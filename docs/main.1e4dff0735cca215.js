(self.webpackChunkphoenix_app=self.webpackChunkphoenix_app||[]).push([[792],{8007:(Yr,mt,Se)=>{"use strict";var Ee=Se(4882);let L=null,ke=1;const ot=Symbol("SIGNAL");function Ye(n){const e=L;return L=n,e}function J(n){if((!g(n)||n.dirty)&&(n.dirty||n.lastCleanEpoch!==ke)){if(!n.producerMustRecompute(n)&&!B(n))return n.dirty=!1,void(n.lastCleanEpoch=ke);n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=ke}}function B(n){v(n);for(let e=0;e<n.producerNode.length;e++){const t=n.producerNode[e],i=n.producerLastReadVersion[e];if(i!==t.version||(J(t),i!==t.version))return!0}return!1}function E(n,e){if(function f(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}(n),v(n),1===n.liveConsumerNode.length)for(let i=0;i<n.producerNode.length;i++)E(n.producerNode[i],n.producerIndexOfThis[i]);const t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){const i=n.liveConsumerIndexOfThis[e],r=n.liveConsumerNode[e];v(r),r.producerIndexOfThis[i]=e}}function g(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function v(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}let he=null;function Je(n){return"function"==typeof n}function tt(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const Fe=tt(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function Ne(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class rt{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(Je(i))try{i()}catch(s){e=s instanceof Fe?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{st(s)}catch(a){e=e??[],a instanceof Fe?e=[...e,...a.errors]:e.push(a)}}if(e)throw new Fe(e)}}add(e){var t;if(e&&e!==this)if(this.closed)st(e);else{if(e instanceof rt){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Ne(t,e)}remove(e){const{_finalizers:t}=this;t&&Ne(t,e),e instanceof rt&&e._removeParent(this)}}rt.EMPTY=(()=>{const n=new rt;return n.closed=!0,n})();const St=rt.EMPTY;function pt(n){return n instanceof rt||n&&"closed"in n&&Je(n.remove)&&Je(n.add)&&Je(n.unsubscribe)}function st(n){Je(n)?n():n.unsubscribe()}const vt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Yt={setTimeout(n,e,...t){const{delegate:i}=Yt;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=Yt;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function qt(n){Yt.setTimeout(()=>{const{onUnhandledError:e}=vt;if(!e)throw n;e(n)})}function Ot(){}const Bn=Dn("C",void 0,void 0);function Dn(n,e,t){return{kind:n,value:e,error:t}}let $n=null;function Cn(n){if(vt.useDeprecatedSynchronousErrorHandling){const e=!$n;if(e&&($n={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=$n;if($n=null,t)throw i}}else n()}class Sn extends rt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,pt(e)&&e.add(this)):this.destination=yo}static create(e,t,i){return new ti(e,t,i)}next(e){this.isStopped?Bs(function bn(n){return Dn("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?Bs(function Mn(n){return Dn("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Bs(Bn,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const ii=Function.prototype.bind;function ai(n,e){return ii.call(n,e)}class Hi{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){Nr(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){Nr(i)}else Nr(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Nr(t)}}}class ti extends Sn{constructor(e,t,i){let r;if(super(),Je(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let s;this&&vt.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&ai(e.next,s),error:e.error&&ai(e.error,s),complete:e.complete&&ai(e.complete,s)}):r=e}this.destination=new Hi(r)}}function Nr(n){vt.useDeprecatedSynchronousErrorHandling?function yn(n){vt.useDeprecatedSynchronousErrorHandling&&$n&&($n.errorThrown=!0,$n.error=n)}(n):qt(n)}function Bs(n,e){const{onStoppedNotification:t}=vt;t&&Yt.setTimeout(()=>t(n,e))}const yo={closed:!0,next:Ot,error:function ss(n){throw n},complete:Ot},xt="function"==typeof Symbol&&Symbol.observable||"@@observable";function K(n){return n}function ye(n){return 0===n.length?K:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}let Pe=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const s=function Nt(n){return n&&n instanceof Sn||function Vt(n){return n&&Je(n.next)&&Je(n.error)&&Je(n.complete)}(n)&&pt(n)}(t)?t:new ti(t,i,r);return Cn(()=>{const{operator:a,source:l}=this;s.add(a?a.call(s,l):l?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=At(i))((r,s)=>{const a=new ti({next:l=>{try{t(l)}catch(d){s(d),a.unsubscribe()}},error:s,complete:r});this.subscribe(a)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[xt](){return this}pipe(...t){return ye(t)(this)}toPromise(t){return new(t=At(t))((i,r)=>{let s;this.subscribe(a=>s=a,a=>r(a),()=>i(s))})}}return n.create=e=>new n(e),n})();function At(n){var e;return null!==(e=n??vt.Promise)&&void 0!==e?e:Promise}const nn=tt(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let hn=(()=>{class n extends Pe{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new kn(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new nn}next(t){Cn(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){Cn(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Cn(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:s}=this;return i||r?St:(this.currentObservers=null,s.push(t),new rt(()=>{this.currentObservers=null,Ne(s,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){const t=new Pe;return t.source=this,t}}return n.create=(e,t)=>new kn(e,t),n})();class kn extends hn{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:St}}class dn extends hn{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}function In(n){return Je(n?.lift)}function ci(n){return e=>{if(In(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Pi(n,e,t,i,r){return new Si(n,e,t,i,r)}class Si extends Sn{constructor(e,t,i,r,s,a){super(e),this.onFinalize=s,this.shouldUnsubscribe=a,this._next=t?function(l){try{t(l)}catch(d){e.error(d)}}:super._next,this._error=r?function(l){try{r(l)}catch(d){e.error(d)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function bi(n,e){return ci((t,i)=>{let r=0;t.subscribe(Pi(i,s=>{i.next(n.call(e,s,r++))}))})}const Wi="https://g.co/ng/security#xss";class Ln extends Error{constructor(e,t){super(function Rs(n,e){return`NG0${Math.abs(n)}${e?": "+e:""}`}(e,t)),this.code=e}}function Oe(n){return{toString:n}.toString()}const et="__parameters__";function tn(n,e,t){return Oe(()=>{const i=function sn(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const a=new r(...s);return l.annotation=a,l;function l(d,u,p){const _=d.hasOwnProperty(et)?d[et]:Object.defineProperty(d,et,{value:[]})[et];for(;_.length<=p;)_.push(null);return(_[p]=_[p]||[]).push(a),d}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}const wn=globalThis;function nt(n){for(let e in n)if(n[e]===nt)return e;throw Error("Could not find renamed property on target object.")}function at(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function ht(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(ht).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function Qt(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const en=nt({__forward_ref__:nt});function jt(n){return n.__forward_ref__=jt,n.toString=function(){return ht(this())},n}function fn(n){return Gn(n)?n():n}function Gn(n){return"function"==typeof n&&n.hasOwnProperty(en)&&n.__forward_ref__===jt}function qi(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function ra(n){return{providers:n.providers||[],imports:n.imports||[]}}function ic(n){return rc(n,$l)||rc(n,fd)}function rc(n,e){return n.hasOwnProperty(e)?n[e]:null}function Io(n){return n&&(n.hasOwnProperty(hd)||n.hasOwnProperty(Td))?n[hd]:null}const $l=nt({\u0275prov:nt}),hd=nt({\u0275inj:nt}),fd=nt({ngInjectableDef:nt}),Td=nt({ngInjectorDef:nt});class Bi{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=qi({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function zf(n){return n&&!!n.\u0275providers}const vg=nt({\u0275cmp:nt}),c1=nt({\u0275dir:nt}),xm=nt({\u0275pipe:nt}),bg=nt({\u0275mod:nt}),$h=nt({\u0275fac:nt}),xg=nt({__NG_ELEMENT_ID__:nt}),Hf=nt({__NG_ENV_ID__:nt});function go(n){return"string"==typeof n?n:null==n?"":String(n)}function Cg(n,e){throw new Ln(-201,!1)}var va=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(va||{});let Mg;function d1(){return Mg}function $d(n){const e=Mg;return Mg=n,e}function u1(n,e,t){const i=ic(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&va.Optional?null:void 0!==e?e:void Cg()}const wp={},h1="__NG_DI_FLAG__",z0="ngTempTokenPath",Rx=/\n/gm,lv="__source";let gA;function Vf(n){const e=gA;return gA=n,e}function H0(n,e=va.Default){if(void 0===gA)throw new Ln(-203,!1);return null===gA?u1(n,void 0,e):gA.get(n,e&va.Optional?null:void 0,e)}function xi(n,e=va.Default){return(d1()||H0)(fn(n),e)}function pi(n,e=va.Default){return xi(n,xh(e))}function xh(n){return typeof n>"u"||"number"==typeof n?n:(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Ac(n){const e=[];for(let t=0;t<n.length;t++){const i=fn(n[t]);if(Array.isArray(i)){if(0===i.length)throw new Ln(900,!1);let r,s=va.Default;for(let a=0;a<i.length;a++){const l=i[a],d=Xd(l);"number"==typeof d?-1===d?r=l.token:s|=d:r=l}e.push(xi(r,s))}else e.push(xi(i))}return e}function Cp(n,e){return n[h1]=e,n.prototype[h1]=e,n}function Xd(n){return n[h1]}const cl=Cp(tn("Optional"),8),Xl=Cp(tn("SkipSelf"),4);function md(n,e){return n.hasOwnProperty($h)?n[$h]:null}function qf(n,e){n.forEach(t=>Array.isArray(t)?qf(t,e):e(t))}function Sg(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Qf(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function Yl(n,e,t){let i=vl(n,e);return i>=0?n[1|i]=t:(i=~i,function Xh(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function Yd(n,e){const t=vl(n,e);if(t>=0)return n[1|t]}function vl(n,e){return function ko(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),a=n[s<<t];if(e===a)return s<<t;a>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const wh={},za=[],zi=new Bi(""),zo=new Bi("",-1),th=new Bi("");class Wc{get(e,t=wp){if(t===wp){const i=new Error(`NullInjectorError: No provider for ${ht(e)}!`);throw i.name="NullInjectorError",i}return t}}var Eg=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(Eg||{}),Ad=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Ad||{}),mi=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(mi||{});function Tg(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}function Dg(n,e,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const s=t[i++],a=t[i++],l=t[i++];n.setAttribute(e,a,l,s)}else{const s=r,a=t[++i];yu(s)?n.setProperty(e,s,a):n.setAttribute(e,s,a),i++}}return i}function Cm(n){return 3===n||4===n||6===n}function yu(n){return 64===n.charCodeAt(0)}function Mp(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||_A(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function _A(n,e,t,i,r){let s=0,a=n.length;if(-1===e)a=-1;else for(;s<n.length;){const l=n[s++];if("number"==typeof l){if(l===e){a=-1;break}if(l>e){a=s-1;break}}}for(;s<n.length;){const l=n[s];if("number"==typeof l)break;if(l===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==a&&(n.splice(a,0,e),s=a+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}const Yh="ng-template";function Ya(n,e,t,i){let r=0;if(i){for(;r<e.length&&"string"==typeof e[r];r+=2)if("class"===e[r]&&-1!==Tg(e[r+1].toLowerCase(),t,0))return!0}else if(Ch(n))return!1;if(r=e.indexOf(1,r),r>-1){let s;for(;++r<e.length&&"string"==typeof(s=e[r]);)if(s.toLowerCase()===t)return!0}return!1}function Ch(n){return 4===n.type&&n.value!==Yh}function Ig(n,e,t){return e===(4!==n.type||t?n.value:Yh)}function Wf(n,e,t){let i=4;const r=n.attrs,s=null!==r?function G0(n){for(let e=0;e<n.length;e++)if(Cm(n[e]))return e;return n.length}(r):0;let a=!1;for(let l=0;l<e.length;l++){const d=e[l];if("number"!=typeof d){if(!a)if(4&i){if(i=2|1&i,""!==d&&!Ig(n,d,t)||""===d&&1===e.length){if(vu(i))return!1;a=!0}}else if(8&i){if(null===r||!Ya(n,r,d,t)){if(vu(i))return!1;a=!0}}else{const u=e[++l],p=cv(d,r,Ch(n),t);if(-1===p){if(vu(i))return!1;a=!0;continue}if(""!==u){let _;if(_=p>s?"":r[p+1].toLowerCase(),2&i&&u!==_){if(vu(i))return!1;a=!0}}}}else{if(!a&&!vu(i)&&!vu(d))return!1;if(a&&vu(d))continue;a=!1,i=d|1&i}}return vu(i)||a}function vu(n){return!(1&n)}function cv(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const a=e[r];if(a===n)return r;if(3===a||6===a)s=!0;else{if(1===a||2===a){let l=e[++r];for(;"string"==typeof l;)l=e[++r];continue}if(4===a)break;if(0===a){r+=4;continue}}r+=s?1:2}return-1}return function bu(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function jf(n,e,t=!1){for(let i=0;i<e.length;i++)if(Wf(n,e[i],t))return!0;return!1}function il(n,e){e:for(let t=0;t<e.length;t++){const i=e[t];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function yA(n,e){return n?":not("+e.trim()+")":e}function Ou(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let a=n[t];if("string"==typeof a)if(2&i){const l=n[++t];r+="["+a+(l.length>0?'="'+l+'"':"")+"]"}else 8&i?r+="."+a:4&i&&(r+=" "+a);else""!==r&&!vu(a)&&(e+=yA(s,r),r=""),i=a,s=s||!vu(i);t++}return""!==r&&(e+=yA(s,r)),e}function Zr(n){return Oe(()=>{const e=Sp(n),t={...e,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===Eg.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Ad.Emulated,styles:n.styles||za,_:null,schemas:n.schemas||null,tView:null,id:""};Ep(t);const i=n.dependencies;return t.directiveDefs=_c(i,!1),t.pipeDefs=_c(i,!0),t.id=function Kh(n){let e=0;const t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const r of t)e=Math.imul(31,e)+r.charCodeAt(0)|0;return e+=2147483648,"c"+e}(t),t})}function Bg(n){return Wo(n)||rl(n)}function Os(n){return null!==n}function vo(n){return Oe(()=>({type:n.type,bootstrap:n.bootstrap||za,declarations:n.declarations||za,imports:n.imports||za,exports:n.exports||za,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function Lu(n,e){if(null==n)return wh;const t={};for(const i in n)if(n.hasOwnProperty(i)){const r=n[i];let s,a,l=mi.None;Array.isArray(r)?(l=r[0],s=r[1],a=r[2]??s):(s=r,a=r),e?(t[s]=l!==mi.None?[i,l]:i,e[s]=a):t[s]=i}return t}function Ft(n){return Oe(()=>{const e=Sp(n);return Ep(e),e})}function Ic(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function Wo(n){return n[vg]||null}function rl(n){return n[c1]||null}function bl(n){return n[xm]||null}function Bc(n,e){const t=n[bg]||null;if(!t&&!0===e)throw new Error(`Type ${ht(n)} does not have '\u0275mod' property.`);return t}function Sp(n){const e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||wh,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||za,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Lu(n.inputs,e),outputs:Lu(n.outputs),debugInfo:null}}function Ep(n){n.features?.forEach(e=>e(n))}function _c(n,e){if(!n)return null;const t=e?bl:Bg;return()=>("function"==typeof n?n():n).map(i=>t(i)).filter(Os)}function Mm(...n){return{\u0275providers:Tp(0,n),\u0275fromNgModule:!0}}function Tp(n,...e){const t=[],i=new Set;let r;const s=a=>{t.push(a)};return qf(e,a=>{const l=a;Uu(l,s,[],i)&&(r||=[],r.push(l))}),void 0!==r&&Dp(r,s),t}function Dp(n,e){for(let t=0;t<n.length;t++){const{ngModule:i,providers:r}=n[t];q0(r,s=>{e(s,i)})}}function Uu(n,e,t,i){if(!(n=fn(n)))return!1;let r=null,s=Io(n);const a=!s&&Wo(n);if(s||a){if(a&&!a.standalone)return!1;r=n}else{const d=n.ngModule;if(s=Io(d),!s)return!1;r=d}const l=i.has(r);if(a){if(l)return!1;if(i.add(r),a.dependencies){const d="function"==typeof a.dependencies?a.dependencies():a.dependencies;for(const u of d)Uu(u,e,t,i)}}else{if(!s)return!1;{if(null!=s.imports&&!l){let u;i.add(r);try{qf(s.imports,p=>{Uu(p,e,t,i)&&(u||=[],u.push(p))})}finally{}void 0!==u&&Dp(u,e)}if(!l){const u=md(r)||(()=>new r);e({provide:r,useFactory:u,deps:za},r),e({provide:th,useValue:r,multi:!0},r),e({provide:zi,useValue:()=>xi(r),multi:!0},r)}const d=s.providers;if(null!=d&&!l){const u=n;q0(d,p=>{e(p,u)})}}}return r!==n&&void 0!==n.providers}function q0(n,e){for(let t of n)zf(t)&&(t=t.\u0275providers),Array.isArray(t)?q0(t,e):e(t)}const vA=nt({provide:String,useValue:nt});function Zh(n){return null!==n&&"object"==typeof n&&vA in n}function Ip(n){return"function"==typeof n}const ih=new Bi(""),yc={},Rg={};let Jh;function bo(){return void 0===Jh&&(Jh=new Wc),Jh}class Rc{}class jc extends Rc{get destroyed(){return this._destroyed}constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Q0(e,a=>this.processProvider(a)),this.records.set(zo,vc(void 0,this)),r.has("environment")&&this.records.set(Rc,vc(void 0,this));const s=this.records.get(ih);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(th,za,va.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;const e=Ye(null);try{for(const i of this._ngOnDestroyHooks)i.ngOnDestroy();const t=this._onDestroyHooks;this._onDestroyHooks=[];for(const i of t)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Ye(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const t=Vf(this),i=$d(void 0);try{return e()}finally{Vf(t),$d(i)}}get(e,t=wp,i=va.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(Hf))return e[Hf](this);i=xh(i);const s=Vf(this),a=$d(void 0);try{if(!(i&va.SkipSelf)){let d=this.records.get(e);if(void 0===d){const u=function ef(n){return"function"==typeof n||"object"==typeof n&&n instanceof Bi}(e)&&ic(e);d=u&&this.injectableDefInScope(u)?vc(kg(e),yc):null,this.records.set(e,d)}if(null!=d)return this.hydrate(e,d)}return(i&va.Self?bo():this.parent).get(e,t=i&va.Optional&&t===wp?null:t)}catch(l){if("NullInjectorError"===l.name){if((l[z0]=l[z0]||[]).unshift(ht(e)),s)throw l;return function pd(n,e,t,i){const r=n[z0];throw e[lv]&&r.unshift(e[lv]),n.message=function gu(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let r=ht(e);if(Array.isArray(e))r=e.map(ht).join(" -> ");else if("object"==typeof e){let s=[];for(let a in e)if(e.hasOwnProperty(a)){let l=e[a];s.push(a+":"+("string"==typeof l?JSON.stringify(l):ht(l)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(Rx,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[z0]=null,n}(l,e,"R3InjectorError",this.source)}throw l}finally{$d(a),Vf(s)}}resolveInjectorInitializers(){const e=Ye(null),t=Vf(this),i=$d(void 0);try{const s=this.get(zi,za,va.Self);for(const a of s)a()}finally{Vf(t),$d(i),Ye(e)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(ht(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Ln(205,!1)}processProvider(e){let t=Ip(e=fn(e))?e:fn(e&&e.provide);const i=function rh(n){return Zh(n)?vc(void 0,n.useValue):vc(Em(n),yc)}(e);if(!Ip(e)&&!0===e.multi){let r=this.records.get(t);r||(r=vc(void 0,yc,!0),r.factory=()=>Ac(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t){const i=Ye(null);try{return t.value===yc&&(t.value=Rg,t.value=t.factory()),"object"==typeof t.value&&t.value&&function Bp(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Ye(i)}}injectableDefInScope(e){if(!e.providedIn)return!1;const t=fn(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function kg(n){const e=ic(n),t=null!==e?e.factory:md(n);if(null!==t)return t;if(n instanceof Bi)throw new Ln(204,!1);if(n instanceof Function)return function Sm(n){if(n.length>0)throw new Ln(204,!1);const t=function Au(n){return n&&(n[$l]||n[fd])||null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new Ln(204,!1)}function Em(n,e,t){let i;if(Ip(n)){const r=fn(n);return md(r)||kg(r)}if(Zh(n))i=()=>fn(n.useValue);else if(function Pg(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...Ac(n.deps||[]));else if(function Kd(n){return!(!n||!n.useExisting)}(n))i=()=>xi(fn(n.useExisting));else{const r=fn(n&&(n.useClass||n.provide));if(!function bA(n){return!!n.deps}(n))return md(r)||kg(r);i=()=>new r(...Ac(n.deps))}return i}function vc(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function Q0(n,e){for(const t of n)Array.isArray(t)?Q0(t,e):t&&zf(t)?Q0(t.\u0275providers,e):e(t)}function El(n,e){n instanceof jc&&n.assertNotDestroyed();const i=Vf(n),r=$d(void 0);try{return e()}finally{Vf(i),$d(r)}}function Pp(){return void 0!==d1()||null!=function f1(){return gA}()}const Tl=0,Gr=1,so=2,ml=3,Zd=4,oc=5,Ul=6,tf=7,Ka=8,$c=9,zu=10,Mo=11,kp=12,j0=13,nf=14,Yo=15,Rl=16,Tm=17,bc=18,Fp=19,Op=20,ac=21,Bd=22,Dl=23,Cs=25,Mh=1,oh=7,cs=9,Ia=10;var $0=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}($0||{});function Fc(n){return Array.isArray(n)&&"object"==typeof n[Mh]}function dl(n){return Array.isArray(n)&&!0===n[Mh]}function MA(n){return!!(4&n.flags)}function sf(n){return n.componentOffset>-1}function zl(n){return!(1&~n.flags)}function Hl(n){return!!n.template}function Lp(n){return!!(512&n[so])}class Hu{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function ch(n,e,t,i){null!==e?e.applyValueToInputSignal(e,i):n[t]=i}function kl(){return Yf}function Yf(n){return n.type.prototype.ngOnChanges&&(n.setInput=Kf),zp}function zp(){const n=Bm(this),e=n?.current;if(e){const t=n.previous;if(t===wh)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function Kf(n,e,t,i,r){const s=this.declaredInputs[i],a=Bm(n)||function Th(n,e){return n[df]=e}(n,{previous:wh,current:null}),l=a.current||(a.current={}),d=a.previous,u=d[s];l[s]=new Hu(u&&u.currentValue,t,d===wh),ch(n,e,r,t)}kl.ngInherit=!0;const df="__ngSimpleChanges__";function Bm(n){return n[df]||null}const eu=function(n,e,t){},Jc="svg";let DA=!1;function oa(n){for(;Array.isArray(n);)n=n[Tl];return n}function IA(n,e){return oa(e[n])}function Pd(n,e){return oa(e[n.index])}function BA(n,e){return n.data[e]}function km(n,e){return n[e]}function Rd(n,e){const t=e[n];return Fc(t)?t:t[Tl]}function dh(n){return!(128&~n[so])}function Vu(n,e){return null==e?null:n[e]}function b1(n){n[Tm]=0}function Y0(n){1024&n[so]||(n[so]|=1024,dh(n)&&Hp(n))}function Oc(n){return!!(9216&n[so]||n[Dl]?.dirty)}function ff(n){n[zu].changeDetectionScheduler?.notify(1),Oc(n)?Hp(n):64&n[so]&&(function hv(){return DA}()?(n[so]|=1024,Hp(n)):n[zu].changeDetectionScheduler?.notify())}function Hp(n){n[zu].changeDetectionScheduler?.notify();let e=Dh(n);for(;null!==e&&!(8192&e[so])&&(e[so]|=8192,dh(e));)e=Dh(e)}function tp(n,e){if(!(256&~n[so]))throw new Ln(911,!1);null===n[ac]&&(n[ac]=[]),n[ac].push(e)}function Dh(n){const e=n[ml];return dl(e)?e[ml]:e}const Gs={lFrame:Wg(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Fm(){return Gs.bindingsEnabled}function Om(){return null!==Gs.skipHydrationRootTNode}function Zi(){return Gs.lFrame.lView}function wa(){return Gs.lFrame.tView}function Ci(n){return Gs.lFrame.contextLView=n,n[Ka]}function Mi(n){return Gs.lFrame.contextLView=null,n}function Ha(){let n=RA();for(;null!==n&&64===n.type;)n=n.parent;return n}function RA(){return Gs.lFrame.currentTNode}function uh(n,e){const t=Gs.lFrame;t.currentTNode=n,t.isParent=e}function kA(){return Gs.lFrame.isParent}function Vg(){Gs.lFrame.isParent=!1}function Yc(){const n=Gs.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function fh(){return Gs.lFrame.bindingIndex++}function pf(n){const e=Gs.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function e_(n,e){const t=Gs.lFrame;t.bindingIndex=t.bindingRootIndex=n,t_(e)}function t_(n){Gs.lFrame.currentDirectiveIndex=n}function i_(){return Gs.lFrame.currentQueryIndex}function FA(n){Gs.lFrame.currentQueryIndex=n}function D1(n){const e=n[Gr];return 2===e.type?e.declTNode:1===e.type?n[oc]:null}function qg(n,e,t){if(t&va.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&va.Host||(r=D1(s),null===r||(s=s[nf],10&r.type))););if(null===r)return!1;e=r,n=s}const i=Gs.lFrame=r_();return i.currentTNode=e,i.lView=n,!0}function Qg(n){const e=r_(),t=n[Gr];Gs.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function r_(){const n=Gs.lFrame,e=null===n?null:n.child;return null===e?Wg(n):e}function Wg(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function s_(){const n=Gs.lFrame;return Gs.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const o_=s_;function a_(){const n=s_();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Lc(){return Gs.lFrame.selectedIndex}function np(n){Gs.lFrame.selectedIndex=n}function gl(){const n=Gs.lFrame;return BA(n.tView,n.selectedIndex)}function Fl(){Gs.lFrame.currentNamespace=Jc}function Ih(){!function mv(){Gs.lFrame.currentNamespace=null}()}let Gp=!0;function Nm(){return Gp}function Za(n){Gp=n}function mf(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:a,ngAfterContentChecked:l,ngAfterViewInit:d,ngAfterViewChecked:u,ngOnDestroy:p}=s;a&&(n.contentHooks??=[]).push(-t,a),l&&((n.contentHooks??=[]).push(t,l),(n.contentCheckHooks??=[]).push(t,l)),d&&(n.viewHooks??=[]).push(-t,d),u&&((n.viewHooks??=[]).push(t,u),(n.viewCheckHooks??=[]).push(t,u)),null!=p&&(n.destroyHooks??=[]).push(t,p)}}function ph(n,e,t){Bh(n,e,3,t)}function mh(n,e,t,i){(3&n[so])===t&&Bh(n,e,t,i)}function Qp(n,e){let t=n[so];(3&t)===e&&(t&=16383,t+=1,n[so]=t)}function Bh(n,e,t,i){const s=i??-1,a=e.length-1;let l=0;for(let d=void 0!==i?65535&n[Tm]:0;d<a;d++)if("number"==typeof e[d+1]){if(l=e[d],null!=i&&l>=i)break}else e[d]<0&&(n[Tm]+=65536),(l<s||-1==s)&&(P1(n,t,e,d),n[Tm]=(4294901760&n[Tm])+d+2),d++}function l_(n,e){eu(4,n,e);const t=Ye(null);try{e.call(n)}finally{Ye(t),eu(5,n,e)}}function P1(n,e,t,i){const r=t[i]<0,s=t[i+1],l=n[r?-t[i]:t[i]];r?n[so]>>14<n[Tm]>>16&&(3&n[so])===e&&(n[so]+=16384,l_(l,s)):l_(l,s)}const ip=-1;class rp{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function Yg(n){return n!==ip}function LA(n){return 32767&n}function Kg(n,e){let t=function R1(n){return n>>16}(n),i=e;for(;t>0;)i=i[nf],t--;return i}let c_=!0;function d_(n){const e=c_;return c_=n,e}const gv=255,u_=5;let Zg=0;const Ph={};function zm(n,e){const t=_v(n,e);if(-1!==t)return t;const i=e[Gr];i.firstCreatePass&&(n.injectorIndex=e.length,Rh(i.data,n),Rh(e,null),Rh(i.blueprint,null));const r=h_(n,e),s=n.injectorIndex;if(Yg(r)){const a=LA(r),l=Kg(r,e),d=l[Gr].data;for(let u=0;u<8;u++)e[s+u]=l[a+u]|d[a+u]}return e[s+8]=r,s}function Rh(n,e){n.push(0,0,0,0,0,0,0,0,e)}function _v(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function h_(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){if(i=NA(r),null===i)return ip;if(t++,r=r[nf],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return ip}function k1(n,e,t){!function UC(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(xg)&&(i=t[xg]),null==i&&(i=t[xg]=Zg++);const r=i&gv;e.data[n+(r>>u_)]|=1<<r}(n,e,t)}function Nx(n,e,t){if(t&va.Optional||void 0!==n)return n;Cg()}function f_(n,e,t,i){if(t&va.Optional&&void 0===i&&(i=null),!(t&(va.Self|va.Host))){const r=n[$c],s=$d(void 0);try{return r?r.get(e,i,t&va.Optional):u1(e,i,t&va.Optional)}finally{$d(s)}}return Nx(i,0,t)}function Jg(n,e,t,i=va.Default,r){if(null!==n){if(2048&e[so]&&!(i&va.Self)){const a=function gd(n,e,t,i,r){let s=n,a=e;for(;null!==s&&null!==a&&2048&a[so]&&!(512&a[so]);){const l=p_(s,a,t,i|va.Self,Ph);if(l!==Ph)return l;let d=s.parent;if(!d){const u=a[Op];if(u){const p=u.get(t,Ph,i);if(p!==Ph)return p}d=NA(a),a=a[nf]}s=d}return r}(n,e,t,i,Ph);if(a!==Ph)return a}const s=p_(n,e,t,i,Ph);if(s!==Ph)return s}return f_(e,t,i,r)}function p_(n,e,t,i,r){const s=function F1(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(xg)?n[xg]:void 0;return"number"==typeof e?e>=0?e&gv:L1:e}(t);if("function"==typeof s){if(!qg(e,n,i))return i&va.Host?Nx(r,0,i):f_(e,t,i,r);try{let a;if(a=s(i),null!=a||i&va.Optional)return a;Cg()}finally{o_()}}else if("number"==typeof s){let a=null,l=_v(n,e),d=ip,u=i&va.Host?e[Yo][oc]:null;for((-1===l||i&va.SkipSelf)&&(d=-1===l?h_(n,e):e[l+8],d!==ip&&O1(i,!1)?(a=e[Gr],l=LA(d),e=Kg(d,e)):l=-1);-1!==l;){const p=e[Gr];if(Nc(s,l,p.data)){const _=Ux(l,e,t,a,i,u);if(_!==Ph)return _}d=e[l+8],d!==ip&&O1(i,e[Gr].data[l+8]===u)&&Nc(s,l,e)?(a=p,l=LA(d),e=Kg(d,e)):l=-1}}return r}function Ux(n,e,t,i,r,s){const a=e[Gr],l=a.data[n+8],p=vs(l,a,t,null==i?sf(l)&&c_:i!=a&&!!(3&l.type),r&va.Host&&s===l);return null!==p?Gu(e,a,p,l):Ph}function vs(n,e,t,i,r){const s=n.providerIndexes,a=e.data,l=1048575&s,d=n.directiveStart,p=s>>20,S=r?l+p:n.directiveEnd;for(let R=i?l:l+p;R<S;R++){const H=a[R];if(R<d&&t===H||R>=d&&H.type===t)return R}if(r){const R=a[d];if(R&&Hl(R)&&R.type===t)return d}return null}function Gu(n,e,t,i){let r=n[t];const s=e.data;if(function Um(n){return n instanceof rp}(r)){const a=r;a.resolving&&function Dx(n,e){throw e&&e.join(" > "),new Ln(-200,n)}(function Wa(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():go(n)}(s[t]));const l=d_(a.canSeeViewProviders);a.resolving=!0;const u=a.injectImpl?$d(a.injectImpl):null;qg(n,i,va.Default);try{r=n[t]=a.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function qp(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const a=Yf(e);(t.preOrderHooks??=[]).push(n,a),(t.preOrderCheckHooks??=[]).push(n,a)}r&&(t.preOrderHooks??=[]).push(0-n,r),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}(t,s[t],e)}finally{null!==u&&$d(u),d_(l),a.resolving=!1,o_()}}return r}function Nc(n,e,t){return!!(t[e+(n>>u_)]&1<<n)}function O1(n,e){return!(n&va.Self||n&va.Host&&e)}class cc{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return Jg(this._tNode,this._lView,e,xh(i),t)}}function L1(){return new cc(Ha(),Zi())}function Ca(n){return Oe(()=>{const e=n.prototype.constructor,t=e[$h]||Wp(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[$h]||Wp(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function Wp(n){return Gn(n)?()=>{const e=Wp(fn(n));return e&&e()}:md(n)}function NA(n){const e=n[Gr],t=e.type;return 2===t?e.declTNode:1===t?n[oc]:null}function xu(n){return function yv(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const s=t[r];if(Cm(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(s===e)return t[r+1];r+=2}}}return null}(Ha(),n)}function Zl(n,e=null,t=null,i){const r=gf(n,e,t,i);return r.resolveInjectorInitializers(),r}function gf(n,e=null,t=null,i,r=new Set){const s=[t||za,Mm(n)];return i=i||("object"==typeof n?void 0:ht(n)),new jc(s,e||bo(),i||null,r)}let Al=(()=>{class n{static#e=this.THROW_IF_NOT_FOUND=wp;static#t=this.NULL=new Wc;static create(t,i){if(Array.isArray(t))return Zl({name:""},i,t,"");{const r=t.name??"";return Zl({name:r},t.parent,t.providers,r)}}static#n=this.\u0275prov=qi({token:n,providedIn:"any",factory:()=>xi(zo)});static#i=this.__NG_ELEMENT_ID__=-1}return n})();function kd(n){return n.ngOriginalError}class xl{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&kd(e);for(;t&&kd(t);)t=kd(t);return t||null}}const t0=new Bi("",{providedIn:"root",factory:()=>pi(xl).handleError.bind(void 0)});let Uc=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=HA;static#t=this.__NG_ENV_ID__=t=>t}return n})();class m_ extends Uc{constructor(e){super(),this._lView=e}onDestroy(e){return tp(this._lView,e),()=>function zg(n,e){if(null===n[ac])return;const t=n[ac].indexOf(e);-1!==t&&n[ac].splice(t,1)}(this._lView,e)}}function HA(){return new m_(Zi())}function g_(){return qm(Ha(),Zi())}function qm(n,e){return new oo(Pd(n,e))}let oo=(()=>{class n{constructor(t){this.nativeElement=t}static#e=this.__NG_ELEMENT_ID__=g_}return n})();function Qm(n){return n instanceof oo?n.nativeElement:n}function Wm(n){return e=>{setTimeout(n,void 0,e)}}const Ls=class __ extends hn{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,Pp()&&(this.destroyRef=pi(Uc,{optional:!0})??void 0)}emit(e){const t=Ye(null);try{super.next(e)}finally{Ye(t)}}subscribe(e,t,i){let r=e,s=t||(()=>null),a=i;if(e&&"object"==typeof e){const d=e;r=d.next?.bind(d),s=d.error?.bind(d),a=d.complete?.bind(d)}this.__isAsync&&(s=Wm(s),r&&(r=Wm(r)),a&&(a=Wm(a)));const l=super.subscribe({next:r,error:s,complete:a});return e instanceof rt&&e.add(l),l}};function r0(){return this._results[Symbol.iterator]()}class _f{static#e=Symbol.iterator;get changes(){return this._changes??=new Ls}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._onDirty=void 0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;const t=_f.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=r0)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;const i=function ha(n){return n.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function wm(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(this._results,i,t))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}}function le(n){return!(128&~n.flags)}const Ue=new Map;let dt=0;const zr="__ngContext__";function Hr(n,e){Fc(e)?(n[zr]=e[Fp],function ln(n){Ue.set(n[Fp],n)}(e)):n[zr]=e}function ul(n){return yf(n[kp])}function Kc(n){return yf(n[Zd])}function yf(n){for(;null!==n&&!dl(n);)n=n[Zd];return n}let wv;const y_=new Bi("",{providedIn:"root",factory:()=>GC}),GC="ng",Vx=new Bi(""),Kp=new Bi("",{providedIn:"platform",factory:()=>"unknown"}),Od=new Bi(""),Cv=new Bi("",{providedIn:"root",factory:()=>function $m(){if(void 0!==wv)return wv;if(typeof document<"u")return document;throw new Ln(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let Gt=()=>null;function Qn(n,e,t=!1){return Gt(n,e,t)}const nu=new Bi("",{providedIn:"root",factory:()=>!1});let Xm;function c0(n){return function em(){if(void 0===Xm&&(Xm=null,wn.trustedTypes))try{Xm=wn.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Xm}()?.createScriptURL(n)||n}class xf{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Wi})`}}function Sa(n){return n instanceof xf?n.changingThisBreaksApplicationSecurity:n}function ec(n,e){const t=function yh(n){return n instanceof xf&&n.getTypeName()||null}(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${Wi})`)}return t===e}const Qx=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var Nd=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(Nd||{});function Y1(n){const e=kv();return e?e.sanitize(Nd.URL,n)||"":ec(n,"URL")?Sa(n):function Dv(n){return(n=String(n)).match(Qx)?n:"unsafe:"+n}(go(n))}function $x(n){const e=kv();if(e)return c0(e.sanitize(Nd.RESOURCE_URL,n)||"");if(ec(n,"ResourceURL"))return c0(Sa(n));throw new Ln(904,!1)}function kv(){const n=Zi();return n&&n[zu].sanitizer}const HB=/^>|^->|<!--|-->|--!>|<!-$/g,VB=/(<|>)/g,Fv="\u200b$1\u200b";function Cu(n){return n instanceof Function?n():n}var u0=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(u0||{});let sM;function Nv(n,e){return sM(n,e)}function nm(n,e,t,i,r){if(null!=i){let s,a=!1;dl(i)?s=i:Fc(i)&&(a=!0,i=i[Tl]);const l=oa(i);0===n&&null!==t?null==r?DT(e,t,l):w_(e,t,l,r||null,!0):1===n&&null!==t?w_(e,t,l,r||null,!0):2===n?function sy(n,e,t){const i=iy(n,e);i&&function cM(n,e,t,i){n.removeChild(e,t,i)}(n,i,e,t)}(e,l,a):3===n&&e.destroyNode(l),null!=s&&function RT(n,e,t,i,r){const s=t[oh];s!==oa(t)&&nm(e,n,i,s,r);for(let l=Ia;l<t.length;l++){const d=t[l];Qv(d[Gr],d,n,e,i,s)}}(e,n,s,t,r)}}function ty(n,e){return n.createComment(function JC(n){return n.replace(HB,e=>e.replace(VB,Fv))}(e))}function Uv(n,e,t){return n.createElement(e,t)}function ST(n,e){e[zu].changeDetectionScheduler?.notify(1),Qv(n,e,e[Mo],2,null,null)}function aM(n,e){const t=n[cs],i=t.indexOf(e);t.splice(i,1)}function jA(n,e){if(n.length<=Ia)return;const t=Ia+e,i=n[t];if(i){const r=i[Rl];null!==r&&r!==n&&aM(r,i),e>0&&(n[t-1][Zd]=i[Zd]);const s=Qf(n,Ia+e);!function Yx(n,e){ST(n,e),e[Tl]=null,e[oc]=null}(i[Gr],i);const a=s[bc];null!==a&&a.detachView(s[Gr]),i[ml]=null,i[Zd]=null,i[so]&=-129}return i}function ny(n,e){if(!(256&e[so])){const t=e[Mo];t.destroyNode&&Qv(n,e,t,3,null,null),function zv(n){let e=n[kp];if(!e)return lM(n[Gr],n);for(;e;){let t=null;if(Fc(e))t=e[kp];else{const i=e[Ia];i&&(t=i)}if(!t){for(;e&&!e[Zd]&&e!==n;)Fc(e)&&lM(e[Gr],e),e=e[ml];null===e&&(e=n),Fc(e)&&lM(e[Gr],e),t=e&&e[Zd]}e=t}}(e)}}function lM(n,e){if(256&e[so])return;const t=Ye(null);try{e[so]&=-129,e[so]|=256,e[Dl]&&function $(n){if(v(n),g(n))for(let e=0;e<n.producerNode.length;e++)E(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}(e[Dl]),function TT(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof rp)){const s=t[i+1];if(Array.isArray(s))for(let a=0;a<s.length;a+=2){const l=r[s[a]],d=s[a+1];eu(4,l,d);try{d.call(l)}finally{eu(5,l,d)}}else{eu(4,r,s);try{s.call(r)}finally{eu(5,r,s)}}}}}(n,e),function Ym(n,e){const t=n.cleanup,i=e[tf];if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const a=t[s+3];a>=0?i[a]():i[-a].unsubscribe(),s+=2}else t[s].call(i[t[s+1]]);null!==i&&(e[tf]=null);const r=e[ac];if(null!==r){e[ac]=null;for(let s=0;s<r.length;s++)(0,r[s])()}}(n,e),1===e[Gr].type&&e[Mo].destroy();const i=e[Rl];if(null!==i&&dl(e[ml])){i!==e[ml]&&aM(i,e);const r=e[bc];null!==r&&r.detachView(n)}!function jn(n){Ue.delete(n[Fp])}(e)}finally{Ye(t)}}function Zx(n,e,t){return function Hv(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[Tl];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:s}=n.data[i.directiveStart+r];if(s===Ad.None||s===Ad.Emulated)return null}return Pd(i,t)}}(n,e.parent,t)}function w_(n,e,t,i,r){n.insertBefore(e,t,i,r)}function DT(n,e,t){n.appendChild(e,t)}function Jx(n,e,t,i,r){null!==i?w_(n,e,t,i,r):DT(n,e,t)}function iy(n,e){return n.parentNode(e)}function Vv(n,e,t){return tw(n,e,t)}let Gv,tw=function ew(n,e,t){return 40&n.type?Pd(n,t):null};function iw(n,e,t,i){const r=Zx(n,i,e),s=e[Mo],l=Vv(i.parent||e[oc],i,e);if(null!=r)if(Array.isArray(t))for(let d=0;d<t.length;d++)Jx(s,r,t[d],l,!1);else Jx(s,r,t,l,!1);void 0!==Gv&&Gv(s,i,e,t,r)}function ry(n,e){if(null!==e){const t=e.type;if(3&t)return Pd(e,n);if(4&t)return uM(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return ry(n,i);{const r=n[e.index];return dl(r)?uM(-1,r):oa(r)}}if(32&t)return Nv(e,n)()||oa(n[e.index]);{const i=dM(n,e);return null!==i?Array.isArray(i)?i[0]:ry(Dh(n[Yo]),i):ry(n,e.next)}}return null}function dM(n,e){return null!==e?n[Yo][oc].projection[e.projection]:null}function uM(n,e){const t=Ia+n+1;if(t<e.length){const i=e[t],r=i[Gr].firstChild;if(null!==r)return ry(i,r)}return e[oh]}function qv(n,e,t,i,r,s,a){for(;null!=t;){const l=i[t.index],d=t.type;if(a&&0===e&&(l&&Hr(oa(l),i),t.flags|=2),32&~t.flags)if(8&d)qv(n,e,t.child,i,r,s,!1),nm(e,n,r,l,s);else if(32&d){const u=Nv(t,i);let p;for(;p=u();)nm(e,n,r,p,s);nm(e,n,r,l,s)}else 16&d?hM(n,e,i,t,r,s):nm(e,n,r,l,s);t=a?t.projectionNext:t.next}}function Qv(n,e,t,i,r,s){qv(t,i,n.firstChild,e,r,s,!1)}function hM(n,e,t,i,r,s){const a=t[Yo],d=a[oc].projection[i.projection];if(Array.isArray(d))for(let u=0;u<d.length;u++)nm(e,n,r,d[u],s);else{let u=d;const p=a[ml];le(i)&&(u.flags|=128),qv(n,e,u,p,r,s,!0)}}function fM(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function C_(n,e,t){const{mergedAttrs:i,classes:r,styles:s}=t;null!==i&&Dg(n,e,i),null!==r&&fM(n,e,r),null!==s&&function FT(n,e,t){n.setAttribute(e,"style",t)}(n,e,s)}const ca={};function Vn(n=1){up(wa(),Zi(),Lc()+n,!1)}function up(n,e,t,i){if(!i)if(3&~e[so]){const s=n.preOrderHooks;null!==s&&mh(e,s,0,t)}else{const s=n.preOrderCheckHooks;null!==s&&ph(e,s,t)}np(t)}function Lt(n,e=va.Default){const t=Zi();return null===t?xi(n,e):Jg(Ha(),t,fn(n),e)}function pM(){throw new Error("invalid")}function h0(n,e,t,i,r,s){const a=Ye(null);try{let l=null;r&mi.SignalBased&&(l=e[i][ot]),null!==l&&void 0!==l.transformFn&&(s=l.transformFn(s)),r&mi.HasDecoratorInputTransform&&(s=n.inputTransforms[i].call(e,s)),null!==n.setInput?n.setInput(e,l,s,t,i):ch(e,l,i,s)}finally{Ye(a)}}function mM(n,e,t,i,r,s,a,l,d,u,p){const _=e.blueprint.slice();return _[Tl]=r,_[so]=204|i,(null!==u||n&&2048&n[so])&&(_[so]|=2048),b1(_),_[ml]=_[nf]=n,_[Ka]=t,_[zu]=a||n&&n[zu],_[Mo]=l||n&&n[Mo],_[$c]=d||n&&n[$c]||null,_[oc]=s,_[Fp]=function Bt(){return dt++}(),_[Ul]=p,_[Op]=u,_[Yo]=2==e.type?n[Yo]:_,_}function $A(n,e,t,i,r){let s=n.data[e];if(null===s)s=function OT(n,e,t,i,r){const s=RA(),a=kA(),d=n.data[e]=function ow(n,e,t,i,r,s){let a=e?e.injectorIndex:-1,l=0;return Om()&&(l|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:a,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:l,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,a?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=d),null!==s&&(a?null==s.child&&null!==d.parent&&(s.child=d):null===s.next&&(s.next=d,d.prev=s)),d}(n,e,t,i,r),function J0(){return Gs.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const a=function Lm(){const n=Gs.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===a?-1:a.injectorIndex}return uh(s,!0),s}function rw(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function LT(n,e,t,i,r){const s=Lc(),a=2&i;try{np(-1),a&&e.length>Cs&&up(n,e,Cs,!1),eu(a?2:0,r),t(i,r)}finally{np(s),eu(a?3:1,r)}}function Wv(n,e,t){if(MA(e)){const i=Ye(null);try{const s=e.directiveEnd;for(let a=e.directiveStart;a<s;a++){const l=n.data[a];l.contentQueries&&l.contentQueries(1,t[a],a)}}finally{Ye(i)}}}function Mu(n,e,t){Fm()&&(function VT(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;sf(t)&&function yM(n,e,t){const i=Pd(e,n),r=M_(t);let a=16;t.signals?a=4096:t.onPush&&(a=64);const l=dy(n,mM(n,r,null,a,i,e,null,n[zu].rendererFactory.createRenderer(i,t),null,null,null));n[e.index]=l}(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||zm(t,e),Hr(i,e);const a=t.initialInputs;for(let l=r;l<s;l++){const d=n.data[l],u=Gu(e,n,l,t);Hr(u,e),null!==a&&WT(0,l-r,u,d,0,a),Hl(d)&&(Rd(t.index,e)[Ka]=Gu(e,n,l,t))}}(n,e,t,Pd(t,e)),!(64&~t.flags)&&$v(n,e,t))}function f0(n,e,t=Pd){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const a=i[s+1],l=-1===a?t(e,n):n[a];n[r++]=l}}}function M_(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=S_(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function S_(n,e,t,i,r,s,a,l,d,u,p){const _=Cs+i,S=_+r,R=function oy(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:ca);return t}(_,S),H="function"==typeof u?u():u;return R[Gr]={type:n,blueprint:R,template:t,queries:null,viewQuery:l,declTNode:e,data:R.slice().fill(null,_),bindingStartIndex:_,expandoStartIndex:S,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof a?a():a,firstChild:null,schemas:d,consts:H,incompleteFirstPass:!1,ssrId:p}}let cy=()=>null;function AM(n,e,t,i,r){for(let s in e){if(!e.hasOwnProperty(s))continue;const a=e[s];if(void 0===a)continue;i??={};let l,d=mi.None;Array.isArray(a)?(l=a[0],d=a[1]):l=a;let u=s;if(null!==r){if(!r.hasOwnProperty(s))continue;u=r[s]}0===n?aw(i,t,u,l,d):aw(i,t,u,l)}return i}function aw(n,e,t,i,r){let s;n.hasOwnProperty(t)?(s=n[t]).push(e,i):s=n[t]=[e,i],void 0!==r&&s.push(r)}function Su(n,e,t,i,r,s,a,l){const d=Pd(e,t);let p,u=e.inputs;!l&&null!=u&&(p=u[i])?(MM(n,t,p,i,r),sf(e)&&function lw(n,e){const t=Rd(e,n);16&t[so]||(t[so]|=64)}(t,e.index)):3&e.type&&(i=function KB(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=a?a(r,e.value||"",i):r,s.setProperty(d,i,r))}function cw(n,e,t,i){if(Fm()){const r=null===i?null:{"":-1},s=function GT(n,e){const t=n.directiveRegistry;let i=null,r=null;if(t)for(let s=0;s<t.length;s++){const a=t[s];if(jf(e,a.selectors,!1))if(i||(i=[]),Hl(a))if(null!==a.findHostDirectiveDefs){const l=[];r=r||new Map,a.findHostDirectiveDefs(a,l,r),i.unshift(...l,a),Xv(n,e,l.length)}else i.unshift(a),Xv(n,e,0);else r=r||new Map,a.findHostDirectiveDefs?.(a,i,r),i.push(a)}return null===i?null:[i,r]}(n,t);let a,l;null===s?a=l=null:[a,l]=s,null!==a&&gM(n,e,t,a,r,l),r&&function JB(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new Ln(-301,!1);i.push(e[r],s)}}}(t,i,r)}t.mergedAttrs=Mp(t.mergedAttrs,t.attrs)}function gM(n,e,t,i,r,s){for(let u=0;u<i.length;u++)k1(zm(t,e),n,i[u].type);!function QT(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,i.length);for(let u=0;u<i.length;u++){const p=i[u];p.providersResolver&&p.providersResolver(p)}let a=!1,l=!1,d=rw(n,e,i.length,null);for(let u=0;u<i.length;u++){const p=i[u];t.mergedAttrs=Mp(t.mergedAttrs,p.hostAttrs),eP(n,t,e,d,p),qT(d,p,r),null!==p.contentQueries&&(t.flags|=4),(null!==p.hostBindings||null!==p.hostAttrs||0!==p.hostVars)&&(t.flags|=64);const _=p.type.prototype;!a&&(_.ngOnChanges||_.ngOnInit||_.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),a=!0),!l&&(_.ngOnChanges||_.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),l=!0),d++}!function UT(n,e,t){const r=e.directiveEnd,s=n.data,a=e.attrs,l=[];let d=null,u=null;for(let p=e.directiveStart;p<r;p++){const _=s[p],S=t?t.get(_):null,H=S?S.outputs:null;d=AM(0,_.inputs,p,d,S?S.inputs:null),u=AM(1,_.outputs,p,u,H);const re=null===d||null===a||Ch(e)?null:vM(d,p,a);l.push(re)}null!==d&&(d.hasOwnProperty("class")&&(e.flags|=8),d.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=l,e.inputs=d,e.outputs=u}(n,t,s)}function $v(n,e,t){const i=t.directiveStart,r=t.directiveEnd,s=t.index,a=function Gg(){return Gs.lFrame.currentDirectiveIndex}();try{np(s);for(let l=i;l<r;l++){const d=n.data[l],u=e[l];t_(l),(null!==d.hostBindings||0!==d.hostVars||null!==d.hostAttrs)&&_M(d,u)}}finally{np(-1),t_(a)}}function _M(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function Xv(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function qT(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;Hl(e)&&(t[""]=n)}}function eP(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=md(r.type)),a=new rp(s,Hl(r),Lt);n.blueprint[i]=a,t[i]=a,function HT(n,e,t,i,r){const s=r.hostBindings;if(s){let a=n.hostBindingOpCodes;null===a&&(a=n.hostBindingOpCodes=[]);const l=~e.index;(function ZB(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(a)!=l&&a.push(l),a.push(t,i,s)}}(n,e,i,rw(n,t,r.hostVars,ca),r)}function hp(n,e,t,i,r,s){const a=Pd(n,e);!function XA(n,e,t,i,r,s,a){if(null==s)n.removeAttribute(e,r,t);else{const l=null==a?go(s):a(s,i||"",r);n.setAttribute(e,r,l,t)}}(e[Mo],a,s,n.value,t,i,r)}function WT(n,e,t,i,r,s){const a=s[e];if(null!==a)for(let l=0;l<a.length;)h0(i,t,a[l++],a[l++],a[l++],a[l++])}function vM(n,e,t){let i=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===i&&(i=[]);const a=n[s];for(let l=0;l<a.length;l+=3)if(a[l]===e){i.push(s,a[l+1],a[l+2],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function bM(n,e,t,i){return[n,!0,0,e,null,i,null,t,null,null]}function xM(n,e){const t=n.contentQueries;if(null!==t){const i=Ye(null);try{for(let r=0;r<t.length;r+=2){const a=t[r+1];if(-1!==a){const l=n.data[a];FA(t[r]),l.contentQueries(2,e[a],a)}}}finally{Ye(i)}}}function dy(n,e){return n[kp]?n[j0][Zd]=e:n[kp]=e,n[j0]=e,e}function wM(n,e,t){FA(0);const i=Ye(null);try{e(n,t)}finally{Ye(i)}}function CM(n){return n[tf]||(n[tf]=[])}function uy(n){return n.cleanup||(n.cleanup=[])}function uw(n,e){const t=n[$c],i=t?t.get(xl,null):null;i&&i.handleError(e)}function MM(n,e,t,i,r){for(let s=0;s<t.length;){const a=t[s++],l=t[s++],d=t[s++];h0(n.data[a],e[a],i,l,d,r)}}function jT(n,e){const t=Rd(e,n),i=t[Gr];!function $T(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}(i,t);const r=t[Tl];null!==r&&null===t[Ul]&&(t[Ul]=Qn(r,t[$c])),SM(i,t,t[Ka])}function SM(n,e,t){Qg(e);try{const i=n.viewQuery;null!==i&&wM(1,i,t);const r=n.template;null!==r&&LT(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[bc]?.finishViewCreation(n),n.staticContentQueries&&xM(n,e),n.staticViewQueries&&wM(2,n.viewQuery,t);const s=n.components;null!==s&&function tP(n,e){for(let t=0;t<e.length;t++)jT(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[so]&=-5,a_()}}function Yv(n,e,t,i){const r=Ye(null);try{const s=e.tView,d=mM(n,s,t,4096&n[so]?4096:16,null,e,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null);d[Rl]=n[e.index];const p=n[bc];return null!==p&&(d[bc]=p.createEmbeddedView(s)),SM(s,d,t),d}finally{Ye(r)}}function Kv(n,e){const t=Ia+e;if(t<n.length)return n[t]}function hy(n,e){return!e||null===e.firstChild||le(n)}function Zv(n,e,t,i=!0){const r=e[Gr];if(function $B(n,e,t,i){const r=Ia+i,s=t.length;i>0&&(t[r-1][Zd]=e),i<s-Ia?(e[Zd]=t[r],Sg(t,Ia+i,e)):(t.push(e),e[Zd]=null),e[ml]=t;const a=e[Rl];null!==a&&t!==a&&function ET(n,e){const t=n[cs];e[Yo]!==e[ml][ml][Yo]&&(n[so]|=$0.HasTransplantedViews),null===t?n[cs]=[e]:t.push(e)}(a,e);const l=e[bc];null!==l&&l.insertView(n),ff(e),e[so]|=128}(r,e,n,t),i){const a=uM(t,n),l=e[Mo],d=iy(l,n[oh]);null!==d&&function Kx(n,e,t,i,r,s){i[Tl]=r,i[oc]=e,Qv(n,i,t,1,r,s)}(r,n[oc],l,e,d,a)}const s=e[Ul];null!==s&&null!==s.firstChild&&(s.firstChild=null)}function hw(n,e){const t=jA(n,e);return void 0!==t&&ny(t[Gr],t),t}function fy(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];null!==s&&i.push(oa(s)),dl(s)&&Jv(s,i);const a=t.type;if(8&a)fy(n,e,t.child,i);else if(32&a){const l=Nv(t,e);let d;for(;d=l();)i.push(d)}else if(16&a){const l=dM(e,t);if(Array.isArray(l))i.push(...l);else{const d=Dh(e[Yo]);fy(d[Gr],d,l,i,!0)}}t=r?t.projectionNext:t.next}return i}function Jv(n,e){for(let t=Ia;t<n.length;t++){const i=n[t],r=i[Gr].firstChild;null!==r&&fy(i[Gr],i,r,e)}n[oh]!==n[Tl]&&e.push(n[oh])}let XT=[];const py={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{},consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{Hp(n.lView)},consumerOnSignalRead(){this.lView[Dl]=this}},EM=100;function E_(n,e=!0,t=0){const i=n[zu],r=i.rendererFactory;r.begin?.();try{!function rP(n,e){Aw(n,e);let t=0;for(;Oc(n);){if(t===EM)throw new Ln(103,!1);t++,Aw(n,1)}}(n,t)}catch(a){throw e&&uw(n,a),a}finally{r.end?.(),i.inlineEffectRunner?.flush()}}function my(n,e,t,i){const r=e[so];if(!(256&~r))return;e[zu].inlineEffectRunner?.flush(),Qg(e);let a=null,l=null;(function pw(n){return 2!==n.type})(n)&&(l=function nP(n){return n[Dl]??function iP(n){const e=XT.pop()??Object.create(py);return e.lView=n,e}(n)}(e),a=function me(n){return n&&(n.nextProducerIndex=0),Ye(n)}(l));try{b1(e),function Z0(n){return Gs.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&LT(n,e,t,2,i);const d=!(3&~r);if(d){const _=n.preOrderCheckHooks;null!==_&&ph(e,_,null)}else{const _=n.preOrderHooks;null!==_&&mh(e,_,0,null),Qp(e,0)}if(function sP(n){for(let e=ul(n);null!==e;e=Kc(e)){if(!(e[so]&$0.HasTransplantedViews))continue;const t=e[cs];for(let i=0;i<t.length;i++){Y0(t[i])}}}(e),YT(e,0),null!==n.contentQueries&&xM(n,e),d){const _=n.contentCheckHooks;null!==_&&ph(e,_)}else{const _=n.contentHooks;null!==_&&mh(e,_,1),Qp(e,1)}!function YB(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)np(~r);else{const s=r,a=t[++i],l=t[++i];e_(a,s),l(2,e[s])}}}finally{np(-1)}}(n,e);const u=n.components;null!==u&&KT(e,u,0);const p=n.viewQuery;if(null!==p&&wM(2,p,i),d){const _=n.viewCheckHooks;null!==_&&ph(e,_)}else{const _=n.viewHooks;null!==_&&mh(e,_,2),Qp(e,2)}if(!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[Bd]){for(const _ of e[Bd])_();e[Bd]=null}e[so]&=-73}catch(d){throw Hp(e),d}finally{null!==l&&(function X(n,e){if(Ye(e),n&&void 0!==n.producerNode&&void 0!==n.producerIndexOfThis&&void 0!==n.producerLastReadVersion){if(g(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)E(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}(l,a),function Km(n){n.lView[Dl]!==n&&(n.lView=null,XT.push(n))}(l)),a_()}}function YT(n,e){for(let t=ul(n);null!==t;t=Kc(t))for(let i=Ia;i<t.length;i++)mw(t[i],e)}function oP(n,e,t){mw(Rd(e,n),t)}function mw(n,e){dh(n)&&Aw(n,e)}function Aw(n,e){const i=n[Gr],r=n[so],s=n[Dl];let a=!!(0===e&&16&r);if(a||=!!(64&r&&0===e),a||=!!(1024&r),a||=!(!s?.dirty||!B(s)),s&&(s.dirty=!1),n[so]&=-9217,a)my(i,n,i.template,n[Ka]);else if(8192&r){YT(n,1);const l=i.components;null!==l&&KT(n,l,1)}}function KT(n,e,t){for(let i=0;i<e.length;i++)oP(n,e[i],t)}function eb(n){for(n[zu].changeDetectionScheduler?.notify();n;){n[so]|=64;const e=Dh(n);if(Lp(n)&&!e)return n;n=e}return null}class gw{get rootNodes(){const e=this._lView,t=e[Gr];return fy(t,e,t.firstChild,[])}constructor(e,t,i=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=i,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Ka]}set context(e){this._lView[Ka]=e}get destroyed(){return!(256&~this._lView[so])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[ml];if(dl(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(jA(e,i),Qf(t,i))}this._attachedToViewContainer=!1}ny(this._lView[Gr],this._lView)}onDestroy(e){tp(this._lView,e)}markForCheck(){eb(this._cdRefInjectingView||this._lView)}detach(){this._lView[so]&=-129}reattach(){ff(this._lView),this._lView[so]|=128}detectChanges(){this._lView[so]|=1024,E_(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Ln(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,ST(this._lView[Gr],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Ln(902,!1);this._appRef=e,ff(this._lView)}}let Ud=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=xN}return n})();const ZT=Ud,JT=class extends ZT{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,i){const r=Yv(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:i});return new gw(r)}};function xN(){return T_(Ha(),Zi())}function T_(n,e){return 4&n.type?new JT(e,n,qm(n,e)):null}let sb=()=>null;function yy(n,e){return sb(n,e)}class ob{}class ab{}class f3{}class _P{resolveComponentFactory(e){throw function AP(n){const e=Error(`No component factory found for ${ht(n)}.`);return e.ngComponent=n,e}(e)}}let p0=(()=>{class n{static#e=this.NULL=new _P}return n})();class LM{}let KA=(()=>{class n{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function yP(){const n=Zi(),t=Rd(Ha().index,n);return(Fc(t)?t:n)[Mo]}()}return n})(),EN=(()=>{class n{static#e=this.\u0275prov=qi({token:n,providedIn:"root",factory:()=>null})}return n})();const NM={},m3=new Set;function im(n){m3.has(n)||(m3.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function I_(...n){}class io{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ls(!1),this.onMicrotaskEmpty=new Ls(!1),this.onStable=new Ls(!1),this.onError=new Ls(!1),typeof Zone>"u")throw new Ln(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function A3(){const n="function"==typeof wn.requestAnimationFrame;let e=wn[n?"requestAnimationFrame":"setTimeout"],t=wn[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function o(n){const e=()=>{!function w(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(wn,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,c(n),n.isCheckStableRunning=!0,UM(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),c(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,a,l)=>{if(function N(n){return!(!Array.isArray(n)||1!==n.length)&&!0===n[0].data?.__ignore_ng_zone__}(l))return t.invokeTask(r,s,a,l);try{return h(n),t.invokeTask(r,s,a,l)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),m(n)}},onInvoke:(t,i,r,s,a,l,d)=>{try{return h(n),t.invoke(r,s,a,l,d)}finally{n.shouldCoalesceRunChangeDetection&&e(),m(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,c(n),UM(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!io.isInAngularZone())throw new Ln(909,!1)}static assertNotInAngularZone(){if(io.isInAngularZone())throw new Ln(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,a=s.scheduleEventTask("NgZoneEvent: "+r,e,bP,I_,I_);try{return s.runTask(a,t,i)}finally{s.cancelTask(a)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const bP={};function UM(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function c(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function h(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function m(n){n._nesting--,UM(n)}class M{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ls,this.onMicrotaskEmpty=new Ls,this.onStable=new Ls,this.onError=new Ls}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}var de=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(de||{});const pe={destroy(){}};function Be(n,e){!e&&function W0(n){if(!Pp())throw new Ln(-203,!1)}();const t=e?.injector??pi(Al);if(!function d0(n){return"browser"===(n??pi(Al)).get(Kp)}(t))return pe;im("NgAfterNextRender");const i=t.get(ft),r=i.handler??=new Ke,s=e?.phase??de.MixedReadWrite,a=()=>{r.unregister(d),l()},l=t.get(Uc).onDestroy(a),d=El(t,()=>new Le(s,()=>{a(),n()}));return r.register(d),{destroy:a}}class Le{constructor(e,t){this.phase=e,this.callbackFn=t,this.zone=pi(io),this.errorHandler=pi(xl,{optional:!0}),pi(ob,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}}class Ke{constructor(){this.executingCallbacks=!1,this.buckets={[de.EarlyRead]:new Set,[de.Write]:new Set,[de.MixedReadWrite]:new Set,[de.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(const e of Object.values(this.buckets))for(const t of e)t.invoke();this.executingCallbacks=!1;for(const e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(const e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}}let ft=(()=>{class n{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){const t=[...this.internalCallbacks];this.internalCallbacks.length=0;for(const i of t)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}static#e=this.\u0275prov=qi({token:n,providedIn:"root",factory:()=>new n})}return n})();function Ti(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let a=0;a<e.length;a++){const l=e[a];"number"==typeof l?s=l:1==s?r=Qt(r,l):2==s&&(i=Qt(i,l+": "+e[++a]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}class ur extends p0{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Wo(e);return new Li(t,this.ngModule)}}function Yn(n){const e=[];for(const t in n){if(!n.hasOwnProperty(t))continue;const i=n[t];void 0!==i&&e.push({propName:Array.isArray(i)?i[0]:i,templateName:t})}return e}class rr{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=xh(i);const r=this.injector.get(e,NM,i);return r!==NM||t===NM?r:this.parentInjector.get(e,t,i)}}class Li extends f3{get inputs(){const e=this.componentDef,t=e.inputTransforms,i=Yn(e.inputs);if(null!==t)for(const r of i)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return i}get outputs(){return Yn(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function m1(n){return n.map(Ou).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,i,r){const s=Ye(null);try{let a=(r=r||this.ngModule)instanceof Rc?r:r?.injector;a&&null!==this.componentDef.getStandaloneInjector&&(a=this.componentDef.getStandaloneInjector(a)||a);const l=a?new rr(e,a):e,d=l.get(LM,null);if(null===d)throw new Ln(407,!1);const u=l.get(EN,null),S={rendererFactory:d,sanitizer:u,inlineEffectRunner:null,afterRenderEventManager:l.get(ft,null),changeDetectionScheduler:l.get(ob,null)},R=d.createRenderer(null,this.componentDef),H=this.componentDef.selectors[0][0]||"div",re=i?function ay(n,e,t,i){const s=i.get(nu,!1)||t===Ad.ShadowDom,a=n.selectRootElement(e,s);return function ly(n){cy(n)}(a),a}(R,i,this.componentDef.encapsulation,l):Uv(R,H,function Di(n){const e=n.toLowerCase();return"svg"===e?Jc:"math"===e?"math":null}(H));let se=512;this.componentDef.signals?se|=4096:this.componentDef.onPush||(se|=16);let ce=null;null!==re&&(ce=Qn(re,l,!0));const Te=S_(0,null,null,1,0,null,null,null,null,null,null),Ce=mM(null,Te,null,se,null,null,S,R,l,null,ce);let qe,wt;Qg(Ce);try{const gt=this.componentDef;let Et,Xt=null;gt.findHostDirectiveDefs?(Et=[],Xt=new Map,gt.findHostDirectiveDefs(gt,Et,Xt),Et.push(gt)):Et=[gt];const Un=function Ji(n,e){const t=n[Gr],i=Cs;return n[i]=e,$A(t,i,2,"#host",null)}(Ce,re),Ct=function lr(n,e,t,i,r,s,a){const l=r[Gr];!function ei(n,e,t,i){for(const r of n)e.mergedAttrs=Mp(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(Ti(e,e.mergedAttrs,!0),null!==t&&C_(i,t,e))}(i,n,e,a);let d=null;null!==e&&(d=Qn(e,r[$c]));const u=s.rendererFactory.createRenderer(e,t);let p=16;t.signals?p=4096:t.onPush&&(p=64);const _=mM(r,M_(t),null,p,r[n.index],n,s,u,null,null,d);return l.firstCreatePass&&Xv(l,n,i.length-1),dy(r,_),r[n.index]=_}(Un,re,gt,Et,Ce,S,R);wt=BA(Te,Cs),re&&function as(n,e,t,i){if(i)Dg(n,t,["ng-version","17.3.1"]);else{const{attrs:r,classes:s}=function nh(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!vu(r))break;r=s}i++}return{attrs:e,classes:t}}(e.selectors[0]);r&&Dg(n,t,r),s&&s.length>0&&fM(n,t,s.join(" "))}}(R,gt,re,i),void 0!==t&&function xs(n,e,t){const i=n.projection=[];for(let r=0;r<e.length;r++){const s=t[r];i.push(null!=s?Array.from(s):null)}}(wt,this.ngContentSelectors,t),qe=function sr(n,e,t,i,r,s){const a=Ha(),l=r[Gr],d=Pd(a,r);gM(l,r,a,t,null,i);for(let p=0;p<t.length;p++)Hr(Gu(r,l,a.directiveStart+p,a),r);$v(l,r,a),d&&Hr(d,r);const u=Gu(r,l,a.directiveStart+a.componentOffset,a);if(n[Ka]=r[Ka]=u,null!==s)for(const p of s)p(u,e);return Wv(l,a,r),u}(Ct,gt,Et,Xt,Ce,[Ds]),SM(Te,Ce,null)}finally{a_()}return new br(this.componentType,qe,qm(wt,Ce),Ce,wt)}finally{Ye(s)}}}class br extends ab{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new gw(r,void 0,!1),this.componentType=e}setInput(e,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const s=this._rootLView;MM(s[Gr],s,r,e,t),this.previousInputValues.set(e,t),eb(Rd(this._tNode.index,s))}}get injector(){return new cc(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function Ds(){const n=Ha();mf(Zi()[Gr],n)}let fs=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=eo}return n})();function eo(){return _n(Ha(),Zi())}const er=fs,Lr=class extends er{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return qm(this._hostTNode,this._hostLView)}get injector(){return new cc(this._hostTNode,this._hostLView)}get parentInjector(){const e=h_(this._hostTNode,this._hostLView);if(Yg(e)){const t=Kg(e,this._hostLView),i=LA(e);return new cc(t[Gr].data[i+8],t)}return new cc(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=yr(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-Ia}createEmbeddedView(e,t,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const a=yy(this._lContainer,e.ssrId),l=e.createEmbeddedViewImpl(t||{},s,a);return this.insertImpl(l,r,hy(this._hostTNode,a)),l}createComponent(e,t,i,r,s){const a=e&&!function Fg(n){return"function"==typeof n}(e);let l;if(a)l=t;else{const H=t||{};l=H.index,i=H.injector,r=H.projectableNodes,s=H.environmentInjector||H.ngModuleRef}const d=a?e:new Li(Wo(e)),u=i||this.parentInjector;if(!s&&null==d.ngModule){const re=(a?u:this.parentInjector).get(Rc,null);re&&(s=re)}const p=Wo(d.componentType??{}),_=yy(this._lContainer,p?.id??null),R=d.create(u,r,_?.firstChild??null,s);return this.insertImpl(R.hostView,l,hy(this._hostTNode,_)),R}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,i){const r=e._lView;if(function hf(n){return dl(n[ml])}(r)){const l=this.indexOf(e);if(-1!==l)this.detach(l);else{const d=r[ml],u=new Lr(d,d[oc],d[ml]);u.detach(u.indexOf(e))}}const s=this._adjustIndex(t),a=this._lContainer;return Zv(a,r,s,i),e.attachToViewContainerRef(),Sg(vr(a),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=yr(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=jA(this._lContainer,t);i&&(Qf(vr(this._lContainer),t),ny(i[Gr],i))}detach(e){const t=this._adjustIndex(e,-1),i=jA(this._lContainer,t);return i&&null!=Qf(vr(this._lContainer),t)?new gw(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function yr(n){return n[8]}function vr(n){return n[8]||(n[8]=[])}function _n(n,e){let t;const i=e[n.index];return dl(i)?t=i:(t=bM(i,e,null,n),e[n.index]=t,dy(e,t)),si(t,e,n,i),new Lr(t,n,e)}let si=function es(n,e,t,i){if(n[oh])return;let r;r=8&t.type?oa(i):function Ki(n,e){const t=n[Mo],i=t.createComment(""),r=Pd(e,n);return w_(t,iy(t,r),i,function XB(n,e){return n.nextSibling(e)}(t,r),!1),i}(e,t),n[oh]=r},Ri=()=>!1;class co{constructor(e){this.queryList=e,this.matches=null}clone(){return new co(this.queryList)}setDirty(){this.queryList.setDirty()}}class _s{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const a=t.getByIndex(s);r.push(this.queries[a.indexInDeclarationView].clone())}return new _s(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==Ps(e,t).matches&&this.queries[t].setDirty()}}class $t{constructor(e,t,i=null){this.flags=t,this.read=i,this.predicate="string"==typeof e?function Ao(n){return n.split(",").map(e=>e.trim())}(e):e}}class Pt{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new Pt(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class ni{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new ni(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1&~this.metadata.flags){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,cr(t,s)),this.matchTNodeWithReadOption(e,t,vs(t,e,s,!1,!1))}else i===Ud?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,vs(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===oo||r===fs||r===Ud&&4&t.type)this.addMatch(t.index,-2);else{const s=vs(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function cr(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function Br(n,e,t,i){return-1===t?function Ar(n,e){return 11&n.type?qm(n,e):4&n.type?T_(n,e):null}(e,n):-2===t?function ks(n,e,t){return t===oo?qm(e,n):t===Ud?T_(e,n):t===fs?_n(e,n):void 0}(n,e,i):Gu(n,n[Gr],t,e)}function Ir(n,e,t,i){const r=e[bc].queries[i];if(null===r.matches){const s=n.data,a=t.matches,l=[];for(let d=0;null!==a&&d<a.length;d+=2){const u=a[d];l.push(u<0?null:Br(e,s[u],a[d+1],t.metadata.read))}r.matches=l}return r.matches}function ts(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const a=Ir(n,e,r,t);for(let l=0;l<s.length;l+=2){const d=s[l];if(d>0)i.push(a[l/2]);else{const u=s[l+1],p=e[-d];for(let _=Ia;_<p.length;_++){const S=p[_];S[Rl]===S[ml]&&ts(S[Gr],S,u,i)}if(null!==p[cs]){const _=p[cs];for(let S=0;S<_.length;S++){const R=_[S];ts(R[Gr],R,u,i)}}}}}return i}function Vr(n,e,t){const i=new _f(!(4&~t));return function jv(n,e,t,i){const r=CM(e);r.push(t),n.firstCreatePass&&uy(n).push(i,r.length-1)}(n,e,i,i.destroy),(e[bc]??=new _s).queries.push(new co(i))-1}function fo(n,e,t){null===n.queries&&(n.queries=new Pt),n.queries.track(new ni(e,t))}function Ps(n,e){return n.queries.getByIndex(e)}function _a(n,e){const t=n[Gr],i=Ps(t,e);return i.crossesNgTemplate?ts(t,n,e,[]):Ir(t,n,i,e)}function xo(n){return function Kn(n){return"function"==typeof n&&void 0!==n[ot]}(n)&&"function"==typeof n.set}function Lo(n){let e=function xw(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(Hl(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Ln(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);const a=n;a.inputs=b3(n.inputs),a.inputTransforms=b3(n.inputTransforms),a.declaredInputs=b3(n.declaredInputs),a.outputs=b3(n.outputs);const l=r.hostBindings;l&&LX(n,l);const d=r.viewQuery,u=r.contentQueries;if(d&&FX(n,d),u&&OX(n,u),v3(n,r),at(n.outputs,r.outputs),Hl(r)&&r.data.animation){const p=n.data;p.animation=(p.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let a=0;a<s.length;a++){const l=s[a];l&&l.ngInherit&&l(n),l===Lo&&(t=!1)}}e=Object.getPrototypeOf(e)}!function kX(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Mp(r.hostAttrs,t=Mp(t,r.hostAttrs))}}(i)}function v3(n,e){for(const t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;const i=e.inputs[t];if(void 0!==i&&(n.inputs[t]=i,n.declaredInputs[t]=e.declaredInputs[t],null!==e.inputTransforms)){const r=Array.isArray(i)?i[0]:i;if(!e.inputTransforms.hasOwnProperty(r))continue;n.inputTransforms??={},n.inputTransforms[r]=e.inputTransforms[r]}}}function b3(n){return n===wh?{}:n===za?[]:n}function FX(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function OX(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function LX(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}function ql(n){const e=n.inputConfig,t={};for(const i in e)if(e.hasOwnProperty(i)){const r=e[i];Array.isArray(r)&&r[3]&&(t[i]=r[3])}n.inputTransforms=t}class db{}class RN{}class SP extends db{constructor(e,t,i){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new ur(this);const r=Bc(e);this._bootstrapComponents=Cu(r.bootstrap),this._r3Injector=gf(e,t,[{provide:db,useValue:this},{provide:p0,useValue:this.componentFactoryResolver},...i],ht(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class EP extends RN{constructor(e){super(),this.moduleType=e}create(e){return new SP(this.moduleType,e,[])}}class kN extends db{constructor(e){super(),this.componentFactoryResolver=new ur(this),this.instance=null;const t=new jc([...e.providers,{provide:db,useValue:this},{provide:p0,useValue:this.componentFactoryResolver}],e.parent||bo(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function x3(n,e,t=null){return new kN({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}let vy=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new dn(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function C3(n){return!!TP(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function TP(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function A0(n,e,t){return n[e]=t}function Hd(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function ub(n,e,t,i){const r=Hd(n,e,t);return Hd(n,e+1,i)||r}function zs(n,e,t,i,r,s,a,l){const d=Zi(),u=wa(),p=n+Cs,_=u.firstCreatePass?function YX(n,e,t,i,r,s,a,l,d){const u=e.consts,p=$A(e,n,4,a||null,Vu(u,l));cw(e,t,p,Vu(u,d)),mf(e,p);const _=p.tView=S_(2,p,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,u,null);return null!==e.queries&&(e.queries.template(e,p),_.queries=e.queries.embeddedTView(p)),p}(p,u,d,e,t,i,r,s,a):u.data[p];uh(_,!1);const S=FN(u,d,_,n);Nm()&&iw(u,d,S,_),Hr(S,d);const R=bM(S,d,S,_);return d[p]=R,dy(d,R),function Ii(n,e,t){return Ri(n,e,t)}(R,_,d),zl(_)&&Mu(u,d,_),null!=a&&f0(d,_,l),zs}let FN=function ON(n,e,t,i){return Za(!0),e[Mo].createComment("")};function sl(n,e,t,i){const r=Zi();return Hd(r,fh(),e)&&(wa(),hp(gl(),r,n,e,t,i)),sl}function Bw(n,e,t,i,r,s){const l=ub(n,function hh(){return Gs.lFrame.bindingIndex}(),t,r);return pf(2),l?e+go(t)+i+go(r)+s:ca}function Nw(n,e,t,i,r,s,a,l){const d=Zi(),u=Bw(d,e,t,i,r,s);return u!==ca&&hp(gl(),d,n,u,a,l),Nw}function B3(n,e){return n<<17|e<<2}function xy(n){return n>>17&32767}function NP(n){return 2|n}function fb(n){return(131068&n)>>2}function UP(n,e){return-131069&n|e<<2}function zP(n){return 1|n}function h8(n,e,t,i){const r=n[t+1],s=null===e;let a=i?xy(r):fb(r),l=!1;for(;0!==a&&(!1===l||s);){const u=n[a+1];kY(n[a],e)&&(l=!0,n[a+1]=i?zP(u):NP(u)),a=i?xy(u):fb(u)}l&&(n[t+1]=i?NP(r):zP(r))}function kY(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&vl(n,e)>=0}const Eu={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function f8(n){return n.substring(Eu.key,Eu.keyEnd)}function FY(n){return n.substring(Eu.value,Eu.valueEnd)}function p8(n,e){const t=Eu.textEnd;return t===e?-1:(e=Eu.keyEnd=function NY(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}(n,Eu.key=e,t),Uw(n,e,t))}function m8(n,e){const t=Eu.textEnd;let i=Eu.key=Uw(n,e,t);return t===i?-1:(i=Eu.keyEnd=function UY(n,e,t){let i;for(;e<t&&(45===(i=n.charCodeAt(e))||95===i||(-33&i)>=65&&(-33&i)<=90||i>=48&&i<=57);)e++;return e}(n,i,t),i=g8(n,i,t),i=Eu.value=Uw(n,i,t),i=Eu.valueEnd=function zY(n,e,t){let i=-1,r=-1,s=-1,a=e,l=a;for(;a<t;){const d=n.charCodeAt(a++);if(59===d)return l;34===d||39===d?l=a=_8(n,d,a,t):e===a-4&&85===s&&82===r&&76===i&&40===d?l=a=_8(n,41,a,t):d>32&&(l=a),s=r,r=i,i=-33&d}return l}(n,i,t),g8(n,i,t))}function A8(n){Eu.key=0,Eu.keyEnd=0,Eu.value=0,Eu.valueEnd=0,Eu.textEnd=n.length}function Uw(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function g8(n,e,t,i){return(e=Uw(n,e,t))<t&&e++,e}function _8(n,e,t,i){let r=-1,s=t;for(;s<i;){const a=n.charCodeAt(s++);if(a==e&&92!==r)return s;r=92==a&&92===r?0:a}throw new Error}function Hn(n,e,t){const i=Zi();return Hd(i,fh(),e)&&Su(wa(),gl(),i,n,e,i[Mo],t,!1),Hn}function HP(n,e,t,i,r){const a=r?"class":"style";MM(n,t,e.inputs[a],a,i)}function XM(n,e,t){return eg(n,e,t,!1),XM}function Ja(n,e){return eg(n,e,null,!0),Ja}function HY(n,e){for(let t=function LY(n){return A8(n),m8(n,Uw(n,0,Eu.textEnd))}(e);t>=0;t=m8(e,t))b8(n,f8(e),FY(e))}function B_(n){tg(jY,g0,n,!0)}function g0(n,e){for(let t=function OY(n){return A8(n),p8(n,Uw(n,0,Eu.textEnd))}(e);t>=0;t=p8(e,t))Yl(n,f8(e),!0)}function eg(n,e,t,i){const r=Zi(),s=wa(),a=pf(2);s.firstUpdatePass&&v8(s,n,a,i),e!==ca&&Hd(r,a,e)&&x8(s,s.data[Lc()],r,r[Mo],n,r[a+1]=function XY(n,e){return null==n||""===n||("string"==typeof e?n+=e:"object"==typeof n&&(n=ht(Sa(n)))),n}(e,t),i,a)}function tg(n,e,t,i){const r=wa(),s=pf(2);r.firstUpdatePass&&v8(r,null,s,i);const a=Zi();if(t!==ca&&Hd(a,s,t)){const l=r.data[Lc()];if(C8(l,i)&&!y8(r,s)){let d=i?l.classesWithoutHost:l.stylesWithoutHost;null!==d&&(t=Qt(d,t||"")),HP(r,l,a,t,i)}else!function $Y(n,e,t,i,r,s,a,l){r===ca&&(r=za);let d=0,u=0,p=0<r.length?r[0]:null,_=0<s.length?s[0]:null;for(;null!==p||null!==_;){const S=d<r.length?r[d+1]:void 0,R=u<s.length?s[u+1]:void 0;let re,H=null;p===_?(d+=2,u+=2,S!==R&&(H=_,re=R)):null===_||null!==p&&p<_?(d+=2,H=p):(u+=2,H=_,re=R),null!==H&&x8(n,e,t,i,H,re,a,l),p=d<r.length?r[d]:null,_=u<s.length?s[u]:null}}(r,l,a,a[Mo],a[s+1],a[s+1]=function WY(n,e,t){if(null==t||""===t)return za;const i=[],r=Sa(t);if(Array.isArray(r))for(let s=0;s<r.length;s++)n(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&n(i,s,r[s]);else"string"==typeof r&&e(i,r);return i}(n,e,t),i,s)}}function y8(n,e){return e>=n.expandoStartIndex}function v8(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[Lc()],a=y8(n,t);C8(s,i)&&null===e&&!a&&(e=!1),e=function VY(n,e,t,i){const r=function n_(n){const e=Gs.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=YM(t=VP(null,n,e,t,i),e.attrs,i),s=null);else{const a=e.directiveStylingLast;if(-1===a||n[a]!==r)if(t=VP(r,n,e,t,i),null===s){let d=function GY(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==fb(i))return n[xy(i)]}(n,e,i);void 0!==d&&Array.isArray(d)&&(d=VP(null,n,e,d[1],i),d=YM(d,e.attrs,i),function qY(n,e,t,i){n[xy(t?e.classBindings:e.styleBindings)]=i}(n,e,i,d))}else s=function QY(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=YM(i,n[s].hostAttrs,t);return YM(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function PY(n,e,t,i,r,s){let a=s?e.classBindings:e.styleBindings,l=xy(a),d=fb(a);n[i]=t;let p,u=!1;if(Array.isArray(t)?(p=t[1],(null===p||vl(t,p)>0)&&(u=!0)):p=t,r)if(0!==d){const S=xy(n[l+1]);n[i+1]=B3(S,l),0!==S&&(n[S+1]=UP(n[S+1],i)),n[l+1]=function IY(n,e){return 131071&n|e<<17}(n[l+1],i)}else n[i+1]=B3(l,0),0!==l&&(n[l+1]=UP(n[l+1],i)),l=i;else n[i+1]=B3(d,0),0===l?l=i:n[d+1]=UP(n[d+1],i),d=i;u&&(n[i+1]=NP(n[i+1])),h8(n,p,i,!0),h8(n,p,i,!1),function RY(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&vl(s,e)>=0&&(t[i+1]=zP(t[i+1]))}(e,p,n,i,s),a=B3(l,d),s?e.classBindings=a:e.styleBindings=a}(r,s,e,t,a,i)}}function VP(n,e,t,i,r){let s=null;const a=t.directiveEnd;let l=t.directiveStylingLast;for(-1===l?l=t.directiveStart:l++;l<a&&(s=e[l],i=YM(i,s.hostAttrs,r),s!==n);)l++;return null!==n&&(t.directiveStylingLast=l),i}function YM(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const a=e[s];"number"==typeof a?r=a:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Yl(n,a,!!t||e[++s]))}return void 0===n?null:n}function b8(n,e,t){Yl(n,e,Sa(t))}function jY(n,e,t){const i=String(e);""!==i&&!i.includes(" ")&&Yl(n,i,t)}function x8(n,e,t,i,r,s,a,l){if(!(3&e.type))return;const d=n.data,u=d[l+1],p=function BY(n){return!(1&~n)}(u)?w8(d,e,t,r,fb(u),a):void 0;P3(p)||(P3(s)||function DY(n){return!(2&~n)}(u)&&(s=w8(d,null,t,r,l,a)),function kT(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let s=-1===i.indexOf("-")?void 0:u0.DashCase;null==r?n.removeStyle(t,i,s):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=u0.Important),n.setStyle(t,i,r,s))}}(i,a,IA(Lc(),t),r,s))}function w8(n,e,t,i,r,s){const a=null===e;let l;for(;r>0;){const d=n[r],u=Array.isArray(d),p=u?d[1]:d,_=null===p;let S=t[r+1];S===ca&&(S=_?za:void 0);let R=_?Yd(S,i):p===i?S:void 0;if(u&&!P3(R)&&(R=Yd(d,i)),P3(R)&&(l=R,a))return l;const H=n[r+1];r=a?xy(H):fb(H)}if(null!==e){let d=s?e.residualClasses:e.residualStyles;null!=d&&(l=Yd(d,i))}return l}function P3(n){return void 0!==n}function C8(n,e){return!!(n.flags&(e?8:16))}class oK{destroy(e){}updateValue(e,t){}swap(e,t){const i=Math.min(e,t),r=Math.max(e,t),s=this.detach(r);if(r-i>1){const a=this.detach(i);this.attach(i,s),this.attach(r,a)}else this.attach(i,s)}move(e,t){this.attach(t,this.detach(e))}}function GP(n,e,t,i,r){return n===t&&Object.is(e,i)?1:Object.is(r(n,e),r(t,i))?-1:0}function qP(n,e,t,i){return!(void 0===e||!e.has(i)||(n.attach(t,e.get(i)),e.delete(i),0))}function M8(n,e,t,i,r){if(qP(n,e,i,t(i,r)))n.updateValue(i,r);else{const s=n.create(i,r);n.attach(i,s)}}function S8(n,e,t,i){const r=new Set;for(let s=e;s<=t;s++)r.add(i(s,n.at(s)));return r}class E8{constructor(){this.kvMap=new Map,this._vMap=void 0}has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;const t=this.kvMap.get(e);return void 0!==this._vMap&&this._vMap.has(t)?(this.kvMap.set(e,this._vMap.get(t)),this._vMap.delete(t)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,t){if(this.kvMap.has(e)){let i=this.kvMap.get(e);void 0===this._vMap&&(this._vMap=new Map);const r=this._vMap;for(;r.has(i);)i=r.get(i);r.set(i,t)}else this.kvMap.set(e,t)}forEach(e){for(let[t,i]of this.kvMap)if(e(i,t),void 0!==this._vMap){const r=this._vMap;for(;r.has(i);)i=r.get(i),e(i,t)}}}function P_(n,e,t){im("NgControlFlow");const i=Zi(),r=fh(),s=QP(i,Cs+n);if(Hd(i,r,e)){const l=Ye(null);try{if(hw(s,0),-1!==e){const d=WP(i[Gr],Cs+e),u=yy(s,d.tView.ssrId);Zv(s,Yv(i,d,t,{dehydratedView:u}),0,hy(d,u))}}finally{Ye(l)}}else{const l=Kv(s,0);void 0!==l&&(l[Ka]=t)}}class lK{constructor(e,t,i){this.lContainer=e,this.$implicit=t,this.$index=i}get $count(){return this.lContainer.length-Ia}}function R3(n,e){return e}class dK{constructor(e,t,i){this.hasEmptyBlock=e,this.trackByFn=t,this.liveCollection=i}}class uK extends oK{constructor(e,t,i){super(),this.lContainer=e,this.hostLView=t,this.templateTNode=i,this.needsIndexUpdate=!1}get length(){return this.lContainer.length-Ia}at(e){return this.getLView(e)[Ka].$implicit}attach(e,t){const i=t[Ul];this.needsIndexUpdate||=e!==this.length,Zv(this.lContainer,t,e,hy(this.templateTNode,i))}detach(e){return this.needsIndexUpdate||=e!==this.length-1,function hK(n,e){return jA(n,e)}(this.lContainer,e)}create(e,t){const i=yy(this.lContainer,this.templateTNode.tView.ssrId);return Yv(this.hostLView,this.templateTNode,new lK(this.lContainer,t,e),{dehydratedView:i})}destroy(e){ny(e[Gr],e)}updateValue(e,t){this.getLView(e)[Ka].$implicit=t}reset(){this.needsIndexUpdate=!1}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[Ka].$index=e}getLView(e){return function fK(n,e){return Kv(n,e)}(this.lContainer,e)}}function QP(n,e){return n[e]}function WP(n,e){return BA(n,e)}function zt(n,e,t,i){const r=Zi(),s=wa(),a=Cs+n,l=r[Mo],d=s.firstCreatePass?function pK(n,e,t,i,r,s){const a=e.consts,d=$A(e,n,2,i,Vu(a,r));return cw(e,t,d,Vu(a,s)),null!==d.attrs&&Ti(d,d.attrs,!1),null!==d.mergedAttrs&&Ti(d,d.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,d),d}(a,s,r,e,t,i):s.data[a],u=T8(s,r,d,l,e,n);r[a]=u;const p=zl(d);return uh(d,!0),C_(l,u,d),!function QM(n){return!(32&~n.flags)}(d)&&Nm()&&iw(s,r,u,d),0===function ja(){return Gs.lFrame.elementDepthCount}()&&Hr(u,r),function fv(){Gs.lFrame.elementDepthCount++}(),p&&(Mu(s,r,d),Wv(s,d,r)),null!==i&&f0(r,d),zt}function an(){let n=Ha();kA()?Vg():(n=n.parent,uh(n,!1));const e=n;(function w1(n){return Gs.skipHydrationRootTNode===n})(e)&&function Hg(){Gs.skipHydrationRootTNode=null}(),function PA(){Gs.lFrame.elementDepthCount--}();const t=wa();return t.firstCreatePass&&(mf(t,n),MA(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function $g(n){return!!(8&n.flags)}(e)&&HP(t,e,Zi(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function Xg(n){return!!(16&n.flags)}(e)&&HP(t,e,Zi(),e.stylesWithoutHost,!1),an}function Fr(n,e,t,i){return zt(n,e,t,i),an(),Fr}let T8=(n,e,t,i,r,s)=>(Za(!0),Uv(i,r,function B1(){return Gs.lFrame.currentNamespace}()));function ng(n,e,t){const i=Zi(),r=wa(),s=n+Cs,a=r.firstCreatePass?function gK(n,e,t,i,r){const s=e.consts,a=Vu(s,i),l=$A(e,n,8,"ng-container",a);return null!==a&&Ti(l,a,!0),cw(e,t,l,Vu(s,r)),null!==e.queries&&e.queries.elementStart(e,l),l}(s,r,i,e,t):r.data[s];uh(a,!0);const l=D8(r,i,a,n);return i[s]=l,Nm()&&iw(r,i,l,a),Hr(l,i),zl(a)&&(Mu(r,i,a),Wv(r,a,i)),null!=t&&f0(i,a),ng}function ig(){let n=Ha();const e=wa();return kA()?Vg():(n=n.parent,uh(n,!1)),e.firstCreatePass&&(mf(e,n),MA(n)&&e.queries.elementEnd(n)),ig}function zw(n,e,t){return ng(n,e,t),ig(),zw}let D8=(n,e,t,i)=>(Za(!0),ty(e[Mo],""));function ta(){return Zi()}function Hw(n,e,t){const i=Zi();return Hd(i,fh(),e)&&Su(wa(),gl(),i,n,e,i[Mo],t,!0),Hw}const pb=void 0;var bK=["en",[["a","p"],["AM","PM"],pb],[["AM","PM"],pb,pb],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],pb,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],pb,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",pb,"{1} 'at' {0}",pb],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function vK(n){const t=Math.floor(Math.abs(n)),i=n.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===i?1:5}];let Vw={};function Mf(n){const e=function xK(n){return n.toLowerCase().replace(/_/g,"-")}(n);let t=P8(e);if(t)return t;const i=e.split("-")[0];if(t=P8(i),t)return t;if("en"===i)return bK;throw new Ln(701,!1)}function P8(n){return n in Vw||(Vw[n]=wn.ng&&wn.ng.common&&wn.ng.common.locales&&wn.ng.common.locales[n]),Vw[n]}var Mc=function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n}(Mc||{});const Gw="en-US";let R8=Gw;function Ai(n,e,t,i){const r=Zi(),s=wa(),a=Ha();return XP(s,r,r[Mo],a,n,e,i),Ai}function XP(n,e,t,i,r,s,a){const l=zl(i),u=n.firstCreatePass&&uy(n),p=e[Ka],_=CM(e);let S=!0;if(3&i.type||a){const re=Pd(i,e),se=a?a(re):re,ce=_.length,Te=a?qe=>a(oa(qe[i.index])):i.index;let Ce=null;if(!a&&l&&(Ce=function _Z(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const a=r[s];if(a===t&&r[s+1]===i){const l=e[tf],d=r[s+2];return l.length>d?l[d]:null}"string"==typeof a&&(s+=2)}return null}(n,e,r,i.index)),null!==Ce)(Ce.__ngLastListenerFn__||Ce).__ngNextListenerFn__=s,Ce.__ngLastListenerFn__=s,S=!1;else{s=a6(i,e,p,s,!1);const qe=t.listen(se,r,s);_.push(s,qe),u&&u.push(r,Te,ce,ce+1)}}else s=a6(i,e,p,s,!1);const R=i.outputs;let H;if(S&&null!==R&&(H=R[r])){const re=H.length;if(re)for(let se=0;se<re;se+=2){const wt=e[H[se]][H[se+1]].subscribe(s),gt=_.length;_.push(s,wt),u&&u.push(r,i.index,gt,-(gt+1))}}}function o6(n,e,t,i){const r=Ye(null);try{return eu(6,e,t),!1!==t(i)}catch(s){return uw(n,s),!1}finally{eu(7,e,t),Ye(r)}}function a6(n,e,t,i,r){return function s(a){if(a===Function)return i;eb(n.componentOffset>-1?Rd(n.index,e):e);let d=o6(e,t,i,a),u=s.__ngNextListenerFn__;for(;u;)d=o6(e,t,u,a)&&d,u=u.__ngNextListenerFn__;return r&&!1===d&&a.preventDefault(),d}}function Pr(n=1){return function OA(n){return(Gs.lFrame.contextLView=function K0(n,e){for(;n>0;)e=e[nf],n--;return e}(n,Gs.lFrame.contextLView))[Ka]}(n)}function yZ(n,e){let t=null;const i=function $f(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(!(1&t))return e[t+1]}return null}(n);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===i?jf(n,s,!0):il(i,s))return r}else t=r}return t}function vh(n){const e=Zi()[Yo][oc];if(!e.projection){const i=e.projection=function gc(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}(n?n.length:1,null),r=i.slice();let s=e.child;for(;null!==s;){const a=n?yZ(s,n):0;null!==a&&(r[a]?r[a].projectionNext=s:i[a]=s,r[a]=s),s=s.next}}}function ru(n,e=0,t){const i=Zi(),r=wa(),s=$A(r,Cs+n,16,null,t||null);null===s.projection&&(s.projection=e),Vg(),(!i[Ul]||Om())&&32&~s.flags&&function PT(n,e,t){hM(e[Mo],0,e,t,Zx(n,t,e),Vv(t.parent||e[oc],t,e))}(r,i,s)}function mp(n,e,t,i){!function Oo(n,e,t,i){const r=wa();if(r.firstCreatePass){const s=Ha();fo(r,new $t(e,t,i),s.index),function to(n,e){const t=n.contentQueries||(n.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(n.queries.length-1,e)}(r,n),!(2&~t)&&(r.staticContentQueries=!0)}return Vr(r,Zi(),t)}(n,e,t,i)}function _l(n,e,t){!function xr(n,e,t){const i=wa();return i.firstCreatePass&&(fo(i,new $t(n,e,t),-1),!(2&~e)&&(i.staticViewQueries=!0)),Vr(i,Zi(),e)}(n,e,t)}function pa(n){const e=Zi(),t=wa(),i=i_();FA(i+1);const r=Ps(t,i);if(n.dirty&&function X0(n){return!(4&~n[so])}(e)===!(2&~r.metadata.flags)){if(null===r.matches)n.reset([]);else{const s=_a(e,i);n.reset(s,Qm),n.notifyOnChanges()}return!0}return!1}function ma(){return function Nn(n,e){return n[bc].queries[e].queryList}(Zi(),i_())}function Ga(n){return km(function E1(){return Gs.lFrame.contextLView}(),Cs+n)}function Fi(n,e=""){const t=Zi(),i=wa(),r=n+Cs,s=i.firstCreatePass?$A(i,r,1,e,null):i.data[r],a=S6(i,t,s,e,n);t[r]=a,Nm()&&iw(i,t,a,s),uh(s,!1)}let S6=(n,e,t,i,r)=>(Za(!0),function oM(n,e){return n.createText(e)}(e[Mo],i));function tA(n){return yl("",n,""),tA}function yl(n,e,t){const i=Zi(),r=function Iw(n,e,t,i){return Hd(n,fh(),t)?e+go(t)+i:ca}(i,n,e,t);return r!==ca&&function YA(n,e,t){const i=IA(e,n);!function Cc(n,e,t){n.setValue(e,t)}(n[Mo],i,t)}(i,Lc(),r),yl}function qw(n,e,t){xo(e)&&(e=e());const i=Zi();return Hd(i,fh(),e)&&Su(wa(),gl(),i,n,e,i[Mo],t,!1),qw}function iS(n,e){const t=xo(n);return t&&n.set(e),t}function Qw(n,e){const t=Zi(),i=wa(),r=Ha();return XP(i,t,t[Mo],r,n,e),Qw}function KP(n,e,t,i,r){if(n=fn(n),Array.isArray(n))for(let s=0;s<n.length;s++)KP(n[s],e,t,i,r);else{const s=wa(),a=Zi(),l=Ha();let d=Ip(n)?n:fn(n.provide);const u=Em(n),p=1048575&l.providerIndexes,_=l.directiveStart,S=l.providerIndexes>>20;if(Ip(n)||!n.multi){const R=new rp(u,r,Lt),H=JP(d,e,r?p:p+S,_);-1===H?(k1(zm(l,a),s,d),ZP(s,n,e.length),e.push(d),l.directiveStart++,l.directiveEnd++,r&&(l.providerIndexes+=1048576),t.push(R),a.push(R)):(t[H]=R,a[H]=R)}else{const R=JP(d,e,p+S,_),H=JP(d,e,p,p+S),se=H>=0&&t[H];if(r&&!se||!r&&!(R>=0&&t[R])){k1(zm(l,a),s,d);const ce=function NZ(n,e,t,i,r){const s=new rp(n,t,Lt);return s.multi=[],s.index=e,s.componentProviders=0,F6(s,r,i&&!t),s}(r?LZ:OZ,t.length,r,i,u);!r&&se&&(t[H].providerFactory=ce),ZP(s,n,e.length,0),e.push(d),l.directiveStart++,l.directiveEnd++,r&&(l.providerIndexes+=1048576),t.push(ce),a.push(ce)}else ZP(s,n,R>-1?R:H,F6(t[r?H:R],u,!r&&i));!r&&i&&se&&t[H].componentProviders++}}}function ZP(n,e,t,i){const r=Ip(e),s=function dv(n){return!!n.useClass}(e);if(r||s){const d=(s?fn(e.useClass):e).prototype.ngOnDestroy;if(d){const u=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const p=u.indexOf(t);-1===p?u.push(t,[i,d]):u[p+1].push(i,d)}else u.push(t,d)}}}function F6(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function JP(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function OZ(n,e,t,i){return eR(this.multi,[])}function LZ(n,e,t,i){const r=this.multi;let s;if(this.providerFactory){const a=this.providerFactory.componentProviders,l=Gu(t,t[Gr],this.providerFactory.index,i);s=l.slice(0,a),eR(r,s);for(let d=a;d<l.length;d++)s.push(l[d])}else s=[],eR(r,s);return s}function eR(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function qo(n,e=[]){return t=>{t.providersResolver=(i,r)=>function FZ(n,e,t){const i=wa();if(i.firstCreatePass){const r=Hl(n);KP(t,i.data,i.blueprint,r,!0),KP(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}let UZ=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const i=Tp(0,t.type),r=i.length>0?x3([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=qi({token:n,providedIn:"environment",factory:()=>new n(xi(Rc))})}return n})();function yd(n){im("NgStandalone"),n.getStandaloneInjector=e=>e.get(UZ).getOrCreateStandaloneInjector(n)}function tR(n,e,t){const i=Yc()+n,r=Zi();return r[i]===ca?A0(r,i,t?e.call(t):e()):function qM(n,e){return n[e]}(r,i)}function Sf(n,e,t,i){return N6(Zi(),Yc(),n,e,t,i)}function H3(n,e,t,i,r){return U6(Zi(),Yc(),n,e,t,i,r)}function L6(n,e,t,i,r,s){return function z6(n,e,t,i,r,s,a,l){const d=e+t;return function M3(n,e,t,i,r){const s=ub(n,e,t,i);return Hd(n,e+2,r)||s}(n,d,r,s,a)?A0(n,d+3,l?i.call(l,r,s,a):i(r,s,a)):rS(n,d+3)}(Zi(),Yc(),n,e,t,i,r,s)}function rS(n,e){const t=n[e];return t===ca?void 0:t}function N6(n,e,t,i,r,s){const a=e+t;return Hd(n,a,r)?A0(n,a+1,s?i.call(s,r):i(r)):rS(n,a+1)}function U6(n,e,t,i,r,s,a){const l=e+t;return ub(n,l,r,s)?A0(n,l+2,a?i.call(a,r,s):i(r,s)):rS(n,l+2)}function sS(n,e){const t=wa();let i;const r=n+Cs;t.firstCreatePass?(i=function $Z(n,e){if(e)for(let t=e.length-1;t>=0;t--){const i=e[t];if(n===i.name)return i}}(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks??=[]).push(r,i.onDestroy)):i=t.data[r];const s=i.factory||(i.factory=md(i.type)),l=$d(Lt);try{const d=d_(!1),u=s();return d_(d),function wZ(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}(t,Zi(),r,u),u}finally{$d(l)}}function V3(n,e,t,i){const r=n+Cs,s=Zi(),a=km(s,r);return oS(s,r)?U6(s,Yc(),e,a.transform,t,i,a):a.transform(t,i)}function oS(n,e){return n[Gr].data[e].pure}function nR(n,e){return T_(n,e)}let sU=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();const dU=new Bi(""),Q3=new Bi("");let dR,lR=(()=>{class n{constructor(t,i,r){this._ngZone=t,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,dR||(function qJ(n){dR=n}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{io.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb()}});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1))}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==s),t()},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}static#e=this.\u0275fac=function(i){return new(i||n)(xi(io),xi(cR),xi(Q3))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac})}return n})(),cR=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return dR?.findTestabilityInTree(this,t,i)??null}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();function cS(n){return!!n&&"function"==typeof n.then}function uU(n){return!!n&&"function"==typeof n.subscribe}const uR=new Bi("");let hR=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i}),this.appInits=pi(uR,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const t=[];for(const r of this.appInits){const s=r();if(cS(s))t.push(s);else if(uU(s)){const a=new Promise((l,d)=>{s.subscribe({complete:l,error:d})});t.push(a)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const fR=new Bi("");function pU(n,e){return Array.isArray(e)?e.reduce(pU,n):{...n,...e}}let R_=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=pi(t0),this.afterRenderEffectManager=pi(ft),this.externalTestViews=new Set,this.beforeRender=new hn,this.afterTick=new hn,this.componentTypes=[],this.components=[],this.isStable=pi(vy).hasPendingTasks.pipe(bi(t=>!t)),this._injector=pi(Rc)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,i){const r=t instanceof f3;if(!this._injector.get(hR).done)throw!r&&function Sl(n){const e=Wo(n)||rl(n)||bl(n);return null!==e&&e.standalone}(t),new Ln(405,!1);let a;a=r?t:this._injector.get(p0).resolveComponentFactory(t),this.componentTypes.push(a.componentType);const l=function QJ(n){return n.isBoundToModule}(a)?void 0:this._injector.get(db),u=a.create(Al.NULL,[],i||a.selector,l),p=u.location.nativeElement,_=u.injector.get(dU,null);return _?.registerApplication(p),u.onDestroy(()=>{this.detachView(u.hostView),W3(this.components,u),_?.unregisterApplication(p)}),this._loadComponent(u),u}tick(){this._tick(!0)}_tick(t){if(this._runningTick)throw new Ln(101,!1);const i=Ye(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(t)}catch(r){this.internalErrorHandler(r)}finally{this.afterTick.next(),this._runningTick=!1,Ye(i)}}detectChangesInAttachedViews(t){let i=0;const r=this.afterRenderEffectManager;for(;;){if(i===EM)throw new Ln(103,!1);if(t){const s=0===i;this.beforeRender.next(s);for(let{_lView:a,notifyErrorHandler:l}of this._views)jJ(a,s,l)}if(i++,r.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:s})=>pR(s))&&(r.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:s})=>pR(s))))break}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;W3(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const i=this._injector.get(fR,[]);[...this._bootstrapListeners,...i].forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>W3(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new Ln(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function W3(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function jJ(n,e,t){!e&&!pR(n)||function $J(n,e,t){let i;t?(i=0,n[so]|=1024):i=64&n[so]?0:1,E_(n,e,i)}(n,t,e)}function pR(n){return Oc(n)}class XJ{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let mU=(()=>{class n{compileModuleSync(t){return new EP(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),s=Cu(Bc(t).declarations).reduce((a,l)=>{const d=Wo(l);return d&&a.push(new Li(d)),a},[]);return new XJ(i,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),ZJ=(()=>{class n{constructor(){this.zone=pi(io),this.applicationRef=pi(R_)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function JJ(){const n=pi(io),e=pi(xl);return t=>n.runOutsideAngular(()=>e.handleError(t))}let tee=(()=>{class n{constructor(){this.subscription=new rt,this.initialized=!1,this.zone=pi(io),this.pendingTasks=pi(vy)}initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{io.assertNotInAngularZone(),queueMicrotask(()=>{null!==t&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{io.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const _0=new Bi("",{providedIn:"root",factory:()=>pi(_0,va.Optional|va.SkipSelf)||function nee(){return typeof $localize<"u"&&$localize.locale||Gw}()}),mR=new Bi("");let yU=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const r=function q(n="zone.js",e){return"noop"===n?new M:"zone.js"===n?new io(e):n}(i?.ngZone,function _U(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return r.run(()=>{const s=function qX(n,e,t){return new SP(n,e,t)}(t.moduleType,this.injector,function gU(n){return[{provide:io,useFactory:n},{provide:zi,multi:!0,useFactory:()=>{const e=pi(ZJ,{optional:!0});return()=>e.initialize()}},{provide:zi,multi:!0,useFactory:()=>{const e=pi(tee);return()=>{e.initialize()}}},{provide:t0,useFactory:JJ}]}(()=>r)),a=s.injector.get(xl,null);return r.runOutsideAngular(()=>{const l=r.onError.subscribe({next:d=>{a.handleError(d)}});s.onDestroy(()=>{W3(this._modules,s),l.unsubscribe()})}),function fU(n,e,t){try{const i=t();return cS(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(a,r,()=>{const l=s.injector.get(hR);return l.runInitializers(),l.donePromise.then(()=>(function k8(n){"string"==typeof n&&(R8=n.toLowerCase().replace(/_/g,"-"))}(s.injector.get(_0,Gw)||Gw),this._moduleDoBootstrap(s),s))})})}bootstrapModule(t,i=[]){const r=pU({},i);return function KJ(n,e,t){const i=new EP(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(R_);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new Ln(-403,!1);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Ln(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(mR,null);t&&(t.forEach(i=>i()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(i){return new(i||n)(xi(Al))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})(),wy=null;const vU=new Bi("");function bU(n,e,t=[]){const i=`Platform: ${e}`,r=new Bi(i);return(s=[])=>{let a=AR();if(!a||a.injector.get(vU,!1)){const l=[...t,...s,{provide:r,useValue:!0}];n?n(l):function see(n){if(wy&&!wy.get(vU,!1))throw new Ln(400,!1);(function hU(){!function b(n){he=n}(()=>{throw new Ln(600,!1)})})(),wy=n;const e=n.get(yU);(function wU(n){n.get(Vx,null)?.forEach(t=>t())})(n)}(function xU(n=[],e){return Al.create({name:e,providers:[{provide:ih,useValue:"platform"},{provide:mR,useValue:new Set([()=>wy=null])},...n]})}(l,i))}return function oee(n){const e=AR();if(!e)throw new Ln(401,!1);return e}()}}function AR(){return wy?.get(yU)??null}let Sc=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=lee}return n})();function lee(n){return function cee(n,e,t){if(sf(n)&&!t){const i=Rd(n.index,e);return new gw(i,i)}return 47&n.type?new gw(e[Yo],e):null}(Ha(),Zi(),!(16&~n))}class TU{constructor(){}supports(e){return C3(e)}create(e){return new pee(e)}}const fee=(n,e)=>e;class pee{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||fee}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const a=!i||t&&t.currentIndex<IU(i,r,s)?t:i,l=IU(a,r,s),d=a.currentIndex;if(a===i)r--,i=i._nextRemoved;else if(t=t._next,null==a.previousIndex)r++;else{s||(s=[]);const u=l-r,p=d-r;if(u!=p){for(let S=0;S<u;S++){const R=S<s.length?s[S]:s[S]=0,H=R+S;p<=H&&H<u&&(s[S]=R+1)}s[a.previousIndex]=p-u}}l!==d&&e(a,l,d)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!C3(e))throw new Ln(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,a,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let l=0;l<this.length;l++)s=e[l],a=this._trackByFn(l,s),null!==t&&Object.is(t.trackById,a)?(i&&(t=this._verifyReinsertion(t,s,a,l)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,a,l),i=!0),t=t._next}else r=0,function $X(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Symbol.iterator]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,l=>{a=this._trackByFn(r,l),null!==t&&Object.is(t.trackById,a)?(i&&(t=this._verifyReinsertion(t,l,a,r)),Object.is(t.item,l)||this._addIdentityChange(t,l)):(t=this._mismatch(t,l,a,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new mee(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new DU),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new DU),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class mee{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Aee{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class DU{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new Aee,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function IU(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}class BU{constructor(){}supports(e){return e instanceof Map||TP(e)}create(){return new gee}}class gee{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||TP(e)))throw new Ln(900,!1)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,a=r._next;return s&&(s._next=a),a&&(a._prev=s),r._next=null,r._prev=null,r}const i=new _ee(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class _ee{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function PU(){return new $w([new TU])}let $w=(()=>{class n{static#e=this.\u0275prov=qi({token:n,providedIn:"root",factory:PU});constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||PU()),deps:[[n,new Xl,new cl]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new Ln(901,!1)}}return n})();function RU(){return new Y3([new BU])}let Y3=(()=>{class n{static#e=this.\u0275prov=qi({token:n,providedIn:"root",factory:RU});constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||RU()),deps:[[n,new Xl,new cl]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new Ln(901,!1)}}return n})();const bee=bU(null,"core",[]);let xee=(()=>{class n{constructor(t){}static#e=this.\u0275fac=function(i){return new(i||n)(xi(R_))};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({})}return n})();function _o(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}function su(n,e=NaN){return isNaN(parseFloat(n))||isNaN(Number(n))?e:Number(n)}let n7=null;function Cy(){return n7}class ste{}const ba=new Bi("");let wR=(()=>{class n{historyGo(t){throw new Error("")}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=qi({token:n,factory:()=>pi(ate),providedIn:"platform"})}return n})();const ote=new Bi("");let ate=(()=>{class n extends wR{constructor(){super(),this._doc=pi(ba),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Cy().getBaseHref(this._doc)}onPopState(t){const i=Cy().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=Cy().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=qi({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function CR(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function i7(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function k_(n){return n&&"?"!==n[0]?"?"+n:n}let gb=(()=>{class n{historyGo(t){throw new Error("")}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=qi({token:n,factory:()=>pi(s7),providedIn:"root"})}return n})();const r7=new Bi("");let s7=(()=>{class n extends gb{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??pi(ba).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return CR(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+k_(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const a=this.prepareExternalUrl(r+k_(s));this._platformLocation.pushState(t,i,a)}replaceState(t,i,r,s){const a=this.prepareExternalUrl(r+k_(s));this._platformLocation.replaceState(t,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(i){return new(i||n)(xi(wR),xi(r7,8))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),lte=(()=>{class n extends gb{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){const i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=CR(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,s){let a=this.prepareExternalUrl(r+k_(s));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.pushState(t,i,a)}replaceState(t,i,r,s){let a=this.prepareExternalUrl(r+k_(s));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(i){return new(i||n)(xi(wR),xi(r7,8))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac})}return n})(),_b=(()=>{class n{constructor(t){this._subject=new Ls,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function ute(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(i7(o7(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+k_(i))}normalize(t){return n.stripTrailingSlash(function dte(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,o7(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+k_(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+k_(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}static#e=this.normalizeQueryParams=k_;static#t=this.joinWithSlash=CR;static#n=this.stripTrailingSlash=i7;static#i=this.\u0275fac=function(i){return new(i||n)(xi(gb))};static#r=this.\u0275prov=qi({token:n,factory:()=>function cte(){return new _b(xi(gb))}(),providedIn:"root"})}return n})();function o7(n){return n.replace(/\/index.html$/,"")}var nD=function(n){return n[n.Decimal=0]="Decimal",n[n.Percent=1]="Percent",n[n.Currency=2]="Currency",n[n.Scientific=3]="Scientific",n}(nD||{});const ou={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function nA(n,e){const t=Mf(n),i=t[Mc.NumberSymbols][e];if(typeof i>"u"){if(e===ou.CurrencyDecimal)return t[Mc.NumberSymbols][ou.Decimal];if(e===ou.CurrencyGroup)return t[Mc.NumberSymbols][ou.Group]}return i}const Nte=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function PR(n){const e=parseInt(n);if(isNaN(e))throw new Error("Invalid integer literal when parsing "+n);return e}function m7(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}const kR=/\s+/,A7=[];let om=(()=>{class n{constructor(t,i){this._ngEl=t,this._renderer=i,this.initialClasses=A7,this.stateMap=new Map}set klass(t){this.initialClasses=null!=t?t.trim().split(kR):A7}set ngClass(t){this.rawClass="string"==typeof t?t.trim().split(kR):t}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(const i of t)this._updateState(i,!0);else if(null!=t)for(const i of Object.keys(t))this._updateState(i,!!t[i]);this._applyStateDiff()}_updateState(t,i){const r=this.stateMap.get(t);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(t,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const t of this.stateMap){const i=t[0],r=t[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(t,i){(t=t.trim()).length>0&&t.split(kR).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(oo),Lt(KA))};static#t=this.\u0275dir=Ft({type:n,selectors:[["","ngClass",""]],inputs:{klass:[mi.None,"class","klass"],ngClass:"ngClass"},standalone:!0})}return n})();class Yte{constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let am=(()=>{class n{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=this._viewContainer;t.forEachOperation((r,s,a)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new Yte(r.item,this._ngForOf,-1,-1),null===a?void 0:a);else if(null==a)i.remove(null===s?void 0:s);else if(null!==s){const l=i.get(s);i.move(l,a),_7(l,r)}});for(let r=0,s=i.length;r<s;r++){const l=i.get(r).context;l.index=r,l.count=s,l.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{_7(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,i){return!0}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(fs),Lt(Ud),Lt($w))};static#t=this.\u0275dir=Ft({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return n})();function _7(n,e){n.context.$implicit=e.item}let Lh=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new Kte,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){y7("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){y7("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(fs),Lt(Ud))};static#t=this.\u0275dir=Ft({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return n})();class Kte{constructor(){this.$implicit=null,this.ngIf=null}}function y7(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${ht(e)}'.`)}class FR{constructor(e,t){this._viewContainerRef=e,this._templateRef=t,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(e){e&&!this._created?this.create():!e&&this._created&&this.destroy()}}let fD=(()=>{class n{constructor(){this._defaultViews=[],this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(t){this._ngSwitch=t,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(t){this._defaultViews.push(t)}_matchCase(t){const i=t===this._ngSwitch;return this._lastCasesMatched||=i,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),i}_updateDefaultCases(t){if(this._defaultViews.length>0&&t!==this._defaultUsed){this._defaultUsed=t;for(const i of this._defaultViews)i.enforceState(t)}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275dir=Ft({type:n,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0})}return n})(),v7=(()=>{class n{constructor(t,i,r){this.ngSwitch=r,r._addCase(),this._view=new FR(t,i)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(fs),Lt(Ud),Lt(fD,9))};static#t=this.\u0275dir=Ft({type:n,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0})}return n})(),x7=(()=>{class n{constructor(t,i,r){this._ngEl=t,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){const t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,i){const[r,s]=t.split("."),a=-1===r.indexOf("-")?void 0:u0.DashCase;null!=i?this._renderer.setStyle(this._ngEl.nativeElement,r,s?`${i}${s}`:i,a):this._renderer.removeStyle(this._ngEl.nativeElement,r,a)}_applyChanges(t){t.forEachRemovedItem(i=>this._setStyle(i.key,null)),t.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),t.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(oo),Lt(Y3),Lt(KA))};static#t=this.\u0275dir=Ft({type:n,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0})}return n})(),w7=(()=>{class n{constructor(t){this._viewContainerRef=t,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(t){if(this._shouldRecreateView(t)){const i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),!this.ngTemplateOutlet)return void(this._viewRef=null);const r=this._createContextForwardProxy();this._viewRef=i.createEmbeddedView(this.ngTemplateOutlet,r,{injector:this.ngTemplateOutletInjector??void 0})}}_shouldRecreateView(t){return!!t.ngTemplateOutlet||!!t.ngTemplateOutletInjector}_createContextForwardProxy(){return new Proxy({},{set:(t,i,r)=>!!this.ngTemplateOutletContext&&Reflect.set(this.ngTemplateOutletContext,i,r),get:(t,i,r)=>{if(this.ngTemplateOutletContext)return Reflect.get(this.ngTemplateOutletContext,i,r)}})}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(fs))};static#t=this.\u0275dir=Ft({type:n,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[kl]})}return n})();let M7=(()=>{class n{constructor(t){this._locale=t}transform(t,i,r){if(!function OR(n){return!(null==n||""===n||n!=n)}(t))return null;r||=this._locale;try{return function qte(n,e,t){return function IR(n,e,t,i,r,s,a=!1){let l="",d=!1;if(isFinite(n)){let u=function Wte(n){let i,r,s,a,l,e=Math.abs(n)+"",t=0;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(s=e.search(/e/i))>0?(r<0&&(r=s),r+=+e.slice(s+1),e=e.substring(0,s)):r<0&&(r=e.length),s=0;"0"===e.charAt(s);s++);if(s===(l=e.length))i=[0],r=1;else{for(l--;"0"===e.charAt(l);)l--;for(r-=s,i=[],a=0;s<=l;s++,a++)i[a]=Number(e.charAt(s))}return r>22&&(i=i.splice(0,21),t=r-1,r=1),{digits:i,exponent:t,integerLen:r}}(n);a&&(u=function Qte(n){if(0===n.digits[0])return n;const e=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(0===e?n.digits.push(0,0):1===e&&n.digits.push(0),n.integerLen+=2),n}(u));let p=e.minInt,_=e.minFrac,S=e.maxFrac;if(s){const Te=s.match(Nte);if(null===Te)throw new Error(`${s} is not a valid digit info`);const Ce=Te[1],qe=Te[3],wt=Te[5];null!=Ce&&(p=PR(Ce)),null!=qe&&(_=PR(qe)),null!=wt?S=PR(wt):null!=qe&&_>S&&(S=_)}!function jte(n,e,t){if(e>t)throw new Error(`The minimum number of digits after fraction (${e}) is higher than the maximum (${t}).`);let i=n.digits,r=i.length-n.integerLen;const s=Math.min(Math.max(e,r),t);let a=s+n.integerLen,l=i[a];if(a>0){i.splice(Math.max(n.integerLen,a));for(let _=a;_<i.length;_++)i[_]=0}else{r=Math.max(0,r),n.integerLen=1,i.length=Math.max(1,a=s+1),i[0]=0;for(let _=1;_<a;_++)i[_]=0}if(l>=5)if(a-1<0){for(let _=0;_>a;_--)i.unshift(0),n.integerLen++;i.unshift(1),n.integerLen++}else i[a-1]++;for(;r<Math.max(0,s);r++)i.push(0);let d=0!==s;const u=e+n.integerLen,p=i.reduceRight(function(_,S,R,H){return H[R]=(S+=_)<10?S:S-10,d&&(0===H[R]&&R>=u?H.pop():d=!1),S>=10?1:0},0);p&&(i.unshift(p),n.integerLen++)}(u,_,S);let R=u.digits,H=u.integerLen;const re=u.exponent;let se=[];for(d=R.every(Te=>!Te);H<p;H++)R.unshift(0);for(;H<0;H++)R.unshift(0);H>0?se=R.splice(H,R.length):(se=R,R=[0]);const ce=[];for(R.length>=e.lgSize&&ce.unshift(R.splice(-e.lgSize,R.length).join(""));R.length>e.gSize;)ce.unshift(R.splice(-e.gSize,R.length).join(""));R.length&&ce.unshift(R.join("")),l=ce.join(nA(t,i)),se.length&&(l+=nA(t,r)+se.join("")),re&&(l+=nA(t,ou.Exponential)+"+"+re)}else l=nA(t,ou.Infinity);return l=n<0&&!d?e.negPre+l+e.negSuf:e.posPre+l+e.posSuf,l}(n,function BR(n,e="-"){const t={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},i=n.split(";"),r=i[0],s=i[1],a=-1!==r.indexOf(".")?r.split("."):[r.substring(0,r.lastIndexOf("0")+1),r.substring(r.lastIndexOf("0")+1)],l=a[0],d=a[1]||"";t.posPre=l.substring(0,l.indexOf("#"));for(let p=0;p<d.length;p++){const _=d.charAt(p);"0"===_?t.minFrac=t.maxFrac=p+1:"#"===_?t.maxFrac=p+1:t.posSuf+=_}const u=l.split(",");if(t.gSize=u[1]?u[1].length:0,t.lgSize=u[2]||u[1]?(u[2]||u[1]).length:0,s){const p=r.length-t.posPre.length-t.posSuf.length,_=s.indexOf("#");t.negPre=s.substring(0,_).replace(/'/g,""),t.negSuf=s.slice(_+p).replace(/'/g,"")}else t.negPre=e+t.posPre,t.negSuf=t.posSuf;return t}(function MR(n,e){return Mf(n)[Mc.NumberFormats][e]}(e,nD.Decimal),nA(e,ou.MinusSign)),e,ou.Group,ou.Decimal,t)}(function LR(n){if("string"==typeof n&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if("number"!=typeof n)throw new Error(`${n} is not a number`);return n}(t),r,i)}catch(s){throw function sg(n,e){return new Ln(2100,!1)}()}}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(_0,16))};static#t=this.\u0275pipe=Ic({name:"number",type:n,pure:!0,standalone:!0})}return n})();let fS=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({})}return n})();const S7="browser";function E7(n){return n===S7}function T7(n){return"server"===n}let Mne=(()=>{class n{static#e=this.\u0275prov=qi({token:n,providedIn:"root",factory:()=>E7(pi(Kp))?new Sne(pi(ba),window):new Tne})}return n})();class Sne{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){const t=function Ene(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&"function"==typeof n.body.attachShadow){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const a=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(a)return a}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}}class Tne{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}}class D7{}class nie extends ste{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class UR extends nie{static makeCurrent(){!function rte(n){n7??=n}(new UR)}onAndCancel(e,t,i){return e.addEventListener(t,i),()=>{e.removeEventListener(t,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function iie(){return AS=AS||document.querySelector("base"),AS?AS.getAttribute("href"):null}();return null==t?null:function rie(n){return new URL(n,document.baseURI).pathname}(t)}resetBaseElement(){AS=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return m7(document.cookie,e)}}let AS=null,oie=(()=>{class n{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac})}return n})();const zR=new Bi("");let N7=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(s=>s.supports(t)),!i)throw new Ln(5101,!1);return this._eventNameToPlugin.set(t,i),i}static#e=this.\u0275fac=function(i){return new(i||n)(xi(zR),xi(io))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac})}return n})();class U7{constructor(e){this._doc=e}}const HR="ng-app-id";let z7=(()=>{class n{constructor(t,i,r,s={}){this.doc=t,this.appId=i,this.nonce=r,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=T7(s),this.resetHostNodes()}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const t=this.styleNodesInDOM;t&&(t.forEach(i=>i.remove()),t.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.elements?.forEach(r=>r.remove()),i.delete(t)}collectServerRenderedStyles(){const t=this.doc.head?.querySelectorAll(`style[${HR}="${this.appId}"]`);if(t?.length){const i=new Map;return t.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(t,i){const r=this.styleRef;if(r.has(t)){const s=r.get(t);return s.usage+=i,s.usage}return r.set(t,{usage:i,elements:[]}),i}getStyleElement(t,i){const r=this.styleNodesInDOM,s=r?.get(i);if(s?.parentNode===t)return r.delete(i),s.removeAttribute(HR),s;{const a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(HR,this.appId),t.appendChild(a),a}}addStyleToHost(t,i){const r=this.getStyleElement(t,i),s=this.styleRef,a=s.get(i)?.elements;a?a.push(r):s.set(i,{elements:[r],usage:1})}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}static#e=this.\u0275fac=function(i){return new(i||n)(xi(ba),xi(y_),xi(Cv,8),xi(Kp))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac})}return n})();const VR={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},GR=/%COMP%/g,die=new Bi("",{providedIn:"root",factory:()=>!0});function V7(n,e){return e.map(t=>t.replace(GR,n))}let qR=(()=>{class n{constructor(t,i,r,s,a,l,d,u=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=s,this.doc=a,this.platformId=l,this.ngZone=d,this.nonce=u,this.rendererByCompId=new Map,this.platformIsServer=T7(l),this.defaultRenderer=new QR(t,a,d,this.platformIsServer)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Ad.ShadowDom&&(i={...i,encapsulation:Ad.Emulated});const r=this.getOrCreateRenderer(t,i);return r instanceof q7?r.applyToHost(t):r instanceof WR&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const a=this.doc,l=this.ngZone,d=this.eventManager,u=this.sharedStylesHost,p=this.removeStylesOnCompDestroy,_=this.platformIsServer;switch(i.encapsulation){case Ad.Emulated:s=new q7(d,u,i,this.appId,p,a,l,_);break;case Ad.ShadowDom:return new pie(d,u,t,i,a,l,this.nonce,_);default:s=new WR(d,u,i,p,a,l,_)}r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(i){return new(i||n)(xi(N7),xi(z7),xi(y_),xi(die),xi(ba),xi(Kp),xi(io),xi(Cv))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac})}return n})();class QR{constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(VR[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(G7(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(G7(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?this.doc.querySelector(e):e;if(!i)throw new Ln(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=VR[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=VR[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(u0.DashCase|u0.Important)?e.style.setProperty(t,i,r&u0.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&u0.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){null!=e&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i){if("string"==typeof e&&!(e=Cy().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(i))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function G7(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class pie extends QR{constructor(e,t,i,r,s,a,l,d){super(e,s,a,d),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const u=V7(r.id,r.styles);for(const p of u){const _=document.createElement("style");l&&_.setAttribute("nonce",l),_.textContent=p,this.shadowRoot.appendChild(_)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class WR extends QR{constructor(e,t,i,r,s,a,l,d){super(e,s,a,l),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=d?V7(d,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class q7 extends WR{constructor(e,t,i,r,s,a,l,d){const u=r+"-"+i.id;super(e,t,i,s,a,l,d,u),this.contentAttr=function uie(n){return"_ngcontent-%COMP%".replace(GR,n)}(u),this.hostAttr=function hie(n){return"_nghost-%COMP%".replace(GR,n)}(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}let mie=(()=>{class n extends U7{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}static#e=this.\u0275fac=function(i){return new(i||n)(xi(ba))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac})}return n})();const Q7=["alt","control","meta","shift"],Aie={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},gie={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let _ie=(()=>{class n extends U7{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),a=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Cy().onAndCancel(t,s.domEventName,a))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let a="",l=i.indexOf("code");if(l>-1&&(i.splice(l,1),a="code."),Q7.forEach(u=>{const p=i.indexOf(u);p>-1&&(i.splice(p,1),a+=u+".")}),a+=s,0!=i.length||0===s.length)return null;const d={};return d.domEventName=r,d.fullKey=a,d}static matchEventFullKeyCode(t,i){let r=Aie[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),Q7.forEach(a=>{a!==r&&(0,gie[a])(t)&&(s+=a+".")}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}static#e=this.\u0275fac=function(i){return new(i||n)(xi(ba))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac})}return n})();const xie=bU(bee,"browser",[{provide:Kp,useValue:S7},{provide:Vx,useValue:function yie(){UR.makeCurrent()},multi:!0},{provide:ba,useFactory:function bie(){return function VC(n){wv=n}(document),document},deps:[]}]),wie=new Bi(""),$7=[{provide:Q3,useClass:class sie{addToWindow(e){wn.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new Ln(5103,!1);return s},wn.getAllAngularTestabilities=()=>e.getAllTestabilities(),wn.getAllAngularRootElements=()=>e.getAllRootElements(),wn.frameworkStabilizers||(wn.frameworkStabilizers=[]),wn.frameworkStabilizers.push(i=>{const r=wn.getAllAngularTestabilities();let s=r.length;const a=function(){s--,0==s&&i()};r.forEach(l=>{l.whenStable(a)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?Cy().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:dU,useClass:lR,deps:[io,cR,Q3]},{provide:lR,useClass:lR,deps:[io,cR,Q3]}],X7=[{provide:ih,useValue:"root"},{provide:xl,useFactory:function vie(){return new xl},deps:[]},{provide:zR,useClass:mie,multi:!0,deps:[ba,io,Kp]},{provide:zR,useClass:_ie,multi:!0,deps:[ba]},qR,z7,N7,{provide:LM,useExisting:qR},{provide:D7,useClass:oie,deps:[]},[]];let Y7=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:y_,useValue:t.appId}]}}static#e=this.\u0275fac=function(i){return new(i||n)(xi(wie,12))};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({providers:[...X7,...$7],imports:[fS,xee]})}return n})(),Cie=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static#e=this.\u0275fac=function(i){return new(i||n)(xi(ba))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function e9(n){return n&&Je(n.schedule)}function $R(n){return n[n.length-1]}function t9(n){return Je($R(n))?n.pop():void 0}function _S(n){return e9($R(n))?n.pop():void 0}function My(n){return this instanceof My?(this.v=n,this):new My(n)}function s9(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function ZR(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(a){return new Promise(function(l,d){!function r(s,a,l,d){Promise.resolve(d).then(function(u){s({value:u,done:l})},a)}(l,d,(a=n[s](a)).done,a.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const JR=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function o9(n){return Je(n?.then)}function a9(n){return Je(n[xt])}function l9(n){return Symbol.asyncIterator&&Je(n?.[Symbol.asyncIterator])}function c9(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const d9=function Kie(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function u9(n){return Je(n?.[d9])}function h9(n){return function r9(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),s=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(S){i[S]&&(r[S]=function(R){return new Promise(function(H,re){s.push([S,R,H,re])>1||l(S,R)})})}function l(S,R){try{!function d(S){S.value instanceof My?Promise.resolve(S.value.v).then(u,p):_(s[0][2],S)}(i[S](R))}catch(H){_(s[0][3],H)}}function u(S){l("next",S)}function p(S){l("throw",S)}function _(S,R){S(R),s.shift(),s.length&&l(s[0][0],s[0][1])}}(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield My(t.read());if(r)return yield My(void 0);yield yield My(i)}}finally{t.releaseLock()}})}function f9(n){return Je(n?.getReader)}function Nh(n){if(n instanceof Pe)return n;if(null!=n){if(a9(n))return function Zie(n){return new Pe(e=>{const t=n[xt]();if(Je(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(JR(n))return function Jie(n){return new Pe(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(o9(n))return function ere(n){return new Pe(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,qt)})}(n);if(l9(n))return p9(n);if(u9(n))return function tre(n){return new Pe(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(f9(n))return function nre(n){return p9(h9(n))}(n)}throw c9(n)}function p9(n){return new Pe(e=>{(function ire(n,e){var t,i,r,s;return function n9(n,e,t,i){return new(t||(t=Promise))(function(s,a){function l(p){try{u(i.next(p))}catch(_){a(_)}}function d(p){try{u(i.throw(p))}catch(_){a(_)}}function u(p){p.done?s(p.value):function r(s){return s instanceof t?s:new t(function(a){a(s)})}(p.value).then(l,d)}u((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=s9(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(a){r={error:a}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function L_(n,e,t,i=0,r=!1){const s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function m9(n,e=0){return ci((t,i)=>{t.subscribe(Pi(i,r=>L_(i,n,()=>i.next(r),e),()=>L_(i,n,()=>i.complete(),e),r=>L_(i,n,()=>i.error(r),e)))})}function A9(n,e=0){return ci((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function g9(n,e){if(!n)throw new Error("Iterable cannot be null");return new Pe(t=>{L_(t,e,()=>{const i=n[Symbol.asyncIterator]();L_(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function lu(n,e){return e?function cre(n,e){if(null!=n){if(a9(n))return function rre(n,e){return Nh(n).pipe(A9(e),m9(e))}(n,e);if(JR(n))return function ore(n,e){return new Pe(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(o9(n))return function sre(n,e){return Nh(n).pipe(A9(e),m9(e))}(n,e);if(l9(n))return g9(n,e);if(u9(n))return function are(n,e){return new Pe(t=>{let i;return L_(t,e,()=>{i=n[d9](),L_(t,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(a){return void t.error(a)}s?t.complete():t.next(r)},0,!0)}),()=>Je(i?.return)&&i.return()})}(n,e);if(f9(n))return function lre(n,e){return g9(h9(n),e)}(n,e)}throw c9(n)}(n,e):Nh(n)}function po(...n){return lu(n,_S(n))}function Qu(n,e,t=1/0){return Je(e)?Qu((i,r)=>bi((s,a)=>e(i,s,r,a))(Nh(n(i,r))),t):("number"==typeof e&&(t=e),ci((i,r)=>function dre(n,e,t,i,r,s,a,l){const d=[];let u=0,p=0,_=!1;const S=()=>{_&&!d.length&&!u&&e.complete()},R=re=>u<i?H(re):d.push(re),H=re=>{s&&e.next(re),u++;let se=!1;Nh(t(re,p++)).subscribe(Pi(e,ce=>{r?.(ce),s?R(ce):e.next(ce)},()=>{se=!0},void 0,()=>{if(se)try{for(u--;d.length&&u<i;){const ce=d.shift();a?L_(e,a,()=>H(ce)):H(ce)}S()}catch(ce){e.error(ce)}}))};return n.subscribe(Pi(e,R,()=>{_=!0,S()})),()=>{l?.()}}(i,r,n,t)))}function Kw(n,e){return Je(e)?Qu(n,e,1):Qu(n,1)}function od(n,e){return ci((t,i)=>{let r=0;t.subscribe(Pi(i,s=>n.call(e,s,r++)&&i.next(s)))})}function Zw(n){return ci((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Df(n,e){return ci((t,i)=>{let r=null,s=0,a=!1;const l=()=>a&&!r&&i.complete();t.subscribe(Pi(i,d=>{r?.unsubscribe();let u=0;const p=s++;Nh(n(d,p)).subscribe(r=Pi(i,_=>i.next(e?e(d,_,p,u++):_),()=>{r=null,l()}))},()=>{a=!0,l()}))})}class AD{}class gD{}class lm{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?"string"==typeof e?this.lazyInit=()=>{this.headers=new Map,e.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),s=r.toLowerCase(),a=t.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(a):this.headers.set(s,[a])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,i)=>{this.setHeaderEntries(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof lm?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new lm;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof lm?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let a=this.headers.get(t);if(!a)return;a=a.filter(l=>-1===s.indexOf(l)),0===a.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,a)}else this.headers.delete(t),this.normalizedNames.delete(t)}}setHeaderEntries(e,t){const i=(Array.isArray(t)?t:[t]).map(s=>s.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class ure{encodeKey(e){return _9(e)}encodeValue(e){return _9(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const fre=/%(\d[a-f0-9])/gi,pre={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function _9(n){return encodeURIComponent(n).replace(fre,(e,t)=>pre[t]??e)}function _D(n){return`${n}`}class Sy{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new ure,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function hre(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[a,l]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],d=t.get(a)||[];d.push(l),t.set(a,d)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t],r=Array.isArray(i)?i.map(_D):[_D(i)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new Sy({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(_D(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const r=i.indexOf(_D(e.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class mre{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function y9(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function v9(n){return typeof Blob<"u"&&n instanceof Blob}function b9(n){return typeof FormData<"u"&&n instanceof FormData}class yS{constructor(e,t,i,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function Are(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new lm,this.context??=new mre,this.params){const a=this.params.toString();if(0===a.length)this.urlWithParams=t;else{const l=t.indexOf("?");this.urlWithParams=t+(-1===l?"?":l<t.length-1?"&":"")+a}}else this.params=new Sy,this.urlWithParams=t}serializeBody(){return null===this.body?null:y9(this.body)||v9(this.body)||b9(this.body)||function gre(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Sy?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||b9(this.body)?null:v9(this.body)?this.body.type||null:y9(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Sy?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,s=void 0!==e.body?e.body:this.body,a=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,l=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let d=e.headers||this.headers,u=e.params||this.params;const p=e.context??this.context;return void 0!==e.setHeaders&&(d=Object.keys(e.setHeaders).reduce((_,S)=>_.set(S,e.setHeaders[S]),d)),e.setParams&&(u=Object.keys(e.setParams).reduce((_,S)=>_.set(S,e.setParams[S]),u)),new yS(t,i,s,{params:u,headers:d,context:p,reportProgress:l,responseType:r,withCredentials:a})}}var Ey=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(Ey||{});class ek{constructor(e,t=vS.Ok,i="OK"){this.headers=e.headers||new lm,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class yD extends ek{constructor(e={}){super(e),this.type=Ey.ResponseHeader}clone(e={}){return new yD({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class yb extends ek{constructor(e={}){super(e),this.type=Ey.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new yb({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Jw extends ek{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}var vS=function(n){return n[n.Continue=100]="Continue",n[n.SwitchingProtocols=101]="SwitchingProtocols",n[n.Processing=102]="Processing",n[n.EarlyHints=103]="EarlyHints",n[n.Ok=200]="Ok",n[n.Created=201]="Created",n[n.Accepted=202]="Accepted",n[n.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",n[n.NoContent=204]="NoContent",n[n.ResetContent=205]="ResetContent",n[n.PartialContent=206]="PartialContent",n[n.MultiStatus=207]="MultiStatus",n[n.AlreadyReported=208]="AlreadyReported",n[n.ImUsed=226]="ImUsed",n[n.MultipleChoices=300]="MultipleChoices",n[n.MovedPermanently=301]="MovedPermanently",n[n.Found=302]="Found",n[n.SeeOther=303]="SeeOther",n[n.NotModified=304]="NotModified",n[n.UseProxy=305]="UseProxy",n[n.Unused=306]="Unused",n[n.TemporaryRedirect=307]="TemporaryRedirect",n[n.PermanentRedirect=308]="PermanentRedirect",n[n.BadRequest=400]="BadRequest",n[n.Unauthorized=401]="Unauthorized",n[n.PaymentRequired=402]="PaymentRequired",n[n.Forbidden=403]="Forbidden",n[n.NotFound=404]="NotFound",n[n.MethodNotAllowed=405]="MethodNotAllowed",n[n.NotAcceptable=406]="NotAcceptable",n[n.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",n[n.RequestTimeout=408]="RequestTimeout",n[n.Conflict=409]="Conflict",n[n.Gone=410]="Gone",n[n.LengthRequired=411]="LengthRequired",n[n.PreconditionFailed=412]="PreconditionFailed",n[n.PayloadTooLarge=413]="PayloadTooLarge",n[n.UriTooLong=414]="UriTooLong",n[n.UnsupportedMediaType=415]="UnsupportedMediaType",n[n.RangeNotSatisfiable=416]="RangeNotSatisfiable",n[n.ExpectationFailed=417]="ExpectationFailed",n[n.ImATeapot=418]="ImATeapot",n[n.MisdirectedRequest=421]="MisdirectedRequest",n[n.UnprocessableEntity=422]="UnprocessableEntity",n[n.Locked=423]="Locked",n[n.FailedDependency=424]="FailedDependency",n[n.TooEarly=425]="TooEarly",n[n.UpgradeRequired=426]="UpgradeRequired",n[n.PreconditionRequired=428]="PreconditionRequired",n[n.TooManyRequests=429]="TooManyRequests",n[n.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",n[n.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",n[n.InternalServerError=500]="InternalServerError",n[n.NotImplemented=501]="NotImplemented",n[n.BadGateway=502]="BadGateway",n[n.ServiceUnavailable=503]="ServiceUnavailable",n[n.GatewayTimeout=504]="GatewayTimeout",n[n.HttpVersionNotSupported=505]="HttpVersionNotSupported",n[n.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",n[n.InsufficientStorage=507]="InsufficientStorage",n[n.LoopDetected=508]="LoopDetected",n[n.NotExtended=510]="NotExtended",n[n.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",n}(vS||{});function tk(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}let bS=(()=>{class n{constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof yS)s=t;else{let d,u;d=r.headers instanceof lm?r.headers:new lm(r.headers),r.params&&(u=r.params instanceof Sy?r.params:new Sy({fromObject:r.params})),s=new yS(t,i,void 0!==r.body?r.body:null,{headers:d,context:r.context,params:u,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials,transferCache:r.transferCache})}const a=po(s).pipe(Kw(d=>this.handler.handle(d)));if(t instanceof yS||"events"===r.observe)return a;const l=a.pipe(od(d=>d instanceof yb));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return l.pipe(bi(d=>{if(null!==d.body&&!(d.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return d.body}));case"blob":return l.pipe(bi(d=>{if(null!==d.body&&!(d.body instanceof Blob))throw new Error("Response is not a Blob.");return d.body}));case"text":return l.pipe(bi(d=>{if(null!==d.body&&"string"!=typeof d.body)throw new Error("Response is not a string.");return d.body}));default:return l.pipe(bi(d=>d.body))}case"response":return l;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new Sy).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,tk(r,i))}post(t,i,r={}){return this.request("POST",t,tk(r,i))}put(t,i,r={}){return this.request("PUT",t,tk(r,i))}static#e=this.\u0275fac=function(i){return new(i||n)(xi(AD))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac})}return n})();function w9(n,e){return e(n)}function xre(n,e){return(t,i)=>e.intercept(t,{handle:r=>n(r,i)})}const Cre=new Bi(""),xS=new Bi(""),C9=new Bi(""),M9=new Bi("");function Mre(){let n=null;return(e,t)=>{null===n&&(n=(pi(Cre,{optional:!0})??[]).reduceRight(xre,w9));const i=pi(vy),r=i.add();return n(e,t).pipe(Zw(()=>i.remove(r)))}}let S9=(()=>{class n extends AD{constructor(t,i){super(),this.backend=t,this.injector=i,this.chain=null,this.pendingTasks=pi(vy);const r=pi(M9,{optional:!0});this.backend=r??t}handle(t){if(null===this.chain){const r=Array.from(new Set([...this.injector.get(xS),...this.injector.get(C9,[])]));this.chain=r.reduceRight((s,a)=>function wre(n,e,t){return(i,r)=>El(t,()=>e(i,s=>n(s,r)))}(s,a,this.injector),w9)}const i=this.pendingTasks.add();return this.chain(t,r=>this.backend.handle(r)).pipe(Zw(()=>this.pendingTasks.remove(i)))}static#e=this.\u0275fac=function(i){return new(i||n)(xi(gD),xi(Rc))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac})}return n})();const Ire=/^\)\]\}',?\n/;let T9=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Ln(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?lu(i.\u0275loadImpl()):po(null)).pipe(Df(()=>new Pe(s=>{const a=i.build();if(a.open(t.method,t.urlWithParams),t.withCredentials&&(a.withCredentials=!0),t.headers.forEach((re,se)=>a.setRequestHeader(re,se.join(","))),t.headers.has("Accept")||a.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const re=t.detectContentTypeHeader();null!==re&&a.setRequestHeader("Content-Type",re)}if(t.responseType){const re=t.responseType.toLowerCase();a.responseType="json"!==re?re:"text"}const l=t.serializeBody();let d=null;const u=()=>{if(null!==d)return d;const re=a.statusText||"OK",se=new lm(a.getAllResponseHeaders()),ce=function Bre(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(a)||t.url;return d=new yD({headers:se,status:a.status,statusText:re,url:ce}),d},p=()=>{let{headers:re,status:se,statusText:ce,url:Te}=u(),Ce=null;se!==vS.NoContent&&(Ce=typeof a.response>"u"?a.responseText:a.response),0===se&&(se=Ce?vS.Ok:0);let qe=se>=200&&se<300;if("json"===t.responseType&&"string"==typeof Ce){const wt=Ce;Ce=Ce.replace(Ire,"");try{Ce=""!==Ce?JSON.parse(Ce):null}catch(gt){Ce=wt,qe&&(qe=!1,Ce={error:gt,text:Ce})}}qe?(s.next(new yb({body:Ce,headers:re,status:se,statusText:ce,url:Te||void 0})),s.complete()):s.error(new Jw({error:Ce,headers:re,status:se,statusText:ce,url:Te||void 0}))},_=re=>{const{url:se}=u(),ce=new Jw({error:re,status:a.status||0,statusText:a.statusText||"Unknown Error",url:se||void 0});s.error(ce)};let S=!1;const R=re=>{S||(s.next(u()),S=!0);let se={type:Ey.DownloadProgress,loaded:re.loaded};re.lengthComputable&&(se.total=re.total),"text"===t.responseType&&a.responseText&&(se.partialText=a.responseText),s.next(se)},H=re=>{let se={type:Ey.UploadProgress,loaded:re.loaded};re.lengthComputable&&(se.total=re.total),s.next(se)};return a.addEventListener("load",p),a.addEventListener("error",_),a.addEventListener("timeout",_),a.addEventListener("abort",_),t.reportProgress&&(a.addEventListener("progress",R),null!==l&&a.upload&&a.upload.addEventListener("progress",H)),a.send(l),s.next({type:Ey.Sent}),()=>{a.removeEventListener("error",_),a.removeEventListener("abort",_),a.removeEventListener("load",p),a.removeEventListener("timeout",_),t.reportProgress&&(a.removeEventListener("progress",R),null!==l&&a.upload&&a.upload.removeEventListener("progress",H)),a.readyState!==a.DONE&&a.abort()}})))}static#e=this.\u0275fac=function(i){return new(i||n)(xi(D7))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac})}return n})();const rk=new Bi(""),D9=new Bi("",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),I9=new Bi("",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class B9{}let kre=(()=>{class n{constructor(t,i,r){this.doc=t,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=m7(t,this.cookieName),this.lastCookieString=t),this.lastToken}static#e=this.\u0275fac=function(i){return new(i||n)(xi(ba),xi(Kp),xi(D9))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac})}return n})();function Fre(n,e){const t=n.url.toLowerCase();if(!pi(rk)||"GET"===n.method||"HEAD"===n.method||t.startsWith("http://")||t.startsWith("https://"))return e(n);const i=pi(B9).getToken(),r=pi(I9);return null!=i&&!n.headers.has(r)&&(n=n.clone({headers:n.headers.set(r,i)})),e(n)}var Ty=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(Ty||{});function Ore(...n){const e=[bS,T9,S9,{provide:AD,useExisting:S9},{provide:gD,useExisting:T9},{provide:xS,useValue:Fre,multi:!0},{provide:rk,useValue:!0},{provide:B9,useClass:kre}];for(const t of n)e.push(...t.\u0275providers);return function Nu(n){return{\u0275providers:n}}(e)}const P9=new Bi("");function Lre(){return function vb(n,e){return{\u0275kind:n,\u0275providers:e}}(Ty.LegacyInterceptors,[{provide:P9,useFactory:Mre},{provide:xS,useExisting:P9,multi:!0}])}let Nre=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({providers:[Ore(Lre())]})}return n})();const{isArray:qre}=Array,{getPrototypeOf:Qre,prototype:Wre,keys:jre}=Object;function U9(n){if(1===n.length){const e=n[0];if(qre(e))return{args:e,keys:null};if(function $re(n){return n&&"object"==typeof n&&Qre(n)===Wre}(e)){const t=jre(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}const{isArray:Xre}=Array;function sk(n){return bi(e=>function Yre(n,e){return Xre(e)?n(...e):n(e)}(n,e))}function z9(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function bD(...n){const e=_S(n),t=t9(n),{args:i,keys:r}=U9(n);if(0===i.length)return lu([],e);const s=new Pe(function Kre(n,e,t=K){return i=>{H9(e,()=>{const{length:r}=n,s=new Array(r);let a=r,l=r;for(let d=0;d<r;d++)H9(e,()=>{const u=lu(n[d],e);let p=!1;u.subscribe(Pi(i,_=>{s[d]=_,p||(p=!0,l--),l||i.next(t(s.slice()))},()=>{--a||i.complete()}))},i)},i)}}(i,e,r?a=>z9(r,a):K));return t?s.pipe(sk(t)):s}function H9(n,e,t){n?L_(t,n,e):e()}const xD=tt(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function e2(n=1/0){return Qu(K,n)}function CS(...n){return function Zre(){return e2(1)}()(lu(n,_S(n)))}function wD(n){return new Pe(e=>{Nh(n()).subscribe(e)})}function MS(n,e){const t=Je(n)?n:()=>n,i=r=>r.error(t());return new Pe(e?r=>e.schedule(i,0,r):i)}const rA=new Pe(n=>n.complete());function ok(){return ci((n,e)=>{let t=null;n._refCount++;const i=Pi(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class ak extends Pe{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,In(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new rt;const t=this.getSubject();e.add(this.source.subscribe(Pi(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=rt.EMPTY)}return e}refCount(){return ok()(this)}}function ad(n){return n<=0?()=>rA:ci((e,t)=>{let i=0;e.subscribe(Pi(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function sA(...n){const e=_S(n);return ci((t,i)=>{(e?CS(n,t,e):CS(n,t)).subscribe(i)})}function CD(n){return ci((e,t)=>{let i=!1;e.subscribe(Pi(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function V9(n=ese){return ci((e,t)=>{let i=!1;e.subscribe(Pi(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function ese(){return new xD}function bb(n,e){const t=arguments.length>=2;return i=>i.pipe(n?od((r,s)=>n(r,s,i)):K,ad(1),t?CD(e):V9(()=>new xD))}function cu(n,e,t){const i=Je(n)||e||t?{next:n,error:e,complete:t}:n;return i?ci((r,s)=>{var a;null===(a=i.subscribe)||void 0===a||a.call(i);let l=!0;r.subscribe(Pi(s,d=>{var u;null===(u=i.next)||void 0===u||u.call(i,d),s.next(d)},()=>{var d;l=!1,null===(d=i.complete)||void 0===d||d.call(i),s.complete()},d=>{var u;l=!1,null===(u=i.error)||void 0===u||u.call(i,d),s.error(d)},()=>{var d,u;l&&(null===(d=i.unsubscribe)||void 0===d||d.call(i)),null===(u=i.finalize)||void 0===u||u.call(i)}))}):K}function xb(n){return ci((e,t)=>{let s,i=null,r=!1;i=e.subscribe(Pi(t,void 0,void 0,a=>{s=Nh(n(a,xb(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function lk(n){return n<=0?()=>rA:ci((e,t)=>{let i=[];e.subscribe(Pi(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function G9(n){return bi(()=>n)}function Ql(n){return ci((e,t)=>{Nh(n).subscribe(Pi(t,()=>t.complete(),Ot)),!t.closed&&e.subscribe(t)})}const Ra="primary",SS=Symbol("RouteTitle");class rse{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function t2(n){return new rse(n)}function sse(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const a=i[s],l=n[s];if(a.startsWith(":"))r[a.substring(1)]=l;else if(a!==l.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function y0(n,e){const t=n?ck(n):void 0,i=e?ck(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!q9(n[r],e[r]))return!1;return!0}function ck(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function q9(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}return n===e}function Q9(n){return n.length>0?n[n.length-1]:null}function Dy(n){return function wS(n){return!!n&&(n instanceof Pe||Je(n.lift)&&Je(n.subscribe))}(n)?n:cS(n)?lu(Promise.resolve(n)):po(n)}const ase={exact:function $9(n,e,t){if(!wb(n.segments,e.segments)||!MD(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!$9(n.children[i],e.children[i],t))return!1;return!0},subset:X9},W9={exact:function lse(n,e){return y0(n,e)},subset:function cse(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>q9(n[t],e[t]))},ignored:()=>!0};function j9(n,e,t){return ase[t.paths](n.root,e.root,t.matrixParams)&&W9[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function X9(n,e,t){return Y9(n,e,e.segments,t)}function Y9(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!wb(r,t)||e.hasChildren()||!MD(r,t,i))}if(n.segments.length===t.length){if(!wb(n.segments,t)||!MD(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!X9(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(wb(n.segments,r)&&MD(n.segments,r,i)&&n.children[Ra])&&Y9(n.children[Ra],e,s,i)}}function MD(n,e,t){return e.every((i,r)=>W9[t](n[r].parameters,i.parameters))}class n2{constructor(e=new tc([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap??=t2(this.queryParams),this._queryParamMap}toString(){return hse.serialize(this)}}class tc{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return SD(this)}}class ES{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=t2(this.parameters),this._parameterMap}toString(){return J9(this)}}function wb(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}let r2=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=qi({token:n,factory:()=>new dk,providedIn:"root"})}return n})();class dk{parse(e){const t=new wse(e);return new n2(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${TS(e.root,!0)}`,i=function mse(n){const e=Object.entries(n).map(([t,i])=>Array.isArray(i)?i.map(r=>`${ED(t)}=${ED(r)}`).join("&"):`${ED(t)}=${ED(i)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function fse(n){return encodeURI(n)}(e.fragment)}`:""}`}}const hse=new dk;function SD(n){return n.segments.map(e=>J9(e)).join("/")}function TS(n,e){if(!n.hasChildren())return SD(n);if(e){const t=n.children[Ra]?TS(n.children[Ra],!1):"",i=[];return Object.entries(n.children).forEach(([r,s])=>{r!==Ra&&i.push(`${r}:${TS(s,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function use(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===Ra&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==Ra&&(t=t.concat(e(r,i)))}),t}(n,(i,r)=>r===Ra?[TS(n.children[Ra],!1)]:[`${r}:${TS(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Ra]?`${SD(n)}/${t[0]}`:`${SD(n)}/(${t.join("//")})`}}function K9(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function ED(n){return K9(n).replace(/%3B/gi,";")}function uk(n){return K9(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function TD(n){return decodeURIComponent(n)}function Z9(n){return TD(n.replace(/\+/g,"%20"))}function J9(n){return`${uk(n.path)}${function pse(n){return Object.entries(n).map(([e,t])=>`;${uk(e)}=${uk(t)}`).join("")}(n.parameters)}`}const Ase=/^[^\/()?;#]+/;function hk(n){const e=n.match(Ase);return e?e[0]:""}const gse=/^[^\/()?;=#]+/,yse=/^[^=?&#]+/,bse=/^[^&#]+/;class wse{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new tc([],{}):new tc([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[Ra]=new tc(e,t)),i}parseSegment(){const e=hk(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Ln(4009,!1);return this.capture(e),new ES(TD(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=function _se(n){const e=n.match(gse);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=hk(this.remaining);r&&(i=r,this.capture(i))}e[TD(t)]=TD(i)}parseQueryParam(e){const t=function vse(n){const e=n.match(yse);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const a=function xse(n){const e=n.match(bse);return e?e[0]:""}(this.remaining);a&&(i=a,this.capture(i))}const r=Z9(t),s=Z9(i);if(e.hasOwnProperty(r)){let a=e[r];Array.isArray(a)||(a=[a],e[r]=a),a.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=hk(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new Ln(4010,!1);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Ra);const a=this.parseChildren();t[s]=1===Object.keys(a).length?a[Ra]:new tc([],a),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Ln(4011,!1)}}function ez(n){return n.segments.length>0?new tc([],{[Ra]:n}):n}function tz(n){const e={};for(const[i,r]of Object.entries(n.children)){const s=tz(r);if(i===Ra&&0===s.segments.length&&s.hasChildren())for(const[a,l]of Object.entries(s.children))e[a]=l;else(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function Cse(n){if(1===n.numberOfChildren&&n.children[Ra]){const e=n.children[Ra];return new tc(n.segments.concat(e.segments),e.children)}return n}(new tc(n.segments,e))}function s2(n){return n instanceof n2}function nz(n){let e;const r=ez(function t(s){const a={};for(const d of s.children){const u=t(d);a[d.outlet]=u}const l=new tc(s.url,a);return s===n&&(e=l),l}(n.root));return e??r}function iz(n,e,t,i){let r=n;for(;r.parent;)r=r.parent;if(0===e.length)return fk(r,r,r,t,i);const s=function Sse(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new sz(!0,0,n);let e=0,t=!1;const i=n.reduce((r,s,a)=>{if("object"==typeof s&&null!=s){if(s.outlets){const l={};return Object.entries(s.outlets).forEach(([d,u])=>{l[d]="string"==typeof u?u.split("/"):u}),[...r,{outlets:l}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===a?(s.split("/").forEach((l,d)=>{0==d&&"."===l||(0==d&&""===l?t=!0:".."===l?e++:""!=l&&r.push(l))}),r):[...r,s]},[]);return new sz(t,e,i)}(e);if(s.toRoot())return fk(r,r,new tc([],{}),t,i);const a=function Ese(n,e,t){if(n.isAbsolute)return new ID(e,!0,0);if(!t)return new ID(e,!1,NaN);if(null===t.parent)return new ID(t,!0,0);const i=DD(n.commands[0])?0:1;return function Tse(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new Ln(4005,!1);r=i.segments.length}return new ID(i,!1,r-s)}(t,t.segments.length-1+i,n.numberOfDoubleDots)}(s,r,n),l=a.processChildren?IS(a.segmentGroup,a.index,s.commands):oz(a.segmentGroup,a.index,s.commands);return fk(r,a.segmentGroup,l,t,i)}function DD(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function DS(n){return"object"==typeof n&&null!=n&&n.outlets}function fk(n,e,t,i,r){let a,s={};i&&Object.entries(i).forEach(([d,u])=>{s[d]=Array.isArray(u)?u.map(p=>`${p}`):`${u}`}),a=n===e?t:rz(n,e,t);const l=ez(tz(a));return new n2(l,s,r)}function rz(n,e,t){const i={};return Object.entries(n.children).forEach(([r,s])=>{i[r]=s===e?t:rz(s,e,t)}),new tc(n.segments,i)}class sz{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&DD(i[0]))throw new Ln(4003,!1);const r=i.find(DS);if(r&&r!==Q9(i))throw new Ln(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class ID{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function oz(n,e,t){if(n??=new tc([],{}),0===n.segments.length&&n.hasChildren())return IS(n,e,t);const i=function Ise(n,e,t){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;const a=n.segments[r],l=t[i];if(DS(l))break;const d=`${l}`,u=i<t.length-1?t[i+1]:null;if(r>0&&void 0===d)break;if(d&&u&&"object"==typeof u&&void 0===u.outlets){if(!lz(d,u,a))return s;i+=2}else{if(!lz(d,{},a))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new tc(n.segments.slice(0,i.pathIndex),{});return s.children[Ra]=new tc(n.segments.slice(i.pathIndex),n.children),IS(s,0,r)}return i.match&&0===r.length?new tc(n.segments,{}):i.match&&!n.hasChildren()?pk(n,e,t):i.match?IS(n,0,r):pk(n,e,t)}function IS(n,e,t){if(0===t.length)return new tc(n.segments,{});{const i=function Dse(n){return DS(n[0])?n[0].outlets:{[Ra]:n}}(t),r={};if(Object.keys(i).some(s=>s!==Ra)&&n.children[Ra]&&1===n.numberOfChildren&&0===n.children[Ra].segments.length){const s=IS(n.children[Ra],e,t);return new tc(n.segments,s.children)}return Object.entries(i).forEach(([s,a])=>{"string"==typeof a&&(a=[a]),null!==a&&(r[s]=oz(n.children[s],e,a))}),Object.entries(n.children).forEach(([s,a])=>{void 0===i[s]&&(r[s]=a)}),new tc(n.segments,r)}}function pk(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(DS(s)){const d=Bse(s.outlets);return new tc(i,d)}if(0===r&&DD(t[0])){i.push(new ES(n.segments[e].path,az(t[0]))),r++;continue}const a=DS(s)?s.outlets[Ra]:`${s}`,l=r<t.length-1?t[r+1]:null;a&&l&&DD(l)?(i.push(new ES(a,az(l))),r+=2):(i.push(new ES(a,{})),r++)}return new tc(i,{})}function Bse(n){const e={};return Object.entries(n).forEach(([t,i])=>{"string"==typeof i&&(i=[i]),null!==i&&(e[t]=pk(new tc([],{}),0,i))}),e}function az(n){const e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function lz(n,e,t){return n==t.path&&y0(e,t.parameters)}const BS="imperative";var fl=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(fl||{});class v0{constructor(e,t){this.id=e,this.url=t}}class BD extends v0{constructor(e,t,i="imperative",r=null){super(e,t),this.type=fl.NavigationStart,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class N_ extends v0{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=fl.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}var cm=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(cm||{}),PD=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(PD||{});class o2 extends v0{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=fl.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class a2 extends v0{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=fl.NavigationSkipped}}class RD extends v0{constructor(e,t,i,r){super(e,t),this.error=i,this.target=r,this.type=fl.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class cz extends v0{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=fl.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Pse extends v0{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=fl.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Rse extends v0{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=fl.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class kse extends v0{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=fl.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Fse extends v0{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=fl.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ose{constructor(e){this.route=e,this.type=fl.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Lse{constructor(e){this.route=e,this.type=fl.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Nse{constructor(e){this.snapshot=e,this.type=fl.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Use{constructor(e){this.snapshot=e,this.type=fl.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class zse{constructor(e){this.snapshot=e,this.type=fl.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Hse{constructor(e){this.snapshot=e,this.type=fl.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class dz{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i,this.type=fl.Scroll}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class mk{}class Ak{constructor(e){this.url=e}}class Vse{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new PS,this.attachRef=null}}let PS=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,i){const r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new Vse,this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class uz{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=gk(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=gk(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=_k(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return _k(e,this._root).map(t=>t.value)}}function gk(n,e){if(n===e.value)return e;for(const t of e.children){const i=gk(n,t);if(i)return i}return null}function _k(n,e){if(n===e.value)return[e];for(const t of e.children){const i=_k(n,t);if(i.length)return i.unshift(e),i}return[]}class og{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function l2(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class hz extends uz{constructor(e,t){super(e),this.snapshot=t,bk(this,e)}toString(){return this.snapshot.toString()}}function fz(n){const e=function Gse(n){const s=new vk([],{},{},"",{},Ra,n,null,{});return new pz("",new og(s,[]))}(n),t=new dn([new ES("",{})]),i=new dn({}),r=new dn({}),s=new dn({}),a=new dn(""),l=new Cb(t,i,s,a,r,Ra,n,e.root);return l.snapshot=e.root,new hz(new og(l,[]),e)}class Cb{constructor(e,t,i,r,s,a,l,d){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=s,this.outlet=a,this.component=l,this._futureSnapshot=d,this.title=this.dataSubject?.pipe(bi(u=>u[SS]))??po(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(bi(e=>t2(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(bi(e=>t2(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function yk(n,e,t="emptyOnly"){let i;const{routeConfig:r}=n;return i=null===e||"always"!==t&&""!==r?.path&&(e.component||e.routeConfig?.loadComponent)?{params:{...n.params},data:{...n.data},resolve:{...n.data,...n._resolvedData??{}}}:{params:{...e.params,...n.params},data:{...e.data,...n.data},resolve:{...n.data,...e.data,...r?.data,...n._resolvedData}},r&&Az(r)&&(i.resolve[SS]=r.title),i}class vk{get title(){return this.data?.[SS]}constructor(e,t,i,r,s,a,l,d,u){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=a,this.component=l,this.routeConfig=d,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=t2(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=t2(this.queryParams),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class pz extends uz{constructor(e,t){super(t),this.url=e,bk(this,t)}toString(){return mz(this._root)}}function bk(n,e){e.value._routerState=n,e.children.forEach(t=>bk(n,t))}function mz(n){const e=n.children.length>0?` { ${n.children.map(mz).join(", ")} } `:"";return`${n.value}${e}`}function xk(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,y0(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),y0(e.params,t.params)||n.paramsSubject.next(t.params),function ose(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!y0(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.urlSubject.next(t.url),y0(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function wk(n,e){const t=y0(n.params,e.params)&&function dse(n,e){return wb(n,e)&&n.every((t,i)=>y0(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||wk(n.parent,e.parent))}function Az(n){return"string"==typeof n.title||null===n.title}let Ck=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=Ra,this.activateEvents=new Ls,this.deactivateEvents=new Ls,this.attachEvents=new Ls,this.detachEvents=new Ls,this.parentContexts=pi(PS),this.location=pi(fs),this.changeDetector=pi(Sc),this.environmentInjector=pi(Rc),this.inputBinder=pi(kD,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Ln(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Ln(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Ln(4012,!1);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new Ln(4013,!1);this._activatedRoute=t;const r=this.location,a=t.snapshot.component,l=this.parentContexts.getOrCreateContext(this.name).children,d=new qse(t,l,r.injector);this.activated=r.createComponent(a,{index:r.length,injector:d,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275dir=Ft({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[kl]})}return n})();class qse{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===Cb?this.route:e===PS?this.childContexts:this.parent.get(e,t)}}const kD=new Bi("");let gz=(()=>{class n{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){const{activatedRoute:i}=t,r=bD([i.queryParams,i.params,i.data]).pipe(Df(([s,a,l],d)=>(l={...s,...a,...l},0===d?po(l):Promise.resolve(l)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(t);const a=function ite(n){const e=Wo(n);if(!e)return null;const t=new Li(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(i.component);if(a)for(const{templateName:l}of a.inputs)t.activatedComponentRef.setInput(l,s[l]);else this.unsubscribeFromRouteData(t)});this.outletDataSubscriptions.set(t,r)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac})}return n})();function RS(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function Wse(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return RS(n,i,r);return RS(n,i)})}(n,e,t);return new og(i,r)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const a=s.route;return a.value._futureSnapshot=e.value,a.children=e.children.map(l=>RS(n,l)),a}}const i=function jse(n){return new Cb(new dn(n.url),new dn(n.params),new dn(n.queryParams),new dn(n.fragment),new dn(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(s=>RS(n,s));return new og(i,r)}}const _z="ngNavigationCancelingError";function yz(n,e){const{redirectTo:t,navigationBehaviorOptions:i}=s2(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=vz(!1,cm.Redirect);return r.url=t,r.navigationBehaviorOptions=i,r}function vz(n,e){const t=new Error(`NavigationCancelingError: ${n||""}`);return t[_z]=!0,t.cancellationCode=e,t}function bz(n){return!!n&&n[_z]}let xz=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=Zr({type:n,selectors:[["ng-component"]],standalone:!0,features:[yd],decls:1,vars:0,template:function(i,r){1&i&&Fr(0,"router-outlet")},dependencies:[Ck],encapsulation:2})}return n})();function Mk(n){const e=n.children&&n.children.map(Mk),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Ra&&(t.component=xz),t}function b0(n){return n.outlet||Ra}function kS(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class toe{constructor(e,t,i,r,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=s}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),xk(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=l2(t);e.children.forEach(s=>{const a=s.value.outlet;this.deactivateRoutes(s,r[a],i),delete r[a]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const a=i.getContext(r.outlet);a&&this.deactivateChildRoutes(e,t,a.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=l2(e);for(const a of Object.values(s))this.deactivateRouteAndItsChildren(a,r);if(i&&i.outlet){const a=i.outlet.detach(),l=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:a,route:e,contexts:l})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=l2(e);for(const a of Object.values(s))this.deactivateRouteAndItsChildren(a,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){const r=l2(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new Hse(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Use(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(xk(r),r===s)if(r.component){const a=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,a.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const a=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const l=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),a.children.onOutletReAttached(l.contexts),a.attachRef=l.componentRef,a.route=l.route.value,a.outlet&&a.outlet.attach(l.componentRef,l.route.value),xk(l.route.value),this.activateChildRoutes(e,null,a.children)}else{const l=kS(r.snapshot);a.attachRef=null,a.route=r,a.injector=l,a.outlet&&a.outlet.activateWith(r,a.injector),this.activateChildRoutes(e,null,a.children)}}else this.activateChildRoutes(e,null,i)}}class wz{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class FD{constructor(e,t){this.component=e,this.route=t}}function noe(n,e,t){const i=n._root;return FS(i,e?e._root:null,t,[i.value])}function c2(n,e){const t=Symbol(),i=e.get(n,t);return i===t?"function"!=typeof n||function jh(n){return null!==ic(n)}(n)?e.get(n):n:i}function FS(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=l2(e);return n.children.forEach(a=>{(function roe(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,a=e?e.value:null,l=t?t.getContext(n.value.outlet):null;if(a&&s.routeConfig===a.routeConfig){const d=function soe(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!wb(n.url,e.url);case"pathParamsOrQueryParamsChange":return!wb(n.url,e.url)||!y0(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!wk(n,e)||!y0(n.queryParams,e.queryParams);default:return!wk(n,e)}}(a,s,s.routeConfig.runGuardsAndResolvers);d?r.canActivateChecks.push(new wz(i)):(s.data=a.data,s._resolvedData=a._resolvedData),FS(n,e,s.component?l?l.children:null:t,i,r),d&&l&&l.outlet&&l.outlet.isActivated&&r.canDeactivateChecks.push(new FD(l.outlet.component,a))}else a&&OS(e,l,r),r.canActivateChecks.push(new wz(i)),FS(n,null,s.component?l?l.children:null:t,i,r)})(a,s[a.value.outlet],t,i.concat([a.value]),r),delete s[a.value.outlet]}),Object.entries(s).forEach(([a,l])=>OS(l,t.getContext(a),r)),r}function OS(n,e,t){const i=l2(n),r=n.value;Object.entries(i).forEach(([s,a])=>{OS(a,r.component?e?e.children.getContext(s):null:e,t)}),t.canDeactivateChecks.push(new FD(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function LS(n){return"function"==typeof n}function Cz(n){return n instanceof xD||"EmptyError"===n?.name}const OD=Symbol("INITIAL_VALUE");function d2(){return Df(n=>bD(n.map(e=>e.pipe(ad(1),sA(OD)))).pipe(bi(e=>{for(const t of e)if(!0!==t){if(t===OD)return OD;if(!1===t||t instanceof n2)return t}return!0}),od(e=>e!==OD),ad(1)))}function Mz(n){return function ge(...n){return ye(n)}(cu(e=>{if(s2(e))throw yz(0,e)}),bi(e=>!0===e))}class Sk{constructor(e){this.segmentGroup=e||null}}class Ek extends Error{constructor(e){super(),this.urlTree=e}}function u2(n){return MS(new Sk(n))}class Coe{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return po(i);if(r.numberOfChildren>1||!r.children[Ra])return MS(new Ln(4e3,!1));r=r.children[Ra]}}applyRedirectCommands(e,t,i){const r=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i);if(t.startsWith("/"))throw new Ek(r);return r}applyRedirectCreateUrlTree(e,t,i,r){const s=this.createSegmentGroup(e,t.root,i,r);return new n2(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return Object.entries(e).forEach(([r,s])=>{if("string"==typeof s&&s.startsWith(":")){const l=s.substring(1);i[r]=t[l]}else i[r]=s}),i}createSegmentGroup(e,t,i,r){const s=this.createSegments(e,t.segments,i,r);let a={};return Object.entries(t.children).forEach(([l,d])=>{a[l]=this.createSegmentGroup(e,d,i,r)}),new tc(s,a)}createSegments(e,t,i,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new Ln(4001,!1);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}const Tk={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Moe(n,e,t,i,r){const s=Dk(n,e,t);return s.matched?(i=function Xse(n,e){return n.providers&&!n._injector&&(n._injector=x3(n.providers,e,`Route: ${n.path}`)),n._injector??e}(e,i),function boe(n,e,t,i){const r=e.canMatch;return r&&0!==r.length?po(r.map(a=>{const l=c2(a,n);return Dy(function uoe(n){return n&&LS(n.canMatch)}(l)?l.canMatch(e,t):El(n,()=>l(e,t)))})).pipe(d2(),Mz()):po(!0)}(i,e,t).pipe(bi(a=>!0===a?s:{...Tk}))):po(s)}function Dk(n,e,t){if("**"===e.path)return function Soe(n){return{matched:!0,parameters:n.length>0?Q9(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}(t);if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...Tk}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||sse)(t,n,e);if(!r)return{...Tk};const s={};Object.entries(r.posParams??{}).forEach(([l,d])=>{s[l]=d.path});const a=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:a,positionalParamSegments:r.posParams??{}}}function Sz(n,e,t,i){return t.length>0&&function Doe(n,e,t){return t.some(i=>LD(n,e,i)&&b0(i)!==Ra)}(n,t,i)?{segmentGroup:new tc(e,Toe(i,new tc(t,n.children))),slicedSegments:[]}:0===t.length&&function Ioe(n,e,t){return t.some(i=>LD(n,e,i))}(n,t,i)?{segmentGroup:new tc(n.segments,Eoe(n,t,i,n.children)),slicedSegments:t}:{segmentGroup:new tc(n.segments,n.children),slicedSegments:t}}function Eoe(n,e,t,i){const r={};for(const s of t)if(LD(n,e,s)&&!i[b0(s)]){const a=new tc([],{});r[b0(s)]=a}return{...i,...r}}function Toe(n,e){const t={};t[Ra]=e;for(const i of n)if(""===i.path&&b0(i)!==Ra){const r=new tc([],{});t[b0(i)]=r}return t}function LD(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}class Roe{}class Ooe{constructor(e,t,i,r,s,a,l){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=a,this.urlSerializer=l,this.applyRedirects=new Coe(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new Ln(4002,`'${e.segmentGroup}'`)}recognize(){const e=Sz(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(bi(t=>{const i=new vk([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Ra,this.rootComponentType,null,{}),r=new og(i,t),s=new pz("",r),a=function Mse(n,e,t=null,i=null){return iz(nz(n),e,t,i)}(i,[],this.urlTree.queryParams,this.urlTree.fragment);return a.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(a),this.inheritParamsAndData(s._root,null),{state:s,tree:a}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,Ra).pipe(xb(i=>{if(i instanceof Ek)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof Sk?this.noMatchError(i):i}))}inheritParamsAndData(e,t){const i=e.value,r=yk(i,t,this.paramsInheritanceStrategy);i.params=Object.freeze(r.params),i.data=Object.freeze(r.data),e.children.forEach(s=>this.inheritParamsAndData(s,i))}processSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,t,i):this.processSegment(e,t,i,i.segments,r,!0).pipe(bi(s=>s instanceof og?[s]:[]))}processChildren(e,t,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return lu(r).pipe(Kw(s=>{const a=i.children[s],l=function Jse(n,e){const t=n.filter(i=>b0(i)===e);return t.push(...n.filter(i=>b0(i)!==e)),t}(t,s);return this.processSegmentGroup(e,l,a,s)}),function nse(n,e){return ci(function tse(n,e,t,i,r){return(s,a)=>{let l=t,d=e,u=0;s.subscribe(Pi(a,p=>{const _=u++;d=l?n(d,p,_):(l=!0,p),i&&a.next(d)},r&&(()=>{l&&a.next(d),a.complete()})))}}(n,e,arguments.length>=2,!0))}((s,a)=>(s.push(...a),s)),CD(null),function ise(n,e){const t=arguments.length>=2;return i=>i.pipe(n?od((r,s)=>n(r,s,i)):K,lk(1),t?CD(e):V9(()=>new xD))}(),Qu(s=>{if(null===s)return u2(i);const a=Ez(s);return function Loe(n){n.sort((e,t)=>e.value.outlet===Ra?-1:t.value.outlet===Ra?1:e.value.outlet.localeCompare(t.value.outlet))}(a),po(a)}))}processSegment(e,t,i,r,s,a){return lu(t).pipe(Kw(l=>this.processSegmentAgainstRoute(l._injector??e,t,l,i,r,s,a).pipe(xb(d=>{if(d instanceof Sk)return po(null);throw d}))),bb(l=>!!l),xb(l=>{if(Cz(l))return function Poe(n,e,t){return 0===e.length&&!n.children[t]}(i,r,s)?po(new Roe):u2(i);throw l}))}processSegmentAgainstRoute(e,t,i,r,s,a,l){return function Boe(n,e,t,i){return!!(b0(n)===i||i!==Ra&&LD(e,t,n))&&Dk(e,n,t).matched}(i,r,s,a)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,r,i,s,a):this.allowRedirects&&l?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,s,a):u2(r):u2(r)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,a){const{matched:l,consumedSegments:d,positionalParamSegments:u,remainingSegments:p}=Dk(t,r,s);if(!l)return u2(t);r.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>31&&(this.allowRedirects=!1));const _=this.applyRedirects.applyRedirectCommands(d,r.redirectTo,u);return this.applyRedirects.lineralizeSegments(r,_).pipe(Qu(S=>this.processSegment(e,i,t,S.concat(p),a,!1)))}matchSegmentAgainstRoute(e,t,i,r,s){const a=Moe(t,i,r,e);return"**"===i.path&&(t.children={}),a.pipe(Df(l=>l.matched?this.getChildConfig(e=i._injector??e,i,r).pipe(Df(({routes:d})=>{const u=i._loadedInjector??e,{consumedSegments:p,remainingSegments:_,parameters:S}=l,R=new vk(p,S,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,function Uoe(n){return n.data||{}}(i),b0(i),i.component??i._loadedComponent??null,i,function zoe(n){return n.resolve||{}}(i)),{segmentGroup:H,slicedSegments:re}=Sz(t,p,_,d);if(0===re.length&&H.hasChildren())return this.processChildren(u,d,H).pipe(bi(ce=>null===ce?null:new og(R,ce)));if(0===d.length&&0===re.length)return po(new og(R,[]));const se=b0(i)===s;return this.processSegment(u,d,H,re,se?Ra:s,!0).pipe(bi(ce=>new og(R,ce instanceof og?[ce]:[])))})):u2(t)))}getChildConfig(e,t,i){return t.children?po({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?po({routes:t._loadedRoutes,injector:t._loadedInjector}):function voe(n,e,t,i){const r=e.canLoad;return void 0===r||0===r.length?po(!0):po(r.map(a=>{const l=c2(a,n);return Dy(function aoe(n){return n&&LS(n.canLoad)}(l)?l.canLoad(e,t):El(n,()=>l(e,t)))})).pipe(d2(),Mz())}(e,t,i).pipe(Qu(r=>r?this.configLoader.loadChildren(e,t).pipe(cu(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function woe(n){return MS(vz(!1,cm.GuardRejected))}())):po({routes:[],injector:e})}}function Noe(n){const e=n.value.routeConfig;return e&&""===e.path}function Ez(n){const e=[],t=new Set;for(const i of n){if(!Noe(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=Ez(i.children);e.push(new og(i.value,r))}return e.filter(i=>!t.has(i))}function Tz(n){const e=n.children.map(t=>Tz(t)).flat();return[n,...e]}function Ik(n){return Df(e=>{const t=n(e);return t?lu(t).pipe(bi(()=>e)):po(e)})}let Dz=(()=>{class n{buildTitle(t){let i,r=t.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===Ra);return i}getResolvedTitleForRoute(t){return t.data[SS]}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=qi({token:n,factory:()=>pi(Woe),providedIn:"root"})}return n})(),Woe=(()=>{class n extends Dz{constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}static#e=this.\u0275fac=function(i){return new(i||n)(xi(Cie))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const h2=new Bi("",{providedIn:"root",factory:()=>({})}),f2=new Bi("");let Bk=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=pi(mU)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return po(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=Dy(t.loadComponent()).pipe(bi(Iz),cu(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),Zw(()=>{this.componentLoaders.delete(t)})),r=new ak(i,()=>new hn).pipe(ok());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return po({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const s=function joe(n,e,t,i){return Dy(n.loadChildren()).pipe(bi(Iz),Qu(r=>r instanceof RN||Array.isArray(r)?po(r):lu(e.compileModuleAsync(r))),bi(r=>{i&&i(n);let s,a,l=!1;return Array.isArray(r)?(a=r,!0):(s=r.create(t).injector,a=s.get(f2,[],{optional:!0,self:!0}).flat()),{routes:a.map(Mk),injector:s}}))}(i,this.compiler,t,this.onLoadEndListener).pipe(Zw(()=>{this.childrenLoaders.delete(i)})),a=new ak(s,()=>new hn).pipe(ok());return this.childrenLoaders.set(i,a),a}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Iz(n){return function $oe(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let Pk=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=qi({token:n,factory:()=>pi(Xoe),providedIn:"root"})}return n})(),Xoe=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Bz=new Bi(""),Pz=new Bi("");function Yoe(n,e,t){const i=n.get(Pz),r=n.get(ba);return n.get(io).runOutsideAngular(()=>{if(!r.startViewTransition||i.skipNextTransition)return i.skipNextTransition=!1,Promise.resolve();let s;const a=new Promise(u=>{s=u}),l=r.startViewTransition(()=>(s(),function Koe(n){return new Promise(e=>{Be(e,{injector:n})})}(n))),{onViewTransitionCreated:d}=i;return d&&El(n,()=>d({transition:l,from:e,to:t})),a})}let ND=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new hn,this.transitionAbortSubject=new hn,this.configLoader=pi(Bk),this.environmentInjector=pi(Rc),this.urlSerializer=pi(r2),this.rootContexts=pi(PS),this.location=pi(_b),this.inputBindingEnabled=null!==pi(kD,{optional:!0}),this.titleStrategy=pi(Dz),this.options=pi(h2,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=pi(Pk),this.createViewTransition=pi(Bz,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>po(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new Lse(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new Ose(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:i})}setupNavigations(t,i,r){return this.transitions=new dn({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:BS,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(od(s=>0!==s.id),bi(s=>({...s,extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),Df(s=>{let a=!1,l=!1;return po(s).pipe(Df(d=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",cm.SupersededByNewNavigation),rA;this.currentTransition=s,this.currentNavigation={id:d.id,initialUrl:d.rawUrl,extractedUrl:d.extractedUrl,trigger:d.source,extras:d.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null};const u=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl();if(!u&&"reload"!==(d.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const _="";return this.events.next(new a2(d.id,this.urlSerializer.serialize(d.rawUrl),_,PD.IgnoredSameUrlNavigation)),d.resolve(null),rA}if(this.urlHandlingStrategy.shouldProcessUrl(d.rawUrl))return po(d).pipe(Df(_=>{const S=this.transitions?.getValue();return this.events.next(new BD(_.id,this.urlSerializer.serialize(_.extractedUrl),_.source,_.restoredState)),S!==this.transitions?.getValue()?rA:Promise.resolve(_)}),function Hoe(n,e,t,i,r,s){return Qu(a=>function koe(n,e,t,i,r,s,a="emptyOnly"){return new Ooe(n,e,t,i,r,a,s).recognize()}(n,e,t,i,a.extractedUrl,r,s).pipe(bi(({state:l,tree:d})=>({...a,targetSnapshot:l,urlAfterRedirects:d}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),cu(_=>{s.targetSnapshot=_.targetSnapshot,s.urlAfterRedirects=_.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:_.urlAfterRedirects};const S=new cz(_.id,this.urlSerializer.serialize(_.extractedUrl),this.urlSerializer.serialize(_.urlAfterRedirects),_.targetSnapshot);this.events.next(S)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(d.currentRawUrl)){const{id:_,extractedUrl:S,source:R,restoredState:H,extras:re}=d,se=new BD(_,this.urlSerializer.serialize(S),R,H);this.events.next(se);const ce=fz(this.rootComponentType).snapshot;return this.currentTransition=s={...d,targetSnapshot:ce,urlAfterRedirects:S,extras:{...re,skipLocationChange:!1,replaceUrl:!1}},this.currentNavigation.finalUrl=S,po(s)}{const _="";return this.events.next(new a2(d.id,this.urlSerializer.serialize(d.extractedUrl),_,PD.IgnoredByUrlHandlingStrategy)),d.resolve(null),rA}}),cu(d=>{const u=new Pse(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(u)}),bi(d=>(this.currentTransition=s={...d,guards:noe(d.targetSnapshot,d.currentSnapshot,this.rootContexts)},s)),function hoe(n,e){return Qu(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:a}}=t;return 0===a.length&&0===s.length?po({...t,guardsResult:!0}):function foe(n,e,t,i){return lu(n).pipe(Qu(r=>function yoe(n,e,t,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?po(s.map(l=>{const d=kS(e)??r,u=c2(l,d);return Dy(function doe(n){return n&&LS(n.canDeactivate)}(u)?u.canDeactivate(n,e,t,i):El(d,()=>u(n,e,t,i))).pipe(bb())})).pipe(d2()):po(!0)}(r.component,r.route,t,e,i)),bb(r=>!0!==r,!0))}(a,i,r,n).pipe(Qu(l=>l&&function ooe(n){return"boolean"==typeof n}(l)?function poe(n,e,t,i){return lu(e).pipe(Kw(r=>CS(function Aoe(n,e){return null!==n&&e&&e(new Nse(n)),po(!0)}(r.route.parent,i),function moe(n,e){return null!==n&&e&&e(new zse(n)),po(!0)}(r.route,i),function _oe(n,e,t){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(a=>function ioe(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(a)).filter(a=>null!==a).map(a=>wD(()=>po(a.guards.map(d=>{const u=kS(a.node)??t,p=c2(d,u);return Dy(function coe(n){return n&&LS(n.canActivateChild)}(p)?p.canActivateChild(i,n):El(u,()=>p(i,n))).pipe(bb())})).pipe(d2())));return po(s).pipe(d2())}(n,r.path,t),function goe(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return po(!0);const r=i.map(s=>wD(()=>{const a=kS(e)??t,l=c2(s,a);return Dy(function loe(n){return n&&LS(n.canActivate)}(l)?l.canActivate(e,n):El(a,()=>l(e,n))).pipe(bb())}));return po(r).pipe(d2())}(n,r.route,t))),bb(r=>!0!==r,!0))}(i,s,n,e):po(l)),bi(l=>({...t,guardsResult:l})))})}(this.environmentInjector,d=>this.events.next(d)),cu(d=>{if(s.guardsResult=d.guardsResult,s2(d.guardsResult))throw yz(0,d.guardsResult);const u=new Rse(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot,!!d.guardsResult);this.events.next(u)}),od(d=>!!d.guardsResult||(this.cancelNavigationTransition(d,"",cm.GuardRejected),!1)),Ik(d=>{if(d.guards.canActivateChecks.length)return po(d).pipe(cu(u=>{const p=new kse(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(p)}),Df(u=>{let p=!1;return po(u).pipe(function Voe(n,e){return Qu(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return po(t);const s=new Set(r.map(d=>d.route)),a=new Set;for(const d of s)if(!a.has(d))for(const u of Tz(d))a.add(u);let l=0;return lu(a).pipe(Kw(d=>s.has(d)?function Goe(n,e,t,i){const r=n.routeConfig,s=n._resolve;return void 0!==r?.title&&!Az(r)&&(s[SS]=r.title),function qoe(n,e,t,i){const r=ck(n);if(0===r.length)return po({});const s={};return lu(r).pipe(Qu(a=>function Qoe(n,e,t,i){const r=kS(e)??i,s=c2(n,r);return Dy(s.resolve?s.resolve(e,t):El(r,()=>s(e,t)))}(n[a],e,t,i).pipe(bb(),cu(l=>{s[a]=l}))),lk(1),G9(s),xb(a=>Cz(a)?rA:MS(a)))}(s,n,e,i).pipe(bi(a=>(n._resolvedData=a,n.data=yk(n,n.parent,t).resolve,null)))}(d,i,n,e):(d.data=yk(d,d.parent,n).resolve,po(void 0))),cu(()=>l++),lk(1),Qu(d=>l===a.size?po(t):rA))})}(this.paramsInheritanceStrategy,this.environmentInjector),cu({next:()=>p=!0,complete:()=>{p||this.cancelNavigationTransition(u,"",cm.NoDataFromResolver)}}))}),cu(u=>{const p=new Fse(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(p)}))}),Ik(d=>{const u=p=>{const _=[];p.routeConfig?.loadComponent&&!p.routeConfig._loadedComponent&&_.push(this.configLoader.loadComponent(p.routeConfig).pipe(cu(S=>{p.component=S}),bi(()=>{})));for(const S of p.children)_.push(...u(S));return _};return bD(u(d.targetSnapshot.root)).pipe(CD(null),ad(1))}),Ik(()=>this.afterPreactivation()),Df(()=>{const{currentSnapshot:d,targetSnapshot:u}=s,p=this.createViewTransition?.(this.environmentInjector,d.root,u.root);return p?lu(p).pipe(bi(()=>s)):po(s)}),bi(d=>{const u=function Qse(n,e,t){const i=RS(n,e._root,t?t._root:void 0);return new hz(i,e)}(t.routeReuseStrategy,d.targetSnapshot,d.currentRouterState);return this.currentTransition=s={...d,targetRouterState:u},this.currentNavigation.targetRouterState=u,s}),cu(()=>{this.events.next(new mk)}),((n,e,t,i)=>bi(r=>(new toe(e,r.targetRouterState,r.currentRouterState,t,i).activate(n),r)))(this.rootContexts,t.routeReuseStrategy,d=>this.events.next(d),this.inputBindingEnabled),ad(1),cu({next:d=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new N_(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects))),this.titleStrategy?.updateTitle(d.targetRouterState.snapshot),d.resolve(!0)},complete:()=>{a=!0}}),Ql(this.transitionAbortSubject.pipe(cu(d=>{throw d}))),Zw(()=>{!a&&!l&&this.cancelNavigationTransition(s,"",cm.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),xb(d=>{if(l=!0,bz(d))this.events.next(new o2(s.id,this.urlSerializer.serialize(s.extractedUrl),d.message,d.cancellationCode)),function $se(n){return bz(n)&&s2(n.url)}(d)?this.events.next(new Ak(d.url)):s.resolve(!1);else{this.events.next(new RD(s.id,this.urlSerializer.serialize(s.extractedUrl),d,s.targetSnapshot??void 0));try{s.resolve(t.errorHandler(d))}catch(u){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(u)}}return rA}))}))}cancelNavigationTransition(t,i,r){const s=new o2(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Zoe(n){return n!==BS}let Joe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=qi({token:n,factory:()=>pi(tae),providedIn:"root"})}return n})();class eae{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let tae=(()=>{class n extends eae{static#e=this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Ca(n)))(r||n)}})();static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Rz=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=qi({token:n,factory:()=>pi(nae),providedIn:"root"})}return n})(),nae=(()=>{class n extends Rz{constructor(){super(...arguments),this.location=pi(_b),this.urlSerializer=pi(r2),this.options=pi(h2,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=pi(Pk),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new n2,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=fz(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(i=>{"popstate"===i.type&&t(i.url,i.state)})}handleRouterEvent(t,i){if(t instanceof BD)this.stateMemento=this.createStateMemento();else if(t instanceof a2)this.rawUrlTree=i.initialUrl;else if(t instanceof cz){if("eager"===this.urlUpdateStrategy&&!i.extras.skipLocationChange){const r=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(r,i)}}else t instanceof mk?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,"deferred"===this.urlUpdateStrategy&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):t instanceof o2&&(t.code===cm.GuardRejected||t.code===cm.NoDataFromResolver)?this.restoreHistory(i):t instanceof RD?this.restoreHistory(i,!0):t instanceof N_&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){const a={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(r,"",a)}else{const s={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId+1)};this.location.go(r,"",s)}}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-this.browserPageId;0!==s?this.location.historyGo(s):this.currentUrlTree===t.finalUrl&&0===s&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static#e=this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Ca(n)))(r||n)}})();static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var NS=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(NS||{});function kz(n,e){n.events.pipe(od(t=>t instanceof N_||t instanceof o2||t instanceof RD||t instanceof a2),bi(t=>t instanceof N_||t instanceof a2?NS.COMPLETE:t instanceof o2&&(t.code===cm.Redirect||t.code===cm.SupersededByNewNavigation)?NS.REDIRECTING:NS.FAILED),od(t=>t!==NS.REDIRECTING),ad(1)).subscribe(()=>{e()})}function iae(n){throw n}const rae={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},sae={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let ag=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=pi(sU),this.stateManager=pi(Rz),this.options=pi(h2,{optional:!0})||{},this.pendingTasks=pi(vy),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=pi(ND),this.urlSerializer=pi(r2),this.location=pi(_b),this.urlHandlingStrategy=pi(Pk),this._events=new hn,this.errorHandler=this.options.errorHandler||iae,this.navigated=!1,this.routeReuseStrategy=pi(Joe),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=pi(f2,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!pi(kD,{optional:!0}),this.eventsSubscription=new rt,this.isNgZoneEnabled=pi(io)instanceof io&&io.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const t=this.navigationTransitions.events.subscribe(i=>{try{const r=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(null!==r&&null!==s)if(this.stateManager.handleRouterEvent(i,s),i instanceof o2&&i.code!==cm.Redirect&&i.code!==cm.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof N_)this.navigated=!0;else if(i instanceof Ak){const a=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),l={info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Zoe(r.source)};this.scheduleNavigation(a,BS,null,l,{resolve:r.resolve,reject:r.reject,promise:r.promise})}(function aae(n){return!(n instanceof mk||n instanceof Ak)})(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),BS,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",i)},0)})}navigateToSyncWithBrowser(t,i,r){const s={replaceUrl:!0},a=r?.navigationId?r:null;if(r){const d={...r};delete d.navigationId,delete d.\u0275routerPageId,0!==Object.keys(d).length&&(s.state=d)}const l=this.parseUrl(t);this.scheduleNavigation(l,i,a,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Mk),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){const{relativeTo:r,queryParams:s,fragment:a,queryParamsHandling:l,preserveFragment:d}=i,u=d?this.currentUrlTree.fragment:a;let _,p=null;switch(l){case"merge":p={...this.currentUrlTree.queryParams,...s};break;case"preserve":p=this.currentUrlTree.queryParams;break;default:p=s||null}null!==p&&(p=this.removeEmptyProps(p));try{_=nz(r?r.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof t[0]||!t[0].startsWith("/"))&&(t=[]),_=this.currentUrlTree.root}return iz(_,t,p,u??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=s2(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,BS,null,i)}navigate(t,i={skipLocationChange:!1}){return function oae(n){for(let e=0;e<n.length;e++)if(null==n[e])throw new Ln(4008,!1)}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,i){let r;if(r=!0===i?{...rae}:!1===i?{...sae}:i,s2(t))return j9(this.currentUrlTree,t,r);const s=this.parseUrl(t);return j9(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.entries(t).reduce((i,[r,s])=>(null!=s&&(i[r]=s),i),{})}scheduleNavigation(t,i,r,s,a){if(this.disposed)return Promise.resolve(!1);let l,d,u;a?(l=a.resolve,d=a.reject,u=a.promise):u=new Promise((_,S)=>{l=_,d=S});const p=this.pendingTasks.add();return kz(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(p))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:l,reject:d,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(_=>Promise.reject(_))}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),US=(()=>{class n{constructor(t,i,r,s,a,l){this.router=t,this.route=i,this.tabIndexAttribute=r,this.renderer=s,this.el=a,this.locationStrategy=l,this.href=null,this.commands=null,this.onChanges=new hn,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const d=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===d||"area"===d,this.isAnchorElement?this.subscription=t.events.subscribe(u=>{u instanceof N_&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(t){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){null!=t?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(t,i,r,s,a){const l=this.urlTree;return!!(null===l||this.isAnchorElement&&(0!==t||i||r||s||a||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(l,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){const t=this.urlTree;this.href=null!==t&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t)):null;const i=null===this.href?null:function mT(n,e,t){return function zB(n,e){return"src"===e&&("embed"===n||"frame"===n||"iframe"===n||"media"===n||"script"===n)||"href"===e&&("base"===n||"link"===n)?$x:Y1}(e,t)(n)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(t,i){const r=this.renderer,s=this.el.nativeElement;null!==i?r.setAttribute(s,t,i):r.removeAttribute(s,t)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(ag),Lt(Cb),xu("tabindex"),Lt(KA),Lt(oo),Lt(gb))};static#t=this.\u0275dir=Ft({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,r){1&i&&Ai("click",function(a){return r.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),2&i&&sl("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[mi.HasDecoratorInputTransform,"preserveFragment","preserveFragment",_o],skipLocationChange:[mi.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",_o],replaceUrl:[mi.HasDecoratorInputTransform,"replaceUrl","replaceUrl",_o],routerLink:"routerLink"},standalone:!0,features:[ql,kl]})}return n})();class Fz{}let dae=(()=>{class n{constructor(t,i,r,s,a){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(od(t=>t instanceof N_),Kw(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const s of i){s.providers&&!s._injector&&(s._injector=x3(s.providers,t,`Route: ${s.path}`));const a=s._injector??t,l=s._loadedInjector??a;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&r.push(this.preloadConfig(a,s)),(s.children||s._loadedRoutes)&&r.push(this.processRoutes(l,s.children??s._loadedRoutes))}return lu(r).pipe(e2())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):po(null);const s=r.pipe(Qu(a=>null===a?po(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??t,a.routes))));return i.loadComponent&&!i._loadedComponent?lu([s,this.loader.loadComponent(i)]).pipe(e2()):s})}static#e=this.\u0275fac=function(i){return new(i||n)(xi(ag),xi(mU),xi(Rc),xi(Fz),xi(Bk))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Rk=new Bi("");let Oz=(()=>{class n{constructor(t,i,r,s,a={}){this.urlSerializer=t,this.transitions=i,this.viewportScroller=r,this.zone=s,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof BD?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof N_?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof a2&&t.code===PD.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof dz&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new dz(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){pM()};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac})}return n})();function x0(n,e){return{\u0275kind:n,\u0275providers:e}}function Nz(){const n=pi(Al);return e=>{const t=n.get(R_);if(e!==t.components[0])return;const i=n.get(ag),r=n.get(Uz);1===n.get(kk)&&i.initialNavigation(),n.get(zz,null,va.Optional)?.setUpPreloading(),n.get(Rk,null,va.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const Uz=new Bi("",{factory:()=>new hn}),kk=new Bi("",{providedIn:"root",factory:()=>1}),zz=new Bi("");function pae(n){return x0(0,[{provide:zz,useExisting:dae},{provide:Fz,useExisting:n}])}function Aae(n){return x0(9,[{provide:Bz,useValue:Yoe},{provide:Pz,useValue:{skipNextTransition:!!n?.skipInitialTransition,...n}}])}const Hz=new Bi("ROUTER_FORROOT_GUARD"),gae=[_b,{provide:r2,useClass:dk},ag,PS,{provide:Cb,useFactory:function Lz(n){return n.routerState.root},deps:[ag]},Bk,[]];let Vz=(()=>{class n{constructor(t){}static forRoot(t,i){return{ngModule:n,providers:[gae,[],{provide:f2,multi:!0,useValue:t},{provide:Hz,useFactory:bae,deps:[[ag,new cl,new Xl]]},{provide:h2,useValue:i||{}},i?.useHash?{provide:gb,useClass:lte}:{provide:gb,useClass:s7},{provide:Rk,useFactory:()=>{const n=pi(Mne),e=pi(io),t=pi(h2),i=pi(ND),r=pi(r2);return t.scrollOffset&&n.setOffset(t.scrollOffset),new Oz(r,i,n,e,t)}},i?.preloadingStrategy?pae(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?xae(i):[],i?.bindToComponentInputs?x0(8,[gz,{provide:kD,useExisting:gz}]).\u0275providers:[],i?.enableViewTransitions?Aae().\u0275providers:[],[{provide:Gz,useFactory:Nz},{provide:fR,multi:!0,useExisting:Gz}]]}}static forChild(t){return{ngModule:n,providers:[{provide:f2,multi:!0,useValue:t}]}}static#e=this.\u0275fac=function(i){return new(i||n)(xi(Hz,8))};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({})}return n})();function bae(n){return"guarded"}function xae(n){return["disabled"===n.initialNavigation?x0(3,[{provide:uR,multi:!0,useFactory:()=>{const e=pi(ag);return()=>{e.setUpLocationChangeListener()}}},{provide:kk,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?x0(2,[{provide:kk,useValue:0},{provide:uR,multi:!0,deps:[Al],useFactory:e=>{const t=e.get(ote,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const r=e.get(ag),s=e.get(Uz);kz(r,()=>{i(!0)}),e.get(ND).afterPreactivation=()=>(i(!0),s.closed?po(void 0):s),r.initialNavigation()}))}}]).\u0275providers:[]]}const Gz=new Bi("");let Cae=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Zr({type:n,selectors:[["app-root"]],decls:1,vars:0,template:function(i,r){1&i&&Fr(0,"router-outlet")},dependencies:[Ck]})}return n})();var qz=Se(8872),Qz=(Se(8362),Se(2843),Se(1922),Se(8142),Se(4355),Se(1828),Se(578),Se(2454)),Wz=(Se(5992),Se(6923),Se(4369));Se(6157),Se(6043),Se(1949);var lg=Object.freeze({Linear:Object.freeze({None:function(n){return n},In:function(n){return this.None(n)},Out:function(n){return this.None(n)},InOut:function(n){return this.None(n)}}),Quadratic:Object.freeze({In:function(n){return n*n},Out:function(n){return n*(2-n)},InOut:function(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)}}),Cubic:Object.freeze({In:function(n){return n*n*n},Out:function(n){return--n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)}}),Quartic:Object.freeze({In:function(n){return n*n*n*n},Out:function(n){return 1- --n*n*n*n},InOut:function(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)}}),Quintic:Object.freeze({In:function(n){return n*n*n*n*n},Out:function(n){return--n*n*n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)}}),Sinusoidal:Object.freeze({In:function(n){return 1-Math.sin((1-n)*Math.PI/2)},Out:function(n){return Math.sin(n*Math.PI/2)},InOut:function(n){return.5*(1-Math.sin(Math.PI*(.5-n)))}}),Exponential:Object.freeze({In:function(n){return 0===n?0:Math.pow(1024,n-1)},Out:function(n){return 1===n?1:1-Math.pow(2,-10*n)},InOut:function(n){return 0===n?0:1===n?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(2-Math.pow(2,-10*(n-1)))}}),Circular:Object.freeze({In:function(n){return 1-Math.sqrt(1-n*n)},Out:function(n){return Math.sqrt(1- --n*n)},InOut:function(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)}}),Elastic:Object.freeze({In:function(n){return 0===n?0:1===n?1:-Math.pow(2,10*(n-1))*Math.sin(5*(n-1.1)*Math.PI)},Out:function(n){return 0===n?0:1===n?1:Math.pow(2,-10*n)*Math.sin(5*(n-.1)*Math.PI)+1},InOut:function(n){return 0===n?0:1===n?1:(n*=2)<1?-.5*Math.pow(2,10*(n-1))*Math.sin(5*(n-1.1)*Math.PI):.5*Math.pow(2,-10*(n-1))*Math.sin(5*(n-1.1)*Math.PI)+1}}),Back:Object.freeze({In:function(n){var e=1.70158;return 1===n?1:n*n*((e+1)*n-e)},Out:function(n){var e=1.70158;return 0===n?0:--n*n*((e+1)*n+e)+1},InOut:function(n){var e=2.5949095;return(n*=2)<1?n*n*((e+1)*n-e)*.5:.5*((n-=2)*n*((e+1)*n+e)+2)}}),Bounce:Object.freeze({In:function(n){return 1-lg.Bounce.Out(1-n)},Out:function(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},InOut:function(n){return n<.5?.5*lg.Bounce.In(2*n):.5*lg.Bounce.Out(2*n-1)+.5}}),generatePow:function(n){return void 0===n&&(n=4),n=(n=n<Number.EPSILON?Number.EPSILON:n)>1e4?1e4:n,{In:function(e){return Math.pow(e,n)},Out:function(e){return 1-Math.pow(1-e,n)},InOut:function(e){return e<.5?Math.pow(2*e,n)/2:(1-Math.pow(2-2*e,n))/2+.5}}}}),p2=function(){return performance.now()},jz=function(){function n(){this._tweens={},this._tweensAddedDuringUpdate={}}return n.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(t){return e._tweens[t]})},n.prototype.removeAll=function(){this._tweens={}},n.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},n.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},n.prototype.update=function(e,t){void 0===e&&(e=p2()),void 0===t&&(t=!1);var i=Object.keys(this._tweens);if(0===i.length)return!1;for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<i.length;r++){var s=this._tweens[i[r]];s&&!1===s.update(e,!t)&&!t&&delete this._tweens[i[r]]}i=Object.keys(this._tweensAddedDuringUpdate)}return!0},n}(),Mb={Linear:function(n,e){var t=n.length-1,i=t*e,r=Math.floor(i),s=Mb.Utils.Linear;return e<0?s(n[0],n[1],i):e>1?s(n[t],n[t-1],t-i):s(n[r],n[r+1>t?t:r+1],i-r)},Bezier:function(n,e){for(var t=0,i=n.length-1,r=Math.pow,s=Mb.Utils.Bernstein,a=0;a<=i;a++)t+=r(1-e,i-a)*r(e,a)*n[a]*s(i,a);return t},CatmullRom:function(n,e){var t=n.length-1,i=t*e,r=Math.floor(i),s=Mb.Utils.CatmullRom;return n[0]===n[t]?(e<0&&(r=Math.floor(i=t*(1+e))),s(n[(r-1+t)%t],n[r],n[(r+1)%t],n[(r+2)%t],i-r)):e<0?n[0]-(s(n[0],n[0],n[1],n[1],-i)-n[0]):e>1?n[t]-(s(n[t],n[t],n[t-1],n[t-1],i-t)-n[t]):s(n[r?r-1:0],n[r],n[t<r+1?t:r+1],n[t<r+2?t:r+2],i-r)},Utils:{Linear:function(n,e,t){return(e-n)*t+n},Bernstein:function(n,e){var t=Mb.Utils.Factorial;return t(n)/t(e)/t(n-e)},Factorial:function(){var n=[1];return function(e){var t=1;if(n[e])return n[e];for(var i=e;i>1;i--)t*=i;return n[e]=t,t}}(),CatmullRom:function(n,e,t,i,r){var s=.5*(t-n),a=.5*(i-e),l=r*r;return(2*e-2*t+s+a)*(r*l)+(-3*e+3*t-2*s-a)*l+s*r+e}}},Ok=function(){function n(){}return n.nextId=function(){return n._nextId++},n._nextId=0,n}(),Lk=new jz,If=function(){function n(e,t){void 0===t&&(t=Lk),this._object=e,this._group=t,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=lg.Linear.None,this._interpolationFunction=Mb.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=Ok.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return n.prototype.getId=function(){return this._id},n.prototype.isPlaying=function(){return this._isPlaying},n.prototype.isPaused=function(){return this._isPaused},n.prototype.getDuration=function(){return this._duration},n.prototype.to=function(e,t){if(void 0===t&&(t=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t<0?0:t,this},n.prototype.duration=function(e){return void 0===e&&(e=1e3),this._duration=e<0?0:e,this},n.prototype.dynamic=function(e){return void 0===e&&(e=!1),this._isDynamic=e,this},n.prototype.start=function(e,t){if(void 0===e&&(e=p2()),void 0===t&&(t=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var i in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i];if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var r={};for(var s in this._valuesEnd)r[s]=this._valuesEnd[s];this._valuesEnd=r}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},n.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},n.prototype._setupProperties=function(e,t,i,r,s){for(var a in i){var l=e[a],d=Array.isArray(l),u=d?"array":typeof l,p=!d&&Array.isArray(i[a]);if("undefined"!==u&&"function"!==u){if(p){if(0===(_=i[a]).length)continue;for(var S=[l],R=0,H=_.length;R<H;R+=1){var re=this._handleRelativeValue(l,_[R]);if(isNaN(re)){p=!1,console.warn("Found invalid interpolation list. Skipping.");break}S.push(re)}p&&(i[a]=S)}if("object"!==u&&!d||!l||p)(typeof t[a]>"u"||s)&&(t[a]=l),d||(t[a]*=1),r[a]=p?i[a].slice().reverse():t[a]||0;else{t[a]=d?[]:{};var se=l;for(var ce in se)t[a][ce]=se[ce];r[a]=d?[]:{};var _=i[a];if(!this._isDynamic){var Te={};for(var ce in _)Te[ce]=_[ce];i[a]=_=Te}this._setupProperties(se,t[a],_,r[a],s)}}}},n.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},n.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},n.prototype.pause=function(e){return void 0===e&&(e=p2()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this)),this},n.prototype.resume=function(e){return void 0===e&&(e=p2()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},n.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},n.prototype.group=function(e){return void 0===e&&(e=Lk),this._group=e,this},n.prototype.delay=function(e){return void 0===e&&(e=0),this._delayTime=e,this},n.prototype.repeat=function(e){return void 0===e&&(e=0),this._initialRepeat=e,this._repeat=e,this},n.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},n.prototype.yoyo=function(e){return void 0===e&&(e=!1),this._yoyo=e,this},n.prototype.easing=function(e){return void 0===e&&(e=lg.Linear.None),this._easingFunction=e,this},n.prototype.interpolation=function(e){return void 0===e&&(e=Mb.Linear),this._interpolationFunction=e,this},n.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},n.prototype.onStart=function(e){return this._onStartCallback=e,this},n.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},n.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},n.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},n.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},n.prototype.onStop=function(e){return this._onStopCallback=e,this},n.prototype.update=function(e,t){var r,s,i=this;if(void 0===e&&(e=p2()),void 0===t&&(t=!0),this._isPaused)return!0;if(!this._goToEnd&&!this._isPlaying){if(e>this._startTime+this._duration)return!1;t&&this.start(e,!0)}if(this._goToEnd=!1,e<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),!1===this._onEveryStartCallbackFired&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var l=e-this._startTime,d=this._duration+(null!==(r=this._repeatDelayTime)&&void 0!==r?r:this._delayTime),u=this._duration+this._repeat*d,_=function(){if(0===i._duration||l>u)return 1;var se=Math.trunc(l/d),Te=Math.min((l-se*d)/i._duration,1);return 0===Te&&l===i._duration?1:Te}(),S=this._easingFunction(_);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,S),this._onUpdateCallback&&this._onUpdateCallback(this._object,_),0===this._duration||l>=this._duration){if(this._repeat>0){var R=Math.min(Math.trunc((l-this._duration)/d)+1,this._repeat);for(s in isFinite(this._repeat)&&(this._repeat-=R),this._valuesStartRepeat)!this._yoyo&&"string"==typeof this._valuesEnd[s]&&(this._valuesStartRepeat[s]=this._valuesStartRepeat[s]+parseFloat(this._valuesEnd[s])),this._yoyo&&this._swapEndStartRepeatValues(s),this._valuesStart[s]=this._valuesStartRepeat[s];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=d*R,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var H=0,re=this._chainedTweens.length;H<re;H++)this._chainedTweens[H].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},n.prototype._updateProperties=function(e,t,i,r){for(var s in i)if(void 0!==t[s]){var a=t[s]||0,l=i[s],d=Array.isArray(e[s]),u=Array.isArray(l);!d&&u?e[s]=this._interpolationFunction(l,r):"object"==typeof l&&l?this._updateProperties(e[s],a,l,r):"number"==typeof(l=this._handleRelativeValue(a,l))&&(e[s]=a+(l-a)*r)}},n.prototype._handleRelativeValue=function(e,t){return"string"!=typeof t?t:"+"===t.charAt(0)||"-"===t.charAt(0)?e+parseFloat(t):parseFloat(t)},n.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],i=this._valuesEnd[e];this._valuesStartRepeat[e]="string"==typeof i?this._valuesStartRepeat[e]+parseFloat(i):this._valuesEnd[e],this._valuesEnd[e]=t},n}(),w0=Lk,$z=(w0.getAll.bind(w0),w0.removeAll.bind(w0),w0.add.bind(w0),w0.remove.bind(w0),w0.update.bind(w0));const m2="162",Yz=1,kae=2,U_=3,zD=0,rle=1,sle=2,Iy=0,ole=1,ale=2,lle=3,cle=4,dle=5,ule=6,hle=7,tH="attached",By=301,Tb=302,zS=306,Py=1e3,bh=1001,_2=1002,vd=1003,Ry=1005,Hc=1006,y2=1007,oA=1008,ky=1009,Fy=1014,aA=1015,lA=1016,Db=1020,gp=1023,Ib=1026,v2=1027,b2=2300,Bb=2301,du="srgb",Wu="srgb-linear",Kk="display-p3",qD="display-p3-linear",QD="linear",Vc="srgb",WD="rec709",jD="p3",C2=7680,zH="300 es",H_=2e3;class V_{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const r=i.slice(0);for(let s=0,a=r.length;s<a;s++)r[s].call(this,e);e.target=null}}}const Uh=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let HH=1234567;const Rb=Math.PI/180,M2=180/Math.PI;function dm(){const n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Uh[255&n]+Uh[n>>8&255]+Uh[n>>16&255]+Uh[n>>24&255]+"-"+Uh[255&e]+Uh[e>>8&255]+"-"+Uh[e>>16&15|64]+Uh[e>>24&255]+"-"+Uh[63&t|128]+Uh[t>>8&255]+"-"+Uh[t>>16&255]+Uh[t>>24&255]+Uh[255&i]+Uh[i>>8&255]+Uh[i>>16&255]+Uh[i>>24&255]).toLowerCase()}function bd(n,e,t){return Math.max(e,Math.min(t,n))}function Jk(n,e){return(n%e+e)%e}function VS(n,e,t){return(1-t)*n+t*e}function e5(n){return!(n&n-1)&&0!==n}function YD(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function Bf(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Ea(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(4294967295*n);case Uint16Array:return Math.round(65535*n);case Uint8Array:return Math.round(255*n);case Int32Array:return Math.round(2147483647*n);case Int16Array:return Math.round(32767*n);case Int8Array:return Math.round(127*n);default:throw new Error("Invalid component type.")}}const GS={DEG2RAD:Rb,RAD2DEG:M2,generateUUID:dm,clamp:bd,euclideanModulo:Jk,mapLinear:function kle(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)},inverseLerp:function Fle(n,e,t){return n!==e?(t-n)/(e-n):0},lerp:VS,damp:function Ole(n,e,t,i){return VS(n,e,1-Math.exp(-t*i))},pingpong:function Lle(n,e=1){return e-Math.abs(Jk(n,2*e)-e)},smoothstep:function Nle(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e))*n*(3-2*n)},smootherstep:function Ule(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e))*n*n*(n*(6*n-15)+10)},randInt:function zle(n,e){return n+Math.floor(Math.random()*(e-n+1))},randFloat:function Hle(n,e){return n+Math.random()*(e-n)},randFloatSpread:function Vle(n){return n*(.5-Math.random())},seededRandom:function Gle(n){void 0!==n&&(HH=n);let e=HH+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},degToRad:function qle(n){return n*Rb},radToDeg:function Qle(n){return n*M2},isPowerOfTwo:e5,ceilPowerOfTwo:function Wle(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))},floorPowerOfTwo:YD,setQuaternionFromProperEuler:function jle(n,e,t,i,r){const s=Math.cos,a=Math.sin,l=s(t/2),d=a(t/2),u=s((e+i)/2),p=a((e+i)/2),_=s((e-i)/2),S=a((e-i)/2),R=s((i-e)/2),H=a((i-e)/2);switch(r){case"XYX":n.set(l*p,d*_,d*S,l*u);break;case"YZY":n.set(d*S,l*p,d*_,l*u);break;case"ZXZ":n.set(d*_,d*S,l*p,l*u);break;case"XZX":n.set(l*p,d*H,d*R,l*u);break;case"YXY":n.set(d*R,l*p,d*H,l*u);break;case"ZYZ":n.set(d*H,d*R,l*p,l*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},normalize:Ea,denormalize:Bf};class Qi{constructor(e=0,t=0){Qi.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(bd(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,a=this.y-e.y;return this.x=s*i-a*r+e.x,this.y=s*r+a*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ta{constructor(e,t,i,r,s,a,l,d,u){Ta.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,i,r,s,a,l,d,u)}set(e,t,i,r,s,a,l,d,u){const p=this.elements;return p[0]=e,p[1]=r,p[2]=l,p[3]=t,p[4]=s,p[5]=d,p[6]=i,p[7]=a,p[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,a=i[0],l=i[3],d=i[6],u=i[1],p=i[4],_=i[7],S=i[2],R=i[5],H=i[8],re=r[0],se=r[3],ce=r[6],Te=r[1],Ce=r[4],qe=r[7],wt=r[2],gt=r[5],Et=r[8];return s[0]=a*re+l*Te+d*wt,s[3]=a*se+l*Ce+d*gt,s[6]=a*ce+l*qe+d*Et,s[1]=u*re+p*Te+_*wt,s[4]=u*se+p*Ce+_*gt,s[7]=u*ce+p*qe+_*Et,s[2]=S*re+R*Te+H*wt,s[5]=S*se+R*Ce+H*gt,s[8]=S*ce+R*qe+H*Et,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],a=e[4],l=e[5],d=e[6],u=e[7],p=e[8];return t*a*p-t*l*u-i*s*p+i*l*d+r*s*u-r*a*d}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],a=e[4],l=e[5],d=e[6],u=e[7],p=e[8],_=p*a-l*u,S=l*d-p*s,R=u*s-a*d,H=t*_+i*S+r*R;if(0===H)return this.set(0,0,0,0,0,0,0,0,0);const re=1/H;return e[0]=_*re,e[1]=(r*u-p*i)*re,e[2]=(l*i-r*a)*re,e[3]=S*re,e[4]=(p*t-r*d)*re,e[5]=(r*s-l*t)*re,e[6]=R*re,e[7]=(i*d-u*t)*re,e[8]=(a*t-i*s)*re,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,a,l){const d=Math.cos(s),u=Math.sin(s);return this.set(i*d,i*u,-i*(d*a+u*l)+a+e,-r*u,r*d,-r*(-u*a+d*l)+l+t,0,0,1),this}scale(e,t){return this.premultiply(t5.makeScale(e,t)),this}rotate(e){return this.premultiply(t5.makeRotation(-e)),this}translate(e,t){return this.premultiply(t5.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const t5=new Ta;function VH(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const $le={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function S2(n,e){return new $le[n](e)}function qS(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function Xle(){const n=qS("canvas");return n.style.display="block",n}const GH={};function qH(n){n in GH||(GH[n]=!0,console.warn(n))}const QH=(new Ta).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),WH=(new Ta).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),KD={[Wu]:{transfer:QD,primaries:WD,toReference:n=>n,fromReference:n=>n},[du]:{transfer:Vc,primaries:WD,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[qD]:{transfer:QD,primaries:jD,toReference:n=>n.applyMatrix3(WH),fromReference:n=>n.applyMatrix3(QH)},[Kk]:{transfer:Vc,primaries:jD,toReference:n=>n.convertSRGBToLinear().applyMatrix3(WH),fromReference:n=>n.applyMatrix3(QH).convertLinearToSRGB()}},Yle=new Set([Wu,qD]),Ol={enabled:!0,_workingColorSpace:Wu,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!Yle.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){return!1!==this.enabled&&e!==t&&e&&t?(0,KD[t].fromReference)((0,KD[e].toReference)(n)):n},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return KD[n].primaries},getTransfer:function(n){return""===n?QD:KD[n].transfer}};function E2(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function n5(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}let T2;class jH{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===T2&&(T2=qS("canvas")),T2.width=e.width,T2.height=e.height;const i=T2.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=T2}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=qS("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let a=0;a<s.length;a++)s[a]=255*E2(s[a]/255);return i.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*E2(t[i]/255)):E2(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Kle=0;class kb{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Kle++}),this.uuid=dm(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let a=0,l=r.length;a<l;a++)s.push(r5(r[a].isDataTexture?r[a].image:r[a]))}else s=r5(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function r5(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?jH.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Zle=0,zh=(()=>{class n extends V_{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=bh,s=bh,a=Hc,l=oA,d=gp,u=ky,p=n.DEFAULT_ANISOTROPY,_=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Zle++}),this.uuid=dm(),this.name="",this.source=new kb(t),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=r,this.wrapT=s,this.magFilter=a,this.minFilter=l,this.anisotropy=p,this.format=d,this.internalFormat=null,this.type=u,this.offset=new Qi(0,0),this.repeat=new Qi(1,1),this.center=new Qi(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ta,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=_,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),i||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Py:t.x=t.x-Math.floor(t.x);break;case bh:t.x=t.x<0?0:1;break;case _2:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Py:t.y=t.y-Math.floor(t.y);break;case bh:t.y=t.y<0?0:1;break;case _2:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=300,n.DEFAULT_ANISOTROPY=1,n})();class nc{constructor(e=0,t=0,i=0,r=1){nc.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,a=e.elements;return this.x=a[0]*t+a[4]*i+a[8]*r+a[12]*s,this.y=a[1]*t+a[5]*i+a[9]*r+a[13]*s,this.z=a[2]*t+a[6]*i+a[10]*r+a[14]*s,this.w=a[3]*t+a[7]*i+a[11]*r+a[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const d=e.elements,u=d[0],p=d[4],_=d[8],S=d[1],R=d[5],H=d[9],re=d[2],se=d[6],ce=d[10];if(Math.abs(p-S)<.01&&Math.abs(_-re)<.01&&Math.abs(H-se)<.01){if(Math.abs(p+S)<.1&&Math.abs(_+re)<.1&&Math.abs(H+se)<.1&&Math.abs(u+R+ce-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const Ce=(u+1)/2,qe=(R+1)/2,wt=(ce+1)/2,gt=(p+S)/4,Et=(_+re)/4,Xt=(H+se)/4;return Ce>qe&&Ce>wt?Ce<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(Ce),r=gt/i,s=Et/i):qe>wt?qe<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(qe),i=gt/r,s=Xt/r):wt<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(wt),i=Et/s,r=Xt/s),this.set(i,r,s,t),this}let Te=Math.sqrt((se-H)*(se-H)+(_-re)*(_-re)+(S-p)*(S-p));return Math.abs(Te)<.001&&(Te=1),this.x=(se-H)/Te,this.y=(_-re)/Te,this.z=(S-p)/Te,this.w=Math.acos((u+R+ce-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Jle extends V_{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new nc(0,0,e,t),this.scissorTest=!1,this.viewport=new nc(0,0,e,t);const r={width:e,height:t,depth:1};i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Hc,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0,count:1},i);const s=new zh(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace);s.flipY=!1,s.generateMipmaps=i.generateMipmaps,s.internalFormat=i.internalFormat,this.textures=[];const a=i.count;for(let l=0;l<a;l++)this.textures[l]=s.clone(),this.textures[l].isRenderTargetTexture=!0;this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=i;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let i=0,r=e.textures.length;i<r;i++)this.textures[i]=e.textures[i].clone(),this.textures[i].isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new kb(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class ju extends Jle{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class s5 extends zh{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=vd,this.minFilter=vd,this.wrapR=bh,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class $H extends zh{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=vd,this.minFilter=vd,this.wrapR=bh,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Gc{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,a,l){let d=i[r+0],u=i[r+1],p=i[r+2],_=i[r+3];const S=s[a+0],R=s[a+1],H=s[a+2],re=s[a+3];if(0===l)return e[t+0]=d,e[t+1]=u,e[t+2]=p,void(e[t+3]=_);if(1===l)return e[t+0]=S,e[t+1]=R,e[t+2]=H,void(e[t+3]=re);if(_!==re||d!==S||u!==R||p!==H){let se=1-l;const ce=d*S+u*R+p*H+_*re,Te=ce>=0?1:-1,Ce=1-ce*ce;if(Ce>Number.EPSILON){const wt=Math.sqrt(Ce),gt=Math.atan2(wt,ce*Te);se=Math.sin(se*gt)/wt,l=Math.sin(l*gt)/wt}const qe=l*Te;if(d=d*se+S*qe,u=u*se+R*qe,p=p*se+H*qe,_=_*se+re*qe,se===1-l){const wt=1/Math.sqrt(d*d+u*u+p*p+_*_);d*=wt,u*=wt,p*=wt,_*=wt}}e[t]=d,e[t+1]=u,e[t+2]=p,e[t+3]=_}static multiplyQuaternionsFlat(e,t,i,r,s,a){const l=i[r],d=i[r+1],u=i[r+2],p=i[r+3],_=s[a],S=s[a+1],R=s[a+2],H=s[a+3];return e[t]=l*H+p*_+d*R-u*S,e[t+1]=d*H+p*S+u*_-l*R,e[t+2]=u*H+p*R+l*S-d*_,e[t+3]=p*H-l*_-d*S-u*R,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const i=e._x,r=e._y,s=e._z,a=e._order,l=Math.cos,d=Math.sin,u=l(i/2),p=l(r/2),_=l(s/2),S=d(i/2),R=d(r/2),H=d(s/2);switch(a){case"XYZ":this._x=S*p*_+u*R*H,this._y=u*R*_-S*p*H,this._z=u*p*H+S*R*_,this._w=u*p*_-S*R*H;break;case"YXZ":this._x=S*p*_+u*R*H,this._y=u*R*_-S*p*H,this._z=u*p*H-S*R*_,this._w=u*p*_+S*R*H;break;case"ZXY":this._x=S*p*_-u*R*H,this._y=u*R*_+S*p*H,this._z=u*p*H+S*R*_,this._w=u*p*_-S*R*H;break;case"ZYX":this._x=S*p*_-u*R*H,this._y=u*R*_+S*p*H,this._z=u*p*H-S*R*_,this._w=u*p*_+S*R*H;break;case"YZX":this._x=S*p*_+u*R*H,this._y=u*R*_+S*p*H,this._z=u*p*H-S*R*_,this._w=u*p*_-S*R*H;break;case"XZY":this._x=S*p*_-u*R*H,this._y=u*R*_-S*p*H,this._z=u*p*H+S*R*_,this._w=u*p*_+S*R*H;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],a=t[1],l=t[5],d=t[9],u=t[2],p=t[6],_=t[10],S=i+l+_;if(S>0){const R=.5/Math.sqrt(S+1);this._w=.25/R,this._x=(p-d)*R,this._y=(s-u)*R,this._z=(a-r)*R}else if(i>l&&i>_){const R=2*Math.sqrt(1+i-l-_);this._w=(p-d)/R,this._x=.25*R,this._y=(r+a)/R,this._z=(s+u)/R}else if(l>_){const R=2*Math.sqrt(1+l-i-_);this._w=(s-u)/R,this._x=(r+a)/R,this._y=.25*R,this._z=(d+p)/R}else{const R=2*Math.sqrt(1+_-i-l);this._w=(a-r)/R,this._x=(s+u)/R,this._y=(d+p)/R,this._z=.25*R}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(bd(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,a=e._w,l=t._x,d=t._y,u=t._z,p=t._w;return this._x=i*p+a*l+r*u-s*d,this._y=r*p+a*d+s*l-i*u,this._z=s*p+a*u+i*d-r*l,this._w=a*p-i*l-r*d-s*u,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,r=this._y,s=this._z,a=this._w;let l=a*e._w+i*e._x+r*e._y+s*e._z;if(l<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,l=-l):this.copy(e),l>=1)return this._w=a,this._x=i,this._y=r,this._z=s,this;const d=1-l*l;if(d<=Number.EPSILON){const R=1-t;return this._w=R*a+t*this._w,this._x=R*i+t*this._x,this._y=R*r+t*this._y,this._z=R*s+t*this._z,this.normalize(),this}const u=Math.sqrt(d),p=Math.atan2(u,l),_=Math.sin((1-t)*p)/u,S=Math.sin(t*p)/u;return this._w=a*_+this._w*S,this._x=i*_+this._x*S,this._y=r*_+this._y*S,this._z=s*_+this._z*S,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),i=Math.random(),r=Math.sqrt(1-i),s=Math.sqrt(i);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class It{constructor(e=0,t=0,i=0){It.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(XH.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(XH.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,a=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*a,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*a,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*a,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,a=e.y,l=e.z,d=e.w,u=2*(a*r-l*i),p=2*(l*t-s*r),_=2*(s*i-a*t);return this.x=t+d*u+a*_-l*p,this.y=i+d*p+l*u-s*_,this.z=r+d*_+s*p-a*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,a=t.x,l=t.y,d=t.z;return this.x=r*d-s*l,this.y=s*a-i*d,this.z=i*l-r*a,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return o5.copy(this).projectOnVector(e),this.sub(o5)}reflect(e){return this.sub(o5.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(bd(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=2*Math.random()-1,i=Math.sqrt(1-t*t);return this.x=i*Math.cos(e),this.y=t,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const o5=new It,XH=new Gc;class Pf{constructor(e=new It(1/0,1/0,1/0),t=new It(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(dg.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(dg.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=dg.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(void 0!==i){const s=i.getAttribute("position");if(!0===t&&void 0!==s&&!0!==e.isInstancedMesh)for(let a=0,l=s.count;a<l;a++)!0===e.isMesh?e.getVertexPosition(a,dg):dg.fromBufferAttribute(s,a),dg.applyMatrix4(e.matrixWorld),this.expandByPoint(dg);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),ZD.copy(e.boundingBox)):(null===i.boundingBox&&i.computeBoundingBox(),ZD.copy(i.boundingBox)),ZD.applyMatrix4(e.matrixWorld),this.union(ZD)}const r=e.children;for(let s=0,a=r.length;s<a;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,dg),dg.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(QS),JD.subVectors(this.max,QS),D2.subVectors(e.a,QS),I2.subVectors(e.b,QS),B2.subVectors(e.c,QS),Oy.subVectors(I2,D2),Ly.subVectors(B2,I2),Fb.subVectors(D2,B2);let t=[0,-Oy.z,Oy.y,0,-Ly.z,Ly.y,0,-Fb.z,Fb.y,Oy.z,0,-Oy.x,Ly.z,0,-Ly.x,Fb.z,0,-Fb.x,-Oy.y,Oy.x,0,-Ly.y,Ly.x,0,-Fb.y,Fb.x,0];return!(!a5(t,D2,I2,B2,JD)||(t=[1,0,0,0,1,0,0,0,1],!a5(t,D2,I2,B2,JD)))&&(eI.crossVectors(Oy,Ly),t=[eI.x,eI.y,eI.z],a5(t,D2,I2,B2,JD))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,dg).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(dg).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(G_[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),G_[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),G_[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),G_[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),G_[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),G_[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),G_[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),G_[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(G_)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const G_=[new It,new It,new It,new It,new It,new It,new It,new It],dg=new It,ZD=new Pf,D2=new It,I2=new It,B2=new It,Oy=new It,Ly=new It,Fb=new It,QS=new It,JD=new It,eI=new It,Ob=new It;function a5(n,e,t,i,r){for(let s=0,a=n.length-3;s<=a;s+=3){Ob.fromArray(n,s);const l=r.x*Math.abs(Ob.x)+r.y*Math.abs(Ob.y)+r.z*Math.abs(Ob.z),d=e.dot(Ob),u=t.dot(Ob),p=i.dot(Ob);if(Math.max(-Math.max(d,u,p),Math.min(d,u,p))>l)return!1}return!0}const ece=new Pf,WS=new It,l5=new It;class $u{constructor(e=new It,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):ece.setFromPoints(e).getCenter(i);let r=0;for(let s=0,a=e.length;s<a;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;WS.subVectors(e,this.center);const t=WS.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=.5*(i-this.radius);this.center.addScaledVector(WS,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(l5.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(WS.copy(e.center).add(l5)),this.expandByPoint(WS.copy(e.center).sub(l5))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const q_=new It,c5=new It,tI=new It,Ny=new It,d5=new It,nI=new It,u5=new It;class P2{constructor(e=new It,t=new It(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,q_)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=q_.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(q_.copy(this.origin).addScaledVector(this.direction,t),q_.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){c5.copy(e).add(t).multiplyScalar(.5),tI.copy(t).sub(e).normalize(),Ny.copy(this.origin).sub(c5);const s=.5*e.distanceTo(t),a=-this.direction.dot(tI),l=Ny.dot(this.direction),d=-Ny.dot(tI),u=Ny.lengthSq(),p=Math.abs(1-a*a);let _,S,R,H;if(p>0)if(_=a*d-l,S=a*l-d,H=s*p,_>=0)if(S>=-H)if(S<=H){const re=1/p;_*=re,S*=re,R=_*(_+a*S+2*l)+S*(a*_+S+2*d)+u}else S=s,_=Math.max(0,-(a*S+l)),R=-_*_+S*(S+2*d)+u;else S=-s,_=Math.max(0,-(a*S+l)),R=-_*_+S*(S+2*d)+u;else S<=-H?(_=Math.max(0,-(-a*s+l)),S=_>0?-s:Math.min(Math.max(-s,-d),s),R=-_*_+S*(S+2*d)+u):S<=H?(_=0,S=Math.min(Math.max(-s,-d),s),R=S*(S+2*d)+u):(_=Math.max(0,-(a*s+l)),S=_>0?s:Math.min(Math.max(-s,-d),s),R=-_*_+S*(S+2*d)+u);else S=a>0?-s:s,_=Math.max(0,-(a*S+l)),R=-_*_+S*(S+2*d)+u;return i&&i.copy(this.origin).addScaledVector(this.direction,_),r&&r.copy(c5).addScaledVector(tI,S),R}intersectSphere(e,t){q_.subVectors(e.center,this.origin);const i=q_.dot(this.direction),r=q_.dot(q_)-i*i,s=e.radius*e.radius;if(r>s)return null;const a=Math.sqrt(s-r),l=i-a,d=i+a;return d<0?null:this.at(l<0?d:l,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,a,l,d;const u=1/this.direction.x,p=1/this.direction.y,_=1/this.direction.z,S=this.origin;return u>=0?(i=(e.min.x-S.x)*u,r=(e.max.x-S.x)*u):(i=(e.max.x-S.x)*u,r=(e.min.x-S.x)*u),p>=0?(s=(e.min.y-S.y)*p,a=(e.max.y-S.y)*p):(s=(e.max.y-S.y)*p,a=(e.min.y-S.y)*p),i>a||s>r||((s>i||isNaN(i))&&(i=s),(a<r||isNaN(r))&&(r=a),_>=0?(l=(e.min.z-S.z)*_,d=(e.max.z-S.z)*_):(l=(e.max.z-S.z)*_,d=(e.min.z-S.z)*_),i>d||l>r)||((l>i||i!=i)&&(i=l),(d<r||r!=r)&&(r=d),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,q_)}intersectTriangle(e,t,i,r,s){d5.subVectors(t,e),nI.subVectors(i,e),u5.crossVectors(d5,nI);let l,a=this.direction.dot(u5);if(a>0){if(r)return null;l=1}else{if(!(a<0))return null;l=-1,a=-a}Ny.subVectors(this.origin,e);const d=l*this.direction.dot(nI.crossVectors(Ny,nI));if(d<0)return null;const u=l*this.direction.dot(d5.cross(Ny));if(u<0||d+u>a)return null;const p=-l*Ny.dot(u5);return p<0?null:this.at(p/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class wo{constructor(e,t,i,r,s,a,l,d,u,p,_,S,R,H,re,se){wo.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,i,r,s,a,l,d,u,p,_,S,R,H,re,se)}set(e,t,i,r,s,a,l,d,u,p,_,S,R,H,re,se){const ce=this.elements;return ce[0]=e,ce[4]=t,ce[8]=i,ce[12]=r,ce[1]=s,ce[5]=a,ce[9]=l,ce[13]=d,ce[2]=u,ce[6]=p,ce[10]=_,ce[14]=S,ce[3]=R,ce[7]=H,ce[11]=re,ce[15]=se,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new wo).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/R2.setFromMatrixColumn(e,0).length(),s=1/R2.setFromMatrixColumn(e,1).length(),a=1/R2.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*a,t[9]=i[9]*a,t[10]=i[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,a=Math.cos(i),l=Math.sin(i),d=Math.cos(r),u=Math.sin(r),p=Math.cos(s),_=Math.sin(s);if("XYZ"===e.order){const S=a*p,R=a*_,H=l*p,re=l*_;t[0]=d*p,t[4]=-d*_,t[8]=u,t[1]=R+H*u,t[5]=S-re*u,t[9]=-l*d,t[2]=re-S*u,t[6]=H+R*u,t[10]=a*d}else if("YXZ"===e.order){const S=d*p,R=d*_,H=u*p,re=u*_;t[0]=S+re*l,t[4]=H*l-R,t[8]=a*u,t[1]=a*_,t[5]=a*p,t[9]=-l,t[2]=R*l-H,t[6]=re+S*l,t[10]=a*d}else if("ZXY"===e.order){const S=d*p,R=d*_,H=u*p,re=u*_;t[0]=S-re*l,t[4]=-a*_,t[8]=H+R*l,t[1]=R+H*l,t[5]=a*p,t[9]=re-S*l,t[2]=-a*u,t[6]=l,t[10]=a*d}else if("ZYX"===e.order){const S=a*p,R=a*_,H=l*p,re=l*_;t[0]=d*p,t[4]=H*u-R,t[8]=S*u+re,t[1]=d*_,t[5]=re*u+S,t[9]=R*u-H,t[2]=-u,t[6]=l*d,t[10]=a*d}else if("YZX"===e.order){const S=a*d,R=a*u,H=l*d,re=l*u;t[0]=d*p,t[4]=re-S*_,t[8]=H*_+R,t[1]=_,t[5]=a*p,t[9]=-l*p,t[2]=-u*p,t[6]=R*_+H,t[10]=S-re*_}else if("XZY"===e.order){const S=a*d,R=a*u,H=l*d,re=l*u;t[0]=d*p,t[4]=-_,t[8]=u*p,t[1]=S*_+re,t[5]=a*p,t[9]=R*_-H,t[2]=H*_-R,t[6]=l*p,t[10]=re*_+S}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(tce,e,nce)}lookAt(e,t,i){const r=this.elements;return um.subVectors(e,t),0===um.lengthSq()&&(um.z=1),um.normalize(),Uy.crossVectors(i,um),0===Uy.lengthSq()&&(1===Math.abs(i.z)?um.x+=1e-4:um.z+=1e-4,um.normalize(),Uy.crossVectors(i,um)),Uy.normalize(),iI.crossVectors(um,Uy),r[0]=Uy.x,r[4]=iI.x,r[8]=um.x,r[1]=Uy.y,r[5]=iI.y,r[9]=um.y,r[2]=Uy.z,r[6]=iI.z,r[10]=um.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,a=i[0],l=i[4],d=i[8],u=i[12],p=i[1],_=i[5],S=i[9],R=i[13],H=i[2],re=i[6],se=i[10],ce=i[14],Te=i[3],Ce=i[7],qe=i[11],wt=i[15],gt=r[0],Et=r[4],Xt=r[8],Un=r[12],Ct=r[1],Kt=r[5],Gi=r[9],Yi=r[13],En=r[2],wi=r[6],zn=r[10],oi=r[14],hi=r[3],vi=r[7],mr=r[11],Mr=r[15];return s[0]=a*gt+l*Ct+d*En+u*hi,s[4]=a*Et+l*Kt+d*wi+u*vi,s[8]=a*Xt+l*Gi+d*zn+u*mr,s[12]=a*Un+l*Yi+d*oi+u*Mr,s[1]=p*gt+_*Ct+S*En+R*hi,s[5]=p*Et+_*Kt+S*wi+R*vi,s[9]=p*Xt+_*Gi+S*zn+R*mr,s[13]=p*Un+_*Yi+S*oi+R*Mr,s[2]=H*gt+re*Ct+se*En+ce*hi,s[6]=H*Et+re*Kt+se*wi+ce*vi,s[10]=H*Xt+re*Gi+se*zn+ce*mr,s[14]=H*Un+re*Yi+se*oi+ce*Mr,s[3]=Te*gt+Ce*Ct+qe*En+wt*hi,s[7]=Te*Et+Ce*Kt+qe*wi+wt*vi,s[11]=Te*Xt+Ce*Gi+qe*zn+wt*mr,s[15]=Te*Un+Ce*Yi+qe*oi+wt*Mr,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],a=e[1],l=e[5],d=e[9],u=e[13],p=e[2],_=e[6],S=e[10],R=e[14];return e[3]*(+s*d*_-r*u*_-s*l*S+i*u*S+r*l*R-i*d*R)+e[7]*(+t*d*R-t*u*S+s*a*S-r*a*R+r*u*p-s*d*p)+e[11]*(+t*u*_-t*l*R-s*a*_+i*a*R+s*l*p-i*u*p)+e[15]*(-r*l*p-t*d*_+t*l*S+r*a*_-i*a*S+i*d*p)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],a=e[4],l=e[5],d=e[6],u=e[7],p=e[8],_=e[9],S=e[10],R=e[11],H=e[12],re=e[13],se=e[14],ce=e[15],Te=_*se*u-re*S*u+re*d*R-l*se*R-_*d*ce+l*S*ce,Ce=H*S*u-p*se*u-H*d*R+a*se*R+p*d*ce-a*S*ce,qe=p*re*u-H*_*u+H*l*R-a*re*R-p*l*ce+a*_*ce,wt=H*_*d-p*re*d-H*l*S+a*re*S+p*l*se-a*_*se,gt=t*Te+i*Ce+r*qe+s*wt;if(0===gt)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const Et=1/gt;return e[0]=Te*Et,e[1]=(re*S*s-_*se*s-re*r*R+i*se*R+_*r*ce-i*S*ce)*Et,e[2]=(l*se*s-re*d*s+re*r*u-i*se*u-l*r*ce+i*d*ce)*Et,e[3]=(_*d*s-l*S*s-_*r*u+i*S*u+l*r*R-i*d*R)*Et,e[4]=Ce*Et,e[5]=(p*se*s-H*S*s+H*r*R-t*se*R-p*r*ce+t*S*ce)*Et,e[6]=(H*d*s-a*se*s-H*r*u+t*se*u+a*r*ce-t*d*ce)*Et,e[7]=(a*S*s-p*d*s+p*r*u-t*S*u-a*r*R+t*d*R)*Et,e[8]=qe*Et,e[9]=(H*_*s-p*re*s-H*i*R+t*re*R+p*i*ce-t*_*ce)*Et,e[10]=(a*re*s-H*l*s+H*i*u-t*re*u-a*i*ce+t*l*ce)*Et,e[11]=(p*l*s-a*_*s-p*i*u+t*_*u+a*i*R-t*l*R)*Et,e[12]=wt*Et,e[13]=(p*re*r-H*_*r+H*i*S-t*re*S-p*i*se+t*_*se)*Et,e[14]=(H*l*r-a*re*r-H*i*d+t*re*d+a*i*se-t*l*se)*Et,e[15]=(a*_*r-p*l*r+p*i*d-t*_*d-a*i*S+t*l*S)*Et,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,a=e.x,l=e.y,d=e.z,u=s*a,p=s*l;return this.set(u*a+i,u*l-r*d,u*d+r*l,0,u*l+r*d,p*l+i,p*d-r*a,0,u*d-r*l,p*d+r*a,s*d*d+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,a){return this.set(1,i,s,0,e,1,a,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,a=t._y,l=t._z,d=t._w,u=s+s,p=a+a,_=l+l,S=s*u,R=s*p,H=s*_,re=a*p,se=a*_,ce=l*_,Te=d*u,Ce=d*p,qe=d*_,wt=i.x,gt=i.y,Et=i.z;return r[0]=(1-(re+ce))*wt,r[1]=(R+qe)*wt,r[2]=(H-Ce)*wt,r[3]=0,r[4]=(R-qe)*gt,r[5]=(1-(S+ce))*gt,r[6]=(se+Te)*gt,r[7]=0,r[8]=(H+Ce)*Et,r[9]=(se-Te)*Et,r[10]=(1-(S+re))*Et,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=R2.set(r[0],r[1],r[2]).length();const a=R2.set(r[4],r[5],r[6]).length(),l=R2.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],ug.copy(this);const u=1/s,p=1/a,_=1/l;return ug.elements[0]*=u,ug.elements[1]*=u,ug.elements[2]*=u,ug.elements[4]*=p,ug.elements[5]*=p,ug.elements[6]*=p,ug.elements[8]*=_,ug.elements[9]*=_,ug.elements[10]*=_,t.setFromRotationMatrix(ug),i.x=s,i.y=a,i.z=l,this}makePerspective(e,t,i,r,s,a,l=H_){const d=this.elements,u=2*s/(t-e),p=2*s/(i-r),_=(t+e)/(t-e),S=(i+r)/(i-r);let R,H;if(l===H_)R=-(a+s)/(a-s),H=-2*a*s/(a-s);else{if(2001!==l)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);R=-a/(a-s),H=-a*s/(a-s)}return d[0]=u,d[4]=0,d[8]=_,d[12]=0,d[1]=0,d[5]=p,d[9]=S,d[13]=0,d[2]=0,d[6]=0,d[10]=R,d[14]=H,d[3]=0,d[7]=0,d[11]=-1,d[15]=0,this}makeOrthographic(e,t,i,r,s,a,l=H_){const d=this.elements,u=1/(t-e),p=1/(i-r),_=1/(a-s),S=(t+e)*u,R=(i+r)*p;let H,re;if(l===H_)H=(a+s)*_,re=-2*_;else{if(2001!==l)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);H=s*_,re=-1*_}return d[0]=2*u,d[4]=0,d[8]=0,d[12]=-S,d[1]=0,d[5]=2*p,d[9]=0,d[13]=-R,d[2]=0,d[6]=0,d[10]=re,d[14]=-H,d[3]=0,d[7]=0,d[11]=0,d[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const R2=new It,ug=new wo,tce=new It(0,0,0),nce=new It(1,1,1),Uy=new It,iI=new It,um=new It,YH=new wo,KH=new Gc;let M0=(()=>{class n{constructor(t=0,i=0,r=0,s=n.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,r,s=this._order){return this._x=t,this._y=i,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,r=!0){const s=t.elements,a=s[0],l=s[4],d=s[8],u=s[1],p=s[5],_=s[9],S=s[2],R=s[6],H=s[10];switch(i){case"XYZ":this._y=Math.asin(bd(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(-_,H),this._z=Math.atan2(-l,a)):(this._x=Math.atan2(R,p),this._z=0);break;case"YXZ":this._x=Math.asin(-bd(_,-1,1)),Math.abs(_)<.9999999?(this._y=Math.atan2(d,H),this._z=Math.atan2(u,p)):(this._y=Math.atan2(-S,a),this._z=0);break;case"ZXY":this._x=Math.asin(bd(R,-1,1)),Math.abs(R)<.9999999?(this._y=Math.atan2(-S,H),this._z=Math.atan2(-l,p)):(this._y=0,this._z=Math.atan2(u,a));break;case"ZYX":this._y=Math.asin(-bd(S,-1,1)),Math.abs(S)<.9999999?(this._x=Math.atan2(R,H),this._z=Math.atan2(u,a)):(this._x=0,this._z=Math.atan2(-l,p));break;case"YZX":this._z=Math.asin(bd(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-_,p),this._y=Math.atan2(-S,a)):(this._x=0,this._y=Math.atan2(d,H));break;case"XZY":this._z=Math.asin(-bd(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(R,p),this._y=Math.atan2(d,a)):(this._x=Math.atan2(-_,H),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,i,r){return YH.makeRotationFromQuaternion(t),this.setFromRotationMatrix(YH,i,r)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return KH.setFromEuler(this),this.setFromQuaternion(KH,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return n.DEFAULT_ORDER="XYZ",n})();class h5{constructor(){this.mask=1}set(e){this.mask=1<<e>>>0}enable(e){this.mask|=1<<e}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e}disable(e){this.mask&=~(1<<e)}disableAll(){this.mask=0}test(e){return!!(this.mask&e.mask)}isEnabled(e){return!!(this.mask&1<<e)}}let ice=0;const ZH=new It,k2=new Gc,Q_=new wo,rI=new It,jS=new It,rce=new It,sce=new Gc,JH=new It(1,0,0),eV=new It(0,1,0),tV=new It(0,0,1),oce={type:"added"},ace={type:"removed"},f5={type:"childadded",child:null},p5={type:"childremoved",child:null};let Pl=(()=>{class n extends V_{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:ice++}),this.uuid=dm(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=n.DEFAULT_UP.clone();const t=new It,i=new M0,r=new Gc,s=new It(1,1,1);i._onChange(function a(){r.setFromEuler(i,!1)}),r._onChange(function l(){i.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new wo},normalMatrix:{value:new Ta}}),this.matrix=new wo,this.matrixWorld=new wo,this.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new h5,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return k2.setFromAxisAngle(t,i),this.quaternion.multiply(k2),this}rotateOnWorldAxis(t,i){return k2.setFromAxisAngle(t,i),this.quaternion.premultiply(k2),this}rotateX(t){return this.rotateOnAxis(JH,t)}rotateY(t){return this.rotateOnAxis(eV,t)}rotateZ(t){return this.rotateOnAxis(tV,t)}translateOnAxis(t,i){return ZH.copy(t).applyQuaternion(this.quaternion),this.position.add(ZH.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(JH,t)}translateY(t){return this.translateOnAxis(eV,t)}translateZ(t){return this.translateOnAxis(tV,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Q_.copy(this.matrixWorld).invert())}lookAt(t,i,r){t.isVector3?rI.copy(t):rI.set(t,i,r);const s=this.parent;this.updateWorldMatrix(!0,!1),jS.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Q_.lookAt(jS,rI,this.up):Q_.lookAt(rI,jS,this.up),this.quaternion.setFromRotationMatrix(Q_),s&&(Q_.extractRotation(s.matrixWorld),k2.setFromRotationMatrix(Q_),this.quaternion.premultiply(k2.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(oce),f5.child=t,this.dispatchEvent(f5),f5.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(ace),p5.child=t,this.dispatchEvent(p5),p5.child=null),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),Q_.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Q_.multiply(t.parent.matrixWorld)),t.applyMatrix4(Q_),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let r=0,s=this.children.length;r<s;r++){const l=this.children[r].getObjectByProperty(t,i);if(void 0!==l)return l}}getObjectsByProperty(t,i,r=[]){this[t]===i&&r.push(this);const s=this.children;for(let a=0,l=s.length;a<l;a++)s[a].getObjectsByProperty(t,i,r);return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(jS,t,rce),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(jS,sce,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverseVisible(t)}traverseAncestors(t){const i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let r=0,s=i.length;r<s;r++){const a=i[r];(!0===a.matrixWorldAutoUpdate||!0===t)&&a.updateMatrixWorld(t)}}updateWorldMatrix(t,i){const r=this.parent;if(!0===t&&null!==r&&!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===i){const s=this.children;for(let a=0,l=s.length;a<l;a++){const d=s[a];!0===d.matrixWorldAutoUpdate&&d.updateWorldMatrix(!1,!0)}}}toJSON(t){const i=void 0===t||"string"==typeof t,r={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};function a(d,u){return void 0===d[u.uuid]&&(d[u.uuid]=u.toJSON(t)),u.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.visibility=this._visibility,s.active=this._active,s.bounds=this._bounds.map(d=>({boxInitialized:d.boxInitialized,boxMin:d.box.min.toArray(),boxMax:d.box.max.toArray(),sphereInitialized:d.sphereInitialized,sphereRadius:d.sphere.radius,sphereCenter:d.sphere.center.toArray()})),s.maxGeometryCount=this._maxGeometryCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.geometryCount=this._geometryCount,s.matricesTexture=this._matricesTexture.toJSON(t),null!==this.boundingSphere&&(s.boundingSphere={center:s.boundingSphere.center.toArray(),radius:s.boundingSphere.radius}),null!==this.boundingBox&&(s.boundingBox={min:s.boundingBox.min.toArray(),max:s.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=a(t.geometries,this.geometry);const d=this.geometry.parameters;if(void 0!==d&&void 0!==d.shapes){const u=d.shapes;if(Array.isArray(u))for(let p=0,_=u.length;p<_;p++)a(t.shapes,u[p]);else a(t.shapes,u)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(a(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const d=[];for(let u=0,p=this.material.length;u<p;u++)d.push(a(t.materials,this.material[u]));s.material=d}else s.material=a(t.materials,this.material);if(this.children.length>0){s.children=[];for(let d=0;d<this.children.length;d++)s.children.push(this.children[d].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let d=0;d<this.animations.length;d++)s.animations.push(a(t.animations,this.animations[d]))}if(i){const d=l(t.geometries),u=l(t.materials),p=l(t.textures),_=l(t.images),S=l(t.shapes),R=l(t.skeletons),H=l(t.animations),re=l(t.nodes);d.length>0&&(r.geometries=d),u.length>0&&(r.materials=u),p.length>0&&(r.textures=p),_.length>0&&(r.images=_),S.length>0&&(r.shapes=S),R.length>0&&(r.skeletons=R),H.length>0&&(r.animations=H),re.length>0&&(r.nodes=re)}return r.object=s,r;function l(d){const u=[];for(const p in d){const _=d[p];delete _.metadata,u.push(_)}return u}}clone(t){return(new this.constructor).copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return n.DEFAULT_UP=new It(0,1,0),n.DEFAULT_MATRIX_AUTO_UPDATE=!0,n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,n})();const hg=new It,W_=new It,m5=new It,j_=new It,F2=new It,O2=new It,nV=new It,A5=new It,g5=new It,_5=new It;class hm{constructor(e=new It,t=new It,i=new It){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),hg.subVectors(e,t),r.cross(hg);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){hg.subVectors(r,t),W_.subVectors(i,t),m5.subVectors(e,t);const a=hg.dot(hg),l=hg.dot(W_),d=hg.dot(m5),u=W_.dot(W_),p=W_.dot(m5),_=a*u-l*l;if(0===_)return s.set(0,0,0),null;const S=1/_,R=(u*d-l*p)*S,H=(a*p-l*d)*S;return s.set(1-R-H,H,R)}static containsPoint(e,t,i,r){return null!==this.getBarycoord(e,t,i,r,j_)&&j_.x>=0&&j_.y>=0&&j_.x+j_.y<=1}static getInterpolation(e,t,i,r,s,a,l,d){return null===this.getBarycoord(e,t,i,r,j_)?(d.x=0,d.y=0,"z"in d&&(d.z=0),"w"in d&&(d.w=0),null):(d.setScalar(0),d.addScaledVector(s,j_.x),d.addScaledVector(a,j_.y),d.addScaledVector(l,j_.z),d)}static isFrontFacing(e,t,i,r){return hg.subVectors(i,t),W_.subVectors(e,t),hg.cross(W_).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return hg.subVectors(this.c,this.b),W_.subVectors(this.a,this.b),.5*hg.cross(W_).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return hm.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return hm.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,i,r,s){return hm.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return hm.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return hm.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let a,l;F2.subVectors(r,i),O2.subVectors(s,i),A5.subVectors(e,i);const d=F2.dot(A5),u=O2.dot(A5);if(d<=0&&u<=0)return t.copy(i);g5.subVectors(e,r);const p=F2.dot(g5),_=O2.dot(g5);if(p>=0&&_<=p)return t.copy(r);const S=d*_-p*u;if(S<=0&&d>=0&&p<=0)return a=d/(d-p),t.copy(i).addScaledVector(F2,a);_5.subVectors(e,s);const R=F2.dot(_5),H=O2.dot(_5);if(H>=0&&R<=H)return t.copy(s);const re=R*u-d*H;if(re<=0&&u>=0&&H<=0)return l=u/(u-H),t.copy(i).addScaledVector(O2,l);const se=p*H-R*_;if(se<=0&&_-p>=0&&R-H>=0)return nV.subVectors(s,r),l=(_-p)/(_-p+(R-H)),t.copy(r).addScaledVector(nV,l);const ce=1/(se+re+S);return a=re*ce,l=S*ce,t.copy(i).addScaledVector(F2,a).addScaledVector(O2,l)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const iV={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},zy={h:0,s:0,l:0},sI={h:0,s:0,l:0};function y5(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+6*(e-n)*(2/3-t):n}class Cr{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(void 0===t&&void 0===i){const r=e;r&&r.isColor?this.copy(r):"number"==typeof r?this.setHex(r):"string"==typeof r&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=du){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Ol.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=Ol.workingColorSpace){return this.r=e,this.g=t,this.b=i,Ol.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=Ol.workingColorSpace){if(e=Jk(e,1),t=bd(t,0,1),i=bd(i,0,1),0===t)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,a=2*i-s;this.r=y5(a,s,e+1/3),this.g=y5(a,s,e),this.b=y5(a,s,e-1/3)}return Ol.toWorkingColorSpace(this,r),this}setStyle(e,t=du){function i(s){void 0!==s&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const l=r[2];switch(r[1]){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],a=s.length;if(3===a)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(6===a)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=du){const i=iV[e.toLowerCase()];return void 0!==i?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=E2(e.r),this.g=E2(e.g),this.b=E2(e.b),this}copyLinearToSRGB(e){return this.r=n5(e.r),this.g=n5(e.g),this.b=n5(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=du){return Ol.fromWorkingColorSpace(Hh.copy(this),e),65536*Math.round(bd(255*Hh.r,0,255))+256*Math.round(bd(255*Hh.g,0,255))+Math.round(bd(255*Hh.b,0,255))}getHexString(e=du){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Ol.workingColorSpace){Ol.fromWorkingColorSpace(Hh.copy(this),t);const i=Hh.r,r=Hh.g,s=Hh.b,a=Math.max(i,r,s),l=Math.min(i,r,s);let d,u;const p=(l+a)/2;if(l===a)d=0,u=0;else{const _=a-l;switch(u=p<=.5?_/(a+l):_/(2-a-l),a){case i:d=(r-s)/_+(r<s?6:0);break;case r:d=(s-i)/_+2;break;case s:d=(i-r)/_+4}d/=6}return e.h=d,e.s=u,e.l=p,e}getRGB(e,t=Ol.workingColorSpace){return Ol.fromWorkingColorSpace(Hh.copy(this),t),e.r=Hh.r,e.g=Hh.g,e.b=Hh.b,e}getStyle(e=du){Ol.fromWorkingColorSpace(Hh.copy(this),e);const t=Hh.r,i=Hh.g,r=Hh.b;return e!==du?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*i)},${Math.round(255*r)})`}offsetHSL(e,t,i){return this.getHSL(zy),this.setHSL(zy.h+e,zy.s+t,zy.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(zy),e.getHSL(sI);const i=VS(zy.h,sI.h,t),r=VS(zy.s,sI.s,t),s=VS(zy.l,sI.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Hh=new Cr;Cr.NAMES=iV;let lce=0;class ld extends V_{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:lce++}),this.uuid=dm(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Cr(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=C2,this.stencilZFail=C2,this.stencilZPass=C2,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function r(s){const a=[];for(const l in s){const d=s[l];delete d.metadata,a.push(d)}return a}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(i.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapRotation&&(i.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),0!==this.side&&(i.side=this.side),!0===this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=!0),204!==this.blendSrc&&(i.blendSrc=this.blendSrc),205!==this.blendDst&&(i.blendDst=this.blendDst),100!==this.blendEquation&&(i.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(i.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(i.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(i.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(i.depthFunc=this.depthFunc),!1===this.depthTest&&(i.depthTest=this.depthTest),!1===this.depthWrite&&(i.depthWrite=this.depthWrite),!1===this.colorWrite&&(i.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(i.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(i.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(i.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==C2&&(i.stencilFail=this.stencilFail),this.stencilZFail!==C2&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==C2&&(i.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(i.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaHash&&(i.alphaHash=!0),!0===this.alphaToCoverage&&(i.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=!0),!0===this.forceSinglePass&&(i.forceSinglePass=!0),!0===this.wireframe&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=!0),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),t){const s=r(e.textures),a=r(e.images);s.length>0&&(i.textures=s),a.length>0&&(i.images=a)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class xd extends ld{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Cr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new M0,this.combine=zD,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const uu=new It,oI=new Qi;class No{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=i,this.usage=35044,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=aA,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}get updateRange(){return qH("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)oI.fromBufferAttribute(this,t),oI.applyMatrix3(e),this.setXY(t,oI.x,oI.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)uu.fromBufferAttribute(this,t),uu.applyMatrix3(e),this.setXYZ(t,uu.x,uu.y,uu.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)uu.fromBufferAttribute(this,t),uu.applyMatrix4(e),this.setXYZ(t,uu.x,uu.y,uu.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)uu.fromBufferAttribute(this,t),uu.applyNormalMatrix(e),this.setXYZ(t,uu.x,uu.y,uu.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)uu.fromBufferAttribute(this,t),uu.transformDirection(e),this.setXYZ(t,uu.x,uu.y,uu.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=Bf(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=Ea(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Bf(t,this.array)),t}setX(e,t){return this.normalized&&(t=Ea(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Bf(t,this.array)),t}setY(e,t){return this.normalized&&(t=Ea(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Bf(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Ea(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Bf(t,this.array)),t}setW(e,t){return this.normalized&&(t=Ea(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Ea(t,this.array),i=Ea(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=Ea(t,this.array),i=Ea(i,this.array),r=Ea(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=Ea(t,this.array),i=Ea(i,this.array),r=Ea(r,this.array),s=Ea(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),e}}class rV extends No{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class sV extends No{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class Ws extends No{constructor(e,t,i){super(new Float32Array(e),t,i)}}let dce=0;const cA=new wo,v5=new Pl,L2=new It,fm=new Pf,XS=new Pf,Xu=new It;class no extends V_{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:dce++}),this.uuid=dm(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(VH(e)?sV:rV)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const s=(new Ta).getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return cA.makeRotationFromQuaternion(e),this.applyMatrix4(cA),this}rotateX(e){return cA.makeRotationX(e),this.applyMatrix4(cA),this}rotateY(e){return cA.makeRotationY(e),this.applyMatrix4(cA),this}rotateZ(e){return cA.makeRotationZ(e),this.applyMatrix4(cA),this}translate(e,t,i){return cA.makeTranslation(e,t,i),this.applyMatrix4(cA),this}scale(e,t,i){return cA.makeScale(e,t,i),this.applyMatrix4(cA),this}lookAt(e){return v5.lookAt(e),v5.updateMatrix(),this.applyMatrix4(v5.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(L2).negate(),this.translate(L2.x,L2.y,L2.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Ws(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Pf);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new It(-1/0,-1/0,-1/0),new It(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++)fm.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(Xu.addVectors(this.boundingBox.min,fm.min),this.boundingBox.expandByPoint(Xu),Xu.addVectors(this.boundingBox.max,fm.max),this.boundingBox.expandByPoint(Xu)):(this.boundingBox.expandByPoint(fm.min),this.boundingBox.expandByPoint(fm.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new $u);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new It,1/0);if(e){const i=this.boundingSphere.center;if(fm.setFromBufferAttribute(e),t)for(let s=0,a=t.length;s<a;s++)XS.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(Xu.addVectors(fm.min,XS.min),fm.expandByPoint(Xu),Xu.addVectors(fm.max,XS.max),fm.expandByPoint(Xu)):(fm.expandByPoint(XS.min),fm.expandByPoint(XS.max));fm.getCenter(i);let r=0;for(let s=0,a=e.count;s<a;s++)Xu.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(Xu));if(t)for(let s=0,a=t.length;s<a;s++){const l=t[s],d=this.morphTargetsRelative;for(let u=0,p=l.count;u<p;u++)Xu.fromBufferAttribute(l,u),d&&(L2.fromBufferAttribute(e,u),Xu.add(L2)),r=Math.max(r,i.distanceToSquared(Xu))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=t.position,r=t.normal,s=t.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new No(new Float32Array(4*i.count),4));const a=this.getAttribute("tangent"),l=[],d=[];for(let Xt=0;Xt<i.count;Xt++)l[Xt]=new It,d[Xt]=new It;const u=new It,p=new It,_=new It,S=new Qi,R=new Qi,H=new Qi,re=new It,se=new It;function ce(Xt,Un,Ct){u.fromBufferAttribute(i,Xt),p.fromBufferAttribute(i,Un),_.fromBufferAttribute(i,Ct),S.fromBufferAttribute(s,Xt),R.fromBufferAttribute(s,Un),H.fromBufferAttribute(s,Ct),p.sub(u),_.sub(u),R.sub(S),H.sub(S);const Kt=1/(R.x*H.y-H.x*R.y);isFinite(Kt)&&(re.copy(p).multiplyScalar(H.y).addScaledVector(_,-R.y).multiplyScalar(Kt),se.copy(_).multiplyScalar(R.x).addScaledVector(p,-H.x).multiplyScalar(Kt),l[Xt].add(re),l[Un].add(re),l[Ct].add(re),d[Xt].add(se),d[Un].add(se),d[Ct].add(se))}let Te=this.groups;0===Te.length&&(Te=[{start:0,count:e.count}]);for(let Xt=0,Un=Te.length;Xt<Un;++Xt){const Ct=Te[Xt],Kt=Ct.start;for(let Yi=Kt,En=Kt+Ct.count;Yi<En;Yi+=3)ce(e.getX(Yi+0),e.getX(Yi+1),e.getX(Yi+2))}const Ce=new It,qe=new It,wt=new It,gt=new It;function Et(Xt){wt.fromBufferAttribute(r,Xt),gt.copy(wt);const Un=l[Xt];Ce.copy(Un),Ce.sub(wt.multiplyScalar(wt.dot(Un))).normalize(),qe.crossVectors(gt,Un);const Kt=qe.dot(d[Xt])<0?-1:1;a.setXYZW(Xt,Ce.x,Ce.y,Ce.z,Kt)}for(let Xt=0,Un=Te.length;Xt<Un;++Xt){const Ct=Te[Xt],Kt=Ct.start;for(let Yi=Kt,En=Kt+Ct.count;Yi<En;Yi+=3)Et(e.getX(Yi+0)),Et(e.getX(Yi+1)),Et(e.getX(Yi+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new No(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let S=0,R=i.count;S<R;S++)i.setXYZ(S,0,0,0);const r=new It,s=new It,a=new It,l=new It,d=new It,u=new It,p=new It,_=new It;if(e)for(let S=0,R=e.count;S<R;S+=3){const H=e.getX(S+0),re=e.getX(S+1),se=e.getX(S+2);r.fromBufferAttribute(t,H),s.fromBufferAttribute(t,re),a.fromBufferAttribute(t,se),p.subVectors(a,s),_.subVectors(r,s),p.cross(_),l.fromBufferAttribute(i,H),d.fromBufferAttribute(i,re),u.fromBufferAttribute(i,se),l.add(p),d.add(p),u.add(p),i.setXYZ(H,l.x,l.y,l.z),i.setXYZ(re,d.x,d.y,d.z),i.setXYZ(se,u.x,u.y,u.z)}else for(let S=0,R=t.count;S<R;S+=3)r.fromBufferAttribute(t,S+0),s.fromBufferAttribute(t,S+1),a.fromBufferAttribute(t,S+2),p.subVectors(a,s),_.subVectors(r,s),p.cross(_),i.setXYZ(S+0,p.x,p.y,p.z),i.setXYZ(S+1,p.x,p.y,p.z),i.setXYZ(S+2,p.x,p.y,p.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)Xu.fromBufferAttribute(e,t),Xu.normalize(),e.setXYZ(t,Xu.x,Xu.y,Xu.z)}toNonIndexed(){function e(l,d){const u=l.array,p=l.itemSize,_=l.normalized,S=new u.constructor(d.length*p);let R=0,H=0;for(let re=0,se=d.length;re<se;re++){R=l.isInterleavedBufferAttribute?d[re]*l.data.stride+l.offset:d[re]*p;for(let ce=0;ce<p;ce++)S[H++]=u[R++]}return new No(S,p,_)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new no,i=this.index.array,r=this.attributes;for(const l in r){const u=e(r[l],i);t.setAttribute(l,u)}const s=this.morphAttributes;for(const l in s){const d=[],u=s[l];for(let p=0,_=u.length;p<_;p++){const R=e(u[p],i);d.push(R)}t.morphAttributes[l]=d}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let l=0,d=a.length;l<d;l++){const u=a[l];t.addGroup(u.start,u.count,u.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const d=this.parameters;for(const u in d)void 0!==d[u]&&(e[u]=d[u]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const d in i)e.data.attributes[d]=i[d].toJSON(e.data);const r={};let s=!1;for(const d in this.morphAttributes){const u=this.morphAttributes[d],p=[];for(let _=0,S=u.length;_<S;_++)p.push(u[_].toJSON(e.data));p.length>0&&(r[d]=p,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const l=this.boundingSphere;return null!==l&&(e.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const r=e.attributes;for(const u in r)this.setAttribute(u,r[u].clone(t));const s=e.morphAttributes;for(const u in s){const p=[],_=s[u];for(let S=0,R=_.length;S<R;S++)p.push(_[S].clone(t));this.morphAttributes[u]=p}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let u=0,p=a.length;u<p;u++){const _=a[u];this.addGroup(_.start,_.count,_.materialIndex)}const l=e.boundingBox;null!==l&&(this.boundingBox=l.clone());const d=e.boundingSphere;return null!==d&&(this.boundingSphere=d.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const oV=new wo,Lb=new P2,aI=new $u,aV=new It,N2=new It,U2=new It,z2=new It,b5=new It,lI=new It,cI=new Qi,dI=new Qi,uI=new Qi,lV=new It,cV=new It,dV=new It,hI=new It,fI=new It;class ua extends Pl{constructor(e=new no,t=new xd){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const l=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=s}}}}getVertexPosition(e,t){const i=this.geometry,s=i.morphAttributes.position,a=i.morphTargetsRelative;t.fromBufferAttribute(i.attributes.position,e);const l=this.morphTargetInfluences;if(s&&l){lI.set(0,0,0);for(let d=0,u=s.length;d<u;d++){const p=l[d];0!==p&&(b5.fromBufferAttribute(s[d],e),lI.addScaledVector(a?b5:b5.sub(t),p))}t.add(lI)}return t}raycast(e,t){const i=this.geometry,s=this.matrixWorld;void 0!==this.material&&(null===i.boundingSphere&&i.computeBoundingSphere(),aI.copy(i.boundingSphere),aI.applyMatrix4(s),Lb.copy(e.ray).recast(e.near),(!1!==aI.containsPoint(Lb.origin)||!(null===Lb.intersectSphere(aI,aV)||Lb.origin.distanceToSquared(aV)>(e.far-e.near)**2))&&(oV.copy(s).invert(),Lb.copy(e.ray).applyMatrix4(oV),(null===i.boundingBox||!1!==Lb.intersectsBox(i.boundingBox))&&this._computeIntersections(e,t,Lb)))}_computeIntersections(e,t,i){let r;const s=this.geometry,a=this.material,l=s.index,d=s.attributes.position,u=s.attributes.uv,p=s.attributes.uv1,_=s.attributes.normal,S=s.groups,R=s.drawRange;if(null!==l)if(Array.isArray(a))for(let H=0,re=S.length;H<re;H++){const se=S[H],ce=a[se.materialIndex];for(let qe=Math.max(se.start,R.start),wt=Math.min(l.count,Math.min(se.start+se.count,R.start+R.count));qe<wt;qe+=3)r=pI(this,ce,e,i,u,p,_,l.getX(qe),l.getX(qe+1),l.getX(qe+2)),r&&(r.faceIndex=Math.floor(qe/3),r.face.materialIndex=se.materialIndex,t.push(r))}else for(let se=Math.max(0,R.start),ce=Math.min(l.count,R.start+R.count);se<ce;se+=3)r=pI(this,a,e,i,u,p,_,l.getX(se),l.getX(se+1),l.getX(se+2)),r&&(r.faceIndex=Math.floor(se/3),t.push(r));else if(void 0!==d)if(Array.isArray(a))for(let H=0,re=S.length;H<re;H++){const se=S[H],ce=a[se.materialIndex];for(let qe=Math.max(se.start,R.start),wt=Math.min(d.count,Math.min(se.start+se.count,R.start+R.count));qe<wt;qe+=3)r=pI(this,ce,e,i,u,p,_,qe,qe+1,qe+2),r&&(r.faceIndex=Math.floor(qe/3),r.face.materialIndex=se.materialIndex,t.push(r))}else for(let se=Math.max(0,R.start),ce=Math.min(d.count,R.start+R.count);se<ce;se+=3)r=pI(this,a,e,i,u,p,_,se,se+1,se+2),r&&(r.faceIndex=Math.floor(se/3),t.push(r))}}function pI(n,e,t,i,r,s,a,l,d,u){n.getVertexPosition(l,N2),n.getVertexPosition(d,U2),n.getVertexPosition(u,z2);const p=function uce(n,e,t,i,r,s,a,l){let d;if(d=1===e.side?i.intersectTriangle(a,s,r,!0,l):i.intersectTriangle(r,s,a,0===e.side,l),null===d)return null;fI.copy(l),fI.applyMatrix4(n.matrixWorld);const u=t.ray.origin.distanceTo(fI);return u<t.near||u>t.far?null:{distance:u,point:fI.clone(),object:n}}(n,e,t,i,N2,U2,z2,hI);if(p){r&&(cI.fromBufferAttribute(r,l),dI.fromBufferAttribute(r,d),uI.fromBufferAttribute(r,u),p.uv=hm.getInterpolation(hI,N2,U2,z2,cI,dI,uI,new Qi)),s&&(cI.fromBufferAttribute(s,l),dI.fromBufferAttribute(s,d),uI.fromBufferAttribute(s,u),p.uv1=hm.getInterpolation(hI,N2,U2,z2,cI,dI,uI,new Qi)),a&&(lV.fromBufferAttribute(a,l),cV.fromBufferAttribute(a,d),dV.fromBufferAttribute(a,u),p.normal=hm.getInterpolation(hI,N2,U2,z2,lV,cV,dV,new It),p.normal.dot(i.direction)>0&&p.normal.multiplyScalar(-1));const _={a:l,b:d,c:u,normal:new It,materialIndex:0};hm.getNormal(N2,U2,z2,_.normal),p.face=_}return p}class yp extends no{constructor(e=1,t=1,i=1,r=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:a};const l=this;r=Math.floor(r),s=Math.floor(s),a=Math.floor(a);const d=[],u=[],p=[],_=[];let S=0,R=0;function H(re,se,ce,Te,Ce,qe,wt,gt,Et,Xt,Un){const Ct=qe/Et,Kt=wt/Xt,Gi=qe/2,Yi=wt/2,En=gt/2,wi=Et+1,zn=Xt+1;let oi=0,hi=0;const vi=new It;for(let mr=0;mr<zn;mr++){const Mr=mr*Kt-Yi;for(let is=0;is<wi;is++)vi[re]=(is*Ct-Gi)*Te,vi[se]=Mr*Ce,vi[ce]=En,u.push(vi.x,vi.y,vi.z),vi[re]=0,vi[se]=0,vi[ce]=gt>0?1:-1,p.push(vi.x,vi.y,vi.z),_.push(is/Et),_.push(1-mr/Xt),oi+=1}for(let mr=0;mr<Xt;mr++)for(let Mr=0;Mr<Et;Mr++){const $s=S+Mr+wi*(mr+1),fi=S+(Mr+1)+wi*(mr+1),Rr=S+(Mr+1)+wi*mr;d.push(S+Mr+wi*mr,$s,Rr),d.push($s,fi,Rr),hi+=6}l.addGroup(R,hi,Un),R+=hi,S+=oi}H("z","y","x",-1,-1,i,t,e,a,s,0),H("z","y","x",1,-1,i,t,-e,a,s,1),H("x","z","y",1,1,e,i,t,r,a,2),H("x","z","y",1,-1,e,i,-t,r,a,3),H("x","y","z",1,-1,e,t,i,r,s,4),H("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(d),this.setAttribute("position",new Ws(u,3)),this.setAttribute("normal",new Ws(p,3)),this.setAttribute("uv",new Ws(_,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new yp(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function H2(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():e[t][i]=Array.isArray(r)?r.slice():r}}return e}function Rf(n){const e={};for(let t=0;t<n.length;t++){const i=H2(n[t]);for(const r in i)e[r]=i[r]}return e}function uV(n){return null===n.getRenderTarget()?n.outputColorSpace:Ol.workingColorSpace}const x5={clone:H2,merge:Rf};class Iu extends ld{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=H2(e.uniforms),this.uniformsGroups=function hce(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const a=this.uniforms[r].value;t.uniforms[r]=a&&a.isTexture?{type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?{type:"c",value:a.getHex()}:a&&a.isVector2?{type:"v2",value:a.toArray()}:a&&a.isVector3?{type:"v3",value:a.toArray()}:a&&a.isVector4?{type:"v4",value:a.toArray()}:a&&a.isMatrix3?{type:"m3",value:a.toArray()}:a&&a.isMatrix4?{type:"m4",value:a.toArray()}:{value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)!0===this.extensions[r]&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class w5 extends Pl{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new wo,this.projectionMatrix=new wo,this.projectionMatrixInverse=new wo,this.coordinateSystem=H_}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const Hy=new It,hV=new Qi,fV=new Qi;class Bu extends w5{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*M2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Rb*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*M2*Math.atan(Math.tan(.5*Rb*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,i){Hy.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Hy.x,Hy.y).multiplyScalar(-e/Hy.z),Hy.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(Hy.x,Hy.y).multiplyScalar(-e/Hy.z)}getViewSize(e,t){return this.getViewBounds(e,hV,fV),t.subVectors(fV,hV)}setViewOffset(e,t,i,r,s,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Rb*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const a=this.view;if(null!==this.view&&this.view.enabled){const d=a.fullWidth,u=a.fullHeight;s+=a.offsetX*r/d,t-=a.offsetY*i/u,r*=a.width/d,i*=a.height/u}const l=this.filmOffset;0!==l&&(s+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class mce extends Pl{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Bu(-90,1,e,t);r.layers=this.layers,this.add(r);const s=new Bu(-90,1,e,t);s.layers=this.layers,this.add(s);const a=new Bu(-90,1,e,t);a.layers=this.layers,this.add(a);const l=new Bu(-90,1,e,t);l.layers=this.layers,this.add(l);const d=new Bu(-90,1,e,t);d.layers=this.layers,this.add(d);const u=new Bu(-90,1,e,t);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,a,l,d]=t;for(const u of t)this.remove(u);if(e===H_)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),l.up.set(0,1,0),l.lookAt(0,0,1),d.up.set(0,1,0),d.lookAt(0,0,-1);else{if(2001!==e)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),l.up.set(0,-1,0),l.lookAt(0,0,1),d.up.set(0,-1,0),d.lookAt(0,0,-1)}for(const u of t)this.add(u),u.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,a,l,d,u,p]=this.children,_=e.getRenderTarget(),S=e.getActiveCubeFace(),R=e.getActiveMipmapLevel(),H=e.xr.enabled;e.xr.enabled=!1;const re=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,s),e.setRenderTarget(i,1,r),e.render(t,a),e.setRenderTarget(i,2,r),e.render(t,l),e.setRenderTarget(i,3,r),e.render(t,d),e.setRenderTarget(i,4,r),e.render(t,u),i.texture.generateMipmaps=re,e.setRenderTarget(i,5,r),e.render(t,p),e.setRenderTarget(_,S,R),e.xr.enabled=H,i.texture.needsPMREMUpdate=!0}}class mI extends zh{constructor(e,t,i,r,s,a,l,d,u,p){super(e=void 0!==e?e:[],t=void 0!==t?t:By,i,r,s,a,l,d,u,p),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Ace extends ju{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1};this.texture=new mI([i,i,i,i,i,i],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:Hc}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new yp(5,5,5),s=new Iu({name:"CubemapFromEquirect",uniforms:H2(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:1,blending:0});s.uniforms.tEquirect.value=t;const a=new ua(r,s),l=t.minFilter;return t.minFilter===oA&&(t.minFilter=Hc),new mce(1,10,this).update(e,a),t.minFilter=l,a.geometry.dispose(),a.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,i,r);e.setRenderTarget(s)}}const C5=new It,gce=new It,_ce=new Ta;class dA{constructor(e=new It(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=C5.subVectors(i,t).cross(gce.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(C5),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||_ce.getNormalMatrix(e),r=this.coplanarPoint(C5).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Nb=new $u,AI=new It;class gI{constructor(e=new dA,t=new dA,i=new dA,r=new dA,s=new dA,a=new dA){this.planes=[e,t,i,r,s,a]}set(e,t,i,r,s,a){const l=this.planes;return l[0].copy(e),l[1].copy(t),l[2].copy(i),l[3].copy(r),l[4].copy(s),l[5].copy(a),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=H_){const i=this.planes,r=e.elements,s=r[0],a=r[1],l=r[2],d=r[3],u=r[4],p=r[5],_=r[6],S=r[7],R=r[8],H=r[9],re=r[10],se=r[11],ce=r[12],Te=r[13],Ce=r[14],qe=r[15];if(i[0].setComponents(d-s,S-u,se-R,qe-ce).normalize(),i[1].setComponents(d+s,S+u,se+R,qe+ce).normalize(),i[2].setComponents(d+a,S+p,se+H,qe+Te).normalize(),i[3].setComponents(d-a,S-p,se-H,qe-Te).normalize(),i[4].setComponents(d-l,S-_,se-re,qe-Ce).normalize(),t===H_)i[5].setComponents(d+l,S+_,se+re,qe+Ce).normalize();else{if(2001!==t)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);i[5].setComponents(l,_,re,Ce).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),Nb.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),Nb.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Nb)}intersectsSprite(e){return Nb.center.set(0,0,0),Nb.radius=.7071067811865476,Nb.applyMatrix4(e.matrixWorld),this.intersectsSphere(Nb)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(AI.x=r.normal.x>0?e.max.x:e.min.x,AI.y=r.normal.y>0?e.max.y:e.min.y,AI.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(AI)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function pV(){let n=null,e=!1,t=null,i=null;function r(s,a){t(s,a),i=n.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function yce(n,e){const t=e.isWebGL2,i=new WeakMap;return{get:function a(u){return u.isInterleavedBufferAttribute&&(u=u.data),i.get(u)},remove:function l(u){u.isInterleavedBufferAttribute&&(u=u.data);const p=i.get(u);p&&(n.deleteBuffer(p.buffer),i.delete(u))},update:function d(u,p){if(u.isGLBufferAttribute){const S=i.get(u);return void((!S||S.version<u.version)&&i.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version}))}u.isInterleavedBufferAttribute&&(u=u.data);const _=i.get(u);if(void 0===_)i.set(u,function r(u,p){const _=u.array,S=u.usage,R=_.byteLength,H=n.createBuffer();let re;if(n.bindBuffer(p,H),n.bufferData(p,_,S),u.onUploadCallback(),_ instanceof Float32Array)re=n.FLOAT;else if(_ instanceof Uint16Array)if(u.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");re=n.HALF_FLOAT}else re=n.UNSIGNED_SHORT;else if(_ instanceof Int16Array)re=n.SHORT;else if(_ instanceof Uint32Array)re=n.UNSIGNED_INT;else if(_ instanceof Int32Array)re=n.INT;else if(_ instanceof Int8Array)re=n.BYTE;else if(_ instanceof Uint8Array)re=n.UNSIGNED_BYTE;else{if(!(_ instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+_);re=n.UNSIGNED_BYTE}return{buffer:H,type:re,bytesPerElement:_.BYTES_PER_ELEMENT,version:u.version,size:R}}(u,p));else if(_.version<u.version){if(_.size!==u.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");(function s(u,p,_){const S=p.array,R=p._updateRange,H=p.updateRanges;if(n.bindBuffer(_,u),-1===R.count&&0===H.length&&n.bufferSubData(_,0,S),0!==H.length){for(let re=0,se=H.length;re<se;re++){const ce=H[re];t?n.bufferSubData(_,ce.start*S.BYTES_PER_ELEMENT,S,ce.start,ce.count):n.bufferSubData(_,ce.start*S.BYTES_PER_ELEMENT,S.subarray(ce.start,ce.start+ce.count))}p.clearUpdateRanges()}-1!==R.count&&(t?n.bufferSubData(_,R.offset*S.BYTES_PER_ELEMENT,S,R.offset,R.count):n.bufferSubData(_,R.offset*S.BYTES_PER_ELEMENT,S.subarray(R.offset,R.offset+R.count)),R.count=-1),p.onUploadCallback()})(_.buffer,u,p),_.version=u.version}}}}class q2 extends no{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,a=t/2,l=Math.floor(i),d=Math.floor(r),u=l+1,p=d+1,_=e/l,S=t/d,R=[],H=[],re=[],se=[];for(let ce=0;ce<p;ce++){const Te=ce*S-a;for(let Ce=0;Ce<u;Ce++)H.push(Ce*_-s,-Te,0),re.push(0,0,1),se.push(Ce/l),se.push(1-ce/d)}for(let ce=0;ce<d;ce++)for(let Te=0;Te<l;Te++){const qe=Te+u*(ce+1),wt=Te+1+u*(ce+1),gt=Te+1+u*ce;R.push(Te+u*ce,qe,gt),R.push(qe,wt,gt)}this.setIndex(R),this.setAttribute("position",new Ws(H,3)),this.setAttribute("normal",new Ws(re,3)),this.setAttribute("uv",new Ws(se,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new q2(e.width,e.height,e.widthSegments,e.heightSegments)}}const xa={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\tattribute float batchId;\n\tuniform highp sampler2D batchingTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( batchId );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(\n\tvec3( 0.8224621, 0.177538, 0.0 ),\n\tvec3( 0.0331941, 0.9668058, 0.0 ),\n\tvec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.2249401, - 0.2249404, 0.0 ),\n\tvec3( - 0.0420569, 1.0420571, 0.0 ),\n\tvec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn sRGBTransferOETF( value );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[MORPHTARGETS_COUNT];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t#endif\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\t#ifndef USE_INSTANCING_MORPH\n\t\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\t#endif\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tfloat startCompression = 0.8 - 0.04;\n\tfloat desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min(color.r, min(color.g, color.b));\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max(color.r, max(color.g, color.b));\n\tif (peak < startCompression) return color;\n\tfloat d = 1. - startCompression;\n\tfloat newPeak = 1. - d * d / (peak + d - startCompression);\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / (desaturation * (peak - newPeak) + 1.);\n\treturn mix(color, vec3(1, 1, 1), g);\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},Ms={common:{diffuse:{value:new Cr(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Ta},alphaMap:{value:null},alphaMapTransform:{value:new Ta},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Ta}},envmap:{envMap:{value:null},envMapRotation:{value:new Ta},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Ta}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Ta}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Ta},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Ta},normalScale:{value:new Qi(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Ta},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Ta}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Ta}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Ta}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Cr(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Cr(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Ta},alphaTest:{value:0},uvTransform:{value:new Ta}},sprite:{diffuse:{value:new Cr(16777215)},opacity:{value:1},center:{value:new Qi(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Ta},alphaMap:{value:null},alphaMapTransform:{value:new Ta},alphaTest:{value:0}}},S0={basic:{uniforms:Rf([Ms.common,Ms.specularmap,Ms.envmap,Ms.aomap,Ms.lightmap,Ms.fog]),vertexShader:xa.meshbasic_vert,fragmentShader:xa.meshbasic_frag},lambert:{uniforms:Rf([Ms.common,Ms.specularmap,Ms.envmap,Ms.aomap,Ms.lightmap,Ms.emissivemap,Ms.bumpmap,Ms.normalmap,Ms.displacementmap,Ms.fog,Ms.lights,{emissive:{value:new Cr(0)}}]),vertexShader:xa.meshlambert_vert,fragmentShader:xa.meshlambert_frag},phong:{uniforms:Rf([Ms.common,Ms.specularmap,Ms.envmap,Ms.aomap,Ms.lightmap,Ms.emissivemap,Ms.bumpmap,Ms.normalmap,Ms.displacementmap,Ms.fog,Ms.lights,{emissive:{value:new Cr(0)},specular:{value:new Cr(1118481)},shininess:{value:30}}]),vertexShader:xa.meshphong_vert,fragmentShader:xa.meshphong_frag},standard:{uniforms:Rf([Ms.common,Ms.envmap,Ms.aomap,Ms.lightmap,Ms.emissivemap,Ms.bumpmap,Ms.normalmap,Ms.displacementmap,Ms.roughnessmap,Ms.metalnessmap,Ms.fog,Ms.lights,{emissive:{value:new Cr(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:xa.meshphysical_vert,fragmentShader:xa.meshphysical_frag},toon:{uniforms:Rf([Ms.common,Ms.aomap,Ms.lightmap,Ms.emissivemap,Ms.bumpmap,Ms.normalmap,Ms.displacementmap,Ms.gradientmap,Ms.fog,Ms.lights,{emissive:{value:new Cr(0)}}]),vertexShader:xa.meshtoon_vert,fragmentShader:xa.meshtoon_frag},matcap:{uniforms:Rf([Ms.common,Ms.bumpmap,Ms.normalmap,Ms.displacementmap,Ms.fog,{matcap:{value:null}}]),vertexShader:xa.meshmatcap_vert,fragmentShader:xa.meshmatcap_frag},points:{uniforms:Rf([Ms.points,Ms.fog]),vertexShader:xa.points_vert,fragmentShader:xa.points_frag},dashed:{uniforms:Rf([Ms.common,Ms.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:xa.linedashed_vert,fragmentShader:xa.linedashed_frag},depth:{uniforms:Rf([Ms.common,Ms.displacementmap]),vertexShader:xa.depth_vert,fragmentShader:xa.depth_frag},normal:{uniforms:Rf([Ms.common,Ms.bumpmap,Ms.normalmap,Ms.displacementmap,{opacity:{value:1}}]),vertexShader:xa.meshnormal_vert,fragmentShader:xa.meshnormal_frag},sprite:{uniforms:Rf([Ms.sprite,Ms.fog]),vertexShader:xa.sprite_vert,fragmentShader:xa.sprite_frag},background:{uniforms:{uvTransform:{value:new Ta},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:xa.background_vert,fragmentShader:xa.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Ta}},vertexShader:xa.backgroundCube_vert,fragmentShader:xa.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:xa.cube_vert,fragmentShader:xa.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:xa.equirect_vert,fragmentShader:xa.equirect_frag},distanceRGBA:{uniforms:Rf([Ms.common,Ms.displacementmap,{referencePosition:{value:new It},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:xa.distanceRGBA_vert,fragmentShader:xa.distanceRGBA_frag},shadow:{uniforms:Rf([Ms.lights,Ms.fog,{color:{value:new Cr(0)},opacity:{value:1}}]),vertexShader:xa.shadow_vert,fragmentShader:xa.shadow_frag}};S0.physical={uniforms:Rf([S0.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Ta},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Ta},clearcoatNormalScale:{value:new Qi(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Ta},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Ta},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Ta},sheen:{value:0},sheenColor:{value:new Cr(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Ta},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Ta},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Ta},transmissionSamplerSize:{value:new Qi},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Ta},attenuationDistance:{value:0},attenuationColor:{value:new Cr(0)},specularColor:{value:new Cr(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Ta},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Ta},anisotropyVector:{value:new Qi},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Ta}}]),vertexShader:xa.meshphysical_vert,fragmentShader:xa.meshphysical_frag};const _I={r:0,b:0,g:0},Ub=new M0,vue=new wo;function bue(n,e,t,i,r,s,a){const l=new Cr(0);let u,p,d=!0===s?0:1,_=null,S=0,R=null;function re(se,ce){se.getRGB(_I,uV(n)),i.buffers.color.setClear(_I.r,_I.g,_I.b,ce,a)}return{getClearColor:function(){return l},setClearColor:function(se,ce=1){l.set(se),d=ce,re(l,d)},getClearAlpha:function(){return d},setClearAlpha:function(se){d=se,re(l,d)},render:function H(se,ce){let Te=!1,Ce=!0===ce.isScene?ce.background:null;Ce&&Ce.isTexture&&(Ce=(ce.backgroundBlurriness>0?t:e).get(Ce)),null===Ce?re(l,d):Ce&&Ce.isColor&&(re(Ce,1),Te=!0);const qe=n.xr.getEnvironmentBlendMode();"additive"===qe?i.buffers.color.setClear(0,0,0,1,a):"alpha-blend"===qe&&i.buffers.color.setClear(0,0,0,0,a),(n.autoClear||Te)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),Ce&&(Ce.isCubeTexture||Ce.mapping===zS)?(void 0===p&&(p=new ua(new yp(1,1,1),new Iu({name:"BackgroundCubeMaterial",uniforms:H2(S0.backgroundCube.uniforms),vertexShader:S0.backgroundCube.vertexShader,fragmentShader:S0.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),p.geometry.deleteAttribute("normal"),p.geometry.deleteAttribute("uv"),p.onBeforeRender=function(wt,gt,Et){this.matrixWorld.copyPosition(Et.matrixWorld)},Object.defineProperty(p.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(p)),Ub.copy(ce.backgroundRotation),Ub.x*=-1,Ub.y*=-1,Ub.z*=-1,Ce.isCubeTexture&&!1===Ce.isRenderTargetTexture&&(Ub.y*=-1,Ub.z*=-1),p.material.uniforms.envMap.value=Ce,p.material.uniforms.flipEnvMap.value=Ce.isCubeTexture&&!1===Ce.isRenderTargetTexture?-1:1,p.material.uniforms.backgroundBlurriness.value=ce.backgroundBlurriness,p.material.uniforms.backgroundIntensity.value=ce.backgroundIntensity,p.material.uniforms.backgroundRotation.value.setFromMatrix4(vue.makeRotationFromEuler(Ub)),p.material.toneMapped=Ol.getTransfer(Ce.colorSpace)!==Vc,(_!==Ce||S!==Ce.version||R!==n.toneMapping)&&(p.material.needsUpdate=!0,_=Ce,S=Ce.version,R=n.toneMapping),p.layers.enableAll(),se.unshift(p,p.geometry,p.material,0,0,null)):Ce&&Ce.isTexture&&(void 0===u&&(u=new ua(new q2(2,2),new Iu({name:"BackgroundMaterial",uniforms:H2(S0.background.uniforms),vertexShader:S0.background.vertexShader,fragmentShader:S0.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(u)),u.material.uniforms.t2D.value=Ce,u.material.uniforms.backgroundIntensity.value=ce.backgroundIntensity,u.material.toneMapped=Ol.getTransfer(Ce.colorSpace)!==Vc,!0===Ce.matrixAutoUpdate&&Ce.updateMatrix(),u.material.uniforms.uvTransform.value.copy(Ce.matrix),(_!==Ce||S!==Ce.version||R!==n.toneMapping)&&(u.material.needsUpdate=!0,_=Ce,S=Ce.version,R=n.toneMapping),u.layers.enableAll(),se.unshift(u,u.geometry,u.material,0,0,null))}}}function xue(n,e,t,i){const r=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),a=i.isWebGL2||null!==s,l={},d=se(null);let u=d,p=!1;function R(En){return i.isWebGL2?n.bindVertexArray(En):s.bindVertexArrayOES(En)}function H(En){return i.isWebGL2?n.deleteVertexArray(En):s.deleteVertexArrayOES(En)}function se(En){const wi=[],zn=[],oi=[];for(let hi=0;hi<r;hi++)wi[hi]=0,zn[hi]=0,oi[hi]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:wi,enabledAttributes:zn,attributeDivisors:oi,object:En,attributes:{},index:null}}function Ce(){const En=u.newAttributes;for(let wi=0,zn=En.length;wi<zn;wi++)En[wi]=0}function qe(En){wt(En,0)}function wt(En,wi){const oi=u.enabledAttributes,hi=u.attributeDivisors;u.newAttributes[En]=1,0===oi[En]&&(n.enableVertexAttribArray(En),oi[En]=1),hi[En]!==wi&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](En,wi),hi[En]=wi)}function gt(){const En=u.newAttributes,wi=u.enabledAttributes;for(let zn=0,oi=wi.length;zn<oi;zn++)wi[zn]!==En[zn]&&(n.disableVertexAttribArray(zn),wi[zn]=0)}function Et(En,wi,zn,oi,hi,vi,mr){!0===mr?n.vertexAttribIPointer(En,wi,zn,hi,vi):n.vertexAttribPointer(En,wi,zn,oi,hi,vi)}function Gi(){Yi(),p=!0,u!==d&&(u=d,R(u.object))}function Yi(){d.geometry=null,d.program=null,d.wireframe=!1}return{setup:function _(En,wi,zn,oi,hi){let vi=!1;if(a){const mr=function re(En,wi,zn){const oi=!0===zn.wireframe;let hi=l[En.id];void 0===hi&&(hi={},l[En.id]=hi);let vi=hi[wi.id];void 0===vi&&(vi={},hi[wi.id]=vi);let mr=vi[oi];return void 0===mr&&(mr=se(function S(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}()),vi[oi]=mr),mr}(oi,zn,wi);u!==mr&&(u=mr,R(u.object)),vi=function ce(En,wi,zn,oi){const hi=u.attributes,vi=wi.attributes;let mr=0;const Mr=zn.getAttributes();for(const is in Mr)if(Mr[is].location>=0){const fi=hi[is];let Rr=vi[is];if(void 0===Rr&&("instanceMatrix"===is&&En.instanceMatrix&&(Rr=En.instanceMatrix),"instanceColor"===is&&En.instanceColor&&(Rr=En.instanceColor)),void 0===fi||fi.attribute!==Rr||Rr&&fi.data!==Rr.data)return!0;mr++}return u.attributesNum!==mr||u.index!==oi}(En,oi,zn,hi),vi&&function Te(En,wi,zn,oi){const hi={},vi=wi.attributes;let mr=0;const Mr=zn.getAttributes();for(const is in Mr)if(Mr[is].location>=0){let fi=vi[is];void 0===fi&&("instanceMatrix"===is&&En.instanceMatrix&&(fi=En.instanceMatrix),"instanceColor"===is&&En.instanceColor&&(fi=En.instanceColor));const Rr={};Rr.attribute=fi,fi&&fi.data&&(Rr.data=fi.data),hi[is]=Rr,mr++}u.attributes=hi,u.attributesNum=mr,u.index=oi}(En,oi,zn,hi)}else{const mr=!0===wi.wireframe;(u.geometry!==oi.id||u.program!==zn.id||u.wireframe!==mr)&&(u.geometry=oi.id,u.program=zn.id,u.wireframe=mr,vi=!0)}null!==hi&&t.update(hi,n.ELEMENT_ARRAY_BUFFER),(vi||p)&&(p=!1,function Xt(En,wi,zn,oi){if(!1===i.isWebGL2&&(En.isInstancedMesh||oi.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;Ce();const hi=oi.attributes,vi=zn.getAttributes(),mr=wi.defaultAttributeValues;for(const Mr in vi){const is=vi[Mr];if(is.location>=0){let $s=hi[Mr];if(void 0===$s&&("instanceMatrix"===Mr&&En.instanceMatrix&&($s=En.instanceMatrix),"instanceColor"===Mr&&En.instanceColor&&($s=En.instanceColor)),void 0!==$s){const fi=$s.normalized,Rr=$s.itemSize,ms=t.get($s);if(void 0===ms)continue;const Fs=ms.buffer,Us=ms.type,ws=ms.bytesPerElement,Co=!0===i.isWebGL2&&(Us===n.INT||Us===n.UNSIGNED_INT||1013===$s.gpuType);if($s.isInterleavedBufferAttribute){const lo=$s.data,On=lo.stride,ps=$s.offset;if(lo.isInstancedInterleavedBuffer){for(let gr=0;gr<is.locationSize;gr++)wt(is.location+gr,lo.meshPerAttribute);!0!==En.isInstancedMesh&&void 0===oi._maxInstanceCount&&(oi._maxInstanceCount=lo.meshPerAttribute*lo.count)}else for(let gr=0;gr<is.locationSize;gr++)qe(is.location+gr);n.bindBuffer(n.ARRAY_BUFFER,Fs);for(let gr=0;gr<is.locationSize;gr++)Et(is.location+gr,Rr/is.locationSize,Us,fi,On*ws,(ps+Rr/is.locationSize*gr)*ws,Co)}else{if($s.isInstancedBufferAttribute){for(let lo=0;lo<is.locationSize;lo++)wt(is.location+lo,$s.meshPerAttribute);!0!==En.isInstancedMesh&&void 0===oi._maxInstanceCount&&(oi._maxInstanceCount=$s.meshPerAttribute*$s.count)}else for(let lo=0;lo<is.locationSize;lo++)qe(is.location+lo);n.bindBuffer(n.ARRAY_BUFFER,Fs);for(let lo=0;lo<is.locationSize;lo++)Et(is.location+lo,Rr/is.locationSize,Us,fi,Rr*ws,Rr/is.locationSize*lo*ws,Co)}}else if(void 0!==mr){const fi=mr[Mr];if(void 0!==fi)switch(fi.length){case 2:n.vertexAttrib2fv(is.location,fi);break;case 3:n.vertexAttrib3fv(is.location,fi);break;case 4:n.vertexAttrib4fv(is.location,fi);break;default:n.vertexAttrib1fv(is.location,fi)}}}}gt()}(En,wi,zn,oi),null!==hi&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(hi).buffer))},reset:Gi,resetDefaultState:Yi,dispose:function Un(){Gi();for(const En in l){const wi=l[En];for(const zn in wi){const oi=wi[zn];for(const hi in oi)H(oi[hi].object),delete oi[hi];delete wi[zn]}delete l[En]}},releaseStatesOfGeometry:function Ct(En){if(void 0===l[En.id])return;const wi=l[En.id];for(const zn in wi){const oi=wi[zn];for(const hi in oi)H(oi[hi].object),delete oi[hi];delete wi[zn]}delete l[En.id]},releaseStatesOfProgram:function Kt(En){for(const wi in l){const zn=l[wi];if(void 0===zn[En.id])continue;const oi=zn[En.id];for(const hi in oi)H(oi[hi].object),delete oi[hi];delete zn[En.id]}},initAttributes:Ce,enableAttribute:qe,disableUnusedAttributes:gt}}function wue(n,e,t,i){const r=i.isWebGL2;let s;this.setMode=function a(p){s=p},this.render=function l(p,_){n.drawArrays(s,p,_),t.update(_,s,1)},this.renderInstances=function d(p,_,S){if(0===S)return;let R,H;if(r)R=n,H="drawArraysInstanced";else if(R=e.get("ANGLE_instanced_arrays"),H="drawArraysInstancedANGLE",null===R)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");R[H](s,p,_,S),t.update(_,s,S)},this.renderMultiDraw=function u(p,_,S){if(0===S)return;const R=e.get("WEBGL_multi_draw");if(null===R)for(let H=0;H<S;H++)this.render(p[H],_[H]);else{R.multiDrawArraysWEBGL(s,p,0,_,0,S);let H=0;for(let re=0;re<S;re++)H+=_[re];t.update(H,s,1)}}}function Cue(n,e,t){let i;function s(Et){if("highp"===Et){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";Et="mediump"}return"mediump"===Et&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const a=typeof WebGL2RenderingContext<"u"&&"WebGL2RenderingContext"===n.constructor.name;let l=void 0!==t.precision?t.precision:"highp";const d=s(l);d!==l&&(console.warn("THREE.WebGLRenderer:",l,"not supported, using",d,"instead."),l=d);const u=a||e.has("WEBGL_draw_buffers"),p=!0===t.logarithmicDepthBuffer,_=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),S=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),R=n.getParameter(n.MAX_TEXTURE_SIZE),H=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),re=n.getParameter(n.MAX_VERTEX_ATTRIBS),se=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),ce=n.getParameter(n.MAX_VARYING_VECTORS),Te=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),Ce=S>0,qe=a||e.has("OES_texture_float");return{isWebGL2:a,drawBuffers:u,getMaxAnisotropy:function r(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const Et=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(Et.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:s,precision:l,logarithmicDepthBuffer:p,maxTextures:_,maxVertexTextures:S,maxTextureSize:R,maxCubemapSize:H,maxAttributes:re,maxVertexUniforms:se,maxVaryings:ce,maxFragmentUniforms:Te,vertexTextures:Ce,floatFragmentTextures:qe,floatVertexTextures:Ce&&qe,maxSamples:a?n.getParameter(n.MAX_SAMPLES):0}}function Mue(n){const e=this;let t=null,i=0,r=!1,s=!1;const a=new dA,l=new Ta,d={value:null,needsUpdate:!1};function p(_,S,R,H){const re=null!==_?_.length:0;let se=null;if(0!==re){if(se=d.value,!0!==H||null===se){const ce=R+4*re,Te=S.matrixWorldInverse;l.getNormalMatrix(Te),(null===se||se.length<ce)&&(se=new Float32Array(ce));for(let Ce=0,qe=R;Ce!==re;++Ce,qe+=4)a.copy(_[Ce]).applyMatrix4(Te,l),a.normal.toArray(se,qe),se[qe+3]=a.constant}d.value=se,d.needsUpdate=!0}return e.numPlanes=re,e.numIntersection=0,se}this.uniform=d,this.numPlanes=0,this.numIntersection=0,this.init=function(_,S){const R=0!==_.length||S||0!==i||r;return r=S,i=_.length,R},this.beginShadows=function(){s=!0,p(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(_,S){t=p(_,S,0)},this.setState=function(_,S,R){const H=_.clippingPlanes,re=_.clipIntersection,se=_.clipShadows,ce=n.get(_);if(!r||null===H||0===H.length||s&&!se)s?p(null):function u(){d.value!==t&&(d.value=t,d.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}();else{const Te=s?0:i,Ce=4*Te;let qe=ce.clippingState||null;d.value=qe,qe=p(H,S,Ce,R);for(let wt=0;wt!==Ce;++wt)qe[wt]=t[wt];ce.clippingState=qe,this.numIntersection=re?this.numPlanes:0,this.numPlanes+=Te}}}function Sue(n){let e=new WeakMap;function t(a,l){return 303===l?a.mapping=By:304===l&&(a.mapping=Tb),a}function r(a){const l=a.target;l.removeEventListener("dispose",r);const d=e.get(l);void 0!==d&&(e.delete(l),d.dispose())}return{get:function i(a){if(a&&a.isTexture){const l=a.mapping;if(303===l||304===l){if(e.has(a))return t(e.get(a).texture,a.mapping);{const d=a.image;if(d&&d.height>0){const u=new Ace(d.height);return u.fromEquirectangularTexture(n,a),e.set(a,u),a.addEventListener("dispose",r),t(u.texture,a.mapping)}return null}}}return a},dispose:function s(){e=new WeakMap}}}class Q2 extends w5{constructor(e=-1,t=1,i=1,r=-1,s=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,a=i+e,l=r+t,d=r-t;if(null!==this.view&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,p=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=u*this.view.offsetX,a=s+u*this.view.width,l-=p*this.view.offsetY,d=l-p*this.view.height}this.projectionMatrix.makeOrthographic(s,a,l,d,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const mV=[.125,.215,.35,.446,.526,.582],M5=new Q2,AV=new Cr;let S5=null,E5=0,T5=0;const Hb=(1+Math.sqrt(5))/2,j2=1/Hb,gV=[new It(1,1,1),new It(-1,1,1),new It(1,1,-1),new It(-1,1,-1),new It(0,Hb,j2),new It(0,Hb,-j2),new It(j2,0,Hb),new It(-j2,0,Hb),new It(Hb,j2,0),new It(-Hb,j2,0)];class _V{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){S5=this._renderer.getRenderTarget(),E5=this._renderer.getActiveCubeFace(),T5=this._renderer.getActiveMipmapLevel(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=bV(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=vV(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(S5,E5,T5),e.scissorTest=!1,yI(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===By||e.mapping===Tb?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),S5=this._renderer.getRenderTarget(),E5=this._renderer.getActiveCubeFace(),T5=this._renderer.getActiveMipmapLevel();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:Hc,minFilter:Hc,generateMipmaps:!1,type:lA,format:gp,colorSpace:Wu,depthBuffer:!1},r=yV(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=yV(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function Eue(n){const e=[],t=[],i=[];let r=n;const s=n-4+1+mV.length;for(let a=0;a<s;a++){const l=Math.pow(2,r);t.push(l);let d=1/l;a>n-4?d=mV[a-n+4-1]:0===a&&(d=0),i.push(d);const u=1/(l-2),p=-u,_=1+u,S=[p,p,_,p,_,_,p,p,_,_,p,_],R=6,H=6,re=3,se=2,ce=1,Te=new Float32Array(re*H*R),Ce=new Float32Array(se*H*R),qe=new Float32Array(ce*H*R);for(let gt=0;gt<R;gt++){const Et=gt%3*2/3-1,Xt=gt>2?0:-1;Te.set([Et,Xt,0,Et+2/3,Xt,0,Et+2/3,Xt+1,0,Et,Xt,0,Et+2/3,Xt+1,0,Et,Xt+1,0],re*H*gt),Ce.set(S,se*H*gt),qe.set([gt,gt,gt,gt,gt,gt],ce*H*gt)}const wt=new no;wt.setAttribute("position",new No(Te,re)),wt.setAttribute("uv",new No(Ce,se)),wt.setAttribute("faceIndex",new No(qe,ce)),e.push(wt),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(s)),this._blurMaterial=function Tue(n,e,t){const i=new Float32Array(20),r=new It(0,1,0);return new Iu({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new ua(this._lodPlanes[0],e);this._renderer.compile(t,M5)}_sceneToCubeUV(e,t,i,r){const l=new Bu(90,1,t,i),d=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],p=this._renderer,_=p.autoClear,S=p.toneMapping;p.getClearColor(AV),p.toneMapping=Iy,p.autoClear=!1;const R=new xd({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),H=new ua(new yp,R);let re=!1;const se=e.background;se?se.isColor&&(R.color.copy(se),e.background=null,re=!0):(R.color.copy(AV),re=!0);for(let ce=0;ce<6;ce++){const Te=ce%3;0===Te?(l.up.set(0,d[ce],0),l.lookAt(u[ce],0,0)):1===Te?(l.up.set(0,0,d[ce]),l.lookAt(0,u[ce],0)):(l.up.set(0,d[ce],0),l.lookAt(0,0,u[ce]));const Ce=this._cubeSize;yI(r,Te*Ce,ce>2?Ce:0,Ce,Ce),p.setRenderTarget(r),re&&p.render(H,l),p.render(e,l)}H.geometry.dispose(),H.material.dispose(),p.toneMapping=S,p.autoClear=_,e.background=se}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===By||e.mapping===Tb;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=bV()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=vV());const s=r?this._cubemapMaterial:this._equirectMaterial,a=new ua(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const d=this._cubeSize;yI(t,0,0,3*d,2*d),i.setRenderTarget(t),i.render(a,M5)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,gV[(r-1)%gV.length])}t.autoClear=i}_blur(e,t,i,r,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,i,r,"latitudinal",s),this._halfBlur(a,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,a,l){const d=this._renderer,u=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");const _=new ua(this._lodPlanes[r],u),S=u.uniforms,R=this._sizeLods[i]-1,H=isFinite(s)?Math.PI/(2*R):2*Math.PI/39,re=s/H,se=isFinite(s)?1+Math.floor(3*re):20;se>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${se} samples when the maximum is set to 20`);const ce=[];let Te=0;for(let Et=0;Et<20;++Et){const Xt=Et/re,Un=Math.exp(-Xt*Xt/2);ce.push(Un),0===Et?Te+=Un:Et<se&&(Te+=2*Un)}for(let Et=0;Et<ce.length;Et++)ce[Et]=ce[Et]/Te;S.envMap.value=e.texture,S.samples.value=se,S.weights.value=ce,S.latitudinal.value="latitudinal"===a,l&&(S.poleAxis.value=l);const{_lodMax:Ce}=this;S.dTheta.value=H,S.mipInt.value=Ce-i;const qe=this._sizeLods[r];yI(t,3*qe*(r>Ce-4?r-Ce+4:0),4*(this._cubeSize-qe),3*qe,2*qe),d.setRenderTarget(t),d.render(_,M5)}}function yV(n,e,t){const i=new ju(n,e,t);return i.texture.mapping=zS,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function yI(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function vV(){return new Iu({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function bV(){return new Iu({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Due(n){let e=new WeakMap,t=null;function s(l){const d=l.target;d.removeEventListener("dispose",s);const u=e.get(d);void 0!==u&&(e.delete(d),u.dispose())}return{get:function i(l){if(l&&l.isTexture){const d=l.mapping,u=303===d||304===d,p=d===By||d===Tb;if(u||p){if(l.isRenderTargetTexture&&!0===l.needsPMREMUpdate){l.needsPMREMUpdate=!1;let _=e.get(l);return null===t&&(t=new _V(n)),_=u?t.fromEquirectangular(l,_):t.fromCubemap(l,_),e.set(l,_),_.texture}if(e.has(l))return e.get(l).texture;{const _=l.image;if(u&&_&&_.height>0||p&&_&&function r(l){let d=0;for(let p=0;p<6;p++)void 0!==l[p]&&d++;return 6===d}(_)){null===t&&(t=new _V(n));const S=u?t.fromEquirectangular(l):t.fromCubemap(l);return e.set(l,S),l.addEventListener("dispose",s),S.texture}return null}}}return l},dispose:function a(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function Iue(n){const e={};function t(i){if(void 0!==e[i])return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return null!==t(i)},init:function(i){i.isWebGL2?(t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance")):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return null===r&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function Bue(n,e,t,i){const r={},s=new WeakMap;function a(_){const S=_.target;null!==S.index&&e.remove(S.index);for(const H in S.attributes)e.remove(S.attributes[H]);for(const H in S.morphAttributes){const re=S.morphAttributes[H];for(let se=0,ce=re.length;se<ce;se++)e.remove(re[se])}S.removeEventListener("dispose",a),delete r[S.id];const R=s.get(S);R&&(e.remove(R),s.delete(S)),i.releaseStatesOfGeometry(S),!0===S.isInstancedBufferGeometry&&delete S._maxInstanceCount,t.memory.geometries--}function u(_){const S=[],R=_.index,H=_.attributes.position;let re=0;if(null!==R){const Te=R.array;re=R.version;for(let Ce=0,qe=Te.length;Ce<qe;Ce+=3){const wt=Te[Ce+0],gt=Te[Ce+1],Et=Te[Ce+2];S.push(wt,gt,gt,Et,Et,wt)}}else{if(void 0===H)return;re=H.version;for(let Ce=0,qe=H.array.length/3-1;Ce<qe;Ce+=3){const wt=Ce+0,gt=Ce+1,Et=Ce+2;S.push(wt,gt,gt,Et,Et,wt)}}const se=new(VH(S)?sV:rV)(S,1);se.version=re;const ce=s.get(_);ce&&e.remove(ce),s.set(_,se)}return{get:function l(_,S){return!0===r[S.id]||(S.addEventListener("dispose",a),r[S.id]=!0,t.memory.geometries++),S},update:function d(_){const S=_.attributes;for(const H in S)e.update(S[H],n.ARRAY_BUFFER);const R=_.morphAttributes;for(const H in R){const re=R[H];for(let se=0,ce=re.length;se<ce;se++)e.update(re[se],n.ARRAY_BUFFER)}},getWireframeAttribute:function p(_){const S=s.get(_);if(S){const R=_.index;null!==R&&S.version<R.version&&u(_)}else u(_);return s.get(_)}}}function Pue(n,e,t,i){const r=i.isWebGL2;let s,l,d;this.setMode=function a(R){s=R},this.setIndex=function u(R){l=R.type,d=R.bytesPerElement},this.render=function p(R,H){n.drawElements(s,H,l,R*d),t.update(H,s,1)},this.renderInstances=function _(R,H,re){if(0===re)return;let se,ce;if(r)se=n,ce="drawElementsInstanced";else if(se=e.get("ANGLE_instanced_arrays"),ce="drawElementsInstancedANGLE",null===se)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");se[ce](s,H,l,R*d,re),t.update(H,s,re)},this.renderMultiDraw=function S(R,H,re){if(0===re)return;const se=e.get("WEBGL_multi_draw");if(null===se)for(let ce=0;ce<re;ce++)this.render(R[ce]/d,H[ce]);else{se.multiDrawElementsWEBGL(s,H,0,l,R,0,re);let ce=0;for(let Te=0;Te<re;Te++)ce+=H[Te];t.update(ce,s,1)}}}function Rue(n){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(s,a,l){switch(t.calls++,a){case n.TRIANGLES:t.triangles+=l*(s/3);break;case n.LINES:t.lines+=l*(s/2);break;case n.LINE_STRIP:t.lines+=l*(s-1);break;case n.LINE_LOOP:t.lines+=l*s;break;case n.POINTS:t.points+=l*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a)}}}}function kue(n,e){return n[0]-e[0]}function Fue(n,e){return Math.abs(e[1])-Math.abs(n[1])}function Oue(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,a=new nc,l=[];for(let u=0;u<8;u++)l[u]=[u,0];return{update:function d(u,p,_){const S=u.morphTargetInfluences;if(!0===e.isWebGL2){const R=p.morphAttributes.position||p.morphAttributes.normal||p.morphAttributes.color,H=void 0!==R?R.length:0;let re=s.get(p);if(void 0===re||re.count!==H){let Gi=function(){Ct.dispose(),s.delete(p),p.removeEventListener("dispose",Gi)};void 0!==re&&re.texture.dispose();const se=void 0!==p.morphAttributes.position,ce=void 0!==p.morphAttributes.normal,Te=void 0!==p.morphAttributes.color,Ce=p.morphAttributes.position||[],qe=p.morphAttributes.normal||[],wt=p.morphAttributes.color||[];let gt=0;!0===se&&(gt=1),!0===ce&&(gt=2),!0===Te&&(gt=3);let Et=p.attributes.position.count*gt,Xt=1;Et>e.maxTextureSize&&(Xt=Math.ceil(Et/e.maxTextureSize),Et=e.maxTextureSize);const Un=new Float32Array(Et*Xt*4*H),Ct=new s5(Un,Et,Xt,H);Ct.type=aA,Ct.needsUpdate=!0;const Kt=4*gt;for(let Yi=0;Yi<H;Yi++){const En=Ce[Yi],wi=qe[Yi],zn=wt[Yi],oi=Et*Xt*4*Yi;for(let hi=0;hi<En.count;hi++){const vi=hi*Kt;!0===se&&(a.fromBufferAttribute(En,hi),Un[oi+vi+0]=a.x,Un[oi+vi+1]=a.y,Un[oi+vi+2]=a.z,Un[oi+vi+3]=0),!0===ce&&(a.fromBufferAttribute(wi,hi),Un[oi+vi+4]=a.x,Un[oi+vi+5]=a.y,Un[oi+vi+6]=a.z,Un[oi+vi+7]=0),!0===Te&&(a.fromBufferAttribute(zn,hi),Un[oi+vi+8]=a.x,Un[oi+vi+9]=a.y,Un[oi+vi+10]=a.z,Un[oi+vi+11]=4===zn.itemSize?a.w:1)}}re={count:H,texture:Ct,size:new Qi(Et,Xt)},s.set(p,re),p.addEventListener("dispose",Gi)}if(!0===u.isInstancedMesh&&null!==u.morphTexture)_.getUniforms().setValue(n,"morphTexture",u.morphTexture,t);else{let se=0;for(let Te=0;Te<S.length;Te++)se+=S[Te];const ce=p.morphTargetsRelative?1:1-se;_.getUniforms().setValue(n,"morphTargetBaseInfluence",ce),_.getUniforms().setValue(n,"morphTargetInfluences",S)}_.getUniforms().setValue(n,"morphTargetsTexture",re.texture,t),_.getUniforms().setValue(n,"morphTargetsTextureSize",re.size)}else{const R=void 0===S?0:S.length;let H=i[p.id];if(void 0===H||H.length!==R){H=[];for(let Ce=0;Ce<R;Ce++)H[Ce]=[Ce,0];i[p.id]=H}for(let Ce=0;Ce<R;Ce++){const qe=H[Ce];qe[0]=Ce,qe[1]=S[Ce]}H.sort(Fue);for(let Ce=0;Ce<8;Ce++)Ce<R&&H[Ce][1]?(l[Ce][0]=H[Ce][0],l[Ce][1]=H[Ce][1]):(l[Ce][0]=Number.MAX_SAFE_INTEGER,l[Ce][1]=0);l.sort(kue);const re=p.morphAttributes.position,se=p.morphAttributes.normal;let ce=0;for(let Ce=0;Ce<8;Ce++){const qe=l[Ce],wt=qe[0],gt=qe[1];wt!==Number.MAX_SAFE_INTEGER&&gt?(re&&p.getAttribute("morphTarget"+Ce)!==re[wt]&&p.setAttribute("morphTarget"+Ce,re[wt]),se&&p.getAttribute("morphNormal"+Ce)!==se[wt]&&p.setAttribute("morphNormal"+Ce,se[wt]),r[Ce]=gt,ce+=gt):(re&&!0===p.hasAttribute("morphTarget"+Ce)&&p.deleteAttribute("morphTarget"+Ce),se&&!0===p.hasAttribute("morphNormal"+Ce)&&p.deleteAttribute("morphNormal"+Ce),r[Ce]=0)}const Te=p.morphTargetsRelative?1:1-ce;_.getUniforms().setValue(n,"morphTargetBaseInfluence",Te),_.getUniforms().setValue(n,"morphTargetInfluences",r)}}}}function Lue(n,e,t,i){let r=new WeakMap;function l(d){const u=d.target;u.removeEventListener("dispose",l),t.remove(u.instanceMatrix),null!==u.instanceColor&&t.remove(u.instanceColor)}return{update:function s(d){const u=i.render.frame,_=e.get(d,d.geometry);if(r.get(_)!==u&&(e.update(_),r.set(_,u)),d.isInstancedMesh&&(!1===d.hasEventListener("dispose",l)&&d.addEventListener("dispose",l),r.get(d)!==u&&(t.update(d.instanceMatrix,n.ARRAY_BUFFER),null!==d.instanceColor&&t.update(d.instanceColor,n.ARRAY_BUFFER),r.set(d,u))),d.isSkinnedMesh){const S=d.skeleton;r.get(S)!==u&&(S.update(),r.set(S,u))}return _},dispose:function a(){r=new WeakMap}}}class xV extends zh{constructor(e,t,i,r,s,a,l,d,u,p){if((p=void 0!==p?p:Ib)!==Ib&&p!==v2)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&p===Ib&&(i=Fy),void 0===i&&p===v2&&(i=Db),super(null,r,s,a,l,d,p,i,u),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==l?l:vd,this.minFilter=void 0!==d?d:vd,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}const wV=new zh,CV=new xV(1,1);CV.compareFunction=515;const MV=new s5,SV=new $H,EV=new mI,TV=[],DV=[],IV=new Float32Array(16),BV=new Float32Array(9),PV=new Float32Array(4);function $2(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=TV[r];if(void 0===s&&(s=new Float32Array(r),TV[r]=s),0!==e){i.toArray(s,0);for(let a=1,l=0;a!==e;++a)l+=t,n[a].toArray(s,l)}return s}function Pu(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function Ru(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function vI(n,e){let t=DV[e];void 0===t&&(t=new Int32Array(e),DV[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function Nue(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function Uue(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Pu(t,e))return;n.uniform2fv(this.addr,e),Ru(t,e)}}function zue(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Pu(t,e))return;n.uniform3fv(this.addr,e),Ru(t,e)}}function Hue(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Pu(t,e))return;n.uniform4fv(this.addr,e),Ru(t,e)}}function Vue(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Pu(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Ru(t,e)}else{if(Pu(t,i))return;PV.set(i),n.uniformMatrix2fv(this.addr,!1,PV),Ru(t,i)}}function Gue(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Pu(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Ru(t,e)}else{if(Pu(t,i))return;BV.set(i),n.uniformMatrix3fv(this.addr,!1,BV),Ru(t,i)}}function que(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Pu(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Ru(t,e)}else{if(Pu(t,i))return;IV.set(i),n.uniformMatrix4fv(this.addr,!1,IV),Ru(t,i)}}function Que(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function Wue(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Pu(t,e))return;n.uniform2iv(this.addr,e),Ru(t,e)}}function jue(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Pu(t,e))return;n.uniform3iv(this.addr,e),Ru(t,e)}}function $ue(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Pu(t,e))return;n.uniform4iv(this.addr,e),Ru(t,e)}}function Xue(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function Yue(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Pu(t,e))return;n.uniform2uiv(this.addr,e),Ru(t,e)}}function Kue(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Pu(t,e))return;n.uniform3uiv(this.addr,e),Ru(t,e)}}function Zue(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Pu(t,e))return;n.uniform4uiv(this.addr,e),Ru(t,e)}}function Jue(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||(this.type===n.SAMPLER_2D_SHADOW?CV:wV),r)}function ehe(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||SV,r)}function the(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||EV,r)}function nhe(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||MV,r)}function rhe(n,e){n.uniform1fv(this.addr,e)}function she(n,e){const t=$2(e,this.size,2);n.uniform2fv(this.addr,t)}function ohe(n,e){const t=$2(e,this.size,3);n.uniform3fv(this.addr,t)}function ahe(n,e){const t=$2(e,this.size,4);n.uniform4fv(this.addr,t)}function lhe(n,e){const t=$2(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function che(n,e){const t=$2(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function dhe(n,e){const t=$2(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function uhe(n,e){n.uniform1iv(this.addr,e)}function hhe(n,e){n.uniform2iv(this.addr,e)}function fhe(n,e){n.uniform3iv(this.addr,e)}function phe(n,e){n.uniform4iv(this.addr,e)}function mhe(n,e){n.uniform1uiv(this.addr,e)}function Ahe(n,e){n.uniform2uiv(this.addr,e)}function ghe(n,e){n.uniform3uiv(this.addr,e)}function _he(n,e){n.uniform4uiv(this.addr,e)}function yhe(n,e,t){const i=this.cache,r=e.length,s=vI(t,r);Pu(i,s)||(n.uniform1iv(this.addr,s),Ru(i,s));for(let a=0;a!==r;++a)t.setTexture2D(e[a]||wV,s[a])}function vhe(n,e,t){const i=this.cache,r=e.length,s=vI(t,r);Pu(i,s)||(n.uniform1iv(this.addr,s),Ru(i,s));for(let a=0;a!==r;++a)t.setTexture3D(e[a]||SV,s[a])}function bhe(n,e,t){const i=this.cache,r=e.length,s=vI(t,r);Pu(i,s)||(n.uniform1iv(this.addr,s),Ru(i,s));for(let a=0;a!==r;++a)t.setTextureCube(e[a]||EV,s[a])}function xhe(n,e,t){const i=this.cache,r=e.length,s=vI(t,r);Pu(i,s)||(n.uniform1iv(this.addr,s),Ru(i,s));for(let a=0;a!==r;++a)t.setTexture2DArray(e[a]||MV,s[a])}class Che{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=function ihe(n){switch(n){case 5126:return Nue;case 35664:return Uue;case 35665:return zue;case 35666:return Hue;case 35674:return Vue;case 35675:return Gue;case 35676:return que;case 5124:case 35670:return Que;case 35667:case 35671:return Wue;case 35668:case 35672:return jue;case 35669:case 35673:return $ue;case 5125:return Xue;case 36294:return Yue;case 36295:return Kue;case 36296:return Zue;case 35678:case 36198:case 36298:case 36306:case 35682:return Jue;case 35679:case 36299:case 36307:return ehe;case 35680:case 36300:case 36308:case 36293:return the;case 36289:case 36303:case 36311:case 36292:return nhe}}(t.type)}}class Mhe{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=function whe(n){switch(n){case 5126:return rhe;case 35664:return she;case 35665:return ohe;case 35666:return ahe;case 35674:return lhe;case 35675:return che;case 35676:return dhe;case 5124:case 35670:return uhe;case 35667:case 35671:return hhe;case 35668:case 35672:return fhe;case 35669:case 35673:return phe;case 5125:return mhe;case 36294:return Ahe;case 36295:return ghe;case 36296:return _he;case 35678:case 36198:case 36298:case 36306:case 35682:return yhe;case 35679:case 36299:case 36307:return vhe;case 35680:case 36300:case 36308:case 36293:return bhe;case 36289:case 36303:case 36311:case 36292:return xhe}}(t.type)}}class She{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,a=r.length;s!==a;++s){const l=r[s];l.setValue(e,t[l.id],i)}}}const I5=/(\w+)(\])?(\[|\.)?/g;function RV(n,e){n.seq.push(e),n.map[e.id]=e}function Ehe(n,e,t){const i=n.name,r=i.length;for(I5.lastIndex=0;;){const s=I5.exec(i);let l=s[1];const u=s[3];if("]"===s[2]&&(l|=0),void 0===u||"["===u&&I5.lastIndex+2===r){RV(t,void 0===u?new Che(l,n,e):new Mhe(l,n,e));break}{let _=t.map[l];void 0===_&&(_=new She(l),RV(t,_)),t=_}}}class bI{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r);Ehe(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,i,r){const s=this.map[t];void 0!==s&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];void 0!==r&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,a=t.length;s!==a;++s){const l=t[s],d=i[l.id];!1!==d.needsUpdate&&l.setValue(e,d.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const a=e[r];a.id in t&&i.push(a)}return i}}function kV(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}const The=37297;let Dhe=0;function FV(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const a=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function Ihe(n,e){const t=n.split("\n"),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let a=r;a<s;a++){const l=a+1;i.push(`${l===e?">":" "} ${l}: ${t[a]}`)}return i.join("\n")}(n.getShaderSource(e),a)}return r}function Phe(n,e){const t=function Bhe(n){const e=Ol.getPrimaries(Ol.workingColorSpace),t=Ol.getPrimaries(n);let i;switch(e===t?i="":e===jD&&t===WD?i="LinearDisplayP3ToLinearSRGB":e===WD&&t===jD&&(i="LinearSRGBToLinearDisplayP3"),n){case Wu:case qD:return[i,"LinearTransferOETF"];case du:case Kk:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[i,"LinearTransferOETF"]}}(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function Rhe(n,e){let t;switch(e){case ole:t="Linear";break;case ale:t="Reinhard";break;case lle:t="OptimizedCineon";break;case cle:t="ACESFilmic";break;case ule:t="AgX";break;case hle:t="Neutral";break;case dle:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function X2(n){return""!==n}function OV(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function LV(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Nhe=/^[ \t]*#include +<([\w\d./]+)>/gm;function B5(n){return n.replace(Nhe,zhe)}const Uhe=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function zhe(n,e){let t=xa[e];if(void 0===t){const i=Uhe.get(e);if(void 0===i)throw new Error("Can not resolve #include <"+e+">");t=xa[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i)}return B5(t)}const Hhe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function NV(n){return n.replace(Hhe,Vhe)}function Vhe(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function UV(n){let e=`precision ${n.precision} float;\n\tprecision ${n.precision} int;\n\tprecision ${n.precision} sampler2D;\n\tprecision ${n.precision} samplerCube;\n\t`;return n.isWebGL2&&(e+=`precision ${n.precision} sampler3D;\n\t\tprecision ${n.precision} sampler2DArray;\n\t\tprecision ${n.precision} sampler2DShadow;\n\t\tprecision ${n.precision} samplerCubeShadow;\n\t\tprecision ${n.precision} sampler2DArrayShadow;\n\t\tprecision ${n.precision} isampler2D;\n\t\tprecision ${n.precision} isampler3D;\n\t\tprecision ${n.precision} isamplerCube;\n\t\tprecision ${n.precision} isampler2DArray;\n\t\tprecision ${n.precision} usampler2D;\n\t\tprecision ${n.precision} usampler3D;\n\t\tprecision ${n.precision} usamplerCube;\n\t\tprecision ${n.precision} usampler2DArray;\n\t\t`),"highp"===n.precision?e+="\n#define HIGH_PRECISION":"mediump"===n.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===n.precision&&(e+="\n#define LOW_PRECISION"),e}function $he(n,e,t,i){const r=n.getContext(),s=t.defines;let a=t.vertexShader,l=t.fragmentShader;const d=function Ghe(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===Yz?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===kae?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===U_&&(e="SHADOWMAP_TYPE_VSM"),e}(t),u=function qhe(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case By:case Tb:e="ENVMAP_TYPE_CUBE";break;case zS:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),p=function Qhe(n){let e="ENVMAP_MODE_REFLECTION";return n.envMap&&n.envMapMode===Tb&&(e="ENVMAP_MODE_REFRACTION"),e}(t),_=function Whe(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case zD:e="ENVMAP_BLENDING_MULTIPLY";break;case rle:e="ENVMAP_BLENDING_MIX";break;case sle:e="ENVMAP_BLENDING_ADD"}return e}(t),S=function jhe(n){const e=n.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),R=t.isWebGL2?"":function khe(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||n.alphaToCoverage||"physical"===n.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(X2).join("\n")}(t),H=function Fhe(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(X2).join("\n")}(t),re=function Ohe(n){const e=[];for(const t in n){const i=n[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(s),se=r.createProgram();let ce,Te,Ce=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(ce=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,re].filter(X2).join("\n"),ce.length>0&&(ce+="\n"),Te=[R,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,re].filter(X2).join("\n"),Te.length>0&&(Te+="\n")):(ce=[UV(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,re,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+p:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(X2).join("\n"),Te=[R,UV(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,re,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.envMap?"#define "+p:"",t.envMap?"#define "+_:"",S?"#define CUBEUV_TEXEL_WIDTH "+S.texelWidth:"",S?"#define CUBEUV_TEXEL_HEIGHT "+S.texelHeight:"",S?"#define CUBEUV_MAX_MIP "+S.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Iy?"#define TONE_MAPPING":"",t.toneMapping!==Iy?xa.tonemapping_pars_fragment:"",t.toneMapping!==Iy?Rhe("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",xa.colorspace_pars_fragment,Phe("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(X2).join("\n")),a=B5(a),a=OV(a,t),a=LV(a,t),l=B5(l),l=OV(l,t),l=LV(l,t),a=NV(a),l=NV(l),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(Ce="#version 300 es\n",ce=[H,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+ce,Te=["precision mediump sampler2DArray;","#define varying in",t.glslVersion===zH?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===zH?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+Te);const wt=Ce+Te+l,gt=kV(r,r.VERTEX_SHADER,Ce+ce+a),Et=kV(r,r.FRAGMENT_SHADER,wt);function Xt(Gi){if(n.debug.checkShaderErrors){const Yi=r.getProgramInfoLog(se).trim(),En=r.getShaderInfoLog(gt).trim(),wi=r.getShaderInfoLog(Et).trim();let zn=!0,oi=!0;if(!1===r.getProgramParameter(se,r.LINK_STATUS))if(zn=!1,"function"==typeof n.debug.onShaderError)n.debug.onShaderError(r,se,gt,Et);else{const hi=FV(r,gt,"vertex"),vi=FV(r,Et,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(se,r.VALIDATE_STATUS)+"\n\nMaterial Name: "+Gi.name+"\nMaterial Type: "+Gi.type+"\n\nProgram Info Log: "+Yi+"\n"+hi+"\n"+vi)}else""!==Yi?console.warn("THREE.WebGLProgram: Program Info Log:",Yi):(""===En||""===wi)&&(oi=!1);oi&&(Gi.diagnostics={runnable:zn,programLog:Yi,vertexShader:{log:En,prefix:ce},fragmentShader:{log:wi,prefix:Te}})}r.deleteShader(gt),r.deleteShader(Et),Un=new bI(r,se),Ct=function Lhe(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),a=s.name;let l=1;s.type===n.FLOAT_MAT2&&(l=2),s.type===n.FLOAT_MAT3&&(l=3),s.type===n.FLOAT_MAT4&&(l=4),t[a]={type:s.type,location:n.getAttribLocation(e,a),locationSize:l}}return t}(r,se)}let Un,Ct;r.attachShader(se,gt),r.attachShader(se,Et),void 0!==t.index0AttributeName?r.bindAttribLocation(se,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(se,0,"position"),r.linkProgram(se),this.getUniforms=function(){return void 0===Un&&Xt(this),Un},this.getAttributes=function(){return void 0===Ct&&Xt(this),Ct};let Kt=!1===t.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===Kt&&(Kt=r.getProgramParameter(se,The)),Kt},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(se),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=Dhe++,this.cacheKey=e,this.usedTimes=1,this.program=se,this.vertexShader=gt,this.fragmentShader=Et,this}let Xhe=0;class Yhe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(i),a=this._getShaderCacheForMaterial(e);return!1===a.has(r)&&(a.add(r),r.usedTimes++),!1===a.has(s)&&(a.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return void 0===i&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return void 0===i&&(i=new Khe(e),t.set(e,i)),i}}class Khe{constructor(e){this.id=Xhe++,this.code=e,this.usedTimes=0}}function Zhe(n,e,t,i,r,s,a){const l=new h5,d=new Yhe,u=new Set,p=[],_=r.isWebGL2,S=r.logarithmicDepthBuffer,R=r.vertexTextures;let H=r.precision;const re={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function se(Ct){return u.add(Ct),0===Ct?"uv":`uv${Ct}`}return{getParameters:function ce(Ct,Kt,Gi,Yi,En){const wi=Yi.fog,zn=En.geometry,hi=(Ct.isMeshStandardMaterial?t:e).get(Ct.envMap||(Ct.isMeshStandardMaterial?Yi.environment:null)),vi=hi&&hi.mapping===zS?hi.image.height:null,mr=re[Ct.type];null!==Ct.precision&&(H=r.getMaxPrecision(Ct.precision),H!==Ct.precision&&console.warn("THREE.WebGLProgram.getParameters:",Ct.precision,"not supported, using",H,"instead."));const Mr=zn.morphAttributes.position||zn.morphAttributes.normal||zn.morphAttributes.color,is=void 0!==Mr?Mr.length:0;let fi,Rr,ms,Fs,$s=0;if(void 0!==zn.morphAttributes.position&&($s=1),void 0!==zn.morphAttributes.normal&&($s=2),void 0!==zn.morphAttributes.color&&($s=3),mr){const jl=S0[mr];fi=jl.vertexShader,Rr=jl.fragmentShader}else fi=Ct.vertexShader,Rr=Ct.fragmentShader,d.update(Ct),ms=d.getVertexShaderID(Ct),Fs=d.getFragmentShaderID(Ct);const Us=n.getRenderTarget(),ws=!0===En.isInstancedMesh,lo=!!Ct.map,ps=!!hi,gr=!!Ct.aoMap,ls=!!Ct.lightMap,Tr=!!Ct.bumpMap,Ys=!!Ct.normalMap,qs=!!Ct.displacementMap,uo=!!Ct.emissiveMap,ka=!!Ct.metalnessMap,gn=!!Ct.roughnessMap,Ht=Ct.anisotropy>0,ar=Ct.clearcoat>0,hr=Ct.iridescence>0,$r=Ct.sheen>0,Or=Ct.transmission>0,Aa=Ht&&!!Ct.anisotropyMap,Qo=ar&&!!Ct.clearcoatMap,As=ar&&!!Ct.clearcoatNormalMap,Is=ar&&!!Ct.clearcoatRoughnessMap,ga=hr&&!!Ct.iridescenceMap,hs=hr&&!!Ct.iridescenceThicknessMap,Sd=$r&&!!Ct.sheenColorMap,qa=$r&&!!Ct.sheenRoughnessMap,Ro=!!Ct.specularMap,ho=!!Ct.specularColorMap,To=!!Ct.specularIntensityMap,Tn=Or&&!!Ct.transmissionMap,Er=Or&&!!Ct.thicknessMap,Xn=!!Ct.alphaMap,Xr=!!Ct.extensions;let Hs=Iy;Ct.toneMapped&&(null===Us||!0===Us.isXRRenderTarget)&&(Hs=n.toneMapping);const Xa={isWebGL2:_,shaderID:mr,shaderType:Ct.type,shaderName:Ct.name,vertexShader:fi,fragmentShader:Rr,defines:Ct.defines,customVertexShaderID:ms,customFragmentShaderID:Fs,isRawShaderMaterial:!0===Ct.isRawShaderMaterial,glslVersion:Ct.glslVersion,precision:H,batching:!0===En.isBatchedMesh,instancing:ws,instancingColor:ws&&null!==En.instanceColor,instancingMorph:ws&&null!==En.morphTexture,supportsVertexTextures:R,outputColorSpace:null===Us?n.outputColorSpace:!0===Us.isXRRenderTarget?Us.texture.colorSpace:Wu,alphaToCoverage:!!Ct.alphaToCoverage,map:lo,matcap:!!Ct.matcap,envMap:ps,envMapMode:ps&&hi.mapping,envMapCubeUVHeight:vi,aoMap:gr,lightMap:ls,bumpMap:Tr,normalMap:Ys,displacementMap:R&&qs,emissiveMap:uo,normalMapObjectSpace:Ys&&1===Ct.normalMapType,normalMapTangentSpace:Ys&&0===Ct.normalMapType,metalnessMap:ka,roughnessMap:gn,anisotropy:Ht,anisotropyMap:Aa,clearcoat:ar,clearcoatMap:Qo,clearcoatNormalMap:As,clearcoatRoughnessMap:Is,iridescence:hr,iridescenceMap:ga,iridescenceThicknessMap:hs,sheen:$r,sheenColorMap:Sd,sheenRoughnessMap:qa,specularMap:Ro,specularColorMap:ho,specularIntensityMap:To,transmission:Or,transmissionMap:Tn,thicknessMap:Er,gradientMap:!!Ct.gradientMap,opaque:!1===Ct.transparent&&1===Ct.blending&&!1===Ct.alphaToCoverage,alphaMap:Xn,alphaTest:Ct.alphaTest>0,alphaHash:!!Ct.alphaHash,combine:Ct.combine,mapUv:lo&&se(Ct.map.channel),aoMapUv:gr&&se(Ct.aoMap.channel),lightMapUv:ls&&se(Ct.lightMap.channel),bumpMapUv:Tr&&se(Ct.bumpMap.channel),normalMapUv:Ys&&se(Ct.normalMap.channel),displacementMapUv:qs&&se(Ct.displacementMap.channel),emissiveMapUv:uo&&se(Ct.emissiveMap.channel),metalnessMapUv:ka&&se(Ct.metalnessMap.channel),roughnessMapUv:gn&&se(Ct.roughnessMap.channel),anisotropyMapUv:Aa&&se(Ct.anisotropyMap.channel),clearcoatMapUv:Qo&&se(Ct.clearcoatMap.channel),clearcoatNormalMapUv:As&&se(Ct.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Is&&se(Ct.clearcoatRoughnessMap.channel),iridescenceMapUv:ga&&se(Ct.iridescenceMap.channel),iridescenceThicknessMapUv:hs&&se(Ct.iridescenceThicknessMap.channel),sheenColorMapUv:Sd&&se(Ct.sheenColorMap.channel),sheenRoughnessMapUv:qa&&se(Ct.sheenRoughnessMap.channel),specularMapUv:Ro&&se(Ct.specularMap.channel),specularColorMapUv:ho&&se(Ct.specularColorMap.channel),specularIntensityMapUv:To&&se(Ct.specularIntensityMap.channel),transmissionMapUv:Tn&&se(Ct.transmissionMap.channel),thicknessMapUv:Er&&se(Ct.thicknessMap.channel),alphaMapUv:Xn&&se(Ct.alphaMap.channel),vertexTangents:!!zn.attributes.tangent&&(Ys||Ht),vertexColors:Ct.vertexColors,vertexAlphas:!0===Ct.vertexColors&&!!zn.attributes.color&&4===zn.attributes.color.itemSize,pointsUvs:!0===En.isPoints&&!!zn.attributes.uv&&(lo||Xn),fog:!!wi,useFog:!0===Ct.fog,fogExp2:!!wi&&wi.isFogExp2,flatShading:!0===Ct.flatShading,sizeAttenuation:!0===Ct.sizeAttenuation,logarithmicDepthBuffer:S,skinning:!0===En.isSkinnedMesh,morphTargets:void 0!==zn.morphAttributes.position,morphNormals:void 0!==zn.morphAttributes.normal,morphColors:void 0!==zn.morphAttributes.color,morphTargetsCount:is,morphTextureStride:$s,numDirLights:Kt.directional.length,numPointLights:Kt.point.length,numSpotLights:Kt.spot.length,numSpotLightMaps:Kt.spotLightMap.length,numRectAreaLights:Kt.rectArea.length,numHemiLights:Kt.hemi.length,numDirLightShadows:Kt.directionalShadowMap.length,numPointLightShadows:Kt.pointShadowMap.length,numSpotLightShadows:Kt.spotShadowMap.length,numSpotLightShadowsWithMaps:Kt.numSpotLightShadowsWithMaps,numLightProbes:Kt.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:Ct.dithering,shadowMapEnabled:n.shadowMap.enabled&&Gi.length>0,shadowMapType:n.shadowMap.type,toneMapping:Hs,useLegacyLights:n._useLegacyLights,decodeVideoTexture:lo&&!0===Ct.map.isVideoTexture&&Ol.getTransfer(Ct.map.colorSpace)===Vc,premultipliedAlpha:Ct.premultipliedAlpha,doubleSided:2===Ct.side,flipSided:1===Ct.side,useDepthPacking:Ct.depthPacking>=0,depthPacking:Ct.depthPacking||0,index0AttributeName:Ct.index0AttributeName,extensionDerivatives:Xr&&!0===Ct.extensions.derivatives,extensionFragDepth:Xr&&!0===Ct.extensions.fragDepth,extensionDrawBuffers:Xr&&!0===Ct.extensions.drawBuffers,extensionShaderTextureLOD:Xr&&!0===Ct.extensions.shaderTextureLOD,extensionClipCullDistance:Xr&&!0===Ct.extensions.clipCullDistance&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:Xr&&!0===Ct.extensions.multiDraw&&i.has("WEBGL_multi_draw"),rendererExtensionFragDepth:_||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:_||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:_||i.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:Ct.customProgramCacheKey()};return Xa.vertexUv1s=u.has(1),Xa.vertexUv2s=u.has(2),Xa.vertexUv3s=u.has(3),u.clear(),Xa},getProgramCacheKey:function Te(Ct){const Kt=[];if(Ct.shaderID?Kt.push(Ct.shaderID):(Kt.push(Ct.customVertexShaderID),Kt.push(Ct.customFragmentShaderID)),void 0!==Ct.defines)for(const Gi in Ct.defines)Kt.push(Gi),Kt.push(Ct.defines[Gi]);return!1===Ct.isRawShaderMaterial&&(function Ce(Ct,Kt){Ct.push(Kt.precision),Ct.push(Kt.outputColorSpace),Ct.push(Kt.envMapMode),Ct.push(Kt.envMapCubeUVHeight),Ct.push(Kt.mapUv),Ct.push(Kt.alphaMapUv),Ct.push(Kt.lightMapUv),Ct.push(Kt.aoMapUv),Ct.push(Kt.bumpMapUv),Ct.push(Kt.normalMapUv),Ct.push(Kt.displacementMapUv),Ct.push(Kt.emissiveMapUv),Ct.push(Kt.metalnessMapUv),Ct.push(Kt.roughnessMapUv),Ct.push(Kt.anisotropyMapUv),Ct.push(Kt.clearcoatMapUv),Ct.push(Kt.clearcoatNormalMapUv),Ct.push(Kt.clearcoatRoughnessMapUv),Ct.push(Kt.iridescenceMapUv),Ct.push(Kt.iridescenceThicknessMapUv),Ct.push(Kt.sheenColorMapUv),Ct.push(Kt.sheenRoughnessMapUv),Ct.push(Kt.specularMapUv),Ct.push(Kt.specularColorMapUv),Ct.push(Kt.specularIntensityMapUv),Ct.push(Kt.transmissionMapUv),Ct.push(Kt.thicknessMapUv),Ct.push(Kt.combine),Ct.push(Kt.fogExp2),Ct.push(Kt.sizeAttenuation),Ct.push(Kt.morphTargetsCount),Ct.push(Kt.morphAttributeCount),Ct.push(Kt.numDirLights),Ct.push(Kt.numPointLights),Ct.push(Kt.numSpotLights),Ct.push(Kt.numSpotLightMaps),Ct.push(Kt.numHemiLights),Ct.push(Kt.numRectAreaLights),Ct.push(Kt.numDirLightShadows),Ct.push(Kt.numPointLightShadows),Ct.push(Kt.numSpotLightShadows),Ct.push(Kt.numSpotLightShadowsWithMaps),Ct.push(Kt.numLightProbes),Ct.push(Kt.shadowMapType),Ct.push(Kt.toneMapping),Ct.push(Kt.numClippingPlanes),Ct.push(Kt.numClipIntersection),Ct.push(Kt.depthPacking)}(Kt,Ct),function qe(Ct,Kt){l.disableAll(),Kt.isWebGL2&&l.enable(0),Kt.supportsVertexTextures&&l.enable(1),Kt.instancing&&l.enable(2),Kt.instancingColor&&l.enable(3),Kt.instancingMorph&&l.enable(4),Kt.matcap&&l.enable(5),Kt.envMap&&l.enable(6),Kt.normalMapObjectSpace&&l.enable(7),Kt.normalMapTangentSpace&&l.enable(8),Kt.clearcoat&&l.enable(9),Kt.iridescence&&l.enable(10),Kt.alphaTest&&l.enable(11),Kt.vertexColors&&l.enable(12),Kt.vertexAlphas&&l.enable(13),Kt.vertexUv1s&&l.enable(14),Kt.vertexUv2s&&l.enable(15),Kt.vertexUv3s&&l.enable(16),Kt.vertexTangents&&l.enable(17),Kt.anisotropy&&l.enable(18),Kt.alphaHash&&l.enable(19),Kt.batching&&l.enable(20),Ct.push(l.mask),l.disableAll(),Kt.fog&&l.enable(0),Kt.useFog&&l.enable(1),Kt.flatShading&&l.enable(2),Kt.logarithmicDepthBuffer&&l.enable(3),Kt.skinning&&l.enable(4),Kt.morphTargets&&l.enable(5),Kt.morphNormals&&l.enable(6),Kt.morphColors&&l.enable(7),Kt.premultipliedAlpha&&l.enable(8),Kt.shadowMapEnabled&&l.enable(9),Kt.useLegacyLights&&l.enable(10),Kt.doubleSided&&l.enable(11),Kt.flipSided&&l.enable(12),Kt.useDepthPacking&&l.enable(13),Kt.dithering&&l.enable(14),Kt.transmission&&l.enable(15),Kt.sheen&&l.enable(16),Kt.opaque&&l.enable(17),Kt.pointsUvs&&l.enable(18),Kt.decodeVideoTexture&&l.enable(19),Kt.alphaToCoverage&&l.enable(20),Ct.push(l.mask)}(Kt,Ct),Kt.push(n.outputColorSpace)),Kt.push(Ct.customProgramCacheKey),Kt.join()},getUniforms:function wt(Ct){const Kt=re[Ct.type];let Gi;return Gi=Kt?x5.clone(S0[Kt].uniforms):Ct.uniforms,Gi},acquireProgram:function gt(Ct,Kt){let Gi;for(let Yi=0,En=p.length;Yi<En;Yi++){const wi=p[Yi];if(wi.cacheKey===Kt){Gi=wi,++Gi.usedTimes;break}}return void 0===Gi&&(Gi=new $he(n,Kt,Ct,s),p.push(Gi)),Gi},releaseProgram:function Et(Ct){if(0==--Ct.usedTimes){const Kt=p.indexOf(Ct);p[Kt]=p[p.length-1],p.pop(),Ct.destroy()}},releaseShaderCache:function Xt(Ct){d.remove(Ct)},programs:p,dispose:function Un(){d.dispose()}}}function Jhe(){let n=new WeakMap;return{get:function e(s){let a=n.get(s);return void 0===a&&(a={},n.set(s,a)),a},remove:function t(s){n.delete(s)},update:function i(s,a,l){n.get(s)[a]=l},dispose:function r(){n=new WeakMap}}}function efe(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function zV(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function HV(){const n=[];let e=0;const t=[],i=[],r=[];function a(_,S,R,H,re,se){let ce=n[e];return void 0===ce?(ce={id:_.id,object:_,geometry:S,material:R,groupOrder:H,renderOrder:_.renderOrder,z:re,group:se},n[e]=ce):(ce.id=_.id,ce.object=_,ce.geometry=S,ce.material=R,ce.groupOrder=H,ce.renderOrder=_.renderOrder,ce.z=re,ce.group=se),e++,ce}return{opaque:t,transmissive:i,transparent:r,init:function s(){e=0,t.length=0,i.length=0,r.length=0},push:function l(_,S,R,H,re,se){const ce=a(_,S,R,H,re,se);R.transmission>0?i.push(ce):!0===R.transparent?r.push(ce):t.push(ce)},unshift:function d(_,S,R,H,re,se){const ce=a(_,S,R,H,re,se);R.transmission>0?i.unshift(ce):!0===R.transparent?r.unshift(ce):t.unshift(ce)},finish:function p(){for(let _=e,S=n.length;_<S;_++){const R=n[_];if(null===R.id)break;R.id=null,R.object=null,R.geometry=null,R.material=null,R.group=null}},sort:function u(_,S){t.length>1&&t.sort(_||efe),i.length>1&&i.sort(S||zV),r.length>1&&r.sort(S||zV)}}}function tfe(){let n=new WeakMap;return{get:function e(i,r){const s=n.get(i);let a;return void 0===s?(a=new HV,n.set(i,[a])):r>=s.length?(a=new HV,s.push(a)):a=s[r],a},dispose:function t(){n=new WeakMap}}}function nfe(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new It,color:new Cr};break;case"SpotLight":t={position:new It,direction:new It,color:new Cr,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new It,color:new Cr,distance:0,decay:0};break;case"HemisphereLight":t={direction:new It,skyColor:new Cr,groundColor:new Cr};break;case"RectAreaLight":t={color:new Cr,position:new It,halfWidth:new It,halfHeight:new It}}return n[e.id]=t,t}}}let rfe=0;function sfe(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function ofe(n,e){const t=new nfe,i=function ife(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Qi};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Qi,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let p=0;p<9;p++)r.probe.push(new It);const s=new It,a=new wo,l=new wo;return{setup:function d(p,_){let S=0,R=0,H=0;for(let Gi=0;Gi<9;Gi++)r.probe[Gi].set(0,0,0);let re=0,se=0,ce=0,Te=0,Ce=0,qe=0,wt=0,gt=0,Et=0,Xt=0,Un=0;p.sort(sfe);const Ct=!0===_?Math.PI:1;for(let Gi=0,Yi=p.length;Gi<Yi;Gi++){const En=p[Gi],wi=En.color,zn=En.intensity,oi=En.distance,hi=En.shadow&&En.shadow.map?En.shadow.map.texture:null;if(En.isAmbientLight)S+=wi.r*zn*Ct,R+=wi.g*zn*Ct,H+=wi.b*zn*Ct;else if(En.isLightProbe){for(let vi=0;vi<9;vi++)r.probe[vi].addScaledVector(En.sh.coefficients[vi],zn);Un++}else if(En.isDirectionalLight){const vi=t.get(En);if(vi.color.copy(En.color).multiplyScalar(En.intensity*Ct),En.castShadow){const mr=En.shadow,Mr=i.get(En);Mr.shadowBias=mr.bias,Mr.shadowNormalBias=mr.normalBias,Mr.shadowRadius=mr.radius,Mr.shadowMapSize=mr.mapSize,r.directionalShadow[re]=Mr,r.directionalShadowMap[re]=hi,r.directionalShadowMatrix[re]=En.shadow.matrix,qe++}r.directional[re]=vi,re++}else if(En.isSpotLight){const vi=t.get(En);vi.position.setFromMatrixPosition(En.matrixWorld),vi.color.copy(wi).multiplyScalar(zn*Ct),vi.distance=oi,vi.coneCos=Math.cos(En.angle),vi.penumbraCos=Math.cos(En.angle*(1-En.penumbra)),vi.decay=En.decay,r.spot[ce]=vi;const mr=En.shadow;if(En.map&&(r.spotLightMap[Et]=En.map,Et++,mr.updateMatrices(En),En.castShadow&&Xt++),r.spotLightMatrix[ce]=mr.matrix,En.castShadow){const Mr=i.get(En);Mr.shadowBias=mr.bias,Mr.shadowNormalBias=mr.normalBias,Mr.shadowRadius=mr.radius,Mr.shadowMapSize=mr.mapSize,r.spotShadow[ce]=Mr,r.spotShadowMap[ce]=hi,gt++}ce++}else if(En.isRectAreaLight){const vi=t.get(En);vi.color.copy(wi).multiplyScalar(zn),vi.halfWidth.set(.5*En.width,0,0),vi.halfHeight.set(0,.5*En.height,0),r.rectArea[Te]=vi,Te++}else if(En.isPointLight){const vi=t.get(En);if(vi.color.copy(En.color).multiplyScalar(En.intensity*Ct),vi.distance=En.distance,vi.decay=En.decay,En.castShadow){const mr=En.shadow,Mr=i.get(En);Mr.shadowBias=mr.bias,Mr.shadowNormalBias=mr.normalBias,Mr.shadowRadius=mr.radius,Mr.shadowMapSize=mr.mapSize,Mr.shadowCameraNear=mr.camera.near,Mr.shadowCameraFar=mr.camera.far,r.pointShadow[se]=Mr,r.pointShadowMap[se]=hi,r.pointShadowMatrix[se]=En.shadow.matrix,wt++}r.point[se]=vi,se++}else if(En.isHemisphereLight){const vi=t.get(En);vi.skyColor.copy(En.color).multiplyScalar(zn*Ct),vi.groundColor.copy(En.groundColor).multiplyScalar(zn*Ct),r.hemi[Ce]=vi,Ce++}}Te>0&&(e.isWebGL2?!0===n.has("OES_texture_float_linear")?(r.rectAreaLTC1=Ms.LTC_FLOAT_1,r.rectAreaLTC2=Ms.LTC_FLOAT_2):(r.rectAreaLTC1=Ms.LTC_HALF_1,r.rectAreaLTC2=Ms.LTC_HALF_2):!0===n.has("OES_texture_float_linear")?(r.rectAreaLTC1=Ms.LTC_FLOAT_1,r.rectAreaLTC2=Ms.LTC_FLOAT_2):!0===n.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=Ms.LTC_HALF_1,r.rectAreaLTC2=Ms.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=S,r.ambient[1]=R,r.ambient[2]=H;const Kt=r.hash;(Kt.directionalLength!==re||Kt.pointLength!==se||Kt.spotLength!==ce||Kt.rectAreaLength!==Te||Kt.hemiLength!==Ce||Kt.numDirectionalShadows!==qe||Kt.numPointShadows!==wt||Kt.numSpotShadows!==gt||Kt.numSpotMaps!==Et||Kt.numLightProbes!==Un)&&(r.directional.length=re,r.spot.length=ce,r.rectArea.length=Te,r.point.length=se,r.hemi.length=Ce,r.directionalShadow.length=qe,r.directionalShadowMap.length=qe,r.pointShadow.length=wt,r.pointShadowMap.length=wt,r.spotShadow.length=gt,r.spotShadowMap.length=gt,r.directionalShadowMatrix.length=qe,r.pointShadowMatrix.length=wt,r.spotLightMatrix.length=gt+Et-Xt,r.spotLightMap.length=Et,r.numSpotLightShadowsWithMaps=Xt,r.numLightProbes=Un,Kt.directionalLength=re,Kt.pointLength=se,Kt.spotLength=ce,Kt.rectAreaLength=Te,Kt.hemiLength=Ce,Kt.numDirectionalShadows=qe,Kt.numPointShadows=wt,Kt.numSpotShadows=gt,Kt.numSpotMaps=Et,Kt.numLightProbes=Un,r.version=rfe++)},setupView:function u(p,_){let S=0,R=0,H=0,re=0,se=0;const ce=_.matrixWorldInverse;for(let Te=0,Ce=p.length;Te<Ce;Te++){const qe=p[Te];if(qe.isDirectionalLight){const wt=r.directional[S];wt.direction.setFromMatrixPosition(qe.matrixWorld),s.setFromMatrixPosition(qe.target.matrixWorld),wt.direction.sub(s),wt.direction.transformDirection(ce),S++}else if(qe.isSpotLight){const wt=r.spot[H];wt.position.setFromMatrixPosition(qe.matrixWorld),wt.position.applyMatrix4(ce),wt.direction.setFromMatrixPosition(qe.matrixWorld),s.setFromMatrixPosition(qe.target.matrixWorld),wt.direction.sub(s),wt.direction.transformDirection(ce),H++}else if(qe.isRectAreaLight){const wt=r.rectArea[re];wt.position.setFromMatrixPosition(qe.matrixWorld),wt.position.applyMatrix4(ce),l.identity(),a.copy(qe.matrixWorld),a.premultiply(ce),l.extractRotation(a),wt.halfWidth.set(.5*qe.width,0,0),wt.halfHeight.set(0,.5*qe.height,0),wt.halfWidth.applyMatrix4(l),wt.halfHeight.applyMatrix4(l),re++}else if(qe.isPointLight){const wt=r.point[R];wt.position.setFromMatrixPosition(qe.matrixWorld),wt.position.applyMatrix4(ce),R++}else if(qe.isHemisphereLight){const wt=r.hemi[se];wt.direction.setFromMatrixPosition(qe.matrixWorld),wt.direction.transformDirection(ce),se++}}},state:r}}function VV(n,e){const t=new ofe(n,e),i=[],r=[];return{init:function s(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:function d(_){t.setup(i,_)},setupLightsView:function u(_){t.setupView(i,_)},pushLight:function a(_){i.push(_)},pushShadow:function l(_){r.push(_)}}}function afe(n,e){let t=new WeakMap;return{get:function i(s,a=0){const l=t.get(s);let d;return void 0===l?(d=new VV(n,e),t.set(s,[d])):a>=l.length?(d=new VV(n,e),l.push(d)):d=l[a],d},dispose:function r(){t=new WeakMap}}}class P5 extends ld{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class GV extends ld{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function dfe(n,e,t){let i=new gI;const r=new Qi,s=new Qi,a=new nc,l=new P5({depthPacking:3201}),d=new GV,u={},p=t.maxTextureSize,_={0:1,1:0,2:2},S=new Iu({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Qi},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),R=S.clone();R.defines.HORIZONTAL_PASS=1;const H=new no;H.setAttribute("position",new No(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const re=new ua(H,S),se=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Yz;let ce=this.type;function Te(gt,Et){const Xt=e.update(re);S.defines.VSM_SAMPLES!==gt.blurSamples&&(S.defines.VSM_SAMPLES=gt.blurSamples,R.defines.VSM_SAMPLES=gt.blurSamples,S.needsUpdate=!0,R.needsUpdate=!0),null===gt.mapPass&&(gt.mapPass=new ju(r.x,r.y)),S.uniforms.shadow_pass.value=gt.map.texture,S.uniforms.resolution.value=gt.mapSize,S.uniforms.radius.value=gt.radius,n.setRenderTarget(gt.mapPass),n.clear(),n.renderBufferDirect(Et,null,Xt,S,re,null),R.uniforms.shadow_pass.value=gt.mapPass.texture,R.uniforms.resolution.value=gt.mapSize,R.uniforms.radius.value=gt.radius,n.setRenderTarget(gt.map),n.clear(),n.renderBufferDirect(Et,null,Xt,R,re,null)}function Ce(gt,Et,Xt,Un){let Ct=null;const Kt=!0===Xt.isPointLight?gt.customDistanceMaterial:gt.customDepthMaterial;if(void 0!==Kt)Ct=Kt;else if(Ct=!0===Xt.isPointLight?d:l,n.localClippingEnabled&&!0===Et.clipShadows&&Array.isArray(Et.clippingPlanes)&&0!==Et.clippingPlanes.length||Et.displacementMap&&0!==Et.displacementScale||Et.alphaMap&&Et.alphaTest>0||Et.map&&Et.alphaTest>0){const Gi=Ct.uuid,Yi=Et.uuid;let En=u[Gi];void 0===En&&(En={},u[Gi]=En);let wi=En[Yi];void 0===wi&&(wi=Ct.clone(),En[Yi]=wi,Et.addEventListener("dispose",wt)),Ct=wi}return Ct.visible=Et.visible,Ct.wireframe=Et.wireframe,Ct.side=Un===U_?null!==Et.shadowSide?Et.shadowSide:Et.side:null!==Et.shadowSide?Et.shadowSide:_[Et.side],Ct.alphaMap=Et.alphaMap,Ct.alphaTest=Et.alphaTest,Ct.map=Et.map,Ct.clipShadows=Et.clipShadows,Ct.clippingPlanes=Et.clippingPlanes,Ct.clipIntersection=Et.clipIntersection,Ct.displacementMap=Et.displacementMap,Ct.displacementScale=Et.displacementScale,Ct.displacementBias=Et.displacementBias,Ct.wireframeLinewidth=Et.wireframeLinewidth,Ct.linewidth=Et.linewidth,!0===Xt.isPointLight&&!0===Ct.isMeshDistanceMaterial&&(n.properties.get(Ct).light=Xt),Ct}function qe(gt,Et,Xt,Un,Ct){if(!1===gt.visible)return;if(gt.layers.test(Et.layers)&&(gt.isMesh||gt.isLine||gt.isPoints)&&(gt.castShadow||gt.receiveShadow&&Ct===U_)&&(!gt.frustumCulled||i.intersectsObject(gt))){gt.modelViewMatrix.multiplyMatrices(Xt.matrixWorldInverse,gt.matrixWorld);const Yi=e.update(gt),En=gt.material;if(Array.isArray(En)){const wi=Yi.groups;for(let zn=0,oi=wi.length;zn<oi;zn++){const hi=wi[zn],vi=En[hi.materialIndex];if(vi&&vi.visible){const mr=Ce(gt,vi,Un,Ct);gt.onBeforeShadow(n,gt,Et,Xt,Yi,mr,hi),n.renderBufferDirect(Xt,null,Yi,mr,gt,hi),gt.onAfterShadow(n,gt,Et,Xt,Yi,mr,hi)}}}else if(En.visible){const wi=Ce(gt,En,Un,Ct);gt.onBeforeShadow(n,gt,Et,Xt,Yi,wi,null),n.renderBufferDirect(Xt,null,Yi,wi,gt,null),gt.onAfterShadow(n,gt,Et,Xt,Yi,wi,null)}}const Gi=gt.children;for(let Yi=0,En=Gi.length;Yi<En;Yi++)qe(Gi[Yi],Et,Xt,Un,Ct)}function wt(gt){gt.target.removeEventListener("dispose",wt);for(const Xt in u){const Un=u[Xt],Ct=gt.target.uuid;Ct in Un&&(Un[Ct].dispose(),delete Un[Ct])}}this.render=function(gt,Et,Xt){if(!1===se.enabled||!1===se.autoUpdate&&!1===se.needsUpdate||0===gt.length)return;const Un=n.getRenderTarget(),Ct=n.getActiveCubeFace(),Kt=n.getActiveMipmapLevel(),Gi=n.state;Gi.setBlending(0),Gi.buffers.color.setClear(1,1,1,1),Gi.buffers.depth.setTest(!0),Gi.setScissorTest(!1);const Yi=ce!==U_&&this.type===U_,En=ce===U_&&this.type!==U_;for(let wi=0,zn=gt.length;wi<zn;wi++){const oi=gt[wi],hi=oi.shadow;if(void 0===hi){console.warn("THREE.WebGLShadowMap:",oi,"has no shadow.");continue}if(!1===hi.autoUpdate&&!1===hi.needsUpdate)continue;r.copy(hi.mapSize);const vi=hi.getFrameExtents();if(r.multiply(vi),s.copy(hi.mapSize),(r.x>p||r.y>p)&&(r.x>p&&(s.x=Math.floor(p/vi.x),r.x=s.x*vi.x,hi.mapSize.x=s.x),r.y>p&&(s.y=Math.floor(p/vi.y),r.y=s.y*vi.y,hi.mapSize.y=s.y)),null===hi.map||!0===Yi||!0===En){const Mr=this.type!==U_?{minFilter:vd,magFilter:vd}:{};null!==hi.map&&hi.map.dispose(),hi.map=new ju(r.x,r.y,Mr),hi.map.texture.name=oi.name+".shadowMap",hi.camera.updateProjectionMatrix()}n.setRenderTarget(hi.map),n.clear();const mr=hi.getViewportCount();for(let Mr=0;Mr<mr;Mr++){const is=hi.getViewport(Mr);a.set(s.x*is.x,s.y*is.y,s.x*is.z,s.y*is.w),Gi.viewport(a),hi.updateMatrices(oi,Mr),i=hi.getFrustum(),qe(Et,Xt,hi.camera,oi,this.type)}!0!==hi.isPointLightShadow&&this.type===U_&&Te(hi,Xt),hi.needsUpdate=!1}ce=this.type,se.needsUpdate=!1,n.setRenderTarget(Un,Ct,Kt)}}function ufe(n,e,t){const i=t.isWebGL2,l=new function r(){let Xn=!1;const rs=new nc;let ki=null;const Xr=new nc(0,0,0,0);return{setMask:function(Hs){ki!==Hs&&!Xn&&(n.colorMask(Hs,Hs,Hs,Hs),ki=Hs)},setLocked:function(Hs){Xn=Hs},setClear:function(Hs,Xa,jl,pc,Ed){!0===Ed&&(Hs*=pc,Xa*=pc,jl*=pc),rs.set(Hs,Xa,jl,pc),!1===Xr.equals(rs)&&(n.clearColor(Hs,Xa,jl,pc),Xr.copy(rs))},reset:function(){Xn=!1,ki=null,Xr.set(-1,0,0,0)}}},d=new function s(){let Xn=!1,rs=null,ki=null,Xr=null;return{setTest:function(Hs){Hs?ws(n.DEPTH_TEST):Co(n.DEPTH_TEST)},setMask:function(Hs){rs!==Hs&&!Xn&&(n.depthMask(Hs),rs=Hs)},setFunc:function(Hs){if(ki!==Hs){switch(Hs){case 0:n.depthFunc(n.NEVER);break;case 1:n.depthFunc(n.ALWAYS);break;case 2:n.depthFunc(n.LESS);break;case 3:default:n.depthFunc(n.LEQUAL);break;case 4:n.depthFunc(n.EQUAL);break;case 5:n.depthFunc(n.GEQUAL);break;case 6:n.depthFunc(n.GREATER);break;case 7:n.depthFunc(n.NOTEQUAL)}ki=Hs}},setLocked:function(Hs){Xn=Hs},setClear:function(Hs){Xr!==Hs&&(n.clearDepth(Hs),Xr=Hs)},reset:function(){Xn=!1,rs=null,ki=null,Xr=null}}},u=new function a(){let Xn=!1,rs=null,ki=null,Xr=null,Hs=null,Xa=null,jl=null,pc=null,Ed=null;return{setTest:function(Ml){Xn||(Ml?ws(n.STENCIL_TEST):Co(n.STENCIL_TEST))},setMask:function(Ml){rs!==Ml&&!Xn&&(n.stencilMask(Ml),rs=Ml)},setFunc:function(Ml,Qc,Qh){(ki!==Ml||Xr!==Qc||Hs!==Qh)&&(n.stencilFunc(Ml,Qc,Qh),ki=Ml,Xr=Qc,Hs=Qh)},setOp:function(Ml,Qc,Qh){(Xa!==Ml||jl!==Qc||pc!==Qh)&&(n.stencilOp(Ml,Qc,Qh),Xa=Ml,jl=Qc,pc=Qh)},setLocked:function(Ml){Xn=Ml},setClear:function(Ml){Ed!==Ml&&(n.clearStencil(Ml),Ed=Ml)},reset:function(){Xn=!1,rs=null,ki=null,Xr=null,Hs=null,Xa=null,jl=null,pc=null,Ed=null}}},p=new WeakMap,_=new WeakMap;let S={},R={},H=new WeakMap,re=[],se=null,ce=!1,Te=null,Ce=null,qe=null,wt=null,gt=null,Et=null,Xt=null,Un=new Cr(0,0,0),Ct=0,Kt=!1,Gi=null,Yi=null,En=null,wi=null,zn=null;const oi=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let hi=!1,vi=0;const mr=n.getParameter(n.VERSION);-1!==mr.indexOf("WebGL")?(vi=parseFloat(/^WebGL (\d)/.exec(mr)[1]),hi=vi>=1):-1!==mr.indexOf("OpenGL ES")&&(vi=parseFloat(/^OpenGL ES (\d)/.exec(mr)[1]),hi=vi>=2);let Mr=null,is={};const $s=n.getParameter(n.SCISSOR_BOX),fi=n.getParameter(n.VIEWPORT),Rr=(new nc).fromArray($s),ms=(new nc).fromArray(fi);function Fs(Xn,rs,ki,Xr){const Hs=new Uint8Array(4),Xa=n.createTexture();n.bindTexture(Xn,Xa),n.texParameteri(Xn,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(Xn,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let jl=0;jl<ki;jl++)!i||Xn!==n.TEXTURE_3D&&Xn!==n.TEXTURE_2D_ARRAY?n.texImage2D(rs+jl,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,Hs):n.texImage3D(rs,0,n.RGBA,1,1,Xr,0,n.RGBA,n.UNSIGNED_BYTE,Hs);return Xa}const Us={};function ws(Xn){!0!==S[Xn]&&(n.enable(Xn),S[Xn]=!0)}function Co(Xn){!1!==S[Xn]&&(n.disable(Xn),S[Xn]=!1)}Us[n.TEXTURE_2D]=Fs(n.TEXTURE_2D,n.TEXTURE_2D,1),Us[n.TEXTURE_CUBE_MAP]=Fs(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(Us[n.TEXTURE_2D_ARRAY]=Fs(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Us[n.TEXTURE_3D]=Fs(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),l.setClear(0,0,0,1),d.setClear(1),u.setClear(0),ws(n.DEPTH_TEST),d.setFunc(3),qs(!1),uo(1),ws(n.CULL_FACE),Tr(0);const gr={100:n.FUNC_ADD,101:n.FUNC_SUBTRACT,102:n.FUNC_REVERSE_SUBTRACT};if(i)gr[103]=n.MIN,gr[104]=n.MAX;else{const Xn=e.get("EXT_blend_minmax");null!==Xn&&(gr[103]=Xn.MIN_EXT,gr[104]=Xn.MAX_EXT)}const ls={200:n.ZERO,201:n.ONE,202:n.SRC_COLOR,204:n.SRC_ALPHA,210:n.SRC_ALPHA_SATURATE,208:n.DST_COLOR,206:n.DST_ALPHA,203:n.ONE_MINUS_SRC_COLOR,205:n.ONE_MINUS_SRC_ALPHA,209:n.ONE_MINUS_DST_COLOR,207:n.ONE_MINUS_DST_ALPHA,211:n.CONSTANT_COLOR,212:n.ONE_MINUS_CONSTANT_COLOR,213:n.CONSTANT_ALPHA,214:n.ONE_MINUS_CONSTANT_ALPHA};function Tr(Xn,rs,ki,Xr,Hs,Xa,jl,pc,Ed,Ml){if(0!==Xn){if(!1===ce&&(ws(n.BLEND),ce=!0),5===Xn)Hs=Hs||rs,Xa=Xa||ki,jl=jl||Xr,(rs!==Ce||Hs!==gt)&&(n.blendEquationSeparate(gr[rs],gr[Hs]),Ce=rs,gt=Hs),(ki!==qe||Xr!==wt||Xa!==Et||jl!==Xt)&&(n.blendFuncSeparate(ls[ki],ls[Xr],ls[Xa],ls[jl]),qe=ki,wt=Xr,Et=Xa,Xt=jl),(!1===pc.equals(Un)||Ed!==Ct)&&(n.blendColor(pc.r,pc.g,pc.b,Ed),Un.copy(pc),Ct=Ed),Te=Xn,Kt=!1;else if(Xn!==Te||Ml!==Kt){if((100!==Ce||100!==gt)&&(n.blendEquation(n.FUNC_ADD),Ce=100,gt=100),Ml)switch(Xn){case 1:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.ONE,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Xn)}else switch(Xn){case 1:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Xn)}qe=null,wt=null,Et=null,Xt=null,Un.set(0,0,0),Ct=0,Te=Xn,Kt=Ml}}else!0===ce&&(Co(n.BLEND),ce=!1)}function qs(Xn){Gi!==Xn&&(n.frontFace(Xn?n.CW:n.CCW),Gi=Xn)}function uo(Xn){0!==Xn?(ws(n.CULL_FACE),Xn!==Yi&&n.cullFace(1===Xn?n.BACK:2===Xn?n.FRONT:n.FRONT_AND_BACK)):Co(n.CULL_FACE),Yi=Xn}function gn(Xn,rs,ki){Xn?(ws(n.POLYGON_OFFSET_FILL),(wi!==rs||zn!==ki)&&(n.polygonOffset(rs,ki),wi=rs,zn=ki)):Co(n.POLYGON_OFFSET_FILL)}return{buffers:{color:l,depth:d,stencil:u},enable:ws,disable:Co,bindFramebuffer:function lo(Xn,rs){return R[Xn]!==rs&&(n.bindFramebuffer(Xn,rs),R[Xn]=rs,i&&(Xn===n.DRAW_FRAMEBUFFER&&(R[n.FRAMEBUFFER]=rs),Xn===n.FRAMEBUFFER&&(R[n.DRAW_FRAMEBUFFER]=rs)),!0)},drawBuffers:function On(Xn,rs){let ki=re,Xr=!1;if(Xn){ki=H.get(rs),void 0===ki&&(ki=[],H.set(rs,ki));const Hs=Xn.textures;if(ki.length!==Hs.length||ki[0]!==n.COLOR_ATTACHMENT0){for(let Xa=0,jl=Hs.length;Xa<jl;Xa++)ki[Xa]=n.COLOR_ATTACHMENT0+Xa;ki.length=Hs.length,Xr=!0}}else ki[0]!==n.BACK&&(ki[0]=n.BACK,Xr=!0);if(Xr)if(t.isWebGL2)n.drawBuffers(ki);else{if(!0!==e.has("WEBGL_draw_buffers"))throw new Error("THREE.WebGLState: Usage of gl.drawBuffers() require WebGL2 or WEBGL_draw_buffers extension");e.get("WEBGL_draw_buffers").drawBuffersWEBGL(ki)}},useProgram:function ps(Xn){return se!==Xn&&(n.useProgram(Xn),se=Xn,!0)},setBlending:Tr,setMaterial:function Ys(Xn,rs){2===Xn.side?Co(n.CULL_FACE):ws(n.CULL_FACE);let ki=1===Xn.side;rs&&(ki=!ki),qs(ki),1===Xn.blending&&!1===Xn.transparent?Tr(0):Tr(Xn.blending,Xn.blendEquation,Xn.blendSrc,Xn.blendDst,Xn.blendEquationAlpha,Xn.blendSrcAlpha,Xn.blendDstAlpha,Xn.blendColor,Xn.blendAlpha,Xn.premultipliedAlpha),d.setFunc(Xn.depthFunc),d.setTest(Xn.depthTest),d.setMask(Xn.depthWrite),l.setMask(Xn.colorWrite);const Xr=Xn.stencilWrite;u.setTest(Xr),Xr&&(u.setMask(Xn.stencilWriteMask),u.setFunc(Xn.stencilFunc,Xn.stencilRef,Xn.stencilFuncMask),u.setOp(Xn.stencilFail,Xn.stencilZFail,Xn.stencilZPass)),gn(Xn.polygonOffset,Xn.polygonOffsetFactor,Xn.polygonOffsetUnits),!0===Xn.alphaToCoverage?ws(n.SAMPLE_ALPHA_TO_COVERAGE):Co(n.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:qs,setCullFace:uo,setLineWidth:function ka(Xn){Xn!==En&&(hi&&n.lineWidth(Xn),En=Xn)},setPolygonOffset:gn,setScissorTest:function Ht(Xn){Xn?ws(n.SCISSOR_TEST):Co(n.SCISSOR_TEST)},activeTexture:function ar(Xn){void 0===Xn&&(Xn=n.TEXTURE0+oi-1),Mr!==Xn&&(n.activeTexture(Xn),Mr=Xn)},bindTexture:function hr(Xn,rs,ki){void 0===ki&&(ki=null===Mr?n.TEXTURE0+oi-1:Mr);let Xr=is[ki];void 0===Xr&&(Xr={type:void 0,texture:void 0},is[ki]=Xr),(Xr.type!==Xn||Xr.texture!==rs)&&(Mr!==ki&&(n.activeTexture(ki),Mr=ki),n.bindTexture(Xn,rs||Us[Xn]),Xr.type=Xn,Xr.texture=rs)},unbindTexture:function $r(){const Xn=is[Mr];void 0!==Xn&&void 0!==Xn.type&&(n.bindTexture(Xn.type,null),Xn.type=void 0,Xn.texture=void 0)},compressedTexImage2D:function Or(){try{n.compressedTexImage2D.apply(n,arguments)}catch(Xn){console.error("THREE.WebGLState:",Xn)}},compressedTexImage3D:function Aa(){try{n.compressedTexImage3D.apply(n,arguments)}catch(Xn){console.error("THREE.WebGLState:",Xn)}},texImage2D:function qa(){try{n.texImage2D.apply(n,arguments)}catch(Xn){console.error("THREE.WebGLState:",Xn)}},texImage3D:function Ro(){try{n.texImage3D.apply(n,arguments)}catch(Xn){console.error("THREE.WebGLState:",Xn)}},updateUBOMapping:function Tn(Xn,rs){let ki=_.get(rs);void 0===ki&&(ki=new WeakMap,_.set(rs,ki));let Xr=ki.get(Xn);void 0===Xr&&(Xr=n.getUniformBlockIndex(rs,Xn.name),ki.set(Xn,Xr))},uniformBlockBinding:function Er(Xn,rs){const Xr=_.get(rs).get(Xn);p.get(rs)!==Xr&&(n.uniformBlockBinding(rs,Xr,Xn.__bindingPointIndex),p.set(rs,Xr))},texStorage2D:function hs(){try{n.texStorage2D.apply(n,arguments)}catch(Xn){console.error("THREE.WebGLState:",Xn)}},texStorage3D:function Sd(){try{n.texStorage3D.apply(n,arguments)}catch(Xn){console.error("THREE.WebGLState:",Xn)}},texSubImage2D:function Qo(){try{n.texSubImage2D.apply(n,arguments)}catch(Xn){console.error("THREE.WebGLState:",Xn)}},texSubImage3D:function As(){try{n.texSubImage3D.apply(n,arguments)}catch(Xn){console.error("THREE.WebGLState:",Xn)}},compressedTexSubImage2D:function Is(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(Xn){console.error("THREE.WebGLState:",Xn)}},compressedTexSubImage3D:function ga(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(Xn){console.error("THREE.WebGLState:",Xn)}},scissor:function ho(Xn){!1===Rr.equals(Xn)&&(n.scissor(Xn.x,Xn.y,Xn.z,Xn.w),Rr.copy(Xn))},viewport:function To(Xn){!1===ms.equals(Xn)&&(n.viewport(Xn.x,Xn.y,Xn.z,Xn.w),ms.copy(Xn))},reset:function mo(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),!0===i&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),S={},Mr=null,is={},R={},H=new WeakMap,re=[],se=null,ce=!1,Te=null,Ce=null,qe=null,wt=null,gt=null,Et=null,Xt=null,Un=new Cr(0,0,0),Ct=0,Kt=!1,Gi=null,Yi=null,En=null,wi=null,zn=null,Rr.set(0,0,n.canvas.width,n.canvas.height),ms.set(0,0,n.canvas.width,n.canvas.height),l.reset(),d.reset(),u.reset()}}}function hfe(n,e,t,i,r,s,a){const l=r.isWebGL2,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,u=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),p=new Qi,_=new WeakMap;let S;const R=new WeakMap;let H=!1;try{H=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function re(gn,Ht){return H?new OffscreenCanvas(gn,Ht):qS("canvas")}function se(gn,Ht,ar,hr){let $r=1;const Or=ka(gn);if((Or.width>hr||Or.height>hr)&&($r=hr/Math.max(Or.width,Or.height)),$r<1||!0===Ht){if(typeof HTMLImageElement<"u"&&gn instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&gn instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&gn instanceof ImageBitmap||typeof VideoFrame<"u"&&gn instanceof VideoFrame){const Aa=Ht?YD:Math.floor,Qo=Aa($r*Or.width),As=Aa($r*Or.height);void 0===S&&(S=re(Qo,As));const Is=ar?re(Qo,As):S;return Is.width=Qo,Is.height=As,Is.getContext("2d").drawImage(gn,0,0,Qo,As),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Or.width+"x"+Or.height+") to ("+Qo+"x"+As+")."),Is}return"data"in gn&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Or.width+"x"+Or.height+")."),gn}return gn}function ce(gn){const Ht=ka(gn);return e5(Ht.width)&&e5(Ht.height)}function Ce(gn,Ht){return gn.generateMipmaps&&Ht&&gn.minFilter!==vd&&gn.minFilter!==Hc}function qe(gn){n.generateMipmap(gn)}function wt(gn,Ht,ar,hr,$r=!1){if(!1===l)return Ht;if(null!==gn){if(void 0!==n[gn])return n[gn];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+gn+"'")}let Or=Ht;if(Ht===n.RED&&(ar===n.FLOAT&&(Or=n.R32F),ar===n.HALF_FLOAT&&(Or=n.R16F),ar===n.UNSIGNED_BYTE&&(Or=n.R8)),Ht===n.RED_INTEGER&&(ar===n.UNSIGNED_BYTE&&(Or=n.R8UI),ar===n.UNSIGNED_SHORT&&(Or=n.R16UI),ar===n.UNSIGNED_INT&&(Or=n.R32UI),ar===n.BYTE&&(Or=n.R8I),ar===n.SHORT&&(Or=n.R16I),ar===n.INT&&(Or=n.R32I)),Ht===n.RG&&(ar===n.FLOAT&&(Or=n.RG32F),ar===n.HALF_FLOAT&&(Or=n.RG16F),ar===n.UNSIGNED_BYTE&&(Or=n.RG8)),Ht===n.RG_INTEGER&&(ar===n.UNSIGNED_BYTE&&(Or=n.RG8UI),ar===n.UNSIGNED_SHORT&&(Or=n.RG16UI),ar===n.UNSIGNED_INT&&(Or=n.RG32UI),ar===n.BYTE&&(Or=n.RG8I),ar===n.SHORT&&(Or=n.RG16I),ar===n.INT&&(Or=n.RG32I)),Ht===n.RGBA){const Aa=$r?QD:Ol.getTransfer(hr);ar===n.FLOAT&&(Or=n.RGBA32F),ar===n.HALF_FLOAT&&(Or=n.RGBA16F),ar===n.UNSIGNED_BYTE&&(Or=Aa===Vc?n.SRGB8_ALPHA8:n.RGBA8),ar===n.UNSIGNED_SHORT_4_4_4_4&&(Or=n.RGBA4),ar===n.UNSIGNED_SHORT_5_5_5_1&&(Or=n.RGB5_A1)}return(Or===n.R16F||Or===n.R32F||Or===n.RG16F||Or===n.RG32F||Or===n.RGBA16F||Or===n.RGBA32F)&&e.get("EXT_color_buffer_float"),Or}function gt(gn,Ht,ar){return!0===Ce(gn,ar)||gn.isFramebufferTexture&&gn.minFilter!==vd&&gn.minFilter!==Hc?Math.log2(Math.max(Ht.width,Ht.height))+1:void 0!==gn.mipmaps&&gn.mipmaps.length>0?gn.mipmaps.length:gn.isCompressedTexture&&Array.isArray(gn.image)?Ht.mipmaps.length:1}function Et(gn){return gn===vd||1004===gn||gn===Ry?n.NEAREST:n.LINEAR}function Xt(gn){const Ht=gn.target;Ht.removeEventListener("dispose",Xt),function Ct(gn){const Ht=i.get(gn);if(void 0===Ht.__webglInit)return;const ar=gn.source,hr=R.get(ar);if(hr){const $r=hr[Ht.__cacheKey];$r.usedTimes--,0===$r.usedTimes&&Kt(gn),0===Object.keys(hr).length&&R.delete(ar)}i.remove(gn)}(Ht),Ht.isVideoTexture&&_.delete(Ht)}function Un(gn){const Ht=gn.target;Ht.removeEventListener("dispose",Un),function Gi(gn){const Ht=i.get(gn);if(gn.depthTexture&&gn.depthTexture.dispose(),gn.isWebGLCubeRenderTarget)for(let hr=0;hr<6;hr++){if(Array.isArray(Ht.__webglFramebuffer[hr]))for(let $r=0;$r<Ht.__webglFramebuffer[hr].length;$r++)n.deleteFramebuffer(Ht.__webglFramebuffer[hr][$r]);else n.deleteFramebuffer(Ht.__webglFramebuffer[hr]);Ht.__webglDepthbuffer&&n.deleteRenderbuffer(Ht.__webglDepthbuffer[hr])}else{if(Array.isArray(Ht.__webglFramebuffer))for(let hr=0;hr<Ht.__webglFramebuffer.length;hr++)n.deleteFramebuffer(Ht.__webglFramebuffer[hr]);else n.deleteFramebuffer(Ht.__webglFramebuffer);if(Ht.__webglDepthbuffer&&n.deleteRenderbuffer(Ht.__webglDepthbuffer),Ht.__webglMultisampledFramebuffer&&n.deleteFramebuffer(Ht.__webglMultisampledFramebuffer),Ht.__webglColorRenderbuffer)for(let hr=0;hr<Ht.__webglColorRenderbuffer.length;hr++)Ht.__webglColorRenderbuffer[hr]&&n.deleteRenderbuffer(Ht.__webglColorRenderbuffer[hr]);Ht.__webglDepthRenderbuffer&&n.deleteRenderbuffer(Ht.__webglDepthRenderbuffer)}const ar=gn.textures;for(let hr=0,$r=ar.length;hr<$r;hr++){const Or=i.get(ar[hr]);Or.__webglTexture&&(n.deleteTexture(Or.__webglTexture),a.memory.textures--),i.remove(ar[hr])}i.remove(gn)}(Ht)}function Kt(gn){const Ht=i.get(gn);n.deleteTexture(Ht.__webglTexture),delete R.get(gn.source)[Ht.__cacheKey],a.memory.textures--}let Yi=0;function oi(gn,Ht){const ar=i.get(gn);if(gn.isVideoTexture&&function qs(gn){const Ht=a.render.frame;_.get(gn)!==Ht&&(_.set(gn,Ht),gn.update())}(gn),!1===gn.isRenderTargetTexture&&gn.version>0&&ar.__version!==gn.version){const hr=gn.image;if(null===hr)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==hr.complete)return void ms(ar,gn,Ht);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(n.TEXTURE_2D,ar.__webglTexture,n.TEXTURE0+Ht)}const Mr={[Py]:n.REPEAT,[bh]:n.CLAMP_TO_EDGE,[_2]:n.MIRRORED_REPEAT},is={[vd]:n.NEAREST,1004:n.NEAREST_MIPMAP_NEAREST,[Ry]:n.NEAREST_MIPMAP_LINEAR,[Hc]:n.LINEAR,[y2]:n.LINEAR_MIPMAP_NEAREST,[oA]:n.LINEAR_MIPMAP_LINEAR},$s={512:n.NEVER,519:n.ALWAYS,513:n.LESS,515:n.LEQUAL,514:n.EQUAL,518:n.GEQUAL,516:n.GREATER,517:n.NOTEQUAL};function fi(gn,Ht,ar){if(Ht.type===aA&&!1===e.has("OES_texture_float_linear")&&(Ht.magFilter===Hc||Ht.magFilter===y2||Ht.magFilter===Ry||Ht.magFilter===oA||Ht.minFilter===Hc||Ht.minFilter===y2||Ht.minFilter===Ry||Ht.minFilter===oA)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),ar?(n.texParameteri(gn,n.TEXTURE_WRAP_S,Mr[Ht.wrapS]),n.texParameteri(gn,n.TEXTURE_WRAP_T,Mr[Ht.wrapT]),(gn===n.TEXTURE_3D||gn===n.TEXTURE_2D_ARRAY)&&n.texParameteri(gn,n.TEXTURE_WRAP_R,Mr[Ht.wrapR]),n.texParameteri(gn,n.TEXTURE_MAG_FILTER,is[Ht.magFilter]),n.texParameteri(gn,n.TEXTURE_MIN_FILTER,is[Ht.minFilter])):(n.texParameteri(gn,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(gn,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(gn===n.TEXTURE_3D||gn===n.TEXTURE_2D_ARRAY)&&n.texParameteri(gn,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(Ht.wrapS!==bh||Ht.wrapT!==bh)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(gn,n.TEXTURE_MAG_FILTER,Et(Ht.magFilter)),n.texParameteri(gn,n.TEXTURE_MIN_FILTER,Et(Ht.minFilter)),Ht.minFilter!==vd&&Ht.minFilter!==Hc&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),Ht.compareFunction&&(n.texParameteri(gn,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(gn,n.TEXTURE_COMPARE_FUNC,$s[Ht.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){if(Ht.magFilter===vd||Ht.minFilter!==Ry&&Ht.minFilter!==oA||Ht.type===aA&&!1===e.has("OES_texture_float_linear")||!1===l&&Ht.type===lA&&!1===e.has("OES_texture_half_float_linear"))return;if(Ht.anisotropy>1||i.get(Ht).__currentAnisotropy){const hr=e.get("EXT_texture_filter_anisotropic");n.texParameterf(gn,hr.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Ht.anisotropy,r.getMaxAnisotropy())),i.get(Ht).__currentAnisotropy=Ht.anisotropy}}}function Rr(gn,Ht){let ar=!1;void 0===gn.__webglInit&&(gn.__webglInit=!0,Ht.addEventListener("dispose",Xt));const hr=Ht.source;let $r=R.get(hr);void 0===$r&&($r={},R.set(hr,$r));const Or=function zn(gn){const Ht=[];return Ht.push(gn.wrapS),Ht.push(gn.wrapT),Ht.push(gn.wrapR||0),Ht.push(gn.magFilter),Ht.push(gn.minFilter),Ht.push(gn.anisotropy),Ht.push(gn.internalFormat),Ht.push(gn.format),Ht.push(gn.type),Ht.push(gn.generateMipmaps),Ht.push(gn.premultiplyAlpha),Ht.push(gn.flipY),Ht.push(gn.unpackAlignment),Ht.push(gn.colorSpace),Ht.join()}(Ht);if(Or!==gn.__cacheKey){void 0===$r[Or]&&($r[Or]={texture:n.createTexture(),usedTimes:0},a.memory.textures++,ar=!0),$r[Or].usedTimes++;const Aa=$r[gn.__cacheKey];void 0!==Aa&&($r[gn.__cacheKey].usedTimes--,0===Aa.usedTimes&&Kt(Ht)),gn.__cacheKey=Or,gn.__webglTexture=$r[Or].texture}return ar}function ms(gn,Ht,ar){let hr=n.TEXTURE_2D;(Ht.isDataArrayTexture||Ht.isCompressedArrayTexture)&&(hr=n.TEXTURE_2D_ARRAY),Ht.isData3DTexture&&(hr=n.TEXTURE_3D);const $r=Rr(gn,Ht),Or=Ht.source;t.bindTexture(hr,gn.__webglTexture,n.TEXTURE0+ar);const Aa=i.get(Or);if(Or.version!==Aa.__version||!0===$r){t.activeTexture(n.TEXTURE0+ar);const Qo=Ol.getPrimaries(Ol.workingColorSpace),As=""===Ht.colorSpace?null:Ol.getPrimaries(Ht.colorSpace),Is=""===Ht.colorSpace||Qo===As?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,Ht.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ht.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,Ht.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Is);const ga=function Te(gn){return!l&&(gn.wrapS!==bh||gn.wrapT!==bh||gn.minFilter!==vd&&gn.minFilter!==Hc)}(Ht)&&!1===ce(Ht.image);let hs=se(Ht.image,ga,!1,r.maxTextureSize);hs=uo(Ht,hs);const Sd=ce(hs)||l,qa=s.convert(Ht.format,Ht.colorSpace);let To,Ro=s.convert(Ht.type),ho=wt(Ht.internalFormat,qa,Ro,Ht.colorSpace,Ht.isVideoTexture);fi(hr,Ht,Sd);const Tn=Ht.mipmaps,Er=l&&!0!==Ht.isVideoTexture&&36196!==ho,mo=void 0===Aa.__version||!0===$r,Xn=Or.dataReady,rs=gt(Ht,hs,Sd);if(Ht.isDepthTexture)ho=n.DEPTH_COMPONENT,l?ho=Ht.type===aA?n.DEPTH_COMPONENT32F:Ht.type===Fy?n.DEPTH_COMPONENT24:Ht.type===Db?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT16:Ht.type===aA&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Ht.format===Ib&&ho===n.DEPTH_COMPONENT&&1012!==Ht.type&&Ht.type!==Fy&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Ht.type=Fy,Ro=s.convert(Ht.type)),Ht.format===v2&&ho===n.DEPTH_COMPONENT&&(ho=n.DEPTH_STENCIL,Ht.type!==Db&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Ht.type=Db,Ro=s.convert(Ht.type))),mo&&(Er?t.texStorage2D(n.TEXTURE_2D,1,ho,hs.width,hs.height):t.texImage2D(n.TEXTURE_2D,0,ho,hs.width,hs.height,0,qa,Ro,null));else if(Ht.isDataTexture)if(Tn.length>0&&Sd){Er&&mo&&t.texStorage2D(n.TEXTURE_2D,rs,ho,Tn[0].width,Tn[0].height);for(let ki=0,Xr=Tn.length;ki<Xr;ki++)To=Tn[ki],Er?Xn&&t.texSubImage2D(n.TEXTURE_2D,ki,0,0,To.width,To.height,qa,Ro,To.data):t.texImage2D(n.TEXTURE_2D,ki,ho,To.width,To.height,0,qa,Ro,To.data);Ht.generateMipmaps=!1}else Er?(mo&&t.texStorage2D(n.TEXTURE_2D,rs,ho,hs.width,hs.height),Xn&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,hs.width,hs.height,qa,Ro,hs.data)):t.texImage2D(n.TEXTURE_2D,0,ho,hs.width,hs.height,0,qa,Ro,hs.data);else if(Ht.isCompressedTexture)if(Ht.isCompressedArrayTexture){Er&&mo&&t.texStorage3D(n.TEXTURE_2D_ARRAY,rs,ho,Tn[0].width,Tn[0].height,hs.depth);for(let ki=0,Xr=Tn.length;ki<Xr;ki++)To=Tn[ki],Ht.format!==gp?null!==qa?Er?Xn&&t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,ki,0,0,0,To.width,To.height,hs.depth,qa,To.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,ki,ho,To.width,To.height,hs.depth,0,To.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Er?Xn&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,ki,0,0,0,To.width,To.height,hs.depth,qa,Ro,To.data):t.texImage3D(n.TEXTURE_2D_ARRAY,ki,ho,To.width,To.height,hs.depth,0,qa,Ro,To.data)}else{Er&&mo&&t.texStorage2D(n.TEXTURE_2D,rs,ho,Tn[0].width,Tn[0].height);for(let ki=0,Xr=Tn.length;ki<Xr;ki++)To=Tn[ki],Ht.format!==gp?null!==qa?Er?Xn&&t.compressedTexSubImage2D(n.TEXTURE_2D,ki,0,0,To.width,To.height,qa,To.data):t.compressedTexImage2D(n.TEXTURE_2D,ki,ho,To.width,To.height,0,To.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Er?Xn&&t.texSubImage2D(n.TEXTURE_2D,ki,0,0,To.width,To.height,qa,Ro,To.data):t.texImage2D(n.TEXTURE_2D,ki,ho,To.width,To.height,0,qa,Ro,To.data)}else if(Ht.isDataArrayTexture)Er?(mo&&t.texStorage3D(n.TEXTURE_2D_ARRAY,rs,ho,hs.width,hs.height,hs.depth),Xn&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,hs.width,hs.height,hs.depth,qa,Ro,hs.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,ho,hs.width,hs.height,hs.depth,0,qa,Ro,hs.data);else if(Ht.isData3DTexture)Er?(mo&&t.texStorage3D(n.TEXTURE_3D,rs,ho,hs.width,hs.height,hs.depth),Xn&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,hs.width,hs.height,hs.depth,qa,Ro,hs.data)):t.texImage3D(n.TEXTURE_3D,0,ho,hs.width,hs.height,hs.depth,0,qa,Ro,hs.data);else if(Ht.isFramebufferTexture){if(mo)if(Er)t.texStorage2D(n.TEXTURE_2D,rs,ho,hs.width,hs.height);else{let ki=hs.width,Xr=hs.height;for(let Hs=0;Hs<rs;Hs++)t.texImage2D(n.TEXTURE_2D,Hs,ho,ki,Xr,0,qa,Ro,null),ki>>=1,Xr>>=1}}else if(Tn.length>0&&Sd){if(Er&&mo){const ki=ka(Tn[0]);t.texStorage2D(n.TEXTURE_2D,rs,ho,ki.width,ki.height)}for(let ki=0,Xr=Tn.length;ki<Xr;ki++)To=Tn[ki],Er?Xn&&t.texSubImage2D(n.TEXTURE_2D,ki,0,0,qa,Ro,To):t.texImage2D(n.TEXTURE_2D,ki,ho,qa,Ro,To);Ht.generateMipmaps=!1}else if(Er){if(mo){const ki=ka(hs);t.texStorage2D(n.TEXTURE_2D,rs,ho,ki.width,ki.height)}Xn&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,qa,Ro,hs)}else t.texImage2D(n.TEXTURE_2D,0,ho,qa,Ro,hs);Ce(Ht,Sd)&&qe(hr),Aa.__version=Or.version,Ht.onUpdate&&Ht.onUpdate(Ht)}gn.__version=Ht.version}function Us(gn,Ht,ar,hr,$r,Or){const Aa=s.convert(ar.format,ar.colorSpace),Qo=s.convert(ar.type),As=wt(ar.internalFormat,Aa,Qo,ar.colorSpace);if(!i.get(Ht).__hasExternalTextures){const ga=Math.max(1,Ht.width>>Or),hs=Math.max(1,Ht.height>>Or);$r===n.TEXTURE_3D||$r===n.TEXTURE_2D_ARRAY?t.texImage3D($r,Or,As,ga,hs,Ht.depth,0,Aa,Qo,null):t.texImage2D($r,Or,As,ga,hs,0,Aa,Qo,null)}t.bindFramebuffer(n.FRAMEBUFFER,gn),Ys(Ht)?d.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,hr,$r,i.get(ar).__webglTexture,0,Tr(Ht)):($r===n.TEXTURE_2D||$r>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&$r<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,hr,$r,i.get(ar).__webglTexture,Or),t.bindFramebuffer(n.FRAMEBUFFER,null)}function ws(gn,Ht,ar){if(n.bindRenderbuffer(n.RENDERBUFFER,gn),Ht.depthBuffer&&!Ht.stencilBuffer){let hr=!0===l?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(ar||Ys(Ht)){const $r=Ht.depthTexture;$r&&$r.isDepthTexture&&($r.type===aA?hr=n.DEPTH_COMPONENT32F:$r.type===Fy&&(hr=n.DEPTH_COMPONENT24));const Or=Tr(Ht);Ys(Ht)?d.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Or,hr,Ht.width,Ht.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,Or,hr,Ht.width,Ht.height)}else n.renderbufferStorage(n.RENDERBUFFER,hr,Ht.width,Ht.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,gn)}else if(Ht.depthBuffer&&Ht.stencilBuffer){const hr=Tr(Ht);ar&&!1===Ys(Ht)?n.renderbufferStorageMultisample(n.RENDERBUFFER,hr,n.DEPTH24_STENCIL8,Ht.width,Ht.height):Ys(Ht)?d.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,hr,n.DEPTH24_STENCIL8,Ht.width,Ht.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,Ht.width,Ht.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,gn)}else{const hr=Ht.textures;for(let $r=0;$r<hr.length;$r++){const Or=hr[$r],Aa=s.convert(Or.format,Or.colorSpace),Qo=s.convert(Or.type),As=wt(Or.internalFormat,Aa,Qo,Or.colorSpace),Is=Tr(Ht);ar&&!1===Ys(Ht)?n.renderbufferStorageMultisample(n.RENDERBUFFER,Is,As,Ht.width,Ht.height):Ys(Ht)?d.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Is,As,Ht.width,Ht.height):n.renderbufferStorage(n.RENDERBUFFER,As,Ht.width,Ht.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function lo(gn){const Ht=i.get(gn),ar=!0===gn.isWebGLCubeRenderTarget;if(gn.depthTexture&&!Ht.__autoAllocateDepthBuffer){if(ar)throw new Error("target.depthTexture not supported in Cube render targets");!function Co(gn,Ht){if(Ht&&Ht.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,gn),!Ht.depthTexture||!Ht.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(Ht.depthTexture).__webglTexture||Ht.depthTexture.image.width!==Ht.width||Ht.depthTexture.image.height!==Ht.height)&&(Ht.depthTexture.image.width=Ht.width,Ht.depthTexture.image.height=Ht.height,Ht.depthTexture.needsUpdate=!0),oi(Ht.depthTexture,0);const hr=i.get(Ht.depthTexture).__webglTexture,$r=Tr(Ht);if(Ht.depthTexture.format===Ib)Ys(Ht)?d.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,hr,0,$r):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,hr,0);else{if(Ht.depthTexture.format!==v2)throw new Error("Unknown depthTexture format");Ys(Ht)?d.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,hr,0,$r):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,hr,0)}}(Ht.__webglFramebuffer,gn)}else if(ar){Ht.__webglDepthbuffer=[];for(let hr=0;hr<6;hr++)t.bindFramebuffer(n.FRAMEBUFFER,Ht.__webglFramebuffer[hr]),Ht.__webglDepthbuffer[hr]=n.createRenderbuffer(),ws(Ht.__webglDepthbuffer[hr],gn,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,Ht.__webglFramebuffer),Ht.__webglDepthbuffer=n.createRenderbuffer(),ws(Ht.__webglDepthbuffer,gn,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function Tr(gn){return Math.min(r.maxSamples,gn.samples)}function Ys(gn){const Ht=i.get(gn);return l&&gn.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==Ht.__useRenderToTexture}function uo(gn,Ht){const ar=gn.colorSpace,hr=gn.format,$r=gn.type;return!0===gn.isCompressedTexture||!0===gn.isVideoTexture||1035===gn.format||ar!==Wu&&""!==ar&&(Ol.getTransfer(ar)===Vc?!1===l?!0===e.has("EXT_sRGB")&&hr===gp?(gn.format=1035,gn.minFilter=Hc,gn.generateMipmaps=!1):Ht=jH.sRGBToLinear(Ht):(hr!==gp||$r!==ky)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",ar)),Ht}function ka(gn){return typeof HTMLImageElement<"u"&&gn instanceof HTMLImageElement?(p.width=gn.naturalWidth||gn.width,p.height=gn.naturalHeight||gn.height):typeof VideoFrame<"u"&&gn instanceof VideoFrame?(p.width=gn.displayWidth,p.height=gn.displayHeight):(p.width=gn.width,p.height=gn.height),p}this.allocateTextureUnit=function wi(){const gn=Yi;return gn>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+gn+" texture units while this GPU supports only "+r.maxTextures),Yi+=1,gn},this.resetTextureUnits=function En(){Yi=0},this.setTexture2D=oi,this.setTexture2DArray=function hi(gn,Ht){const ar=i.get(gn);gn.version>0&&ar.__version!==gn.version?ms(ar,gn,Ht):t.bindTexture(n.TEXTURE_2D_ARRAY,ar.__webglTexture,n.TEXTURE0+Ht)},this.setTexture3D=function vi(gn,Ht){const ar=i.get(gn);gn.version>0&&ar.__version!==gn.version?ms(ar,gn,Ht):t.bindTexture(n.TEXTURE_3D,ar.__webglTexture,n.TEXTURE0+Ht)},this.setTextureCube=function mr(gn,Ht){const ar=i.get(gn);gn.version>0&&ar.__version!==gn.version?function Fs(gn,Ht,ar){if(6!==Ht.image.length)return;const hr=Rr(gn,Ht),$r=Ht.source;t.bindTexture(n.TEXTURE_CUBE_MAP,gn.__webglTexture,n.TEXTURE0+ar);const Or=i.get($r);if($r.version!==Or.__version||!0===hr){t.activeTexture(n.TEXTURE0+ar);const Aa=Ol.getPrimaries(Ol.workingColorSpace),Qo=""===Ht.colorSpace?null:Ol.getPrimaries(Ht.colorSpace),As=""===Ht.colorSpace||Aa===Qo?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,Ht.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ht.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,Ht.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,As);const Is=Ht.isCompressedTexture||Ht.image[0].isCompressedTexture,ga=Ht.image[0]&&Ht.image[0].isDataTexture,hs=[];for(let ki=0;ki<6;ki++)hs[ki]=Is||ga?ga?Ht.image[ki].image:Ht.image[ki]:se(Ht.image[ki],!1,!0,r.maxCubemapSize),hs[ki]=uo(Ht,hs[ki]);const Sd=hs[0],qa=ce(Sd)||l,Ro=s.convert(Ht.format,Ht.colorSpace),ho=s.convert(Ht.type),To=wt(Ht.internalFormat,Ro,ho,Ht.colorSpace),Tn=l&&!0!==Ht.isVideoTexture,Er=void 0===Or.__version||!0===hr,mo=$r.dataReady;let rs,Xn=gt(Ht,Sd,qa);if(fi(n.TEXTURE_CUBE_MAP,Ht,qa),Is){Tn&&Er&&t.texStorage2D(n.TEXTURE_CUBE_MAP,Xn,To,Sd.width,Sd.height);for(let ki=0;ki<6;ki++){rs=hs[ki].mipmaps;for(let Xr=0;Xr<rs.length;Xr++){const Hs=rs[Xr];Ht.format!==gp?null!==Ro?Tn?mo&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ki,Xr,0,0,Hs.width,Hs.height,Ro,Hs.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ki,Xr,To,Hs.width,Hs.height,0,Hs.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Tn?mo&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ki,Xr,0,0,Hs.width,Hs.height,Ro,ho,Hs.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ki,Xr,To,Hs.width,Hs.height,0,Ro,ho,Hs.data)}}}else{if(rs=Ht.mipmaps,Tn&&Er){rs.length>0&&Xn++;const ki=ka(hs[0]);t.texStorage2D(n.TEXTURE_CUBE_MAP,Xn,To,ki.width,ki.height)}for(let ki=0;ki<6;ki++)if(ga){Tn?mo&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ki,0,0,0,hs[ki].width,hs[ki].height,Ro,ho,hs[ki].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ki,0,To,hs[ki].width,hs[ki].height,0,Ro,ho,hs[ki].data);for(let Xr=0;Xr<rs.length;Xr++){const Xa=rs[Xr].image[ki].image;Tn?mo&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ki,Xr+1,0,0,Xa.width,Xa.height,Ro,ho,Xa.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ki,Xr+1,To,Xa.width,Xa.height,0,Ro,ho,Xa.data)}}else{Tn?mo&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ki,0,0,0,Ro,ho,hs[ki]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ki,0,To,Ro,ho,hs[ki]);for(let Xr=0;Xr<rs.length;Xr++){const Hs=rs[Xr];Tn?mo&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ki,Xr+1,0,0,Ro,ho,Hs.image[ki]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ki,Xr+1,To,Ro,ho,Hs.image[ki])}}}Ce(Ht,qa)&&qe(n.TEXTURE_CUBE_MAP),Or.__version=$r.version,Ht.onUpdate&&Ht.onUpdate(Ht)}gn.__version=Ht.version}(ar,gn,Ht):t.bindTexture(n.TEXTURE_CUBE_MAP,ar.__webglTexture,n.TEXTURE0+Ht)},this.rebindTextures=function On(gn,Ht,ar){const hr=i.get(gn);void 0!==Ht&&Us(hr.__webglFramebuffer,gn,gn.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),void 0!==ar&&lo(gn)},this.setupRenderTarget=function ps(gn){const Ht=gn.texture,ar=i.get(gn),hr=i.get(Ht);gn.addEventListener("dispose",Un);const $r=gn.textures,Or=!0===gn.isWebGLCubeRenderTarget,Aa=$r.length>1,Qo=ce(gn)||l;if(Aa||(void 0===hr.__webglTexture&&(hr.__webglTexture=n.createTexture()),hr.__version=Ht.version,a.memory.textures++),Or){ar.__webglFramebuffer=[];for(let As=0;As<6;As++)if(l&&Ht.mipmaps&&Ht.mipmaps.length>0){ar.__webglFramebuffer[As]=[];for(let Is=0;Is<Ht.mipmaps.length;Is++)ar.__webglFramebuffer[As][Is]=n.createFramebuffer()}else ar.__webglFramebuffer[As]=n.createFramebuffer()}else{if(l&&Ht.mipmaps&&Ht.mipmaps.length>0){ar.__webglFramebuffer=[];for(let As=0;As<Ht.mipmaps.length;As++)ar.__webglFramebuffer[As]=n.createFramebuffer()}else ar.__webglFramebuffer=n.createFramebuffer();if(Aa)if(r.drawBuffers)for(let As=0,Is=$r.length;As<Is;As++){const ga=i.get($r[As]);void 0===ga.__webglTexture&&(ga.__webglTexture=n.createTexture(),a.memory.textures++)}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(l&&gn.samples>0&&!1===Ys(gn)){ar.__webglMultisampledFramebuffer=n.createFramebuffer(),ar.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,ar.__webglMultisampledFramebuffer);for(let As=0;As<$r.length;As++){const Is=$r[As];ar.__webglColorRenderbuffer[As]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,ar.__webglColorRenderbuffer[As]);const ga=s.convert(Is.format,Is.colorSpace),hs=s.convert(Is.type),Sd=wt(Is.internalFormat,ga,hs,Is.colorSpace,!0===gn.isXRRenderTarget),qa=Tr(gn);n.renderbufferStorageMultisample(n.RENDERBUFFER,qa,Sd,gn.width,gn.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+As,n.RENDERBUFFER,ar.__webglColorRenderbuffer[As])}n.bindRenderbuffer(n.RENDERBUFFER,null),gn.depthBuffer&&(ar.__webglDepthRenderbuffer=n.createRenderbuffer(),ws(ar.__webglDepthRenderbuffer,gn,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(Or){t.bindTexture(n.TEXTURE_CUBE_MAP,hr.__webglTexture),fi(n.TEXTURE_CUBE_MAP,Ht,Qo);for(let As=0;As<6;As++)if(l&&Ht.mipmaps&&Ht.mipmaps.length>0)for(let Is=0;Is<Ht.mipmaps.length;Is++)Us(ar.__webglFramebuffer[As][Is],gn,Ht,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+As,Is);else Us(ar.__webglFramebuffer[As],gn,Ht,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+As,0);Ce(Ht,Qo)&&qe(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Aa){for(let As=0,Is=$r.length;As<Is;As++){const ga=$r[As],hs=i.get(ga);t.bindTexture(n.TEXTURE_2D,hs.__webglTexture),fi(n.TEXTURE_2D,ga,Qo),Us(ar.__webglFramebuffer,gn,ga,n.COLOR_ATTACHMENT0+As,n.TEXTURE_2D,0),Ce(ga,Qo)&&qe(n.TEXTURE_2D)}t.unbindTexture()}else{let As=n.TEXTURE_2D;if((gn.isWebGL3DRenderTarget||gn.isWebGLArrayRenderTarget)&&(l?As=gn.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(As,hr.__webglTexture),fi(As,Ht,Qo),l&&Ht.mipmaps&&Ht.mipmaps.length>0)for(let Is=0;Is<Ht.mipmaps.length;Is++)Us(ar.__webglFramebuffer[Is],gn,Ht,n.COLOR_ATTACHMENT0,As,Is);else Us(ar.__webglFramebuffer,gn,Ht,n.COLOR_ATTACHMENT0,As,0);Ce(Ht,Qo)&&qe(As),t.unbindTexture()}gn.depthBuffer&&lo(gn)},this.updateRenderTargetMipmap=function gr(gn){const Ht=ce(gn)||l,ar=gn.textures;for(let hr=0,$r=ar.length;hr<$r;hr++){const Or=ar[hr];if(Ce(Or,Ht)){const Aa=gn.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,Qo=i.get(Or).__webglTexture;t.bindTexture(Aa,Qo),qe(Aa),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function ls(gn){if(l&&gn.samples>0&&!1===Ys(gn)){const Ht=gn.textures,ar=gn.width,hr=gn.height;let $r=n.COLOR_BUFFER_BIT;const Or=[],Aa=gn.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Qo=i.get(gn),As=Ht.length>1;if(As)for(let Is=0;Is<Ht.length;Is++)t.bindFramebuffer(n.FRAMEBUFFER,Qo.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Is,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,Qo.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Is,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,Qo.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Qo.__webglFramebuffer);for(let Is=0;Is<Ht.length;Is++){Or.push(n.COLOR_ATTACHMENT0+Is),gn.depthBuffer&&Or.push(Aa);const ga=void 0!==Qo.__ignoreDepthValues&&Qo.__ignoreDepthValues;if(!1===ga&&(gn.depthBuffer&&($r|=n.DEPTH_BUFFER_BIT),gn.stencilBuffer&&($r|=n.STENCIL_BUFFER_BIT)),As&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Qo.__webglColorRenderbuffer[Is]),!0===ga&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[Aa]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[Aa])),As){const hs=i.get(Ht[Is]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,hs,0)}n.blitFramebuffer(0,0,ar,hr,0,0,ar,hr,$r,n.NEAREST),u&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,Or)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),As)for(let Is=0;Is<Ht.length;Is++){t.bindFramebuffer(n.FRAMEBUFFER,Qo.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Is,n.RENDERBUFFER,Qo.__webglColorRenderbuffer[Is]);const ga=i.get(Ht[Is]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,Qo.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Is,n.TEXTURE_2D,ga,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Qo.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=lo,this.setupFrameBufferTexture=Us,this.useMultisampledRTT=Ys}function ffe(n,e,t){const i=t.isWebGL2;return{convert:function r(s,a=""){let l;const d=Ol.getTransfer(a);if(s===ky)return n.UNSIGNED_BYTE;if(1017===s)return n.UNSIGNED_SHORT_4_4_4_4;if(1018===s)return n.UNSIGNED_SHORT_5_5_5_1;if(1010===s)return n.BYTE;if(1011===s)return n.SHORT;if(1012===s)return n.UNSIGNED_SHORT;if(1013===s)return n.INT;if(s===Fy)return n.UNSIGNED_INT;if(s===aA)return n.FLOAT;if(s===lA)return i?n.HALF_FLOAT:(l=e.get("OES_texture_half_float"),null!==l?l.HALF_FLOAT_OES:null);if(1021===s)return n.ALPHA;if(s===gp)return n.RGBA;if(1024===s)return n.LUMINANCE;if(1025===s)return n.LUMINANCE_ALPHA;if(s===Ib)return n.DEPTH_COMPONENT;if(s===v2)return n.DEPTH_STENCIL;if(1035===s)return l=e.get("EXT_sRGB"),null!==l?l.SRGB_ALPHA_EXT:null;if(1028===s)return n.RED;if(1029===s)return n.RED_INTEGER;if(1030===s)return n.RG;if(1031===s)return n.RG_INTEGER;if(1033===s)return n.RGBA_INTEGER;if(33776===s||33777===s||33778===s||33779===s)if(d===Vc){if(l=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===l)return null;if(33776===s)return l.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===s)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===s)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===s)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(l=e.get("WEBGL_compressed_texture_s3tc"),null===l)return null;if(33776===s)return l.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===s)return l.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===s)return l.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===s)return l.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===s||35841===s||35842===s||35843===s){if(l=e.get("WEBGL_compressed_texture_pvrtc"),null===l)return null;if(35840===s)return l.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===s)return l.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===s)return l.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===s)return l.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===s)return l=e.get("WEBGL_compressed_texture_etc1"),null!==l?l.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===s||37496===s){if(l=e.get("WEBGL_compressed_texture_etc"),null===l)return null;if(37492===s)return d===Vc?l.COMPRESSED_SRGB8_ETC2:l.COMPRESSED_RGB8_ETC2;if(37496===s)return d===Vc?l.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:l.COMPRESSED_RGBA8_ETC2_EAC}if(37808===s||37809===s||37810===s||37811===s||37812===s||37813===s||37814===s||37815===s||37816===s||37817===s||37818===s||37819===s||37820===s||37821===s){if(l=e.get("WEBGL_compressed_texture_astc"),null===l)return null;if(37808===s)return d===Vc?l.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:l.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===s)return d===Vc?l.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:l.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===s)return d===Vc?l.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:l.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===s)return d===Vc?l.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:l.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===s)return d===Vc?l.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:l.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===s)return d===Vc?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:l.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===s)return d===Vc?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:l.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===s)return d===Vc?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:l.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===s)return d===Vc?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:l.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===s)return d===Vc?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:l.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===s)return d===Vc?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:l.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===s)return d===Vc?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:l.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===s)return d===Vc?l.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:l.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===s)return d===Vc?l.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:l.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===s||36494===s||36495===s){if(l=e.get("EXT_texture_compression_bptc"),null===l)return null;if(36492===s)return d===Vc?l.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:l.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(36494===s)return l.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(36495===s)return l.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===s||36284===s||36285===s||36286===s){if(l=e.get("EXT_texture_compression_rgtc"),null===l)return null;if(36492===s)return l.COMPRESSED_RED_RGTC1_EXT;if(36284===s)return l.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===s)return l.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===s)return l.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return s===Db?i?n.UNSIGNED_INT_24_8:(l=e.get("WEBGL_depth_texture"),null!==l?l.UNSIGNED_INT_24_8_WEBGL:null):void 0!==n[s]?n[s]:null}}}class qV extends Bu{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Wl extends Pl{constructor(){super(),this.isGroup=!0,this.type="Group"}}const pfe={type:"move"};class R5{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Wl,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Wl,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new It,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new It),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Wl,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new It,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new It),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,a=null;const l=this._targetRay,d=this._grip,u=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(u&&e.hand){a=!0;for(const re of e.hand.values()){const se=t.getJointPose(re,i),ce=this._getHandJoint(u,re);null!==se&&(ce.matrix.fromArray(se.transform.matrix),ce.matrix.decompose(ce.position,ce.rotation,ce.scale),ce.matrixWorldNeedsUpdate=!0,ce.jointRadius=se.radius),ce.visible=null!==se}const S=u.joints["index-finger-tip"].position.distanceTo(u.joints["thumb-tip"].position),R=.02,H=.005;u.inputState.pinching&&S>R+H?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&S<=R-H&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==d&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),null!==s&&(d.matrix.fromArray(s.transform.matrix),d.matrix.decompose(d.position,d.rotation,d.scale),d.matrixWorldNeedsUpdate=!0,s.linearVelocity?(d.hasLinearVelocity=!0,d.linearVelocity.copy(s.linearVelocity)):d.hasLinearVelocity=!1,s.angularVelocity?(d.hasAngularVelocity=!0,d.angularVelocity.copy(s.angularVelocity)):d.hasAngularVelocity=!1));null!==l&&(r=t.getPose(e.targetRaySpace,i),null===r&&null!==s&&(r=s),null!==r&&(l.matrix.fromArray(r.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,r.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(r.linearVelocity)):l.hasLinearVelocity=!1,r.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(r.angularVelocity)):l.hasAngularVelocity=!1,this.dispatchEvent(pfe)))}return null!==l&&(l.visible=null!==r),null!==d&&(d.visible=null!==s),null!==u&&(u.visible=null!==a),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const i=new Wl;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class gfe{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,i){if(null===this.texture){const r=new zh;e.properties.get(r).__webglTexture=t.texture,(t.depthNear!=i.depthNear||t.depthFar!=i.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=r}}render(e,t){if(null!==this.texture){if(null===this.mesh){const i=t.cameras[0].viewport,r=new Iu({extensions:{fragDepth:!0},vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepthEXT = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepthEXT = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:i.z},depthHeight:{value:i.w}}});this.mesh=new ua(new q2(20,20),r)}e.render(this.mesh,t)}}reset(){this.texture=null,this.mesh=null}}class _fe extends V_{constructor(e,t){super();const i=this;let r=null,s=1,a=null,l="local-floor",d=1,u=null,p=null,_=null,S=null,R=null,H=null;const re=new gfe,se=t.getContextAttributes();let ce=null,Te=null;const Ce=[],qe=[],wt=new Qi;let gt=null;const Et=new Bu;Et.layers.enable(1),Et.viewport=new nc;const Xt=new Bu;Xt.layers.enable(2),Xt.viewport=new nc;const Un=[Et,Xt],Ct=new qV;Ct.layers.enable(1),Ct.layers.enable(2);let Kt=null,Gi=null;function Yi(fi){const Rr=qe.indexOf(fi.inputSource);if(-1===Rr)return;const ms=Ce[Rr];void 0!==ms&&(ms.update(fi.inputSource,fi.frame,u||a),ms.dispatchEvent({type:fi.type,data:fi.inputSource}))}function En(){r.removeEventListener("select",Yi),r.removeEventListener("selectstart",Yi),r.removeEventListener("selectend",Yi),r.removeEventListener("squeeze",Yi),r.removeEventListener("squeezestart",Yi),r.removeEventListener("squeezeend",Yi),r.removeEventListener("end",En),r.removeEventListener("inputsourceschange",wi);for(let fi=0;fi<Ce.length;fi++){const Rr=qe[fi];null!==Rr&&(qe[fi]=null,Ce[fi].disconnect(Rr))}Kt=null,Gi=null,re.reset(),e.setRenderTarget(ce),R=null,S=null,_=null,r=null,Te=null,$s.stop(),i.isPresenting=!1,e.setPixelRatio(gt),e.setSize(wt.width,wt.height,!1),i.dispatchEvent({type:"sessionend"})}function wi(fi){for(let Rr=0;Rr<fi.removed.length;Rr++){const ms=fi.removed[Rr],Fs=qe.indexOf(ms);Fs>=0&&(qe[Fs]=null,Ce[Fs].disconnect(ms))}for(let Rr=0;Rr<fi.added.length;Rr++){const ms=fi.added[Rr];let Fs=qe.indexOf(ms);if(-1===Fs){for(let ws=0;ws<Ce.length;ws++){if(ws>=qe.length){qe.push(ms),Fs=ws;break}if(null===qe[ws]){qe[ws]=ms,Fs=ws;break}}if(-1===Fs)break}const Us=Ce[Fs];Us&&Us.connect(ms)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(fi){let Rr=Ce[fi];return void 0===Rr&&(Rr=new R5,Ce[fi]=Rr),Rr.getTargetRaySpace()},this.getControllerGrip=function(fi){let Rr=Ce[fi];return void 0===Rr&&(Rr=new R5,Ce[fi]=Rr),Rr.getGripSpace()},this.getHand=function(fi){let Rr=Ce[fi];return void 0===Rr&&(Rr=new R5,Ce[fi]=Rr),Rr.getHandSpace()},this.setFramebufferScaleFactor=function(fi){s=fi,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(fi){l=fi,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||a},this.setReferenceSpace=function(fi){u=fi},this.getBaseLayer=function(){return null!==S?S:R},this.getBinding=function(){return _},this.getFrame=function(){return H},this.getSession=function(){return r},this.setSession=function(){var fi=(0,Ee.A)(function*(Rr){if(r=Rr,null!==r){if(ce=e.getRenderTarget(),r.addEventListener("select",Yi),r.addEventListener("selectstart",Yi),r.addEventListener("selectend",Yi),r.addEventListener("squeeze",Yi),r.addEventListener("squeezestart",Yi),r.addEventListener("squeezeend",Yi),r.addEventListener("end",En),r.addEventListener("inputsourceschange",wi),!0!==se.xrCompatible&&(yield t.makeXRCompatible()),gt=e.getPixelRatio(),e.getSize(wt),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)R=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||se.antialias,alpha:!0,depth:se.depth,stencil:se.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:R}),e.setPixelRatio(1),e.setSize(R.framebufferWidth,R.framebufferHeight,!1),Te=new ju(R.framebufferWidth,R.framebufferHeight,{format:gp,type:ky,colorSpace:e.outputColorSpace,stencilBuffer:se.stencil});else{let ms=null,Fs=null,Us=null;se.depth&&(Us=se.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,ms=se.stencil?v2:Ib,Fs=se.stencil?Db:Fy);const ws={colorFormat:t.RGBA8,depthFormat:Us,scaleFactor:s};_=new XRWebGLBinding(r,t),S=_.createProjectionLayer(ws),r.updateRenderState({layers:[S]}),e.setPixelRatio(1),e.setSize(S.textureWidth,S.textureHeight,!1),Te=new ju(S.textureWidth,S.textureHeight,{format:gp,type:ky,depthTexture:new xV(S.textureWidth,S.textureHeight,Fs,void 0,void 0,void 0,void 0,void 0,void 0,ms),stencilBuffer:se.stencil,colorSpace:e.outputColorSpace,samples:se.antialias?4:0}),e.properties.get(Te).__ignoreDepthValues=S.ignoreDepthValues}Te.isXRRenderTarget=!0,this.setFoveation(d),u=null,a=yield r.requestReferenceSpace(l),$s.setContext(r),$s.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(Rr){return fi.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode};const zn=new It,oi=new It;function vi(fi,Rr){null===Rr?fi.matrixWorld.copy(fi.matrix):fi.matrixWorld.multiplyMatrices(Rr.matrixWorld,fi.matrix),fi.matrixWorldInverse.copy(fi.matrixWorld).invert()}this.updateCamera=function(fi){if(null===r)return;null!==re.texture&&(fi.near=re.depthNear,fi.far=re.depthFar),Ct.near=Xt.near=Et.near=fi.near,Ct.far=Xt.far=Et.far=fi.far,(Kt!==Ct.near||Gi!==Ct.far)&&(r.updateRenderState({depthNear:Ct.near,depthFar:Ct.far}),Kt=Ct.near,Gi=Ct.far,Et.near=Kt,Et.far=Gi,Xt.near=Kt,Xt.far=Gi,Et.updateProjectionMatrix(),Xt.updateProjectionMatrix(),fi.updateProjectionMatrix());const Rr=fi.parent,ms=Ct.cameras;vi(Ct,Rr);for(let Fs=0;Fs<ms.length;Fs++)vi(ms[Fs],Rr);2===ms.length?function hi(fi,Rr,ms){zn.setFromMatrixPosition(Rr.matrixWorld),oi.setFromMatrixPosition(ms.matrixWorld);const Fs=zn.distanceTo(oi),Us=Rr.projectionMatrix.elements,ws=ms.projectionMatrix.elements,Co=Us[14]/(Us[10]-1),lo=Us[14]/(Us[10]+1),On=(Us[9]+1)/Us[5],ps=(Us[9]-1)/Us[5],gr=(Us[8]-1)/Us[0],ls=(ws[8]+1)/ws[0],Tr=Co*gr,Ys=Co*ls,qs=Fs/(-gr+ls),uo=qs*-gr;Rr.matrixWorld.decompose(fi.position,fi.quaternion,fi.scale),fi.translateX(uo),fi.translateZ(qs),fi.matrixWorld.compose(fi.position,fi.quaternion,fi.scale),fi.matrixWorldInverse.copy(fi.matrixWorld).invert();const ka=Co+qs,gn=lo+qs;fi.projectionMatrix.makePerspective(Tr-uo,Ys+(Fs-uo),On*lo/gn*ka,ps*lo/gn*ka,ka,gn),fi.projectionMatrixInverse.copy(fi.projectionMatrix).invert()}(Ct,Et,Xt):Ct.projectionMatrix.copy(Et.projectionMatrix),function mr(fi,Rr,ms){null===ms?fi.matrix.copy(Rr.matrixWorld):(fi.matrix.copy(ms.matrixWorld),fi.matrix.invert(),fi.matrix.multiply(Rr.matrixWorld)),fi.matrix.decompose(fi.position,fi.quaternion,fi.scale),fi.updateMatrixWorld(!0),fi.projectionMatrix.copy(Rr.projectionMatrix),fi.projectionMatrixInverse.copy(Rr.projectionMatrixInverse),fi.isPerspectiveCamera&&(fi.fov=2*M2*Math.atan(1/fi.projectionMatrix.elements[5]),fi.zoom=1)}(fi,Ct,Rr)},this.getCamera=function(){return Ct},this.getFoveation=function(){if(null!==S||null!==R)return d},this.setFoveation=function(fi){d=fi,null!==S&&(S.fixedFoveation=fi),null!==R&&void 0!==R.fixedFoveation&&(R.fixedFoveation=fi)},this.hasDepthSensing=function(){return null!==re.texture};let Mr=null;const $s=new pV;$s.setAnimationLoop(function is(fi,Rr){if(p=Rr.getViewerPose(u||a),H=Rr,null!==p){const ms=p.views;null!==R&&(e.setRenderTargetFramebuffer(Te,R.framebuffer),e.setRenderTarget(Te));let Fs=!1;ms.length!==Ct.cameras.length&&(Ct.cameras.length=0,Fs=!0);for(let ws=0;ws<ms.length;ws++){const Co=ms[ws];let lo=null;if(null!==R)lo=R.getViewport(Co);else{const ps=_.getViewSubImage(S,Co);lo=ps.viewport,0===ws&&(e.setRenderTargetTextures(Te,ps.colorTexture,S.ignoreDepthValues?void 0:ps.depthStencilTexture),e.setRenderTarget(Te))}let On=Un[ws];void 0===On&&(On=new Bu,On.layers.enable(ws),On.viewport=new nc,Un[ws]=On),On.matrix.fromArray(Co.transform.matrix),On.matrix.decompose(On.position,On.quaternion,On.scale),On.projectionMatrix.fromArray(Co.projectionMatrix),On.projectionMatrixInverse.copy(On.projectionMatrix).invert(),On.viewport.set(lo.x,lo.y,lo.width,lo.height),0===ws&&(Ct.matrix.copy(On.matrix),Ct.matrix.decompose(Ct.position,Ct.quaternion,Ct.scale)),!0===Fs&&Ct.cameras.push(On)}const Us=r.enabledFeatures;if(Us&&Us.includes("depth-sensing")){const ws=_.getDepthInformation(ms[0]);ws&&ws.isValid&&ws.texture&&re.init(e,ws,r.renderState)}}for(let ms=0;ms<Ce.length;ms++){const Fs=qe[ms],Us=Ce[ms];null!==Fs&&void 0!==Us&&Us.update(Fs,Rr,u||a)}re.render(e,Ct),Mr&&Mr(fi,Rr),Rr.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:Rr}),H=null}),this.setAnimationLoop=function(fi){Mr=fi},this.dispose=function(){}}}const Vb=new M0,yfe=new wo;function vfe(n,e){function t(se,ce){!0===se.matrixAutoUpdate&&se.updateMatrix(),ce.value.copy(se.matrix)}function s(se,ce){se.opacity.value=ce.opacity,ce.color&&se.diffuse.value.copy(ce.color),ce.emissive&&se.emissive.value.copy(ce.emissive).multiplyScalar(ce.emissiveIntensity),ce.map&&(se.map.value=ce.map,t(ce.map,se.mapTransform)),ce.alphaMap&&(se.alphaMap.value=ce.alphaMap,t(ce.alphaMap,se.alphaMapTransform)),ce.bumpMap&&(se.bumpMap.value=ce.bumpMap,t(ce.bumpMap,se.bumpMapTransform),se.bumpScale.value=ce.bumpScale,1===ce.side&&(se.bumpScale.value*=-1)),ce.normalMap&&(se.normalMap.value=ce.normalMap,t(ce.normalMap,se.normalMapTransform),se.normalScale.value.copy(ce.normalScale),1===ce.side&&se.normalScale.value.negate()),ce.displacementMap&&(se.displacementMap.value=ce.displacementMap,t(ce.displacementMap,se.displacementMapTransform),se.displacementScale.value=ce.displacementScale,se.displacementBias.value=ce.displacementBias),ce.emissiveMap&&(se.emissiveMap.value=ce.emissiveMap,t(ce.emissiveMap,se.emissiveMapTransform)),ce.specularMap&&(se.specularMap.value=ce.specularMap,t(ce.specularMap,se.specularMapTransform)),ce.alphaTest>0&&(se.alphaTest.value=ce.alphaTest);const Te=e.get(ce),Ce=Te.envMap,qe=Te.envMapRotation;if(Ce&&(se.envMap.value=Ce,Vb.copy(qe),Vb.x*=-1,Vb.y*=-1,Vb.z*=-1,Ce.isCubeTexture&&!1===Ce.isRenderTargetTexture&&(Vb.y*=-1,Vb.z*=-1),se.envMapRotation.value.setFromMatrix4(yfe.makeRotationFromEuler(Vb)),se.flipEnvMap.value=Ce.isCubeTexture&&!1===Ce.isRenderTargetTexture?-1:1,se.reflectivity.value=ce.reflectivity,se.ior.value=ce.ior,se.refractionRatio.value=ce.refractionRatio),ce.lightMap){se.lightMap.value=ce.lightMap;const wt=!0===n._useLegacyLights?Math.PI:1;se.lightMapIntensity.value=ce.lightMapIntensity*wt,t(ce.lightMap,se.lightMapTransform)}ce.aoMap&&(se.aoMap.value=ce.aoMap,se.aoMapIntensity.value=ce.aoMapIntensity,t(ce.aoMap,se.aoMapTransform))}return{refreshFogUniforms:function i(se,ce){ce.color.getRGB(se.fogColor.value,uV(n)),ce.isFog?(se.fogNear.value=ce.near,se.fogFar.value=ce.far):ce.isFogExp2&&(se.fogDensity.value=ce.density)},refreshMaterialUniforms:function r(se,ce,Te,Ce,qe){ce.isMeshBasicMaterial||ce.isMeshLambertMaterial?s(se,ce):ce.isMeshToonMaterial?(s(se,ce),function _(se,ce){ce.gradientMap&&(se.gradientMap.value=ce.gradientMap)}(se,ce)):ce.isMeshPhongMaterial?(s(se,ce),function p(se,ce){se.specular.value.copy(ce.specular),se.shininess.value=Math.max(ce.shininess,1e-4)}(se,ce)):ce.isMeshStandardMaterial?(s(se,ce),function S(se,ce){se.metalness.value=ce.metalness,ce.metalnessMap&&(se.metalnessMap.value=ce.metalnessMap,t(ce.metalnessMap,se.metalnessMapTransform)),se.roughness.value=ce.roughness,ce.roughnessMap&&(se.roughnessMap.value=ce.roughnessMap,t(ce.roughnessMap,se.roughnessMapTransform)),e.get(ce).envMap&&(se.envMapIntensity.value=ce.envMapIntensity)}(se,ce),ce.isMeshPhysicalMaterial&&function R(se,ce,Te){se.ior.value=ce.ior,ce.sheen>0&&(se.sheenColor.value.copy(ce.sheenColor).multiplyScalar(ce.sheen),se.sheenRoughness.value=ce.sheenRoughness,ce.sheenColorMap&&(se.sheenColorMap.value=ce.sheenColorMap,t(ce.sheenColorMap,se.sheenColorMapTransform)),ce.sheenRoughnessMap&&(se.sheenRoughnessMap.value=ce.sheenRoughnessMap,t(ce.sheenRoughnessMap,se.sheenRoughnessMapTransform))),ce.clearcoat>0&&(se.clearcoat.value=ce.clearcoat,se.clearcoatRoughness.value=ce.clearcoatRoughness,ce.clearcoatMap&&(se.clearcoatMap.value=ce.clearcoatMap,t(ce.clearcoatMap,se.clearcoatMapTransform)),ce.clearcoatRoughnessMap&&(se.clearcoatRoughnessMap.value=ce.clearcoatRoughnessMap,t(ce.clearcoatRoughnessMap,se.clearcoatRoughnessMapTransform)),ce.clearcoatNormalMap&&(se.clearcoatNormalMap.value=ce.clearcoatNormalMap,t(ce.clearcoatNormalMap,se.clearcoatNormalMapTransform),se.clearcoatNormalScale.value.copy(ce.clearcoatNormalScale),1===ce.side&&se.clearcoatNormalScale.value.negate())),ce.iridescence>0&&(se.iridescence.value=ce.iridescence,se.iridescenceIOR.value=ce.iridescenceIOR,se.iridescenceThicknessMinimum.value=ce.iridescenceThicknessRange[0],se.iridescenceThicknessMaximum.value=ce.iridescenceThicknessRange[1],ce.iridescenceMap&&(se.iridescenceMap.value=ce.iridescenceMap,t(ce.iridescenceMap,se.iridescenceMapTransform)),ce.iridescenceThicknessMap&&(se.iridescenceThicknessMap.value=ce.iridescenceThicknessMap,t(ce.iridescenceThicknessMap,se.iridescenceThicknessMapTransform))),ce.transmission>0&&(se.transmission.value=ce.transmission,se.transmissionSamplerMap.value=Te.texture,se.transmissionSamplerSize.value.set(Te.width,Te.height),ce.transmissionMap&&(se.transmissionMap.value=ce.transmissionMap,t(ce.transmissionMap,se.transmissionMapTransform)),se.thickness.value=ce.thickness,ce.thicknessMap&&(se.thicknessMap.value=ce.thicknessMap,t(ce.thicknessMap,se.thicknessMapTransform)),se.attenuationDistance.value=ce.attenuationDistance,se.attenuationColor.value.copy(ce.attenuationColor)),ce.anisotropy>0&&(se.anisotropyVector.value.set(ce.anisotropy*Math.cos(ce.anisotropyRotation),ce.anisotropy*Math.sin(ce.anisotropyRotation)),ce.anisotropyMap&&(se.anisotropyMap.value=ce.anisotropyMap,t(ce.anisotropyMap,se.anisotropyMapTransform))),se.specularIntensity.value=ce.specularIntensity,se.specularColor.value.copy(ce.specularColor),ce.specularColorMap&&(se.specularColorMap.value=ce.specularColorMap,t(ce.specularColorMap,se.specularColorMapTransform)),ce.specularIntensityMap&&(se.specularIntensityMap.value=ce.specularIntensityMap,t(ce.specularIntensityMap,se.specularIntensityMapTransform))}(se,ce,qe)):ce.isMeshMatcapMaterial?(s(se,ce),function H(se,ce){ce.matcap&&(se.matcap.value=ce.matcap)}(se,ce)):ce.isMeshDepthMaterial?s(se,ce):ce.isMeshDistanceMaterial?(s(se,ce),function re(se,ce){const Te=e.get(ce).light;se.referencePosition.value.setFromMatrixPosition(Te.matrixWorld),se.nearDistance.value=Te.shadow.camera.near,se.farDistance.value=Te.shadow.camera.far}(se,ce)):ce.isMeshNormalMaterial?s(se,ce):ce.isLineBasicMaterial?(function a(se,ce){se.diffuse.value.copy(ce.color),se.opacity.value=ce.opacity,ce.map&&(se.map.value=ce.map,t(ce.map,se.mapTransform))}(se,ce),ce.isLineDashedMaterial&&function l(se,ce){se.dashSize.value=ce.dashSize,se.totalSize.value=ce.dashSize+ce.gapSize,se.scale.value=ce.scale}(se,ce)):ce.isPointsMaterial?function d(se,ce,Te,Ce){se.diffuse.value.copy(ce.color),se.opacity.value=ce.opacity,se.size.value=ce.size*Te,se.scale.value=.5*Ce,ce.map&&(se.map.value=ce.map,t(ce.map,se.uvTransform)),ce.alphaMap&&(se.alphaMap.value=ce.alphaMap,t(ce.alphaMap,se.alphaMapTransform)),ce.alphaTest>0&&(se.alphaTest.value=ce.alphaTest)}(se,ce,Te,Ce):ce.isSpriteMaterial?function u(se,ce){se.diffuse.value.copy(ce.color),se.opacity.value=ce.opacity,se.rotation.value=ce.rotation,ce.map&&(se.map.value=ce.map,t(ce.map,se.mapTransform)),ce.alphaMap&&(se.alphaMap.value=ce.alphaMap,t(ce.alphaMap,se.alphaMapTransform)),ce.alphaTest>0&&(se.alphaTest.value=ce.alphaTest)}(se,ce):ce.isShadowMaterial?(se.color.value.copy(ce.color),se.opacity.value=ce.opacity):ce.isShaderMaterial&&(ce.uniformsNeedUpdate=!1)}}}function bfe(n,e,t,i){let r={},s={},a=[];const l=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function R(Te,Ce,qe,wt){const gt=Te.value,Et=Ce+"_"+qe;if(void 0===wt[Et])return wt[Et]="number"==typeof gt||"boolean"==typeof gt?gt:gt.clone(),!0;{const Xt=wt[Et];if("number"==typeof gt||"boolean"==typeof gt){if(Xt!==gt)return wt[Et]=gt,!0}else if(!1===Xt.equals(gt))return Xt.copy(gt),!0}return!1}function re(Te){const Ce={boundary:0,storage:0};return"number"==typeof Te||"boolean"==typeof Te?(Ce.boundary=4,Ce.storage=4):Te.isVector2?(Ce.boundary=8,Ce.storage=8):Te.isVector3||Te.isColor?(Ce.boundary=16,Ce.storage=12):Te.isVector4?(Ce.boundary=16,Ce.storage=16):Te.isMatrix3?(Ce.boundary=48,Ce.storage=48):Te.isMatrix4?(Ce.boundary=64,Ce.storage=64):Te.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",Te),Ce}function se(Te){const Ce=Te.target;Ce.removeEventListener("dispose",se);const qe=a.indexOf(Ce.__bindingPointIndex);a.splice(qe,1),n.deleteBuffer(r[Ce.id]),delete r[Ce.id],delete s[Ce.id]}return{bind:function d(Te,Ce){i.uniformBlockBinding(Te,Ce.program)},update:function u(Te,Ce){let qe=r[Te.id];void 0===qe&&(function H(Te){const Ce=Te.uniforms;let qe=0;for(let Et=0,Xt=Ce.length;Et<Xt;Et++){const Un=Array.isArray(Ce[Et])?Ce[Et]:[Ce[Et]];for(let Ct=0,Kt=Un.length;Ct<Kt;Ct++){const Gi=Un[Ct],Yi=Array.isArray(Gi.value)?Gi.value:[Gi.value];for(let En=0,wi=Yi.length;En<wi;En++){const oi=re(Yi[En]),hi=qe%16;0!==hi&&16-hi<oi.boundary&&(qe+=16-hi),Gi.__data=new Float32Array(oi.storage/Float32Array.BYTES_PER_ELEMENT),Gi.__offset=qe,qe+=oi.storage}}}const gt=qe%16;gt>0&&(qe+=16-gt),Te.__size=qe,Te.__cache={}}(Te),qe=function p(Te){const Ce=function _(){for(let Te=0;Te<l;Te++)if(-1===a.indexOf(Te))return a.push(Te),Te;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();Te.__bindingPointIndex=Ce;const qe=n.createBuffer(),wt=Te.__size,gt=Te.usage;return n.bindBuffer(n.UNIFORM_BUFFER,qe),n.bufferData(n.UNIFORM_BUFFER,wt,gt),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,Ce,qe),qe}(Te),r[Te.id]=qe,Te.addEventListener("dispose",se)),i.updateUBOMapping(Te,Ce.program);const gt=e.render.frame;s[Te.id]!==gt&&(function S(Te){const qe=Te.uniforms,wt=Te.__cache;n.bindBuffer(n.UNIFORM_BUFFER,r[Te.id]);for(let gt=0,Et=qe.length;gt<Et;gt++){const Xt=Array.isArray(qe[gt])?qe[gt]:[qe[gt]];for(let Un=0,Ct=Xt.length;Un<Ct;Un++){const Kt=Xt[Un];if(!0===R(Kt,gt,Un,wt)){const Gi=Kt.__offset,Yi=Array.isArray(Kt.value)?Kt.value:[Kt.value];let En=0;for(let wi=0;wi<Yi.length;wi++){const zn=Yi[wi],oi=re(zn);"number"==typeof zn||"boolean"==typeof zn?(Kt.__data[0]=zn,n.bufferSubData(n.UNIFORM_BUFFER,Gi+En,Kt.__data)):zn.isMatrix3?(Kt.__data[0]=zn.elements[0],Kt.__data[1]=zn.elements[1],Kt.__data[2]=zn.elements[2],Kt.__data[3]=0,Kt.__data[4]=zn.elements[3],Kt.__data[5]=zn.elements[4],Kt.__data[6]=zn.elements[5],Kt.__data[7]=0,Kt.__data[8]=zn.elements[6],Kt.__data[9]=zn.elements[7],Kt.__data[10]=zn.elements[8],Kt.__data[11]=0):(zn.toArray(Kt.__data,En),En+=oi.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,Gi,Kt.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}(Te),s[Te.id]=gt)},dispose:function ce(){for(const Te in r)n.deleteBuffer(r[Te]);a=[],r={},s={}}}}class xI{constructor(e={}){const{canvas:t=Xle(),context:i=null,depth:r=!0,stencil:s=!0,alpha:a=!1,antialias:l=!1,premultipliedAlpha:d=!0,preserveDrawingBuffer:u=!1,powerPreference:p="default",failIfMajorPerformanceCaveat:_=!1}=e;let S;this.isWebGLRenderer=!0,S=null!==i?i.getContextAttributes().alpha:a;const R=new Uint32Array(4),H=new Int32Array(4);let re=null,se=null;const ce=[],Te=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=du,this._useLegacyLights=!1,this.toneMapping=Iy,this.toneMappingExposure=1;const Ce=this;let qe=!1,wt=0,gt=0,Et=null,Xt=-1,Un=null;const Ct=new nc,Kt=new nc;let Gi=null;const Yi=new Cr(0);let En=0,wi=t.width,zn=t.height,oi=1,hi=null,vi=null;const mr=new nc(0,0,wi,zn),Mr=new nc(0,0,wi,zn);let is=!1;const $s=new gI;let fi=!1,Rr=!1,ms=null;const Fs=new wo,Us=new Qi,ws=new It,Co={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function lo(){return null===Et?oi:1}let gr,ls,Tr,Ys,qs,uo,ka,gn,Ht,ar,hr,$r,Or,Aa,Qo,As,Is,ga,hs,Sd,qa,Ro,ho,To,On=i;function ps(mn,gi){for(let $i=0;$i<mn.length;$i++){const Ui=t.getContext(mn[$i],gi);if(null!==Ui)return Ui}return null}try{const mn={alpha:!0,depth:r,stencil:s,antialias:l,premultipliedAlpha:d,preserveDrawingBuffer:u,powerPreference:p,failIfMajorPerformanceCaveat:_};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${m2}`),t.addEventListener("webglcontextlost",mo,!1),t.addEventListener("webglcontextrestored",Xn,!1),t.addEventListener("webglcontextcreationerror",rs,!1),null===On){const gi=["webgl2","webgl","experimental-webgl"];if(!0===Ce.isWebGL1Renderer&&gi.shift(),On=ps(gi,mn),null===On)throw ps(gi)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&On instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===On.getShaderPrecisionFormat&&(On.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(mn){throw console.error("THREE.WebGLRenderer: "+mn.message),mn}function Tn(){gr=new Iue(On),ls=new Cue(On,gr,e),gr.init(ls),Ro=new ffe(On,gr,ls),Tr=new ufe(On,gr,ls),Ys=new Rue(On),qs=new Jhe,uo=new hfe(On,gr,Tr,qs,ls,Ro,Ys),ka=new Sue(Ce),gn=new Due(Ce),Ht=new yce(On,ls),ho=new xue(On,gr,Ht,ls),ar=new Bue(On,Ht,Ys,ho),hr=new Lue(On,ar,Ht,Ys),hs=new Oue(On,ls,uo),As=new Mue(qs),$r=new Zhe(Ce,ka,gn,gr,ls,ho,As),Or=new vfe(Ce,qs),Aa=new tfe,Qo=new afe(gr,ls),ga=new bue(Ce,ka,gn,Tr,hr,S,d),Is=new dfe(Ce,hr,ls),To=new bfe(On,Ys,ls,Tr),Sd=new wue(On,gr,Ys,ls),qa=new Pue(On,gr,Ys,ls),Ys.programs=$r.programs,Ce.capabilities=ls,Ce.extensions=gr,Ce.properties=qs,Ce.renderLists=Aa,Ce.shadowMap=Is,Ce.state=Tr,Ce.info=Ys}Tn();const Er=new _fe(Ce,On);function mo(mn){mn.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),qe=!0}function Xn(){console.log("THREE.WebGLRenderer: Context Restored."),qe=!1;const mn=Ys.autoReset,gi=Is.enabled,$i=Is.autoUpdate,tr=Is.needsUpdate,Ui=Is.type;Tn(),Ys.autoReset=mn,Is.enabled=gi,Is.autoUpdate=$i,Is.needsUpdate=tr,Is.type=Ui}function rs(mn){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",mn.statusMessage)}function ki(mn){const gi=mn.target;gi.removeEventListener("dispose",ki),function Xr(mn){(function Hs(mn){const gi=qs.get(mn).programs;void 0!==gi&&(gi.forEach(function($i){$r.releaseProgram($i)}),mn.isShaderMaterial&&$r.releaseShaderCache(mn))})(mn),qs.remove(mn)}(gi)}function Xa(mn,gi,$i){!0===mn.transparent&&2===mn.side&&!1===mn.forceSinglePass?(mn.side=1,mn.needsUpdate=!0,DB(mn,gi,$i),mn.side=0,mn.needsUpdate=!0,DB(mn,gi,$i),mn.side=2):DB(mn,gi,$i)}this.xr=Er,this.getContext=function(){return On},this.getContextAttributes=function(){return On.getContextAttributes()},this.forceContextLoss=function(){const mn=gr.get("WEBGL_lose_context");mn&&mn.loseContext()},this.forceContextRestore=function(){const mn=gr.get("WEBGL_lose_context");mn&&mn.restoreContext()},this.getPixelRatio=function(){return oi},this.setPixelRatio=function(mn){void 0!==mn&&(oi=mn,this.setSize(wi,zn,!1))},this.getSize=function(mn){return mn.set(wi,zn)},this.setSize=function(mn,gi,$i=!0){Er.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(wi=mn,zn=gi,t.width=Math.floor(mn*oi),t.height=Math.floor(gi*oi),!0===$i&&(t.style.width=mn+"px",t.style.height=gi+"px"),this.setViewport(0,0,mn,gi))},this.getDrawingBufferSize=function(mn){return mn.set(wi*oi,zn*oi).floor()},this.setDrawingBufferSize=function(mn,gi,$i){wi=mn,zn=gi,oi=$i,t.width=Math.floor(mn*$i),t.height=Math.floor(gi*$i),this.setViewport(0,0,mn,gi)},this.getCurrentViewport=function(mn){return mn.copy(Ct)},this.getViewport=function(mn){return mn.copy(mr)},this.setViewport=function(mn,gi,$i,tr){mn.isVector4?mr.set(mn.x,mn.y,mn.z,mn.w):mr.set(mn,gi,$i,tr),Tr.viewport(Ct.copy(mr).multiplyScalar(oi).round())},this.getScissor=function(mn){return mn.copy(Mr)},this.setScissor=function(mn,gi,$i,tr){mn.isVector4?Mr.set(mn.x,mn.y,mn.z,mn.w):Mr.set(mn,gi,$i,tr),Tr.scissor(Kt.copy(Mr).multiplyScalar(oi).round())},this.getScissorTest=function(){return is},this.setScissorTest=function(mn){Tr.setScissorTest(is=mn)},this.setOpaqueSort=function(mn){hi=mn},this.setTransparentSort=function(mn){vi=mn},this.getClearColor=function(mn){return mn.copy(ga.getClearColor())},this.setClearColor=function(){ga.setClearColor.apply(ga,arguments)},this.getClearAlpha=function(){return ga.getClearAlpha()},this.setClearAlpha=function(){ga.setClearAlpha.apply(ga,arguments)},this.clear=function(mn=!0,gi=!0,$i=!0){let tr=0;if(mn){let Ui=!1;if(null!==Et){const Ks=Et.texture.format;Ui=1033===Ks||1031===Ks||1029===Ks}if(Ui){const Ks=Et.texture.type,Do=Ks===ky||Ks===Fy||1012===Ks||Ks===Db||1017===Ks||1018===Ks,la=ga.getClearColor(),ya=ga.getClearAlpha(),Qa=la.r,Da=la.g,Fa=la.b;Do?(R[0]=Qa,R[1]=Da,R[2]=Fa,R[3]=ya,On.clearBufferuiv(On.COLOR,0,R)):(H[0]=Qa,H[1]=Da,H[2]=Fa,H[3]=ya,On.clearBufferiv(On.COLOR,0,H))}else tr|=On.COLOR_BUFFER_BIT}gi&&(tr|=On.DEPTH_BUFFER_BIT),$i&&(tr|=On.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),On.clear(tr)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",mo,!1),t.removeEventListener("webglcontextrestored",Xn,!1),t.removeEventListener("webglcontextcreationerror",rs,!1),Aa.dispose(),Qo.dispose(),qs.dispose(),ka.dispose(),gn.dispose(),hr.dispose(),ho.dispose(),To.dispose(),$r.dispose(),Er.dispose(),Er.removeEventListener("sessionstart",Ed),Er.removeEventListener("sessionend",Ml),ms&&(ms.dispose(),ms=null),Qc.stop()},this.renderBufferDirect=function(mn,gi,$i,tr,Ui,Ks){null===gi&&(gi=Co);const Do=Ui.isMesh&&Ui.matrixWorld.determinant()<0,la=function QCe(mn,gi,$i,tr,Ui){!0!==gi.isScene&&(gi=Co),uo.resetTextureUnits();const Ks=gi.fog,la=null===Et?Ce.outputColorSpace:!0===Et.isXRRenderTarget?Et.texture.colorSpace:Wu,ya=(tr.isMeshStandardMaterial?gn:ka).get(tr.envMap||(tr.isMeshStandardMaterial?gi.environment:null)),Qa=!0===tr.vertexColors&&!!$i.attributes.color&&4===$i.attributes.color.itemSize,Da=!!$i.attributes.tangent&&(!!tr.normalMap||tr.anisotropy>0),Fa=!!$i.morphAttributes.position,jd=!!$i.morphAttributes.normal,bm=!!$i.morphAttributes.color;let Zu=Iy;tr.toneMapped&&(null===Et||!0===Et.isXRRenderTarget)&&(Zu=Ce.toneMapping);const l1=$i.morphAttributes.position||$i.morphAttributes.normal||$i.morphAttributes.color,ud=void 0!==l1?l1.length:0,Ua=qs.get(tr),dN=se.state.lights;!0!==fi||!0!==Rr&&mn===Un||As.setState(tr,mn,mn===Un&&tr.id===Xt);let Zc=!1;tr.version===Ua.__version?(Ua.needsLights&&Ua.lightsStateVersion!==dN.state.version||Ua.outputColorSpace!==la||Ui.isBatchedMesh&&!1===Ua.batching||!Ui.isBatchedMesh&&!0===Ua.batching||Ui.isInstancedMesh&&!1===Ua.instancing||!Ui.isInstancedMesh&&!0===Ua.instancing||Ui.isSkinnedMesh&&!1===Ua.skinning||!Ui.isSkinnedMesh&&!0===Ua.skinning||Ui.isInstancedMesh&&!0===Ua.instancingColor&&null===Ui.instanceColor||Ui.isInstancedMesh&&!1===Ua.instancingColor&&null!==Ui.instanceColor||Ui.isInstancedMesh&&!0===Ua.instancingMorph&&null===Ui.morphTexture||Ui.isInstancedMesh&&!1===Ua.instancingMorph&&null!==Ui.morphTexture||Ua.envMap!==ya||!0===tr.fog&&Ua.fog!==Ks||void 0!==Ua.numClippingPlanes&&(Ua.numClippingPlanes!==As.numPlanes||Ua.numIntersection!==As.numIntersection)||Ua.vertexAlphas!==Qa||Ua.vertexTangents!==Da||Ua.morphTargets!==Fa||Ua.morphNormals!==jd||Ua.morphColors!==bm||Ua.toneMapping!==Zu||!0===ls.isWebGL2&&Ua.morphTargetsCount!==ud)&&(Zc=!0):(Zc=!0,Ua.__version=tr.version);let Sx=Ua.currentProgram;!0===Zc&&(Sx=DB(tr,gi,Ui));let BX=!1,rT=!1,uN=!1;const Wh=Sx.getUniforms(),Ex=Ua.uniforms;if(Tr.useProgram(Sx.program)&&(BX=!0,rT=!0,uN=!0),tr.id!==Xt&&(Xt=tr.id,rT=!0),BX||Un!==mn){Wh.setValue(On,"projectionMatrix",mn.projectionMatrix),Wh.setValue(On,"viewMatrix",mn.matrixWorldInverse);const AA=Wh.map.cameraPosition;void 0!==AA&&AA.setValue(On,ws.setFromMatrixPosition(mn.matrixWorld)),ls.logarithmicDepthBuffer&&Wh.setValue(On,"logDepthBufFC",2/(Math.log(mn.far+1)/Math.LN2)),(tr.isMeshPhongMaterial||tr.isMeshToonMaterial||tr.isMeshLambertMaterial||tr.isMeshBasicMaterial||tr.isMeshStandardMaterial||tr.isShaderMaterial)&&Wh.setValue(On,"isOrthographic",!0===mn.isOrthographicCamera),Un!==mn&&(Un=mn,rT=!0,uN=!0)}if(Ui.isSkinnedMesh){Wh.setOptional(On,Ui,"bindMatrix"),Wh.setOptional(On,Ui,"bindMatrixInverse");const AA=Ui.skeleton;AA&&(ls.floatVertexTextures?(null===AA.boneTexture&&AA.computeBoneTexture(),Wh.setValue(On,"boneTexture",AA.boneTexture,uo)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}Ui.isBatchedMesh&&(Wh.setOptional(On,Ui,"batchingTexture"),Wh.setValue(On,"batchingTexture",Ui._matricesTexture,uo));const hN=$i.morphAttributes;if((void 0!==hN.position||void 0!==hN.normal||void 0!==hN.color&&!0===ls.isWebGL2)&&hs.update(Ui,$i,Sx),(rT||Ua.receiveShadow!==Ui.receiveShadow)&&(Ua.receiveShadow=Ui.receiveShadow,Wh.setValue(On,"receiveShadow",Ui.receiveShadow)),tr.isMeshGouraudMaterial&&null!==tr.envMap&&(Ex.envMap.value=ya,Ex.flipEnvMap.value=ya.isCubeTexture&&!1===ya.isRenderTargetTexture?-1:1),rT&&(Wh.setValue(On,"toneMappingExposure",Ce.toneMappingExposure),Ua.needsLights&&function WCe(mn,gi){mn.ambientLightColor.needsUpdate=gi,mn.lightProbe.needsUpdate=gi,mn.directionalLights.needsUpdate=gi,mn.directionalLightShadows.needsUpdate=gi,mn.pointLights.needsUpdate=gi,mn.pointLightShadows.needsUpdate=gi,mn.spotLights.needsUpdate=gi,mn.spotLightShadows.needsUpdate=gi,mn.rectAreaLights.needsUpdate=gi,mn.hemisphereLights.needsUpdate=gi}(Ex,uN),Ks&&!0===tr.fog&&Or.refreshFogUniforms(Ex,Ks),Or.refreshMaterialUniforms(Ex,tr,oi,zn,ms),bI.upload(On,DX(Ua),Ex,uo)),tr.isShaderMaterial&&!0===tr.uniformsNeedUpdate&&(bI.upload(On,DX(Ua),Ex,uo),tr.uniformsNeedUpdate=!1),tr.isSpriteMaterial&&Wh.setValue(On,"center",Ui.center),Wh.setValue(On,"modelViewMatrix",Ui.modelViewMatrix),Wh.setValue(On,"normalMatrix",Ui.normalMatrix),Wh.setValue(On,"modelMatrix",Ui.matrixWorld),tr.isShaderMaterial||tr.isRawShaderMaterial){const AA=tr.uniformsGroups;for(let fN=0,$Ce=AA.length;fN<$Ce;fN++)if(ls.isWebGL2){const PX=AA[fN];To.update(PX,Sx),To.bind(PX,Sx)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Sx}(mn,gi,$i,tr,Ui);Tr.setMaterial(tr,Do);let ya=$i.index,Qa=1;if(!0===tr.wireframe){if(ya=ar.getWireframeAttribute($i),void 0===ya)return;Qa=2}const Da=$i.drawRange,Fa=$i.attributes.position;let jd=Da.start*Qa,bm=(Da.start+Da.count)*Qa;null!==Ks&&(jd=Math.max(jd,Ks.start*Qa),bm=Math.min(bm,(Ks.start+Ks.count)*Qa)),null!==ya?(jd=Math.max(jd,0),bm=Math.min(bm,ya.count)):null!=Fa&&(jd=Math.max(jd,0),bm=Math.min(bm,Fa.count));const Zu=bm-jd;if(Zu<0||Zu===1/0)return;ho.setup(Ui,tr,la,$i,ya);let l1,ud=Sd;if(null!==ya&&(l1=Ht.get(ya),ud=qa,ud.setIndex(l1)),Ui.isMesh)!0===tr.wireframe?(Tr.setLineWidth(tr.wireframeLinewidth*lo()),ud.setMode(On.LINES)):ud.setMode(On.TRIANGLES);else if(Ui.isLine){let Ua=tr.linewidth;void 0===Ua&&(Ua=1),Tr.setLineWidth(Ua*lo()),ud.setMode(Ui.isLineSegments?On.LINES:Ui.isLineLoop?On.LINE_LOOP:On.LINE_STRIP)}else Ui.isPoints?ud.setMode(On.POINTS):Ui.isSprite&&ud.setMode(On.TRIANGLES);if(Ui.isBatchedMesh)ud.renderMultiDraw(Ui._multiDrawStarts,Ui._multiDrawCounts,Ui._multiDrawCount);else if(Ui.isInstancedMesh)ud.renderInstances(jd,Zu,Ui.count);else if($i.isInstancedBufferGeometry){const dN=Math.min($i.instanceCount,void 0!==$i._maxInstanceCount?$i._maxInstanceCount:1/0);ud.renderInstances(jd,Zu,dN)}else ud.render(jd,Zu)},this.compile=function(mn,gi,$i=null){null===$i&&($i=mn),se=Qo.get($i),se.init(),Te.push(se),$i.traverseVisible(function(Ui){Ui.isLight&&Ui.layers.test(gi.layers)&&(se.pushLight(Ui),Ui.castShadow&&se.pushShadow(Ui))}),mn!==$i&&mn.traverseVisible(function(Ui){Ui.isLight&&Ui.layers.test(gi.layers)&&(se.pushLight(Ui),Ui.castShadow&&se.pushShadow(Ui))}),se.setupLights(Ce._useLegacyLights);const tr=new Set;return mn.traverse(function(Ui){const Ks=Ui.material;if(Ks)if(Array.isArray(Ks))for(let Do=0;Do<Ks.length;Do++){const la=Ks[Do];Xa(la,$i,Ui),tr.add(la)}else Xa(Ks,$i,Ui),tr.add(Ks)}),Te.pop(),se=null,tr},this.compileAsync=function(mn,gi,$i=null){const tr=this.compile(mn,gi,$i);return new Promise(Ui=>{function Ks(){tr.forEach(function(Do){qs.get(Do).currentProgram.isReady()&&tr.delete(Do)}),0!==tr.size?setTimeout(Ks,10):Ui(mn)}null!==gr.get("KHR_parallel_shader_compile")?Ks():setTimeout(Ks,10)})};let jl=null;function Ed(){Qc.stop()}function Ml(){Qc.start()}const Qc=new pV;function Qh(mn,gi,$i,tr){if(!1===mn.visible)return;if(mn.layers.test(gi.layers))if(mn.isGroup)$i=mn.renderOrder;else if(mn.isLOD)!0===mn.autoUpdate&&mn.update(gi);else if(mn.isLight)se.pushLight(mn),mn.castShadow&&se.pushShadow(mn);else if(mn.isSprite){if(!mn.frustumCulled||$s.intersectsSprite(mn)){tr&&ws.setFromMatrixPosition(mn.matrixWorld).applyMatrix4(Fs);const Do=hr.update(mn),la=mn.material;la.visible&&re.push(mn,Do,la,$i,ws.z,null)}}else if((mn.isMesh||mn.isLine||mn.isPoints)&&(!mn.frustumCulled||$s.intersectsObject(mn))){const Do=hr.update(mn),la=mn.material;if(tr&&(void 0!==mn.boundingSphere?(null===mn.boundingSphere&&mn.computeBoundingSphere(),ws.copy(mn.boundingSphere.center)):(null===Do.boundingSphere&&Do.computeBoundingSphere(),ws.copy(Do.boundingSphere.center)),ws.applyMatrix4(mn.matrixWorld).applyMatrix4(Fs)),Array.isArray(la)){const ya=Do.groups;for(let Qa=0,Da=ya.length;Qa<Da;Qa++){const Fa=ya[Qa],jd=la[Fa.materialIndex];jd&&jd.visible&&re.push(mn,Do,jd,$i,ws.z,Fa)}}else la.visible&&re.push(mn,Do,la,$i,ws.z,null)}const Ks=mn.children;for(let Do=0,la=Ks.length;Do<la;Do++)Qh(Ks[Do],gi,$i,tr)}function Mx(mn,gi,$i,tr){const Ui=mn.opaque,Ks=mn.transmissive,Do=mn.transparent;se.setupLightsView($i),!0===fi&&As.setGlobalState(Ce.clippingPlanes,$i),Ks.length>0&&function EB(mn,gi,$i,tr){if(null!==(!0===$i.isScene?$i.overrideMaterial:null))return;const Ks=ls.isWebGL2;null===ms&&(ms=new ju(1,1,{generateMipmaps:!0,type:gr.has("EXT_color_buffer_half_float")?lA:ky,minFilter:oA,samples:Ks?4:0})),Ce.getDrawingBufferSize(Us),Ks?ms.setSize(Us.x,Us.y):ms.setSize(YD(Us.x),YD(Us.y));const Do=Ce.getRenderTarget();Ce.setRenderTarget(ms),Ce.getClearColor(Yi),En=Ce.getClearAlpha(),En<1&&Ce.setClearColor(16777215,.5),Ce.clear();const la=Ce.toneMapping;Ce.toneMapping=Iy,TB(mn,$i,tr),uo.updateMultisampleRenderTarget(ms),uo.updateRenderTargetMipmap(ms);let ya=!1;for(let Qa=0,Da=gi.length;Qa<Da;Qa++){const Fa=gi[Qa],jd=Fa.object,bm=Fa.geometry,Zu=Fa.material,l1=Fa.group;if(2===Zu.side&&jd.layers.test(tr.layers)){const ud=Zu.side;Zu.side=1,Zu.needsUpdate=!0,TX(jd,$i,tr,bm,Zu,l1),Zu.side=ud,Zu.needsUpdate=!0,ya=!0}}!0===ya&&(uo.updateMultisampleRenderTarget(ms),uo.updateRenderTargetMipmap(ms)),Ce.setRenderTarget(Do),Ce.setClearColor(Yi,En),Ce.toneMapping=la}(Ui,Ks,gi,$i),tr&&Tr.viewport(Ct.copy(tr)),Ui.length>0&&TB(Ui,gi,$i),Ks.length>0&&TB(Ks,gi,$i),Do.length>0&&TB(Do,gi,$i),Tr.buffers.depth.setTest(!0),Tr.buffers.depth.setMask(!0),Tr.buffers.color.setMask(!0),Tr.setPolygonOffset(!1)}function TB(mn,gi,$i){const tr=!0===gi.isScene?gi.overrideMaterial:null;for(let Ui=0,Ks=mn.length;Ui<Ks;Ui++){const Do=mn[Ui],la=Do.object,ya=Do.geometry,Qa=null===tr?Do.material:tr,Da=Do.group;la.layers.test($i.layers)&&TX(la,gi,$i,ya,Qa,Da)}}function TX(mn,gi,$i,tr,Ui,Ks){mn.onBeforeRender(Ce,gi,$i,tr,Ui,Ks),mn.modelViewMatrix.multiplyMatrices($i.matrixWorldInverse,mn.matrixWorld),mn.normalMatrix.getNormalMatrix(mn.modelViewMatrix),Ui.onBeforeRender(Ce,gi,$i,tr,mn,Ks),!0===Ui.transparent&&2===Ui.side&&!1===Ui.forceSinglePass?(Ui.side=1,Ui.needsUpdate=!0,Ce.renderBufferDirect($i,gi,tr,Ui,mn,Ks),Ui.side=0,Ui.needsUpdate=!0,Ce.renderBufferDirect($i,gi,tr,Ui,mn,Ks),Ui.side=2):Ce.renderBufferDirect($i,gi,tr,Ui,mn,Ks),mn.onAfterRender(Ce,gi,$i,tr,Ui,Ks)}function DB(mn,gi,$i){!0!==gi.isScene&&(gi=Co);const tr=qs.get(mn),Ui=se.state.lights,Do=Ui.state.version,la=$r.getParameters(mn,Ui.state,se.state.shadowsArray,gi,$i),ya=$r.getProgramCacheKey(la);let Qa=tr.programs;tr.environment=mn.isMeshStandardMaterial?gi.environment:null,tr.fog=gi.fog,tr.envMap=(mn.isMeshStandardMaterial?gn:ka).get(mn.envMap||tr.environment),tr.envMapRotation=null!==tr.environment&&null===mn.envMap?gi.environmentRotation:mn.envMapRotation,void 0===Qa&&(mn.addEventListener("dispose",ki),Qa=new Map,tr.programs=Qa);let Da=Qa.get(ya);if(void 0!==Da){if(tr.currentProgram===Da&&tr.lightsStateVersion===Do)return IX(mn,la),Da}else la.uniforms=$r.getUniforms(mn),mn.onBuild($i,la,Ce),mn.onBeforeCompile(la,Ce),Da=$r.acquireProgram(la,ya),Qa.set(ya,Da),tr.uniforms=la.uniforms;const Fa=tr.uniforms;return(!mn.isShaderMaterial&&!mn.isRawShaderMaterial||!0===mn.clipping)&&(Fa.clippingPlanes=As.uniform),IX(mn,la),tr.needsLights=function jCe(mn){return mn.isMeshLambertMaterial||mn.isMeshToonMaterial||mn.isMeshPhongMaterial||mn.isMeshStandardMaterial||mn.isShadowMaterial||mn.isShaderMaterial&&!0===mn.lights}(mn),tr.lightsStateVersion=Do,tr.needsLights&&(Fa.ambientLightColor.value=Ui.state.ambient,Fa.lightProbe.value=Ui.state.probe,Fa.directionalLights.value=Ui.state.directional,Fa.directionalLightShadows.value=Ui.state.directionalShadow,Fa.spotLights.value=Ui.state.spot,Fa.spotLightShadows.value=Ui.state.spotShadow,Fa.rectAreaLights.value=Ui.state.rectArea,Fa.ltc_1.value=Ui.state.rectAreaLTC1,Fa.ltc_2.value=Ui.state.rectAreaLTC2,Fa.pointLights.value=Ui.state.point,Fa.pointLightShadows.value=Ui.state.pointShadow,Fa.hemisphereLights.value=Ui.state.hemi,Fa.directionalShadowMap.value=Ui.state.directionalShadowMap,Fa.directionalShadowMatrix.value=Ui.state.directionalShadowMatrix,Fa.spotShadowMap.value=Ui.state.spotShadowMap,Fa.spotLightMatrix.value=Ui.state.spotLightMatrix,Fa.spotLightMap.value=Ui.state.spotLightMap,Fa.pointShadowMap.value=Ui.state.pointShadowMap,Fa.pointShadowMatrix.value=Ui.state.pointShadowMatrix),tr.currentProgram=Da,tr.uniformsList=null,Da}function DX(mn){if(null===mn.uniformsList){const gi=mn.currentProgram.getUniforms();mn.uniformsList=bI.seqWithValue(gi.seq,mn.uniforms)}return mn.uniformsList}function IX(mn,gi){const $i=qs.get(mn);$i.outputColorSpace=gi.outputColorSpace,$i.batching=gi.batching,$i.instancing=gi.instancing,$i.instancingColor=gi.instancingColor,$i.instancingMorph=gi.instancingMorph,$i.skinning=gi.skinning,$i.morphTargets=gi.morphTargets,$i.morphNormals=gi.morphNormals,$i.morphColors=gi.morphColors,$i.morphTargetsCount=gi.morphTargetsCount,$i.numClippingPlanes=gi.numClippingPlanes,$i.numIntersection=gi.numClipIntersection,$i.vertexAlphas=gi.vertexAlphas,$i.vertexTangents=gi.vertexTangents,$i.toneMapping=gi.toneMapping}Qc.setAnimationLoop(function pc(mn){jl&&jl(mn)}),typeof self<"u"&&Qc.setContext(self),this.setAnimationLoop=function(mn){jl=mn,Er.setAnimationLoop(mn),null===mn?Qc.stop():Qc.start()},Er.addEventListener("sessionstart",Ed),Er.addEventListener("sessionend",Ml),this.render=function(mn,gi){if(void 0===gi||!0===gi.isCamera){if(!0!==qe){if(!0===mn.matrixWorldAutoUpdate&&mn.updateMatrixWorld(),null===gi.parent&&!0===gi.matrixWorldAutoUpdate&&gi.updateMatrixWorld(),!0===Er.enabled&&!0===Er.isPresenting&&(!0===Er.cameraAutoUpdate&&Er.updateCamera(gi),gi=Er.getCamera()),!0===mn.isScene&&mn.onBeforeRender(Ce,mn,gi,Et),se=Qo.get(mn,Te.length),se.init(),Te.push(se),Fs.multiplyMatrices(gi.projectionMatrix,gi.matrixWorldInverse),$s.setFromProjectionMatrix(Fs),Rr=this.localClippingEnabled,fi=As.init(this.clippingPlanes,Rr),re=Aa.get(mn,ce.length),re.init(),ce.push(re),Qh(mn,gi,0,Ce.sortObjects),re.finish(),!0===Ce.sortObjects&&re.sort(hi,vi),this.info.render.frame++,!0===fi&&As.beginShadows(),Is.render(se.state.shadowsArray,mn,gi),!0===fi&&As.endShadows(),!0===this.info.autoReset&&this.info.reset(),(!1===Er.enabled||!1===Er.isPresenting||!1===Er.hasDepthSensing())&&ga.render(re,mn),se.setupLights(Ce._useLegacyLights),gi.isArrayCamera){const tr=gi.cameras;for(let Ui=0,Ks=tr.length;Ui<Ks;Ui++){const Do=tr[Ui];Mx(re,mn,Do,Do.viewport)}}else Mx(re,mn,gi);null!==Et&&(uo.updateMultisampleRenderTarget(Et),uo.updateRenderTargetMipmap(Et)),!0===mn.isScene&&mn.onAfterRender(Ce,mn,gi),ho.resetDefaultState(),Xt=-1,Un=null,Te.pop(),se=Te.length>0?Te[Te.length-1]:null,ce.pop(),re=ce.length>0?ce[ce.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return wt},this.getActiveMipmapLevel=function(){return gt},this.getRenderTarget=function(){return Et},this.setRenderTargetTextures=function(mn,gi,$i){qs.get(mn.texture).__webglTexture=gi,qs.get(mn.depthTexture).__webglTexture=$i;const tr=qs.get(mn);tr.__hasExternalTextures=!0,tr.__autoAllocateDepthBuffer=void 0===$i,tr.__autoAllocateDepthBuffer||!0===gr.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),tr.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(mn,gi){const $i=qs.get(mn);$i.__webglFramebuffer=gi,$i.__useDefaultFramebuffer=void 0===gi},this.setRenderTarget=function(mn,gi=0,$i=0){Et=mn,wt=gi,gt=$i;let tr=!0,Ui=null,Ks=!1,Do=!1;if(mn){const ya=qs.get(mn);void 0!==ya.__useDefaultFramebuffer?(Tr.bindFramebuffer(On.FRAMEBUFFER,null),tr=!1):void 0===ya.__webglFramebuffer?uo.setupRenderTarget(mn):ya.__hasExternalTextures&&uo.rebindTextures(mn,qs.get(mn.texture).__webglTexture,qs.get(mn.depthTexture).__webglTexture);const Qa=mn.texture;(Qa.isData3DTexture||Qa.isDataArrayTexture||Qa.isCompressedArrayTexture)&&(Do=!0);const Da=qs.get(mn).__webglFramebuffer;mn.isWebGLCubeRenderTarget?(Ui=Array.isArray(Da[gi])?Da[gi][$i]:Da[gi],Ks=!0):Ui=ls.isWebGL2&&mn.samples>0&&!1===uo.useMultisampledRTT(mn)?qs.get(mn).__webglMultisampledFramebuffer:Array.isArray(Da)?Da[$i]:Da,Ct.copy(mn.viewport),Kt.copy(mn.scissor),Gi=mn.scissorTest}else Ct.copy(mr).multiplyScalar(oi).floor(),Kt.copy(Mr).multiplyScalar(oi).floor(),Gi=is;if(Tr.bindFramebuffer(On.FRAMEBUFFER,Ui)&&ls.drawBuffers&&tr&&Tr.drawBuffers(mn,Ui),Tr.viewport(Ct),Tr.scissor(Kt),Tr.setScissorTest(Gi),Ks){const ya=qs.get(mn.texture);On.framebufferTexture2D(On.FRAMEBUFFER,On.COLOR_ATTACHMENT0,On.TEXTURE_CUBE_MAP_POSITIVE_X+gi,ya.__webglTexture,$i)}else if(Do){const ya=qs.get(mn.texture);On.framebufferTextureLayer(On.FRAMEBUFFER,On.COLOR_ATTACHMENT0,ya.__webglTexture,$i||0,gi||0)}Xt=-1},this.readRenderTargetPixels=function(mn,gi,$i,tr,Ui,Ks,Do){if(!mn||!mn.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let la=qs.get(mn).__webglFramebuffer;if(mn.isWebGLCubeRenderTarget&&void 0!==Do&&(la=la[Do]),la){Tr.bindFramebuffer(On.FRAMEBUFFER,la);try{const ya=mn.texture,Qa=ya.format,Da=ya.type;if(Qa!==gp&&Ro.convert(Qa)!==On.getParameter(On.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const Fa=Da===lA&&(gr.has("EXT_color_buffer_half_float")||ls.isWebGL2&&gr.has("EXT_color_buffer_float"));if(!(Da===ky||Ro.convert(Da)===On.getParameter(On.IMPLEMENTATION_COLOR_READ_TYPE)||Da===aA&&(ls.isWebGL2||gr.has("OES_texture_float")||gr.has("WEBGL_color_buffer_float"))||Fa))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");gi>=0&&gi<=mn.width-tr&&$i>=0&&$i<=mn.height-Ui&&On.readPixels(gi,$i,tr,Ui,Ro.convert(Qa),Ro.convert(Da),Ks)}finally{const ya=null!==Et?qs.get(Et).__webglFramebuffer:null;Tr.bindFramebuffer(On.FRAMEBUFFER,ya)}}},this.copyFramebufferToTexture=function(mn,gi,$i=0){const tr=Math.pow(2,-$i),Ui=Math.floor(gi.image.width*tr),Ks=Math.floor(gi.image.height*tr);uo.setTexture2D(gi,0),On.copyTexSubImage2D(On.TEXTURE_2D,$i,0,0,mn.x,mn.y,Ui,Ks),Tr.unbindTexture()},this.copyTextureToTexture=function(mn,gi,$i,tr=0){const Ui=gi.image.width,Ks=gi.image.height,Do=Ro.convert($i.format),la=Ro.convert($i.type);uo.setTexture2D($i,0),On.pixelStorei(On.UNPACK_FLIP_Y_WEBGL,$i.flipY),On.pixelStorei(On.UNPACK_PREMULTIPLY_ALPHA_WEBGL,$i.premultiplyAlpha),On.pixelStorei(On.UNPACK_ALIGNMENT,$i.unpackAlignment),gi.isDataTexture?On.texSubImage2D(On.TEXTURE_2D,tr,mn.x,mn.y,Ui,Ks,Do,la,gi.image.data):gi.isCompressedTexture?On.compressedTexSubImage2D(On.TEXTURE_2D,tr,mn.x,mn.y,gi.mipmaps[0].width,gi.mipmaps[0].height,Do,gi.mipmaps[0].data):On.texSubImage2D(On.TEXTURE_2D,tr,mn.x,mn.y,Do,la,gi.image),0===tr&&$i.generateMipmaps&&On.generateMipmap(On.TEXTURE_2D),Tr.unbindTexture()},this.copyTextureToTexture3D=function(mn,gi,$i,tr,Ui=0){if(Ce.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Ks=Math.round(mn.max.x-mn.min.x),Do=Math.round(mn.max.y-mn.min.y),la=mn.max.z-mn.min.z+1,ya=Ro.convert(tr.format),Qa=Ro.convert(tr.type);let Da;if(tr.isData3DTexture)uo.setTexture3D(tr,0),Da=On.TEXTURE_3D;else{if(!tr.isDataArrayTexture&&!tr.isCompressedArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");uo.setTexture2DArray(tr,0),Da=On.TEXTURE_2D_ARRAY}On.pixelStorei(On.UNPACK_FLIP_Y_WEBGL,tr.flipY),On.pixelStorei(On.UNPACK_PREMULTIPLY_ALPHA_WEBGL,tr.premultiplyAlpha),On.pixelStorei(On.UNPACK_ALIGNMENT,tr.unpackAlignment);const Fa=On.getParameter(On.UNPACK_ROW_LENGTH),jd=On.getParameter(On.UNPACK_IMAGE_HEIGHT),bm=On.getParameter(On.UNPACK_SKIP_PIXELS),Zu=On.getParameter(On.UNPACK_SKIP_ROWS),l1=On.getParameter(On.UNPACK_SKIP_IMAGES),ud=$i.isCompressedTexture?$i.mipmaps[Ui]:$i.image;On.pixelStorei(On.UNPACK_ROW_LENGTH,ud.width),On.pixelStorei(On.UNPACK_IMAGE_HEIGHT,ud.height),On.pixelStorei(On.UNPACK_SKIP_PIXELS,mn.min.x),On.pixelStorei(On.UNPACK_SKIP_ROWS,mn.min.y),On.pixelStorei(On.UNPACK_SKIP_IMAGES,mn.min.z),$i.isDataTexture||$i.isData3DTexture?On.texSubImage3D(Da,Ui,gi.x,gi.y,gi.z,Ks,Do,la,ya,Qa,ud.data):tr.isCompressedArrayTexture?On.compressedTexSubImage3D(Da,Ui,gi.x,gi.y,gi.z,Ks,Do,la,ya,ud.data):On.texSubImage3D(Da,Ui,gi.x,gi.y,gi.z,Ks,Do,la,ya,Qa,ud),On.pixelStorei(On.UNPACK_ROW_LENGTH,Fa),On.pixelStorei(On.UNPACK_IMAGE_HEIGHT,jd),On.pixelStorei(On.UNPACK_SKIP_PIXELS,bm),On.pixelStorei(On.UNPACK_SKIP_ROWS,Zu),On.pixelStorei(On.UNPACK_SKIP_IMAGES,l1),0===Ui&&tr.generateMipmaps&&On.generateMipmap(Da),Tr.unbindTexture()},this.initTexture=function(mn){mn.isCubeTexture?uo.setTextureCube(mn,0):mn.isData3DTexture?uo.setTexture3D(mn,0):mn.isDataArrayTexture||mn.isCompressedArrayTexture?uo.setTexture2DArray(mn,0):uo.setTexture2D(mn,0),Tr.unbindTexture()},this.resetState=function(){wt=0,gt=0,Et=null,Tr.reset(),ho.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return H_}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===Kk?"display-p3":"srgb",t.unpackColorSpace=Ol.workingColorSpace===qD?"display-p3":"srgb"}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}(class xfe extends xI{}).prototype.isWebGL1Renderer=!0;class k5{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Cr(e),this.density=t}clone(){return new k5(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class F5{constructor(e,t=1,i=1e3){this.isFog=!0,this.name="",this.color=new Cr(e),this.near=t,this.far=i}clone(){return new F5(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class YS extends Pl{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new M0,this.environmentRotation=new M0,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentRotation.copy(e.environmentRotation),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class wI{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=dm()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}get updateRange(){return qH("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=dm()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=dm()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const kf=new It;class Gb{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)kf.fromBufferAttribute(this,t),kf.applyMatrix4(e),this.setXYZ(t,kf.x,kf.y,kf.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)kf.fromBufferAttribute(this,t),kf.applyNormalMatrix(e),this.setXYZ(t,kf.x,kf.y,kf.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)kf.fromBufferAttribute(this,t),kf.transformDirection(e),this.setXYZ(t,kf.x,kf.y,kf.z);return this}getComponent(e,t){let i=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(i=Bf(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=Ea(i,this.array)),this.data.array[e*this.data.stride+this.offset+t]=i,this}setX(e,t){return this.normalized&&(t=Ea(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Ea(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Ea(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Ea(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Bf(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Bf(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Bf(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Bf(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Ea(t,this.array),i=Ea(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Ea(t,this.array),i=Ea(i,this.array),r=Ea(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Ea(t,this.array),i=Ea(i,this.array),r=Ea(r,this.array),s=Ea(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new No(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Gb(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class QV extends ld{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Cr(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Y2;const KS=new It,K2=new It,Z2=new It,J2=new Qi,ZS=new Qi,WV=new wo,CI=new It,JS=new It,MI=new It,jV=new Qi,O5=new Qi,$V=new Qi;class wfe extends Pl{constructor(e=new QV){if(super(),this.isSprite=!0,this.type="Sprite",void 0===Y2){Y2=new no;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new wI(t,5);Y2.setIndex([0,1,2,0,2,3]),Y2.setAttribute("position",new Gb(i,3,0,!1)),Y2.setAttribute("uv",new Gb(i,2,3,!1))}this.geometry=Y2,this.material=e,this.center=new Qi(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),K2.setFromMatrixScale(this.matrixWorld),WV.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Z2.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&K2.multiplyScalar(-Z2.z);const i=this.material.rotation;let r,s;0!==i&&(s=Math.cos(i),r=Math.sin(i));const a=this.center;SI(CI.set(-.5,-.5,0),Z2,a,K2,r,s),SI(JS.set(.5,-.5,0),Z2,a,K2,r,s),SI(MI.set(.5,.5,0),Z2,a,K2,r,s),jV.set(0,0),O5.set(1,0),$V.set(1,1);let l=e.ray.intersectTriangle(CI,JS,MI,!1,KS);if(null===l&&(SI(JS.set(-.5,.5,0),Z2,a,K2,r,s),O5.set(0,1),l=e.ray.intersectTriangle(CI,MI,JS,!1,KS),null===l))return;const d=e.ray.origin.distanceTo(KS);d<e.near||d>e.far||t.push({distance:d,point:KS.clone(),uv:hm.getInterpolation(KS,CI,JS,MI,jV,O5,$V,new Qi),face:null,object:this})}copy(e,t){return super.copy(e,t),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function SI(n,e,t,i,r,s){J2.subVectors(n,t).addScalar(.5).multiply(i),void 0!==r?(ZS.x=s*J2.x-r*J2.y,ZS.y=r*J2.x+s*J2.y):ZS.copy(J2),n.copy(e),n.x+=ZS.x,n.y+=ZS.y,n.applyMatrix4(WV)}const EI=new It,XV=new It;class Cfe extends Pl{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let i=0,r=t.length;i<r;i++){const s=t[i];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,i=0){t=Math.abs(t);const r=this.levels;let s;for(s=0;s<r.length&&!(t<r[s].distance);s++);return r.splice(s,0,{distance:t,hysteresis:i,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let i,r;for(i=1,r=t.length;i<r;i++){let s=t[i].distance;if(t[i].object.visible&&(s-=s*t[i].hysteresis),e<s)break}return t[i-1].object}return null}raycast(e,t){if(this.levels.length>0){EI.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(EI);this.getObjectForDistance(r).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){EI.setFromMatrixPosition(e.matrixWorld),XV.setFromMatrixPosition(this.matrixWorld);const i=EI.distanceTo(XV)/e.zoom;let r,s;for(t[0].object.visible=!0,r=1,s=t.length;r<s;r++){let a=t[r].distance;if(t[r].object.visible&&(a-=a*t[r].hysteresis),!(i>=a))break;t[r-1].object.visible=!1,t[r].object.visible=!0}for(this._currentLevel=r-1;r<s;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];const i=this.levels;for(let r=0,s=i.length;r<s;r++){const a=i[r];t.object.levels.push({object:a.object.uuid,distance:a.distance,hysteresis:a.hysteresis})}return t}}const YV=new It,KV=new nc,ZV=new nc,Mfe=new It,JV=new wo,TI=new It,L5=new $u,eG=new wo,N5=new P2;class tG extends ua{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=tH,this.bindMatrix=new wo,this.bindMatrixInverse=new wo,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new Pf),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,TI),this.boundingBox.expandByPoint(TI)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new $u),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,TI),this.boundingSphere.expandByPoint(TI)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const r=this.matrixWorld;void 0!==this.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),L5.copy(this.boundingSphere),L5.applyMatrix4(r),!1!==e.ray.intersectsSphere(L5)&&(eG.copy(r).invert(),N5.copy(e.ray).applyMatrix4(eG),(null===this.boundingBox||!1!==N5.intersectsBox(this.boundingBox))&&this._computeIntersections(e,t,N5)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new nc,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===tH?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const i=this.skeleton,r=this.geometry;KV.fromBufferAttribute(r.attributes.skinIndex,e),ZV.fromBufferAttribute(r.attributes.skinWeight,e),YV.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const a=ZV.getComponent(s);if(0!==a){const l=KV.getComponent(s);JV.multiplyMatrices(i.bones[l].matrixWorld,i.boneInverses[l]),t.addScaledVector(Mfe.copy(YV).applyMatrix4(JV),a)}}return t.applyMatrix4(this.bindMatrixInverse)}}class U5 extends Pl{constructor(){super(),this.isBone=!0,this.type="Bone"}}class qb extends zh{constructor(e=null,t=1,i=1,r,s,a,l,d,u=vd,p=vd,_,S){super(null,a,l,d,u,p,r,s,_,S),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const nG=new wo,Sfe=new wo;class DI{constructor(e=[],t=[]){this.uuid=dm(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new wo)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new wo;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,a=e.length;s<a;s++)nG.multiplyMatrices(e[s]?e[s].matrixWorld:Sfe,t[s]),nG.toArray(i,16*s);null!==r&&(r.needsUpdate=!0)}clone(){return new DI(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=4*Math.ceil(e/4),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new qb(t,e,e,gp,aA);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let a=t[s];void 0===a&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),a=new U5),this.bones.push(a),this.boneInverses.push((new wo).fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++)e.bones.push(t[r].uuid),e.boneInverses.push(i[r].toArray());return e}}class eC extends No{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const tC=new wo,iG=new wo,II=[],rG=new Pf,Efe=new wo,eE=new ua,tE=new $u;class sG extends ua{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new eC(new Float32Array(16*i),16),this.instanceColor=null,this.morphTexture=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,Efe)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new Pf),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,tC),rG.copy(e.boundingBox).applyMatrix4(tC),this.boundingBox.union(rG)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new $u),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,tC),tE.copy(e.boundingSphere).applyMatrix4(tC),this.boundingSphere.union(tE)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}getMorphAt(e,t){const i=t.morphTargetInfluences,r=this.morphTexture.source.data.data,a=e*(i.length+1)+1;for(let l=0;l<i.length;l++)i[l]=r[a+l]}raycast(e,t){const i=this.matrixWorld,r=this.count;if(eE.geometry=this.geometry,eE.material=this.material,void 0!==eE.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),tE.copy(this.boundingSphere),tE.applyMatrix4(i),!1!==e.ray.intersectsSphere(tE)))for(let s=0;s<r;s++){this.getMatrixAt(s,tC),iG.multiplyMatrices(i,tC),eE.matrixWorld=iG,eE.raycast(e,II);for(let a=0,l=II.length;a<l;a++){const d=II[a];d.instanceId=s,d.object=this,t.push(d)}II.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new eC(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}setMorphAt(e,t){const i=t.morphTargetInfluences,r=i.length+1;null===this.morphTexture&&(this.morphTexture=new qb(new Float32Array(r*this.count),r,this.count,1028,aA));const s=this.morphTexture.source.data.data;let a=0;for(let u=0;u<i.length;u++)a+=i[u];const d=r*e;s[d]=this.geometry.morphTargetsRelative?1:1-a,s.set(i,d+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}function Tfe(n,e){return n.z-e.z}function Dfe(n,e){return e.z-n.z}class Ife{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t){const i=this.pool,r=this.list;this.index>=i.length&&i.push({start:-1,count:-1,z:-1});const s=i[this.index];r.push(s),this.index++,s.start=e.start,s.count=e.count,s.z=t}reset(){this.list.length=0,this.index=0}}const nC="batchId",Vy=new wo,oG=new wo,Bfe=new wo,aG=new wo,z5=new gI,BI=new Pf,Qb=new $u,nE=new It,H5=new Ife,Vh=new ua,PI=[];function Pfe(n,e,t=0){const i=e.itemSize;if(n.isInterleavedBufferAttribute||n.array.constructor!==e.array.constructor){const r=n.count;for(let s=0;s<r;s++)for(let a=0;a<i;a++)e.setComponent(s+t,a,n.getComponent(s,a))}else e.array.set(n.array,t*i);e.needsUpdate=!0}class Rfe extends ua{get maxGeometryCount(){return this._maxGeometryCount}constructor(e,t,i=2*t,r){super(new no,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawRanges=[],this._reservedRanges=[],this._visibility=[],this._active=[],this._bounds=[],this._maxGeometryCount=e,this._maxVertexCount=t,this._maxIndexCount=i,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._visibilityChanged=!0,this._matricesTexture=null,this._initMatricesTexture()}_initMatricesTexture(){let e=Math.sqrt(4*this._maxGeometryCount);e=4*Math.ceil(e/4),e=Math.max(e,4);const t=new Float32Array(e*e*4),i=new qb(t,e,e,gp,aA);this._matricesTexture=i}_initializeGeometry(e){const t=this.geometry,i=this._maxVertexCount,r=this._maxGeometryCount,s=this._maxIndexCount;if(!1===this._geometryInitialized){for(const l in e.attributes){const d=e.getAttribute(l),{array:u,itemSize:p,normalized:_}=d,S=new u.constructor(i*p),R=new d.constructor(S,p,_);R.setUsage(d.usage),t.setAttribute(l,R)}if(null!==e.getIndex()){const l=i>65536?new Uint32Array(s):new Uint16Array(s);t.setIndex(new No(l,1))}const a=r>65536?new Uint32Array(i):new Uint16Array(i);t.setAttribute(nC,new No(a,1)),this._geometryInitialized=!0}}_validateGeometry(e){if(e.getAttribute(nC))throw new Error(`BatchedMesh: Geometry cannot use attribute "${nC}"`);const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const i in t.attributes){if(i===nC)continue;if(!e.hasAttribute(i))throw new Error(`BatchedMesh: Added geometry missing "${i}". All geometries must have consistent attributes.`);const r=e.getAttribute(i),s=t.getAttribute(i);if(r.itemSize!==s.itemSize||r.normalized!==s.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Pf);const e=this._geometryCount,t=this.boundingBox,i=this._active;t.makeEmpty();for(let r=0;r<e;r++)!1!==i[r]&&(this.getMatrixAt(r,Vy),this.getBoundingBoxAt(r,BI).applyMatrix4(Vy),t.union(BI))}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new $u);const e=this._geometryCount,t=this.boundingSphere,i=this._active;t.makeEmpty();for(let r=0;r<e;r++)!1!==i[r]&&(this.getMatrixAt(r,Vy),this.getBoundingSphereAt(r,Qb).applyMatrix4(Vy),t.union(Qb))}addGeometry(e,t=-1,i=-1){if(this._initializeGeometry(e),this._validateGeometry(e),this._geometryCount>=this._maxGeometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");const r={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let s=null;const a=this._reservedRanges,l=this._drawRanges,d=this._bounds;0!==this._geometryCount&&(s=a[a.length-1]),r.vertexCount=-1===t?e.getAttribute("position").count:t,r.vertexStart=null===s?0:s.vertexStart+s.vertexCount;const u=e.getIndex(),p=null!==u;if(p&&(r.indexCount=-1===i?u.count:i,r.indexStart=null===s?0:s.indexStart+s.indexCount),-1!==r.indexStart&&r.indexStart+r.indexCount>this._maxIndexCount||r.vertexStart+r.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const S=this._active,R=this._matricesTexture,H=this._matricesTexture.image.data;this._visibility.push(!0),S.push(!0);const re=this._geometryCount;this._geometryCount++,Bfe.toArray(H,16*re),R.needsUpdate=!0,a.push(r),l.push({start:p?r.indexStart:r.vertexStart,count:-1}),d.push({boxInitialized:!1,box:new Pf,sphereInitialized:!1,sphere:new $u});const se=this.geometry.getAttribute(nC);for(let ce=0;ce<r.vertexCount;ce++)se.setX(r.vertexStart+ce,re);return se.needsUpdate=!0,this.setGeometryAt(re,e),re}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const i=this.geometry,r=null!==i.getIndex(),s=i.getIndex(),a=t.getIndex(),l=this._reservedRanges[e];if(r&&a.count>l.indexCount||t.attributes.position.count>l.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const d=l.vertexStart,u=l.vertexCount;for(const R in i.attributes){if(R===nC)continue;const H=t.getAttribute(R),re=i.getAttribute(R);Pfe(H,re,d);const se=H.itemSize;for(let ce=H.count,Te=u;ce<Te;ce++){const Ce=d+ce;for(let qe=0;qe<se;qe++)re.setComponent(Ce,qe,0)}re.needsUpdate=!0}if(r){const R=l.indexStart;for(let H=0;H<a.count;H++)s.setX(R+H,d+a.getX(H));for(let H=a.count,re=l.indexCount;H<re;H++)s.setX(R+H,d);s.needsUpdate=!0}const p=this._bounds[e];null!==t.boundingBox?(p.box.copy(t.boundingBox),p.boxInitialized=!0):p.boxInitialized=!1,null!==t.boundingSphere?(p.sphere.copy(t.boundingSphere),p.sphereInitialized=!0):p.sphereInitialized=!1;const _=this._drawRanges[e],S=t.getAttribute("position");return _.count=r?a.count:S.count,this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._active;return e>=t.length||!1===t[e]||(t[e]=!1,this._visibilityChanged=!0),this}getBoundingBoxAt(e,t){if(!1===this._active[e])return null;const r=this._bounds[e],s=r.box,a=this.geometry;if(!1===r.boxInitialized){s.makeEmpty();const l=a.index,d=a.attributes.position,u=this._drawRanges[e];for(let p=u.start,_=u.start+u.count;p<_;p++){let S=p;l&&(S=l.getX(S)),s.expandByPoint(nE.fromBufferAttribute(d,S))}r.boxInitialized=!0}return t.copy(s),t}getBoundingSphereAt(e,t){if(!1===this._active[e])return null;const r=this._bounds[e],s=r.sphere,a=this.geometry;if(!1===r.sphereInitialized){s.makeEmpty(),this.getBoundingBoxAt(e,BI),BI.getCenter(s.center);const l=a.index,d=a.attributes.position,u=this._drawRanges[e];let p=0;for(let _=u.start,S=u.start+u.count;_<S;_++){let R=_;l&&(R=l.getX(R)),nE.fromBufferAttribute(d,R),p=Math.max(p,s.center.distanceToSquared(nE))}s.radius=Math.sqrt(p),r.sphereInitialized=!0}return t.copy(s),t}setMatrixAt(e,t){const r=this._matricesTexture;return e>=this._geometryCount||!1===this._active[e]||(t.toArray(this._matricesTexture.image.data,16*e),r.needsUpdate=!0),this}getMatrixAt(e,t){return e>=this._geometryCount||!1===this._active[e]?null:t.fromArray(this._matricesTexture.image.data,16*e)}setVisibleAt(e,t){const i=this._visibility;return e>=this._geometryCount||!1===this._active[e]||i[e]===t||(i[e]=t,this._visibilityChanged=!0),this}getVisibleAt(e){return!(e>=this._geometryCount||!1===this._active[e])&&this._visibility[e]}raycast(e,t){const i=this._visibility,r=this._active,s=this._drawRanges,a=this._geometryCount,l=this.matrixWorld,d=this.geometry;Vh.material=this.material,Vh.geometry.index=d.index,Vh.geometry.attributes=d.attributes,null===Vh.geometry.boundingBox&&(Vh.geometry.boundingBox=new Pf),null===Vh.geometry.boundingSphere&&(Vh.geometry.boundingSphere=new $u);for(let u=0;u<a;u++){if(!i[u]||!r[u])continue;const p=s[u];Vh.geometry.setDrawRange(p.start,p.count),this.getMatrixAt(u,Vh.matrixWorld).premultiply(l),this.getBoundingBoxAt(u,Vh.geometry.boundingBox),this.getBoundingSphereAt(u,Vh.geometry.boundingSphere),Vh.raycast(e,PI);for(let _=0,S=PI.length;_<S;_++){const R=PI[_];R.object=this,R.batchId=u,t.push(R)}PI.length=0}Vh.material=null,Vh.geometry.index=null,Vh.geometry.attributes={},Vh.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=null!==e.boundingBox?e.boundingBox.clone():null,this.boundingSphere=null!==e.boundingSphere?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(t=>({...t})),this._reservedRanges=e._reservedRanges.map(t=>({...t})),this._visibility=e._visibility.slice(),this._active=e._active.slice(),this._bounds=e._bounds.map(t=>({boxInitialized:t.boxInitialized,box:t.box.clone(),sphereInitialized:t.sphereInitialized,sphere:t.sphere.clone()})),this._maxGeometryCount=e._maxGeometryCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this}onBeforeRender(e,t,i,r,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const a=r.getIndex(),l=null===a?1:a.array.BYTES_PER_ELEMENT,d=this._active,u=this._visibility,p=this._multiDrawStarts,_=this._multiDrawCounts,S=this._drawRanges,R=this.perObjectFrustumCulled;R&&(aG.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse).multiply(this.matrixWorld),z5.setFromProjectionMatrix(aG,e.coordinateSystem));let H=0;if(this.sortObjects){oG.copy(this.matrixWorld).invert(),nE.setFromMatrixPosition(i.matrixWorld).applyMatrix4(oG);for(let ce=0,Te=u.length;ce<Te;ce++)if(u[ce]&&d[ce]){this.getMatrixAt(ce,Vy),this.getBoundingSphereAt(ce,Qb).applyMatrix4(Vy);let Ce=!1;if(R&&(Ce=!z5.intersectsSphere(Qb)),!Ce){const qe=nE.distanceTo(Qb.center);H5.push(S[ce],qe)}}const re=H5.list,se=this.customSort;null===se?re.sort(s.transparent?Dfe:Tfe):se.call(this,re,i);for(let ce=0,Te=re.length;ce<Te;ce++){const Ce=re[ce];p[H]=Ce.start*l,_[H]=Ce.count,H++}H5.reset()}else for(let re=0,se=u.length;re<se;re++)if(u[re]&&d[re]){let ce=!1;if(R&&(this.getMatrixAt(re,Vy),this.getBoundingSphereAt(re,Qb).applyMatrix4(Vy),ce=!z5.intersectsSphere(Qb)),!ce){const Te=S[re];p[H]=Te.start*l,_[H]=Te.count,H++}}this._multiDrawCount=H,this._visibilityChanged=!1}onBeforeShadow(e,t,i,r,s,a){this.onBeforeRender(e,null,r,s,a)}}class Dc extends ld{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Cr(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const lG=new It,cG=new It,dG=new wo,V5=new P2,RI=new $u;class fg extends Pl{constructor(e=new no,t=new Dc){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)lG.fromBufferAttribute(t,r-1),cG.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=lG.distanceTo(cG);e.setAttribute("lineDistance",new Ws(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,a=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),RI.copy(i.boundingSphere),RI.applyMatrix4(r),RI.radius+=s,!1===e.ray.intersectsSphere(RI))return;dG.copy(r).invert(),V5.copy(e.ray).applyMatrix4(dG);const l=s/((this.scale.x+this.scale.y+this.scale.z)/3),d=l*l,u=new It,p=new It,_=new It,S=new It,R=this.isLineSegments?2:1,H=i.index,se=i.attributes.position;if(null!==H)for(let Ce=Math.max(0,a.start),qe=Math.min(H.count,a.start+a.count)-1;Ce<qe;Ce+=R){const wt=H.getX(Ce),gt=H.getX(Ce+1);if(u.fromBufferAttribute(se,wt),p.fromBufferAttribute(se,gt),V5.distanceSqToSegment(u,p,S,_)>d)continue;S.applyMatrix4(this.matrixWorld);const Xt=e.ray.origin.distanceTo(S);Xt<e.near||Xt>e.far||t.push({distance:Xt,point:_.clone().applyMatrix4(this.matrixWorld),index:Ce,face:null,faceIndex:null,object:this})}else for(let Ce=Math.max(0,a.start),qe=Math.min(se.count,a.start+a.count)-1;Ce<qe;Ce+=R){if(u.fromBufferAttribute(se,Ce),p.fromBufferAttribute(se,Ce+1),V5.distanceSqToSegment(u,p,S,_)>d)continue;S.applyMatrix4(this.matrixWorld);const gt=e.ray.origin.distanceTo(S);gt<e.near||gt>e.far||t.push({distance:gt,point:_.clone().applyMatrix4(this.matrixWorld),index:Ce,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const l=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=s}}}}}const uG=new It,hG=new It;class hc extends fg{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)uG.fromBufferAttribute(t,r),hG.fromBufferAttribute(t,r+1),i[r]=0===r?0:i[r-1],i[r+1]=i[r]+uG.distanceTo(hG);e.setAttribute("lineDistance",new Ws(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class fG extends fg{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class X_ extends ld{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Cr(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const pG=new wo,G5=new P2,kI=new $u,FI=new It;class Wb extends Pl{constructor(e=new no,t=new X_){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,a=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),kI.copy(i.boundingSphere),kI.applyMatrix4(r),kI.radius+=s,!1===e.ray.intersectsSphere(kI))return;pG.copy(r).invert(),G5.copy(e.ray).applyMatrix4(pG);const l=s/((this.scale.x+this.scale.y+this.scale.z)/3),d=l*l,u=i.index,_=i.attributes.position;if(null!==u)for(let H=Math.max(0,a.start),re=Math.min(u.count,a.start+a.count);H<re;H++){const se=u.getX(H);FI.fromBufferAttribute(_,se),mG(FI,se,d,r,e,t,this)}else for(let H=Math.max(0,a.start),re=Math.min(_.count,a.start+a.count);H<re;H++)FI.fromBufferAttribute(_,H),mG(FI,H,d,r,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const l=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=s}}}}}function mG(n,e,t,i,r,s,a){const l=G5.distanceSqToPoint(n);if(l<t){const d=new It;G5.closestPointToPoint(n,d),d.applyMatrix4(i);const u=r.ray.origin.distanceTo(d);if(u<r.near||u>r.far)return;s.push({distance:u,distanceToRay:Math.sqrt(l),point:d,index:e,face:null,object:a})}}class iC extends zh{constructor(e,t,i,r,s,a,l,d,u,p,_,S){super(null,a,l,d,u,p,r,s,_,S),this.isCompressedTexture=!0,this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class AG extends zh{constructor(e,t,i,r,s,a,l,d,u){super(e,t,i,r,s,a,l,d,u),this.isCanvasTexture=!0,this.needsUpdate=!0}}class E0{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,r=this.getPoint(0),s=0;t.push(0);for(let a=1;a<=e;a++)i=this.getPoint(a/e),s+=i.distanceTo(r),t.push(s),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const i=this.getLengths();let r=0;const s=i.length;let a;a=t||e*i[s-1];let u,l=0,d=s-1;for(;l<=d;)if(r=Math.floor(l+(d-l)/2),u=i[r]-a,u<0)l=r+1;else{if(!(u>0)){d=r;break}d=r-1}if(r=d,i[r]===a)return r/(s-1);const p=i[r];return(r+(a-p)/(i[r+1]-p))/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const a=this.getPoint(r),l=this.getPoint(s),d=t||(a.isVector2?new Qi:new It);return d.copy(l).sub(a).normalize(),d}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){const i=new It,r=[],s=[],a=[],l=new It,d=new wo;for(let R=0;R<=e;R++)r[R]=this.getTangentAt(R/e,new It);s[0]=new It,a[0]=new It;let u=Number.MAX_VALUE;const p=Math.abs(r[0].x),_=Math.abs(r[0].y),S=Math.abs(r[0].z);p<=u&&(u=p,i.set(1,0,0)),_<=u&&(u=_,i.set(0,1,0)),S<=u&&i.set(0,0,1),l.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],l),a[0].crossVectors(r[0],s[0]);for(let R=1;R<=e;R++){if(s[R]=s[R-1].clone(),a[R]=a[R-1].clone(),l.crossVectors(r[R-1],r[R]),l.length()>Number.EPSILON){l.normalize();const H=Math.acos(bd(r[R-1].dot(r[R]),-1,1));s[R].applyMatrix4(d.makeRotationAxis(l,H))}a[R].crossVectors(r[R],s[R])}if(!0===t){let R=Math.acos(bd(s[0].dot(s[e]),-1,1));R/=e,r[0].dot(l.crossVectors(s[0],s[e]))>0&&(R=-R);for(let H=1;H<=e;H++)s[H].applyMatrix4(d.makeRotationAxis(r[H],R*H)),a[H].crossVectors(r[H],s[H])}return{tangents:r,normals:s,binormals:a}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class q5 extends E0{constructor(e=0,t=0,i=1,r=1,s=0,a=2*Math.PI,l=!1,d=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=a,this.aClockwise=l,this.aRotation=d}getPoint(e,t=new Qi){const i=t,r=2*Math.PI;let s=this.aEndAngle-this.aStartAngle;const a=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(s=a?0:r),!0===this.aClockwise&&!a&&(s===r?s=-r:s-=r);const l=this.aStartAngle+e*s;let d=this.aX+this.xRadius*Math.cos(l),u=this.aY+this.yRadius*Math.sin(l);if(0!==this.aRotation){const p=Math.cos(this.aRotation),_=Math.sin(this.aRotation),S=d-this.aX,R=u-this.aY;d=S*p-R*_+this.aX,u=S*_+R*p+this.aY}return i.set(d,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}function Q5(){let n=0,e=0,t=0,i=0;function r(s,a,l,d){n=s,e=l,t=-3*s+3*a-2*l-d,i=2*s-2*a+l+d}return{initCatmullRom:function(s,a,l,d,u){r(a,l,u*(l-s),u*(d-a))},initNonuniformCatmullRom:function(s,a,l,d,u,p,_){let S=(a-s)/u-(l-s)/(u+p)+(l-a)/p,R=(l-a)/p-(d-a)/(p+_)+(d-l)/_;S*=p,R*=p,r(a,l,S,R)},calc:function(s){const a=s*s;return n+e*s+t*a+i*(a*s)}}}const OI=new It,W5=new Q5,j5=new Q5,$5=new Q5;class X5 extends E0{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new It){const i=t,r=this.points,s=r.length,a=(s-(this.closed?0:1))*e;let u,p,l=Math.floor(a),d=a-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/s)+1)*s:0===d&&l===s-1&&(l=s-2,d=1),this.closed||l>0?u=r[(l-1)%s]:(OI.subVectors(r[0],r[1]).add(r[0]),u=OI);const _=r[l%s],S=r[(l+1)%s];if(this.closed||l+2<s?p=r[(l+2)%s]:(OI.subVectors(r[s-1],r[s-2]).add(r[s-1]),p=OI),"centripetal"===this.curveType||"chordal"===this.curveType){const R="chordal"===this.curveType?.5:.25;let H=Math.pow(u.distanceToSquared(_),R),re=Math.pow(_.distanceToSquared(S),R),se=Math.pow(S.distanceToSquared(p),R);re<1e-4&&(re=1),H<1e-4&&(H=re),se<1e-4&&(se=re),W5.initNonuniformCatmullRom(u.x,_.x,S.x,p.x,H,re,se),j5.initNonuniformCatmullRom(u.y,_.y,S.y,p.y,H,re,se),$5.initNonuniformCatmullRom(u.z,_.z,S.z,p.z,H,re,se)}else"catmullrom"===this.curveType&&(W5.initCatmullRom(u.x,_.x,S.x,p.x,this.tension),j5.initCatmullRom(u.y,_.y,S.y,p.y,this.tension),$5.initCatmullRom(u.z,_.z,S.z,p.z,this.tension));return i.set(W5.calc(d),j5.calc(d),$5.calc(d)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new It).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function gG(n,e,t,i,r){const s=.5*(i-e),a=.5*(r-t),l=n*n;return(2*t-2*i+s+a)*(n*l)+(-3*t+3*i-2*s-a)*l+s*n+t}function iE(n,e,t,i){return function Ffe(n,e){const t=1-n;return t*t*e}(n,e)+function Ofe(n,e){return 2*(1-n)*n*e}(n,t)+function Lfe(n,e){return n*n*e}(n,i)}function rE(n,e,t,i,r){return function Nfe(n,e){const t=1-n;return t*t*t*e}(n,e)+function Ufe(n,e){const t=1-n;return 3*t*t*n*e}(n,t)+function zfe(n,e){return 3*(1-n)*n*n*e}(n,i)+function Hfe(n,e){return n*n*n*e}(n,r)}class _G extends E0{constructor(e=new Qi,t=new Qi,i=new Qi,r=new Qi){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new Qi){const i=t,r=this.v0,s=this.v1,a=this.v2,l=this.v3;return i.set(rE(e,r.x,s.x,a.x,l.x),rE(e,r.y,s.y,a.y,l.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class yG extends E0{constructor(e=new Qi,t=new Qi){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Qi){const i=t;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Qi){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class vG extends E0{constructor(e=new Qi,t=new Qi,i=new Qi){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new Qi){const i=t,r=this.v0,s=this.v1,a=this.v2;return i.set(iE(e,r.x,s.x,a.x),iE(e,r.y,s.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Y5 extends E0{constructor(e=new It,t=new It,i=new It){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new It){const i=t,r=this.v0,s=this.v1,a=this.v2;return i.set(iE(e,r.x,s.x,a.x),iE(e,r.y,s.y,a.y),iE(e,r.z,s.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class bG extends E0{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Qi){const i=t,r=this.points,s=(r.length-1)*e,a=Math.floor(s),l=s-a,d=r[0===a?a:a-1],u=r[a],p=r[a>r.length-2?r.length-1:a+1],_=r[a>r.length-3?r.length-1:a+2];return i.set(gG(l,d.x,u.x,p.x,_.x),gG(l,d.y,u.y,p.y,_.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new Qi).fromArray(r))}return this}}var LI=Object.freeze({__proto__:null,ArcCurve:class kfe extends q5{constructor(e,t,i,r,s,a){super(e,t,i,i,r,s,a),this.isArcCurve=!0,this.type="ArcCurve"}},CatmullRomCurve3:X5,CubicBezierCurve:_G,CubicBezierCurve3:class Vfe extends E0{constructor(e=new It,t=new It,i=new It,r=new It){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new It){const i=t,r=this.v0,s=this.v1,a=this.v2,l=this.v3;return i.set(rE(e,r.x,s.x,a.x,l.x),rE(e,r.y,s.y,a.y,l.y),rE(e,r.z,s.z,a.z,l.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},EllipseCurve:q5,LineCurve:yG,LineCurve3:class Gfe extends E0{constructor(e=new It,t=new It){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new It){const i=t;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new It){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},QuadraticBezierCurve:vG,QuadraticBezierCurve3:Y5,SplineCurve:bG});class qfe extends E0{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);return e.equals(t)||this.curves.push(new LI[!0===e.isVector2?"LineCurve":"LineCurve3"](t,e)),this}getPoint(e,t){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const a=r[s]-i,l=this.curves[s],d=l.getLength();return l.getPointAt(0===d?0:1-a/d,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const a=s[r],d=a.getPoints(a.isEllipseCurve?2*e:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e);for(let u=0;u<d.length;u++){const p=d[u];i&&i.equals(p)||(t.push(p),i=p)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++)this.curves.push(e.curves[t].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++)e.curves.push(this.curves[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push((new LI[r.type]).fromJSON(r))}return this}}class NI extends qfe{constructor(e){super(),this.type="Path",this.currentPoint=new Qi,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new yG(this.currentPoint.clone(),new Qi(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){const s=new vG(this.currentPoint.clone(),new Qi(e,t),new Qi(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,s,a){const l=new _G(this.currentPoint.clone(),new Qi(e,t),new Qi(i,r),new Qi(s,a));return this.curves.push(l),this.currentPoint.set(s,a),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new bG(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,s,a){return this.absarc(e+this.currentPoint.x,t+this.currentPoint.y,i,r,s,a),this}absarc(e,t,i,r,s,a){return this.absellipse(e,t,i,i,r,s,a),this}ellipse(e,t,i,r,s,a,l,d){return this.absellipse(e+this.currentPoint.x,t+this.currentPoint.y,i,r,s,a,l,d),this}absellipse(e,t,i,r,s,a,l,d){const u=new q5(e,t,i,r,s,a,l,d);if(this.curves.length>0){const _=u.getPoint(0);_.equals(this.currentPoint)||this.lineTo(_.x,_.y)}this.curves.push(u);const p=u.getPoint(1);return this.currentPoint.copy(p),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class UI extends no{constructor(e=[new Qi(0,-.5),new Qi(.5,0),new Qi(0,.5)],t=12,i=0,r=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:r},t=Math.floor(t),r=bd(r,0,2*Math.PI);const s=[],a=[],l=[],d=[],u=[],p=1/t,_=new It,S=new Qi,R=new It,H=new It,re=new It;let se=0,ce=0;for(let Te=0;Te<=e.length-1;Te++)switch(Te){case 0:se=e[Te+1].x-e[Te].x,ce=e[Te+1].y-e[Te].y,R.x=1*ce,R.y=-se,R.z=0*ce,re.copy(R),R.normalize(),d.push(R.x,R.y,R.z);break;case e.length-1:d.push(re.x,re.y,re.z);break;default:se=e[Te+1].x-e[Te].x,ce=e[Te+1].y-e[Te].y,R.x=1*ce,R.y=-se,R.z=0*ce,H.copy(R),R.x+=re.x,R.y+=re.y,R.z+=re.z,R.normalize(),d.push(R.x,R.y,R.z),re.copy(H)}for(let Te=0;Te<=t;Te++){const Ce=i+Te*p*r,qe=Math.sin(Ce),wt=Math.cos(Ce);for(let gt=0;gt<=e.length-1;gt++)_.x=e[gt].x*qe,_.y=e[gt].y,_.z=e[gt].x*wt,a.push(_.x,_.y,_.z),S.x=Te/t,S.y=gt/(e.length-1),l.push(S.x,S.y),u.push(d[3*gt+0]*qe,d[3*gt+1],d[3*gt+0]*wt)}for(let Te=0;Te<t;Te++)for(let Ce=0;Ce<e.length-1;Ce++){const qe=Ce+Te*e.length,gt=qe+e.length,Et=qe+e.length+1,Xt=qe+1;s.push(qe,gt,Xt),s.push(Et,Xt,gt)}this.setIndex(s),this.setAttribute("position",new Ws(a,3)),this.setAttribute("uv",new Ws(l,2)),this.setAttribute("normal",new Ws(u,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new UI(e.points,e.segments,e.phiStart,e.phiLength)}}class K5 extends UI{constructor(e=1,t=1,i=4,r=8){const s=new NI;s.absarc(0,-t/2,e,1.5*Math.PI,0),s.absarc(0,t/2,e,0,.5*Math.PI),super(s.getPoints(i),r),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:i,radialSegments:r}}static fromJSON(e){return new K5(e.radius,e.length,e.capSegments,e.radialSegments)}}class Z5 extends no{constructor(e=1,t=32,i=0,r=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:r},t=Math.max(3,t);const s=[],a=[],l=[],d=[],u=new It,p=new Qi;a.push(0,0,0),l.push(0,0,1),d.push(.5,.5);for(let _=0,S=3;_<=t;_++,S+=3){const R=i+_/t*r;u.x=e*Math.cos(R),u.y=e*Math.sin(R),a.push(u.x,u.y,u.z),l.push(0,0,1),p.x=(a[S]/e+1)/2,p.y=(a[S+1]/e+1)/2,d.push(p.x,p.y)}for(let _=1;_<=t;_++)s.push(_,_+1,0);this.setIndex(s),this.setAttribute("position",new Ws(a,3)),this.setAttribute("normal",new Ws(l,3)),this.setAttribute("uv",new Ws(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Z5(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class rC extends no{constructor(e=1,t=1,i=1,r=32,s=1,a=!1,l=0,d=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:s,openEnded:a,thetaStart:l,thetaLength:d};const u=this;r=Math.floor(r),s=Math.floor(s);const p=[],_=[],S=[],R=[];let H=0;const re=[],se=i/2;let ce=0;function Ce(qe){const wt=H,gt=new Qi,Et=new It;let Xt=0;const Un=!0===qe?e:t,Ct=!0===qe?1:-1;for(let Gi=1;Gi<=r;Gi++)_.push(0,se*Ct,0),S.push(0,Ct,0),R.push(.5,.5),H++;const Kt=H;for(let Gi=0;Gi<=r;Gi++){const En=Gi/r*d+l,wi=Math.cos(En),zn=Math.sin(En);Et.x=Un*zn,Et.y=se*Ct,Et.z=Un*wi,_.push(Et.x,Et.y,Et.z),S.push(0,Ct,0),gt.x=.5*wi+.5,gt.y=.5*zn*Ct+.5,R.push(gt.x,gt.y),H++}for(let Gi=0;Gi<r;Gi++){const Yi=wt+Gi,En=Kt+Gi;!0===qe?p.push(En,En+1,Yi):p.push(En+1,En,Yi),Xt+=3}u.addGroup(ce,Xt,!0===qe?1:2),ce+=Xt}(function Te(){const qe=new It,wt=new It;let gt=0;const Et=(t-e)/i;for(let Xt=0;Xt<=s;Xt++){const Un=[],Ct=Xt/s,Kt=Ct*(t-e)+e;for(let Gi=0;Gi<=r;Gi++){const Yi=Gi/r,En=Yi*d+l,wi=Math.sin(En),zn=Math.cos(En);wt.x=Kt*wi,wt.y=-Ct*i+se,wt.z=Kt*zn,_.push(wt.x,wt.y,wt.z),qe.set(wi,Et,zn).normalize(),S.push(qe.x,qe.y,qe.z),R.push(Yi,1-Ct),Un.push(H++)}re.push(Un)}for(let Xt=0;Xt<r;Xt++)for(let Un=0;Un<s;Un++){const Kt=re[Un+1][Xt],Gi=re[Un+1][Xt+1],Yi=re[Un][Xt+1];p.push(re[Un][Xt],Kt,Yi),p.push(Kt,Gi,Yi),gt+=6}u.addGroup(ce,gt,0),ce+=gt})(),!1===a&&(e>0&&Ce(!0),t>0&&Ce(!1)),this.setIndex(p),this.setAttribute("position",new Ws(_,3)),this.setAttribute("normal",new Ws(S,3)),this.setAttribute("uv",new Ws(R,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new rC(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class J5 extends rC{constructor(e=1,t=1,i=32,r=1,s=!1,a=0,l=2*Math.PI){super(0,e,t,i,r,s,a,l),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:a,thetaLength:l}}static fromJSON(e){return new J5(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class jb extends no{constructor(e=[],t=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:r};const s=[],a=[];function d(Te,Ce,qe,wt){const gt=wt+1,Et=[];for(let Xt=0;Xt<=gt;Xt++){Et[Xt]=[];const Un=Te.clone().lerp(qe,Xt/gt),Ct=Ce.clone().lerp(qe,Xt/gt),Kt=gt-Xt;for(let Gi=0;Gi<=Kt;Gi++)Et[Xt][Gi]=0===Gi&&Xt===gt?Un:Un.clone().lerp(Ct,Gi/Kt)}for(let Xt=0;Xt<gt;Xt++)for(let Un=0;Un<2*(gt-Xt)-1;Un++){const Ct=Math.floor(Un/2);Un%2==0?(S(Et[Xt][Ct+1]),S(Et[Xt+1][Ct]),S(Et[Xt][Ct])):(S(Et[Xt][Ct+1]),S(Et[Xt+1][Ct+1]),S(Et[Xt+1][Ct]))}}function S(Te){s.push(Te.x,Te.y,Te.z)}function R(Te,Ce){const qe=3*Te;Ce.x=e[qe+0],Ce.y=e[qe+1],Ce.z=e[qe+2]}function re(Te,Ce,qe,wt){wt<0&&1===Te.x&&(a[Ce]=Te.x-1),0===qe.x&&0===qe.z&&(a[Ce]=wt/2/Math.PI+.5)}function se(Te){return Math.atan2(Te.z,-Te.x)}function ce(Te){return Math.atan2(-Te.y,Math.sqrt(Te.x*Te.x+Te.z*Te.z))}(function l(Te){const Ce=new It,qe=new It,wt=new It;for(let gt=0;gt<t.length;gt+=3)R(t[gt+0],Ce),R(t[gt+1],qe),R(t[gt+2],wt),d(Ce,qe,wt,Te)})(r),function u(Te){const Ce=new It;for(let qe=0;qe<s.length;qe+=3)Ce.x=s[qe+0],Ce.y=s[qe+1],Ce.z=s[qe+2],Ce.normalize().multiplyScalar(Te),s[qe+0]=Ce.x,s[qe+1]=Ce.y,s[qe+2]=Ce.z}(i),function p(){const Te=new It;for(let Ce=0;Ce<s.length;Ce+=3){Te.x=s[Ce+0],Te.y=s[Ce+1],Te.z=s[Ce+2];const qe=se(Te)/2/Math.PI+.5,wt=ce(Te)/Math.PI+.5;a.push(qe,1-wt)}(function H(){const Te=new It,Ce=new It,qe=new It,wt=new It,gt=new Qi,Et=new Qi,Xt=new Qi;for(let Un=0,Ct=0;Un<s.length;Un+=9,Ct+=6){Te.set(s[Un+0],s[Un+1],s[Un+2]),Ce.set(s[Un+3],s[Un+4],s[Un+5]),qe.set(s[Un+6],s[Un+7],s[Un+8]),gt.set(a[Ct+0],a[Ct+1]),Et.set(a[Ct+2],a[Ct+3]),Xt.set(a[Ct+4],a[Ct+5]),wt.copy(Te).add(Ce).add(qe).divideScalar(3);const Kt=se(wt);re(gt,Ct+0,Te,Kt),re(Et,Ct+2,Ce,Kt),re(Xt,Ct+4,qe,Kt)}})(),function _(){for(let Te=0;Te<a.length;Te+=6){const Ce=a[Te+0],qe=a[Te+2],wt=a[Te+4],gt=Math.max(Ce,qe,wt),Et=Math.min(Ce,qe,wt);gt>.9&&Et<.1&&(Ce<.2&&(a[Te+0]+=1),qe<.2&&(a[Te+2]+=1),wt<.2&&(a[Te+4]+=1))}}()}(),this.setAttribute("position",new Ws(s,3)),this.setAttribute("normal",new Ws(s.slice(),3)),this.setAttribute("uv",new Ws(a,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new jb(e.vertices,e.indices,e.radius,e.details)}}class eF extends jb{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2,r=1/i;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new eF(e.radius,e.detail)}}const zI=new It,HI=new It,tF=new It,VI=new hm;class xG extends no{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const r=Math.pow(10,4),s=Math.cos(Rb*t),a=e.getIndex(),l=e.getAttribute("position"),d=a?a.count:l.count,u=[0,0,0],p=["a","b","c"],_=new Array(3),S={},R=[];for(let H=0;H<d;H+=3){a?(u[0]=a.getX(H),u[1]=a.getX(H+1),u[2]=a.getX(H+2)):(u[0]=H,u[1]=H+1,u[2]=H+2);const{a:re,b:se,c:ce}=VI;if(re.fromBufferAttribute(l,u[0]),se.fromBufferAttribute(l,u[1]),ce.fromBufferAttribute(l,u[2]),VI.getNormal(tF),_[0]=`${Math.round(re.x*r)},${Math.round(re.y*r)},${Math.round(re.z*r)}`,_[1]=`${Math.round(se.x*r)},${Math.round(se.y*r)},${Math.round(se.z*r)}`,_[2]=`${Math.round(ce.x*r)},${Math.round(ce.y*r)},${Math.round(ce.z*r)}`,_[0]!==_[1]&&_[1]!==_[2]&&_[2]!==_[0])for(let Te=0;Te<3;Te++){const Ce=(Te+1)%3,qe=_[Te],wt=_[Ce],gt=VI[p[Te]],Et=VI[p[Ce]],Xt=`${qe}_${wt}`,Un=`${wt}_${qe}`;Un in S&&S[Un]?(tF.dot(S[Un].normal)<=s&&(R.push(gt.x,gt.y,gt.z),R.push(Et.x,Et.y,Et.z)),S[Un]=null):Xt in S||(S[Xt]={index0:u[Te],index1:u[Ce],normal:tF.clone()})}}for(const H in S)if(S[H]){const{index0:re,index1:se}=S[H];zI.fromBufferAttribute(l,re),HI.fromBufferAttribute(l,se),R.push(zI.x,zI.y,zI.z),R.push(HI.x,HI.y,HI.z)}this.setAttribute("position",new Ws(R,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class sC extends NI{constructor(e){super(e),this.uuid=dm(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++)this.holes.push(e.holes[t].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++)e.holes.push(this.holes[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push((new NI).fromJSON(r))}return this}}function wG(n,e,t,i,r){let s,a;if(r===function ape(n,e,t,i){let r=0;for(let s=e,a=t-i;s<t;s+=i)r+=(n[a]-n[s])*(n[s+1]+n[a+1]),a=s;return r}(n,e,t,i)>0)for(s=e;s<t;s+=i)a=SG(s,n[s],n[s+1],a);else for(s=t-i;s>=e;s-=i)a=SG(s,n[s],n[s+1],a);return a&&GI(a,a.next)&&(aE(a),a=a.next),a}function $b(n,e){if(!n)return n;e||(e=n);let i,t=n;do{if(i=!1,t.steiner||!GI(t,t.next)&&0!==cd(t.prev,t,t.next))t=t.next;else{if(aE(t),t=e=t.prev,t===t.next)break;i=!0}}while(i||t!==e);return e}function sE(n,e,t,i,r,s,a){if(!n)return;!a&&s&&function tpe(n,e,t,i){let r=n;do{0===r.z&&(r.z=nF(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,function npe(n){let e,t,i,r,s,a,l,d,u=1;do{for(t=n,n=null,s=null,a=0;t;){for(a++,i=t,l=0,e=0;e<u&&(l++,i=i.nextZ,i);e++);for(d=u;l>0||d>0&&i;)0!==l&&(0===d||!i||t.z<=i.z)?(r=t,t=t.nextZ,l--):(r=i,i=i.nextZ,d--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;t=i}s.nextZ=null,u*=2}while(a>1)}(r)}(n,i,r,s);let d,u,l=n;for(;n.prev!==n.next;)if(d=n.prev,u=n.next,s?jfe(n,i,r,s):Wfe(n))e.push(d.i/t|0),e.push(n.i/t|0),e.push(u.i/t|0),aE(n),n=u.next,l=u.next;else if((n=u)===l){a?1===a?sE(n=$fe($b(n),e,t),e,t,i,r,s,2):2===a&&Xfe(n,e,t,i,r,s):sE($b(n),e,t,i,r,s,1);break}}function Wfe(n){const e=n.prev,t=n,i=n.next;if(cd(e,t,i)>=0)return!1;const r=e.x,s=t.x,a=i.x,l=e.y,d=t.y,u=i.y,p=r<s?r<a?r:a:s<a?s:a,_=l<d?l<u?l:u:d<u?d:u,S=r>s?r>a?r:a:s>a?s:a,R=l>d?l>u?l:u:d>u?d:u;let H=i.next;for(;H!==e;){if(H.x>=p&&H.x<=S&&H.y>=_&&H.y<=R&&oC(r,l,s,d,a,u,H.x,H.y)&&cd(H.prev,H,H.next)>=0)return!1;H=H.next}return!0}function jfe(n,e,t,i){const r=n.prev,s=n,a=n.next;if(cd(r,s,a)>=0)return!1;const l=r.x,d=s.x,u=a.x,p=r.y,_=s.y,S=a.y,R=l<d?l<u?l:u:d<u?d:u,H=p<_?p<S?p:S:_<S?_:S,re=l>d?l>u?l:u:d>u?d:u,se=p>_?p>S?p:S:_>S?_:S,ce=nF(R,H,e,t,i),Te=nF(re,se,e,t,i);let Ce=n.prevZ,qe=n.nextZ;for(;Ce&&Ce.z>=ce&&qe&&qe.z<=Te;){if(Ce.x>=R&&Ce.x<=re&&Ce.y>=H&&Ce.y<=se&&Ce!==r&&Ce!==a&&oC(l,p,d,_,u,S,Ce.x,Ce.y)&&cd(Ce.prev,Ce,Ce.next)>=0||(Ce=Ce.prevZ,qe.x>=R&&qe.x<=re&&qe.y>=H&&qe.y<=se&&qe!==r&&qe!==a&&oC(l,p,d,_,u,S,qe.x,qe.y)&&cd(qe.prev,qe,qe.next)>=0))return!1;qe=qe.nextZ}for(;Ce&&Ce.z>=ce;){if(Ce.x>=R&&Ce.x<=re&&Ce.y>=H&&Ce.y<=se&&Ce!==r&&Ce!==a&&oC(l,p,d,_,u,S,Ce.x,Ce.y)&&cd(Ce.prev,Ce,Ce.next)>=0)return!1;Ce=Ce.prevZ}for(;qe&&qe.z<=Te;){if(qe.x>=R&&qe.x<=re&&qe.y>=H&&qe.y<=se&&qe!==r&&qe!==a&&oC(l,p,d,_,u,S,qe.x,qe.y)&&cd(qe.prev,qe,qe.next)>=0)return!1;qe=qe.nextZ}return!0}function $fe(n,e,t){let i=n;do{const r=i.prev,s=i.next.next;!GI(r,s)&&CG(r,i,i.next,s)&&oE(r,s)&&oE(s,r)&&(e.push(r.i/t|0),e.push(i.i/t|0),e.push(s.i/t|0),aE(i),aE(i.next),i=n=s),i=i.next}while(i!==n);return $b(i)}function Xfe(n,e,t,i,r,s){let a=n;do{let l=a.next.next;for(;l!==a.prev;){if(a.i!==l.i&&rpe(a,l)){let d=MG(a,l);return a=$b(a,a.next),d=$b(d,d.next),sE(a,e,t,i,r,s,0),void sE(d,e,t,i,r,s,0)}l=l.next}a=a.next}while(a!==n)}function Kfe(n,e){return n.x-e.x}function Zfe(n,e){const t=function Jfe(n,e){let r,t=e,i=-1/0;const s=n.x,a=n.y;do{if(a<=t.y&&a>=t.next.y&&t.next.y!==t.y){const S=t.x+(a-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(S<=s&&S>i&&(i=S,r=t.x<t.next.x?t:t.next,S===s))return r}t=t.next}while(t!==e);if(!r)return null;const l=r,d=r.x,u=r.y;let _,p=1/0;t=r;do{s>=t.x&&t.x>=d&&s!==t.x&&oC(a<u?s:i,a,d,u,a<u?i:s,a,t.x,t.y)&&(_=Math.abs(a-t.y)/(s-t.x),oE(t,n)&&(_<p||_===p&&(t.x>r.x||t.x===r.x&&epe(r,t)))&&(r=t,p=_)),t=t.next}while(t!==l);return r}(n,e);if(!t)return e;const i=MG(t,n);return $b(i,i.next),$b(t,t.next)}function epe(n,e){return cd(n.prev,n,e.prev)<0&&cd(e.next,n,n.next)<0}function nF(n,e,t,i,r){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-t)*r|0)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function ipe(n){let e=n,t=n;do{(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next}while(e!==n);return t}function oC(n,e,t,i,r,s,a,l){return(r-a)*(e-l)>=(n-a)*(s-l)&&(n-a)*(i-l)>=(t-a)*(e-l)&&(t-a)*(s-l)>=(r-a)*(i-l)}function rpe(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!function spe(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&CG(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}(n,e)&&(oE(n,e)&&oE(e,n)&&function ope(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,s=(n.y+e.y)/2;do{t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next}while(t!==n);return i}(n,e)&&(cd(n.prev,n,e.prev)||cd(n,e.prev,e))||GI(n,e)&&cd(n.prev,n,n.next)>0&&cd(e.prev,e,e.next)>0)}function cd(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function GI(n,e){return n.x===e.x&&n.y===e.y}function CG(n,e,t,i){const r=QI(cd(n,e,t)),s=QI(cd(n,e,i)),a=QI(cd(t,i,n)),l=QI(cd(t,i,e));return!!(r!==s&&a!==l||0===r&&qI(n,t,e)||0===s&&qI(n,i,e)||0===a&&qI(t,n,i)||0===l&&qI(t,e,i))}function qI(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function QI(n){return n>0?1:n<0?-1:0}function oE(n,e){return cd(n.prev,n,n.next)<0?cd(n,e,n.next)>=0&&cd(n,n.prev,e)>=0:cd(n,e,n.prev)<0||cd(n,n.next,e)<0}function MG(n,e){const t=new iF(n.i,n.x,n.y),i=new iF(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function SG(n,e,t,i){const r=new iF(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function aE(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function iF(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Y_{static area(e){const t=e.length;let i=0;for(let r=t-1,s=0;s<t;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return.5*i}static isClockWise(e){return Y_.area(e)<0}static triangulateShape(e,t){const i=[],r=[],s=[];EG(e),TG(i,e);let a=e.length;t.forEach(EG);for(let d=0;d<t.length;d++)r.push(a),a+=t[d].length,TG(i,t[d]);const l=function(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let s=wG(n,0,r,t,!0);const a=[];if(!s||s.next===s.prev)return a;let l,d,u,p,_,S,R;if(i&&(s=function Yfe(n,e,t,i){const r=[];let s,a,l,d,u;for(s=0,a=e.length;s<a;s++)l=e[s]*i,d=s<a-1?e[s+1]*i:n.length,u=wG(n,l,d,i,!1),u===u.next&&(u.steiner=!0),r.push(ipe(u));for(r.sort(Kfe),s=0;s<r.length;s++)t=Zfe(r[s],t);return t}(n,e,s,t)),n.length>80*t){l=u=n[0],d=p=n[1];for(let H=t;H<r;H+=t)_=n[H],S=n[H+1],_<l&&(l=_),S<d&&(d=S),_>u&&(u=_),S>p&&(p=S);R=Math.max(u-l,p-d),R=0!==R?32767/R:0}return sE(s,a,t,l,d,R,0),a}(i,r);for(let d=0;d<l.length;d+=3)s.push(l.slice(d,d+3));return s}}function EG(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function TG(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class WI extends no{constructor(e=new sC([new Qi(.5,.5),new Qi(-.5,.5),new Qi(-.5,-.5),new Qi(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let l=0,d=e.length;l<d;l++)a(e[l]);function a(l){const d=[],u=void 0!==t.curveSegments?t.curveSegments:12,p=void 0!==t.steps?t.steps:1,_=void 0!==t.depth?t.depth:1;let S=void 0===t.bevelEnabled||t.bevelEnabled,R=void 0!==t.bevelThickness?t.bevelThickness:.2,H=void 0!==t.bevelSize?t.bevelSize:R-.1,re=void 0!==t.bevelOffset?t.bevelOffset:0,se=void 0!==t.bevelSegments?t.bevelSegments:3;const ce=t.extrudePath,Te=void 0!==t.UVGenerator?t.UVGenerator:lpe;let Ce,wt,gt,Et,Xt,qe=!1;ce&&(Ce=ce.getSpacedPoints(p),qe=!0,S=!1,wt=ce.computeFrenetFrames(p,!1),gt=new It,Et=new It,Xt=new It),S||(se=0,R=0,H=0,re=0);const Un=l.extractPoints(u);let Ct=Un.shape;const Kt=Un.holes;if(!Y_.isClockWise(Ct)){Ct=Ct.reverse();for(let On=0,ps=Kt.length;On<ps;On++){const gr=Kt[On];Y_.isClockWise(gr)&&(Kt[On]=gr.reverse())}}const Yi=Y_.triangulateShape(Ct,Kt),En=Ct;for(let On=0,ps=Kt.length;On<ps;On++)Ct=Ct.concat(Kt[On]);function wi(On,ps,gr){return ps||console.error("THREE.ExtrudeGeometry: vec does not exist"),On.clone().addScaledVector(ps,gr)}const zn=Ct.length,oi=Yi.length;function hi(On,ps,gr){let ls,Tr,Ys;const qs=On.x-ps.x,uo=On.y-ps.y,ka=gr.x-On.x,gn=gr.y-On.y,Ht=qs*qs+uo*uo;if(Math.abs(qs*gn-uo*ka)>Number.EPSILON){const hr=Math.sqrt(Ht),$r=Math.sqrt(ka*ka+gn*gn),Or=ps.x-uo/hr,Aa=ps.y+qs/hr,Is=((gr.x-gn/$r-Or)*gn-(gr.y+ka/$r-Aa)*ka)/(qs*gn-uo*ka);ls=Or+qs*Is-On.x,Tr=Aa+uo*Is-On.y;const ga=ls*ls+Tr*Tr;if(ga<=2)return new Qi(ls,Tr);Ys=Math.sqrt(ga/2)}else{let hr=!1;qs>Number.EPSILON?ka>Number.EPSILON&&(hr=!0):qs<-Number.EPSILON?ka<-Number.EPSILON&&(hr=!0):Math.sign(uo)===Math.sign(gn)&&(hr=!0),hr?(ls=-uo,Tr=qs,Ys=Math.sqrt(Ht)):(ls=qs,Tr=uo,Ys=Math.sqrt(Ht/2))}return new Qi(ls/Ys,Tr/Ys)}const vi=[];for(let On=0,ps=En.length,gr=ps-1,ls=On+1;On<ps;On++,gr++,ls++)gr===ps&&(gr=0),ls===ps&&(ls=0),vi[On]=hi(En[On],En[gr],En[ls]);const mr=[];let Mr,is=vi.concat();for(let On=0,ps=Kt.length;On<ps;On++){const gr=Kt[On];Mr=[];for(let ls=0,Tr=gr.length,Ys=Tr-1,qs=ls+1;ls<Tr;ls++,Ys++,qs++)Ys===Tr&&(Ys=0),qs===Tr&&(qs=0),Mr[ls]=hi(gr[ls],gr[Ys],gr[qs]);mr.push(Mr),is=is.concat(Mr)}for(let On=0;On<se;On++){const ps=On/se,gr=R*Math.cos(ps*Math.PI/2),ls=H*Math.sin(ps*Math.PI/2)+re;for(let Tr=0,Ys=En.length;Tr<Ys;Tr++){const qs=wi(En[Tr],vi[Tr],ls);Fs(qs.x,qs.y,-gr)}for(let Tr=0,Ys=Kt.length;Tr<Ys;Tr++){const qs=Kt[Tr];Mr=mr[Tr];for(let uo=0,ka=qs.length;uo<ka;uo++){const gn=wi(qs[uo],Mr[uo],ls);Fs(gn.x,gn.y,-gr)}}}const $s=H+re;for(let On=0;On<zn;On++){const ps=S?wi(Ct[On],is[On],$s):Ct[On];qe?(Et.copy(wt.normals[0]).multiplyScalar(ps.x),gt.copy(wt.binormals[0]).multiplyScalar(ps.y),Xt.copy(Ce[0]).add(Et).add(gt),Fs(Xt.x,Xt.y,Xt.z)):Fs(ps.x,ps.y,0)}for(let On=1;On<=p;On++)for(let ps=0;ps<zn;ps++){const gr=S?wi(Ct[ps],is[ps],$s):Ct[ps];qe?(Et.copy(wt.normals[On]).multiplyScalar(gr.x),gt.copy(wt.binormals[On]).multiplyScalar(gr.y),Xt.copy(Ce[On]).add(Et).add(gt),Fs(Xt.x,Xt.y,Xt.z)):Fs(gr.x,gr.y,_/p*On)}for(let On=se-1;On>=0;On--){const ps=On/se,gr=R*Math.cos(ps*Math.PI/2),ls=H*Math.sin(ps*Math.PI/2)+re;for(let Tr=0,Ys=En.length;Tr<Ys;Tr++){const qs=wi(En[Tr],vi[Tr],ls);Fs(qs.x,qs.y,_+gr)}for(let Tr=0,Ys=Kt.length;Tr<Ys;Tr++){const qs=Kt[Tr];Mr=mr[Tr];for(let uo=0,ka=qs.length;uo<ka;uo++){const gn=wi(qs[uo],Mr[uo],ls);qe?Fs(gn.x,gn.y+Ce[p-1].y,Ce[p-1].x+gr):Fs(gn.x,gn.y,_+gr)}}}function ms(On,ps){let gr=On.length;for(;--gr>=0;){const ls=gr;let Tr=gr-1;Tr<0&&(Tr=On.length-1);for(let Ys=0,qs=p+2*se;Ys<qs;Ys++){const uo=zn*Ys,ka=zn*(Ys+1);ws(ps+ls+uo,ps+Tr+uo,ps+Tr+ka,ps+ls+ka)}}}function Fs(On,ps,gr){d.push(On),d.push(ps),d.push(gr)}function Us(On,ps,gr){Co(On),Co(ps),Co(gr);const ls=r.length/3,Tr=Te.generateTopUV(i,r,ls-3,ls-2,ls-1);lo(Tr[0]),lo(Tr[1]),lo(Tr[2])}function ws(On,ps,gr,ls){Co(On),Co(ps),Co(ls),Co(ps),Co(gr),Co(ls);const Tr=r.length/3,Ys=Te.generateSideWallUV(i,r,Tr-6,Tr-3,Tr-2,Tr-1);lo(Ys[0]),lo(Ys[1]),lo(Ys[3]),lo(Ys[1]),lo(Ys[2]),lo(Ys[3])}function Co(On){r.push(d[3*On+0]),r.push(d[3*On+1]),r.push(d[3*On+2])}function lo(On){s.push(On.x),s.push(On.y)}(function fi(){const On=r.length/3;if(S){let ps=0,gr=zn*ps;for(let ls=0;ls<oi;ls++){const Tr=Yi[ls];Us(Tr[2]+gr,Tr[1]+gr,Tr[0]+gr)}ps=p+2*se,gr=zn*ps;for(let ls=0;ls<oi;ls++){const Tr=Yi[ls];Us(Tr[0]+gr,Tr[1]+gr,Tr[2]+gr)}}else{for(let ps=0;ps<oi;ps++){const gr=Yi[ps];Us(gr[2],gr[1],gr[0])}for(let ps=0;ps<oi;ps++){const gr=Yi[ps];Us(gr[0]+zn*p,gr[1]+zn*p,gr[2]+zn*p)}}i.addGroup(On,r.length/3-On,0)})(),function Rr(){const On=r.length/3;let ps=0;ms(En,ps),ps+=En.length;for(let gr=0,ls=Kt.length;gr<ls;gr++){const Tr=Kt[gr];ms(Tr,ps),ps+=Tr.length}i.addGroup(On,r.length/3-On,1)}()}this.setAttribute("position",new Ws(r,3)),this.setAttribute("uv",new Ws(s,2)),this.computeVertexNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function cpe(n,e,t){if(t.shapes=[],Array.isArray(n))for(let i=0,r=n.length;i<r;i++)t.shapes.push(n[i].uuid);else t.shapes.push(n.uuid);return t.options=Object.assign({},e),void 0!==e.extrudePath&&(t.options.extrudePath=e.extrudePath.toJSON()),t}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const i=[];for(let s=0,a=e.shapes.length;s<a;s++)i.push(t[e.shapes[s]]);const r=e.options.extrudePath;return void 0!==r&&(e.options.extrudePath=(new LI[r.type]).fromJSON(r)),new WI(i,e.options)}}const lpe={generateTopUV:function(n,e,t,i,r){const l=e[3*i],d=e[3*i+1],u=e[3*r],p=e[3*r+1];return[new Qi(e[3*t],e[3*t+1]),new Qi(l,d),new Qi(u,p)]},generateSideWallUV:function(n,e,t,i,r,s){const a=e[3*t],l=e[3*t+1],d=e[3*t+2],u=e[3*i],p=e[3*i+1],_=e[3*i+2],S=e[3*r],R=e[3*r+1],H=e[3*r+2],re=e[3*s],se=e[3*s+1],ce=e[3*s+2];return Math.abs(l-p)<Math.abs(a-u)?[new Qi(a,1-d),new Qi(u,1-_),new Qi(S,1-H),new Qi(re,1-ce)]:[new Qi(l,1-d),new Qi(p,1-_),new Qi(R,1-H),new Qi(se,1-ce)]}};class rF extends jb{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2;super([-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new rF(e.radius,e.detail)}}class jI extends jb{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new jI(e.radius,e.detail)}}class sF extends no{constructor(e=.5,t=1,i=32,r=1,s=0,a=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:r,thetaStart:s,thetaLength:a},i=Math.max(3,i);const l=[],d=[],u=[],p=[];let _=e;const S=(t-e)/(r=Math.max(1,r)),R=new It,H=new Qi;for(let re=0;re<=r;re++){for(let se=0;se<=i;se++){const ce=s+se/i*a;R.x=_*Math.cos(ce),R.y=_*Math.sin(ce),d.push(R.x,R.y,R.z),u.push(0,0,1),H.x=(R.x/t+1)/2,H.y=(R.y/t+1)/2,p.push(H.x,H.y)}_+=S}for(let re=0;re<r;re++){const se=re*(i+1);for(let ce=0;ce<i;ce++){const Te=ce+se,qe=Te+i+1,wt=Te+i+2,gt=Te+1;l.push(Te,qe,gt),l.push(qe,wt,gt)}}this.setIndex(l),this.setAttribute("position",new Ws(d,3)),this.setAttribute("normal",new Ws(u,3)),this.setAttribute("uv",new Ws(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new sF(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class oF extends no{constructor(e=new sC([new Qi(0,.5),new Qi(-.5,-.5),new Qi(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const i=[],r=[],s=[],a=[];let l=0,d=0;if(!1===Array.isArray(e))u(e);else for(let p=0;p<e.length;p++)u(e[p]),this.addGroup(l,d,p),l+=d,d=0;function u(p){const _=r.length/3,S=p.extractPoints(t);let R=S.shape;const H=S.holes;!1===Y_.isClockWise(R)&&(R=R.reverse());for(let se=0,ce=H.length;se<ce;se++){const Te=H[se];!0===Y_.isClockWise(Te)&&(H[se]=Te.reverse())}const re=Y_.triangulateShape(R,H);for(let se=0,ce=H.length;se<ce;se++)R=R.concat(H[se]);for(let se=0,ce=R.length;se<ce;se++){const Te=R[se];r.push(Te.x,Te.y,0),s.push(0,0,1),a.push(Te.x,Te.y)}for(let se=0,ce=re.length;se<ce;se++){const Te=re[se];i.push(Te[0]+_,Te[1]+_,Te[2]+_),d+=3}}this.setIndex(i),this.setAttribute("position",new Ws(r,3)),this.setAttribute("normal",new Ws(s,3)),this.setAttribute("uv",new Ws(a,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function dpe(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,i=n.length;t<i;t++)e.shapes.push(n[t].uuid);else e.shapes.push(n.uuid);return e}(this.parameters.shapes,e)}static fromJSON(e,t){const i=[];for(let r=0,s=e.shapes.length;r<s;r++)i.push(t[e.shapes[r]]);return new oF(i,e.curveSegments)}}class Gy extends no{constructor(e=1,t=32,i=16,r=0,s=2*Math.PI,a=0,l=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:a,thetaLength:l},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const d=Math.min(a+l,Math.PI);let u=0;const p=[],_=new It,S=new It,R=[],H=[],re=[],se=[];for(let ce=0;ce<=i;ce++){const Te=[],Ce=ce/i;let qe=0;0===ce&&0===a?qe=.5/t:ce===i&&d===Math.PI&&(qe=-.5/t);for(let wt=0;wt<=t;wt++){const gt=wt/t;_.x=-e*Math.cos(r+gt*s)*Math.sin(a+Ce*l),_.y=e*Math.cos(a+Ce*l),_.z=e*Math.sin(r+gt*s)*Math.sin(a+Ce*l),H.push(_.x,_.y,_.z),S.copy(_).normalize(),re.push(S.x,S.y,S.z),se.push(gt+qe,1-Ce),Te.push(u++)}p.push(Te)}for(let ce=0;ce<i;ce++)for(let Te=0;Te<t;Te++){const qe=p[ce][Te],wt=p[ce+1][Te],gt=p[ce+1][Te+1];(0!==ce||a>0)&&R.push(p[ce][Te+1],qe,gt),(ce!==i-1||d<Math.PI)&&R.push(qe,wt,gt)}this.setIndex(R),this.setAttribute("position",new Ws(H,3)),this.setAttribute("normal",new Ws(re,3)),this.setAttribute("uv",new Ws(se,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Gy(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class aF extends jb{constructor(e=1,t=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new aF(e.radius,e.detail)}}class lF extends no{constructor(e=1,t=.4,i=12,r=48,s=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:r,arc:s},i=Math.floor(i),r=Math.floor(r);const a=[],l=[],d=[],u=[],p=new It,_=new It,S=new It;for(let R=0;R<=i;R++)for(let H=0;H<=r;H++){const re=H/r*s,se=R/i*Math.PI*2;_.x=(e+t*Math.cos(se))*Math.cos(re),_.y=(e+t*Math.cos(se))*Math.sin(re),_.z=t*Math.sin(se),l.push(_.x,_.y,_.z),p.x=e*Math.cos(re),p.y=e*Math.sin(re),S.subVectors(_,p).normalize(),d.push(S.x,S.y,S.z),u.push(H/r),u.push(R/i)}for(let R=1;R<=i;R++)for(let H=1;H<=r;H++){const se=(r+1)*(R-1)+H-1,ce=(r+1)*(R-1)+H,Te=(r+1)*R+H;a.push((r+1)*R+H-1,se,Te),a.push(se,ce,Te)}this.setIndex(a),this.setAttribute("position",new Ws(l,3)),this.setAttribute("normal",new Ws(d,3)),this.setAttribute("uv",new Ws(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new lF(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class cF extends no{constructor(e=1,t=.4,i=64,r=8,s=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:r,p:s,q:a},i=Math.floor(i),r=Math.floor(r);const l=[],d=[],u=[],p=[],_=new It,S=new It,R=new It,H=new It,re=new It,se=new It,ce=new It;for(let Ce=0;Ce<=i;++Ce){const qe=Ce/i*s*Math.PI*2;Te(qe,s,a,e,R),Te(qe+.01,s,a,e,H),se.subVectors(H,R),ce.addVectors(H,R),re.crossVectors(se,ce),ce.crossVectors(re,se),re.normalize(),ce.normalize();for(let wt=0;wt<=r;++wt){const gt=wt/r*Math.PI*2,Et=-t*Math.cos(gt),Xt=t*Math.sin(gt);_.x=R.x+(Et*ce.x+Xt*re.x),_.y=R.y+(Et*ce.y+Xt*re.y),_.z=R.z+(Et*ce.z+Xt*re.z),d.push(_.x,_.y,_.z),S.subVectors(_,R).normalize(),u.push(S.x,S.y,S.z),p.push(Ce/i),p.push(wt/r)}}for(let Ce=1;Ce<=i;Ce++)for(let qe=1;qe<=r;qe++){const gt=(r+1)*Ce+(qe-1),Et=(r+1)*Ce+qe,Xt=(r+1)*(Ce-1)+qe;l.push((r+1)*(Ce-1)+(qe-1),gt,Xt),l.push(gt,Et,Xt)}function Te(Ce,qe,wt,gt,Et){const Xt=Math.cos(Ce),Un=Math.sin(Ce),Ct=wt/qe*Ce,Kt=Math.cos(Ct);Et.x=gt*(2+Kt)*.5*Xt,Et.y=gt*(2+Kt)*Un*.5,Et.z=gt*Math.sin(Ct)*.5}this.setIndex(l),this.setAttribute("position",new Ws(d,3)),this.setAttribute("normal",new Ws(u,3)),this.setAttribute("uv",new Ws(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new cF(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Xb extends no{constructor(e=new Y5(new It(-1,-1,0),new It(-1,1,0),new It(1,1,0)),t=64,i=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:r,closed:s};const a=e.computeFrenetFrames(t,s);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const l=new It,d=new It,u=new Qi;let p=new It;const _=[],S=[],R=[],H=[];function se(Ce){p=e.getPointAt(Ce/t,p);const qe=a.normals[Ce],wt=a.binormals[Ce];for(let gt=0;gt<=r;gt++){const Et=gt/r*Math.PI*2,Xt=Math.sin(Et),Un=-Math.cos(Et);d.x=Un*qe.x+Xt*wt.x,d.y=Un*qe.y+Xt*wt.y,d.z=Un*qe.z+Xt*wt.z,d.normalize(),S.push(d.x,d.y,d.z),l.x=p.x+i*d.x,l.y=p.y+i*d.y,l.z=p.z+i*d.z,_.push(l.x,l.y,l.z)}}(function re(){for(let Ce=0;Ce<t;Ce++)se(Ce);se(!1===s?t:0),function Te(){for(let Ce=0;Ce<=t;Ce++)for(let qe=0;qe<=r;qe++)u.x=Ce/t,u.y=qe/r,R.push(u.x,u.y)}(),function ce(){for(let Ce=1;Ce<=t;Ce++)for(let qe=1;qe<=r;qe++){const gt=(r+1)*Ce+(qe-1),Et=(r+1)*Ce+qe,Xt=(r+1)*(Ce-1)+qe;H.push((r+1)*(Ce-1)+(qe-1),gt,Xt),H.push(gt,Et,Xt)}}()})(),this.setIndex(H),this.setAttribute("position",new Ws(_,3)),this.setAttribute("normal",new Ws(S,3)),this.setAttribute("uv",new Ws(R,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Xb((new LI[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}function DG(n,e,t){const i=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return!0!==t.has(i)&&!0!==t.has(r)&&(t.add(i),t.add(r),!0)}var IG=Object.freeze({__proto__:null,BoxGeometry:yp,CapsuleGeometry:K5,CircleGeometry:Z5,ConeGeometry:J5,CylinderGeometry:rC,DodecahedronGeometry:eF,EdgesGeometry:xG,ExtrudeGeometry:WI,IcosahedronGeometry:rF,LatheGeometry:UI,OctahedronGeometry:jI,PlaneGeometry:q2,PolyhedronGeometry:jb,RingGeometry:sF,ShapeGeometry:oF,SphereGeometry:Gy,TetrahedronGeometry:aF,TorusGeometry:lF,TorusKnotGeometry:cF,TubeGeometry:Xb,WireframeGeometry:class upe extends no{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){const t=[],i=new Set,r=new It,s=new It;if(null!==e.index){const a=e.attributes.position,l=e.index;let d=e.groups;0===d.length&&(d=[{start:0,count:l.count,materialIndex:0}]);for(let u=0,p=d.length;u<p;++u){const _=d[u],S=_.start;for(let H=S,re=S+_.count;H<re;H+=3)for(let se=0;se<3;se++){const ce=l.getX(H+se),Te=l.getX(H+(se+1)%3);r.fromBufferAttribute(a,ce),s.fromBufferAttribute(a,Te),!0===DG(r,s,i)&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{const a=e.attributes.position;for(let l=0,d=a.count/3;l<d;l++)for(let u=0;u<3;u++){const _=3*l+(u+1)%3;r.fromBufferAttribute(a,3*l+u),s.fromBufferAttribute(a,_),!0===DG(r,s,i)&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new Ws(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}});class hpe extends ld{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Cr(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class fpe extends Iu{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class $I extends ld{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Cr(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Cr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Qi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new M0,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class T0 extends $I{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Qi(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return bd(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Cr(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Cr(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Cr(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class pg extends ld{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Cr(16777215),this.specular=new Cr(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Cr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Qi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new M0,this.combine=zD,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class BG extends ld{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Cr(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Cr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Qi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class ppe extends ld{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Qi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class mpe extends ld{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Cr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Cr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Qi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new M0,this.combine=zD,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Ape extends ld{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Cr(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Qi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Yb extends Dc{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Kb(n,e,t){return!n||!t&&n.constructor===e?n:"number"==typeof e.BYTES_PER_ELEMENT?new e(n):Array.prototype.slice.call(n)}function RG(n){const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(function e(r,s){return n[r]-n[s]}),i}function dF(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,a=0;a!==i;++s){const l=t[s]*e;for(let d=0;d!==e;++d)r[a++]=n[l+d]}return r}function uF(n,e,t,i){let r=1,s=n[0];for(;void 0!==s&&void 0===s[i];)s=n[r++];if(void 0===s)return;let a=s[i];if(void 0!==a)if(Array.isArray(a))do{a=s[i],void 0!==a&&(e.push(s.time),t.push.apply(t,a)),s=n[r++]}while(void 0!==s);else if(void 0!==a.toArray)do{a=s[i],void 0!==a&&(e.push(s.time),a.toArray(t,t.length)),s=n[r++]}while(void 0!==s);else do{a=s[i],void 0!==a&&(e.push(s.time),t.push(a)),s=n[r++]}while(void 0!==s)}class lE{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let a;n:{i:if(!(e<r)){for(let l=i+2;;){if(void 0===r){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===l)break;if(s=r,r=t[++i],e<r)break t}a=t.length;break n}if(e>=s)break e;{const l=t[1];e<l&&(i=2,s=l);for(let d=i-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(i===d)break;if(r=s,s=t[--i-1],e>=s)break t}a=i,i=0}}for(;i<a;){const l=i+a>>>1;e<t[l]?a=l:i=l+1}if(r=t[i],s=t[i-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let a=0;a!==r;++a)t[a]=i[s+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class ype extends lE{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,a=e+1,l=r[s],d=r[a];if(void 0===l)switch(this.getSettings_().endingStart){case 2401:s=e,l=2*t-i;break;case 2402:s=r.length-2,l=t+r[s]-r[s+1];break;default:s=e,l=i}if(void 0===d)switch(this.getSettings_().endingEnd){case 2401:a=e,d=2*i-t;break;case 2402:a=1,d=i+r[1]-r[0];break;default:a=e-1,d=t}const u=.5*(i-t),p=this.valueSize;this._weightPrev=u/(t-l),this._weightNext=u/(d-i),this._offsetPrev=s*p,this._offsetNext=a*p}interpolate_(e,t,i,r){const s=this.resultBuffer,a=this.sampleValues,l=this.valueSize,d=e*l,u=d-l,p=this._offsetPrev,_=this._offsetNext,S=this._weightPrev,R=this._weightNext,H=(i-t)/(r-t),re=H*H,se=re*H,ce=-S*se+2*S*re-S*H,Te=(1+S)*se+(-1.5-2*S)*re+(-.5+S)*H+1,Ce=(-1-R)*se+(1.5+R)*re+.5*H,qe=R*se-R*re;for(let wt=0;wt!==l;++wt)s[wt]=ce*a[p+wt]+Te*a[u+wt]+Ce*a[d+wt]+qe*a[_+wt];return s}}class kG extends lE{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,a=this.sampleValues,l=this.valueSize,d=e*l,u=d-l,p=(i-t)/(r-t),_=1-p;for(let S=0;S!==l;++S)s[S]=a[u+S]*_+a[d+S]*p;return s}}class vpe extends lE{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class D0{constructor(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Kb(t,this.TimeBufferType),this.values=Kb(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:Kb(e.times,Array),values:Kb(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new vpe(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new kG(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new ype(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case b2:t=this.InterpolantFactoryMethodDiscrete;break;case Bb:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return b2;case this.InterpolantFactoryMethodLinear:return Bb;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,a=r-1;for(;s!==r&&i[s]<e;)++s;for(;-1!==a&&i[a]>t;)--a;if(++a,0!==s||a!==r){s>=a&&(a=Math.max(a,1),s=a-1);const l=this.getValueSize();this.times=i.slice(s,a),this.values=this.values.slice(s*l,a*l)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let l=0;l!==s;l++){const d=i[l];if("number"==typeof d&&isNaN(d)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,l,d),e=!1;break}if(null!==a&&a>d){console.error("THREE.KeyframeTrack: Out of order keys.",this,l,d,a),e=!1;break}a=d}if(void 0!==r&&function PG(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}(r))for(let l=0,d=r.length;l!==d;++l){const u=r[l];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,u),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),r=2302===this.getInterpolation(),s=e.length-1;let a=1;for(let l=1;l<s;++l){let d=!1;const u=e[l];if(u!==e[l+1]&&(1!==l||u!==e[0]))if(r)d=!0;else{const _=l*i,S=_-i,R=_+i;for(let H=0;H!==i;++H){const re=t[_+H];if(re!==t[S+H]||re!==t[R+H]){d=!0;break}}}if(d){if(l!==a){e[a]=e[l];const _=l*i,S=a*i;for(let R=0;R!==i;++R)t[S+R]=t[_+R]}++a}}if(s>0){e[a]=e[s];for(let l=s*i,d=a*i,u=0;u!==i;++u)t[d+u]=t[l+u];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=t.slice(0,a*i)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}D0.prototype.TimeBufferType=Float32Array,D0.prototype.ValueBufferType=Float32Array,D0.prototype.DefaultInterpolation=Bb;class aC extends D0{}aC.prototype.ValueTypeName="bool",aC.prototype.ValueBufferType=Array,aC.prototype.DefaultInterpolation=b2,aC.prototype.InterpolantFactoryMethodLinear=void 0,aC.prototype.InterpolantFactoryMethodSmooth=void 0;class FG extends D0{}FG.prototype.ValueTypeName="color";class lC extends D0{}lC.prototype.ValueTypeName="number";class bpe extends lE{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,a=this.sampleValues,l=this.valueSize,d=(i-t)/(r-t);let u=e*l;for(let p=u+l;u!==p;u+=4)Gc.slerpFlat(s,0,a,u-l,a,u,d);return s}}class Zb extends D0{InterpolantFactoryMethodLinear(e){return new bpe(this.times,this.values,this.getValueSize(),e)}}Zb.prototype.ValueTypeName="quaternion",Zb.prototype.DefaultInterpolation=Bb,Zb.prototype.InterpolantFactoryMethodSmooth=void 0;class cC extends D0{}cC.prototype.ValueTypeName="string",cC.prototype.ValueBufferType=Array,cC.prototype.DefaultInterpolation=b2,cC.prototype.InterpolantFactoryMethodLinear=void 0,cC.prototype.InterpolantFactoryMethodSmooth=void 0;class dC extends D0{}dC.prototype.ValueTypeName="vector";class cE{constructor(e,t=-1,i,r=2500){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=dm(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let a=0,l=i.length;a!==l;++a)t.push(wpe(i[a]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,a=i.length;s!==a;++s)t.push(D0.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,a=[];for(let l=0;l<s;l++){let d=[],u=[];d.push((l+s-1)%s,l,(l+1)%s),u.push(0,1,0);const p=RG(d);d=dF(d,1,p),u=dF(u,1,p),!r&&0===d[0]&&(d.push(s),u.push(u[0])),a.push(new lC(".morphTargetInfluences["+t[l].name+"]",d,u).scale(1/i))}return new this(e,-1,a)}static findByName(e,t){let i=e;Array.isArray(e)||(i=e.geometry&&e.geometry.animations||e.animations);for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let l=0,d=e.length;l<d;l++){const u=e[l],p=u.name.match(s);if(p&&p.length>1){const _=p[1];let S=r[_];S||(r[_]=S=[]),S.push(u)}}const a=[];for(const l in r)a.push(this.CreateFromMorphTargetSequence(l,r[l],t,i));return a}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(_,S,R,H,re){if(0!==R.length){const se=[],ce=[];uF(R,se,ce,H),0!==se.length&&re.push(new _(S,se,ce))}},r=[],s=e.name||"default",a=e.fps||30,l=e.blendMode;let d=e.length||-1;const u=e.hierarchy||[];for(let _=0;_<u.length;_++){const S=u[_].keys;if(S&&0!==S.length)if(S[0].morphTargets){const R={};let H;for(H=0;H<S.length;H++)if(S[H].morphTargets)for(let re=0;re<S[H].morphTargets.length;re++)R[S[H].morphTargets[re]]=-1;for(const re in R){const se=[],ce=[];for(let Te=0;Te!==S[H].morphTargets.length;++Te){const Ce=S[H];se.push(Ce.time),ce.push(Ce.morphTarget===re?1:0)}r.push(new lC(".morphTargetInfluence["+re+"]",se,ce))}d=R.length*a}else{const R=".bones["+t[_].name+"]";i(dC,R+".position",S,"pos",r),i(Zb,R+".quaternion",S,"rot",r),i(dC,R+".scale",S,"scl",r)}}return 0===r.length?null:new this(s,d,r,l)}resetDuration(){let t=0;for(let i=0,r=this.tracks.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function wpe(n){if(void 0===n.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function xpe(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return lC;case"vector":case"vector2":case"vector3":case"vector4":return dC;case"color":return FG;case"quaternion":return Zb;case"bool":case"boolean":return aC;case"string":return cC}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}(n.type);if(void 0===n.times){const t=[],i=[];uF(n.keys,t,i,"value"),n.times=t,n.values=i}return void 0!==e.parse?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const qy={enabled:!1,files:{},add:function(n,e){!1!==this.enabled&&(this.files[n]=e)},get:function(n){if(!1!==this.enabled)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class OG{constructor(e,t,i){const r=this;let d,s=!1,a=0,l=0;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(p){l++,!1===s&&void 0!==r.onStart&&r.onStart(p,a,l),s=!0},this.itemEnd=function(p){a++,void 0!==r.onProgress&&r.onProgress(p,a,l),a===l&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(p){void 0!==r.onError&&r.onError(p)},this.resolveURL=function(p){return d?d(p):p},this.setURLModifier=function(p){return d=p,this},this.addHandler=function(p,_){return u.push(p,_),this},this.removeHandler=function(p){const _=u.indexOf(p);return-1!==_&&u.splice(_,2),this},this.getHandler=function(p){for(let _=0,S=u.length;_<S;_+=2){const R=u[_],H=u[_+1];if(R.global&&(R.lastIndex=0),R.test(p))return H}return null}}}const Cpe=new OG;let Gh=(()=>{class n{constructor(t){this.manager=void 0!==t?t:Cpe,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,i){const r=this;return new Promise(function(s,a){r.load(t,s,i,a)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}return n.DEFAULT_MATERIAL_NAME="__DEFAULT",n})();const K_={};class Mpe extends Error{constructor(e,t){super(e),this.response=t}}class vp extends Gh{constructor(e){super(e)}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=qy.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(void 0!==K_[e])return void K_[e].push({onLoad:t,onProgress:i,onError:r});K_[e]=[],K_[e].push({onLoad:t,onProgress:i,onError:r});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),l=this.mimeType,d=this.responseType;fetch(a).then(u=>{if(200===u.status||0===u.status){if(0===u.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===u.body||void 0===u.body.getReader)return u;const p=K_[e],_=u.body.getReader(),S=u.headers.get("Content-Length")||u.headers.get("X-File-Size"),R=S?parseInt(S):0,H=0!==R;let re=0;const se=new ReadableStream({start(ce){!function Te(){_.read().then(({done:Ce,value:qe})=>{if(Ce)ce.close();else{re+=qe.byteLength;const wt=new ProgressEvent("progress",{lengthComputable:H,loaded:re,total:R});for(let gt=0,Et=p.length;gt<Et;gt++){const Xt=p[gt];Xt.onProgress&&Xt.onProgress(wt)}ce.enqueue(qe),Te()}})}()}});return new Response(se)}throw new Mpe(`fetch for "${u.url}" responded with ${u.status}: ${u.statusText}`,u)}).then(u=>{switch(d){case"arraybuffer":return u.arrayBuffer();case"blob":return u.blob();case"document":return u.text().then(p=>(new DOMParser).parseFromString(p,l));case"json":return u.json();default:if(void 0===l)return u.text();{const _=/charset="?([^;"\s]*)"?/i.exec(l),S=_&&_[1]?_[1].toLowerCase():void 0,R=new TextDecoder(S);return u.arrayBuffer().then(H=>R.decode(H))}}}).then(u=>{qy.add(e,u);const p=K_[e];delete K_[e];for(let _=0,S=p.length;_<S;_++){const R=p[_];R.onLoad&&R.onLoad(u)}}).catch(u=>{const p=K_[e];if(void 0===p)throw this.manager.itemError(e),u;delete K_[e];for(let _=0,S=p.length;_<S;_++){const R=p[_];R.onError&&R.onError(u)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class XI extends Gh{constructor(e){super(e)}load(e,t,i,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=qy.get(e);if(void 0!==a)return s.manager.itemStart(e),setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0),a;const l=qS("img");function d(){p(),qy.add(e,this),t&&t(this),s.manager.itemEnd(e)}function u(_){p(),r&&r(_),s.manager.itemError(e),s.manager.itemEnd(e)}function p(){l.removeEventListener("load",d,!1),l.removeEventListener("error",u,!1)}return l.addEventListener("load",d,!1),l.addEventListener("error",u,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(l.crossOrigin=this.crossOrigin),s.manager.itemStart(e),l.src=e,l}}class Spe extends Gh{constructor(e){super(e)}load(e,t,i,r){const s=new zh,a=new XI(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(l){s.image=l,s.needsUpdate=!0,void 0!==t&&t(s)},i,r),s}}class Jb extends Pl{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Cr(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}class Epe extends Jb{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Pl.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Cr(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const hF=new wo,LG=new It,NG=new It;class fF{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Qi(512,512),this.map=null,this.mapPass=null,this.matrix=new wo,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new gI,this._frameExtents=new Qi(1,1),this._viewportCount=1,this._viewports=[new nc(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;LG.setFromMatrixPosition(e.matrixWorld),t.position.copy(LG),NG.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(NG),t.updateMatrixWorld(),hF.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(hF),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(hF)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Tpe extends fF{constructor(){super(new Bu(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=2*M2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class UG extends Jb{constructor(e,t,i=0,r=Math.PI/3,s=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Pl.DEFAULT_UP),this.updateMatrix(),this.target=new Pl,this.distance=i,this.angle=r,this.penumbra=s,this.decay=a,this.map=null,this.shadow=new Tpe}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const zG=new wo,dE=new It,pF=new It;class Dpe extends fF{constructor(){super(new Bu(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Qi(4,2),this._viewportCount=6,this._viewports=[new nc(2,1,1,1),new nc(0,1,1,1),new nc(3,1,1,1),new nc(1,1,1,1),new nc(3,0,1,1),new nc(1,0,1,1)],this._cubeDirections=[new It(1,0,0),new It(-1,0,0),new It(0,0,1),new It(0,0,-1),new It(0,1,0),new It(0,-1,0)],this._cubeUps=[new It(0,1,0),new It(0,1,0),new It(0,1,0),new It(0,1,0),new It(0,0,1),new It(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),dE.setFromMatrixPosition(e.matrixWorld),i.position.copy(dE),pF.copy(i.position),pF.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(pF),i.updateMatrixWorld(),r.makeTranslation(-dE.x,-dE.y,-dE.z),zG.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(zG)}}class HG extends Jb{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new Dpe}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Ipe extends fF{constructor(){super(new Q2(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class uC extends Jb{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Pl.DEFAULT_UP),this.updateMatrix(),this.target=new Pl,this.shadow=new Ipe}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class YI extends Jb{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Bpe extends Jb{constructor(e,t,i=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class Ppe{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new It)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const i=e.x,r=e.y,s=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*r),t.addScaledVector(a[2],.488603*s),t.addScaledVector(a[3],.488603*i),t.addScaledVector(a[4],i*r*1.092548),t.addScaledVector(a[5],r*s*1.092548),t.addScaledVector(a[6],.315392*(3*s*s-1)),t.addScaledVector(a[7],i*s*1.092548),t.addScaledVector(a[8],.546274*(i*i-r*r)),t}getIrradianceAt(e,t){const i=e.x,r=e.y,s=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],1.023328*r),t.addScaledVector(a[2],1.023328*s),t.addScaledVector(a[3],1.023328*i),t.addScaledVector(a[4],.858086*i*r),t.addScaledVector(a[5],.858086*r*s),t.addScaledVector(a[6],.743125*s*s-.247708),t.addScaledVector(a[7],.858086*i*s),t.addScaledVector(a[8],.429043*(i*i-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,t+3*r);return this}toArray(e=[],t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,t+3*r);return e}static getBasisAt(e,t){const i=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*i,t[4]=1.092548*i*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*i*s,t[8]=.546274*(i*i-r*r)}}class Rpe extends Jb{constructor(e=new Ppe,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class mF extends Gh{constructor(e){super(e),this.textures={}}load(e,t,i,r){const s=this,a=new vp(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(l){try{t(s.parse(JSON.parse(l)))}catch(d){r?r(d):console.error(d),s.manager.itemError(e)}},i,r)}parse(e){const t=this.textures;function i(s){return void 0===t[s]&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const r=mF.createMaterialFromType(e.type);if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&void 0!==r.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.sheen&&(r.sheen=e.sheen),void 0!==e.sheenColor&&(r.sheenColor=(new Cr).setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(r.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==r.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==r.specular&&r.specular.setHex(e.specular),void 0!==e.specularIntensity&&(r.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==r.specularColor&&r.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearcoat&&(r.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(r.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.iridescence&&(r.iridescence=e.iridescence),void 0!==e.iridescenceIOR&&(r.iridescenceIOR=e.iridescenceIOR),void 0!==e.iridescenceThicknessRange&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),void 0!==e.transmission&&(r.transmission=e.transmission),void 0!==e.thickness&&(r.thickness=e.thickness),void 0!==e.attenuationDistance&&(r.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==r.attenuationColor&&r.attenuationColor.setHex(e.attenuationColor),void 0!==e.anisotropy&&(r.anisotropy=e.anisotropy),void 0!==e.anisotropyRotation&&(r.anisotropyRotation=e.anisotropyRotation),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.shadowSide&&(r.shadowSide=e.shadowSide),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.alphaHash&&(r.alphaHash=e.alphaHash),void 0!==e.depthFunc&&(r.depthFunc=e.depthFunc),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.blendSrc&&(r.blendSrc=e.blendSrc),void 0!==e.blendDst&&(r.blendDst=e.blendDst),void 0!==e.blendEquation&&(r.blendEquation=e.blendEquation),void 0!==e.blendSrcAlpha&&(r.blendSrcAlpha=e.blendSrcAlpha),void 0!==e.blendDstAlpha&&(r.blendDstAlpha=e.blendDstAlpha),void 0!==e.blendEquationAlpha&&(r.blendEquationAlpha=e.blendEquationAlpha),void 0!==e.blendColor&&void 0!==r.blendColor&&r.blendColor.setHex(e.blendColor),void 0!==e.blendAlpha&&(r.blendAlpha=e.blendAlpha),void 0!==e.stencilWriteMask&&(r.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(r.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(r.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(r.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(r.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(r.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(r.stencilZPass=e.stencilZPass),void 0!==e.stencilWrite&&(r.stencilWrite=e.stencilWrite),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),void 0!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.alphaToCoverage&&(r.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(r.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.forceSinglePass&&(r.forceSinglePass=e.forceSinglePass),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.toneMapped&&(r.toneMapped=e.toneMapped),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.vertexColors&&(r.vertexColors="number"==typeof e.vertexColors?e.vertexColors>0:e.vertexColors),void 0!==e.uniforms)for(const s in e.uniforms){const a=e.uniforms[s];switch(r.uniforms[s]={},a.type){case"t":r.uniforms[s].value=i(a.value);break;case"c":r.uniforms[s].value=(new Cr).setHex(a.value);break;case"v2":r.uniforms[s].value=(new Qi).fromArray(a.value);break;case"v3":r.uniforms[s].value=(new It).fromArray(a.value);break;case"v4":r.uniforms[s].value=(new nc).fromArray(a.value);break;case"m3":r.uniforms[s].value=(new Ta).fromArray(a.value);break;case"m4":r.uniforms[s].value=(new wo).fromArray(a.value);break;default:r.uniforms[s].value=a.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.glslVersion&&(r.glslVersion=e.glslVersion),void 0!==e.extensions)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(void 0!==e.lights&&(r.lights=e.lights),void 0!==e.clipping&&(r.clipping=e.clipping),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=i(e.map)),void 0!==e.matcap&&(r.matcap=i(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=i(e.alphaMap)),void 0!==e.bumpMap&&(r.bumpMap=i(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=i(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){let s=e.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new Qi).fromArray(s)}return void 0!==e.displacementMap&&(r.displacementMap=i(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=i(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=i(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=i(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=i(e.specularMap)),void 0!==e.specularIntensityMap&&(r.specularIntensityMap=i(e.specularIntensityMap)),void 0!==e.specularColorMap&&(r.specularColorMap=i(e.specularColorMap)),void 0!==e.envMap&&(r.envMap=i(e.envMap)),void 0!==e.envMapRotation&&r.envMapRotation.fromArray(e.envMapRotation),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=i(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=i(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=i(e.gradientMap)),void 0!==e.clearcoatMap&&(r.clearcoatMap=i(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(r.clearcoatNormalMap=i(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(r.clearcoatNormalScale=(new Qi).fromArray(e.clearcoatNormalScale)),void 0!==e.iridescenceMap&&(r.iridescenceMap=i(e.iridescenceMap)),void 0!==e.iridescenceThicknessMap&&(r.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),void 0!==e.transmissionMap&&(r.transmissionMap=i(e.transmissionMap)),void 0!==e.thicknessMap&&(r.thicknessMap=i(e.thicknessMap)),void 0!==e.anisotropyMap&&(r.anisotropyMap=i(e.anisotropyMap)),void 0!==e.sheenColorMap&&(r.sheenColorMap=i(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(r.sheenRoughnessMap=i(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){return new{ShadowMaterial:hpe,SpriteMaterial:QV,RawShaderMaterial:fpe,ShaderMaterial:Iu,PointsMaterial:X_,MeshPhysicalMaterial:T0,MeshStandardMaterial:$I,MeshPhongMaterial:pg,MeshToonMaterial:BG,MeshNormalMaterial:ppe,MeshLambertMaterial:mpe,MeshDepthMaterial:P5,MeshDistanceMaterial:GV,MeshBasicMaterial:xd,MeshMatcapMaterial:Ape,LineDashedMaterial:Yb,LineBasicMaterial:Dc,Material:ld}[e]}}class ex{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class kpe extends no{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class Fpe extends Gh{constructor(e){super(e)}load(e,t,i,r){const s=this,a=new vp(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(l){try{t(s.parse(JSON.parse(l)))}catch(d){r?r(d):console.error(d),s.manager.itemError(e)}},i,r)}parse(e){const t={},i={};function r(R,H){if(void 0!==t[H])return t[H];const se=R.interleavedBuffers[H],ce=function s(R,H){if(void 0!==i[H])return i[H];const ce=new Uint32Array(R.arrayBuffers[H]).buffer;return i[H]=ce,ce}(R,se.buffer),Te=S2(se.type,ce),Ce=new wI(Te,se.stride);return Ce.uuid=se.uuid,t[H]=Ce,Ce}const a=e.isInstancedBufferGeometry?new kpe:new no,l=e.data.index;if(void 0!==l){const R=S2(l.type,l.array);a.setIndex(new No(R,1))}const d=e.data.attributes;for(const R in d){const H=d[R];let re;if(H.isInterleavedBufferAttribute){const se=r(e.data,H.data);re=new Gb(se,H.itemSize,H.offset,H.normalized)}else{const se=S2(H.type,H.array);re=new(H.isInstancedBufferAttribute?eC:No)(se,H.itemSize,H.normalized)}void 0!==H.name&&(re.name=H.name),void 0!==H.usage&&re.setUsage(H.usage),a.setAttribute(R,re)}const u=e.data.morphAttributes;if(u)for(const R in u){const H=u[R],re=[];for(let se=0,ce=H.length;se<ce;se++){const Te=H[se];let Ce;if(Te.isInterleavedBufferAttribute){const qe=r(e.data,Te.data);Ce=new Gb(qe,Te.itemSize,Te.offset,Te.normalized)}else{const qe=S2(Te.type,Te.array);Ce=new No(qe,Te.itemSize,Te.normalized)}void 0!==Te.name&&(Ce.name=Te.name),re.push(Ce)}a.morphAttributes[R]=re}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);const _=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==_)for(let R=0,H=_.length;R!==H;++R){const re=_[R];a.addGroup(re.start,re.count,re.materialIndex)}const S=e.data.boundingSphere;if(void 0!==S){const R=new It;void 0!==S.center&&R.fromArray(S.center),a.boundingSphere=new $u(R,S.radius)}return e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}}class Ope extends Gh{constructor(e){super(e)}load(e,t,i,r){const s=this,a=""===this.path?ex.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const l=new vp(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(d){let u=null;try{u=JSON.parse(d)}catch(_){return void 0!==r&&r(_),void console.error("THREE:ObjectLoader: Can't parse "+e+".",_.message)}const p=u.metadata;if(void 0===p||void 0===p.type||"geometry"===p.type.toLowerCase())return void 0!==r&&r(new Error("THREE.ObjectLoader: Can't load "+e)),void console.error("THREE.ObjectLoader: Can't load "+e);s.parse(u,t)},i,r)}loadAsync(e,t){var i=this;return(0,Ee.A)(function*(){const r=i,s=""===i.path?ex.extractUrlBase(e):i.path;i.resourcePath=i.resourcePath||s;const a=new vp(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials);const l=yield a.loadAsync(e,t),d=JSON.parse(l),u=d.metadata;if(void 0===u||void 0===u.type||"geometry"===u.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+e);return yield r.parseAsync(d)})()}parse(e,t){const i=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),a=this.parseImages(e.images,function(){void 0!==t&&t(u)}),l=this.parseTextures(e.textures,a),d=this.parseMaterials(e.materials,l),u=this.parseObject(e.object,s,d,l,i),p=this.parseSkeletons(e.skeletons,u);if(this.bindSkeletons(u,p),void 0!==t){let _=!1;for(const S in a)if(a[S].data instanceof HTMLImageElement){_=!0;break}!1===_&&t(u)}return u}parseAsync(e){var t=this;return(0,Ee.A)(function*(){const i=t.parseAnimations(e.animations),r=t.parseShapes(e.shapes),s=t.parseGeometries(e.geometries,r),a=yield t.parseImagesAsync(e.images),l=t.parseTextures(e.textures,a),d=t.parseMaterials(e.materials,l),u=t.parseObject(e.object,s,d,l,i),p=t.parseSkeletons(e.skeletons,u);return t.bindSkeletons(u,p),u})()}parseShapes(e){const t={};if(void 0!==e)for(let i=0,r=e.length;i<r;i++){const s=(new sC).fromJSON(e[i]);t[s.uuid]=s}return t}parseSkeletons(e,t){const i={},r={};if(t.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),void 0!==e)for(let s=0,a=e.length;s<a;s++){const l=(new DI).fromJSON(e[s],r);i[l.uuid]=l}return i}parseGeometries(e,t){const i={};if(void 0!==e){const r=new Fpe;for(let s=0,a=e.length;s<a;s++){let l;const d=e[s];switch(d.type){case"BufferGeometry":case"InstancedBufferGeometry":l=r.parse(d);break;default:d.type in IG?l=IG[d.type].fromJSON(d,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${d.type}"`)}l.uuid=d.uuid,void 0!==d.name&&(l.name=d.name),void 0!==d.userData&&(l.userData=d.userData),i[d.uuid]=l}}return i}parseMaterials(e,t){const i={},r={};if(void 0!==e){const s=new mF;s.setTextures(t);for(let a=0,l=e.length;a<l;a++){const d=e[a];void 0===i[d.uuid]&&(i[d.uuid]=s.parse(d)),r[d.uuid]=i[d.uuid]}}return r}parseAnimations(e){const t={};if(void 0!==e)for(let i=0;i<e.length;i++){const s=cE.parse(e[i]);t[s.uuid]=s}return t}parseImages(e,t){const i=this,r={};let s;function l(d){if("string"==typeof d){const u=d;return function a(d){return i.manager.itemStart(d),s.load(d,function(){i.manager.itemEnd(d)},void 0,function(){i.manager.itemError(d),i.manager.itemEnd(d)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u)?u:i.resourcePath+u)}return d.data?{data:S2(d.type,d.data),width:d.width,height:d.height}:null}if(void 0!==e&&e.length>0){const d=new OG(t);s=new XI(d),s.setCrossOrigin(this.crossOrigin);for(let u=0,p=e.length;u<p;u++){const _=e[u],S=_.url;if(Array.isArray(S)){const R=[];for(let H=0,re=S.length;H<re;H++){const ce=l(S[H]);null!==ce&&(ce instanceof HTMLImageElement?R.push(ce):R.push(new qb(ce.data,ce.width,ce.height)))}r[_.uuid]=new kb(R)}else{const R=l(_.url);r[_.uuid]=new kb(R)}}}return r}parseImagesAsync(e){var t=this;return(0,Ee.A)(function*(){const i=t,r={};let s;function a(d){return l.apply(this,arguments)}function l(){return(l=(0,Ee.A)(function*(d){if("string"==typeof d){const u=d,p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u)?u:i.resourcePath+u;return yield s.loadAsync(p)}return d.data?{data:S2(d.type,d.data),width:d.width,height:d.height}:null})).apply(this,arguments)}if(void 0!==e&&e.length>0){s=new XI(t.manager),s.setCrossOrigin(t.crossOrigin);for(let d=0,u=e.length;d<u;d++){const p=e[d],_=p.url;if(Array.isArray(_)){const S=[];for(let R=0,H=_.length;R<H;R++){const re=_[R],se=yield a(re);null!==se&&(se instanceof HTMLImageElement?S.push(se):S.push(new qb(se.data,se.width,se.height)))}r[p.uuid]=new kb(S)}else{const S=yield a(p.url);r[p.uuid]=new kb(S)}}}return r})()}parseTextures(e,t){function i(s,a){return"number"==typeof s?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),a[s])}const r={};if(void 0!==e)for(let s=0,a=e.length;s<a;s++){const l=e[s];void 0===l.image&&console.warn('THREE.ObjectLoader: No "image" specified for',l.uuid),void 0===t[l.image]&&console.warn("THREE.ObjectLoader: Undefined image",l.image);const d=t[l.image],u=d.data;let p;Array.isArray(u)?(p=new mI,6===u.length&&(p.needsUpdate=!0)):(p=u&&u.data?new qb:new zh,u&&(p.needsUpdate=!0)),p.source=d,p.uuid=l.uuid,void 0!==l.name&&(p.name=l.name),void 0!==l.mapping&&(p.mapping=i(l.mapping,Lpe)),void 0!==l.channel&&(p.channel=l.channel),void 0!==l.offset&&p.offset.fromArray(l.offset),void 0!==l.repeat&&p.repeat.fromArray(l.repeat),void 0!==l.center&&p.center.fromArray(l.center),void 0!==l.rotation&&(p.rotation=l.rotation),void 0!==l.wrap&&(p.wrapS=i(l.wrap[0],VG),p.wrapT=i(l.wrap[1],VG)),void 0!==l.format&&(p.format=l.format),void 0!==l.internalFormat&&(p.internalFormat=l.internalFormat),void 0!==l.type&&(p.type=l.type),void 0!==l.colorSpace&&(p.colorSpace=l.colorSpace),void 0!==l.minFilter&&(p.minFilter=i(l.minFilter,GG)),void 0!==l.magFilter&&(p.magFilter=i(l.magFilter,GG)),void 0!==l.anisotropy&&(p.anisotropy=l.anisotropy),void 0!==l.flipY&&(p.flipY=l.flipY),void 0!==l.generateMipmaps&&(p.generateMipmaps=l.generateMipmaps),void 0!==l.premultiplyAlpha&&(p.premultiplyAlpha=l.premultiplyAlpha),void 0!==l.unpackAlignment&&(p.unpackAlignment=l.unpackAlignment),void 0!==l.compareFunction&&(p.compareFunction=l.compareFunction),void 0!==l.userData&&(p.userData=l.userData),r[l.uuid]=p}return r}parseObject(e,t,i,r,s){let a,p,_;function l(S){return void 0===t[S]&&console.warn("THREE.ObjectLoader: Undefined geometry",S),t[S]}function d(S){if(void 0!==S){if(Array.isArray(S)){const R=[];for(let H=0,re=S.length;H<re;H++){const se=S[H];void 0===i[se]&&console.warn("THREE.ObjectLoader: Undefined material",se),R.push(i[se])}return R}return void 0===i[S]&&console.warn("THREE.ObjectLoader: Undefined material",S),i[S]}}function u(S){return void 0===r[S]&&console.warn("THREE.ObjectLoader: Undefined texture",S),r[S]}switch(e.type){case"Scene":a=new YS,void 0!==e.background&&(a.background=Number.isInteger(e.background)?new Cr(e.background):u(e.background)),void 0!==e.environment&&(a.environment=u(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?a.fog=new F5(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(a.fog=new k5(e.fog.color,e.fog.density)),""!==e.fog.name&&(a.fog.name=e.fog.name)),void 0!==e.backgroundBlurriness&&(a.backgroundBlurriness=e.backgroundBlurriness),void 0!==e.backgroundIntensity&&(a.backgroundIntensity=e.backgroundIntensity),void 0!==e.backgroundRotation&&a.backgroundRotation.fromArray(e.backgroundRotation),void 0!==e.environmentRotation&&a.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":a=new Bu(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(a.focus=e.focus),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.filmGauge&&(a.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(a.filmOffset=e.filmOffset),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new Q2(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new YI(e.color,e.intensity);break;case"DirectionalLight":a=new uC(e.color,e.intensity);break;case"PointLight":a=new HG(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new Bpe(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new UG(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":a=new Epe(e.color,e.groundColor,e.intensity);break;case"LightProbe":a=(new Rpe).fromJSON(e);break;case"SkinnedMesh":p=l(e.geometry),_=d(e.material),a=new tG(p,_),void 0!==e.bindMode&&(a.bindMode=e.bindMode),void 0!==e.bindMatrix&&a.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(a.skeleton=e.skeleton);break;case"Mesh":p=l(e.geometry),_=d(e.material),a=new ua(p,_);break;case"InstancedMesh":p=l(e.geometry),_=d(e.material);const R=e.instanceMatrix,H=e.instanceColor;a=new sG(p,_,e.count),a.instanceMatrix=new eC(new Float32Array(R.array),16),void 0!==H&&(a.instanceColor=new eC(new Float32Array(H.array),H.itemSize));break;case"BatchedMesh":p=l(e.geometry),_=d(e.material),a=new Rfe(e.maxGeometryCount,e.maxVertexCount,e.maxIndexCount,_),a.geometry=p,a.perObjectFrustumCulled=e.perObjectFrustumCulled,a.sortObjects=e.sortObjects,a._drawRanges=e.drawRanges,a._reservedRanges=e.reservedRanges,a._visibility=e.visibility,a._active=e.active,a._bounds=e.bounds.map(re=>{const se=new Pf;se.min.fromArray(re.boxMin),se.max.fromArray(re.boxMax);const ce=new $u;return ce.radius=re.sphereRadius,ce.center.fromArray(re.sphereCenter),{boxInitialized:re.boxInitialized,box:se,sphereInitialized:re.sphereInitialized,sphere:ce}}),a._maxGeometryCount=e.maxGeometryCount,a._maxVertexCount=e.maxVertexCount,a._maxIndexCount=e.maxIndexCount,a._geometryInitialized=e.geometryInitialized,a._geometryCount=e.geometryCount,a._matricesTexture=u(e.matricesTexture.uuid);break;case"LOD":a=new Cfe;break;case"Line":a=new fg(l(e.geometry),d(e.material));break;case"LineLoop":a=new fG(l(e.geometry),d(e.material));break;case"LineSegments":a=new hc(l(e.geometry),d(e.material));break;case"PointCloud":case"Points":a=new Wb(l(e.geometry),d(e.material));break;case"Sprite":a=new wfe(d(e.material));break;case"Group":a=new Wl;break;case"Bone":a=new U5;break;default:a=new Pl}if(a.uuid=e.uuid,void 0!==e.name&&(a.name=e.name),void 0!==e.matrix?(a.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(void 0!==e.position&&a.position.fromArray(e.position),void 0!==e.rotation&&a.rotation.fromArray(e.rotation),void 0!==e.quaternion&&a.quaternion.fromArray(e.quaternion),void 0!==e.scale&&a.scale.fromArray(e.scale)),void 0!==e.up&&a.up.fromArray(e.up),void 0!==e.castShadow&&(a.castShadow=e.castShadow),void 0!==e.receiveShadow&&(a.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(a.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(a.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(a.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&a.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(a.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(a.visible=e.visible),void 0!==e.frustumCulled&&(a.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(a.renderOrder=e.renderOrder),void 0!==e.userData&&(a.userData=e.userData),void 0!==e.layers&&(a.layers.mask=e.layers),void 0!==e.children){const S=e.children;for(let R=0;R<S.length;R++)a.add(this.parseObject(S[R],t,i,r,s))}if(void 0!==e.animations){const S=e.animations;for(let R=0;R<S.length;R++)a.animations.push(s[S[R]])}if("LOD"===e.type){void 0!==e.autoUpdate&&(a.autoUpdate=e.autoUpdate);const S=e.levels;for(let R=0;R<S.length;R++){const H=S[R],re=a.getObjectByProperty("uuid",H.object);void 0!==re&&a.addLevel(re,H.distance,H.hysteresis)}}return a}bindSkeletons(e,t){0!==Object.keys(t).length&&e.traverse(function(i){if(!0===i.isSkinnedMesh&&void 0!==i.skeleton){const r=t[i.skeleton];void 0===r?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(r,i.bindMatrix)}})}}const Lpe={UVMapping:300,CubeReflectionMapping:By,CubeRefractionMapping:Tb,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,CubeUVReflectionMapping:zS},VG={RepeatWrapping:Py,ClampToEdgeWrapping:bh,MirroredRepeatWrapping:_2},GG={NearestFilter:vd,NearestMipmapNearestFilter:1004,NearestMipmapLinearFilter:Ry,LinearFilter:Hc,LinearMipmapNearestFilter:y2,LinearMipmapLinearFilter:oA};class Npe extends Gh{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=qy.get(e);if(void 0!==a)return s.manager.itemStart(e),a.then?void a.then(u=>{t&&t(u),s.manager.itemEnd(e)}).catch(u=>{r&&r(u)}):(setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0),a);const l={};l.credentials="anonymous"===this.crossOrigin?"same-origin":"include",l.headers=this.requestHeader;const d=fetch(e,l).then(function(u){return u.blob()}).then(function(u){return createImageBitmap(u,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(u){return qy.add(e,u),t&&t(u),s.manager.itemEnd(e),u}).catch(function(u){r&&r(u),qy.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});qy.add(e,d),s.manager.itemStart(e)}}class jG{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=$G(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=$G();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function $G(){return(typeof performance>"u"?Date:performance).now()}const AF="\\[\\]\\.:\\/",Gpe=new RegExp("["+AF+"]","g"),gF="[^"+AF+"]",qpe="[^"+AF.replace("\\.","")+"]",Xpe=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",gF)+/(WCOD+)?/.source.replace("WCOD",qpe)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",gF)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",gF)+"$"),Ype=["material","materials","bones","map"];class Kpe{constructor(e,t,i){const r=i||Ll.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let Ll=(()=>{class n{constructor(t,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,r){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,r):new n(t,i,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(Gpe,"")}static parseTrackName(t){const i=Xpe.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const a=r.nodeName.substring(s+1);-1!==Ype.indexOf(a)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=a)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(i);if(void 0!==r)return r}if(t.children){const r=function(a){for(let l=0;l<a.length;l++){const d=a[l];if(d.name===i||d.uuid===i)return d;const u=r(d.children);if(u)return u}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const r=this.resolvedProperty;for(let s=0,a=r.length;s!==a;++s)t[i++]=r[s]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const r=this.resolvedProperty;for(let s=0,a=r.length;s!==a;++s)r[s]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,a=r.length;s!==a;++s)r[s]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,a=r.length;s!==a;++s)r[s]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,r=i.objectName,s=i.propertyName;let a=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(r){let p=i.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let _=0;_<t.length;_++)if(t[_].name===p){p=_;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==p){if(void 0===t[p])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[p]}}const l=t[s];if(void 0===l)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+s+" but it wasn't found.",t);let d=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?d=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(d=this.Versioning.MatrixWorldNeedsUpdate);let u=this.BindingType.Direct;if(void 0!==a){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[a]&&(a=t.morphTargetDictionary[a])}u=this.BindingType.ArrayElement,this.resolvedProperty=l,this.propertyIndex=a}else void 0!==l.fromArray&&void 0!==l.toArray?(u=this.BindingType.HasFromToArray,this.resolvedProperty=l):Array.isArray(l)?(u=this.BindingType.EntireArray,this.resolvedProperty=l):this.propertyName=s;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][d]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=Kpe,n})();Ll.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Ll.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Ll.prototype.GetterByBindingType=[Ll.prototype._getValue_direct,Ll.prototype._getValue_array,Ll.prototype._getValue_arrayElement,Ll.prototype._getValue_toArray],Ll.prototype.SetterByBindingTypeAndVersioning=[[Ll.prototype._setValue_direct,Ll.prototype._setValue_direct_setNeedsUpdate,Ll.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Ll.prototype._setValue_array,Ll.prototype._setValue_array_setNeedsUpdate,Ll.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Ll.prototype._setValue_arrayElement,Ll.prototype._setValue_arrayElement_setNeedsUpdate,Ll.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Ll.prototype._setValue_fromArray,Ll.prototype._setValue_fromArray_setNeedsUpdate,Ll.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);class _F{constructor(e){this.value=e}clone(){return new _F(void 0===this.value.clone?this.value:this.value.clone())}}const KG=new wo;class ZG{constructor(e,t,i=0,r=1/0){this.ray=new P2(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new h5,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return KG.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(KG),this}intersectObject(e,t=!0,i=[]){return yF(e,this,i,t),i.sort(JG),i}intersectObjects(e,t=!0,i=[]){for(let r=0,s=e.length;r<s;r++)yF(e[r],this,i,t);return i.sort(JG),i}}function JG(n,e){return n.distance-e.distance}function yF(n,e,t,i){if(n.layers.test(e.layers)&&n.raycast(e,t),!0===i){const r=n.children;for(let s=0,a=r.length;s<a;s++)yF(r[s],e,t,!0)}}class eq{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(bd(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}const nq=new It,ZI=new It;class dq extends hc{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=new no;r.setAttribute("position",new Ws(t,3)),r.setAttribute("color",new Ws([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(r,new Dc({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,i){const r=new Cr,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(i),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class ime{constructor(){this.type="ShapePath",this.color=new Cr,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new NI,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,i,r){return this.currentPath.quadraticCurveTo(e,t,i,r),this}bezierCurveTo(e,t,i,r,s,a){return this.currentPath.bezierCurveTo(e,t,i,r,s,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function i(ce,Te){const Ce=Te.length;let qe=!1;for(let wt=Ce-1,gt=0;gt<Ce;wt=gt++){let Et=Te[wt],Xt=Te[gt],Un=Xt.x-Et.x,Ct=Xt.y-Et.y;if(Math.abs(Ct)>Number.EPSILON){if(Ct<0&&(Et=Te[gt],Un=-Un,Xt=Te[wt],Ct=-Ct),ce.y<Et.y||ce.y>Xt.y)continue;if(ce.y===Et.y){if(ce.x===Et.x)return!0}else{const Kt=Ct*(ce.x-Et.x)-Un*(ce.y-Et.y);if(0===Kt)return!0;if(Kt<0)continue;qe=!qe}}else{if(ce.y!==Et.y)continue;if(Xt.x<=ce.x&&ce.x<=Et.x||Et.x<=ce.x&&ce.x<=Xt.x)return!0}}return qe}const r=Y_.isClockWise,s=this.subPaths;if(0===s.length)return[];let a,l,d;const u=[];if(1===s.length)return l=s[0],d=new sC,d.curves=l.curves,u.push(d),u;let p=!r(s[0].getPoints());p=e?!p:p;const _=[],S=[];let re,se,R=[],H=0;S[H]=void 0,R[H]=[];for(let ce=0,Te=s.length;ce<Te;ce++)l=s[ce],re=l.getPoints(),a=r(re),a=e?!a:a,a?(!p&&S[H]&&H++,S[H]={s:new sC,p:re},S[H].s.curves=l.curves,p&&H++,R[H]=[]):R[H].push({h:l,p:re[0]});if(!S[0])return function t(ce){const Te=[];for(let Ce=0,qe=ce.length;Ce<qe;Ce++){const wt=ce[Ce],gt=new sC;gt.curves=wt.curves,Te.push(gt)}return Te}(s);if(S.length>1){let ce=!1,Te=0;for(let Ce=0,qe=S.length;Ce<qe;Ce++)_[Ce]=[];for(let Ce=0,qe=S.length;Ce<qe;Ce++){const wt=R[Ce];for(let gt=0;gt<wt.length;gt++){const Et=wt[gt];let Xt=!0;for(let Un=0;Un<S.length;Un++)i(Et.p,S[Un].p)&&(Ce!==Un&&Te++,Xt?(Xt=!1,_[Un].push(Et)):ce=!0);Xt&&_[Ce].push(Et)}}Te>0&&!1===ce&&(R=_)}for(let ce=0,Te=S.length;ce<Te;ce++){d=S[ce].s,u.push(d),se=R[ce];for(let Ce=0,qe=se.length;Ce<qe;Ce++)d.holes.push(se[Ce].h)}return u}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:m2}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=m2);var rme=Se(5747),sme=Se.n(rme);const uq={type:"change"},xF={type:"start"},hq={type:"end"},s4=new P2,fq=new dA,ome=Math.cos(70*GS.DEG2RAD);class ame extends V_{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new It,this.cursor=new It,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return l.phi},this.getAzimuthalAngle=function(){return l.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(Tn){Tn.addEventListener("keydown",Qo),this._domElementKeyEvents=Tn},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",Qo),this._domElementKeyEvents=null},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(uq),i.update(),s=r.NONE},this.update=function(){const Tn=new It,Er=(new Gc).setFromUnitVectors(e.up,new It(0,1,0)),mo=Er.clone().invert(),Xn=new It,rs=new Gc,ki=new It,Xr=2*Math.PI;return function(Xa=null){const jl=i.object.position;Tn.copy(jl).sub(i.target),Tn.applyQuaternion(Er),l.setFromVector3(Tn),i.autoRotate&&s===r.NONE&&Gi(function Ct(Tn){return null!==Tn?2*Math.PI/60*i.autoRotateSpeed*Tn:2*Math.PI/60/60*i.autoRotateSpeed}(Xa)),i.enableDamping?(l.theta+=d.theta*i.dampingFactor,l.phi+=d.phi*i.dampingFactor):(l.theta+=d.theta,l.phi+=d.phi);let pc=i.minAzimuthAngle,Ed=i.maxAzimuthAngle;isFinite(pc)&&isFinite(Ed)&&(pc<-Math.PI?pc+=Xr:pc>Math.PI&&(pc-=Xr),Ed<-Math.PI?Ed+=Xr:Ed>Math.PI&&(Ed-=Xr),l.theta=pc<=Ed?Math.max(pc,Math.min(Ed,l.theta)):l.theta>(pc+Ed)/2?Math.max(pc,l.theta):Math.min(Ed,l.theta)),l.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,l.phi)),l.makeSafe(),!0===i.enableDamping?i.target.addScaledVector(p,i.dampingFactor):i.target.add(p),i.target.sub(i.cursor),i.target.clampLength(i.minTargetRadius,i.maxTargetRadius),i.target.add(i.cursor);let Ml=!1;if(i.zoomToCursor&&gt||i.object.isOrthographicCamera)l.radius=mr(l.radius);else{const Qc=l.radius;l.radius=mr(l.radius*u),Ml=Qc!=l.radius}if(Tn.setFromSpherical(l),Tn.applyQuaternion(mo),jl.copy(i.target).add(Tn),i.object.lookAt(i.target),!0===i.enableDamping?(d.theta*=1-i.dampingFactor,d.phi*=1-i.dampingFactor,p.multiplyScalar(1-i.dampingFactor)):(d.set(0,0,0),p.set(0,0,0)),i.zoomToCursor&&gt){let Qc=null;if(i.object.isPerspectiveCamera){const Qh=Tn.length();Qc=mr(Qh*u);const Mx=Qh-Qc;i.object.position.addScaledVector(qe,Mx),i.object.updateMatrixWorld(),Ml=!!Mx}else if(i.object.isOrthographicCamera){const Qh=new It(wt.x,wt.y,0);Qh.unproject(i.object);const Mx=i.object.zoom;i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/u)),i.object.updateProjectionMatrix(),Ml=Mx!==i.object.zoom;const EB=new It(wt.x,wt.y,0);EB.unproject(i.object),i.object.position.sub(EB).add(Qh),i.object.updateMatrixWorld(),Qc=Tn.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),i.zoomToCursor=!1;null!==Qc&&(this.screenSpacePanning?i.target.set(0,0,-1).transformDirection(i.object.matrix).multiplyScalar(Qc).add(i.object.position):(s4.origin.copy(i.object.position),s4.direction.set(0,0,-1).transformDirection(i.object.matrix),Math.abs(i.object.up.dot(s4.direction))<ome?e.lookAt(i.target):(fq.setFromNormalAndCoplanarPoint(i.object.up,i.target),s4.intersectPlane(fq,i.target))))}else if(i.object.isOrthographicCamera){const Qc=i.object.zoom;i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/u)),Qc!==i.object.zoom&&(i.object.updateProjectionMatrix(),Ml=!0)}return u=1,gt=!1,!!(Ml||Xn.distanceToSquared(i.object.position)>a||8*(1-rs.dot(i.object.quaternion))>a||ki.distanceToSquared(i.target)>a)&&(i.dispatchEvent(uq),Xn.copy(i.object.position),rs.copy(i.object.quaternion),ki.copy(i.target),!0)}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",ga),i.domElement.removeEventListener("pointerdown",uo),i.domElement.removeEventListener("pointercancel",gn),i.domElement.removeEventListener("wheel",hr),i.domElement.removeEventListener("pointermove",ka),i.domElement.removeEventListener("pointerup",gn),i.domElement.getRootNode().removeEventListener("keydown",Or,{capture:!0}),null!==i._domElementKeyEvents&&(i._domElementKeyEvents.removeEventListener("keydown",Qo),i._domElementKeyEvents=null)};const i=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const a=1e-6,l=new eq,d=new eq;let u=1;const p=new It,_=new Qi,S=new Qi,R=new Qi,H=new Qi,re=new Qi,se=new Qi,ce=new Qi,Te=new Qi,Ce=new Qi,qe=new It,wt=new Qi;let gt=!1;const Et=[],Xt={};let Un=!1;function Kt(Tn){const Er=Math.abs(.01*Tn);return Math.pow(.95,i.zoomSpeed*Er)}function Gi(Tn){d.theta-=Tn}function Yi(Tn){d.phi-=Tn}const En=function(){const Tn=new It;return function(mo,Xn){Tn.setFromMatrixColumn(Xn,0),Tn.multiplyScalar(-mo),p.add(Tn)}}(),wi=function(){const Tn=new It;return function(mo,Xn){!0===i.screenSpacePanning?Tn.setFromMatrixColumn(Xn,1):(Tn.setFromMatrixColumn(Xn,0),Tn.crossVectors(i.object.up,Tn)),Tn.multiplyScalar(mo),p.add(Tn)}}(),zn=function(){const Tn=new It;return function(mo,Xn){const rs=i.domElement;if(i.object.isPerspectiveCamera){Tn.copy(i.object.position).sub(i.target);let Xr=Tn.length();Xr*=Math.tan(i.object.fov/2*Math.PI/180),En(2*mo*Xr/rs.clientHeight,i.object.matrix),wi(2*Xn*Xr/rs.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(En(mo*(i.object.right-i.object.left)/i.object.zoom/rs.clientWidth,i.object.matrix),wi(Xn*(i.object.top-i.object.bottom)/i.object.zoom/rs.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function oi(Tn){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?u/=Tn:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function hi(Tn){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?u*=Tn:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function vi(Tn,Er){if(!i.zoomToCursor)return;gt=!0;const mo=i.domElement.getBoundingClientRect(),rs=Er-mo.top,Xr=mo.height;wt.x=(Tn-mo.left)/mo.width*2-1,wt.y=-rs/Xr*2+1,qe.set(wt.x,wt.y,1).unproject(i.object).sub(i.object.position).normalize()}function mr(Tn){return Math.max(i.minDistance,Math.min(i.maxDistance,Tn))}function Mr(Tn){_.set(Tn.clientX,Tn.clientY)}function $s(Tn){H.set(Tn.clientX,Tn.clientY)}function ws(Tn){if(1===Et.length)_.set(Tn.pageX,Tn.pageY);else{const Er=ho(Tn);_.set(.5*(Tn.pageX+Er.x),.5*(Tn.pageY+Er.y))}}function Co(Tn){if(1===Et.length)H.set(Tn.pageX,Tn.pageY);else{const Er=ho(Tn);H.set(.5*(Tn.pageX+Er.x),.5*(Tn.pageY+Er.y))}}function lo(Tn){const Er=ho(Tn),mo=Tn.pageX-Er.x,Xn=Tn.pageY-Er.y,rs=Math.sqrt(mo*mo+Xn*Xn);ce.set(0,rs)}function gr(Tn){if(1==Et.length)S.set(Tn.pageX,Tn.pageY);else{const mo=ho(Tn);S.set(.5*(Tn.pageX+mo.x),.5*(Tn.pageY+mo.y))}R.subVectors(S,_).multiplyScalar(i.rotateSpeed);const Er=i.domElement;Gi(2*Math.PI*R.x/Er.clientHeight),Yi(2*Math.PI*R.y/Er.clientHeight),_.copy(S)}function ls(Tn){if(1===Et.length)re.set(Tn.pageX,Tn.pageY);else{const Er=ho(Tn);re.set(.5*(Tn.pageX+Er.x),.5*(Tn.pageY+Er.y))}se.subVectors(re,H).multiplyScalar(i.panSpeed),zn(se.x,se.y),H.copy(re)}function Tr(Tn){const Er=ho(Tn),mo=Tn.pageX-Er.x,Xn=Tn.pageY-Er.y,rs=Math.sqrt(mo*mo+Xn*Xn);Te.set(0,rs),Ce.set(0,Math.pow(Te.y/ce.y,i.zoomSpeed)),oi(Ce.y),ce.copy(Te),vi(.5*(Tn.pageX+Er.x),.5*(Tn.pageY+Er.y))}function uo(Tn){!1!==i.enabled&&(0===Et.length&&(i.domElement.setPointerCapture(Tn.pointerId),i.domElement.addEventListener("pointermove",ka),i.domElement.addEventListener("pointerup",gn)),!function qa(Tn){for(let Er=0;Er<Et.length;Er++)if(Et[Er]==Tn.pointerId)return!0;return!1}(Tn)&&(function hs(Tn){Et.push(Tn.pointerId)}(Tn),"touch"===Tn.pointerType?As(Tn):function Ht(Tn){let Er;switch(Tn.button){case 0:Er=i.mouseButtons.LEFT;break;case 1:Er=i.mouseButtons.MIDDLE;break;case 2:Er=i.mouseButtons.RIGHT;break;default:Er=-1}switch(Er){case 1:if(!1===i.enableZoom)return;(function is(Tn){vi(Tn.clientX,Tn.clientX),ce.set(Tn.clientX,Tn.clientY)})(Tn),s=r.DOLLY;break;case 0:if(Tn.ctrlKey||Tn.metaKey||Tn.shiftKey){if(!1===i.enablePan)return;$s(Tn),s=r.PAN}else{if(!1===i.enableRotate)return;Mr(Tn),s=r.ROTATE}break;case 2:if(Tn.ctrlKey||Tn.metaKey||Tn.shiftKey){if(!1===i.enableRotate)return;Mr(Tn),s=r.ROTATE}else{if(!1===i.enablePan)return;$s(Tn),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(xF)}(Tn)))}function ka(Tn){!1!==i.enabled&&("touch"===Tn.pointerType?function Is(Tn){switch(Ro(Tn),s){case r.TOUCH_ROTATE:if(!1===i.enableRotate)return;gr(Tn),i.update();break;case r.TOUCH_PAN:if(!1===i.enablePan)return;ls(Tn),i.update();break;case r.TOUCH_DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;(function Ys(Tn){i.enableZoom&&Tr(Tn),i.enablePan&&ls(Tn)})(Tn),i.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function qs(Tn){i.enableZoom&&Tr(Tn),i.enableRotate&&gr(Tn)})(Tn),i.update();break;default:s=r.NONE}}(Tn):function ar(Tn){switch(s){case r.ROTATE:if(!1===i.enableRotate)return;!function fi(Tn){S.set(Tn.clientX,Tn.clientY),R.subVectors(S,_).multiplyScalar(i.rotateSpeed);const Er=i.domElement;Gi(2*Math.PI*R.x/Er.clientHeight),Yi(2*Math.PI*R.y/Er.clientHeight),_.copy(S),i.update()}(Tn);break;case r.DOLLY:if(!1===i.enableZoom)return;!function Rr(Tn){Te.set(Tn.clientX,Tn.clientY),Ce.subVectors(Te,ce),Ce.y>0?oi(Kt(Ce.y)):Ce.y<0&&hi(Kt(Ce.y)),ce.copy(Te),i.update()}(Tn);break;case r.PAN:if(!1===i.enablePan)return;!function ms(Tn){re.set(Tn.clientX,Tn.clientY),se.subVectors(re,H).multiplyScalar(i.panSpeed),zn(se.x,se.y),H.copy(re),i.update()}(Tn)}}(Tn))}function gn(Tn){switch(function Sd(Tn){delete Xt[Tn.pointerId];for(let Er=0;Er<Et.length;Er++)if(Et[Er]==Tn.pointerId)return void Et.splice(Er,1)}(Tn),Et.length){case 0:i.domElement.releasePointerCapture(Tn.pointerId),i.domElement.removeEventListener("pointermove",ka),i.domElement.removeEventListener("pointerup",gn),i.dispatchEvent(hq),s=r.NONE;break;case 1:const Er=Et[0],mo=Xt[Er];As({pointerId:Er,pageX:mo.x,pageY:mo.y})}}function hr(Tn){!1===i.enabled||!1===i.enableZoom||s!==r.NONE||(Tn.preventDefault(),i.dispatchEvent(xF),function Fs(Tn){vi(Tn.clientX,Tn.clientY),Tn.deltaY<0?hi(Kt(Tn.deltaY)):Tn.deltaY>0&&oi(Kt(Tn.deltaY)),i.update()}(function $r(Tn){const mo={clientX:Tn.clientX,clientY:Tn.clientY,deltaY:Tn.deltaY};switch(Tn.deltaMode){case 1:mo.deltaY*=16;break;case 2:mo.deltaY*=100}return Tn.ctrlKey&&!Un&&(mo.deltaY*=10),mo}(Tn)),i.dispatchEvent(hq))}function Or(Tn){"Control"===Tn.key&&(Un=!0,i.domElement.getRootNode().addEventListener("keyup",Aa,{passive:!0,capture:!0}))}function Aa(Tn){"Control"===Tn.key&&(Un=!1,i.domElement.getRootNode().removeEventListener("keyup",Aa,{passive:!0,capture:!0}))}function Qo(Tn){!1===i.enabled||!1===i.enablePan||function Us(Tn){let Er=!1;switch(Tn.code){case i.keys.UP:Tn.ctrlKey||Tn.metaKey||Tn.shiftKey?Yi(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):zn(0,i.keyPanSpeed),Er=!0;break;case i.keys.BOTTOM:Tn.ctrlKey||Tn.metaKey||Tn.shiftKey?Yi(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):zn(0,-i.keyPanSpeed),Er=!0;break;case i.keys.LEFT:Tn.ctrlKey||Tn.metaKey||Tn.shiftKey?Gi(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):zn(i.keyPanSpeed,0),Er=!0;break;case i.keys.RIGHT:Tn.ctrlKey||Tn.metaKey||Tn.shiftKey?Gi(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):zn(-i.keyPanSpeed,0),Er=!0}Er&&(Tn.preventDefault(),i.update())}(Tn)}function As(Tn){switch(Ro(Tn),Et.length){case 1:switch(i.touches.ONE){case 0:if(!1===i.enableRotate)return;ws(Tn),s=r.TOUCH_ROTATE;break;case 1:if(!1===i.enablePan)return;Co(Tn),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(i.touches.TWO){case 2:if(!1===i.enableZoom&&!1===i.enablePan)return;(function On(Tn){i.enableZoom&&lo(Tn),i.enablePan&&Co(Tn)})(Tn),s=r.TOUCH_DOLLY_PAN;break;case 3:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function ps(Tn){i.enableZoom&&lo(Tn),i.enableRotate&&ws(Tn)})(Tn),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(xF)}function ga(Tn){!1!==i.enabled&&Tn.preventDefault()}function Ro(Tn){let Er=Xt[Tn.pointerId];void 0===Er&&(Er=new Qi,Xt[Tn.pointerId]=Er),Er.set(Tn.pageX,Tn.pageY)}function ho(Tn){return Xt[Tn.pointerId===Et[0]?Et[1]:Et[0]]}i.domElement.addEventListener("contextmenu",ga),i.domElement.addEventListener("pointerdown",uo),i.domElement.addEventListener("pointercancel",gn),i.domElement.addEventListener("wheel",hr,{passive:!1}),i.domElement.getRootNode().addEventListener("keydown",Or,{passive:!0,capture:!0}),this.update()}}class lme{activeControls;mainControls;overlayControls;controls;perspectiveControls;orthographicControls;zoomCameraAnimPairs;constructor(e,t=[0,0,200]){this.controls=[],this.mainControls=null,this.overlayControls=null;const i=e.getMainRenderer()?.domElement,r=new Bu(75,i.offsetWidth/i.offsetHeight,10,1e5),s=new Q2(i.offsetWidth/-2,i.offsetWidth/2,i.offsetHeight/2,i.offsetHeight/-2,10,1e5);this.perspectiveControls=this.setOrbitControls(r,i),this.orthographicControls=this.setOrbitControls(s,i),r.position.z=s.position.z=t[2],r.position.y=s.position.y=t[1],r.position.x=s.position.x=t[0],t.length>=6&&(this.perspectiveControls.target=this.orthographicControls.target=new It(t[3],t[4],t[5])),this.addControls(this.perspectiveControls),this.addControls(this.orthographicControls),this.setActiveControls(this.perspectiveControls),this.setMainControls(this.perspectiveControls),this.setOverlayControls(this.orthographicControls),this.getActiveControls().addEventListener("change",()=>{this.transformSync(),this.updateSync()}),this.initializeZoomControls(),this.setupResize(i)}setOrbitControls(e,t){const i=new ame(e,t);return i.enableDamping=!0,i.dampingFactor=.25,i.enableZoom=!0,i.autoRotate=!1,i}setActiveControls(e){this.activeControls=e}setMainControls(e){this.mainControls=e}setOverlayControls(e){this.overlayControls=e}getActiveControls(){return this.activeControls}getMainControls(){return this.mainControls}getOverlayControls(){return this.overlayControls}getActiveCamera(){return this.activeControls.object}getMainCamera(){return this.mainControls.object}getOverlayCamera(){return this.overlayControls.object}getAllCameras(){return[this.getMainCamera(),this.getOverlayCamera()]}addControls(e){this.containsObject(e,this.controls)||this.controls.push(e)}removeControls(e){const t=this.controls.indexOf(e);t>-1&&this.controls.splice(t,1)}swapControls(){const e=this.mainControls;this.mainControls=this.overlayControls,this.overlayControls=e}updateSync(){for(const e of this.controls)e!==this.activeControls&&this.update(e)}update(e){e.update()}transformSync(){for(const e of this.controls)e!==this.activeControls&&(this.positionSync(e),this.rotationSync(e))}zoomTo(e,t){for(const i of this.zoomCameraAnimPairs){const r=i.camera,s=i.anim;if(r.isOrthographicCamera)s.to({zoom:r.zoom*(1/e)},t),r.updateProjectionMatrix();else{const a=r.position;s.to({x:a.x*e,y:a.y*e,z:a.z*e},t)}s.start()}}lookAtObject(e,t,i=0){new It(0,0,0);const s=this.getObjectPosition(e,t);if(s)for(const a of this.getAllCameras())new If(a.position).to({x:1.1*s.x+i,y:1.1*s.y+i,z:1.1*s.z+i},200).start()}getObjectPosition(e,t){const i=t.getObjectByProperty("uuid",e);if(i){const r=new It(0,0,0);let s=new It;return i instanceof Wl?i.traverse(a=>{if(0===a.children.length)if(a.position.equals(r)){if(a.geometry?.boundingSphere)try{s.add(a.geometry.boundingSphere.getBoundingBox().max)}catch{s.add(a.geometry.boundingSphere?.center)}}else s.add(a.position)}):s=i.position.equals(r)?i.geometry?.boundingSphere?.center:i.position,s}}hideTubeTracksOnZoom(e,t){let i=!1;const r=new It;this.activeControls.addEventListener("change",s=>{const a=(s?.target?.object?.position).distanceTo(r)<t;a&&!i?(e.getObjectByName("Tracks")?.traverse(l=>{"Track"===l.name&&l.geometry instanceof Xb&&(l.visible=!1)}),i=!0):!a&&i&&(e.getObjectByName("Tracks")?.traverse(l=>{"Track"===l.name&&l.geometry instanceof Xb&&(l.visible=!0)}),i=!1)})}initializeZoomControls(){const e=this.getAllCameras();this.zoomCameraAnimPairs=[];for(const t of e){const i=new If(t.isOrthographicCamera?t:t.position);this.zoomCameraAnimPairs.push({camera:t,anim:i})}}positionSync(e){e.object.position.set(this.activeControls.object.position.x,this.activeControls.object.position.y,this.activeControls.object.position.z)}rotationSync(e){e.target=this.activeControls.target}containsObject(e,t){for(const i of t)if(i===e)return!0;return!1}setupResize(e){window.addEventListener("resize",()=>{let t=this.getMainCamera();t.isOrthographicCamera?(t.left=e.offsetWidth/-2,t.right=e.offsetWidth/2,t.top=e.offsetHeight/2,t.bottom=e.offsetHeight/-2,t.updateProjectionMatrix()):(t.aspect=e.offsetWidth/e.offsetHeight,t.updateProjectionMatrix())})}objectIndex(e,t){for(let i=0;i<t.length;i++)if(t[i]===e)return i;return-1}}class cme{mainRenderer=null;overlayRenderer=null;renderers=[];fixedOverlay;constructor(){const e=new xI({antialias:!0,alpha:!0,powerPreference:"high-performance"});this.addRenderer(e),this.setMainRenderer(e)}init(e="eventDisplay"){this.getMainRenderer().setAnimationLoop(null),this.initRenderer(e)}render(e,t){if(this.getOverlayRenderer()&&!this.getOverlayRenderer().domElement.hidden){const i=e.background;e.background=null,this.isFixedOverlay()||this.getOverlayRenderer().render(e,t),e.background=i}}initRenderer(e){let t=document.getElementById(e);t||(t=document.body);const i=()=>t.offsetWidth>0?t.offsetWidth:window.innerWidth,r=()=>t.offsetHeight>0?t.offsetHeight:window.innerHeight,s=this.getMainRenderer();s.setSize(i(),r(),!1),s.setPixelRatio(window.devicePixelRatio),s.domElement.id="three-canvas",t.appendChild(this.getMainRenderer().domElement),window.addEventListener("resize",()=>{s.setSize(i(),r())})}setMainRenderer(e){this.mainRenderer=e}setOverlayRenderer(e){const t=new xI({canvas:e,antialias:!1,alpha:!0});this.addRenderer(t),this.overlayRenderer=t}setRenderers(e){this.renderers=e}getMainRenderer(){return this.mainRenderer}getOverlayRenderer(){return this.overlayRenderer}getRenderers(){return this.renderers}addRenderer(e){this.containsObject(e,this.renderers)||this.renderers.push(e)}removeControls(e){const t=this.renderers.indexOf(e);t>-1&&this.renderers.splice(t,1)}swapRenderers(e,t){const i=e;e=t,t=i}containsObject(e,t){for(const i of t)if(i===e)return!0;return!1}setLocalClippingEnabled(e){for(const t of this.renderers)t.localClippingEnabled=e}getLocalClipping(){if(this.renderers.length>0)return this.renderers[0].localClippingEnabled}isFixedOverlay(){return this.fixedOverlay}setFixOverlay(e){this.fixedOverlay=e}}class dme{parse(e){let t="",i=0,r=0,s=0;const a=new It,l=new Cr,d=new It,u=new Qi,p=[];return e.traverse(function(H){!0===H.isMesh&&function _(H){let re=0,se=0,ce=0;const Te=H.geometry,Ce=new Ta,qe=Te.getAttribute("position"),wt=Te.getAttribute("normal"),gt=Te.getAttribute("uv"),Et=Te.getIndex();if(t+="o "+H.name+"\n",H.material&&H.material.name&&(t+="usemtl "+H.material.name+"\n"),void 0!==qe)for(let Xt=0,Un=qe.count;Xt<Un;Xt++,re++)a.fromBufferAttribute(qe,Xt),a.applyMatrix4(H.matrixWorld),t+="v "+a.x+" "+a.y+" "+a.z+"\n";if(void 0!==gt)for(let Xt=0,Un=gt.count;Xt<Un;Xt++,ce++)u.fromBufferAttribute(gt,Xt),t+="vt "+u.x+" "+u.y+"\n";if(void 0!==wt){Ce.getNormalMatrix(H.matrixWorld);for(let Xt=0,Un=wt.count;Xt<Un;Xt++,se++)d.fromBufferAttribute(wt,Xt),d.applyMatrix3(Ce).normalize(),t+="vn "+d.x+" "+d.y+" "+d.z+"\n"}if(null!==Et)for(let Xt=0,Un=Et.count;Xt<Un;Xt+=3){for(let Ct=0;Ct<3;Ct++){const Kt=Et.getX(Xt+Ct)+1;p[Ct]=i+Kt+(wt||gt?"/"+(gt?r+Kt:"")+(wt?"/"+(s+Kt):""):"")}t+="f "+p.join(" ")+"\n"}else for(let Xt=0,Un=qe.count;Xt<Un;Xt+=3){for(let Ct=0;Ct<3;Ct++){const Kt=Xt+Ct+1;p[Ct]=i+Kt+(wt||gt?"/"+(gt?r+Kt:"")+(wt?"/"+(s+Kt):""):"")}t+="f "+p.join(" ")+"\n"}i+=re,r+=ce,s+=se}(H),!0===H.isLine&&function S(H){let re=0;const ce=H.type,Te=H.geometry.getAttribute("position");if(t+="o "+H.name+"\n",void 0!==Te)for(let Ce=0,qe=Te.count;Ce<qe;Ce++,re++)a.fromBufferAttribute(Te,Ce),a.applyMatrix4(H.matrixWorld),t+="v "+a.x+" "+a.y+" "+a.z+"\n";if("Line"===ce){t+="l ";for(let Ce=1,qe=Te.count;Ce<=qe;Ce++)t+=i+Ce+" ";t+="\n"}if("LineSegments"===ce)for(let Ce=1,qe=Ce+1,wt=Te.count;Ce<wt;Ce+=2,qe=Ce+1)t+="l "+(i+Ce)+" "+(i+qe)+"\n";i+=re}(H),!0===H.isPoints&&function R(H){let re=0;const se=H.geometry,ce=se.getAttribute("position"),Te=se.getAttribute("color");if(t+="o "+H.name+"\n",void 0!==ce){for(let Ce=0,qe=ce.count;Ce<qe;Ce++,re++)a.fromBufferAttribute(ce,Ce),a.applyMatrix4(H.matrixWorld),t+="v "+a.x+" "+a.y+" "+a.z,void 0!==Te&&(l.fromBufferAttribute(Te,Ce).convertLinearToSRGB(),t+=" "+l.r+" "+l.g+" "+l.b),t+="\n";t+="p ";for(let Ce=1,qe=ce.count;Ce<=qe;Ce++)t+=i+Ce+" ";t+="\n"}i+=re}(H)}),t}}let uE,wF,hC,o4;function CF(n,e=1/0,t=null){wF||(wF=new q2(2,2,1,1)),hC||(hC=new Iu({uniforms:{blitTexture:new _F(n)},vertexShader:"\n\t\t\tvarying vec2 vUv;\n\t\t\tvoid main(){\n\t\t\t\tvUv = uv;\n\t\t\t\tgl_Position = vec4(position.xy * 1.0,0.,.999999);\n\t\t\t}",fragmentShader:"\n\t\t\tuniform sampler2D blitTexture; \n\t\t\tvarying vec2 vUv;\n\n\t\t\tvoid main(){ \n\t\t\t\tgl_FragColor = vec4(vUv.xy, 0, 1);\n\t\t\t\t\n\t\t\t\t#ifdef IS_SRGB\n\t\t\t\tgl_FragColor = LinearTosRGB( texture2D( blitTexture, vUv) );\n\t\t\t\t#else\n\t\t\t\tgl_FragColor = texture2D( blitTexture, vUv);\n\t\t\t\t#endif\n\t\t\t}"})),hC.uniforms.blitTexture.value=n,hC.defines.IS_SRGB=n.colorSpace==du,hC.needsUpdate=!0,o4||(o4=new ua(wF,hC),o4.frustrumCulled=!1);const i=new Bu,r=new YS;r.add(o4),null===t&&(t=uE=new xI({antialias:!1}));const s=Math.min(n.image.width,e),a=Math.min(n.image.height,e);t.setSize(s,a),t.clear(),t.render(r,i);const l=document.createElement("canvas"),d=l.getContext("2d");l.width=s,l.height=a,d.drawImage(t.domElement,0,0,s,a);const u=new AG(l);return u.minFilter=n.minFilter,u.magFilter=n.magFilter,u.wrapS=n.wrapS,u.wrapT=n.wrapT,u.name=n.name,uE&&(uE.forceContextLoss(),uE.dispose(),uE=null),u}const pq={POSITION:["byte","byte normalized","unsigned byte","unsigned byte normalized","short","short normalized","unsigned short","unsigned short normalized"],NORMAL:["byte normalized","short normalized"],TANGENT:["byte normalized","short normalized"],TEXCOORD:["byte","byte normalized","unsigned byte","short","short normalized","unsigned short"]};class a4{constructor(){this.pluginCallbacks=[],this.register(function(e){return new vme(e)}),this.register(function(e){return new bme(e)}),this.register(function(e){return new Cme(e)}),this.register(function(e){return new Mme(e)}),this.register(function(e){return new Sme(e)}),this.register(function(e){return new Eme(e)}),this.register(function(e){return new xme(e)}),this.register(function(e){return new wme(e)}),this.register(function(e){return new Tme(e)}),this.register(function(e){return new Dme(e)}),this.register(function(e){return new Ime(e)}),this.register(function(e){return new Bme(e)}),this.register(function(e){return new Pme(e)})}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){const s=new yme,a=[];for(let l=0,d=this.pluginCallbacks.length;l<d;l++)a.push(this.pluginCallbacks[l](s));s.setPlugins(a),s.write(e,t,r).catch(i)}parseAsync(e,t){const i=this;return new Promise(function(r,s){i.parse(e,r,s,t)})}}const MF="KHR_mesh_quantization",pm={1003:9728,1004:9984,1005:9986,1006:9729,1007:9985,1008:9987,1001:33071,1e3:10497,1002:33648},mq={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},ume=new Cr;function hE(n,e){return n.length===e.length&&n.every(function(t,i){return t===e[i]})}function _q(n){return 4*Math.ceil(n/4)}function SF(n,e=0){const t=_q(n.byteLength);if(t!==n.byteLength){const i=new Uint8Array(t);if(i.set(new Uint8Array(n)),0!==e)for(let r=n.byteLength;r<t;r++)i[r]=e;return i.buffer}return n}function yq(){return typeof document>"u"&&typeof OffscreenCanvas<"u"?new OffscreenCanvas(1,1):document.createElement("canvas")}function vq(n,e){if(void 0!==n.toBlob)return new Promise(i=>n.toBlob(i,e));let t;return"image/jpeg"===e?t=.92:"image/webp"===e&&(t=.8),n.convertToBlob({type:e,quality:t})}class yme{constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.extensionsRequired={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter"}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map}}setPlugins(e){this.plugins=e}write(e,t,i={}){var r=this;return(0,Ee.A)(function*(){r.options=Object.assign({binary:!1,trs:!1,onlyVisible:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},i),r.options.animations.length>0&&(r.options.trs=!0),r.processInput(e),yield Promise.all(r.pending);const l=r.json;i=r.options;const d=r.extensionsUsed,u=r.extensionsRequired,p=new Blob(r.buffers,{type:"application/octet-stream"}),_=Object.keys(d),S=Object.keys(u);if(_.length>0&&(l.extensionsUsed=_),S.length>0&&(l.extensionsRequired=S),l.buffers&&l.buffers.length>0&&(l.buffers[0].byteLength=p.size),!0===i.binary){const R=new FileReader;R.readAsArrayBuffer(p),R.onloadend=function(){const H=SF(R.result),re=new DataView(new ArrayBuffer(8));re.setUint32(0,H.byteLength,!0),re.setUint32(4,5130562,!0);const se=SF(function Ame(n){return(new TextEncoder).encode(n).buffer}(JSON.stringify(l)),32),ce=new DataView(new ArrayBuffer(8));ce.setUint32(0,se.byteLength,!0),ce.setUint32(4,1313821514,!0);const Te=new ArrayBuffer(12),Ce=new DataView(Te);Ce.setUint32(0,1179937895,!0),Ce.setUint32(4,2,!0),Ce.setUint32(8,12+ce.byteLength+se.byteLength+re.byteLength+H.byteLength,!0);const wt=new Blob([Te,ce,se,re,H],{type:"application/octet-stream"}),gt=new FileReader;gt.readAsArrayBuffer(wt),gt.onloadend=function(){t(gt.result)}}}else if(l.buffers&&l.buffers.length>0){const R=new FileReader;R.readAsDataURL(p),R.onloadend=function(){l.buffers[0].uri=R.result,t(l)}}else t(l)})()}serializeUserData(e,t){if(0===Object.keys(e.userData).length)return;const i=this.options,r=this.extensionsUsed;try{const s=JSON.parse(JSON.stringify(e.userData));if(i.includeCustomExtensions&&s.gltfExtensions){void 0===t.extensions&&(t.extensions={});for(const a in s.gltfExtensions)t.extensions[a]=s.gltfExtensions[a],r[a]=!0;delete s.gltfExtensions}Object.keys(s).length>0&&(t.extras=s)}catch(s){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+s.message)}}getUID(e,t=!1){if(!1===this.uids.has(e)){const r=new Map;r.set(!0,this.uid++),r.set(!1,this.uid++),this.uids.set(e,r)}return this.uids.get(e).get(t)}isNormalizedNormalAttribute(e){if(this.cache.attributesNormalized.has(e))return!1;const i=new It;for(let r=0,s=e.count;r<s;r++)if(Math.abs(i.fromBufferAttribute(e,r).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(e){const t=this.cache;if(t.attributesNormalized.has(e))return t.attributesNormalized.get(e);const i=e.clone(),r=new It;for(let s=0,a=i.count;s<a;s++)r.fromBufferAttribute(i,s),0===r.x&&0===r.y&&0===r.z?r.setX(1):r.normalize(),i.setXYZ(s,r.x,r.y,r.z);return t.attributesNormalized.set(e,i),i}applyTextureTransform(e,t){let i=!1;const r={};(0!==t.offset.x||0!==t.offset.y)&&(r.offset=t.offset.toArray(),i=!0),0!==t.rotation&&(r.rotation=t.rotation,i=!0),(1!==t.repeat.x||1!==t.repeat.y)&&(r.scale=t.repeat.toArray(),i=!0),i&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=r,this.extensionsUsed.KHR_texture_transform=!0)}buildMetalRoughTexture(e,t){if(e===t)return e;function i(R){return R.colorSpace===du?function(re){return re<.04045?.0773993808*re:Math.pow(.9478672986*re+.0521327014,2.4)}:function(re){return re}}console.warn("THREE.GLTFExporter: Merged metalnessMap and roughnessMap textures."),e instanceof iC&&(e=CF(e)),t instanceof iC&&(t=CF(t));const r=e?e.image:null,s=t?t.image:null,a=Math.max(r?r.width:0,s?s.width:0),l=Math.max(r?r.height:0,s?s.height:0),d=yq();d.width=a,d.height=l;const u=d.getContext("2d");u.fillStyle="#00ffff",u.fillRect(0,0,a,l);const p=u.getImageData(0,0,a,l);if(r){u.drawImage(r,0,0,a,l);const R=i(e),H=u.getImageData(0,0,a,l).data;for(let re=2;re<H.length;re+=4)p.data[re]=256*R(H[re]/256)}if(s){u.drawImage(s,0,0,a,l);const R=i(t),H=u.getImageData(0,0,a,l).data;for(let re=1;re<H.length;re+=4)p.data[re]=256*R(H[re]/256)}u.putImageData(p,0,0);const S=(e||t).clone();return S.source=new kb(d),S.colorSpace="",S.channel=(e||t).channel,e&&t&&e.channel!==t.channel&&console.warn("THREE.GLTFExporter: UV channels for metalnessMap and roughnessMap textures must match."),S}processBuffer(e){const t=this.json,i=this.buffers;return t.buffers||(t.buffers=[{byteLength:0}]),i.push(e),0}processBufferView(e,t,i,r,s){const a=this.json;let l;switch(a.bufferViews||(a.bufferViews=[]),t){case 5120:case 5121:l=1;break;case 5122:case 5123:l=2;break;default:l=4}const d=_q(r*e.itemSize*l),u=new DataView(new ArrayBuffer(d));let p=0;for(let R=i;R<i+r;R++)for(let H=0;H<e.itemSize;H++){let re;e.itemSize>4?re=e.array[R*e.itemSize+H]:(0===H?re=e.getX(R):1===H?re=e.getY(R):2===H?re=e.getZ(R):3===H&&(re=e.getW(R)),!0===e.normalized&&(re=GS.normalize(re,e.array))),5126===t?u.setFloat32(p,re,!0):5124===t?u.setInt32(p,re,!0):5125===t?u.setUint32(p,re,!0):5122===t?u.setInt16(p,re,!0):5123===t?u.setUint16(p,re,!0):5120===t?u.setInt8(p,re):5121===t&&u.setUint8(p,re),p+=l}const _={buffer:this.processBuffer(u.buffer),byteOffset:this.byteOffset,byteLength:d};return void 0!==s&&(_.target=s),34962===s&&(_.byteStride=e.itemSize*l),this.byteOffset+=d,a.bufferViews.push(_),{id:a.bufferViews.length-1,byteLength:0}}processBufferViewImage(e){const t=this,i=t.json;return i.bufferViews||(i.bufferViews=[]),new Promise(function(r){const s=new FileReader;s.readAsArrayBuffer(e),s.onloadend=function(){const a=SF(s.result),l={buffer:t.processBuffer(a),byteOffset:t.byteOffset,byteLength:a.byteLength};t.byteOffset+=a.byteLength,r(i.bufferViews.push(l)-1)}})}processAccessor(e,t,i,r){const s=this.json;let l;if(e.array.constructor===Float32Array)l=5126;else if(e.array.constructor===Int32Array)l=5124;else if(e.array.constructor===Uint32Array)l=5125;else if(e.array.constructor===Int16Array)l=5122;else if(e.array.constructor===Uint16Array)l=5123;else if(e.array.constructor===Int8Array)l=5120;else{if(e.array.constructor!==Uint8Array)throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type: "+e.array.constructor.name);l=5121}if(void 0===i&&(i=0),(void 0===r||r===1/0)&&(r=e.count),0===r)return null;const d=function _me(n,e,t){const i={min:new Array(n.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(n.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let r=e;r<e+t;r++)for(let s=0;s<n.itemSize;s++){let a;n.itemSize>4?a=n.array[r*n.itemSize+s]:(0===s?a=n.getX(r):1===s?a=n.getY(r):2===s?a=n.getZ(r):3===s&&(a=n.getW(r)),!0===n.normalized&&(a=GS.normalize(a,n.array))),i.min[s]=Math.min(i.min[s],a),i.max[s]=Math.max(i.max[s],a)}return i}(e,i,r);let u;void 0!==t&&(u=e===t.index?34963:34962);const p=this.processBufferView(e,l,i,r,u),_={bufferView:p.id,byteOffset:p.byteOffset,componentType:l,count:r,max:d.max,min:d.min,type:{1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",9:"MAT3",16:"MAT4"}[e.itemSize]};return!0===e.normalized&&(_.normalized=!0),s.accessors||(s.accessors=[]),s.accessors.push(_)-1}processImage(e,t,i,r="image/png"){if(null!==e){const s=this,a=s.cache,l=s.json,d=s.options,u=s.pending;a.images.has(e)||a.images.set(e,{});const p=a.images.get(e),_=r+":flipY/"+i.toString();if(void 0!==p[_])return p[_];l.images||(l.images=[]);const S={mimeType:r},R=yq();R.width=Math.min(e.width,d.maxTextureSize),R.height=Math.min(e.height,d.maxTextureSize);const H=R.getContext("2d");if(!0===i&&(H.translate(0,R.height),H.scale(1,-1)),void 0!==e.data){t!==gp&&console.error("GLTFExporter: Only RGBAFormat is supported.",t),(e.width>d.maxTextureSize||e.height>d.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",e);const se=new Uint8ClampedArray(e.height*e.width*4);for(let ce=0;ce<se.length;ce+=4)se[ce+0]=e.data[ce+0],se[ce+1]=e.data[ce+1],se[ce+2]=e.data[ce+2],se[ce+3]=e.data[ce+3];H.putImageData(new ImageData(se,e.width,e.height),0,0)}else{if(!(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap))throw new Error("THREE.GLTFExporter: Invalid image type. Use HTMLImageElement, HTMLCanvasElement or ImageBitmap.");H.drawImage(e,0,0,R.width,R.height)}!0===d.binary?u.push(vq(R,r).then(se=>s.processBufferViewImage(se)).then(se=>{S.bufferView=se})):void 0!==R.toDataURL?S.uri=R.toDataURL(r):u.push(vq(R,r).then(se=>(new FileReader).readAsDataURL(se)).then(se=>{S.uri=se}));const re=l.images.push(S)-1;return p[_]=re,re}throw new Error("THREE.GLTFExporter: No valid image data found. Unable to process texture.")}processSampler(e){const t=this.json;return t.samplers||(t.samplers=[]),t.samplers.push({magFilter:pm[e.magFilter],minFilter:pm[e.minFilter],wrapS:pm[e.wrapS],wrapT:pm[e.wrapT]})-1}processTexture(e){const i=this.options,r=this.cache,s=this.json;if(r.textures.has(e))return r.textures.get(e);s.textures||(s.textures=[]),e instanceof iC&&(e=CF(e,i.maxTextureSize));let a=e.userData.mimeType;"image/webp"===a&&(a="image/png");const l={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY,a)};e.name&&(l.name=e.name),this._invokeAll(function(u){u.writeTexture&&u.writeTexture(e,l)});const d=s.textures.push(l)-1;return r.textures.set(e,d),d}processMaterial(e){const t=this.cache,i=this.json;if(t.materials.has(e))return t.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;i.materials||(i.materials=[]);const r={pbrMetallicRoughness:{}};!0!==e.isMeshStandardMaterial&&!0!==e.isMeshBasicMaterial&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");const s=e.color.toArray().concat([e.opacity]);if(hE(s,[1,1,1,1])||(r.pbrMetallicRoughness.baseColorFactor=s),e.isMeshStandardMaterial?(r.pbrMetallicRoughness.metallicFactor=e.metalness,r.pbrMetallicRoughness.roughnessFactor=e.roughness):(r.pbrMetallicRoughness.metallicFactor=.5,r.pbrMetallicRoughness.roughnessFactor=.5),e.metalnessMap||e.roughnessMap){const l=this.buildMetalRoughTexture(e.metalnessMap,e.roughnessMap),d={index:this.processTexture(l),channel:l.channel};this.applyTextureTransform(d,l),r.pbrMetallicRoughness.metallicRoughnessTexture=d}if(e.map){const l={index:this.processTexture(e.map),texCoord:e.map.channel};this.applyTextureTransform(l,e.map),r.pbrMetallicRoughness.baseColorTexture=l}if(e.emissive){const l=e.emissive;if(Math.max(l.r,l.g,l.b)>0&&(r.emissiveFactor=e.emissive.toArray()),e.emissiveMap){const u={index:this.processTexture(e.emissiveMap),texCoord:e.emissiveMap.channel};this.applyTextureTransform(u,e.emissiveMap),r.emissiveTexture=u}}if(e.normalMap){const l={index:this.processTexture(e.normalMap),texCoord:e.normalMap.channel};e.normalScale&&1!==e.normalScale.x&&(l.scale=e.normalScale.x),this.applyTextureTransform(l,e.normalMap),r.normalTexture=l}if(e.aoMap){const l={index:this.processTexture(e.aoMap),texCoord:e.aoMap.channel};1!==e.aoMapIntensity&&(l.strength=e.aoMapIntensity),this.applyTextureTransform(l,e.aoMap),r.occlusionTexture=l}e.transparent?r.alphaMode="BLEND":e.alphaTest>0&&(r.alphaMode="MASK",r.alphaCutoff=e.alphaTest),2===e.side&&(r.doubleSided=!0),""!==e.name&&(r.name=e.name),this.serializeUserData(e,r),this._invokeAll(function(l){l.writeMaterial&&l.writeMaterial(e,r)});const a=i.materials.push(r)-1;return t.materials.set(e,a),a}processMesh(e){const t=this.cache,i=this.json,r=[e.geometry.uuid];if(Array.isArray(e.material))for(let qe=0,wt=e.material.length;qe<wt;qe++)r.push(e.material[qe].uuid);else r.push(e.material.uuid);const s=r.join(":");if(t.meshes.has(s))return t.meshes.get(s);const a=e.geometry;let l;l=e.isLineSegments?1:e.isLineLoop?2:e.isLine?3:e.isPoints?0:e.material.wireframe?1:4;const d={},u={},p=[],_=[],S={uv:"TEXCOORD_0",uv1:"TEXCOORD_1",uv2:"TEXCOORD_2",uv3:"TEXCOORD_3",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},R=a.getAttribute("normal");void 0!==R&&!this.isNormalizedNormalAttribute(R)&&(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),a.setAttribute("normal",this.createNormalizedNormalAttribute(R)));let H=null;for(let qe in a.attributes){if("morph"===qe.slice(0,5))continue;const wt=a.attributes[qe];if(qe=S[qe]||qe.toUpperCase(),/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(qe)||(qe="_"+qe),t.attributes.has(this.getUID(wt))){u[qe]=t.attributes.get(this.getUID(wt));continue}H=null;const Et=wt.array;"JOINTS_0"===qe&&!(Et instanceof Uint16Array)&&!(Et instanceof Uint8Array)&&(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),H=new No(new Uint16Array(Et),wt.itemSize,wt.normalized));const Xt=this.processAccessor(H||wt,a);null!==Xt&&(qe.startsWith("_")||this.detectMeshQuantization(qe,wt),u[qe]=Xt,t.attributes.set(this.getUID(wt),Xt))}if(void 0!==R&&a.setAttribute("normal",R),0===Object.keys(u).length)return null;if(void 0!==e.morphTargetInfluences&&e.morphTargetInfluences.length>0){const qe=[],wt=[],gt={};if(void 0!==e.morphTargetDictionary)for(const Et in e.morphTargetDictionary)gt[e.morphTargetDictionary[Et]]=Et;for(let Et=0;Et<e.morphTargetInfluences.length;++Et){const Xt={};let Un=!1;for(const Ct in a.morphAttributes){if("position"!==Ct&&"normal"!==Ct){Un||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),Un=!0);continue}const Kt=a.morphAttributes[Ct][Et],Gi=Ct.toUpperCase(),Yi=a.attributes[Ct];if(t.attributes.has(this.getUID(Kt,!0))){Xt[Gi]=t.attributes.get(this.getUID(Kt,!0));continue}const En=Kt.clone();if(!a.morphTargetsRelative)for(let wi=0,zn=Kt.count;wi<zn;wi++)for(let oi=0;oi<Kt.itemSize;oi++)0===oi&&En.setX(wi,Kt.getX(wi)-Yi.getX(wi)),1===oi&&En.setY(wi,Kt.getY(wi)-Yi.getY(wi)),2===oi&&En.setZ(wi,Kt.getZ(wi)-Yi.getZ(wi)),3===oi&&En.setW(wi,Kt.getW(wi)-Yi.getW(wi));Xt[Gi]=this.processAccessor(En,a),t.attributes.set(this.getUID(Yi,!0),Xt[Gi])}_.push(Xt),qe.push(e.morphTargetInfluences[Et]),void 0!==e.morphTargetDictionary&&wt.push(gt[Et])}d.weights=qe,wt.length>0&&(d.extras={},d.extras.targetNames=wt)}const re=Array.isArray(e.material);if(re&&0===a.groups.length)return null;let se=!1;if(re&&null===a.index){const qe=[];for(let wt=0,gt=a.attributes.position.count;wt<gt;wt++)qe[wt]=wt;a.setIndex(qe),se=!0}const ce=re?e.material:[e.material],Te=re?a.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let qe=0,wt=Te.length;qe<wt;qe++){const gt={mode:l,attributes:u};if(this.serializeUserData(a,gt),_.length>0&&(gt.targets=_),null!==a.index){let Xt=this.getUID(a.index);(void 0!==Te[qe].start||void 0!==Te[qe].count)&&(Xt+=":"+Te[qe].start+":"+Te[qe].count),t.attributes.has(Xt)?gt.indices=t.attributes.get(Xt):(gt.indices=this.processAccessor(a.index,a,Te[qe].start,Te[qe].count),t.attributes.set(Xt,gt.indices)),null===gt.indices&&delete gt.indices}const Et=this.processMaterial(ce[Te[qe].materialIndex]);null!==Et&&(gt.material=Et),p.push(gt)}!0===se&&a.setIndex(null),d.primitives=p,i.meshes||(i.meshes=[]),this._invokeAll(function(qe){qe.writeMesh&&qe.writeMesh(e,d)});const Ce=i.meshes.push(d)-1;return t.meshes.set(s,Ce),Ce}detectMeshQuantization(e,t){if(this.extensionsUsed[MF])return;let i;switch(t.array.constructor){case Int8Array:i="byte";break;case Uint8Array:i="unsigned byte";break;case Int16Array:i="short";break;case Uint16Array:i="unsigned short";break;default:return}t.normalized&&(i+=" normalized");const r=e.split("_",1)[0];pq[r]&&pq[r].includes(i)&&(this.extensionsUsed[MF]=!0,this.extensionsRequired[MF]=!0)}processCamera(e){const t=this.json;t.cameras||(t.cameras=[]);const i=e.isOrthographicCamera,r={type:i?"orthographic":"perspective"};return i?r.orthographic={xmag:2*e.right,ymag:2*e.top,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:r.perspective={aspectRatio:e.aspect,yfov:GS.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},""!==e.name&&(r.name=e.type),t.cameras.push(r)-1}processAnimation(e,t){const i=this.json,r=this.nodeMap;i.animations||(i.animations=[]);const s=(e=a4.Utils.mergeMorphTargetTracks(e.clone(),t)).tracks,a=[],l=[];for(let d=0;d<s.length;++d){const u=s[d],p=Ll.parseTrackName(u.name);let _=Ll.findNode(t,p.nodeName);const S=mq[p.propertyName];if("bones"===p.objectName&&(_=!0===_.isSkinnedMesh?_.skeleton.getBoneByName(p.objectIndex):void 0),!_||!S)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',u.name),null;const R=1;let re,H=u.values.length/u.times.length;S===mq.morphTargetInfluences&&(H/=_.morphTargetInfluences.length),!0===u.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(re="CUBICSPLINE",H/=3):re=u.getInterpolation()===b2?"STEP":"LINEAR",l.push({input:this.processAccessor(new No(u.times,R)),output:this.processAccessor(new No(u.values,H)),interpolation:re}),a.push({sampler:l.length-1,target:{node:r.get(_),path:S}})}return i.animations.push({name:e.name||"clip_"+i.animations.length,samplers:l,channels:a}),i.animations.length-1}processSkin(e){const t=this.json,i=this.nodeMap,r=t.nodes[i.get(e)],s=e.skeleton;if(void 0===s)return null;const a=e.skeleton.bones[0];if(void 0===a)return null;const l=[],d=new Float32Array(16*s.bones.length),u=new wo;for(let _=0;_<s.bones.length;++_)l.push(i.get(s.bones[_])),u.copy(s.boneInverses[_]),u.multiply(e.bindMatrix).toArray(d,16*_);return void 0===t.skins&&(t.skins=[]),t.skins.push({inverseBindMatrices:this.processAccessor(new No(d,16)),joints:l,skeleton:i.get(a)}),r.skin=t.skins.length-1}processNode(e){const t=this.json,i=this.options,r=this.nodeMap;t.nodes||(t.nodes=[]);const s={};if(i.trs){const l=e.quaternion.toArray(),d=e.position.toArray(),u=e.scale.toArray();hE(l,[0,0,0,1])||(s.rotation=l),hE(d,[0,0,0])||(s.translation=d),hE(u,[1,1,1])||(s.scale=u)}else e.matrixAutoUpdate&&e.updateMatrix(),!1===function gme(n){return hE(n.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}(e.matrix)&&(s.matrix=e.matrix.elements);if(""!==e.name&&(s.name=String(e.name)),this.serializeUserData(e,s),e.isMesh||e.isLine||e.isPoints){const l=this.processMesh(e);null!==l&&(s.mesh=l)}else e.isCamera&&(s.camera=this.processCamera(e));if(e.isSkinnedMesh&&this.skins.push(e),e.children.length>0){const l=[];for(let d=0,u=e.children.length;d<u;d++){const p=e.children[d];if(p.visible||!1===i.onlyVisible){const _=this.processNode(p);null!==_&&l.push(_)}}l.length>0&&(s.children=l)}this._invokeAll(function(l){l.writeNode&&l.writeNode(e,s)});const a=t.nodes.push(s)-1;return r.set(e,a),a}processScene(e){const t=this.json,i=this.options;t.scenes||(t.scenes=[],t.scene=0);const r={};""!==e.name&&(r.name=e.name),t.scenes.push(r);const s=[];for(let a=0,l=e.children.length;a<l;a++){const d=e.children[a];if(d.visible||!1===i.onlyVisible){const u=this.processNode(d);null!==u&&s.push(u)}}s.length>0&&(r.nodes=s),this.serializeUserData(e,r)}processObjects(e){const t=new YS;t.name="AuxScene";for(let i=0;i<e.length;i++)t.children.push(e[i]);this.processScene(t)}processInput(e){const t=this.options;e=e instanceof Array?e:[e],this._invokeAll(function(r){r.beforeParse&&r.beforeParse(e)});const i=[];for(let r=0;r<e.length;r++)e[r]instanceof YS?this.processScene(e[r]):i.push(e[r]);i.length>0&&this.processObjects(i);for(let r=0;r<this.skins.length;++r)this.processSkin(this.skins[r]);for(let r=0;r<t.animations.length;++r)this.processAnimation(t.animations[r],e[0]);this._invokeAll(function(r){r.afterParse&&r.afterParse(e)})}_invokeAll(e){for(let t=0,i=this.plugins.length;t<i;t++)e(this.plugins[t])}}class vme{constructor(e){this.writer=e,this.name="KHR_lights_punctual"}writeNode(e,t){if(!e.isLight)return;if(!e.isDirectionalLight&&!e.isPointLight&&!e.isSpotLight)return void console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e);const i=this.writer,r=i.json,s=i.extensionsUsed,a={};e.name&&(a.name=e.name),a.color=e.color.toArray(),a.intensity=e.intensity,e.isDirectionalLight?a.type="directional":e.isPointLight?(a.type="point",e.distance>0&&(a.range=e.distance)):e.isSpotLight&&(a.type="spot",e.distance>0&&(a.range=e.distance),a.spot={},a.spot.innerConeAngle=(1-e.penumbra)*e.angle,a.spot.outerConeAngle=e.angle),void 0!==e.decay&&2!==e.decay&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),e.target&&(e.target.parent!==e||0!==e.target.position.x||0!==e.target.position.y||-1!==e.target.position.z)&&console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),s[this.name]||(r.extensions=r.extensions||{},r.extensions[this.name]={lights:[]},s[this.name]=!0);const l=r.extensions[this.name].lights;l.push(a),t.extensions=t.extensions||{},t.extensions[this.name]={light:l.length-1}}}class bme{constructor(e){this.writer=e,this.name="KHR_materials_unlit"}writeMaterial(e,t){if(!e.isMeshBasicMaterial)return;const r=this.writer.extensionsUsed;t.extensions=t.extensions||{},t.extensions[this.name]={},r[this.name]=!0,t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9}}class xme{constructor(e){this.writer=e,this.name="KHR_materials_clearcoat"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.clearcoat)return;const i=this.writer,r=i.extensionsUsed,s={};if(s.clearcoatFactor=e.clearcoat,e.clearcoatMap){const a={index:i.processTexture(e.clearcoatMap),texCoord:e.clearcoatMap.channel};i.applyTextureTransform(a,e.clearcoatMap),s.clearcoatTexture=a}if(s.clearcoatRoughnessFactor=e.clearcoatRoughness,e.clearcoatRoughnessMap){const a={index:i.processTexture(e.clearcoatRoughnessMap),texCoord:e.clearcoatRoughnessMap.channel};i.applyTextureTransform(a,e.clearcoatRoughnessMap),s.clearcoatRoughnessTexture=a}if(e.clearcoatNormalMap){const a={index:i.processTexture(e.clearcoatNormalMap),texCoord:e.clearcoatNormalMap.channel};i.applyTextureTransform(a,e.clearcoatNormalMap),s.clearcoatNormalTexture=a}t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class wme{constructor(e){this.writer=e,this.name="KHR_materials_iridescence"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.iridescence)return;const i=this.writer,r=i.extensionsUsed,s={};if(s.iridescenceFactor=e.iridescence,e.iridescenceMap){const a={index:i.processTexture(e.iridescenceMap),texCoord:e.iridescenceMap.channel};i.applyTextureTransform(a,e.iridescenceMap),s.iridescenceTexture=a}if(s.iridescenceIor=e.iridescenceIOR,s.iridescenceThicknessMinimum=e.iridescenceThicknessRange[0],s.iridescenceThicknessMaximum=e.iridescenceThicknessRange[1],e.iridescenceThicknessMap){const a={index:i.processTexture(e.iridescenceThicknessMap),texCoord:e.iridescenceThicknessMap.channel};i.applyTextureTransform(a,e.iridescenceThicknessMap),s.iridescenceThicknessTexture=a}t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class Cme{constructor(e){this.writer=e,this.name="KHR_materials_transmission"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.transmission)return;const i=this.writer,r=i.extensionsUsed,s={};if(s.transmissionFactor=e.transmission,e.transmissionMap){const a={index:i.processTexture(e.transmissionMap),texCoord:e.transmissionMap.channel};i.applyTextureTransform(a,e.transmissionMap),s.transmissionTexture=a}t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class Mme{constructor(e){this.writer=e,this.name="KHR_materials_volume"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.transmission)return;const i=this.writer,r=i.extensionsUsed,s={};if(s.thicknessFactor=e.thickness,e.thicknessMap){const a={index:i.processTexture(e.thicknessMap),texCoord:e.thicknessMap.channel};i.applyTextureTransform(a,e.thicknessMap),s.thicknessTexture=a}s.attenuationDistance=e.attenuationDistance,s.attenuationColor=e.attenuationColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class Sme{constructor(e){this.writer=e,this.name="KHR_materials_ior"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||1.5===e.ior)return;const r=this.writer.extensionsUsed,s={};s.ior=e.ior,t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class Eme{constructor(e){this.writer=e,this.name="KHR_materials_specular"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||1===e.specularIntensity&&e.specularColor.equals(ume)&&!e.specularIntensityMap&&!e.specularColorMap)return;const i=this.writer,r=i.extensionsUsed,s={};if(e.specularIntensityMap){const a={index:i.processTexture(e.specularIntensityMap),texCoord:e.specularIntensityMap.channel};i.applyTextureTransform(a,e.specularIntensityMap),s.specularTexture=a}if(e.specularColorMap){const a={index:i.processTexture(e.specularColorMap),texCoord:e.specularColorMap.channel};i.applyTextureTransform(a,e.specularColorMap),s.specularColorTexture=a}s.specularFactor=e.specularIntensity,s.specularColorFactor=e.specularColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class Tme{constructor(e){this.writer=e,this.name="KHR_materials_sheen"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0==e.sheen)return;const i=this.writer,r=i.extensionsUsed,s={};if(e.sheenRoughnessMap){const a={index:i.processTexture(e.sheenRoughnessMap),texCoord:e.sheenRoughnessMap.channel};i.applyTextureTransform(a,e.sheenRoughnessMap),s.sheenRoughnessTexture=a}if(e.sheenColorMap){const a={index:i.processTexture(e.sheenColorMap),texCoord:e.sheenColorMap.channel};i.applyTextureTransform(a,e.sheenColorMap),s.sheenColorTexture=a}s.sheenRoughnessFactor=e.sheenRoughness,s.sheenColorFactor=e.sheenColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class Dme{constructor(e){this.writer=e,this.name="KHR_materials_anisotropy"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0==e.anisotropy)return;const i=this.writer,r=i.extensionsUsed,s={};if(e.anisotropyMap){const a={index:i.processTexture(e.anisotropyMap)};i.applyTextureTransform(a,e.anisotropyMap),s.anisotropyTexture=a}s.anisotropyStrength=e.anisotropy,s.anisotropyRotation=e.anisotropyRotation,t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class Ime{constructor(e){this.writer=e,this.name="KHR_materials_emissive_strength"}writeMaterial(e,t){if(!e.isMeshStandardMaterial||1===e.emissiveIntensity)return;const r=this.writer.extensionsUsed,s={};s.emissiveStrength=e.emissiveIntensity,t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class Bme{constructor(e){this.writer=e,this.name="EXT_materials_bump"}writeMaterial(e,t){if(!e.isMeshStandardMaterial||1===e.bumpScale&&!e.bumpMap)return;const i=this.writer,r=i.extensionsUsed,s={};if(e.bumpMap){const a={index:i.processTexture(e.bumpMap),texCoord:e.bumpMap.channel};i.applyTextureTransform(a,e.bumpMap),s.bumpTexture=a}s.bumpFactor=e.bumpScale,t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class Pme{constructor(e){this.writer=e,this.name="EXT_mesh_gpu_instancing"}writeNode(e,t){if(!e.isInstancedMesh)return;const i=this.writer,r=e,s=new Float32Array(3*r.count),a=new Float32Array(4*r.count),l=new Float32Array(3*r.count),d=new wo,u=new It,p=new Gc,_=new It;for(let R=0;R<r.count;R++)r.getMatrixAt(R,d),d.decompose(u,p,_),u.toArray(s,3*R),p.toArray(a,4*R),_.toArray(l,3*R);const S={TRANSLATION:i.processAccessor(new No(s,3)),ROTATION:i.processAccessor(new No(a,4)),SCALE:i.processAccessor(new No(l,3))};r.instanceColor&&(S._COLOR_0=i.processAccessor(r.instanceColor)),t.extensions=t.extensions||{},t.extensions[this.name]={attributes:S},i.extensionsUsed[this.name]=!0,i.extensionsRequired[this.name]=!0}}a4.Utils={insertKeyframe:function(n,e){const i=n.getValueSize(),r=new n.TimeBufferType(n.times.length+1),s=new n.ValueBufferType(n.values.length+i),a=n.createInterpolant(new n.ValueBufferType(i));let l;if(0===n.times.length){r[0]=e;for(let d=0;d<i;d++)s[d]=0;l=0}else if(e<n.times[0]){if(Math.abs(n.times[0]-e)<.001)return 0;r[0]=e,r.set(n.times,1),s.set(a.evaluate(e),0),s.set(n.values,i),l=0}else if(e>n.times[n.times.length-1]){if(Math.abs(n.times[n.times.length-1]-e)<.001)return n.times.length-1;r[r.length-1]=e,r.set(n.times,0),s.set(n.values,0),s.set(a.evaluate(e),n.values.length),l=r.length-1}else for(let d=0;d<n.times.length;d++){if(Math.abs(n.times[d]-e)<.001)return d;if(n.times[d]<e&&n.times[d+1]>e){r.set(n.times.slice(0,d+1),0),r[d+1]=e,r.set(n.times.slice(d+1),d+2),s.set(n.values.slice(0,(d+1)*i),0),s.set(a.evaluate(e),(d+1)*i),s.set(n.values.slice((d+1)*i),(d+2)*i),l=d+1;break}}return n.times=r,n.values=s,l},mergeMorphTargetTracks:function(n,e){const t=[],i={},r=n.tracks;for(let s=0;s<r.length;++s){let a=r[s];const l=Ll.parseTrackName(a.name),d=Ll.findNode(e,l.nodeName);if("morphTargetInfluences"!==l.propertyName||void 0===l.propertyIndex){t.push(a);continue}if(a.createInterpolant!==a.InterpolantFactoryMethodDiscrete&&a.createInterpolant!==a.InterpolantFactoryMethodLinear){if(a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),a=a.clone(),a.setInterpolation(Bb)}const u=d.morphTargetInfluences.length,p=d.morphTargetDictionary[l.propertyIndex];if(void 0===p)throw new Error("THREE.GLTFExporter: Morph target name not found: "+l.propertyIndex);let _;if(void 0===i[d.uuid]){_=a.clone();const R=new _.ValueBufferType(u*_.times.length);for(let H=0;H<_.times.length;H++)R[H*u+p]=_.values[H];_.name=(l.nodeName||"")+".morphTargetInfluences",_.values=R,i[d.uuid]=_,t.push(_);continue}const S=a.createInterpolant(new a.ValueBufferType(1));_=i[d.uuid];for(let R=0;R<_.times.length;R++)_.values[R*u+p]=S.evaluate(_.times[R]);for(let R=0;R<a.times.length;R++){const H=this.insertKeyframe(_,a.times[R]);_.values[H*u+p]=a.values[R]}}return n.tracks=t,n}};const fC=(n,e,t="application/json")=>{const i=new Blob([n],{type:t}),r=document.createElement("a");r.style.display="none",r.href=URL.createObjectURL(i),r.download=e,r.click(),r.remove()},bq=(n,e="application/json")=>{let t=document.createElement("input");t.type="file",t.accept=e,t.onchange=i=>{const r=i.target?.files[0],s=new FileReader;s.onload=a=>{n?.(a.target.result.toString()),t.remove(),t=null},s.readAsText(r)},t.click(),setTimeout(()=>{console.log("Let us just wait a second")},1e3)};class Rme{exportSceneToOBJ(e){const i=(new dme).parse(e);fC(i,"phoenix-obj.obj","text/plain")}exportPhoenixScene(e,t,i){const r=new a4,s=this.saveSceneConfig(t,i);r.parse(e,a=>{const d=JSON.stringify({sceneConfiguration:s,scene:a},null,2);fC(d,"phoenix-scene.phnx","text/plain")},null)}saveSceneConfig(e,t){return{eventData:this.saveEventDataConfiguration(e),geometries:this.saveGeometriesConfiguration(t)}}saveEventDataConfiguration(e){const t={};for(const i of e.children)if(i.name){t[i.name]=[];for(const r of i.children)r.name&&t[i.name].push(r.name)}return t}saveGeometriesConfiguration(e){const t=[];return e.children.forEach(i=>{"EventData"!==i.name&&t.push(i.name)}),t}exportGeometriesToGLTF(e){(new a4).parse(e,r=>{if(r instanceof ArrayBuffer){const s=function i(r){let s="";const a=new Uint8Array(r),l=a.byteLength;for(let d=0;d<l;d++)s+=String.fromCharCode(a[d]);return window.btoa(s)}(r);fC(s,"geometries.glb","application/octet-stream")}else{const s=JSON.stringify(r,null,2);fC(s,"geometries.gltf","text/plain")}},r=>{console.error("Error exporting geometries:",r)},{})}}const kme=/^[og]\s*(.+)?/,Fme=/^mtllib /,Ome=/^usemtl /,Lme=/^usemap /,xq=/\s+/,wq=new It,EF=new It,Cq=new It,Mq=new It,uA=new It,l4=new Cr;function Nme(){const n={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);const i=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(r,s){const a=this._finalize(!1);a&&(a.inherited||a.groupCount<=0)&&this.materials.splice(a.index,1);const l={index:this.materials.length,name:r||"",mtllib:Array.isArray(s)&&s.length>0?s[s.length-1]:"",smooth:void 0!==a?a.smooth:this.smooth,groupStart:void 0!==a?a.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(d){const u={index:"number"==typeof d?d:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return u.clone=this.clone.bind(u),u}};return this.materials.push(l),l},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(r){const s=this.currentMaterial();if(s&&-1===s.groupEnd&&(s.groupEnd=this.geometry.vertices.length/3,s.groupCount=s.groupEnd-s.groupStart,s.inherited=!1),r&&this.materials.length>1)for(let a=this.materials.length-1;a>=0;a--)this.materials[a].groupCount<=0&&this.materials.splice(a,1);return r&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),s}},i&&i.name&&"function"==typeof i.clone){const r=i.clone(0);r.inherited=!0,this.object.materials.push(r)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){const i=parseInt(e,10);return 3*(i>=0?i-1:i+t/3)},parseNormalIndex:function(e,t){const i=parseInt(e,10);return 3*(i>=0?i-1:i+t/3)},parseUVIndex:function(e,t){const i=parseInt(e,10);return 2*(i>=0?i-1:i+t/2)},addVertex:function(e,t,i){const r=this.vertices,s=this.object.geometry.vertices;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[t+0],r[t+1],r[t+2]),s.push(r[i+0],r[i+1],r[i+2])},addVertexPoint:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,i){const r=this.normals,s=this.object.geometry.normals;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[t+0],r[t+1],r[t+2]),s.push(r[i+0],r[i+1],r[i+2])},addFaceNormal:function(e,t,i){const r=this.vertices,s=this.object.geometry.normals;wq.fromArray(r,e),EF.fromArray(r,t),Cq.fromArray(r,i),uA.subVectors(Cq,EF),Mq.subVectors(wq,EF),uA.cross(Mq),uA.normalize(),s.push(uA.x,uA.y,uA.z),s.push(uA.x,uA.y,uA.z),s.push(uA.x,uA.y,uA.z)},addColor:function(e,t,i){const r=this.colors,s=this.object.geometry.colors;void 0!==r[e]&&s.push(r[e+0],r[e+1],r[e+2]),void 0!==r[t]&&s.push(r[t+0],r[t+1],r[t+2]),void 0!==r[i]&&s.push(r[i+0],r[i+1],r[i+2])},addUV:function(e,t,i){const r=this.uvs,s=this.object.geometry.uvs;s.push(r[e+0],r[e+1]),s.push(r[t+0],r[t+1]),s.push(r[i+0],r[i+1])},addDefaultUV:function(){const e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){const t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,i,r,s,a,l,d,u){const p=this.vertices.length;let _=this.parseVertexIndex(e,p),S=this.parseVertexIndex(t,p),R=this.parseVertexIndex(i,p);if(this.addVertex(_,S,R),this.addColor(_,S,R),void 0!==l&&""!==l){const H=this.normals.length;_=this.parseNormalIndex(l,H),S=this.parseNormalIndex(d,H),R=this.parseNormalIndex(u,H),this.addNormal(_,S,R)}else this.addFaceNormal(_,S,R);if(void 0!==r&&""!==r){const H=this.uvs.length;_=this.parseUVIndex(r,H),S=this.parseUVIndex(s,H),R=this.parseUVIndex(a,H),this.addUV(_,S,R),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";const t=this.vertices.length;for(let i=0,r=e.length;i<r;i++){const s=this.parseVertexIndex(e[i],t);this.addVertexPoint(s),this.addColor(s)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";const i=this.vertices.length,r=this.uvs.length;for(let s=0,a=e.length;s<a;s++)this.addVertexLine(this.parseVertexIndex(e[s],i));for(let s=0,a=t.length;s<a;s++)this.addUVLine(this.parseUVIndex(t[s],r))}};return n.startObject("",!1),n}class Sq extends Gh{constructor(e){super(e),this.materials=null}load(e,t,i,r){const s=this,a=new vp(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){try{t(s.parse(l))}catch(d){r?r(d):console.error(d),s.manager.itemError(e)}},i,r)}setMaterials(e){return this.materials=e,this}parse(e){const t=new Nme;-1!==e.indexOf("\r\n")&&(e=e.replace(/\r\n/g,"\n")),-1!==e.indexOf("\\\n")&&(e=e.replace(/\\\n/g,""));const i=e.split("\n");let r=[];for(let l=0,d=i.length;l<d;l++){const u=i[l].trimStart();if(0===u.length)continue;const p=u.charAt(0);if("#"!==p)if("v"===p){const _=u.split(xq);switch(_[0]){case"v":t.vertices.push(parseFloat(_[1]),parseFloat(_[2]),parseFloat(_[3])),_.length>=7?(l4.setRGB(parseFloat(_[4]),parseFloat(_[5]),parseFloat(_[6])).convertSRGBToLinear(),t.colors.push(l4.r,l4.g,l4.b)):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(_[1]),parseFloat(_[2]),parseFloat(_[3]));break;case"vt":t.uvs.push(parseFloat(_[1]),parseFloat(_[2]))}}else if("f"===p){const S=u.slice(1).trim().split(xq),R=[];for(let re=0,se=S.length;re<se;re++){const ce=S[re];if(ce.length>0){const Te=ce.split("/");R.push(Te)}}const H=R[0];for(let re=1,se=R.length-1;re<se;re++){const ce=R[re],Te=R[re+1];t.addFace(H[0],ce[0],Te[0],H[1],ce[1],Te[1],H[2],ce[2],Te[2])}}else if("l"===p){const _=u.substring(1).trim().split(" ");let S=[];const R=[];if(-1===u.indexOf("/"))S=_;else for(let H=0,re=_.length;H<re;H++){const se=_[H].split("/");""!==se[0]&&S.push(se[0]),""!==se[1]&&R.push(se[1])}t.addLineGeometry(S,R)}else if("p"===p){const S=u.slice(1).trim().split(" ");t.addPointGeometry(S)}else if(null!==(r=kme.exec(u))){const _=(" "+r[0].slice(1).trim()).slice(1);t.startObject(_)}else if(Ome.test(u))t.object.startMaterial(u.substring(7).trim(),t.materialLibraries);else if(Fme.test(u))t.materialLibraries.push(u.substring(7).trim());else if(Lme.test(u))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===p){if(r=u.split(" "),r.length>1){const S=r[1].trim().toLowerCase();t.object.smooth="0"!==S&&"off"!==S}else t.object.smooth=!0;const _=t.object.currentMaterial();_&&(_.smooth=t.object.smooth)}else{if("\0"===u)continue;console.warn('THREE.OBJLoader: Unexpected line: "'+u+'"')}}t.finalize();const s=new Wl;if(s.materialLibraries=[].concat(t.materialLibraries),1==!(1===t.objects.length&&0===t.objects[0].geometry.vertices.length))for(let l=0,d=t.objects.length;l<d;l++){const u=t.objects[l],p=u.geometry,_=u.materials,S="Line"===p.type,R="Points"===p.type;let H=!1;if(0===p.vertices.length)continue;const re=new no;re.setAttribute("position",new Ws(p.vertices,3)),p.normals.length>0&&re.setAttribute("normal",new Ws(p.normals,3)),p.colors.length>0&&(H=!0,re.setAttribute("color",new Ws(p.colors,3))),!0===p.hasUVIndices&&re.setAttribute("uv",new Ws(p.uvs,2));const se=[];for(let Te=0,Ce=_.length;Te<Ce;Te++){const qe=_[Te],wt=qe.name+"_"+qe.smooth+"_"+H;let gt=t.materials[wt];if(null!==this.materials)if(gt=this.materials.create(qe.name),!S||!gt||gt instanceof Dc){if(R&&gt&&!(gt instanceof X_)){const Et=new X_({size:10,sizeAttenuation:!1});ld.prototype.copy.call(Et,gt),Et.color.copy(gt.color),Et.map=gt.map,gt=Et}}else{const Et=new Dc;ld.prototype.copy.call(Et,gt),Et.color.copy(gt.color),gt=Et}void 0===gt&&(gt=S?new Dc:R?new X_({size:1,sizeAttenuation:!1}):new pg,gt.name=qe.name,gt.flatShading=!qe.smooth,gt.vertexColors=H,t.materials[wt]=gt),se.push(gt)}let ce;if(se.length>1){for(let Te=0,Ce=_.length;Te<Ce;Te++){const qe=_[Te];re.addGroup(qe.groupStart,qe.groupCount,Te)}ce=S?new hc(re,se):R?new Wb(re,se):new ua(re,se)}else ce=S?new hc(re,se[0]):R?new Wb(re,se[0]):new ua(re,se[0]);ce.name=u.name,s.add(ce)}else if(t.vertices.length>0){const l=new X_({size:1,sizeAttenuation:!1}),d=new no;d.setAttribute("position",new Ws(t.vertices,3)),t.colors.length>0&&void 0!==t.colors[0]&&(d.setAttribute("color",new Ws(t.colors,3)),l.vertexColors=!0);const u=new Wb(d,l);s.add(u)}return s}}function TF(n,e=!1){const t=null!==n[0].index,i=new Set(Object.keys(n[0].attributes)),r=new Set(Object.keys(n[0].morphAttributes)),s={},a={},l=n[0].morphTargetsRelative,d=new no;let u=0;for(let p=0;p<n.length;++p){const _=n[p];let S=0;if(t!==(null!==_.index))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+p+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const R in _.attributes){if(!i.has(R))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+p+'. All geometries must have compatible attributes; make sure "'+R+'" attribute exists among all geometries, or in none of them.'),null;void 0===s[R]&&(s[R]=[]),s[R].push(_.attributes[R]),S++}if(S!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+p+". Make sure all geometries have the same number of attributes."),null;if(l!==_.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+p+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const R in _.morphAttributes){if(!r.has(R))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+p+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===a[R]&&(a[R]=[]),a[R].push(_.morphAttributes[R])}if(e){let R;if(t)R=_.index.count;else{if(void 0===_.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+p+". The geometry must have either an index or a position attribute"),null;R=_.attributes.position.count}d.addGroup(u,R,p),u+=R}}if(t){let p=0;const _=[];for(let S=0;S<n.length;++S){const R=n[S].index;for(let H=0;H<R.count;++H)_.push(R.getX(H)+p);p+=n[S].attributes.position.count}d.setIndex(_)}for(const p in s){const _=Eq(s[p]);if(!_)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+p+" attribute."),null;d.setAttribute(p,_)}for(const p in a){const _=a[p][0].length;if(0===_)break;d.morphAttributes=d.morphAttributes||{},d.morphAttributes[p]=[];for(let S=0;S<_;++S){const R=[];for(let re=0;re<a[p].length;++re)R.push(a[p][re][S]);const H=Eq(R);if(!H)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+p+" morphAttribute."),null;d.morphAttributes[p].push(H)}}return d}function Eq(n){let e,t,i,r=-1,s=0;for(let u=0;u<n.length;++u){const p=n[u];if(void 0===e&&(e=p.array.constructor),e!==p.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===t&&(t=p.itemSize),t!==p.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===i&&(i=p.normalized),i!==p.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(-1===r&&(r=p.gpuType),r!==p.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;s+=p.count*t}const a=new e(s),l=new No(a,t,i);let d=0;for(let u=0;u<n.length;++u){const p=n[u];if(p.isInterleavedBufferAttribute){const _=d/t;for(let S=0,R=p.count;S<R;S++)for(let H=0;H<t;H++){const re=p.getComponent(S,H);l.setComponent(S+_,H,re)}}else a.set(p.array,d);d+=p.count*t}return void 0!==r&&(l.gpuType=r),l}function Tq(n,e){if(0===e)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(2===e||1===e){let t=n.getIndex();if(null===t){const a=[],l=n.getAttribute("position");if(void 0===l)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n;for(let d=0;d<l.count;d++)a.push(d);n.setIndex(a),t=n.getIndex()}const i=t.count-2,r=[];if(2===e)for(let a=1;a<=i;a++)r.push(t.getX(0)),r.push(t.getX(a)),r.push(t.getX(a+1));else for(let a=0;a<i;a++)a%2==0?(r.push(t.getX(a)),r.push(t.getX(a+1)),r.push(t.getX(a+2))):(r.push(t.getX(a+2)),r.push(t.getX(a+1)),r.push(t.getX(a)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(r),s.clearGroups(),s}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}class c4 extends Gh{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new Gme(t)}),this.register(function(t){return new Zme(t)}),this.register(function(t){return new Jme(t)}),this.register(function(t){return new eAe(t)}),this.register(function(t){return new Qme(t)}),this.register(function(t){return new Wme(t)}),this.register(function(t){return new jme(t)}),this.register(function(t){return new $me(t)}),this.register(function(t){return new Vme(t)}),this.register(function(t){return new Xme(t)}),this.register(function(t){return new qme(t)}),this.register(function(t){return new Kme(t)}),this.register(function(t){return new Yme(t)}),this.register(function(t){return new zme(t)}),this.register(function(t){return new tAe(t)}),this.register(function(t){return new nAe(t)})}load(e,t,i,r){const s=this;let a;if(""!==this.resourcePath)a=this.resourcePath;else if(""!==this.path){const u=ex.extractUrlBase(e);a=ex.resolveURL(u,this.path)}else a=ex.extractUrlBase(e);this.manager.itemStart(e);const l=function(u){r?r(u):console.error(u),s.manager.itemError(e),s.manager.itemEnd(e)},d=new vp(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(e,function(u){try{s.parse(u,a,function(p){t(p),s.manager.itemEnd(e)},l)}catch(p){l(p)}},i,l)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let s;const a={},l={},d=new TextDecoder;if("string"==typeof e)s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(d.decode(new Uint8Array(e,0,4))===Dq){try{a[al.KHR_BINARY_GLTF]=new iAe(e)}catch(_){return void(r&&r(_))}s=JSON.parse(a[al.KHR_BINARY_GLTF].content)}else s=JSON.parse(d.decode(e));else s=e;if(void 0===s.asset||s.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const u=new AAe(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});u.fileLoader.setRequestHeader(this.requestHeader);for(let p=0;p<this.pluginCallbacks.length;p++){const _=this.pluginCallbacks[p](u);_.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),l[_.name]=_,a[_.name]=!0}if(s.extensionsUsed)for(let p=0;p<s.extensionsUsed.length;++p){const _=s.extensionsUsed[p],S=s.extensionsRequired||[];switch(_){case al.KHR_MATERIALS_UNLIT:a[_]=new Hme;break;case al.KHR_DRACO_MESH_COMPRESSION:a[_]=new rAe(s,this.dracoLoader);break;case al.KHR_TEXTURE_TRANSFORM:a[_]=new sAe;break;case al.KHR_MESH_QUANTIZATION:a[_]=new oAe;break;default:S.indexOf(_)>=0&&void 0===l[_]&&console.warn('THREE.GLTFLoader: Unknown extension "'+_+'".')}}u.setExtensions(a),u.setPlugins(l),u.parse(i,r)}parseAsync(e,t){const i=this;return new Promise(function(r,s){i.parse(e,t,r,s)})}}function Ume(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const al={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class zme{constructor(e){this.parser=e,this.name=al.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,r=t.length;i<r;i++){const s=t[i];s.extensions&&s.extensions[this.name]&&void 0!==s.extensions[this.name].light&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let r=t.cache.get(i);if(r)return r;const s=t.json,d=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let u;const p=new Cr(16777215);void 0!==d.color&&p.setRGB(d.color[0],d.color[1],d.color[2],Wu);const _=void 0!==d.range?d.range:0;switch(d.type){case"directional":u=new uC(p),u.target.position.set(0,0,-1),u.add(u.target);break;case"point":u=new HG(p),u.distance=_;break;case"spot":u=new UG(p),u.distance=_,d.spot=d.spot||{},d.spot.innerConeAngle=void 0!==d.spot.innerConeAngle?d.spot.innerConeAngle:0,d.spot.outerConeAngle=void 0!==d.spot.outerConeAngle?d.spot.outerConeAngle:Math.PI/4,u.angle=d.spot.outerConeAngle,u.penumbra=1-d.spot.innerConeAngle/d.spot.outerConeAngle,u.target.position.set(0,0,-1),u.add(u.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+d.type)}return u.position.set(0,0,0),u.decay=2,jy(u,d),void 0!==d.intensity&&(u.intensity=d.intensity),u.name=t.createUniqueName(d.name||"light_"+e),r=Promise.resolve(u),t.cache.add(i,r),r}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,s=i.json.nodes[e],l=(s.extensions&&s.extensions[this.name]||{}).light;return void 0===l?null:this._loadLight(l).then(function(d){return i._getNodeRef(t.cache,l,d)})}}class Hme{constructor(){this.name=al.KHR_MATERIALS_UNLIT}getMaterialType(){return xd}extendParams(e,t,i){const r=[];e.color=new Cr(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const a=s.baseColorFactor;e.color.setRGB(a[0],a[1],a[2],Wu),e.opacity=a[3]}void 0!==s.baseColorTexture&&r.push(i.assignTexture(e,"map",s.baseColorTexture,du))}return Promise.all(r)}}class Vme{constructor(e){this.parser=e,this.name=al.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return void 0!==s&&(t.emissiveIntensity=s),Promise.resolve()}}class Gme{constructor(e){this.parser=e,this.name=al.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?T0:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];if(void 0!==a.clearcoatFactor&&(t.clearcoat=a.clearcoatFactor),void 0!==a.clearcoatTexture&&s.push(i.assignTexture(t,"clearcoatMap",a.clearcoatTexture)),void 0!==a.clearcoatRoughnessFactor&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),void 0!==a.clearcoatRoughnessTexture&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),void 0!==a.clearcoatNormalTexture&&(s.push(i.assignTexture(t,"clearcoatNormalMap",a.clearcoatNormalTexture)),void 0!==a.clearcoatNormalTexture.scale)){const l=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Qi(l,l)}return Promise.all(s)}}class qme{constructor(e){this.parser=e,this.name=al.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?T0:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];return void 0!==a.iridescenceFactor&&(t.iridescence=a.iridescenceFactor),void 0!==a.iridescenceTexture&&s.push(i.assignTexture(t,"iridescenceMap",a.iridescenceTexture)),void 0!==a.iridescenceIor&&(t.iridescenceIOR=a.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==a.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=a.iridescenceThicknessMinimum),void 0!==a.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=a.iridescenceThicknessMaximum),void 0!==a.iridescenceThicknessTexture&&s.push(i.assignTexture(t,"iridescenceThicknessMap",a.iridescenceThicknessTexture)),Promise.all(s)}}class Qme{constructor(e){this.parser=e,this.name=al.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?T0:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new Cr(0,0,0),t.sheenRoughness=0,t.sheen=1;const a=r.extensions[this.name];if(void 0!==a.sheenColorFactor){const l=a.sheenColorFactor;t.sheenColor.setRGB(l[0],l[1],l[2],Wu)}return void 0!==a.sheenRoughnessFactor&&(t.sheenRoughness=a.sheenRoughnessFactor),void 0!==a.sheenColorTexture&&s.push(i.assignTexture(t,"sheenColorMap",a.sheenColorTexture,du)),void 0!==a.sheenRoughnessTexture&&s.push(i.assignTexture(t,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(s)}}class Wme{constructor(e){this.parser=e,this.name=al.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?T0:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];return void 0!==a.transmissionFactor&&(t.transmission=a.transmissionFactor),void 0!==a.transmissionTexture&&s.push(i.assignTexture(t,"transmissionMap",a.transmissionTexture)),Promise.all(s)}}class jme{constructor(e){this.parser=e,this.name=al.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?T0:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];t.thickness=void 0!==a.thicknessFactor?a.thicknessFactor:0,void 0!==a.thicknessTexture&&s.push(i.assignTexture(t,"thicknessMap",a.thicknessTexture)),t.attenuationDistance=a.attenuationDistance||1/0;const l=a.attenuationColor||[1,1,1];return t.attenuationColor=(new Cr).setRGB(l[0],l[1],l[2],Wu),Promise.all(s)}}class $me{constructor(e){this.parser=e,this.name=al.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?T0:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=void 0!==s.ior?s.ior:1.5,Promise.resolve()}}class Xme{constructor(e){this.parser=e,this.name=al.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?T0:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];t.specularIntensity=void 0!==a.specularFactor?a.specularFactor:1,void 0!==a.specularTexture&&s.push(i.assignTexture(t,"specularIntensityMap",a.specularTexture));const l=a.specularColorFactor||[1,1,1];return t.specularColor=(new Cr).setRGB(l[0],l[1],l[2],Wu),void 0!==a.specularColorTexture&&s.push(i.assignTexture(t,"specularColorMap",a.specularColorTexture,du)),Promise.all(s)}}class Yme{constructor(e){this.parser=e,this.name=al.EXT_MATERIALS_BUMP}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?T0:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];return t.bumpScale=void 0!==a.bumpFactor?a.bumpFactor:1,void 0!==a.bumpTexture&&s.push(i.assignTexture(t,"bumpMap",a.bumpTexture)),Promise.all(s)}}class Kme{constructor(e){this.parser=e,this.name=al.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?T0:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];return void 0!==a.anisotropyStrength&&(t.anisotropy=a.anisotropyStrength),void 0!==a.anisotropyRotation&&(t.anisotropyRotation=a.anisotropyRotation),void 0!==a.anisotropyTexture&&s.push(i.assignTexture(t,"anisotropyMap",a.anisotropyTexture)),Promise.all(s)}}class Zme{constructor(e){this.parser=e,this.name=al.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],a=t.options.ktx2Loader;if(!a){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,a)}}class Jme{constructor(e){this.parser=e,this.name=al.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const a=s.extensions[t],l=r.images[a.source];let d=i.textureLoader;if(l.uri){const u=i.options.manager.getHandler(l.uri);null!==u&&(d=u)}return this.detectSupport().then(function(u){if(u)return i.loadTextureImage(e,a.source,d);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class eAe{constructor(e){this.parser=e,this.name=al.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const a=s.extensions[t],l=r.images[a.source];let d=i.textureLoader;if(l.uri){const u=i.options.manager.getHandler(l.uri);null!==u&&(d=u)}return this.detectSupport().then(function(u){if(u)return i.loadTextureImage(e,a.source,d);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class tAe{constructor(e){this.name=al.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(l){const p=r.count,_=r.byteStride,S=new Uint8Array(l,r.byteOffset||0,r.byteLength||0);return a.decodeGltfBufferAsync?a.decodeGltfBufferAsync(p,_,S,r.mode,r.filter).then(function(R){return R.buffer}):a.ready.then(function(){const R=new ArrayBuffer(p*_);return a.decodeGltfBuffer(new Uint8Array(R),p,_,S,r.mode,r.filter),R})})}return null}}class nAe{constructor(e){this.name=al.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||void 0===i.mesh)return null;const r=t.meshes[i.mesh];for(const u of r.primitives)if(u.mode!==hA.TRIANGLES&&u.mode!==hA.TRIANGLE_STRIP&&u.mode!==hA.TRIANGLE_FAN&&void 0!==u.mode)return null;const a=i.extensions[this.name].attributes,l=[],d={};for(const u in a)l.push(this.parser.getDependency("accessor",a[u]).then(p=>(d[u]=p,d[u])));return l.length<1?null:(l.push(this.parser.createNodeMesh(e)),Promise.all(l).then(u=>{const p=u.pop(),_=p.isGroup?p.children:[p],S=u[0].count,R=[];for(const H of _){const re=new wo,se=new It,ce=new Gc,Te=new It(1,1,1),Ce=new sG(H.geometry,H.material,S);for(let qe=0;qe<S;qe++)d.TRANSLATION&&se.fromBufferAttribute(d.TRANSLATION,qe),d.ROTATION&&ce.fromBufferAttribute(d.ROTATION,qe),d.SCALE&&Te.fromBufferAttribute(d.SCALE,qe),Ce.setMatrixAt(qe,re.compose(se,ce,Te));for(const qe in d)if("_COLOR_0"===qe){const wt=d[qe];Ce.instanceColor=new eC(wt.array,wt.itemSize,wt.normalized)}else"TRANSLATION"!==qe&&"ROTATION"!==qe&&"SCALE"!==qe&&H.geometry.setAttribute(qe,d[qe]);Pl.prototype.copy.call(Ce,H),this.parser.assignFinalMaterial(Ce),R.push(Ce)}return p.isGroup?(p.clear(),p.add(...R),p):R[0]}))}}const Dq="glTF";class iAe{constructor(e){this.name=al.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==Dq)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-12,s=new DataView(e,12);let a=0;for(;a<r;){const l=s.getUint32(a,!0);a+=4;const d=s.getUint32(a,!0);if(a+=4,1313821514===d){const u=new Uint8Array(e,12+a,l);this.content=i.decode(u)}else if(5130562===d){const u=12+a;this.body=e.slice(u,u+l)}a+=l}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class rAe{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=al.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,l={},d={},u={};for(const p in a){const _=BF[p]||p.toLowerCase();l[_]=a[p]}for(const p in e.attributes){const _=BF[p]||p.toLowerCase();if(void 0!==a[p]){const S=i.accessors[e.attributes[p]];u[_]=pC[S.componentType].name,d[_]=!0===S.normalized}}return t.getDependency("bufferView",s).then(function(p){return new Promise(function(_,S){r.decodeDracoFile(p,function(R){for(const H in R.attributes){const se=d[H];void 0!==se&&(R.attributes[H].normalized=se)}_(R)},l,u,Wu,S)})})}}class sAe{constructor(){this.name=al.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class oAe{constructor(){this.name=al.KHR_MESH_QUANTIZATION}}class Bq extends lE{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let a=0;a!==r;a++)t[a]=i[s+a];return t}interpolate_(e,t,i,r){const s=this.resultBuffer,a=this.sampleValues,l=this.valueSize,d=2*l,u=3*l,p=r-t,_=(i-t)/p,S=_*_,R=S*_,H=e*u,re=H-u,se=-2*R+3*S,ce=R-S,Te=1-se,Ce=ce-S+_;for(let qe=0;qe!==l;qe++)s[qe]=Te*a[re+qe+l]+Ce*(a[re+qe+d]*p)+se*a[H+qe+l]+ce*(a[H+qe]*p);return s}}const aAe=new Gc;class lAe extends Bq{interpolate_(e,t,i,r){const s=super.interpolate_(e,t,i,r);return aAe.fromArray(s).normalize().toArray(s),s}}const hA={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},pC={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Pq={9728:vd,9729:Hc,9984:1004,9985:y2,9986:Ry,9987:oA},Rq={33071:bh,33648:_2,10497:Py},IF={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},BF={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Wy={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},cAe={CUBICSPLINE:void 0,LINEAR:Bb,STEP:b2};function ox(n,e,t){for(const i in t.extensions)void 0===n[i]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function jy(n,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function hAe(n,e){if(n.updateMorphTargets(),void 0!==e.weights)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function fAe(n){let e;const t=n.extensions&&n.extensions[al.KHR_DRACO_MESH_COMPRESSION];if(e=t?"draco:"+t.bufferView+":"+t.indices+":"+RF(t.attributes):n.indices+":"+RF(n.attributes)+":"+n.mode,void 0!==n.targets)for(let i=0,r=n.targets.length;i<r;i++)e+=":"+RF(n.targets[i]);return e}function RF(n){let e="";const t=Object.keys(n).sort();for(let i=0,r=t.length;i<r;i++)e+=t[i]+":"+n[t[i]]+";";return e}function kF(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const mAe=new wo;class AAe{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new Ume,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,r=!1,s=-1;typeof navigator<"u"&&(i=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),this.textureLoader=typeof createImageBitmap>"u"||i||r&&s<98?new Spe(this.options.manager):new Npe(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new vp(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(a){return a._markDefs&&a._markDefs()}),Promise.all(this._invokeAll(function(a){return a.beforeRoot&&a.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(a){const l={scene:a[0][r.scene||0],scenes:a[0],animations:a[1],cameras:a[2],asset:r.asset,parser:i,userData:{}};return ox(s,l,r),jy(l,r),Promise.all(i._invokeAll(function(d){return d.afterRoot&&d.afterRoot(l)})).then(function(){e(l)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const a=t[r].joints;for(let l=0,d=a.length;l<d;l++)e[a[l]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const a=e[r];void 0!==a.mesh&&(this._addNodeRef(this.meshCache,a.mesh),void 0!==a.skin&&(i[a.mesh].isSkinnedMesh=!0)),void 0!==a.camera&&this._addNodeRef(this.cameraCache,a.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const r=i.clone(),s=(a,l)=>{const d=this.associations.get(a);null!=d&&this.associations.set(l,d);for(const[u,p]of a.children.entries())s(p,l.children[u])};return s(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const r=e(t[i]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&i.push(s)}return i}getDependency(e,t){const i=e+":"+t;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e)}this.cache.add(i,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(s,a){return i.getDependency(e,a)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[al.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,a){i.load(ex.resolveURL(t.uri,r.path),s,void 0,function(){a(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const s=t.byteOffset||0;return i.slice(s,s+(t.byteLength||0))})}loadAccessor(e){const t=this,i=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse){const a=IF[r.type],d=!0===r.normalized,u=new(0,pC[r.componentType])(r.count*a);return Promise.resolve(new No(u,a,d))}const s=[];return s.push(void 0!==r.bufferView?this.getDependency("bufferView",r.bufferView):null),void 0!==r.sparse&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(a){const l=a[0],d=IF[r.type],u=pC[r.componentType],p=u.BYTES_PER_ELEMENT,S=r.byteOffset||0,R=void 0!==r.bufferView?i.bufferViews[r.bufferView].byteStride:void 0,H=!0===r.normalized;let re,se;if(R&&R!==p*d){const ce=Math.floor(S/R),Te="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+ce+":"+r.count;let Ce=t.cache.get(Te);Ce||(re=new u(l,ce*R,r.count*R/p),Ce=new wI(re,R/p),t.cache.add(Te,Ce)),se=new Gb(Ce,d,S%R/p,H)}else re=null===l?new u(r.count*d):new u(l,S,r.count*d),se=new No(re,d,H);if(void 0!==r.sparse){const qe=r.sparse.values.byteOffset||0,wt=new(0,pC[r.sparse.indices.componentType])(a[1],r.sparse.indices.byteOffset||0,r.sparse.count*IF.SCALAR),gt=new u(a[2],qe,r.sparse.count*d);null!==l&&(se=new No(se.array.slice(),se.itemSize,se.normalized));for(let Et=0,Xt=wt.length;Et<Xt;Et++){const Un=wt[Et];if(se.setX(Un,gt[Et*d]),d>=2&&se.setY(Un,gt[Et*d+1]),d>=3&&se.setZ(Un,gt[Et*d+2]),d>=4&&se.setW(Un,gt[Et*d+3]),d>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return se})}loadTexture(e){const t=this.json,s=t.textures[e].source,a=t.images[s];let l=this.textureLoader;if(a.uri){const d=this.options.manager.getHandler(a.uri);null!==d&&(l=d)}return this.loadTextureImage(e,s,l)}loadTextureImage(e,t,i){const r=this,s=this.json,a=s.textures[e],l=s.images[t],d=(l.uri||l.bufferView)+":"+a.sampler;if(this.textureCache[d])return this.textureCache[d];const u=this.loadImageSource(t,i).then(function(p){p.flipY=!1,p.name=a.name||l.name||"",""===p.name&&"string"==typeof l.uri&&!1===l.uri.startsWith("data:image/")&&(p.name=l.uri);const S=(s.samplers||{})[a.sampler]||{};return p.magFilter=Pq[S.magFilter]||Hc,p.minFilter=Pq[S.minFilter]||oA,p.wrapS=Rq[S.wrapS]||Py,p.wrapT=Rq[S.wrapT]||Py,r.associations.set(p,{textures:e}),p}).catch(function(){return null});return this.textureCache[d]=u,u}loadImageSource(e,t){const r=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(_=>_.clone());const a=r.images[e],l=self.URL||self.webkitURL;let d=a.uri||"",u=!1;if(void 0!==a.bufferView)d=this.getDependency("bufferView",a.bufferView).then(function(_){u=!0;const S=new Blob([_],{type:a.mimeType});return d=l.createObjectURL(S),d});else if(void 0===a.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const p=Promise.resolve(d).then(function(_){return new Promise(function(S,R){let H=S;!0===t.isImageBitmapLoader&&(H=function(re){const se=new zh(re);se.needsUpdate=!0,S(se)}),t.load(ex.resolveURL(_,s.path),H,void 0,R)})}).then(function(_){return!0===u&&l.revokeObjectURL(d),_.userData.mimeType=a.mimeType||function pAe(n){return n.search(/\.jpe?g($|\?)/i)>0||0===n.search(/^data\:image\/jpeg/)?"image/jpeg":n.search(/\.webp($|\?)/i)>0||0===n.search(/^data\:image\/webp/)?"image/webp":"image/png"}(a.uri),_}).catch(function(_){throw console.error("THREE.GLTFLoader: Couldn't load texture",d),_});return this.sourceCache[e]=p,p}assignTexture(e,t,i,r){const s=this;return this.getDependency("texture",i.index).then(function(a){if(!a)return null;if(void 0!==i.texCoord&&i.texCoord>0&&((a=a.clone()).channel=i.texCoord),s.extensions[al.KHR_TEXTURE_TRANSFORM]){const l=void 0!==i.extensions?i.extensions[al.KHR_TEXTURE_TRANSFORM]:void 0;if(l){const d=s.associations.get(a);a=s.extensions[al.KHR_TEXTURE_TRANSFORM].extendTexture(a,l),s.associations.set(a,d)}}return void 0!==r&&(a.colorSpace=r),e[t]=a,a})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const r=void 0===t.attributes.tangent,s=void 0!==t.attributes.color,a=void 0===t.attributes.normal;if(e.isPoints){const l="PointsMaterial:"+i.uuid;let d=this.cache.get(l);d||(d=new X_,ld.prototype.copy.call(d,i),d.color.copy(i.color),d.map=i.map,d.sizeAttenuation=!1,this.cache.add(l,d)),i=d}else if(e.isLine){const l="LineBasicMaterial:"+i.uuid;let d=this.cache.get(l);d||(d=new Dc,ld.prototype.copy.call(d,i),d.color.copy(i.color),d.map=i.map,this.cache.add(l,d)),i=d}if(r||s||a){let l="ClonedMaterial:"+i.uuid+":";r&&(l+="derivative-tangents:"),s&&(l+="vertex-colors:"),a&&(l+="flat-shading:");let d=this.cache.get(l);d||(d=i.clone(),s&&(d.vertexColors=!0),a&&(d.flatShading=!0),r&&(d.normalScale&&(d.normalScale.y*=-1),d.clearcoatNormalScale&&(d.clearcoatNormalScale.y*=-1)),this.cache.add(l,d),this.associations.set(d,this.associations.get(i))),i=d}e.material=i}getMaterialType(){return $I}loadMaterial(e){const t=this,r=this.extensions,s=this.json.materials[e];let a;const l={},u=[];if((s.extensions||{})[al.KHR_MATERIALS_UNLIT]){const _=r[al.KHR_MATERIALS_UNLIT];a=_.getMaterialType(),u.push(_.extendParams(l,s,t))}else{const _=s.pbrMetallicRoughness||{};if(l.color=new Cr(1,1,1),l.opacity=1,Array.isArray(_.baseColorFactor)){const S=_.baseColorFactor;l.color.setRGB(S[0],S[1],S[2],Wu),l.opacity=S[3]}void 0!==_.baseColorTexture&&u.push(t.assignTexture(l,"map",_.baseColorTexture,du)),l.metalness=void 0!==_.metallicFactor?_.metallicFactor:1,l.roughness=void 0!==_.roughnessFactor?_.roughnessFactor:1,void 0!==_.metallicRoughnessTexture&&(u.push(t.assignTexture(l,"metalnessMap",_.metallicRoughnessTexture)),u.push(t.assignTexture(l,"roughnessMap",_.metallicRoughnessTexture))),a=this._invokeOne(function(S){return S.getMaterialType&&S.getMaterialType(e)}),u.push(Promise.all(this._invokeAll(function(S){return S.extendMaterialParams&&S.extendMaterialParams(e,l)})))}!0===s.doubleSided&&(l.side=2);const p=s.alphaMode||"OPAQUE";if("BLEND"===p?(l.transparent=!0,l.depthWrite=!1):(l.transparent=!1,"MASK"===p&&(l.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&a!==xd&&(u.push(t.assignTexture(l,"normalMap",s.normalTexture)),l.normalScale=new Qi(1,1),void 0!==s.normalTexture.scale)){const _=s.normalTexture.scale;l.normalScale.set(_,_)}if(void 0!==s.occlusionTexture&&a!==xd&&(u.push(t.assignTexture(l,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(l.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&a!==xd){const _=s.emissiveFactor;l.emissive=(new Cr).setRGB(_[0],_[1],_[2],Wu)}return void 0!==s.emissiveTexture&&a!==xd&&u.push(t.assignTexture(l,"emissiveMap",s.emissiveTexture,du)),Promise.all(u).then(function(){const _=new a(l);return s.name&&(_.name=s.name),jy(_,s),t.associations.set(_,{materials:e}),s.extensions&&ox(r,_,s),_})}createUniqueName(e){const t=Ll.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,i=this.extensions,r=this.primitiveCache;function s(l){return i[al.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(l,t).then(function(d){return kq(d,l,t)})}const a=[];for(let l=0,d=e.length;l<d;l++){const u=e[l],p=fAe(u),_=r[p];if(_)a.push(_.promise);else{let S;S=u.extensions&&u.extensions[al.KHR_DRACO_MESH_COMPRESSION]?s(u):kq(new no,u,t),r[p]={primitive:u,promise:S},a.push(S)}}return Promise.all(a)}loadMesh(e){const t=this,r=this.extensions,s=this.json.meshes[e],a=s.primitives,l=[];for(let d=0,u=a.length;d<u;d++){const p=void 0===a[d].material?(void 0===(n=this.cache).DefaultMaterial&&(n.DefaultMaterial=new $I({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),n.DefaultMaterial):this.getDependency("material",a[d].material);l.push(p)}var n;return l.push(t.loadGeometries(a)),Promise.all(l).then(function(d){const u=d.slice(0,d.length-1),p=d[d.length-1],_=[];for(let R=0,H=p.length;R<H;R++){const re=p[R],se=a[R];let ce;const Te=u[R];if(se.mode===hA.TRIANGLES||se.mode===hA.TRIANGLE_STRIP||se.mode===hA.TRIANGLE_FAN||void 0===se.mode)ce=!0===s.isSkinnedMesh?new tG(re,Te):new ua(re,Te),!0===ce.isSkinnedMesh&&ce.normalizeSkinWeights(),se.mode===hA.TRIANGLE_STRIP?ce.geometry=Tq(ce.geometry,1):se.mode===hA.TRIANGLE_FAN&&(ce.geometry=Tq(ce.geometry,2));else if(se.mode===hA.LINES)ce=new hc(re,Te);else if(se.mode===hA.LINE_STRIP)ce=new fg(re,Te);else if(se.mode===hA.LINE_LOOP)ce=new fG(re,Te);else{if(se.mode!==hA.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+se.mode);ce=new Wb(re,Te)}Object.keys(ce.geometry.morphAttributes).length>0&&hAe(ce,s),ce.name=t.createUniqueName(s.name||"mesh_"+e),jy(ce,s),se.extensions&&ox(r,ce,se),t.assignFinalMaterial(ce),_.push(ce)}for(let R=0,H=_.length;R<H;R++)t.associations.set(_[R],{meshes:e,primitives:R});if(1===_.length)return s.extensions&&ox(r,_[0],s),_[0];const S=new Wl;s.extensions&&ox(r,S,s),t.associations.set(S,{meshes:e});for(let R=0,H=_.length;R<H;R++)S.add(_[R]);return S})}loadCamera(e){let t;const i=this.json.cameras[e],r=i[i.type];if(r)return"perspective"===i.type?t=new Bu(GS.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===i.type&&(t=new Q2(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),jy(t,i),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],i=[];for(let r=0,s=t.joints.length;r<s;r++)i.push(this._loadNodeShallow(t.joints[r]));return i.push(void 0!==t.inverseBindMatrices?this.getDependency("accessor",t.inverseBindMatrices):null),Promise.all(i).then(function(r){const s=r.pop(),a=r,l=[],d=[];for(let u=0,p=a.length;u<p;u++){const _=a[u];if(_){l.push(_);const S=new wo;null!==s&&S.fromArray(s.array,16*u),d.push(S)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[u])}return new DI(l,d)})}loadAnimation(e){const i=this,r=this.json.animations[e],s=r.name?r.name:"animation_"+e,a=[],l=[],d=[],u=[],p=[];for(let _=0,S=r.channels.length;_<S;_++){const R=r.channels[_],H=r.samplers[R.sampler],re=R.target,ce=void 0!==r.parameters?r.parameters[H.input]:H.input,Te=void 0!==r.parameters?r.parameters[H.output]:H.output;void 0!==re.node&&(a.push(this.getDependency("node",re.node)),l.push(this.getDependency("accessor",ce)),d.push(this.getDependency("accessor",Te)),u.push(H),p.push(re))}return Promise.all([Promise.all(a),Promise.all(l),Promise.all(d),Promise.all(u),Promise.all(p)]).then(function(_){const S=_[0],R=_[1],H=_[2],re=_[3],se=_[4],ce=[];for(let Te=0,Ce=S.length;Te<Ce;Te++){const qe=S[Te],wt=R[Te],gt=H[Te],Et=re[Te],Xt=se[Te];if(void 0===qe)continue;qe.updateMatrix&&qe.updateMatrix();const Un=i._createAnimationTracks(qe,wt,gt,Et,Xt);if(Un)for(let Ct=0;Ct<Un.length;Ct++)ce.push(Un[Ct])}return new cE(s,void 0,ce)})}createNodeMesh(e){const i=this,r=this.json.nodes[e];return void 0===r.mesh?null:i.getDependency("mesh",r.mesh).then(function(s){const a=i._getNodeRef(i.meshCache,r.mesh,s);return void 0!==r.weights&&a.traverse(function(l){if(l.isMesh)for(let d=0,u=r.weights.length;d<u;d++)l.morphTargetInfluences[d]=r.weights[d]}),a})}loadNode(e){const i=this,r=this.json.nodes[e],s=i._loadNodeShallow(e),a=[],l=r.children||[];for(let u=0,p=l.length;u<p;u++)a.push(i.getDependency("node",l[u]));const d=void 0===r.skin?Promise.resolve(null):i.getDependency("skin",r.skin);return Promise.all([s,Promise.all(a),d]).then(function(u){const p=u[0],_=u[1],S=u[2];null!==S&&p.traverse(function(R){R.isSkinnedMesh&&R.bind(S,mAe)});for(let R=0,H=_.length;R<H;R++)p.add(_[R]);return p})}_loadNodeShallow(e){const i=this.extensions,r=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const s=this.json.nodes[e],a=s.name?r.createUniqueName(s.name):"",l=[],d=r._invokeOne(function(u){return u.createNodeMesh&&u.createNodeMesh(e)});return d&&l.push(d),void 0!==s.camera&&l.push(r.getDependency("camera",s.camera).then(function(u){return r._getNodeRef(r.cameraCache,s.camera,u)})),r._invokeAll(function(u){return u.createNodeAttachment&&u.createNodeAttachment(e)}).forEach(function(u){l.push(u)}),this.nodeCache[e]=Promise.all(l).then(function(u){let p;if(p=!0===s.isBone?new U5:u.length>1?new Wl:1===u.length?u[0]:new Pl,p!==u[0])for(let _=0,S=u.length;_<S;_++)p.add(u[_]);if(s.name&&(p.userData.name=s.name,p.name=a),jy(p,s),s.extensions&&ox(i,p,s),void 0!==s.matrix){const _=new wo;_.fromArray(s.matrix),p.applyMatrix4(_)}else void 0!==s.translation&&p.position.fromArray(s.translation),void 0!==s.rotation&&p.quaternion.fromArray(s.rotation),void 0!==s.scale&&p.scale.fromArray(s.scale);return r.associations.has(p)||r.associations.set(p,{}),r.associations.get(p).nodes=e,p}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],r=this,s=new Wl;i.name&&(s.name=r.createUniqueName(i.name)),jy(s,i),i.extensions&&ox(t,s,i);const a=i.nodes||[],l=[];for(let d=0,u=a.length;d<u;d++)l.push(r.getDependency("node",a[d]));return Promise.all(l).then(function(d){for(let p=0,_=d.length;p<_;p++)s.add(d[p]);return r.associations=(p=>{const _=new Map;for(const[S,R]of r.associations)(S instanceof ld||S instanceof zh)&&_.set(S,R);return p.traverse(S=>{const R=r.associations.get(S);null!=R&&_.set(S,R)}),_})(s),s})}_createAnimationTracks(e,t,i,r,s){const a=[],l=e.name?e.name:e.uuid,d=[];let u;switch(Wy[s.path]===Wy.weights?e.traverse(function(S){S.morphTargetInfluences&&d.push(S.name?S.name:S.uuid)}):d.push(l),Wy[s.path]){case Wy.weights:u=lC;break;case Wy.rotation:u=Zb;break;case Wy.position:case Wy.scale:u=dC;break;default:u=1===i.itemSize?lC:dC}const p=void 0!==r.interpolation?cAe[r.interpolation]:Bb,_=this._getArrayFromAccessor(i);for(let S=0,R=d.length;S<R;S++){const H=new u(d[S]+"."+Wy[s.path],t.array,_,p);"CUBICSPLINE"===r.interpolation&&this._createCubicSplineTrackInterpolant(H),a.push(H)}return a}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const i=kF(t.constructor),r=new Float32Array(t.length);for(let s=0,a=t.length;s<a;s++)r[s]=t[s]*i;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){return new(this instanceof Zb?lAe:Bq)(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function kq(n,e,t){const i=e.attributes,r=[];function s(a,l){return t.getDependency("accessor",a).then(function(d){n.setAttribute(l,d)})}for(const a in i){const l=BF[a]||a.toLowerCase();l in n.attributes||r.push(s(i[a],l))}if(void 0!==e.indices&&!n.index){const a=t.getDependency("accessor",e.indices).then(function(l){n.setIndex(l)});r.push(a)}return Ol.workingColorSpace!==Wu&&"COLOR_0"in i&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${Ol.workingColorSpace}" not supported.`),jy(n,e),function gAe(n,e,t){const i=e.attributes,r=new Pf;if(void 0===i.POSITION)return;{const l=t.json.accessors[i.POSITION],d=l.min,u=l.max;if(void 0===d||void 0===u)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new It(d[0],d[1],d[2]),new It(u[0],u[1],u[2])),l.normalized){const p=kF(pC[l.componentType]);r.min.multiplyScalar(p),r.max.multiplyScalar(p)}}const s=e.targets;if(void 0!==s){const l=new It,d=new It;for(let u=0,p=s.length;u<p;u++){const _=s[u];if(void 0!==_.POSITION){const S=t.json.accessors[_.POSITION],R=S.min,H=S.max;if(void 0!==R&&void 0!==H){if(d.setX(Math.max(Math.abs(R[0]),Math.abs(H[0]))),d.setY(Math.max(Math.abs(R[1]),Math.abs(H[1]))),d.setZ(Math.max(Math.abs(R[2]),Math.abs(H[2]))),S.normalized){const re=kF(pC[S.componentType]);d.multiplyScalar(re)}l.max(d)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(l)}n.boundingBox=r;const a=new $u;r.getCenter(a.center),a.radius=r.min.distanceTo(r.max)/2,n.boundingSphere=a}(n,e,t),Promise.all(r).then(function(){return void 0!==e.targets?function uAe(n,e,t){let i=!1,r=!1,s=!1;for(let u=0,p=e.length;u<p;u++){const _=e[u];if(void 0!==_.POSITION&&(i=!0),void 0!==_.NORMAL&&(r=!0),void 0!==_.COLOR_0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(n);const a=[],l=[],d=[];for(let u=0,p=e.length;u<p;u++){const _=e[u];if(i){const S=void 0!==_.POSITION?t.getDependency("accessor",_.POSITION):n.attributes.position;a.push(S)}if(r){const S=void 0!==_.NORMAL?t.getDependency("accessor",_.NORMAL):n.attributes.normal;l.push(S)}if(s){const S=void 0!==_.COLOR_0?t.getDependency("accessor",_.COLOR_0):n.attributes.color;d.push(S)}}return Promise.all([Promise.all(a),Promise.all(l),Promise.all(d)]).then(function(u){const _=u[1],S=u[2];return i&&(n.morphAttributes.position=u[0]),r&&(n.morphAttributes.normal=_),s&&(n.morphAttributes.color=S),n.morphTargetsRelative=!0,n})}(n,e.targets,t):n})}const FF=new WeakMap;class OF extends Gh{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,i,r){const s=new vp(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,a=>{this.parse(a,t,r)},i,r)}parse(e,t,i=(()=>{})){this.decodeDracoFile(e,t,null,null,du).catch(i)}decodeDracoFile(e,t,i,r,s=Wu,a=(()=>{})){return this.decodeGeometry(e,{attributeIDs:i||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!i,vertexColorSpace:s}).then(t).catch(a)}decodeGeometry(e,t){const i=JSON.stringify(t);if(FF.has(e)){const d=FF.get(e);if(d.key===i)return d.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++,l=this._getWorker(s,e.byteLength).then(d=>(r=d,new Promise((u,p)=>{r._callbacks[s]={resolve:u,reject:p},r.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(d=>this._createGeometry(d.geometry));return l.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),FF.set(e,{key:i,promise:l}),l}_createGeometry(e){const t=new no;e.index&&t.setIndex(new No(e.index.array,1));for(let i=0;i<e.attributes.length;i++){const r=e.attributes[i],s=r.name,a=r.array,d=new No(a,r.itemSize);"color"===s&&(this._assignVertexColorSpace(d,r.vertexColorSpace),d.normalized=!(a instanceof Float32Array)),t.setAttribute(s,d)}return t}_assignVertexColorSpace(e,t){if(t!==du)return;const i=new Cr;for(let r=0,s=e.count;r<s;r++)i.fromBufferAttribute(e,r).convertSRGBToLinear(),e.setXYZ(r,i.r,i.g,i.b)}_loadLibrary(e,t){const i=new vp(this.manager);return i.setPath(this.decoderPath),i.setResponseType(t),i.setWithCredentials(this.withCredentials),new Promise((r,s)=>{i.load(e,r,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(i=>{const r=i[0];e||(this.decoderConfig.wasmBinary=i[1]);const s=_Ae.toString(),a=["/* draco decoder */",r,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([a]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(s){const a=s.data;switch(a.type){case"decode":r._callbacks[a.id].resolve(a);break;case"error":r._callbacks[a.id].reject(a);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+a.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,s){return r._taskLoad>s._taskLoad?-1:1});const i=this.workerPool[this.workerPool.length-1];return i._taskCosts[e]=t,i._taskLoad+=t,i})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,""!==this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),this}}function _Ae(){let n,e;function r(a,l,d,u,p,_){const S=_.num_components(),H=d.num_points()*S,re=H*p.BYTES_PER_ELEMENT,se=function s(a,l){switch(l){case Float32Array:return a.DT_FLOAT32;case Int8Array:return a.DT_INT8;case Int16Array:return a.DT_INT16;case Int32Array:return a.DT_INT32;case Uint8Array:return a.DT_UINT8;case Uint16Array:return a.DT_UINT16;case Uint32Array:return a.DT_UINT32}}(a,p),ce=a._malloc(re);l.GetAttributeDataArrayForAllPoints(d,_,se,re,ce);const Te=new p(a.HEAPF32.buffer,ce,H).slice();return a._free(ce),{name:u,array:Te,itemSize:S}}onmessage=function(a){const l=a.data;switch(l.type){case"init":n=l.decoderConfig,e=new Promise(function(p){n.onModuleLoaded=function(_){p({draco:_})},DracoDecoderModule(n)});break;case"decode":const d=l.buffer,u=l.taskConfig;e.then(p=>{const _=p.draco,S=new _.Decoder;try{const R=function t(a,l,d,u){const p=u.attributeIDs,_=u.attributeTypes;let S,R;const H=l.GetEncodedGeometryType(d);if(H===a.TRIANGULAR_MESH)S=new a.Mesh,R=l.DecodeArrayToMesh(d,d.byteLength,S);else{if(H!==a.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");S=new a.PointCloud,R=l.DecodeArrayToPointCloud(d,d.byteLength,S)}if(!R.ok()||0===S.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+R.error_msg());const re={index:null,attributes:[]};for(const se in p){const ce=self[_[se]];let Te,Ce;if(u.useUniqueIDs)Ce=p[se],Te=l.GetAttributeByUniqueId(S,Ce);else{if(Ce=l.GetAttributeId(S,a[p[se]]),-1===Ce)continue;Te=l.GetAttribute(S,Ce)}const qe=r(a,l,S,se,ce,Te);"color"===se&&(qe.vertexColorSpace=u.vertexColorSpace),re.attributes.push(qe)}return H===a.TRIANGULAR_MESH&&(re.index=function i(a,l,d){const p=3*d.num_faces(),_=4*p,S=a._malloc(_);l.GetTrianglesUInt32Array(d,_,S);const R=new Uint32Array(a.HEAPF32.buffer,S,p).slice();return a._free(S),{array:R,itemSize:1}}(a,l,S)),a.destroy(S),re}(_,S,new Int8Array(d),u),H=R.attributes.map(re=>re.array.buffer);R.index&&H.push(R.index.array.buffer),self.postMessage({type:"decode",id:l.id,geometry:R},H)}catch(R){console.error(R),self.postMessage({type:"error",id:l.id,error:R.message})}finally{_.destroy(S)}})}}}var yAe=Se(1747),d4=Se.n(yAe);class vAe{clipPlanes;EVENT_DATA_ID;GEOMETRIES_ID;constructor(e,t,i){this.clipPlanes=e,this.EVENT_DATA_ID=t,this.GEOMETRIES_ID=i}loadOBJGeometry(e,t,i,r,s){i=i??4302580;const a=new Sq;return new Promise((l,d)=>{a.load(e,u=>{const p=this.processOBJ(u,t,i,r,s);l({object:p})},null,u=>{d(u)})})}parseOBJGeometry(e,t){const r=(new Sq).parse(e);return this.processOBJ(r,t,4302580,!1,!1)}processOBJ(e,t,i,r,s){return e.name=t,e.userData={name:t},this.setObjFlat(e,i,r,s)}setObjFlat(e,t,i,r){const s=new pg({color:t,shininess:0,wireframe:!1,clippingPlanes:this.clipPlanes,clipIntersection:!0,clipShadows:!1,side:i?2:0,flatShading:r});return e.traverse(a=>{a instanceof ua?(a.name=e.name,a.userData=e.userData,a.userData.size=this.getObjectSize(a),a.material instanceof ld&&(a.material.dispose(),a.material=s),a.castShadow=!1,a.receiveShadow=!1):a instanceof hc&&a.material instanceof Dc&&a.material.color.set(t)}),e}parsePhnxScene(e,t){const i=new c4,r=new OF;r.setDecoderPath(`https://cdn.jsdelivr.net/npm/three@0.${m2}.0/examples/jsm/libs/draco/`),i.setDRACOLoader(r);const s=JSON.stringify(e,null,2);return new Promise((a,l)=>{i.parse(s,"",d=>{const u=d.scene.getObjectByName(this.EVENT_DATA_ID),p=d.scene.getObjectByName(this.GEOMETRIES_ID);t(u,p),a()},d=>{l(d)})})}zipHandlingWrapper(e,t){"string"!=typeof e&&(e=e.name);const i=e.substr(0,e.lastIndexOf("/"));return new Promise((r,s)=>{fetch(e).then(a=>a.arrayBuffer().then(l=>{if("zip"==e.split(".").pop())try{d4().loadAsync(l).then(d=>{const u=[];for(const _ in d.files)u.push(d.file(_).async("arraybuffer").then(S=>t(S,i,_.split(".")[0])));let p=[];Promise.all(u).then(_=>{_.forEach(S=>{p=p.concat(S)}),r(p)})})}catch(d){console.warn("Could not read zip file","Error"),s(d)}else t(l,i,e.split(".")[0]).then(d=>{r(d)},d=>{s(d)})}))})}loadGLTFGeometry(e,t,i,r,s){return this.zipHandlingWrapper(e,(a,l,d)=>this.loadGLTFGeometryInternal(a,l,t,i,r,s))}loadGLTFGeometryInternal(e,t,i,r,s,a){const l=new c4,d=new OF;return d.setDecoderPath(`https://cdn.jsdelivr.net/npm/three@0.${m2}.0/examples/jsm/libs/draco/`),l.setDRACOLoader(d),new Promise((u,p)=>{l.parse(e,t,_=>{const S=[];for(const R of _.scenes){R.visible=R.userData.visible??a;const H=this.processGLTFSceneName(R.name,r),re={},se=(ce,Te,Ce)=>{const qe=Te.clone().multiply(ce.matrix);if(ce instanceof ua){const wt=ce.material.id;re[wt]||(re[wt]={material:ce.material,geoms:[],renderOrder:-Ce}),re[wt].geoms.push(ce.geometry.clone().applyMatrix4(qe))}for(const wt of ce.children)se(wt,qe,Ce+1)};se(R,new wo,0),R.remove(...R.children);for(const ce of Object.values(re)){const Te=new ua(TF(ce.geoms),ce.material);Te.renderOrder=ce.renderOrder,R.add(Te)}this.processGeometry(R,i??H.name,s,!0),S.push({object:R,menuNodeName:r??H.menuNodeName})}u(S)},_=>{p(_)})})}parseGLTFGeometry(e){return this.zipHandlingWrapper(e,this.parseGLTFGeometryFromArrayBuffer)}parseGLTFGeometryFromArrayBuffer(e,t,i){const r=new c4,s=new OF;return s.setDecoderPath(`https://cdn.jsdelivr.net/npm/three@0.${m2}.0/examples/jsm/libs/draco/`),r.setDRACOLoader(s),new Promise((a,l)=>{r.parse(e,t,d=>{const u=[];for(const p of d.scenes){p.visible=p.userData.visible;const _=this.processGLTFSceneName(p.name);this.processGeometry(p,_.name??i),u.push({object:p,menuNodeName:_.menuNodeName})}a(u)},d=>{l(d)})})}processGLTFSceneName(e,t){if(e){const i=e.split("_>_");t&&i.unshift(t);const r=i.join(" > ");return i.pop(),{name:r,menuNodeName:i.join(" > ")}}}loadJSONGeometry(e,t,i,r){const s=new Ope;switch(typeof e){case"string":return new Promise((a,l)=>{s.load(e,d=>{this.processGeometry(d,t,i,r),a({object:d})},null,d=>{l(d)})});case"object":return new Promise(a=>{const l=s.parse(e);this.processGeometry(l,t,i,r),a({object:l})})}}processGeometry(e,t,i,r){e.name=t,i&&e.scale.setScalar(i),e.traverse(s=>{if(s instanceof ua&&(s.name=s.userData.name=t,s.userData.size=this.getObjectSize(s),s.material instanceof ld)){const a=s.material.color?s.material.color:3135121,l=r?2:s.material.side;s.material.dispose();let d=!1;e.userData.opacity&&(d=!0),s.material=new pg({color:a,shininess:0,side:l,transparent:d,opacity:e.userData.opacity??1}),s.material.clippingPlanes=this.clipPlanes,s.material.clipIntersection=!0,s.material.clipShadows=!1}})}getObjectSize(e){const t=new It;return e.geometry.computeBoundingBox(),e.geometry?.boundingBox?.getSize(t),JSON.stringify(t,null,2)}}let $y=(()=>{class n{static symbols={\u03b8:["theta"],\u03d5:["phi"],pT:["pt"],\u{1d6d8}2:["chi2"],\u03b7:["eta"],q:["charge"],NDOF:["ndof"],DOF:["dof"],Energy:["energy"],ET:["et"],"|p|":["momentum","mom"]};static getPrettySymbol(t){return Object.keys(n.symbols).find(r=>n.symbols[r].includes(t))||t}static getPrettyParams(t){const i=Object.assign({},t);for(const r of Object.keys(i)){const s=n.getPrettySymbol(r);s!==r&&(i[s]=i[r],delete i[r])}if(delete i.pos,i?.dparams){const r={};return r.\u03b8=i.dparams[3],r.\u03d5=i.dparams[2],r["|p|"]=Math.abs(1/i.dparams[4]),r.q=Math.sign(1/i.dparams[4]),r.d0=i.dparams[0],r.z0=i.dparams[1],delete i.dparams,{...i,...r}}return i}}return n})();class mC{value;constructor(e){this.value=e}callbacks=[];update(e){this.value=e,this.callbacks.forEach(t=>t(e))}onUpdate(e){this.callbacks.push(e)}}class bAe{isInit;camera;scene;selectedObject;activeObject=new mC("");ignoreList;outlinePass;effectsManager;infoLogger;preSelectionAntialias;constructor(){this.isInit=!1,this.ignoreList=[(new YI).type,(new uC).type,(new dq).type]}init(e,t,i,r){this.camera=e,this.scene=t,this.isInit=!0,this.infoLogger=r,this.effectsManager=i,this.outlinePass=this.effectsManager.addOutlinePassForSelection()}setSelectedObject(e){this.selectedObject=e}getActiveObjectId(){return this.activeObject}setSelecting(e){this.isInit&&(e?this.enableSelecting():this.disableSelecting())}enableSelecting(){document.getElementById("three-canvas").addEventListener("mousemove",this.onTouchMove,!0),document.getElementById("three-canvas").addEventListener("click",this.onDocumentMouseDown,!0),document.getElementById("three-canvas").addEventListener("touchstart",this.onTouchDown),this.preSelectionAntialias=this.effectsManager.antialiasing,this.effectsManager.setAntialiasing(!1)}disableSelecting(){document.getElementById("three-canvas").removeEventListener("mousemove",this.onTouchMove,!0),document.getElementById("three-canvas").removeEventListener("click",this.onDocumentMouseDown,!0),document.getElementById("three-canvas").removeEventListener("touchstart",this.onTouchDown),this.outlinePass.selectedObjects=[],this.effectsManager.setAntialiasing(this.preSelectionAntialias)}onTouchMove=e=>{const t=this.intersectObject(e);if(t){if(this.ignoreList.includes(t.type))return;this.outlinePass.selectedObjects=[t]}};onDocumentMouseDown=()=>{const e=this.outlinePass.selectedObjects[0];if(e){this.selectedObject.name=e.name,this.selectedObject.attributes.splice(0,this.selectedObject.attributes.length),this.activeObject.update(e.uuid);const t=$y.getPrettyParams(e.userData);for(const s of Object.keys(t))this.selectedObject.attributes.push({attributeName:s,attributeValue:t[s]});const i=Object.keys(e.userData).map(s=>{if(["string","number"].includes(typeof e.userData[s]))return s+"="+e.userData[s]}).filter(s=>s),r=e.name+(i.length>0?" with "+i.join(", "):"");r&&this.infoLogger.add(r,"Clicked")}};onTouchDown=e=>{e.preventDefault(),this.onTouchMove(e.targetTouches[0]),this.onDocumentMouseDown()};intersectObject(e){e.preventDefault?.();const t=new Qi,i=this.effectsManager.composer.renderer.domElement;t.x=e.clientX/i.clientWidth*2-1,t.y=-e.clientY/i.clientHeight*2+1;const r=new ZG;r.setFromCamera(t,this.camera),r.params.Line.threshold=3;const s=r.intersectObjects(this.scene.children,!0);if(s.length>0)return s[0].object}enableHighlighting(){this.preSelectionAntialias=this.effectsManager.antialiasing,this.effectsManager.setAntialiasing(!1)}highlightObject(e,t){const i=t.getObjectByProperty("uuid",e);i&&(this.outlinePass.selectedObjects=[i],this.activeObject.update(i.uuid))}disableHighlighting(){this.outlinePass.selectedObjects=[],this.effectsManager.setAntialiasing(this.preSelectionAntialias)}}class xAe extends WI{constructor(e,t={}){const i=t.font;if(void 0===i)super();else{const r=i.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),super(r,t)}this.type="TextGeometry"}}class Fq{constructor(e){this.isFont=!0,this.type="Font",this.data=e}generateShapes(e,t=100){const i=[],r=function wAe(n,e,t){const i=Array.from(n),r=e/t.resolution,s=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*r,a=[];let l=0,d=0;for(let u=0;u<i.length;u++){const p=i[u];if("\n"===p)l=0,d-=s;else{const _=CAe(p,r,l,d,t);l+=_.offsetX,a.push(_.path)}}return a}(e,t,this.data);for(let s=0,a=r.length;s<a;s++)i.push(...r[s].toShapes());return i}}function CAe(n,e,t,i,r){const s=r.glyphs[n]||r.glyphs["?"];if(!s)return void console.error('THREE.Font: character "'+n+'" does not exists in font family '+r.familyName+".");const a=new ime;let l,d,u,p,_,S,R,H;if(s.o){const re=s._cachedOutline||(s._cachedOutline=s.o.split(" "));for(let se=0,ce=re.length;se<ce;)switch(re[se++]){case"m":l=re[se++]*e+t,d=re[se++]*e+i,a.moveTo(l,d);break;case"l":l=re[se++]*e+t,d=re[se++]*e+i,a.lineTo(l,d);break;case"q":u=re[se++]*e+t,p=re[se++]*e+i,_=re[se++]*e+t,S=re[se++]*e+i,a.quadraticCurveTo(_,S,u,p);break;case"b":u=re[se++]*e+t,p=re[se++]*e+i,_=re[se++]*e+t,S=re[se++]*e+i,R=re[se++]*e+t,H=re[se++]*e+i,a.bezierCurveTo(_,S,R,H,u,p)}}return{offsetX:s.ha*e,path:a}}class Ff{static anglesAreSane(e,t){const i=-Math.PI<t&&Math.PI>t,r=0<e&&Math.PI>e;return i&&r}static etaToTheta(e){return 2*Math.atan(Math.pow(Math.E,-e))}static thetaToEta(e){return-Math.log(Math.tan(e/2))}static sphericalToCartesian(e,t,i){const r=new It;return r.setFromSphericalCoords(e,t,i),r.applyQuaternion(Ff.atlasQuaternion()),r}static etaPhiToCartesian(e,t,i){const r=new It;return r.setFromSphericalCoords(e,this.etaToTheta(t),i),r.applyQuaternion(Ff.atlasQuaternion()),r}static atlasQuaternion(){const e=new It(0,1,0),t=new It(0,0,1),i=new Gc;i.setFromUnitVectors(e,t);const r=new Gc;return r.setFromAxisAngle(new It(0,1,0),Math.PI/2),i.multiply(r),i}}const MAe=JSON.parse('{"glyphs":{"0":{"x_min":73,"x_max":715,"ha":792,"o":"m 394 -29 q 153 129 242 -29 q 73 479 73 272 q 152 829 73 687 q 394 989 241 989 q 634 829 545 989 q 715 479 715 684 q 635 129 715 270 q 394 -29 546 -29 m 394 89 q 546 211 489 89 q 598 479 598 322 q 548 748 598 640 q 394 871 491 871 q 241 748 298 871 q 190 479 190 637 q 239 211 190 319 q 394 89 296 89 "},"1":{"x_min":215.671875,"x_max":574,"ha":792,"o":"m 574 0 l 442 0 l 442 697 l 215 697 l 215 796 q 386 833 330 796 q 475 986 447 875 l 574 986 l 574 0 "},"2":{"x_min":59,"x_max":731,"ha":792,"o":"m 731 0 l 59 0 q 197 314 59 188 q 457 487 199 315 q 598 691 598 580 q 543 819 598 772 q 411 867 488 867 q 272 811 328 867 q 209 630 209 747 l 81 630 q 182 901 81 805 q 408 986 271 986 q 629 909 536 986 q 731 694 731 826 q 613 449 731 541 q 378 316 495 383 q 201 122 235 234 l 731 122 l 731 0 "},"3":{"x_min":54,"x_max":737,"ha":792,"o":"m 737 284 q 635 55 737 141 q 399 -25 541 -25 q 156 52 248 -25 q 54 308 54 140 l 185 308 q 245 147 185 202 q 395 96 302 96 q 539 140 484 96 q 602 280 602 190 q 510 429 602 390 q 324 454 451 454 l 324 565 q 487 584 441 565 q 565 719 565 617 q 515 835 565 791 q 395 879 466 879 q 255 824 307 879 q 203 661 203 769 l 78 661 q 166 909 78 822 q 387 992 250 992 q 603 921 513 992 q 701 723 701 844 q 669 607 701 656 q 578 524 637 558 q 696 434 655 499 q 737 284 737 369 "},"4":{"x_min":48,"x_max":742.453125,"ha":792,"o":"m 742 243 l 602 243 l 602 0 l 476 0 l 476 243 l 48 243 l 48 368 l 476 958 l 602 958 l 602 354 l 742 354 l 742 243 m 476 354 l 476 792 l 162 354 l 476 354 "},"5":{"x_min":54.171875,"x_max":738,"ha":792,"o":"m 738 314 q 626 60 738 153 q 382 -23 526 -23 q 155 47 248 -23 q 54 256 54 125 l 183 256 q 259 132 204 174 q 382 91 314 91 q 533 149 471 91 q 602 314 602 213 q 538 469 602 411 q 386 528 475 528 q 284 506 332 528 q 197 439 237 484 l 81 439 l 159 958 l 684 958 l 684 840 l 254 840 l 214 579 q 306 627 258 612 q 407 643 354 643 q 636 552 540 643 q 738 314 738 457 "},"6":{"x_min":53,"x_max":739,"ha":792,"o":"m 739 312 q 633 62 739 162 q 400 -31 534 -31 q 162 78 257 -31 q 53 439 53 206 q 178 859 53 712 q 441 986 284 986 q 643 912 559 986 q 732 713 732 833 l 601 713 q 544 830 594 786 q 426 875 494 875 q 268 793 331 875 q 193 517 193 697 q 301 597 240 570 q 427 624 362 624 q 643 540 552 624 q 739 312 739 451 m 603 298 q 540 461 603 400 q 404 516 484 516 q 268 461 323 516 q 207 300 207 401 q 269 137 207 198 q 405 83 325 83 q 541 137 486 83 q 603 298 603 197 "},"7":{"x_min":58.71875,"x_max":730.953125,"ha":792,"o":"m 730 839 q 469 448 560 641 q 335 0 378 255 l 192 0 q 328 441 235 252 q 593 830 421 630 l 58 830 l 58 958 l 730 958 l 730 839 "},"8":{"x_min":55,"x_max":736,"ha":792,"o":"m 571 527 q 694 424 652 491 q 736 280 736 358 q 648 71 736 158 q 395 -26 551 -26 q 142 69 238 -26 q 55 279 55 157 q 96 425 55 359 q 220 527 138 491 q 120 615 153 562 q 88 726 88 668 q 171 904 88 827 q 395 986 261 986 q 618 905 529 986 q 702 727 702 830 q 670 616 702 667 q 571 527 638 565 m 394 565 q 519 610 475 565 q 563 717 563 655 q 521 823 563 781 q 392 872 474 872 q 265 824 312 872 q 224 720 224 783 q 265 613 224 656 q 394 565 312 565 m 395 91 q 545 150 488 91 q 597 280 597 204 q 546 408 597 355 q 395 465 492 465 q 244 408 299 465 q 194 280 194 356 q 244 150 194 203 q 395 91 299 91 "},"9":{"x_min":53,"x_max":739,"ha":792,"o":"m 739 524 q 619 94 739 241 q 362 -32 516 -32 q 150 47 242 -32 q 59 244 59 126 l 191 244 q 246 129 191 176 q 373 82 301 82 q 526 161 466 82 q 597 440 597 255 q 363 334 501 334 q 130 432 216 334 q 53 650 53 521 q 134 880 53 786 q 383 986 226 986 q 659 841 566 986 q 739 524 739 719 m 388 449 q 535 514 480 449 q 585 658 585 573 q 535 805 585 744 q 388 873 480 873 q 242 809 294 873 q 191 658 191 745 q 239 514 191 572 q 388 449 292 449 "},"\u03bf":{"x_min":0,"x_max":712,"ha":815,"o":"m 356 -25 q 96 88 192 -25 q 0 368 0 201 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 "},"S":{"x_min":0,"x_max":788,"ha":890,"o":"m 788 291 q 662 54 788 144 q 397 -26 550 -26 q 116 68 226 -26 q 0 337 0 168 l 131 337 q 200 152 131 220 q 384 85 269 85 q 557 129 479 85 q 650 270 650 183 q 490 429 650 379 q 194 513 341 470 q 33 739 33 584 q 142 964 33 881 q 388 1041 242 1041 q 644 957 543 1041 q 756 716 756 867 l 625 716 q 561 874 625 816 q 395 933 497 933 q 243 891 309 933 q 164 759 164 841 q 325 609 164 656 q 625 526 475 568 q 788 291 788 454 "},"\xa6":{"x_min":343,"x_max":449,"ha":792,"o":"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},"/":{"x_min":183.25,"x_max":608.328125,"ha":792,"o":"m 608 1041 l 266 -129 l 183 -129 l 520 1041 l 608 1041 "},"\u03a4":{"x_min":-0.4375,"x_max":777.453125,"ha":839,"o":"m 777 893 l 458 893 l 458 0 l 319 0 l 319 892 l 0 892 l 0 1013 l 777 1013 l 777 893 "},"y":{"x_min":0,"x_max":684.78125,"ha":771,"o":"m 684 738 l 388 -83 q 311 -216 356 -167 q 173 -279 252 -279 q 97 -266 133 -279 l 97 -149 q 132 -155 109 -151 q 168 -160 155 -160 q 240 -114 213 -160 q 274 -26 248 -98 l 0 738 l 137 737 l 341 139 l 548 737 l 684 738 "},"\u03a0":{"x_min":0,"x_max":803,"ha":917,"o":"m 803 0 l 667 0 l 667 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 803 1012 l 803 0 "},"\u0390":{"x_min":-111,"x_max":339,"ha":361,"o":"m 339 800 l 229 800 l 229 925 l 339 925 l 339 800 m -1 800 l -111 800 l -111 925 l -1 925 l -1 800 m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 m 302 1040 l 113 819 l 30 819 l 165 1040 l 302 1040 "},"g":{"x_min":0,"x_max":686,"ha":838,"o":"m 686 34 q 586 -213 686 -121 q 331 -306 487 -306 q 131 -252 216 -306 q 31 -84 31 -190 l 155 -84 q 228 -174 166 -138 q 345 -207 284 -207 q 514 -109 454 -207 q 564 89 564 -27 q 461 6 521 36 q 335 -23 401 -23 q 88 100 184 -23 q 0 370 0 215 q 87 634 0 522 q 330 758 183 758 q 457 728 398 758 q 564 644 515 699 l 564 737 l 686 737 l 686 34 m 582 367 q 529 560 582 481 q 358 652 468 652 q 189 561 250 652 q 135 369 135 482 q 189 176 135 255 q 361 85 251 85 q 529 176 468 85 q 582 367 582 255 "},"\xb2":{"x_min":0,"x_max":442,"ha":539,"o":"m 442 383 l 0 383 q 91 566 0 492 q 260 668 176 617 q 354 798 354 727 q 315 875 354 845 q 227 905 277 905 q 136 869 173 905 q 99 761 99 833 l 14 761 q 82 922 14 864 q 232 974 141 974 q 379 926 316 974 q 442 797 442 878 q 351 635 442 704 q 183 539 321 611 q 92 455 92 491 l 442 455 l 442 383 "},"\u2013":{"x_min":0,"x_max":705.5625,"ha":803,"o":"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},"\u039a":{"x_min":0,"x_max":819.5625,"ha":893,"o":"m 819 0 l 650 0 l 294 509 l 139 356 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},"\u0192":{"x_min":-46.265625,"x_max":392,"ha":513,"o":"m 392 651 l 259 651 l 79 -279 l -46 -278 l 134 651 l 14 651 l 14 751 l 135 751 q 151 948 135 900 q 304 1041 185 1041 q 334 1040 319 1041 q 392 1034 348 1039 l 392 922 q 337 931 360 931 q 271 883 287 931 q 260 793 260 853 l 260 751 l 392 751 l 392 651 "},"e":{"x_min":0,"x_max":714,"ha":813,"o":"m 714 326 l 140 326 q 200 157 140 227 q 359 87 260 87 q 488 130 431 87 q 561 245 545 174 l 697 245 q 577 48 670 123 q 358 -26 484 -26 q 97 85 195 -26 q 0 363 0 197 q 94 642 0 529 q 358 765 195 765 q 626 627 529 765 q 714 326 714 503 m 576 429 q 507 583 564 522 q 355 650 445 650 q 206 583 266 650 q 140 429 152 522 l 576 429 "},"\u03cc":{"x_min":0,"x_max":712,"ha":815,"o":"m 356 -25 q 94 91 194 -25 q 0 368 0 202 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 m 576 1040 l 387 819 l 303 819 l 438 1040 l 576 1040 "},"J":{"x_min":0,"x_max":588,"ha":699,"o":"m 588 279 q 287 -26 588 -26 q 58 73 126 -26 q 0 327 0 158 l 133 327 q 160 172 133 227 q 288 96 198 96 q 426 171 391 96 q 449 336 449 219 l 449 1013 l 588 1013 l 588 279 "},"\xbb":{"x_min":-1,"x_max":503,"ha":601,"o":"m 503 302 l 280 136 l 281 256 l 429 373 l 281 486 l 280 608 l 503 440 l 503 302 m 221 302 l 0 136 l 0 255 l 145 372 l 0 486 l -1 608 l 221 440 l 221 302 "},"\xa9":{"x_min":-3,"x_max":1008,"ha":1106,"o":"m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 741 394 q 661 246 731 302 q 496 190 591 190 q 294 285 369 190 q 228 497 228 370 q 295 714 228 625 q 499 813 370 813 q 656 762 588 813 q 733 625 724 711 l 634 625 q 589 704 629 673 q 498 735 550 735 q 377 666 421 735 q 334 504 334 597 q 374 340 334 408 q 490 272 415 272 q 589 304 549 272 q 638 394 628 337 l 741 394 "},"\u03ce":{"x_min":0,"x_max":922,"ha":1030,"o":"m 687 1040 l 498 819 l 415 819 l 549 1040 l 687 1040 m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 338 0 202 q 45 551 0 444 q 161 737 84 643 l 302 737 q 175 552 219 647 q 124 336 124 446 q 155 179 124 248 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 341 797 257 q 745 555 797 450 q 619 737 705 637 l 760 737 q 874 551 835 640 q 922 339 922 444 "},"^":{"x_min":193.0625,"x_max":598.609375,"ha":792,"o":"m 598 772 l 515 772 l 395 931 l 277 772 l 193 772 l 326 1013 l 462 1013 l 598 772 "},"\xab":{"x_min":0,"x_max":507.203125,"ha":604,"o":"m 506 136 l 284 302 l 284 440 l 506 608 l 507 485 l 360 371 l 506 255 l 506 136 m 222 136 l 0 302 l 0 440 l 222 608 l 221 486 l 73 373 l 222 256 l 222 136 "},"D":{"x_min":0,"x_max":828,"ha":935,"o":"m 389 1013 q 714 867 593 1013 q 828 521 828 729 q 712 161 828 309 q 382 0 587 0 l 0 0 l 0 1013 l 389 1013 m 376 124 q 607 247 523 124 q 681 510 681 355 q 607 771 681 662 q 376 896 522 896 l 139 896 l 139 124 l 376 124 "},"\u2219":{"x_min":0,"x_max":142,"ha":239,"o":"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},"\xff":{"x_min":0,"x_max":47,"ha":125,"o":"m 47 3 q 37 -7 47 -7 q 28 0 30 -7 q 39 -4 32 -4 q 45 3 45 -1 l 37 0 q 28 9 28 0 q 39 19 28 19 l 47 16 l 47 19 l 47 3 m 37 1 q 44 8 44 1 q 37 16 44 16 q 30 8 30 16 q 37 1 30 1 m 26 1 l 23 22 l 14 0 l 3 22 l 3 3 l 0 25 l 13 1 l 22 25 l 26 1 "},"w":{"x_min":0,"x_max":1009.71875,"ha":1100,"o":"m 1009 738 l 783 0 l 658 0 l 501 567 l 345 0 l 222 0 l 0 738 l 130 738 l 284 174 l 432 737 l 576 738 l 721 173 l 881 737 l 1009 738 "},"$":{"x_min":0,"x_max":700,"ha":793,"o":"m 664 717 l 542 717 q 490 825 531 785 q 381 872 450 865 l 381 551 q 620 446 540 522 q 700 241 700 370 q 618 45 700 116 q 381 -25 536 -25 l 381 -152 l 307 -152 l 307 -25 q 81 62 162 -25 q 0 297 0 149 l 124 297 q 169 146 124 204 q 307 81 215 89 l 307 441 q 80 536 148 469 q 13 725 13 603 q 96 910 13 839 q 307 982 180 982 l 307 1077 l 381 1077 l 381 982 q 574 917 494 982 q 664 717 664 845 m 307 565 l 307 872 q 187 831 233 872 q 142 724 142 791 q 180 618 142 656 q 307 565 218 580 m 381 76 q 562 237 562 96 q 517 361 562 313 q 381 423 472 409 l 381 76 "},"\\\\":{"x_min":-0.015625,"x_max":425.0625,"ha":522,"o":"m 425 -129 l 337 -129 l 0 1041 l 83 1041 l 425 -129 "},"\xb5":{"x_min":0,"x_max":697.21875,"ha":747,"o":"m 697 -4 q 629 -14 658 -14 q 498 97 513 -14 q 422 9 470 41 q 313 -23 374 -23 q 207 4 258 -23 q 119 81 156 32 l 119 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 173 124 246 q 308 83 216 83 q 452 178 402 83 q 493 359 493 255 l 493 738 l 617 738 l 617 214 q 623 136 617 160 q 673 92 637 92 q 697 96 684 92 l 697 -4 "},"\u0399":{"x_min":42,"x_max":181,"ha":297,"o":"m 181 0 l 42 0 l 42 1013 l 181 1013 l 181 0 "},"\u038e":{"x_min":0,"x_max":1144.5,"ha":1214,"o":"m 1144 1012 l 807 416 l 807 0 l 667 0 l 667 416 l 325 1012 l 465 1012 l 736 533 l 1004 1012 l 1144 1012 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"\u2019":{"x_min":0,"x_max":139,"ha":236,"o":"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},"\u039d":{"x_min":0,"x_max":801,"ha":915,"o":"m 801 0 l 651 0 l 131 822 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 191 l 670 1013 l 801 1013 l 801 0 "},"-":{"x_min":8.71875,"x_max":350.390625,"ha":478,"o":"m 350 317 l 8 317 l 8 428 l 350 428 l 350 317 "},"Q":{"x_min":0,"x_max":968,"ha":1072,"o":"m 954 5 l 887 -79 l 744 35 q 622 -11 687 2 q 483 -26 556 -26 q 127 130 262 -26 q 0 504 0 279 q 127 880 0 728 q 484 1041 262 1041 q 841 884 708 1041 q 968 507 968 735 q 933 293 968 398 q 832 104 899 188 l 954 5 m 723 191 q 802 330 777 248 q 828 499 828 412 q 744 790 828 673 q 483 922 650 922 q 228 791 322 922 q 142 505 142 673 q 227 221 142 337 q 487 91 323 91 q 632 123 566 91 l 520 215 l 587 301 l 723 191 "},"\u03c2":{"x_min":1,"x_max":676.28125,"ha":740,"o":"m 676 460 l 551 460 q 498 595 542 546 q 365 651 448 651 q 199 578 263 651 q 136 401 136 505 q 266 178 136 241 q 508 106 387 142 q 640 -50 640 62 q 625 -158 640 -105 q 583 -278 611 -211 l 465 -278 q 498 -182 490 -211 q 515 -80 515 -126 q 381 12 515 -15 q 134 91 197 51 q 1 388 1 179 q 100 651 1 542 q 354 761 199 761 q 587 680 498 761 q 676 460 676 599 "},"M":{"x_min":0,"x_max":954,"ha":1067,"o":"m 954 0 l 819 0 l 819 869 l 537 0 l 405 0 l 128 866 l 128 0 l 0 0 l 0 1013 l 200 1013 l 472 160 l 757 1013 l 954 1013 l 954 0 "},"\u03a8":{"x_min":0,"x_max":1006,"ha":1094,"o":"m 1006 678 q 914 319 1006 429 q 571 200 814 200 l 571 0 l 433 0 l 433 200 q 92 319 194 200 q 0 678 0 429 l 0 1013 l 139 1013 l 139 679 q 191 417 139 492 q 433 326 255 326 l 433 1013 l 571 1013 l 571 326 l 580 326 q 813 423 747 326 q 868 679 868 502 l 868 1013 l 1006 1013 l 1006 678 "},"C":{"x_min":0,"x_max":886,"ha":944,"o":"m 886 379 q 760 87 886 201 q 455 -26 634 -26 q 112 136 236 -26 q 0 509 0 283 q 118 882 0 737 q 469 1041 245 1041 q 748 955 630 1041 q 879 708 879 859 l 745 708 q 649 862 724 805 q 473 920 573 920 q 219 791 312 920 q 136 509 136 675 q 217 229 136 344 q 470 99 311 99 q 672 179 591 99 q 753 379 753 259 l 886 379 "},"!":{"x_min":0,"x_max":138,"ha":236,"o":"m 138 684 q 116 409 138 629 q 105 244 105 299 l 33 244 q 16 465 33 313 q 0 684 0 616 l 0 1013 l 138 1013 l 138 684 m 138 0 l 0 0 l 0 151 l 138 151 l 138 0 "},"{":{"x_min":0,"x_max":480.5625,"ha":578,"o":"m 480 -286 q 237 -213 303 -286 q 187 -45 187 -159 q 194 48 187 -15 q 201 141 201 112 q 164 264 201 225 q 0 314 118 314 l 0 417 q 164 471 119 417 q 201 605 201 514 q 199 665 201 644 q 193 772 193 769 q 241 941 193 887 q 480 1015 308 1015 l 480 915 q 336 866 375 915 q 306 742 306 828 q 310 662 306 717 q 314 577 314 606 q 288 452 314 500 q 176 365 256 391 q 289 275 257 337 q 314 143 314 226 q 313 84 314 107 q 310 -11 310 -5 q 339 -131 310 -94 q 480 -182 377 -182 l 480 -286 "},"X":{"x_min":-0.015625,"x_max":854.15625,"ha":940,"o":"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 428 637 l 675 1013 l 836 1013 l 504 520 l 854 0 "},"#":{"x_min":0,"x_max":963.890625,"ha":1061,"o":"m 963 690 l 927 590 l 719 590 l 655 410 l 876 410 l 840 310 l 618 310 l 508 -3 l 393 -2 l 506 309 l 329 310 l 215 -2 l 102 -3 l 212 310 l 0 310 l 36 410 l 248 409 l 312 590 l 86 590 l 120 690 l 347 690 l 459 1006 l 573 1006 l 462 690 l 640 690 l 751 1006 l 865 1006 l 754 690 l 963 690 m 606 590 l 425 590 l 362 410 l 543 410 l 606 590 "},"\u03b9":{"x_min":42,"x_max":284,"ha":361,"o":"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 738 l 167 738 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 "},"\u0386":{"x_min":0,"x_max":906.953125,"ha":982,"o":"m 283 1040 l 88 799 l 5 799 l 145 1040 l 283 1040 m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1012 l 529 1012 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},")":{"x_min":0,"x_max":318,"ha":415,"o":"m 318 365 q 257 25 318 191 q 87 -290 197 -141 l 0 -290 q 140 21 93 -128 q 193 360 193 189 q 141 704 193 537 q 0 1024 97 850 l 87 1024 q 257 706 197 871 q 318 365 318 542 "},"\u03b5":{"x_min":0,"x_max":634.71875,"ha":714,"o":"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 314 0 265 q 128 390 67 353 q 56 460 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 "},"\u0394":{"x_min":0,"x_max":952.78125,"ha":1028,"o":"m 952 0 l 0 0 l 400 1013 l 551 1013 l 952 0 m 762 124 l 476 867 l 187 124 l 762 124 "},"}":{"x_min":0,"x_max":481,"ha":578,"o":"m 481 314 q 318 262 364 314 q 282 136 282 222 q 284 65 282 97 q 293 -58 293 -48 q 241 -217 293 -166 q 0 -286 174 -286 l 0 -182 q 143 -130 105 -182 q 171 -2 171 -93 q 168 81 171 22 q 165 144 165 140 q 188 275 165 229 q 306 365 220 339 q 191 455 224 391 q 165 588 165 505 q 168 681 165 624 q 171 742 171 737 q 141 865 171 827 q 0 915 102 915 l 0 1015 q 243 942 176 1015 q 293 773 293 888 q 287 675 293 741 q 282 590 282 608 q 318 466 282 505 q 481 417 364 417 l 481 314 "},"\u2030":{"x_min":-3,"x_max":1672,"ha":1821,"o":"m 846 0 q 664 76 732 0 q 603 244 603 145 q 662 412 603 344 q 846 489 729 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 846 0 962 0 m 845 103 q 945 143 910 103 q 981 243 981 184 q 947 340 981 301 q 845 385 910 385 q 745 342 782 385 q 709 243 709 300 q 742 147 709 186 q 845 103 781 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 m 1428 0 q 1246 76 1314 0 q 1185 244 1185 145 q 1244 412 1185 344 q 1428 489 1311 489 q 1610 412 1542 489 q 1672 244 1672 343 q 1612 76 1672 144 q 1428 0 1545 0 m 1427 103 q 1528 143 1492 103 q 1564 243 1564 184 q 1530 340 1564 301 q 1427 385 1492 385 q 1327 342 1364 385 q 1291 243 1291 300 q 1324 147 1291 186 q 1427 103 1363 103 "},"a":{"x_min":0,"x_max":698.609375,"ha":794,"o":"m 698 0 q 661 -12 679 -7 q 615 -17 643 -17 q 536 12 564 -17 q 500 96 508 41 q 384 6 456 37 q 236 -25 312 -25 q 65 31 130 -25 q 0 194 0 88 q 118 390 0 334 q 328 435 180 420 q 488 483 476 451 q 495 523 495 504 q 442 619 495 584 q 325 654 389 654 q 209 617 257 654 q 152 513 161 580 l 33 513 q 123 705 33 633 q 332 772 207 772 q 528 712 448 772 q 617 531 617 645 l 617 163 q 624 108 617 126 q 664 90 632 90 l 698 94 l 698 0 m 491 262 l 491 372 q 272 329 350 347 q 128 201 128 294 q 166 113 128 144 q 264 83 205 83 q 414 130 346 83 q 491 262 491 183 "},"\u2014":{"x_min":0,"x_max":941.671875,"ha":1039,"o":"m 941 334 l 0 334 l 0 410 l 941 410 l 941 334 "},"=":{"x_min":8.71875,"x_max":780.953125,"ha":792,"o":"m 780 510 l 8 510 l 8 606 l 780 606 l 780 510 m 780 235 l 8 235 l 8 332 l 780 332 l 780 235 "},"N":{"x_min":0,"x_max":801,"ha":914,"o":"m 801 0 l 651 0 l 131 823 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 193 l 670 1013 l 801 1013 l 801 0 "},"\u03c1":{"x_min":0,"x_max":712,"ha":797,"o":"m 712 369 q 620 94 712 207 q 362 -26 521 -26 q 230 2 292 -26 q 119 83 167 30 l 119 -278 l 0 -278 l 0 362 q 91 643 0 531 q 355 764 190 764 q 617 647 517 764 q 712 369 712 536 m 583 366 q 530 559 583 480 q 359 651 469 651 q 190 562 252 651 q 135 370 135 483 q 189 176 135 257 q 359 85 250 85 q 528 175 466 85 q 583 366 583 254 "},"\xaf":{"x_min":0,"x_max":941.671875,"ha":938,"o":"m 941 1033 l 0 1033 l 0 1109 l 941 1109 l 941 1033 "},"Z":{"x_min":0,"x_max":779,"ha":849,"o":"m 779 0 l 0 0 l 0 113 l 621 896 l 40 896 l 40 1013 l 779 1013 l 778 887 l 171 124 l 779 124 l 779 0 "},"u":{"x_min":0,"x_max":617,"ha":729,"o":"m 617 0 l 499 0 l 499 110 q 391 10 460 45 q 246 -25 322 -25 q 61 58 127 -25 q 0 258 0 136 l 0 738 l 125 738 l 125 284 q 156 148 125 202 q 273 82 197 82 q 433 165 369 82 q 493 340 493 243 l 493 738 l 617 738 l 617 0 "},"k":{"x_min":0,"x_max":612.484375,"ha":697,"o":"m 612 738 l 338 465 l 608 0 l 469 0 l 251 382 l 121 251 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 402 l 456 738 l 612 738 "},"\u0397":{"x_min":0,"x_max":803,"ha":917,"o":"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},"\u0391":{"x_min":0,"x_max":906.953125,"ha":985,"o":"m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},"s":{"x_min":0,"x_max":604,"ha":697,"o":"m 604 217 q 501 36 604 104 q 292 -23 411 -23 q 86 43 166 -23 q 0 238 0 114 l 121 237 q 175 122 121 164 q 300 85 223 85 q 415 112 363 85 q 479 207 479 147 q 361 309 479 276 q 140 372 141 370 q 21 544 21 426 q 111 708 21 647 q 298 761 190 761 q 492 705 413 761 q 583 531 583 643 l 462 531 q 412 625 462 594 q 298 657 363 657 q 199 636 242 657 q 143 558 143 608 q 262 454 143 486 q 484 394 479 397 q 604 217 604 341 "},"B":{"x_min":0,"x_max":778,"ha":876,"o":"m 580 546 q 724 469 670 535 q 778 311 778 403 q 673 83 778 171 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 892 q 691 633 732 693 q 580 546 650 572 m 393 899 l 139 899 l 139 588 l 379 588 q 521 624 462 588 q 592 744 592 667 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 303 635 219 q 559 436 635 389 q 402 477 494 477 l 139 477 l 139 124 l 419 124 "},"\u2026":{"x_min":0,"x_max":614,"ha":708,"o":"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 m 378 0 l 236 0 l 236 151 l 378 151 l 378 0 m 614 0 l 472 0 l 472 151 l 614 151 l 614 0 "},"?":{"x_min":0,"x_max":607,"ha":704,"o":"m 607 777 q 543 599 607 674 q 422 474 482 537 q 357 272 357 391 l 236 272 q 297 487 236 395 q 411 619 298 490 q 474 762 474 691 q 422 885 474 838 q 301 933 371 933 q 179 880 228 933 q 124 706 124 819 l 0 706 q 94 963 0 872 q 302 1044 177 1044 q 511 973 423 1044 q 607 777 607 895 m 370 0 l 230 0 l 230 151 l 370 151 l 370 0 "},"H":{"x_min":0,"x_max":803,"ha":915,"o":"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},"\u03bd":{"x_min":0,"x_max":675,"ha":761,"o":"m 675 738 l 404 0 l 272 0 l 0 738 l 133 738 l 340 147 l 541 738 l 675 738 "},"c":{"x_min":1,"x_max":701.390625,"ha":775,"o":"m 701 264 q 584 53 681 133 q 353 -26 487 -26 q 91 91 188 -26 q 1 370 1 201 q 92 645 1 537 q 353 761 190 761 q 572 688 479 761 q 690 493 666 615 l 556 493 q 487 606 545 562 q 356 650 428 650 q 186 563 246 650 q 134 372 134 487 q 188 179 134 258 q 359 88 250 88 q 492 136 437 88 q 566 264 548 185 l 701 264 "},"\xb6":{"x_min":0,"x_max":566.671875,"ha":678,"o":"m 21 892 l 52 892 l 98 761 l 145 892 l 176 892 l 178 741 l 157 741 l 157 867 l 108 741 l 88 741 l 40 871 l 40 741 l 21 741 l 21 892 m 308 854 l 308 731 q 252 691 308 691 q 227 691 240 691 q 207 696 213 695 l 207 712 l 253 706 q 288 733 288 706 l 288 763 q 244 741 279 741 q 193 797 193 741 q 261 860 193 860 q 287 860 273 860 q 308 854 302 855 m 288 842 l 263 843 q 213 796 213 843 q 248 756 213 756 q 288 796 288 756 l 288 842 m 566 988 l 502 988 l 502 -1 l 439 -1 l 439 988 l 317 988 l 317 -1 l 252 -1 l 252 602 q 81 653 155 602 q 0 805 0 711 q 101 989 0 918 q 309 1053 194 1053 l 566 1053 l 566 988 "},"\u03b2":{"x_min":0,"x_max":660,"ha":745,"o":"m 471 550 q 610 450 561 522 q 660 280 660 378 q 578 64 660 151 q 367 -22 497 -22 q 239 5 299 -22 q 126 82 178 32 l 126 -278 l 0 -278 l 0 593 q 54 903 0 801 q 318 1042 127 1042 q 519 964 436 1042 q 603 771 603 887 q 567 644 603 701 q 471 550 532 586 m 337 79 q 476 138 418 79 q 535 279 535 198 q 427 437 535 386 q 226 477 344 477 l 226 583 q 398 620 329 583 q 486 762 486 668 q 435 884 486 833 q 312 935 384 935 q 169 861 219 935 q 126 698 126 797 l 126 362 q 170 169 126 242 q 337 79 224 79 "},"\u039c":{"x_min":0,"x_max":954,"ha":1068,"o":"m 954 0 l 819 0 l 819 868 l 537 0 l 405 0 l 128 865 l 128 0 l 0 0 l 0 1013 l 199 1013 l 472 158 l 758 1013 l 954 1013 l 954 0 "},"\u038c":{"x_min":0.109375,"x_max":1120,"ha":1217,"o":"m 1120 505 q 994 132 1120 282 q 642 -29 861 -29 q 290 130 422 -29 q 167 505 167 280 q 294 883 167 730 q 650 1046 430 1046 q 999 882 868 1046 q 1120 505 1120 730 m 977 504 q 896 784 977 669 q 644 915 804 915 q 391 785 484 915 q 307 504 307 669 q 391 224 307 339 q 644 95 486 95 q 894 224 803 95 q 977 504 977 339 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"\u0389":{"x_min":0,"x_max":1158,"ha":1275,"o":"m 1158 0 l 1022 0 l 1022 475 l 496 475 l 496 0 l 356 0 l 356 1012 l 496 1012 l 496 599 l 1022 599 l 1022 1012 l 1158 1012 l 1158 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"\u2022":{"x_min":0,"x_max":663.890625,"ha":775,"o":"m 663 529 q 566 293 663 391 q 331 196 469 196 q 97 294 194 196 q 0 529 0 393 q 96 763 0 665 q 331 861 193 861 q 566 763 469 861 q 663 529 663 665 "},"\xa5":{"x_min":0.1875,"x_max":819.546875,"ha":886,"o":"m 563 561 l 697 561 l 696 487 l 520 487 l 482 416 l 482 380 l 697 380 l 695 308 l 482 308 l 482 0 l 342 0 l 342 308 l 125 308 l 125 380 l 342 380 l 342 417 l 303 487 l 125 487 l 125 561 l 258 561 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 l 563 561 "},"(":{"x_min":0,"x_max":318.0625,"ha":415,"o":"m 318 -290 l 230 -290 q 61 23 122 -142 q 0 365 0 190 q 62 712 0 540 q 230 1024 119 869 l 318 1024 q 175 705 219 853 q 125 360 125 542 q 176 22 125 187 q 318 -290 223 -127 "},"U":{"x_min":0,"x_max":796,"ha":904,"o":"m 796 393 q 681 93 796 212 q 386 -25 566 -25 q 101 95 208 -25 q 0 393 0 211 l 0 1013 l 138 1013 l 138 391 q 204 191 138 270 q 394 107 276 107 q 586 191 512 107 q 656 391 656 270 l 656 1013 l 796 1013 l 796 393 "},"\u03b3":{"x_min":0.5,"x_max":744.953125,"ha":822,"o":"m 744 737 l 463 54 l 463 -278 l 338 -278 l 338 54 l 154 495 q 104 597 124 569 q 13 651 67 651 l 0 651 l 0 751 l 39 753 q 168 711 121 753 q 242 594 207 676 l 403 208 l 617 737 l 744 737 "},"\u03b1":{"x_min":0,"x_max":765.5625,"ha":809,"o":"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 728 407 760 q 563 637 524 696 l 563 739 l 685 739 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 96 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 "},"F":{"x_min":0,"x_max":683.328125,"ha":717,"o":"m 683 888 l 140 888 l 140 583 l 613 583 l 613 458 l 140 458 l 140 0 l 0 0 l 0 1013 l 683 1013 l 683 888 "},"\xad":{"x_min":0,"x_max":705.5625,"ha":803,"o":"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},":":{"x_min":0,"x_max":142,"ha":239,"o":"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},"\u03a7":{"x_min":0,"x_max":854.171875,"ha":935,"o":"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 427 637 l 675 1013 l 836 1013 l 504 521 l 854 0 "},"*":{"x_min":116,"x_max":674,"ha":792,"o":"m 674 768 l 475 713 l 610 544 l 517 477 l 394 652 l 272 478 l 178 544 l 314 713 l 116 766 l 153 876 l 341 812 l 342 1013 l 446 1013 l 446 811 l 635 874 l 674 768 "},"\u2020":{"x_min":0,"x_max":777,"ha":835,"o":"m 458 804 l 777 804 l 777 683 l 458 683 l 458 0 l 319 0 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 "},"\xb0":{"x_min":0,"x_max":347,"ha":444,"o":"m 173 802 q 43 856 91 802 q 0 977 0 905 q 45 1101 0 1049 q 173 1153 90 1153 q 303 1098 255 1153 q 347 977 347 1049 q 303 856 347 905 q 173 802 256 802 m 173 884 q 238 910 214 884 q 262 973 262 937 q 239 1038 262 1012 q 173 1064 217 1064 q 108 1037 132 1064 q 85 973 85 1010 q 108 910 85 937 q 173 884 132 884 "},"V":{"x_min":0,"x_max":862.71875,"ha":940,"o":"m 862 1013 l 505 0 l 361 0 l 0 1013 l 143 1013 l 434 165 l 718 1012 l 862 1013 "},"\u039e":{"x_min":0,"x_max":734.71875,"ha":763,"o":"m 723 889 l 9 889 l 9 1013 l 723 1013 l 723 889 m 673 463 l 61 463 l 61 589 l 673 589 l 673 463 m 734 0 l 0 0 l 0 124 l 734 124 l 734 0 "},"\xa0":{"x_min":0,"x_max":0,"ha":853},"\u03ab":{"x_min":0.328125,"x_max":819.515625,"ha":889,"o":"m 588 1046 l 460 1046 l 460 1189 l 588 1189 l 588 1046 m 360 1046 l 232 1046 l 232 1189 l 360 1189 l 360 1046 m 819 1012 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1012 l 140 1012 l 411 533 l 679 1012 l 819 1012 "},"\u201d":{"x_min":0,"x_max":347,"ha":454,"o":"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 m 347 851 q 310 737 347 784 q 208 669 273 690 l 208 734 q 267 787 250 741 q 280 873 280 821 l 208 873 l 208 1013 l 347 1013 l 347 851 "},"@":{"x_min":0,"x_max":1260,"ha":1357,"o":"m 1098 -45 q 877 -160 1001 -117 q 633 -203 752 -203 q 155 -29 327 -203 q 0 360 0 127 q 176 802 0 616 q 687 1008 372 1008 q 1123 854 969 1008 q 1260 517 1260 718 q 1155 216 1260 341 q 868 82 1044 82 q 772 106 801 82 q 737 202 737 135 q 647 113 700 144 q 527 82 594 82 q 367 147 420 82 q 314 312 314 212 q 401 565 314 452 q 639 690 498 690 q 810 588 760 690 l 849 668 l 938 668 q 877 441 900 532 q 833 226 833 268 q 853 182 833 198 q 902 167 873 167 q 1088 272 1012 167 q 1159 512 1159 372 q 1051 793 1159 681 q 687 925 925 925 q 248 747 415 925 q 97 361 97 586 q 226 26 97 159 q 627 -122 370 -122 q 856 -87 737 -122 q 1061 8 976 -53 l 1098 -45 m 786 488 q 738 580 777 545 q 643 615 700 615 q 483 517 548 615 q 425 322 425 430 q 457 203 425 250 q 552 156 490 156 q 722 273 665 156 q 786 488 738 309 "},"\u038a":{"x_min":0,"x_max":499,"ha":613,"o":"m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 m 499 0 l 360 0 l 360 1012 l 499 1012 l 499 0 "},"i":{"x_min":14,"x_max":136,"ha":275,"o":"m 136 873 l 14 873 l 14 1013 l 136 1013 l 136 873 m 136 0 l 14 0 l 14 737 l 136 737 l 136 0 "},"\u0392":{"x_min":0,"x_max":778,"ha":877,"o":"m 580 545 q 724 468 671 534 q 778 310 778 402 q 673 83 778 170 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 891 q 691 632 732 692 q 580 545 650 571 m 393 899 l 139 899 l 139 587 l 379 587 q 521 623 462 587 q 592 744 592 666 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 302 635 219 q 559 435 635 388 q 402 476 494 476 l 139 476 l 139 124 l 419 124 "},"\u03c5":{"x_min":0,"x_max":617,"ha":725,"o":"m 617 352 q 540 94 617 199 q 308 -24 455 -24 q 76 94 161 -24 q 0 352 0 199 l 0 739 l 126 739 l 126 355 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 355 492 257 l 492 739 l 617 739 l 617 352 "},"]":{"x_min":0,"x_max":275,"ha":372,"o":"m 275 -281 l 0 -281 l 0 -187 l 151 -187 l 151 920 l 0 920 l 0 1013 l 275 1013 l 275 -281 "},"m":{"x_min":0,"x_max":1019,"ha":1128,"o":"m 1019 0 l 897 0 l 897 454 q 860 591 897 536 q 739 660 816 660 q 613 586 659 660 q 573 436 573 522 l 573 0 l 447 0 l 447 455 q 412 591 447 535 q 294 657 372 657 q 165 586 213 657 q 122 437 122 521 l 122 0 l 0 0 l 0 738 l 117 738 l 117 640 q 202 730 150 697 q 316 763 254 763 q 437 730 381 763 q 525 642 494 697 q 621 731 559 700 q 753 763 682 763 q 943 694 867 763 q 1019 512 1019 625 l 1019 0 "},"\u03c7":{"x_min":8.328125,"x_max":780.5625,"ha":815,"o":"m 780 -278 q 715 -294 747 -294 q 616 -257 663 -294 q 548 -175 576 -227 l 379 133 l 143 -277 l 9 -277 l 313 254 l 163 522 q 127 586 131 580 q 36 640 91 640 q 8 637 27 640 l 8 752 l 52 757 q 162 719 113 757 q 236 627 200 690 l 383 372 l 594 737 l 726 737 l 448 250 l 625 -69 q 670 -153 647 -110 q 743 -188 695 -188 q 780 -184 759 -188 l 780 -278 "},"\u03af":{"x_min":42,"x_max":326.71875,"ha":361,"o":"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 102 239 101 q 284 112 257 104 l 284 3 m 326 1040 l 137 819 l 54 819 l 189 1040 l 326 1040 "},"\u0396":{"x_min":0,"x_max":779.171875,"ha":850,"o":"m 779 0 l 0 0 l 0 113 l 620 896 l 40 896 l 40 1013 l 779 1013 l 779 887 l 170 124 l 779 124 l 779 0 "},"R":{"x_min":0,"x_max":781.953125,"ha":907,"o":"m 781 0 l 623 0 q 587 242 590 52 q 407 433 585 433 l 138 433 l 138 0 l 0 0 l 0 1013 l 396 1013 q 636 946 539 1013 q 749 731 749 868 q 711 597 749 659 q 608 502 674 534 q 718 370 696 474 q 729 207 722 352 q 781 26 736 62 l 781 0 m 373 551 q 533 594 465 551 q 614 731 614 645 q 532 859 614 815 q 373 896 465 896 l 138 896 l 138 551 l 373 551 "},"o":{"x_min":0,"x_max":713,"ha":821,"o":"m 357 -25 q 94 91 194 -25 q 0 368 0 202 q 93 642 0 533 q 357 761 193 761 q 618 644 518 761 q 713 368 713 533 q 619 91 713 201 q 357 -25 521 -25 m 357 85 q 528 175 465 85 q 584 369 584 255 q 529 562 584 484 q 357 651 467 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 357 85 250 85 "},"K":{"x_min":0,"x_max":819.46875,"ha":906,"o":"m 819 0 l 649 0 l 294 509 l 139 355 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},",":{"x_min":0,"x_max":142,"ha":239,"o":"m 142 -12 q 105 -132 142 -82 q 0 -205 68 -182 l 0 -138 q 57 -82 40 -124 q 70 0 70 -51 l 0 0 l 0 151 l 142 151 l 142 -12 "},"d":{"x_min":0,"x_max":683,"ha":796,"o":"m 683 0 l 564 0 l 564 93 q 456 6 516 38 q 327 -25 395 -25 q 87 100 181 -25 q 0 365 0 215 q 90 639 0 525 q 343 763 187 763 q 564 647 486 763 l 564 1013 l 683 1013 l 683 0 m 582 373 q 529 562 582 484 q 361 653 468 653 q 190 561 253 653 q 135 365 135 479 q 189 175 135 254 q 358 85 251 85 q 529 178 468 85 q 582 373 582 258 "},"\xa8":{"x_min":-109,"x_max":247,"ha":232,"o":"m 247 1046 l 119 1046 l 119 1189 l 247 1189 l 247 1046 m 19 1046 l -109 1046 l -109 1189 l 19 1189 l 19 1046 "},"E":{"x_min":0,"x_max":736.109375,"ha":789,"o":"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},"Y":{"x_min":0,"x_max":820,"ha":886,"o":"m 820 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 534 l 679 1012 l 820 1013 "},"\\"":{"x_min":0,"x_max":299,"ha":396,"o":"m 299 606 l 203 606 l 203 988 l 299 988 l 299 606 m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"\u2039":{"x_min":17.984375,"x_max":773.609375,"ha":792,"o":"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"\u201e":{"x_min":0,"x_max":364,"ha":467,"o":"m 141 -12 q 104 -132 141 -82 q 0 -205 67 -182 l 0 -138 q 56 -82 40 -124 q 69 0 69 -51 l 0 0 l 0 151 l 141 151 l 141 -12 m 364 -12 q 327 -132 364 -82 q 222 -205 290 -182 l 222 -138 q 279 -82 262 -124 q 292 0 292 -51 l 222 0 l 222 151 l 364 151 l 364 -12 "},"\u03b4":{"x_min":1,"x_max":710,"ha":810,"o":"m 710 360 q 616 87 710 196 q 356 -28 518 -28 q 99 82 197 -28 q 1 356 1 192 q 100 606 1 509 q 355 703 199 703 q 180 829 288 754 q 70 903 124 866 l 70 1012 l 643 1012 l 643 901 l 258 901 q 462 763 422 794 q 636 592 577 677 q 710 360 710 485 m 584 365 q 552 501 584 447 q 451 602 521 555 q 372 611 411 611 q 197 541 258 611 q 136 355 136 472 q 190 171 136 245 q 358 85 252 85 q 528 173 465 85 q 584 365 584 252 "},"\u03ad":{"x_min":0,"x_max":634.71875,"ha":714,"o":"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 313 0 265 q 128 390 67 352 q 56 459 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 m 520 1040 l 331 819 l 248 819 l 383 1040 l 520 1040 "},"\u03c9":{"x_min":0,"x_max":922,"ha":1031,"o":"m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 339 0 203 q 45 551 0 444 q 161 738 84 643 l 302 738 q 175 553 219 647 q 124 336 124 446 q 155 179 124 249 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 342 797 257 q 745 556 797 450 q 619 738 705 638 l 760 738 q 874 551 835 640 q 922 339 922 444 "},"\xb4":{"x_min":0,"x_max":96,"ha":251,"o":"m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"\xb1":{"x_min":11,"x_max":781,"ha":792,"o":"m 781 490 l 446 490 l 446 255 l 349 255 l 349 490 l 11 490 l 11 586 l 349 586 l 349 819 l 446 819 l 446 586 l 781 586 l 781 490 m 781 21 l 11 21 l 11 115 l 781 115 l 781 21 "},"|":{"x_min":343,"x_max":449,"ha":792,"o":"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},"\u03cb":{"x_min":0,"x_max":617,"ha":725,"o":"m 482 800 l 372 800 l 372 925 l 482 925 l 482 800 m 239 800 l 129 800 l 129 925 l 239 925 l 239 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 "},"\xa7":{"x_min":0,"x_max":593,"ha":690,"o":"m 593 425 q 554 312 593 369 q 467 233 516 254 q 537 83 537 172 q 459 -74 537 -12 q 288 -133 387 -133 q 115 -69 184 -133 q 47 96 47 -6 l 166 96 q 199 7 166 40 q 288 -26 232 -26 q 371 -5 332 -26 q 420 60 420 21 q 311 201 420 139 q 108 309 210 255 q 0 490 0 383 q 33 602 0 551 q 124 687 66 654 q 75 743 93 712 q 58 812 58 773 q 133 984 58 920 q 300 1043 201 1043 q 458 987 394 1043 q 529 814 529 925 l 411 814 q 370 908 404 877 q 289 939 336 939 q 213 911 246 939 q 180 841 180 883 q 286 720 180 779 q 484 612 480 615 q 593 425 593 534 m 467 409 q 355 544 467 473 q 196 630 228 612 q 146 587 162 609 q 124 525 124 558 q 239 387 124 462 q 398 298 369 315 q 448 345 429 316 q 467 409 467 375 "},"b":{"x_min":0,"x_max":685,"ha":783,"o":"m 685 372 q 597 99 685 213 q 347 -25 501 -25 q 219 5 277 -25 q 121 93 161 36 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 634 q 214 723 157 692 q 341 754 272 754 q 591 637 493 754 q 685 372 685 526 m 554 356 q 499 550 554 470 q 328 644 437 644 q 162 556 223 644 q 108 369 108 478 q 160 176 108 256 q 330 83 221 83 q 498 169 435 83 q 554 356 554 245 "},"q":{"x_min":0,"x_max":683,"ha":876,"o":"m 683 -278 l 564 -278 l 564 97 q 474 8 533 39 q 345 -23 415 -23 q 91 93 188 -23 q 0 364 0 203 q 87 635 0 522 q 337 760 184 760 q 466 727 408 760 q 564 637 523 695 l 564 737 l 683 737 l 683 -278 m 582 375 q 527 564 582 488 q 358 652 466 652 q 190 565 253 652 q 135 377 135 488 q 189 179 135 261 q 361 84 251 84 q 530 179 469 84 q 582 375 582 260 "},"\u03a9":{"x_min":-0.171875,"x_max":969.5625,"ha":1068,"o":"m 969 0 l 555 0 l 555 123 q 744 308 675 194 q 814 558 814 423 q 726 812 814 709 q 484 922 633 922 q 244 820 334 922 q 154 567 154 719 q 223 316 154 433 q 412 123 292 199 l 412 0 l 0 0 l 0 124 l 217 124 q 68 327 122 210 q 15 572 15 444 q 144 911 15 781 q 484 1041 274 1041 q 822 909 691 1041 q 953 569 953 777 q 899 326 953 443 q 750 124 846 210 l 969 124 l 969 0 "},"\u03cd":{"x_min":0,"x_max":617,"ha":725,"o":"m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 535 1040 l 346 819 l 262 819 l 397 1040 l 535 1040 "},"z":{"x_min":-0.015625,"x_max":613.890625,"ha":697,"o":"m 613 0 l 0 0 l 0 100 l 433 630 l 20 630 l 20 738 l 594 738 l 593 636 l 163 110 l 613 110 l 613 0 "},"\u2122":{"x_min":0,"x_max":894,"ha":1000,"o":"m 389 951 l 229 951 l 229 503 l 160 503 l 160 951 l 0 951 l 0 1011 l 389 1011 l 389 951 m 894 503 l 827 503 l 827 939 l 685 503 l 620 503 l 481 937 l 481 503 l 417 503 l 417 1011 l 517 1011 l 653 580 l 796 1010 l 894 1011 l 894 503 "},"\u03ae":{"x_min":0.78125,"x_max":697,"ha":810,"o":"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 721 124 755 q 200 630 193 687 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 m 479 1040 l 290 819 l 207 819 l 341 1040 l 479 1040 "},"\u0398":{"x_min":0,"x_max":960,"ha":1056,"o":"m 960 507 q 833 129 960 280 q 476 -32 698 -32 q 123 129 255 -32 q 0 507 0 280 q 123 883 0 732 q 476 1045 255 1045 q 832 883 696 1045 q 960 507 960 732 m 817 500 q 733 789 817 669 q 476 924 639 924 q 223 792 317 924 q 142 507 142 675 q 222 222 142 339 q 476 89 315 89 q 730 218 636 89 q 817 500 817 334 m 716 449 l 243 449 l 243 571 l 716 571 l 716 449 "},"\xae":{"x_min":-3,"x_max":1008,"ha":1106,"o":"m 503 532 q 614 562 566 532 q 672 658 672 598 q 614 747 672 716 q 503 772 569 772 l 338 772 l 338 532 l 503 532 m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 788 146 l 678 146 q 653 316 655 183 q 527 449 652 449 l 338 449 l 338 146 l 241 146 l 241 854 l 518 854 q 688 808 621 854 q 766 658 766 755 q 739 563 766 607 q 668 497 713 519 q 751 331 747 472 q 788 164 756 190 l 788 146 "},"~":{"x_min":0,"x_max":833,"ha":931,"o":"m 833 958 q 778 753 833 831 q 594 665 716 665 q 402 761 502 665 q 240 857 302 857 q 131 795 166 857 q 104 665 104 745 l 0 665 q 54 867 0 789 q 237 958 116 958 q 429 861 331 958 q 594 765 527 765 q 704 827 670 765 q 729 958 729 874 l 833 958 "},"\u0395":{"x_min":0,"x_max":736.21875,"ha":778,"o":"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},"\xb3":{"x_min":0,"x_max":450,"ha":547,"o":"m 450 552 q 379 413 450 464 q 220 366 313 366 q 69 414 130 366 q 0 567 0 470 l 85 567 q 126 470 85 504 q 225 437 168 437 q 320 467 280 437 q 360 552 360 498 q 318 632 360 608 q 213 657 276 657 q 195 657 203 657 q 176 657 181 657 l 176 722 q 279 733 249 722 q 334 815 334 752 q 300 881 334 856 q 220 907 267 907 q 133 875 169 907 q 97 781 97 844 l 15 781 q 78 926 15 875 q 220 972 135 972 q 364 930 303 972 q 426 817 426 888 q 344 697 426 733 q 421 642 392 681 q 450 552 450 603 "},"[":{"x_min":0,"x_max":273.609375,"ha":371,"o":"m 273 -281 l 0 -281 l 0 1013 l 273 1013 l 273 920 l 124 920 l 124 -187 l 273 -187 l 273 -281 "},"L":{"x_min":0,"x_max":645.828125,"ha":696,"o":"m 645 0 l 0 0 l 0 1013 l 140 1013 l 140 126 l 645 126 l 645 0 "},"\u03c3":{"x_min":0,"x_max":803.390625,"ha":894,"o":"m 803 628 l 633 628 q 713 368 713 512 q 618 93 713 204 q 357 -25 518 -25 q 94 91 194 -25 q 0 368 0 201 q 94 644 0 533 q 356 761 194 761 q 481 750 398 761 q 608 739 564 739 l 803 739 l 803 628 m 360 85 q 529 180 467 85 q 584 374 584 262 q 527 566 584 490 q 352 651 463 651 q 187 559 247 651 q 135 368 135 478 q 189 175 135 254 q 360 85 251 85 "},"\u03b6":{"x_min":0,"x_max":573,"ha":642,"o":"m 573 -40 q 553 -162 573 -97 q 510 -278 543 -193 l 400 -278 q 441 -187 428 -219 q 462 -90 462 -132 q 378 -14 462 -14 q 108 45 197 -14 q 0 290 0 117 q 108 631 0 462 q 353 901 194 767 l 55 901 l 55 1012 l 561 1012 l 561 924 q 261 669 382 831 q 128 301 128 489 q 243 117 128 149 q 458 98 350 108 q 573 -40 573 80 "},"\u03b8":{"x_min":0,"x_max":674,"ha":778,"o":"m 674 496 q 601 160 674 304 q 336 -26 508 -26 q 73 153 165 -26 q 0 485 0 296 q 72 840 0 683 q 343 1045 166 1045 q 605 844 516 1045 q 674 496 674 692 m 546 579 q 498 798 546 691 q 336 935 437 935 q 178 798 237 935 q 126 579 137 701 l 546 579 m 546 475 l 126 475 q 170 233 126 348 q 338 80 230 80 q 504 233 447 80 q 546 475 546 346 "},"\u039f":{"x_min":0,"x_max":958,"ha":1054,"o":"m 485 1042 q 834 883 703 1042 q 958 511 958 735 q 834 136 958 287 q 481 -26 701 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 729 q 485 1042 263 1042 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 670 q 480 913 640 913 q 226 785 321 913 q 142 504 142 671 q 226 224 142 339 q 480 98 319 98 "},"\u0393":{"x_min":0,"x_max":705.28125,"ha":749,"o":"m 705 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 705 1012 l 705 886 "}," ":{"x_min":0,"x_max":0,"ha":375},"%":{"x_min":-3,"x_max":1089,"ha":1186,"o":"m 845 0 q 663 76 731 0 q 602 244 602 145 q 661 412 602 344 q 845 489 728 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 845 0 962 0 m 844 103 q 945 143 909 103 q 981 243 981 184 q 947 340 981 301 q 844 385 909 385 q 744 342 781 385 q 708 243 708 300 q 741 147 708 186 q 844 103 780 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 "},"P":{"x_min":0,"x_max":726,"ha":806,"o":"m 424 1013 q 640 931 555 1013 q 726 719 726 850 q 637 506 726 587 q 413 426 548 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 379 889 l 140 889 l 140 548 l 372 548 q 522 589 459 548 q 593 720 593 637 q 528 845 593 801 q 379 889 463 889 "},"\u0388":{"x_min":0,"x_max":1078.21875,"ha":1118,"o":"m 1078 0 l 342 0 l 342 1013 l 1067 1013 l 1067 889 l 481 889 l 481 585 l 1019 585 l 1019 467 l 481 467 l 481 125 l 1078 125 l 1078 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"\u038f":{"x_min":0.125,"x_max":1136.546875,"ha":1235,"o":"m 1136 0 l 722 0 l 722 123 q 911 309 842 194 q 981 558 981 423 q 893 813 981 710 q 651 923 800 923 q 411 821 501 923 q 321 568 321 720 q 390 316 321 433 q 579 123 459 200 l 579 0 l 166 0 l 166 124 l 384 124 q 235 327 289 210 q 182 572 182 444 q 311 912 182 782 q 651 1042 441 1042 q 989 910 858 1042 q 1120 569 1120 778 q 1066 326 1120 443 q 917 124 1013 210 l 1136 124 l 1136 0 m 277 1040 l 83 800 l 0 800 l 140 1041 l 277 1040 "},"_":{"x_min":0,"x_max":705.5625,"ha":803,"o":"m 705 -334 l 0 -334 l 0 -234 l 705 -234 l 705 -334 "},"\u03aa":{"x_min":-110,"x_max":246,"ha":275,"o":"m 246 1046 l 118 1046 l 118 1189 l 246 1189 l 246 1046 m 18 1046 l -110 1046 l -110 1189 l 18 1189 l 18 1046 m 136 0 l 0 0 l 0 1012 l 136 1012 l 136 0 "},"+":{"x_min":23,"x_max":768,"ha":792,"o":"m 768 372 l 444 372 l 444 0 l 347 0 l 347 372 l 23 372 l 23 468 l 347 468 l 347 840 l 444 840 l 444 468 l 768 468 l 768 372 "},"\xbd":{"x_min":0,"x_max":1050,"ha":1149,"o":"m 1050 0 l 625 0 q 712 178 625 108 q 878 277 722 187 q 967 385 967 328 q 932 456 967 429 q 850 484 897 484 q 759 450 798 484 q 721 352 721 416 l 640 352 q 706 502 640 448 q 851 551 766 551 q 987 509 931 551 q 1050 385 1050 462 q 976 251 1050 301 q 829 179 902 215 q 717 68 740 133 l 1050 68 l 1050 0 m 834 985 l 215 -28 l 130 -28 l 750 984 l 834 985 m 224 422 l 142 422 l 142 811 l 0 811 l 0 867 q 104 889 62 867 q 164 973 157 916 l 224 973 l 224 422 "},"\u03a1":{"x_min":0,"x_max":720,"ha":783,"o":"m 424 1013 q 637 933 554 1013 q 720 723 720 853 q 633 508 720 591 q 413 426 546 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 378 889 l 140 889 l 140 548 l 371 548 q 521 589 458 548 q 592 720 592 637 q 527 845 592 801 q 378 889 463 889 "},"\'":{"x_min":0,"x_max":139,"ha":236,"o":"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},"\xaa":{"x_min":0,"x_max":350,"ha":397,"o":"m 350 625 q 307 616 328 616 q 266 631 281 616 q 247 673 251 645 q 190 628 225 644 q 116 613 156 613 q 32 641 64 613 q 0 722 0 669 q 72 826 0 800 q 247 866 159 846 l 247 887 q 220 934 247 916 q 162 953 194 953 q 104 934 129 953 q 76 882 80 915 l 16 882 q 60 976 16 941 q 166 1011 104 1011 q 266 979 224 1011 q 308 891 308 948 l 308 706 q 311 679 308 688 q 331 670 315 670 l 350 672 l 350 625 m 247 757 l 247 811 q 136 790 175 798 q 64 726 64 773 q 83 682 64 697 q 132 667 103 667 q 207 690 174 667 q 247 757 247 718 "},"\u0385":{"x_min":0,"x_max":450,"ha":553,"o":"m 450 800 l 340 800 l 340 925 l 450 925 l 450 800 m 406 1040 l 212 800 l 129 800 l 269 1040 l 406 1040 m 110 800 l 0 800 l 0 925 l 110 925 l 110 800 "},"T":{"x_min":0,"x_max":777,"ha":835,"o":"m 777 894 l 458 894 l 458 0 l 319 0 l 319 894 l 0 894 l 0 1013 l 777 1013 l 777 894 "},"\u03a6":{"x_min":0,"x_max":915,"ha":997,"o":"m 527 0 l 389 0 l 389 122 q 110 231 220 122 q 0 509 0 340 q 110 785 0 677 q 389 893 220 893 l 389 1013 l 527 1013 l 527 893 q 804 786 693 893 q 915 509 915 679 q 805 231 915 341 q 527 122 696 122 l 527 0 m 527 226 q 712 310 641 226 q 779 507 779 389 q 712 705 779 627 q 527 787 641 787 l 527 226 m 389 226 l 389 787 q 205 698 275 775 q 136 505 136 620 q 206 308 136 391 q 389 226 276 226 "},"\u204b":{"x_min":0,"x_max":0,"ha":694},"j":{"x_min":-77.78125,"x_max":167,"ha":349,"o":"m 167 871 l 42 871 l 42 1013 l 167 1013 l 167 871 m 167 -80 q 121 -231 167 -184 q -26 -278 76 -278 l -77 -278 l -77 -164 l -41 -164 q 26 -143 11 -164 q 42 -65 42 -122 l 42 737 l 167 737 l 167 -80 "},"\u03a3":{"x_min":0,"x_max":756.953125,"ha":819,"o":"m 756 0 l 0 0 l 0 107 l 395 523 l 22 904 l 22 1013 l 745 1013 l 745 889 l 209 889 l 566 523 l 187 125 l 756 125 l 756 0 "},"\u203a":{"x_min":18.0625,"x_max":774,"ha":792,"o":"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},"<":{"x_min":17.984375,"x_max":773.609375,"ha":792,"o":"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"\xa3":{"x_min":0,"x_max":704.484375,"ha":801,"o":"m 704 41 q 623 -10 664 5 q 543 -26 583 -26 q 359 15 501 -26 q 243 36 288 36 q 158 23 197 36 q 73 -21 119 10 l 6 76 q 125 195 90 150 q 175 331 175 262 q 147 443 175 383 l 0 443 l 0 512 l 108 512 q 43 734 43 623 q 120 929 43 854 q 358 1010 204 1010 q 579 936 487 1010 q 678 729 678 857 l 678 684 l 552 684 q 504 838 552 780 q 362 896 457 896 q 216 852 263 896 q 176 747 176 815 q 199 627 176 697 q 248 512 217 574 l 468 512 l 468 443 l 279 443 q 297 356 297 398 q 230 194 297 279 q 153 107 211 170 q 227 133 190 125 q 293 142 264 142 q 410 119 339 142 q 516 96 482 96 q 579 105 550 96 q 648 142 608 115 l 704 41 "},"t":{"x_min":0,"x_max":367,"ha":458,"o":"m 367 0 q 312 -5 339 -2 q 262 -8 284 -8 q 145 28 183 -8 q 108 143 108 64 l 108 638 l 0 638 l 0 738 l 108 738 l 108 944 l 232 944 l 232 738 l 367 738 l 367 638 l 232 638 l 232 185 q 248 121 232 140 q 307 102 264 102 q 345 104 330 102 q 367 107 360 107 l 367 0 "},"\xac":{"x_min":0,"x_max":706,"ha":803,"o":"m 706 411 l 706 158 l 630 158 l 630 335 l 0 335 l 0 411 l 706 411 "},"\u03bb":{"x_min":0,"x_max":750,"ha":803,"o":"m 750 -7 q 679 -15 716 -15 q 538 59 591 -15 q 466 214 512 97 l 336 551 l 126 0 l 0 0 l 270 705 q 223 837 247 770 q 116 899 190 899 q 90 898 100 899 l 90 1004 q 152 1011 125 1011 q 298 938 244 1011 q 373 783 326 901 l 605 192 q 649 115 629 136 q 716 95 669 95 l 736 95 q 750 97 745 97 l 750 -7 "},"W":{"x_min":0,"x_max":1263.890625,"ha":1351,"o":"m 1263 1013 l 995 0 l 859 0 l 627 837 l 405 0 l 265 0 l 0 1013 l 136 1013 l 342 202 l 556 1013 l 701 1013 l 921 207 l 1133 1012 l 1263 1013 "},">":{"x_min":18.0625,"x_max":774,"ha":792,"o":"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},"v":{"x_min":0,"x_max":675.15625,"ha":761,"o":"m 675 738 l 404 0 l 272 0 l 0 738 l 133 737 l 340 147 l 541 737 l 675 738 "},"\u03c4":{"x_min":0.28125,"x_max":644.5,"ha":703,"o":"m 644 628 l 382 628 l 382 179 q 388 120 382 137 q 436 91 401 91 q 474 94 447 91 q 504 97 501 97 l 504 0 q 454 -9 482 -5 q 401 -14 426 -14 q 278 67 308 -14 q 260 233 260 118 l 260 628 l 0 628 l 0 739 l 644 739 l 644 628 "},"\u03be":{"x_min":0,"x_max":624.9375,"ha":699,"o":"m 624 -37 q 608 -153 624 -96 q 563 -278 593 -211 l 454 -278 q 491 -183 486 -200 q 511 -83 511 -126 q 484 -23 511 -44 q 370 1 452 1 q 323 0 354 1 q 283 -1 293 -1 q 84 76 169 -1 q 0 266 0 154 q 56 431 0 358 q 197 538 108 498 q 94 613 134 562 q 54 730 54 665 q 77 823 54 780 q 143 901 101 867 l 27 901 l 27 1012 l 576 1012 l 576 901 l 380 901 q 244 863 303 901 q 178 745 178 820 q 312 600 178 636 q 532 582 380 582 l 532 479 q 276 455 361 479 q 118 281 118 410 q 165 173 118 217 q 274 120 208 133 q 494 101 384 110 q 624 -37 624 76 "},"&":{"x_min":-3,"x_max":894.25,"ha":992,"o":"m 894 0 l 725 0 l 624 123 q 471 0 553 40 q 306 -41 390 -41 q 168 -7 231 -41 q 62 92 105 26 q 14 187 31 139 q -3 276 -3 235 q 55 433 -3 358 q 248 581 114 508 q 170 689 196 640 q 137 817 137 751 q 214 985 137 922 q 384 1041 284 1041 q 548 988 483 1041 q 622 824 622 928 q 563 666 622 739 q 431 556 516 608 l 621 326 q 649 407 639 361 q 663 493 653 426 l 781 493 q 703 229 781 352 l 894 0 m 504 818 q 468 908 504 877 q 384 940 433 940 q 293 907 331 940 q 255 818 255 875 q 289 714 255 767 q 363 628 313 678 q 477 729 446 682 q 504 818 504 771 m 556 209 l 314 499 q 179 395 223 449 q 135 283 135 341 q 146 222 135 253 q 183 158 158 192 q 333 80 241 80 q 556 209 448 80 "},"\u039b":{"x_min":0,"x_max":862.5,"ha":942,"o":"m 862 0 l 719 0 l 426 847 l 143 0 l 0 0 l 356 1013 l 501 1013 l 862 0 "},"I":{"x_min":41,"x_max":180,"ha":293,"o":"m 180 0 l 41 0 l 41 1013 l 180 1013 l 180 0 "},"G":{"x_min":0,"x_max":921,"ha":1011,"o":"m 921 0 l 832 0 l 801 136 q 655 15 741 58 q 470 -28 568 -28 q 126 133 259 -28 q 0 499 0 284 q 125 881 0 731 q 486 1043 259 1043 q 763 957 647 1043 q 905 709 890 864 l 772 709 q 668 866 747 807 q 486 926 589 926 q 228 795 322 926 q 142 507 142 677 q 228 224 142 342 q 483 94 323 94 q 712 195 625 94 q 796 435 796 291 l 477 435 l 477 549 l 921 549 l 921 0 "},"\u03b0":{"x_min":0,"x_max":617,"ha":725,"o":"m 524 800 l 414 800 l 414 925 l 524 925 l 524 800 m 183 800 l 73 800 l 73 925 l 183 925 l 183 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 489 1040 l 300 819 l 216 819 l 351 1040 l 489 1040 "},"`":{"x_min":0,"x_max":138.890625,"ha":236,"o":"m 138 699 l 0 699 l 0 861 q 36 974 0 929 q 138 1041 72 1020 l 138 977 q 82 931 95 969 q 69 839 69 893 l 138 839 l 138 699 "},"\xb7":{"x_min":0,"x_max":142,"ha":239,"o":"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},"\u03a5":{"x_min":0.328125,"x_max":819.515625,"ha":889,"o":"m 819 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 "},"r":{"x_min":0,"x_max":355.5625,"ha":432,"o":"m 355 621 l 343 621 q 179 569 236 621 q 122 411 122 518 l 122 0 l 0 0 l 0 737 l 117 737 l 117 604 q 204 719 146 686 q 355 753 262 753 l 355 621 "},"x":{"x_min":0,"x_max":675,"ha":764,"o":"m 675 0 l 525 0 l 331 286 l 144 0 l 0 0 l 256 379 l 12 738 l 157 737 l 336 473 l 516 738 l 661 738 l 412 380 l 675 0 "},"\u03bc":{"x_min":0,"x_max":696.609375,"ha":747,"o":"m 696 -4 q 628 -14 657 -14 q 498 97 513 -14 q 422 8 470 41 q 313 -24 374 -24 q 207 3 258 -24 q 120 80 157 31 l 120 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 172 124 246 q 308 82 216 82 q 451 177 402 82 q 492 358 492 254 l 492 738 l 616 738 l 616 214 q 623 136 616 160 q 673 92 636 92 q 696 95 684 92 l 696 -4 "},"h":{"x_min":0,"x_max":615,"ha":724,"o":"m 615 472 l 615 0 l 490 0 l 490 454 q 456 590 490 535 q 338 654 416 654 q 186 588 251 654 q 122 436 122 522 l 122 0 l 0 0 l 0 1013 l 122 1013 l 122 633 q 218 727 149 694 q 362 760 287 760 q 552 676 484 760 q 615 472 615 600 "},".":{"x_min":0,"x_max":142,"ha":239,"o":"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},"\u03c6":{"x_min":-2,"x_max":878,"ha":974,"o":"m 496 -279 l 378 -279 l 378 -17 q 101 88 204 -17 q -2 367 -2 194 q 68 626 -2 510 q 283 758 151 758 l 283 646 q 167 537 209 626 q 133 373 133 462 q 192 177 133 254 q 378 93 259 93 l 378 758 q 445 764 426 763 q 476 765 464 765 q 765 659 653 765 q 878 377 878 553 q 771 96 878 209 q 496 -17 665 -17 l 496 -279 m 496 93 l 514 93 q 687 183 623 93 q 746 380 746 265 q 691 569 746 491 q 522 658 629 658 l 496 656 l 496 93 "},";":{"x_min":0,"x_max":142,"ha":239,"o":"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 -12 q 105 -132 142 -82 q 0 -206 68 -182 l 0 -138 q 58 -82 43 -123 q 68 0 68 -56 l 0 0 l 0 151 l 142 151 l 142 -12 "},"f":{"x_min":0,"x_max":378,"ha":472,"o":"m 378 638 l 246 638 l 246 0 l 121 0 l 121 638 l 0 638 l 0 738 l 121 738 q 137 935 121 887 q 290 1028 171 1028 q 320 1027 305 1028 q 378 1021 334 1026 l 378 908 q 323 918 346 918 q 257 870 273 918 q 246 780 246 840 l 246 738 l 378 738 l 378 638 "},"\u201c":{"x_min":1,"x_max":348.21875,"ha":454,"o":"m 140 670 l 1 670 l 1 830 q 37 943 1 897 q 140 1011 74 990 l 140 947 q 82 900 97 940 q 68 810 68 861 l 140 810 l 140 670 m 348 670 l 209 670 l 209 830 q 245 943 209 897 q 348 1011 282 990 l 348 947 q 290 900 305 940 q 276 810 276 861 l 348 810 l 348 670 "},"A":{"x_min":0.03125,"x_max":906.953125,"ha":1008,"o":"m 906 0 l 756 0 l 648 303 l 251 303 l 142 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 610 421 l 452 867 l 293 421 l 610 421 "},"\u2018":{"x_min":1,"x_max":139.890625,"ha":236,"o":"m 139 670 l 1 670 l 1 830 q 37 943 1 897 q 139 1011 74 990 l 139 947 q 82 900 97 940 q 68 810 68 861 l 139 810 l 139 670 "},"\u03ca":{"x_min":-70,"x_max":283,"ha":361,"o":"m 283 800 l 173 800 l 173 925 l 283 925 l 283 800 m 40 800 l -70 800 l -70 925 l 40 925 l 40 800 m 283 3 q 232 -10 257 -5 q 181 -15 206 -15 q 84 26 118 -15 q 41 200 41 79 l 41 737 l 166 737 l 167 215 q 171 141 167 157 q 225 101 182 101 q 247 103 238 101 q 283 112 256 104 l 283 3 "},"\u03c0":{"x_min":-0.21875,"x_max":773.21875,"ha":857,"o":"m 773 -7 l 707 -11 q 575 40 607 -11 q 552 174 552 77 l 552 226 l 552 626 l 222 626 l 222 0 l 97 0 l 97 626 l 0 626 l 0 737 l 773 737 l 773 626 l 676 626 l 676 171 q 695 103 676 117 q 773 90 714 90 l 773 -7 "},"\u03ac":{"x_min":0,"x_max":765.5625,"ha":809,"o":"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 727 407 760 q 563 637 524 695 l 563 738 l 685 738 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 95 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 m 604 1040 l 415 819 l 332 819 l 466 1040 l 604 1040 "},"O":{"x_min":0,"x_max":958,"ha":1057,"o":"m 485 1041 q 834 882 702 1041 q 958 512 958 734 q 834 136 958 287 q 481 -26 702 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 728 q 485 1041 263 1041 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 669 q 480 912 640 912 q 226 784 321 912 q 142 504 142 670 q 226 224 142 339 q 480 98 319 98 "},"n":{"x_min":0,"x_max":615,"ha":724,"o":"m 615 463 l 615 0 l 490 0 l 490 454 q 453 592 490 537 q 331 656 410 656 q 178 585 240 656 q 117 421 117 514 l 117 0 l 0 0 l 0 738 l 117 738 l 117 630 q 218 728 150 693 q 359 764 286 764 q 552 675 484 764 q 615 463 615 593 "},"l":{"x_min":41,"x_max":166,"ha":279,"o":"m 166 0 l 41 0 l 41 1013 l 166 1013 l 166 0 "},"\xa4":{"x_min":40.09375,"x_max":728.796875,"ha":825,"o":"m 728 304 l 649 224 l 512 363 q 383 331 458 331 q 256 363 310 331 l 119 224 l 40 304 l 177 441 q 150 553 150 493 q 184 673 150 621 l 40 818 l 119 898 l 267 749 q 321 766 291 759 q 384 773 351 773 q 447 766 417 773 q 501 749 477 759 l 649 898 l 728 818 l 585 675 q 612 618 604 648 q 621 553 621 587 q 591 441 621 491 l 728 304 m 384 682 q 280 643 318 682 q 243 551 243 604 q 279 461 243 499 q 383 423 316 423 q 487 461 449 423 q 525 553 525 500 q 490 641 525 605 q 384 682 451 682 "},"\u03ba":{"x_min":0,"x_max":632.328125,"ha":679,"o":"m 632 0 l 482 0 l 225 384 l 124 288 l 124 0 l 0 0 l 0 738 l 124 738 l 124 446 l 433 738 l 596 738 l 312 466 l 632 0 "},"p":{"x_min":0,"x_max":685,"ha":786,"o":"m 685 364 q 598 96 685 205 q 350 -23 504 -23 q 121 89 205 -23 l 121 -278 l 0 -278 l 0 738 l 121 738 l 121 633 q 220 726 159 691 q 351 761 280 761 q 598 636 504 761 q 685 364 685 522 m 557 371 q 501 560 557 481 q 330 651 437 651 q 162 559 223 651 q 108 366 108 479 q 162 177 108 254 q 333 87 224 87 q 502 178 441 87 q 557 371 557 258 "},"\u2021":{"x_min":0,"x_max":777,"ha":835,"o":"m 458 238 l 458 0 l 319 0 l 319 238 l 0 238 l 0 360 l 319 360 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 l 777 804 l 777 683 l 458 683 l 458 360 l 777 360 l 777 238 l 458 238 "},"\u03c8":{"x_min":0,"x_max":808,"ha":907,"o":"m 465 -278 l 341 -278 l 341 -15 q 87 102 180 -15 q 0 378 0 210 l 0 739 l 133 739 l 133 379 q 182 195 133 275 q 341 98 242 98 l 341 922 l 465 922 l 465 98 q 623 195 563 98 q 675 382 675 278 l 675 742 l 808 742 l 808 381 q 720 104 808 213 q 466 -13 627 -13 l 465 -278 "},"\u03b7":{"x_min":0.78125,"x_max":697,"ha":810,"o":"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 720 124 755 q 200 630 193 686 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 "}},"cssFontWeight":"normal","ascender":1189,"underlinePosition":-100,"cssFontStyle":"normal","boundingBox":{"yMin":-334,"xMin":-111,"yMax":1189,"xMax":1672},"resolution":1000,"original_font_information":{"postscript_name":"Helvetiker-Regular","version_string":"Version 1.00 2004 initial release","vendor_url":"http://www.magenta.gr/","full_font_name":"Helvetiker","font_family_name":"Helvetiker","copyright":"Copyright (c) \u039cagenta ltd, 2004","description":"","trademark":"","designer":"","designer_url":"","unique_font_identifier":"\u039cagenta ltd:Helvetiker:22-10-104","license_url":"http://www.ellak.gr/fonts/MgOpen/license.html","license_description":"Copyright (c) 2004 by MAGENTA Ltd. All Rights Reserved.\\r\\n\\r\\nPermission is hereby granted, free of charge, to any person obtaining a copy of the fonts accompanying this license (\\"Fonts\\") and associated documentation files (the \\"Font Software\\"), to reproduce and distribute the Font Software, including without limitation the rights to use, copy, merge, publish, distribute, and/or sell copies of the Font Software, and to permit persons to whom the Font Software is furnished to do so, subject to the following conditions: \\r\\n\\r\\nThe above copyright and this permission notice shall be included in all copies of one or more of the Font Software typefaces.\\r\\n\\r\\nThe Font Software may be modified, altered, or added to, and in particular the designs of glyphs or characters in the Fonts may be modified and additional glyphs or characters may be added to the Fonts, only if the fonts are renamed to names not containing the word \\"MgOpen\\", or if the modifications are accepted for inclusion in the Font Software itself by the each appointed Administrator.\\r\\n\\r\\nThis License becomes null and void to the extent applicable to Fonts or Font Software that has been modified and is distributed under the \\"MgOpen\\" name.\\r\\n\\r\\nThe Font Software may be sold as part of a larger software package but no copy of one or more of the Font Software typefaces may be sold by itself. \\r\\n\\r\\nTHE FONT SOFTWARE IS PROVIDED \\"AS IS\\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL MAGENTA OR PERSONS OR BODIES IN CHARGE OF ADMINISTRATION AND MAINTENANCE OF THE FONT SOFTWARE BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM OTHER DEALINGS IN THE FONT SOFTWARE.","manufacturer_name":"\u039cagenta ltd","font_sub_family_name":"Regular"},"descender":-334,"familyName":"Helvetiker","lineHeight":1522,"underlineThickness":50}');let el=(()=>{class n{static EVENT_DATA_ID="EventData";static GEOMETRIES_ID="Geometries";static LABELS_ID="Labels";scene;ignoreList;axis;axisLabels;etaPhiGrid;cartesianGrid;cartesianGridConfig={showXY:!0,showYZ:!0,showZX:!0,xDistance:0,yDistance:0,zDistance:0,sparsity:2};cartesianLabels;useCameraLight=!0;cameraLight;textFont=new Fq(MAe);labelTextLookCallbacks={};axesNumbers=[];constructor(t,i=!0){this.getScene(),this.ignoreList=t,this.axis=null,this.setLights(i)}setLights(t=!0){this.useCameraLight=t;const i=new YI(16777215,1.2);this.scene.add(i),this.useCameraLight?(this.cameraLight=new uC(16777215,.9),this.cameraLight.position.set(0,0,10),this.scene.add(this.cameraLight)):[[-100,-50,100],[100,50,-100],[-100,50,-100],[100,-50,100]].forEach(r=>{const s=new uC(16777215,.2);s.position.set(r[0],r[1],r[2]),this.scene.add(s)})}updateLights(t){this.useCameraLight&&this.cameraLight.position.copy(t.position)}getScene(){return this.scene||(this.scene=new YS),this.scene}getCleanScene(){const t=this.scene.clone(),i=[];return t.traverse(r=>{this.ignoreList.includes(r.type)&&i.push(r)}),t.remove(...i),t}setGeometryOpacity(t,i){i&&t&&t.traverse(r=>{r?.material&&(r.material.transparent=!0,r.material.opacity=i)})}changeObjectColor(t,i){t&&t.traverse(r=>{(r instanceof ua||r instanceof hc)&&(r.material instanceof pg||r.material instanceof xd||r.material instanceof Dc)&&r.material.color.set(i)})}objectVisibility(t,i){t&&(t.visible=i,t.traverse(r=>{i?(r.layers.enable(0),r.layers.disable(1)):(r.layers.disable(0),r.layers.enable(1))}))}getObjectPosition(t){return this.scene.getObjectByName(t)?.position}removeGeometry(t){this.getGeometries().remove(t)}removeLabel(t){const i=this.scene.getObjectByName(t);this.getObjectsGroup(n.LABELS_ID).remove(i)}scaleObject(t,i){t.scale.setScalar(i)}addEventDataTypeGroup(t){const i=this.getEventData();let r=this.scene.getObjectByName(t);return r||(r=new Wl),r.name=t,i.add(r),r}collectionFilter(t,i){const r=this.getScene().getObjectByName(n.EVENT_DATA_ID).getObjectByName(t);for(const s of Object.values(r.children))if(s.userData)for(const a of i){const l=s.userData[a.field];if(l){if(!a.cutPassed(l)){s.visible=!1;break}s.visible=!0}}}groupVisibility(t,i,r){const a=(r?this.scene.getObjectByName(r):this.scene).getObjectByName(t);for(const l of Object.values(a.children))l.visible=i}getObjectsGroup(t){let i=this.scene.getObjectByName(t);return null==i&&(i=new Wl,i.name=t,this.scene.add(i)),i}getEventData(){return this.getObjectsGroup(n.EVENT_DATA_ID)}getGeometries(){return this.getObjectsGroup(n.GEOMETRIES_ID)}clearEventData(){const t=this.getEventData();null!=t&&this.scene.remove(t),this.getEventData()}getText(t,i){const r=new xAe(t,{font:this.textFont,size:60,curveSegments:1,height:1});return new ua(r,new xd({color:new Cr(i)}))}setAxis(t,i=2e3,r=!0){if(null==this.axis){this.axis=new Wl;const s=new Cr(14037811),a=new Cr(3397171),l=new Cr(3355606),d=new Dc({color:s}),u=new Dc({color:a}),p=new Dc({color:l});let _=[new It(-i,0,0),new It(i,0,0)],S=(new no).setFromPoints(_);const R=new hc(S,d);this.axis.add(R),_=[new It(0,-i,0),new It(0,i,0)],S=(new no).setFromPoints(_);const H=new hc(S,u);this.axis.add(H),_=[new It(0,0,-i),new It(0,0,i)],S=(new no).setFromPoints(_);const re=new hc(S,p);this.axis.add(re),this.axis.name="gridline",this.axis.traverse(se=>se.name="gridline"),this.scene.add(this.axis)}if(this.axis.visible=t,r&&null==this.axisLabels){this.axisLabels=new Wl;const s=["X [cm]","Y [cm]","Z [cm]"],a=[16711680,65280,255];let l=0;for(const d of s){const u=this.getText(d,new Cr(a[l++]));this.axisLabels.add(u)}this.axisLabels.children[0].position.set(i+200,0,0),this.axisLabels.children[1].position.set(0,i+200,0),this.axisLabels.children[2].position.set(0,0,i+200),this.axisLabels.name="XYZ Labels",this.axisLabels.traverse(d=>d.name="XYZ Labels"),this.scene.add(this.axisLabels)}this.axisLabels.visible=t}createCartesianGrid(t=3e3){if(null==this.cartesianGrid){this.cartesianGrid=new Wl;const i=new Cr(14037811),r=new Cr(3397171),s=new Cr(3355606),a=new Yb({color:i,dashSize:.5,gapSize:.1,scale:.01}),l=new Yb({color:r,dashSize:.5,gapSize:.1,scale:.01}),d=new Yb({color:s,dashSize:.5,gapSize:.1,scale:.01});let u=new Wl;for(let S=-t;S<=t;S+=.1*t){u=new Wl;let R=[];for(let ce=-t;ce<=t;ce+=.1*t)R.push(new It(-t,ce,S)),R.push(new It(t,ce,S));let H=(new no).setFromPoints(R);const re=d;let se=new hc(H,re);se.computeLineDistances(),u.add(se),R=[];for(let ce=-t;ce<=t;ce+=.1*t)R.push(new It(ce,-t,S)),R.push(new It(ce,t,S));H=(new no).setFromPoints(R),se=new hc(H,re),se.computeLineDistances(),u.add(se),this.cartesianGrid.add(u)}let p=new Wl;for(let S=-t;S<=t;S+=.1*t){p=new Wl;let R=[];for(let ce=-t;ce<=t;ce+=.1*t)R.push(new It(S,ce,-t)),R.push(new It(S,ce,t));let H=(new no).setFromPoints(R);const re=a;let se=new hc(H,re);se.computeLineDistances(),p.add(se),R=[];for(let ce=-t;ce<=t;ce+=.1*t)R.push(new It(S,-t,ce)),R.push(new It(S,t,ce));H=(new no).setFromPoints(R),se=new hc(H,re),se.computeLineDistances(),p.add(se),this.cartesianGrid.add(p)}let _=new Wl;for(let S=-t;S<=t;S+=.1*t){_=new Wl;let R=[];for(let ce=-t;ce<=t;ce+=.1*t)R.push(new It(ce,S,-t)),R.push(new It(ce,S,t));let H=(new no).setFromPoints(R);const re=l;let se=new hc(H,re);se.computeLineDistances(),_.add(se),R=[];for(let ce=-t;ce<=t;ce+=.1*t)R.push(new It(-t,S,ce)),R.push(new It(t,S,ce));H=(new no).setFromPoints(R),se=new hc(H,re),se.computeLineDistances(),_.add(se),this.cartesianGrid.add(_)}this.cartesianGrid.name="gridline",this.cartesianGrid.traverse(S=>S.name="gridline"),this.cartesianGrid.children.forEach(S=>S.visible=!1),this.scene.add(this.cartesianGrid)}}setCartesianGrid(t,i,r){this.createCartesianGrid(i);for(let d=0;d<=62;d+=1)this.cartesianGrid.children[d].visible=!1;typeof r>"u"?r=this.cartesianGridConfig:this.cartesianGridConfig=r;const s=[10,31,52],a=[r.zDistance,r.xDistance,r.yDistance],l=[r.showXY,r.showYZ,r.showZX];if(t)for(let d=0;d<3;d+=1)if(l[d]){for(let u=s[d];u>=s[d]-10*a[d]/i;u-=r.sparsity)this.cartesianGrid.children[u].visible=t;for(let u=s[d];u<=s[d]+10*a[d]/i;u+=r.sparsity)this.cartesianGrid.children[u].visible=t}}getCartesianGridConfig(){return this.cartesianGridConfig}eventDataDepthTest(t){const i=this.getEventData();null!==i&&i.traverse(r=>{r.material&&(r.renderOrder=t?0:999,r.material.depthTest=t)})}wireframeGeometries(t){this.getGeometries().traverse(r=>{r.material&&(r.material.wireframe=t,t?(r.material.transparent=!0,r.material.opacity=.1):(r.material.transparent=!1,r.material.opacity=1))})}wireframeObjects(t,i){t.traverse(r=>{r.material&&(r.material.wireframe=i)})}scaleJets(t){t<=0||this.scene.getObjectByName("Jets").traverse(r=>{if("Jet"===r.name){const s=r.scale.x;r.scale.setScalar(t),r.position.divideScalar(s).multiplyScalar(t)}})}scaleChildObjects(t,i,r){this.scene.getObjectByName(t).traverse(a=>{0===a.children.length&&(r?a.scale[r]=i:a.scale.setScalar(i))})}addLabelToObject(t,i,r,s,a){this.scene.getObjectByProperty("uuid",i).userData.label=t;const d=this.getObjectsGroup(n.LABELS_ID),u=this.scene.getObjectByName(r);u&&d.remove(u);const p=this.getText(t,new Cr("#a8a8a8"));p.position.fromArray(s.toArray()),p.name=r,d.add(p),a.removeEventListener("change",this.labelTextLookCallbacks[i]),this.labelTextLookCallbacks[i]=()=>{p.lookAt(a.object.position)},this.labelTextLookCallbacks[i](),a.addEventListener("change",this.labelTextLookCallbacks[i])}translateCartesianGrid(t){this.createCartesianGrid();const i=t.length(),r=t.normalize();this.cartesianGrid.translateOnAxis(r,i)}translateCartesianLabels(t){this.createCartesianLabels();const i=t.length(),r=t.normalize();this.cartesianLabels.translateOnAxis(r,i),this.axis.translateOnAxis(r,i),this.axisLabels.translateOnAxis(r,i)}createCartesianLabels(t=3e3){if(null==this.cartesianLabels){this.cartesianLabels=new Wl,this.cartesianLabels.name="XYZ Labels";const i=new Cr(14037811),r=new Cr(3397171),s=new Cr(3355606),a=new xd({color:i,side:2}),l=new xd({color:r,side:2}),d=new xd({color:s,side:2});for(let u=-t;u<=t;u+=.1*t){const p=this.getText((u/10).toString(),i);p.position.set(u,40,0),this.axesNumbers.push(p),this.cartesianLabels.add(p);const _=new yp(10,30,10);_.translate(u,0,0);const S=new ua(_,a);this.cartesianLabels.add(S)}for(let u=-t;u<=t;u+=.1*t){const p=this.getText((u/10).toString(),r);p.position.set(-40,u,0),this.axesNumbers.push(p),this.cartesianLabels.add(p);const _=new yp(30,10,10);_.translate(0,u,0);const S=new ua(_,l);this.cartesianLabels.add(S)}for(let u=-t;u<=t;u+=.1*t){const p=this.getText((u/10).toString(),s);p.position.set(-40,0,u),this.axesNumbers.push(p),this.cartesianLabels.add(p);const _=new yp(30,10,10);_.translate(0,0,u);const S=new ua(_,d);this.cartesianLabels.add(S)}this.cartesianLabels.traverse(u=>u.name="XYZ Labels"),this.scene.add(this.cartesianLabels),this.cartesianLabels.children.forEach(u=>u.visible=!1),this.setAxis(!1,3e3)}}alignText(t){null!=this.cartesianLabels&&this.axesNumbers.forEach(i=>{i.lookAt(t.position)}),null!=this.axisLabels&&this.axisLabels.children.forEach(i=>i.lookAt(t.position))}showLabels(t){this.createCartesianLabels(),this.setAxis(t,3e3),this.cartesianLabels.children.forEach(i=>i.visible=t)}setEtaPhiGrid(t,i=3e3){if(null==this.etaPhiGrid){this.etaPhiGrid=new Wl;let r=[];const s=i,a=new Cr(255);for(let Te=-3;Te<=3;Te+=1){r.push(new It(0,0,0));const Ce=Ff.etaPhiToCartesian(s,Te,Math.PI/2),qe=this.getText("\u03b7="+Te.toPrecision(2),a);qe.position.set(Ce.x,Ce.y,Ce.z),qe.rotateOnWorldAxis(new It(0,1,0),Math.PI/2),this.etaPhiGrid.add(qe),r.push(Ce)}const l=(new no).setFromPoints(r),d=new Yb({color:a,dashSize:2,gapSize:1,scale:.01}),u=new hc(l,d);u.computeLineDistances();const p=2*Math.PI/8,_=["-\u03c0","-3\u03c0/4","-\u03c0/2,","-\u03c0/4","0","\u03c0/4","\u03c0/2,","3\u03c0/4"];let S=0;const R=new Cr(16711680);r=[];const H=.9*s;for(let Te=-Math.PI;Te<Math.PI;Te+=p){r.push(new It(0,0,0));const Ce=Ff.etaPhiToCartesian(H,0,Te),qe=this.getText("\u03c6="+_[S++],R);qe.position.set(Ce.x,Ce.y,Ce.z),this.etaPhiGrid.add(qe),r.push(Ce)}const re=(new no).setFromPoints(r),se=new Yb({color:R,dashSize:1,gapSize:1,scale:.01}),ce=new hc(re,se);ce.computeLineDistances(),this.etaPhiGrid.add(u),this.etaPhiGrid.add(ce),this.etaPhiGrid.name="gridline",this.etaPhiGrid.traverse(Te=>Te.name="gridline"),this.scene.add(this.etaPhiGrid)}this.etaPhiGrid.visible=t}getObjectByName(t){return this.scene.getObjectByName(t)}}return n})();class Oq extends no{next_track_id;positions;previous;next;colors;counter;track_id;side;indices_array;_attributes;constructor(){super(),this.type="TracksMesh",this.positions=[],this.previous=[],this.next=[],this.side=[],this.counter=[],this.track_id=[],this.colors=[],this.indices_array=[],this.next_track_id=0}addTrack(e,t){const i=this.next_track_id++,r=new Cr(t);this.previous.push(e[0].x,e[0].y,e[0].z),this.previous.push(e[0].x,e[0].y,e[0].z);for(let a=0;a<e.length;a++){const l=e[a],d=this.positions.length/3;this.positions.push(l.x,l.y,l.z),this.positions.push(l.x,l.y,l.z),this.side.push(1,-1),this.track_id.push(i,i),this.colors.push(r.r,r.g,r.b),this.colors.push(r.r,r.g,r.b),this.counter.push(a/e.length,a/e.length),a<e.length-1?(this.previous.push(l.x,l.y,l.z),this.previous.push(l.x,l.y,l.z),this.indices_array.push(d,d+1,d+2),this.indices_array.push(d+2,d+1,d+3)):a>0&&(this.next.push(l.x,l.y,l.z),this.next.push(l.x,l.y,l.z))}const s=e.length-1;return this.next.push(e[s].x,e[s].y,e[s].z),this.next.push(e[s].x,e[s].y,e[s].z),i}process(){this._attributes&&this._attributes.position.count===this.positions.length?(this._attributes.position.copyArray(new Float32Array(this.positions)),this._attributes.position.needsUpdate=!0,this._attributes.previous.copyArray(new Float32Array(this.previous)),this._attributes.previous.needsUpdate=!0,this._attributes.next.copyArray(new Float32Array(this.next)),this._attributes.next.needsUpdate=!0,this._attributes.side.copyArray(new Float32Array(this.side)),this._attributes.side.needsUpdate=!0,this._attributes.track_id.copyArray(new Int32Array(this.track_id)),this._attributes.track_id.needsUpdate=!0,this._attributes.color.copyArray(new Float32Array(this.colors)),this._attributes.color.needsUpdate=!0,this._attributes.counter.copyArray(new Float32Array(this.counter)),this._attributes.counter.needsUpdate=!0,this._attributes.index.copyArray(new Uint32Array(this.indices_array)),this._attributes.index.needsUpdate=!0):this._attributes={position:new No(new Float32Array(this.positions),3),previous:new No(new Float32Array(this.previous),3),next:new No(new Float32Array(this.next),3),side:new No(new Float32Array(this.side),1),track_id:new No(new Int32Array(this.track_id),1),color:new No(new Float32Array(this.colors),3),counter:new No(new Float32Array(this.counter),1),index:new No(new Uint32Array(this.indices_array),1)},this.setAttribute("position",this._attributes.position),this.setAttribute("previous",this._attributes.previous),this.setAttribute("next",this._attributes.next),this.setAttribute("side",this._attributes.side),this.setAttribute("track_id",this._attributes.track_id),this.setAttribute("color",this._attributes.color),this.setAttribute("counter",this._attributes.counter),this.setIndex(this._attributes.index),this.computeBoundingSphere(),this.computeBoundingBox()}}xa.tracks_vert=["attribute vec3 previous;","attribute vec3 next;","attribute int track_id;","attribute float side;","attribute vec3 color;","attribute float counter;","varying vec3 v_color;","varying float v_counter;","flat varying int v_track_id;","uniform vec2 resolution;","uniform float lineWidth;","void main() {","  vec2 aspect = vec2(resolution.x / resolution.y, 1.0);","","  v_color = color;","  v_counter = counter;","  v_track_id = track_id;","","  mat4 m = projectionMatrix * modelViewMatrix;","  vec4 finalPosition = m * vec4(position, 1.0);","  vec4 prevPos = m * vec4(previous, 1.0);","  vec4 nextPos = m * vec4(next, 1.0);","","  vec2 curP = finalPosition.xy / finalPosition.w * aspect;","  vec2 prevP = prevPos.xy / prevPos.w * aspect;","  vec2 nextP = nextPos.xy / nextPos.w * aspect;","","  vec2 dir;","  if (curP == prevP) dir = normalize(nextP - curP);","  else if (curP == nextP) dir = normalize(curP - prevP);","  else dir = normalize(curP - prevP);","","  vec2 normal = vec2(-dir.y, dir.x);","  normal.xy *= .5 * lineWidth;","  normal.x /= aspect.x;","  normal.xy *= finalPosition.w * 0.001;","  finalPosition.xy += normal.xy * side;","  gl_Position = finalPosition;","}"].join("\n"),xa.tracks_frag=["uniform float progress;","varying vec3 v_color;","varying float v_counter;","flat varying int v_track_id;","void main() {","  if (v_counter > progress) discard;","  gl_FragColor = vec4(v_color, 1.0);","}"].join("\n");class SAe extends Iu{isTracksMaterial;constructor(e){super({uniforms:Object.assign({},{lineWidth:{value:1},resolution:{value:new Qi(1,1)},progress:{value:1}}),vertexShader:xa.tracks_vert,fragmentShader:xa.tracks_vert}),this.isTracksMaterial=!0,this.type="TracksMaterial",Object.defineProperties(this,{lineWidth:{enumerable:!0,get:function(){return this.uniforms.lineWidth.value},set:function(t){this.uniforms.lineWidth.value=t}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(t){this.uniforms.resolution.value.copy(t)}},progress:{enumerable:!0,get:function(){return this.uniforms.progress.value},set:function(t){this.uniforms.progress.value=t}}}),this.setValues(e)}}class EAe{scene;activeCamera;rendererManager;constructor(e,t,i){this.scene=e,this.activeCamera=t,this.rendererManager=i,this.animateEvent=this.animateEvent.bind(this),this.animateEventWithClipping=this.animateEventWithClipping.bind(this)}getCameraTween(e,t=1e3,i){const r=new If(this.activeCamera.position).to({x:e[0],y:e[1],z:e[2]},t);return i&&r.easing(i),r}animateThroughEvent(e,t,i){const r=this.getCameraTween(e,1e3,lg.Cubic.Out),a=this.getCameraTween([0,0,e[2]],t),p=3*Math.PI/24,_=[];for(let Ce=1;Ce<=24;Ce++)_.push([500*Math.sin(p*Ce),0,500*Math.cos(p*Ce)]);const S=this.getCameraTween([0,0,500],t,lg.Cubic.Out);let R=S;const re=4*t/24;for(const Ce of _){const qe=this.getCameraTween(Ce,re);R.chain(qe),R=qe}const ce=this.getCameraTween([0,0,-e[2]],t,lg.Cubic.In),Te=this.getCameraTween(e,t,lg.Cubic.Out);Te.onComplete(()=>i?.()),Te.delay(500),r.chain(a),a.chain(S),R.chain(ce),ce.chain(Te),r.start()}animateEvent(e,t,i){const r=.25*e;e*=.75;const s=this.scene.getObjectByName(el.EVENT_DATA_ID),a=new $u(new It,0),l=[],d=[];s.traverse(S=>{if(S.geometry)if("Track"===S.name||"LineHit"===S.name){let R=S.geometry?.attributes?.position?.count;if(R)if(S.geometry instanceof Xb&&(R*=6),S.geometry instanceof Oq){S.material.progress=0;const H=new If(S.material).to({progress:1},e);H.onComplete(()=>{S.material.progress=1}),d.push(H)}else if(S.geometry instanceof no){const H=S.geometry.drawRange.count;S.geometry.setDrawRange(0,0);const re=new If(S.geometry.drawRange).to({count:R},e);re.onComplete(()=>{S.geometry.drawRange.count=H}),d.push(re)}}else if("Jet"===S.name){const R=new If({x:.01,y:.01,z:.01}).to({x:S.scale.x,y:S.scale.y,z:S.scale.z},e);R.onUpdate(H=>{const re=S.scale.x;S.scale.setScalar(H.x),S.position.divideScalar(re).multiplyScalar(H.x)}),d.push(R)}else{let H=S.position.equals(new It(0,0,0))?S.geometry.boundingSphere.center:S.position;"Hit"===S.name?(H=Array.from(S.geometry.attributes.position.array),S.geometry.deleteAttribute("position"),S.geometry.computeBoundingSphere()):S.visible=!1,l.push({eventObject:S,position:H})}});const u=new If(a).to({radius:3e3},e),p=S=>{l.forEach(R=>{if("Hit"===R.eventObject.name){const H=R.eventObject.geometry,se=this.getHitsPositions(R.position).filter(ce=>S.containsPoint((new It).fromArray(ce)));se.length>0&&(H.setAttribute("position",new No(new Float32Array([].concat(...se)),3)),H.computeBoundingSphere())}else S.containsPoint(R.position)&&(R.eventObject.visible=!0)})};u.onUpdate(p);const _=new If(a).to({radius:1e4},r);_.onUpdate(p),u.chain(_),d.push(u),d[0].onStart(()=>i?.());for(const S of d)S.easing(lg.Quartic.Out).start();_.onComplete(()=>{p(new $u(new It,1/0)),t?.()})}animateEventWithClipping(e,t,i,r=11e3){const s=this.scene.getObjectByName(el.EVENT_DATA_ID),a=new Gy(1,8,8),l=[],d=a.attributes.position,u=new It;for(let S=0;S<d.count;S++)u.fromBufferAttribute(d,S),l.push(new dA(u.clone(),0));const p=this.rendererManager.getMainRenderer().localClippingEnabled;p||this.rendererManager.setLocalClippingEnabled(!0),s.traverse(S=>{S.geometry&&S.material&&(S.material.clippingPlanes=l)});const _=[];for(const S of l){S.constant=0;const R=new If(S).to({constant:r},e);_.push(R)}_[0].onStart(()=>i?.());for(const S of _)S.start();_[_.length-1].onComplete(()=>{p||(this.rendererManager.getMainRenderer().localClippingEnabled=p),s.traverse(S=>{S.geometry&&S.material&&(S.material.clippingPlanes=null)}),t?.()})}collideParticles(e,t=10,i=5e3,r=new Cr(16777215),s){const a=new Gy(t,32,32),l=new xd({color:r,transparent:!0,opacity:0}),d=new ua(a,l),u=d.clone();d.position.setZ(i),u.position.setZ(-i);const p=[d,u];this.scene.add(...p);const _=[];for(const S of p){new If(S.material).to({opacity:1},300).start();const R=new If(S.position).to({z:0},e).start();_.push(R)}_[0].onComplete(()=>{this.scene.remove(...p),s?.()})}animateWithCollision(e,t,i){const r=this.scene.getObjectByName(el.EVENT_DATA_ID),s=r.getObjectByName("Track");let a;a=s instanceof Wl?s.children[0]?.material?.color:s?.material.color,r&&(r.visible=!1),this.collideParticles(1500,30,5e3,a,()=>{e(t,i,()=>{r&&(r.visible=!0)})})}animateEventWithCollision(e,t){this.animateWithCollision(this.animateEvent,e,t)}animateClippingWithCollision(e,t){this.animateWithCollision(this.animateEventWithClipping,e,t)}getHitsPositions(e){const t=[];for(let i=0;i<e.length;i+=3)t.push(e.slice(i,i+3));return t}animatePreset(e,t){const{positions:i,animateEventAfterInterval:r,collisionDuration:s}=e;r&&s&&(this.scene.getObjectByName(el.EVENT_DATA_ID).visible=!1,setTimeout(()=>{this.animateEventWithCollision(s)},r));const a=this.getCameraTween(i[0].position,i[0].duration??2e3,i[0].easing);let l=a;i.slice(1).forEach(({position:d,duration:u,easing:p})=>{const _=this.getCameraTween(d,u??2e3,p);l.chain(_),l=_}),l.onComplete(t),a.start()}}const Lq={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = opacity * texel;\n\n\n\t\t}"};class pE{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const TAe=new Q2(-1,1,1,-1,0,1),IAe=new class DAe extends no{constructor(){super(),this.setAttribute("position",new Ws([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Ws([0,2,0,0,2,0],2))}};class Nq{constructor(e){this._mesh=new ua(IAe,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,TAe)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class BAe extends pE{constructor(e,t){super(),this.textureID=void 0!==t?t:"tDiffuse",e instanceof Iu?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=x5.clone(e.uniforms),this.material=new Iu({name:void 0!==e.name?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new Nq(this.material)}render(e,t,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class Uq extends pE{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,i){const r=e.getContext(),s=e.state;let a,l;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0),this.inverse?(a=0,l=1):(a=1,l=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),s.buffers.stencil.setFunc(r.ALWAYS,a,4294967295),s.buffers.stencil.setClear(l),s.buffers.stencil.setLocked(!0),e.setRenderTarget(i),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.color.setMask(!0),s.buffers.depth.setMask(!0),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(r.EQUAL,1,4294967295),s.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),s.buffers.stencil.setLocked(!0)}}class PAe extends pE{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class RAe{constructor(e,t){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),void 0===t){const i=e.getSize(new Qi);this._width=i.width,this._height=i.height,(t=new ju(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:lA})).texture.name="EffectComposer.rt1"}else this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new BAe(Lq),this.copyPass.material.blending=0,this.clock=new jG}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){void 0===e&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let i=!1;for(let r=0,s=this.passes.length;r<s;r++){const a=this.passes[r];if(!1!==a.enabled){if(a.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),a.render(this.renderer,this.writeBuffer,this.readBuffer,e,i),a.needsSwap){if(i){const l=this.renderer.getContext(),d=this.renderer.state.buffers.stencil;d.setFunc(l.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),d.setFunc(l.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==Uq&&(a instanceof Uq?i=!0:a instanceof PAe&&(i=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(void 0===e){const t=this.renderer.getSize(new Qi);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const i=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(i,r),this.renderTarget2.setSize(i,r);for(let s=0;s<this.passes.length;s++)this.passes[s].setSize(i,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class kAe extends pE{constructor(e,t,i=null,r=null,s=null){super(),this.scene=e,this.camera=t,this.overrideMaterial=i,this.clearColor=r,this.clearAlpha=s,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Cr}render(e,t,i){const r=e.autoClear;let s,a;e.autoClear=!1,null!==this.overrideMaterial&&(a=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),null!==this.clearColor&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor)),null!==this.clearAlpha&&(s=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),1==this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:i),!0===this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),null!==this.clearColor&&e.setClearColor(this._oldClearColor),null!==this.clearAlpha&&e.setClearAlpha(s),null!==this.overrideMaterial&&(this.scene.overrideMaterial=a),e.autoClear=r}}class Xy extends pE{constructor(e,t,i,r){super(),this.renderScene=t,this.renderCamera=i,this.selectedObjects=void 0!==r?r:[],this.visibleEdgeColor=new Cr(1,1,1),this.hiddenEdgeColor=new Cr(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,this._visibilityCache=new Map,this.resolution=void 0!==e?new Qi(e.x,e.y):new Qi(256,256);const s=Math.round(this.resolution.x/this.downSampleRatio),a=Math.round(this.resolution.y/this.downSampleRatio);this.renderTargetMaskBuffer=new ju(this.resolution.x,this.resolution.y),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new P5,this.depthMaterial.side=2,this.depthMaterial.depthPacking=3201,this.depthMaterial.blending=0,this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=2,this.prepareMaskMaterial.fragmentShader=function p(_,S){return _.replace(/DEPTH_TO_VIEW_Z/g,(S.isPerspectiveCamera?"perspective":"orthographic")+"DepthToViewZ")}(this.prepareMaskMaterial.fragmentShader,this.renderCamera),this.renderTargetDepthBuffer=new ju(this.resolution.x,this.resolution.y,{type:lA}),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new ju(s,a,{type:lA}),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new ju(s,a,{type:lA}),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new ju(Math.round(s/2),Math.round(a/2),{type:lA}),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new ju(s,a,{type:lA}),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new ju(Math.round(s/2),Math.round(a/2),{type:lA}),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1,this.separableBlurMaterial1=this.getSeperableBlurMaterial(4),this.separableBlurMaterial1.uniforms.texSize.value.set(s,a),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this.getSeperableBlurMaterial(4),this.separableBlurMaterial2.uniforms.texSize.value.set(Math.round(s/2),Math.round(a/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=4,this.overlayMaterial=this.getOverlayMaterial();const u=Lq;this.copyUniforms=x5.clone(u.uniforms),this.materialCopy=new Iu({uniforms:this.copyUniforms,vertexShader:u.vertexShader,fragmentShader:u.fragmentShader,blending:0,depthTest:!1,depthWrite:!1}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new Cr,this.oldClearAlpha=1,this.fsQuad=new Nq(null),this.tempPulseColor1=new Cr,this.tempPulseColor2=new Cr,this.textureMatrix=new wo}dispose(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose(),this.depthMaterial.dispose(),this.prepareMaskMaterial.dispose(),this.edgeDetectionMaterial.dispose(),this.separableBlurMaterial1.dispose(),this.separableBlurMaterial2.dispose(),this.overlayMaterial.dispose(),this.materialCopy.dispose(),this.fsQuad.dispose()}setSize(e,t){this.renderTargetMaskBuffer.setSize(e,t),this.renderTargetDepthBuffer.setSize(e,t);let i=Math.round(e/this.downSampleRatio),r=Math.round(t/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(i,r),this.renderTargetBlurBuffer1.setSize(i,r),this.renderTargetEdgeBuffer1.setSize(i,r),this.separableBlurMaterial1.uniforms.texSize.value.set(i,r),i=Math.round(i/2),r=Math.round(r/2),this.renderTargetBlurBuffer2.setSize(i,r),this.renderTargetEdgeBuffer2.setSize(i,r),this.separableBlurMaterial2.uniforms.texSize.value.set(i,r)}changeVisibilityOfSelectedObjects(e){const t=this._visibilityCache;function i(r){r.isMesh&&(!0===e?r.visible=t.get(r):(t.set(r,r.visible),r.visible=e))}for(let r=0;r<this.selectedObjects.length;r++)this.selectedObjects[r].traverse(i)}changeVisibilityOfNonSelectedObjects(e){const t=this._visibilityCache,i=[];function r(a){a.isMesh&&i.push(a)}for(let a=0;a<this.selectedObjects.length;a++)this.selectedObjects[a].traverse(r);this.renderScene.traverse(function s(a){if(a.isMesh||a.isSprite){let l=!1;for(let d=0;d<i.length;d++)if(i[d].id===a.id){l=!0;break}if(!1===l){const d=a.visible;(!1===e||!0===t.get(a))&&(a.visible=e),t.set(a,d)}}else(a.isPoints||a.isLine)&&(!0===e?a.visible=t.get(a):(t.set(a,a.visible),a.visible=e))})}updateTextureMatrix(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)}render(e,t,i,r,s){if(this.selectedObjects.length>0){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const a=e.autoClear;e.autoClear=!1,s&&e.state.buffers.stencil.setTest(!1),e.setClearColor(16777215,1),this.changeVisibilityOfSelectedObjects(!1);const l=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,e.setRenderTarget(this.renderTargetDepthBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.changeVisibilityOfSelectedObjects(!0),this._visibilityCache.clear(),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value.set(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,e.setRenderTarget(this.renderTargetMaskBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this._visibilityCache.clear(),this.renderScene.background=l,this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,e.setRenderTarget(this.renderTargetMaskDownSampleBuffer),e.clear(),this.fsQuad.render(e),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),this.pulsePeriod>0){const d=.625+.75*Math.cos(.01*performance.now()/this.pulsePeriod)/2;this.tempPulseColor1.multiplyScalar(d),this.tempPulseColor2.multiplyScalar(d)}this.fsQuad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value.set(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=Xy.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,e.setRenderTarget(this.renderTargetBlurBuffer1),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=Xy.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=Xy.BlurDirectionX,e.setRenderTarget(this.renderTargetBlurBuffer2),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=Xy.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer2),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,s&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(i),this.fsQuad.render(e),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=a}this.renderToScreen&&(this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=i.texture,e.setRenderTarget(null),this.fsQuad.render(e))}getPrepareMaskMaterial(){return new Iu({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new Qi(.5,.5)},textureMatrix:{value:null}},vertexShader:"#include <morphtarget_pars_vertex>\n\t\t\t\t#include <skinning_pars_vertex>\n\n\t\t\t\tvarying vec4 projTexCoord;\n\t\t\t\tvarying vec4 vPosition;\n\t\t\t\tuniform mat4 textureMatrix;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <morphtarget_vertex>\n\t\t\t\t\t#include <skinning_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t\tvPosition = mvPosition;\n\n\t\t\t\t\tvec4 worldPosition = vec4( transformed, 1.0 );\n\n\t\t\t\t\t#ifdef USE_INSTANCING\n\n\t\t\t\t\t\tworldPosition = instanceMatrix * worldPosition;\n\n\t\t\t\t\t#endif\n\t\t\t\t\t\n\t\t\t\t\tworldPosition = modelMatrix * worldPosition;\n\n\t\t\t\t\tprojTexCoord = textureMatrix * worldPosition;\n\n\t\t\t\t}",fragmentShader:"#include <packing>\n\t\t\t\tvarying vec4 vPosition;\n\t\t\t\tvarying vec4 projTexCoord;\n\t\t\t\tuniform sampler2D depthTexture;\n\t\t\t\tuniform vec2 cameraNearFar;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tfloat depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));\n\t\t\t\t\tfloat viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );\n\t\t\t\t\tfloat depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;\n\t\t\t\t\tgl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);\n\n\t\t\t\t}"})}getEdgeDetectionMaterial(){return new Iu({uniforms:{maskTexture:{value:null},texSize:{value:new Qi(.5,.5)},visibleEdgeColor:{value:new It(1,1,1)},hiddenEdgeColor:{value:new It(1,1,1)}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\n\t\t\t\tuniform sampler2D maskTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec3 visibleEdgeColor;\n\t\t\t\tuniform vec3 hiddenEdgeColor;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tvec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);\n\t\t\t\t\tvec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);\n\t\t\t\t\tvec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);\n\t\t\t\t\tvec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);\n\t\t\t\t\tvec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);\n\t\t\t\t\tfloat diff1 = (c1.r - c2.r)*0.5;\n\t\t\t\t\tfloat diff2 = (c3.r - c4.r)*0.5;\n\t\t\t\t\tfloat d = length( vec2(diff1, diff2) );\n\t\t\t\t\tfloat a1 = min(c1.g, c2.g);\n\t\t\t\t\tfloat a2 = min(c3.g, c4.g);\n\t\t\t\t\tfloat visibilityFactor = min(a1, a2);\n\t\t\t\t\tvec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;\n\t\t\t\t\tgl_FragColor = vec4(edgeColor, 1.0) * vec4(d);\n\t\t\t\t}"})}getSeperableBlurMaterial(e){return new Iu({defines:{MAX_RADIUS:e},uniforms:{colorTexture:{value:null},texSize:{value:new Qi(.5,.5)},direction:{value:new Qi(.5,.5)},kernelRadius:{value:1}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec2 direction;\n\t\t\t\tuniform float kernelRadius;\n\n\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\n\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tfloat sigma = kernelRadius/2.0;\n\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, sigma);\n\t\t\t\t\tvec4 diffuseSum = texture2D( colorTexture, vUv) * weightSum;\n\t\t\t\t\tvec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);\n\t\t\t\t\tvec2 uvOffset = delta;\n\t\t\t\t\tfor( int i = 1; i <= MAX_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat x = kernelRadius * float(i) / float(MAX_RADIUS);\n\t\t\t\t\t\tfloat w = gaussianPdf(x, sigma);\n\t\t\t\t\t\tvec4 sample1 = texture2D( colorTexture, vUv + uvOffset);\n\t\t\t\t\t\tvec4 sample2 = texture2D( colorTexture, vUv - uvOffset);\n\t\t\t\t\t\tdiffuseSum += ((sample1 + sample2) * w);\n\t\t\t\t\t\tweightSum += (2.0 * w);\n\t\t\t\t\t\tuvOffset += delta;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = diffuseSum/weightSum;\n\t\t\t\t}"})}getOverlayMaterial(){return new Iu({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\n\t\t\t\tuniform sampler2D maskTexture;\n\t\t\t\tuniform sampler2D edgeTexture1;\n\t\t\t\tuniform sampler2D edgeTexture2;\n\t\t\t\tuniform sampler2D patternTexture;\n\t\t\t\tuniform float edgeStrength;\n\t\t\t\tuniform float edgeGlow;\n\t\t\t\tuniform bool usePatternTexture;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec4 edgeValue1 = texture2D(edgeTexture1, vUv);\n\t\t\t\t\tvec4 edgeValue2 = texture2D(edgeTexture2, vUv);\n\t\t\t\t\tvec4 maskColor = texture2D(maskTexture, vUv);\n\t\t\t\t\tvec4 patternColor = texture2D(patternTexture, 6.0 * vUv);\n\t\t\t\t\tfloat visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;\n\t\t\t\t\tvec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;\n\t\t\t\t\tvec4 finalColor = edgeStrength * maskColor.r * edgeValue;\n\t\t\t\t\tif(usePatternTexture)\n\t\t\t\t\t\tfinalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);\n\t\t\t\t\tgl_FragColor = finalColor;\n\t\t\t\t}",blending:2,depthTest:!1,depthWrite:!1,transparent:!0})}}Xy.BlurDirectionX=new Qi(1,0),Xy.BlurDirectionY=new Qi(0,1);class FAe{composer;camera;scene;defaultRenderPass;antialiasing=!0;render;constructor(e,t,i){this.composer=new RAe(i),this.camera=e,this.scene=t,this.defaultRenderPass=new kAe(this.scene,this.camera),this.composer.addPass(this.defaultRenderPass),this.render=this.antialiasing?this.antialiasRender:this.effectsRender}effectsRender(e,t){this.composer&&(this.defaultRenderPass.camera=t,this.defaultRenderPass.scene=e,this.composer.render())}antialiasRender(e,t){this.composer.renderer.render(e,t)}addOutlinePassForSelection(){const e=new Xy(new Qi(window.innerWidth,window.innerHeight),this.scene,this.camera);return e.overlayMaterial.blending=1,e.visibleEdgeColor.set(16777062),e.visibleEdgeColor.set(14635824),this.composer.addPass(e),e}removePass(e){const t=this.composer.passes.indexOf(e);this.composer.passes.splice(t,1)}setAntialiasing(e){this.antialiasing=e,this.render=this.antialiasing?this.antialiasRender:this.effectsRender}}let ax=(()=>{class n{static instance;phoenixMenuRoot;clippingEnabled=new mC(!1);startClippingAngle=new mC(0);openingClippingAngle=new mC(0);activeCamera;eventDisplay;eventMetadata={runNumber:"000",eventNumber:"000"};constructor(){return void 0===n.instance&&(n.instance=this),n.instance}static getInstance(){return n.instance}setPhoenixMenuRoot(t){this.phoenixMenuRoot=t,this.phoenixMenuRoot&&this.phoenixMenuRoot.addConfig("button",{label:"Save state",onClick:()=>{this.saveStateAsJSON()}}).addConfig("button",{label:"Load state",onClick:()=>{bq(i=>{this.loadStateFromJSON(JSON.parse(i))})}})}saveStateAsJSON(){const t={phoenixMenu:this.phoenixMenuRoot.getNodeState(),eventDisplay:{cameraPosition:this.activeCamera.position.toArray(),startClippingAngle:this.clippingEnabled.value?this.startClippingAngle.value:null,openingClippingAngle:this.clippingEnabled.value?this.openingClippingAngle.value:null}};fC(JSON.stringify(t),`run${this.eventMetadata.runNumber}_evt${this.eventMetadata.eventNumber}.json`)}loadStateFromJSON(t){const i="string"==typeof t?JSON.parse(t):t;if(i.phoenixMenu&&this.phoenixMenuRoot&&(this.phoenixMenuRoot.loadStateFromJSON(i.phoenixMenu),this.phoenixMenuRoot.configActive=!1),i.eventDisplay){this.activeCamera.position.fromArray(i.eventDisplay?.cameraPosition);const r=i.eventDisplay?.startClippingAngle,s=i.eventDisplay?.openingClippingAngle;(r||s)&&(this.setClippingEnabled(!0),this.eventDisplay.getUIManager().setClipping(!0),r&&this.eventDisplay.getUIManager().rotateStartAngleClipping(i.eventDisplay.startClippingAngle),s&&this.eventDisplay.getUIManager().rotateOpeningAngleClipping(i.eventDisplay.openingClippingAngle))}}setClippingEnabled(t){this.clippingEnabled.update(t)}setStartClippingAngle(t){this.startClippingAngle.update(t)}getStartClippingAngle(){return this.startClippingAngle.value}setOpeningClippingAngle(t){this.openingClippingAngle.update(t)}getOpeningClippingAngle(){return this.openingClippingAngle.value}setCamera(t){this.activeCamera=t}setEventDisplay(t){this.eventDisplay=t}}return n})(),LF=(()=>{class n{static instance;toLoad=[];loaded=[];onLoadCallbacks=[];onProgressCallbacks=[];progressItems={};constructor(){return void 0===n.instance&&(n.instance=this),n.instance}addLoadableItem(t=""){this.toLoad.push(t),this.progressItems[t]=0}itemLoaded(t=""){this.loaded.push(t),this.onProgress(t,100),this.toLoad.length===this.loaded.length&&this.toLoad.sort().join(",")===this.loaded.sort().join(",")&&(this.onLoadCallbacks.forEach(i=>i()),this.reset())}onProgress(t,i){this.progressItems[t]=i;const a=Object.values(this.progressItems).reduce((l,d)=>l+d,0)/Object.keys(this.progressItems).length;for(const l of this.onProgressCallbacks)l(a)}addLoadListener(t){this.onLoadCallbacks.push(t)}addLoadListenerWithCheck(t){this.toLoad.length>0&&this.toLoad.length!==this.loaded.length?this.onLoadCallbacks.push(t):t()}addProgressListener(t){this.onProgressCallbacks.push(t)}reset(){this.toLoad=[],this.loaded=[],this.onLoadCallbacks=[],this.onProgressCallbacks=[],this.progressItems={}}}return n})();class OAe{sceneManager;constructor(e){this.sceneManager=e}colorObjectsByProperty(e,t,i){this.sceneManager.getScene().getObjectByName(t).traverse(s=>{s.material?.color&&i(s.userData)&&s.material.color.set(e)})}collectionColor(e,t){const i=this.sceneManager.getScene().getObjectByName(el.EVENT_DATA_ID).getObjectByName(e);for(const r of Object.values(i.children))r.traverse(s=>{s.material?.color?.set(t)})}collectionColorRandom(e){const t=this.sceneManager.getScene().getObjectByName(el.EVENT_DATA_ID).getObjectByName(e);for(const i of Object.values(t.children))i.traverse(r=>{r.material?.color?.set(16777215*Math.random())})}colorTracksByVertex(e){const t=this.sceneManager.getScene();t.getObjectByName("Vertices").traverse(r=>{const{linkedTrackCollection:s,linkedTracks:a}=r.userData;if("Vertex"===r.name&&s===e&&a){const l=r.material.color,d=t.getObjectByName(s);a.forEach(u=>{d.children[u].traverse(p=>{p?.material?.color?.set(l)})})}})}}var mm=function(n){return n.VR="VR",n.AR="AR",n}(mm||{});class zq{sessionType;xrActive=!1;sessionInit;renderer;currentXRSession=null;onSessionEnded;cameraGroup;xrCamera;constructor(e){this.sessionType=e}setXRSession(e,t,i){this.renderer=e,this.onSessionEnded=i;const r=navigator?.xr,s=this.sessionType===mm.VR?"vr":"ar";r?.requestSession(`immersive-${s}`,this.sessionInit?.()).then(a=>{this.onXRSessionStarted.bind(this)(a),t?.()}).catch(a=>{console.error(`${s.toUpperCase()} Error:`,a)})}onXRSessionStarted(e){var t=this;return(0,Ee.A)(function*(){t.xrActive=!0,e.addEventListener("end",t.onXRSessionEnded.bind(t)),yield t.renderer.xr.setSession(e),t.currentXRSession=e})()}onXRSessionEnded(){this.xrActive=!1,this.currentXRSession.removeEventListener("end",this.onXRSessionEnded),this.currentXRSession=null,this.cameraGroup=void 0,this.onSessionEnded?.()}endXRSession(){this.currentXRSession?.end()}getCameraGroup(e){if(this.cameraGroup||(this.cameraGroup=new Wl),e&&this.xrActive){this.xrCamera=this.renderer.xr.getCamera().copy(new qV([e.clone()])),this.xrCamera.name="XR_CAMERA";const t=this.sessionType===mm.VR?this.xrCamera.position:new It(0,0,.1);this.cameraGroup.position.copy(t),this.cameraGroup.add(this.xrCamera)}return this.cameraGroup}getXRCamera(){return this.xrCamera}}const Cd={Handedness:Object.freeze({NONE:"none",LEFT:"left",RIGHT:"right"}),ComponentState:Object.freeze({DEFAULT:"default",TOUCHED:"touched",PRESSED:"pressed"}),ComponentProperty:Object.freeze({BUTTON:"button",X_AXIS:"xAxis",Y_AXIS:"yAxis",STATE:"state"}),ComponentType:Object.freeze({TRIGGER:"trigger",SQUEEZE:"squeeze",TOUCHPAD:"touchpad",THUMBSTICK:"thumbstick",BUTTON:"button"}),ButtonTouchThreshold:.05,AxisTouchThreshold:.1,VisualResponseProperty:Object.freeze({TRANSFORM:"transform",VISIBILITY:"visibility"})};function Hq(n){return NF.apply(this,arguments)}function NF(){return(NF=(0,Ee.A)(function*(n){const e=yield fetch(n);if(e.ok)return e.json();throw new Error(e.statusText)})).apply(this,arguments)}function UF(){return(UF=(0,Ee.A)(function*(n){if(!n)throw new Error("No basePath supplied");return yield Hq(`${n}/profilesList.json`)})).apply(this,arguments)}function zF(){return zF=(0,Ee.A)(function*(n,e,t=null,i=!0){if(!n)throw new Error("No xrInputSource supplied");if(!e)throw new Error("No basePath supplied");const r=yield function LAe(n){return UF.apply(this,arguments)}(e);let s;if(n.profiles.some(d=>{const u=r[d];return u&&(s={profileId:d,profilePath:`${e}/${u.path}`,deprecated:!!u.deprecated}),!!s}),!s){if(!t)throw new Error("No matching profile name found");const d=r[t];if(!d)throw new Error(`No matching profile name found and default profile "${t}" missing.`);s={profileId:t,profilePath:`${e}/${d.path}`,deprecated:!!d.deprecated}}const a=yield Hq(s.profilePath);let l;if(i){let d;if(d="any"===n.handedness?a.layouts[Object.keys(a.layouts)[0]]:a.layouts[n.handedness],!d)throw new Error(`No matching handedness, ${n.handedness}, in profile ${s.profileId}`);d.assetPath&&(l=s.profilePath.replace("profile.json",d.assetPath))}return{profile:a,assetPath:l}}),zF.apply(this,arguments)}const UAe={xAxis:0,yAxis:0,button:0,state:Cd.ComponentState.DEFAULT};class HAe{constructor(e){this.componentProperty=e.componentProperty,this.states=e.states,this.valueNodeName=e.valueNodeName,this.valueNodeProperty=e.valueNodeProperty,this.valueNodeProperty===Cd.VisualResponseProperty.TRANSFORM&&(this.minNodeName=e.minNodeName,this.maxNodeName=e.maxNodeName),this.value=0,this.updateFromComponent(UAe)}updateFromComponent({xAxis:e,yAxis:t,button:i,state:r}){const{normalizedXAxis:s,normalizedYAxis:a}=function zAe(n=0,e=0){let t=n,i=e;if(Math.sqrt(n*n+e*e)>1){const a=Math.atan2(e,n);t=Math.cos(a),i=Math.sin(a)}return{normalizedXAxis:.5*t+.5,normalizedYAxis:.5*i+.5}}(e,t);switch(this.componentProperty){case Cd.ComponentProperty.X_AXIS:this.value=this.states.includes(r)?s:.5;break;case Cd.ComponentProperty.Y_AXIS:this.value=this.states.includes(r)?a:.5;break;case Cd.ComponentProperty.BUTTON:this.value=this.states.includes(r)?i:0;break;case Cd.ComponentProperty.STATE:this.value=this.valueNodeProperty===Cd.VisualResponseProperty.VISIBILITY?this.states.includes(r):this.states.includes(r)?1:0;break;default:throw new Error(`Unexpected visualResponse componentProperty ${this.componentProperty}`)}}}class VAe{constructor(e,t){if(!(e&&t&&t.visualResponses&&t.gamepadIndices&&0!==Object.keys(t.gamepadIndices).length))throw new Error("Invalid arguments supplied");this.id=e,this.type=t.type,this.rootNodeName=t.rootNodeName,this.touchPointNodeName=t.touchPointNodeName,this.visualResponses={},Object.keys(t.visualResponses).forEach(i=>{const r=new HAe(t.visualResponses[i]);this.visualResponses[i]=r}),this.gamepadIndices=Object.assign({},t.gamepadIndices),this.values={state:Cd.ComponentState.DEFAULT,button:void 0!==this.gamepadIndices.button?0:void 0,xAxis:void 0!==this.gamepadIndices.xAxis?0:void 0,yAxis:void 0!==this.gamepadIndices.yAxis?0:void 0}}get data(){return{id:this.id,...this.values}}updateFromGamepad(e){if(this.values.state=Cd.ComponentState.DEFAULT,void 0!==this.gamepadIndices.button&&e.buttons.length>this.gamepadIndices.button){const t=e.buttons[this.gamepadIndices.button];this.values.button=t.value,this.values.button=this.values.button<0?0:this.values.button,this.values.button=this.values.button>1?1:this.values.button,t.pressed||1===this.values.button?this.values.state=Cd.ComponentState.PRESSED:(t.touched||this.values.button>Cd.ButtonTouchThreshold)&&(this.values.state=Cd.ComponentState.TOUCHED)}void 0!==this.gamepadIndices.xAxis&&e.axes.length>this.gamepadIndices.xAxis&&(this.values.xAxis=e.axes[this.gamepadIndices.xAxis],this.values.xAxis=this.values.xAxis<-1?-1:this.values.xAxis,this.values.xAxis=this.values.xAxis>1?1:this.values.xAxis,this.values.state===Cd.ComponentState.DEFAULT&&Math.abs(this.values.xAxis)>Cd.AxisTouchThreshold&&(this.values.state=Cd.ComponentState.TOUCHED)),void 0!==this.gamepadIndices.yAxis&&e.axes.length>this.gamepadIndices.yAxis&&(this.values.yAxis=e.axes[this.gamepadIndices.yAxis],this.values.yAxis=this.values.yAxis<-1?-1:this.values.yAxis,this.values.yAxis=this.values.yAxis>1?1:this.values.yAxis,this.values.state===Cd.ComponentState.DEFAULT&&Math.abs(this.values.yAxis)>Cd.AxisTouchThreshold&&(this.values.state=Cd.ComponentState.TOUCHED)),Object.values(this.visualResponses).forEach(t=>{t.updateFromComponent(this.values)})}}class GAe{constructor(e,t,i){if(!e)throw new Error("No xrInputSource supplied");if(!t)throw new Error("No profile supplied");this.xrInputSource=e,this.assetUrl=i,this.id=t.profileId,this.layoutDescription=t.layouts[e.handedness],this.components={},Object.keys(this.layoutDescription.components).forEach(r=>{this.components[r]=new VAe(r,this.layoutDescription.components[r])}),this.updateFromGamepad()}get gripSpace(){return this.xrInputSource.gripSpace}get targetRaySpace(){return this.xrInputSource.targetRaySpace}get data(){const e=[];return Object.values(this.components).forEach(t=>{e.push(t.data)}),e}updateFromGamepad(){Object.values(this.components).forEach(e=>{e.updateFromGamepad(this.xrInputSource.gamepad)})}}class WAe extends Pl{constructor(){super(),this.motionController=null,this.envMap=null}setEnvironmentMap(e){return this.envMap==e||(this.envMap=e,this.traverse(t=>{t.isMesh&&(t.material.envMap=this.envMap,t.material.needsUpdate=!0)})),this}updateMatrixWorld(e){super.updateMatrixWorld(e),this.motionController&&(this.motionController.updateFromGamepad(),Object.values(this.motionController.components).forEach(t=>{Object.values(t.visualResponses).forEach(i=>{const{valueNode:r,minNode:s,maxNode:a,value:l,valueNodeProperty:d}=i;r&&(d===Cd.VisualResponseProperty.VISIBILITY?r.visible=l:d===Cd.VisualResponseProperty.TRANSFORM&&(r.quaternion.slerpQuaternions(s.quaternion,a.quaternion,l),r.position.lerpVectors(s.position,a.position,l)))})}))}}function Vq(n,e){(function jAe(n,e){Object.values(n.components).forEach(t=>{const{type:i,touchPointNodeName:r,visualResponses:s}=t;if(i===Cd.ComponentType.TOUCHPAD)if(t.touchPointNode=e.getObjectByName(r),t.touchPointNode){const a=new Gy(.001),l=new xd({color:255}),d=new ua(a,l);t.touchPointNode.add(d)}else console.warn(`Could not find touch dot, ${t.touchPointNodeName}, in touchpad component ${t.id}`);Object.values(s).forEach(a=>{const{valueNodeName:l,minNodeName:d,maxNodeName:u,valueNodeProperty:p}=a;if(p===Cd.VisualResponseProperty.TRANSFORM){if(a.minNode=e.getObjectByName(d),a.maxNode=e.getObjectByName(u),!a.minNode)return void console.warn(`Could not find ${d} in the model`);if(!a.maxNode)return void console.warn(`Could not find ${u} in the model`)}a.valueNode=e.getObjectByName(l),a.valueNode||console.warn(`Could not find ${l} in the model`)})})})(n.motionController,e),n.envMap&&e.traverse(t=>{t.isMesh&&(t.material.envMap=n.envMap,t.material.needsUpdate=!0)}),n.add(e)}class $Ae{constructor(e=null,t=null){this.gltfLoader=e,this.path="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles",this._assetCache={},this.onLoad=t,this.gltfLoader||(this.gltfLoader=new c4)}setPath(e){return this.path=e,this}createControllerModel(e){const t=new WAe;let i=null;return e.addEventListener("connected",r=>{const s=r.data;"tracked-pointer"!==s.targetRayMode||!s.gamepad||function NAe(n,e){return zF.apply(this,arguments)}(s,this.path,"generic-trigger").then(({profile:a,assetPath:l})=>{t.motionController=new GAe(s,a,l);const d=this._assetCache[t.motionController.assetUrl];if(d)i=d.scene.clone(),Vq(t,i),this.onLoad&&this.onLoad(i);else{if(!this.gltfLoader)throw new Error("GLTFLoader not set.");this.gltfLoader.setPath(""),this.gltfLoader.load(t.motionController.assetUrl,u=>{this._assetCache[t.motionController.assetUrl]=u,i=u.scene.clone(),Vq(t,i),this.onLoad&&this.onLoad(i)},null,()=>{throw new Error(`Asset ${t.motionController.assetUrl} missing or malformed.`)})}}).catch(a=>{console.warn(a)})}),e.addEventListener("disconnected",()=>{t.motionController=null,t.remove(i),i=null}),t}}let Gq=(()=>class n extends zq{static SESSION_TYPE="immersive-vr";controller1;controller2;controllerGrip1;controllerGrip2;onControllerSelectStart;onControllerSelectEnd;constructor(){super(mm.VR),this.sessionInit=()=>({optionalFeatures:["local-floor","bounded-floor","hand-tracking"]})}setXRSession(t,i,r){super.setXRSession(t,i,r),this.setupVRControls()}onXRSessionEnded(){super.onXRSessionEnded(),this.controller1?.removeEventListener("selectstart",this.onControllerSelectStart),this.controller1?.removeEventListener("selectend",this.onControllerSelectEnd)}setupVRControls(){this.controller1=this.renderer.xr.getController(0),this.getCameraGroup().add(this.controller1),this.controller2=this.renderer.xr.getController(1),this.getCameraGroup().add(this.controller2);const t=new $Ae;this.controllerGrip1=this.renderer.xr.getControllerGrip(0),this.controllerGrip1.add(t.createControllerModel(this.controllerGrip1)),this.getCameraGroup().add(this.controllerGrip1),this.controllerGrip2=this.renderer.xr.getControllerGrip(1),this.controllerGrip2.add(t.createControllerModel(this.controllerGrip2)),this.getCameraGroup().add(this.controllerGrip2);const i=(new no).setFromPoints([new It(0,0,0),new It(0,0,-1)]),r=new fg(i);r.name="line",r.scale.z=50,this.controller1.add(r.clone()),this.controller2.add(r.clone());const a=new It;let l;this.onControllerSelectStart=()=>{console.log("Select: c1 position "+this.controller1.position.toArray().join(", ")),console.log("Select: CG position "+this.cameraGroup.position.toArray().join(", ")),l=setInterval(()=>{this.moveInDirection(a,30)},20)},this.onControllerSelectEnd=()=>{clearInterval(l)},this.controller1.addEventListener("selectstart",this.onControllerSelectStart),this.controller1.addEventListener("selectend",this.onControllerSelectEnd)}moveInDirection(t,i){this.xrCamera?.getWorldDirection(t),this.cameraGroup.position.addScaledVector(t,i),this.xrCamera.position.addScaledVector(t,i)}})(),HF=(()=>{class n extends zq{scene;camera;static SESSION_TYPE="immersive-ar";static enableDomOverlay=!0;previousValues={sceneScale:1,cameraNear:10};constructor(t,i){super(mm.AR),this.scene=t,this.camera=i,this.previousValues.sceneScale=t.scale.x,this.previousValues.cameraNear=i.near,this.sessionInit=()=>n.enableDomOverlay?{optionalFeatures:["dom-overlay"],domOverlay:{root:document.body}}:{}}onXRSessionStarted(t){var i=()=>super.onXRSessionStarted,r=this;return(0,Ee.A)(function*(){document.body.style.setProperty("background-color","transparent"),r.previousValues.sceneScale=r.scene.scale.x,r.previousValues.cameraNear=r.camera.near,r.scaleScene(1e-5),r.camera.near=.01,r.renderer.xr.setReferenceSpaceType("local"),yield i().call(r,t)})()}onXRSessionEnded(){document.body.style.removeProperty("background-color"),this.scaleScene(this.previousValues.sceneScale),this.camera.near=this.previousValues.cameraNear,super.onXRSessionEnded()}scaleScene(t){[el.EVENT_DATA_ID,el.GEOMETRIES_ID,el.LABELS_ID].forEach(i=>{this.scene.getObjectByName(i)?.scale.setScalar(t)})}}return n})();!function(){const n=Pl.prototype.updateMatrixWorld;Pl.prototype.updateMatrixWorld=function(){this.visible&&n.apply(this)}}();class XAe{infoLogger;sceneManager;rendererManager;controlsManager;exportManager;importManager;selectionManager;animationsManager;effectsManager;vrManager;arManager;colorManager;loadingManager;stateManager;animationLoop;uiLoop;isEventData;isVisible;show3DPointsCallback;shiftCartesianGridCallback;show3DDistanceCallback;origin=new It(0,0,0);ignoreList=[(new YI).type,(new uC).type,(new dq).type];clipPlanes;clipIntersection;prev3DCoord=null;prev2DCoord;prevIntersectName=null;distanceCanvas=null;displayColor="black";mousemoveCallback;originChanged=new Ls;shiftGrid=!1;stopShifting=new Ls;constructor(e){this.infoLogger=e,this.rendererManager=new cme,this.loadingManager=new LF}init(e){this.clipPlanes=[new dA(new It(0,1,0),0),new dA(new It(0,-1,0),0)],this.sceneManager=new el(this.ignoreList),this.exportManager=new Rme,this.importManager=new vAe(this.clipPlanes,el.EVENT_DATA_ID,el.GEOMETRIES_ID),this.rendererManager.init(e.elementId),this.controlsManager=new lme(this.rendererManager,e.defaultView),this.controlsManager.hideTubeTracksOnZoom(this.sceneManager.getScene(),200),this.effectsManager=new FAe(this.controlsManager.getMainCamera(),this.sceneManager.getScene(),this.rendererManager.getMainRenderer()),this.animationsManager=new EAe(this.sceneManager.getScene(),this.controlsManager.getActiveCamera(),this.rendererManager),this.vrManager=new Gq,this.arManager=new HF(this.sceneManager.getScene(),this.controlsManager.getMainCamera()),this.colorManager=new OAe(this.sceneManager),this.getSelectionManager().init(this.controlsManager.getMainCamera(),this.sceneManager.getScene(),this.effectsManager,this.infoLogger),(new ax).setCamera(this.controlsManager.getActiveCamera())}setDarkColor(e){this.displayColor=e?"white":"black"}updateControls(){this.controlsManager.getActiveControls().update(),this.controlsManager.updateSync(),$z()}setAnimationLoop(e){this.uiLoop=e,this.animationLoop=()=>{this.uiLoop(),this.updateControls(),this.sceneManager.alignText(this.controlsManager.getMainCamera()),this.render()},this.rendererManager.getMainRenderer().setAnimationLoop(this.animationLoop)}stopAnimationLoop(){this.rendererManager.getMainRenderer().setAnimationLoop(null)}render(){this.rendererManager.render(this.sceneManager.getScene(),this.controlsManager.getOverlayCamera()),this.effectsManager.render(this.sceneManager.getScene(),this.controlsManager.getMainCamera()),this.sceneManager.updateLights(this.controlsManager.getActiveCamera())}xrRender(e){this.uiLoop(),this.rendererManager.getMainRenderer().render(this.sceneManager.getScene(),e.getXRCamera()),this.sceneManager.updateLights(e.getXRCamera())}getSceneManager(){return this.sceneManager||(this.sceneManager=new el(this.ignoreList)),this.sceneManager}autoRotate(e){this.controlsManager.getActiveControls().autoRotate=e}filterRayIntersect(){null==this.stateManager&&(this.stateManager=new ax),null==this.isEventData&&(this.isEventData=e=>{let t=!1;return e.object.traverseAncestors(i=>{"EventData"==i.name&&(t=!0)}),t}),null==this.isVisible&&(this.isVisible=e=>{let t=!1;return this.clipPlanes.length>0&&(this.clipIntersection?this.clipPlanes.every(i=>i.distanceToPoint(e.point)<0)||(t=!0):this.clipPlanes.every(i=>i.distanceToPoint(e.point)>0)&&(t=!0)),t})}originChangedEmit(e){this.origin=e,this.originChanged.emit(e)}getMainIntersect(e){const t=this.controlsManager.getMainCamera(),i=this.sceneManager.getScene(),r=new ZG,s=new Qi;s.x=e.clientX/window.innerWidth*2-1,s.y=-e.clientY/window.innerHeight*2+1,r.setFromCamera(s,t);const a=r.intersectObjects(i.children);let l=null;if(a.length>0&&!this.stateManager.clippingEnabled.value){for(const d of a)if("gridline"!=d.object.name&&"XYZ Labels"!=d.object.name){l=d;break}}else for(const d of a)if("gridline"!=d.object.name&&"XYZ Labels"!=d.object.name){if(this.isEventData(d)){l=d;break}if(this.isVisible(d)){l=d;break}}return l}show3DMousePoints(e){this.filterRayIntersect(),null==this.show3DPointsCallback&&(this.show3DPointsCallback=t=>{const i=this.getMainIntersect(t);if(null!=i){const r=i.point,s=new It;s.subVectors(r,this.origin);const a=document.getElementsByTagName("app-root")[0],l=document.createElement("p");l.id="3dcoordinates",l.innerHTML=`${i.object.name}:\r\n\tOriginal (cm): (${Math.round(r.x/10)}, ${Math.round(r.y/10)}, ${Math.round(r.z/10)})`,(0!=this.origin.x||0!=this.origin.y||0!=this.origin.z)&&(l.innerHTML+=`\r\n\tCompared to grid (cm): (${Math.round(s.x/10)}, ${Math.round(s.y/10)}, ${Math.round(s.z/10)})`),l.style.whiteSpace="pre",l.style.color=this.displayColor,l.style.position="absolute",l.style.top=`${t.clientY+10}px`,l.style.left=`${t.clientX+10}px`;const d=document.createElement("div");d.id="circledDot",d.style.width="1rem",d.style.height="1rem",d.style.position="absolute",d.style.top=`calc(${t.clientY}px - 0.5rem)`,d.style.left=`calc(${t.clientX}px - 0.5rem)`,d.style.border=`2px solid ${this.displayColor}`,d.style.borderRadius="0.5rem",d.innerHTML=`\n            <div \n              style = "\n                background-color: ${this.displayColor}; \n                margin-top: calc(0.3rem - 1.5px);\n                margin-left: calc(0.3rem - 1.5px); \n                width: 0.4rem; \n                height: 0.4rem; \n                border-radius: 0.5rem;\n              "\n            ></div>`,a?.appendChild(l),a?.appendChild(d),setTimeout(()=>{document.getElementById("3dcoordinates").remove(),document.getElementById("circledDot").remove()},3e3)}}),e?window.addEventListener("click",this.show3DPointsCallback):window.removeEventListener("click",this.show3DPointsCallback)}show3DDistance(e){this.prev3DCoord=null,this.prev2DCoord=null,this.prevIntersectName=null,this.filterRayIntersect(),null==this.show3DDistanceCallback&&(this.mousemoveCallback=this.drawLine.bind(this),this.show3DDistanceCallback=t=>{const i=this.getMainIntersect(t);if(null!=i)if(null==this.prev3DCoord){this.prev3DCoord=i.point,this.prev2DCoord=new Qi(t.clientX,t.clientY),this.prevIntersectName=i.object.name;const r=document.getElementsByTagName("app-root")[0];null==this.distanceCanvas&&(this.distanceCanvas=document.createElement("canvas"),this.distanceCanvas.id="3Ddistance",this.distanceCanvas.width=window.innerWidth,this.distanceCanvas.height=window.innerHeight,this.distanceCanvas.style.position="absolute",this.distanceCanvas.style.bottom="0"),r?.appendChild(this.distanceCanvas);const s=this.distanceCanvas.getContext("2d");s.strokeStyle=this.displayColor,s.lineWidth=2,s.fillStyle=this.displayColor,s.beginPath(),s.arc(this.prev2DCoord.x,this.prev2DCoord.y,7,0,2*Math.PI),s.stroke(),s.beginPath(),s.arc(this.prev2DCoord.x,this.prev2DCoord.y,3,0,2*Math.PI),s.fill(),window.addEventListener("mousemove",this.mousemoveCallback)}else{window.removeEventListener("mousemove",this.mousemoveCallback);const r=i.point.distanceTo(this.prev3DCoord)/10;this.drawLine(t);const s=this.distanceCanvas.getContext("2d");s.beginPath(),s.arc(t.clientX,t.clientY,7,0,2*Math.PI),s.stroke(),s.beginPath(),s.arc(t.clientX,t.clientY,3,0,2*Math.PI),s.fill(),s.font="15px Arial";let a=this.prev2DCoord.x,l=t.clientX;const d=this.prev2DCoord.y,u=t.clientY,p=(a+l)/2,_=(d+u)/2,R=(a-l)/(u-d),H=25/Math.sqrt(1+R*R),se=p+H,ce=_+R*H;this.prev2DCoord.x>t.clientX?(a=this.prev2DCoord.x+20,l=t.clientX-s.measureText(i.object.name).width-20):(a=this.prev2DCoord.x-s.measureText(this.prevIntersectName).width-20,l=t.clientX+20),s.fillText(this.prevIntersectName,a,d),s.fillText(i.object.name,l,u),s.fillText(r.toFixed(2).toString()+"cm",se,ce),setTimeout(()=>{null!=document.getElementById("3Ddistance")&&document.getElementById("3Ddistance").remove(),this.distanceCanvas.getContext("2d").clearRect(0,0,this.distanceCanvas.width,this.distanceCanvas.height)},3e3),this.prev3DCoord=null,this.prev2DCoord=null,this.prevIntersectName=null}}),e?window.addEventListener("click",this.show3DDistanceCallback):(window.removeEventListener("click",this.show3DDistanceCallback),window.removeEventListener("mousemove",this.mousemoveCallback),null!=document.getElementById("3Ddistance")&&document.getElementById("3Ddistance").remove(),null!=this.distanceCanvas&&this.distanceCanvas.getContext("2d").clearRect(0,0,this.distanceCanvas.width,this.distanceCanvas.height))}drawLine(e){const t=this.distanceCanvas.getContext("2d");t.clearRect(0,0,this.distanceCanvas.width,this.distanceCanvas.height),t.beginPath(),t.moveTo(this.prev2DCoord.x,this.prev2DCoord.y),t.lineTo(e.clientX,e.clientY),t.stroke(),t.beginPath(),t.arc(this.prev2DCoord.x,this.prev2DCoord.y,7,0,2*Math.PI),t.stroke(),t.beginPath(),t.arc(this.prev2DCoord.x,this.prev2DCoord.y,3,0,2*Math.PI),t.fill()}shiftCartesianGrid(){this.shiftGrid=!0,this.filterRayIntersect(),null==this.shiftCartesianGridCallback&&(this.shiftCartesianGridCallback=t=>{const i=this.getMainIntersect(t);null!=i&&this.originChangedEmit(i.point)});const e=t=>{window.removeEventListener("click",this.shiftCartesianGridCallback),this.stopShifting.emit(!0),this.shiftGrid=!1,window.removeEventListener("contextmenu",e)};window.addEventListener("click",this.shiftCartesianGridCallback),window.addEventListener("contextmenu",e)}setClipping(e){this.rendererManager.setLocalClippingEnabled(e)}setClippingAngle(e,t){const i=new Gc;i.setFromAxisAngle(new It(0,0,1),e*Math.PI/180),this.clipPlanes[0].normal.set(0,-1,0).applyQuaternion(i);const r=new Gc;r.setFromAxisAngle(new It(0,0,1),(e+t)*Math.PI/180),this.clipPlanes[1].normal.set(0,1,0).applyQuaternion(r),(this.clipIntersection&&t>180||!this.clipIntersection&&t<180)&&(this.clipIntersection=t<180,this.sceneManager.getGeometries().traverse(a=>{a instanceof ua&&a.material instanceof ld&&(a.material.clipIntersection=this.clipIntersection)}))}animateCameraTransform(e,t,i){this.animateCameraPosition(e,i),this.animateCameraTarget(t,i)}swapCameras(e){let t;t=e?"OrthographicCamera":"PerspectiveCamera",this.controlsManager.getMainCamera().type!==t&&this.controlsManager.swapControls()}loadOBJGeometry(e,t,i,r,s=!0,a=!0){var l=this;return(0,Ee.A)(function*(){const d=l.sceneManager.getGeometries(),u=yield l.importManager.loadOBJGeometry(e,t,i,r,a),{object:p}=u;return p.visible=s,d.add(p),u})()}loadGLTFGeometry(e,t,i,r,s){var a=this;return(0,Ee.A)(function*(){const l=a.sceneManager.getGeometries(),d=yield a.importManager.loadGLTFGeometry(e,t,i,r,s);for(const{object:u}of d)l.add(u),a.infoLogger.add(t,"Loaded GLTF scene");return d})()}parseOBJGeometry(e,t,i=!0){const r=this.sceneManager.getGeometries(),s=this.importManager.parseOBJGeometry(e,t);return s.visible=i,r.add(s),{object:s}}parseGLTFGeometry(e){var t=this;return(0,Ee.A)(function*(){const i=yield t.importManager.parseGLTFGeometry(e.name);for(const{object:r}of i)t.sceneManager.getGeometries().add(r),t.infoLogger.add(e.name,"Parsed GLTF geometry");return i})()}parsePhnxScene(e){var t=this;return(0,Ee.A)(function*(){yield t.importManager.parsePhnxScene(e,(r,s)=>{t.sceneManager.getScene().add(r),t.sceneManager.getScene().add(s)})})()}loadJSONGeometry(e,t,i,r,s=!0){var a=this;return(0,Ee.A)(function*(){const l=a.sceneManager.getGeometries(),{object:d}=yield a.importManager.loadJSONGeometry(e,t,i,r);return d.visible=s,l.add(d),{object:d}})()}exportSceneToOBJ(){const e=this.sceneManager.getCleanScene();this.exportManager.exportSceneToOBJ(e)}exportGeometriesToGLTF(){this.exportManager.exportGeometriesToGLTF(this.sceneManager.getGeometries())}exportPhoenixScene(){const e=this.sceneManager.getCleanScene();this.exportManager.exportPhoenixScene(e,this.sceneManager.getEventData(),this.sceneManager.getGeometries())}fixOverlayView(e){this.rendererManager.setFixOverlay(e)}setSelectedObjectDisplay(e){this.getSelectionManager().setSelectedObject(e)}eventDataDepthTest(e){this.sceneManager.eventDataDepthTest(e)}enableSelecting(e){this.getSelectionManager().setSelecting(e)}clearEventData(){this.sceneManager.clearEventData()}addEventDataTypeGroup(e){return this.sceneManager.addEventDataTypeGroup(e)}setOverlayRenderer(e){this.rendererManager&&this.rendererManager.setOverlayRenderer(e)}zoomTo(e,t){this.controlsManager.zoomTo(e,t)}getSelectionManager(){return this.selectionManager||(this.selectionManager=new bAe),this.selectionManager}animateCameraPosition(e,t){const i=new If(this.controlsManager.getActiveCamera().position);i.to({x:e[0],y:e[1],z:e[2]},t),i.start()}animateCameraTarget(e,t){const i=new If(this.controlsManager.getActiveControls().target);i.to({x:e[0],y:e[1],z:e[2]},t),i.start()}getActiveObjectId(){return this.getSelectionManager().getActiveObjectId()}lookAtObject(e,t=!1){1==t?this.controlsManager.lookAtObject(e,this.getSceneManager().getGeometries(),1e3):this.controlsManager.lookAtObject(e,this.getSceneManager().getEventData(),0)}getObjectPosition(e){return this.controlsManager.getObjectPosition(e,this.getSceneManager().getScene())}highlightObject(e,t=!1){this.selectionManager.highlightObject(e,1==t?this.getSceneManager().getGeometries():this.getSceneManager().getEventData())}enableHighlighting(){this.selectionManager.enableHighlighting()}disableHighlighting(){this.selectionManager.disableHighlighting()}enableKeyboardControls(){document.addEventListener("keydown",e=>{if(!["input","textarea"].includes(e.target?.tagName.toLowerCase())&&e.shiftKey)switch(e.code){case"KeyR":this.autoRotate(!this.controlsManager.getActiveControls().autoRotate);break;case"Equal":this.zoomTo(1/1.2,100);break;case"Minus":this.zoomTo(1.2,100);break;case"KeyC":this.setClipping(!this.rendererManager.getLocalClipping()),this.rendererManager.getLocalClipping()&&this.setClippingAngle(0,180);break;case"KeyV":{const i="OrthographicCamera"===this.controlsManager.getMainCamera().type;this.swapCameras(!i);break}}})}animateThroughEvent(e,t,i){this.animationsManager.animateThroughEvent(e,t,i)}animatePreset(e,t){this.animationsManager.animatePreset(e,t)}animateEventWithCollision(e,t){this.animationsManager.animateEventWithCollision(e,t)}animateClippingWithCollision(e,t){this.animationsManager.animateClippingWithCollision(e,t)}saveBlob=function(){const e=document.createElement("a");return document.body.appendChild(e),e.style.display="none",function(i,r){const s=window.URL.createObjectURL(i);e.href=s,e.download=r,e.click()}}();croppedSize(e,t,i,r){let s=t,a=e;return i*t<r*e?s=r*e/i:a=i*t/r,{width:a,height:s}}checkScreenShotCanvasSize(e,t,i="Stretch"){const r=this.rendererManager.getMainRenderer(),s=new Qi;r.getSize(s);const a=this.croppedSize(e,t,s.width,s.height),l=window.devicePixelRatio,d=r.getContext(),u=d.getParameter(d.MAX_RENDERBUFFER_SIZE);return a.width/l<u&&a.height/l<u}makeScreenShot(e,t,i="Strech"){const r=this.rendererManager.getMainRenderer(),s=new Qi;r.getSize(s);const a=this.croppedSize(e,t,s.width,s.height),l=(a.height-t)/2,d=(a.width-e)/2,u=getComputedStyle(document.body).getPropertyValue("--phoenix-background-color"),p=window.devicePixelRatio,_=document.getElementById("screenshotCanvas");_.width=e,_.height=t,_.style.width=(e/p).toString()+"px",_.style.height=(t/p).toString()+"px";const S=_.getContext("2d");S.fillStyle=u,S.fillRect(0,0,e,t),r.setSize(a.width/p,a.height/p,!1),this.render(),S.drawImage(r.domElement,d,l,e,t,0,0,e,t),r.setSize(s.width,s.height,!1),this.render();const R=document.getElementById("experimentInfo");if(null!=R){const H=R.clientHeight*a.height/s.height,re=R.clientWidth*a.width/s.width;sme()(R,{backgroundColor:u,ignoreElements:se=>"CANVAS"==se.tagName}).then(se=>{se.toBlob(ce=>{S.drawImage(se,H/6,H/6,re,H),_.toBlob(Te=>{const Ce=document.createElement("a");document.body.appendChild(Ce),Ce.style.display="none";const qe=window.URL.createObjectURL(Te);Ce.href=qe,Ce.download="screencapture.png",Ce.click()})})})}}initXRSession(e,t){const i=e===mm.VR?this.vrManager:this.arManager,r=this.rendererManager.getMainRenderer();r.xr.enabled=!0,r.xr.setAnimationLoop(this.xrRender.bind(this,i)),i.setXRSession(r,()=>{const a=i.getCameraGroup(this.controlsManager.getMainCamera());this.sceneManager.getScene().add(a)},t)}endXRSession(e){const t=e===mm.VR?this.vrManager:this.arManager;this.sceneManager.getScene().remove(t.getCameraGroup());const i=this.rendererManager.getMainRenderer();i.xr.setAnimationLoop(null),i.xr.enabled=!1,t.endXRSession()}getObjectByName(e){return this.getSceneManager().getScene().getObjectByName(e)}setAntialiasing(e){this.effectsManager.setAntialiasing(e)}addGeometryFromParameters(e){this.loadingManager.addLoadableItem("geom_from_params");const t=this.getSceneManager().getScene(),l=e.NumPhiEl,d=e.NumZEl,u=e.Radius,p=e.MinZ,_=e.MaxZ,S=e.TiltAngle,R=e.ZTiltAngle,H=e.PhiOffset,re=e.Colour,ce=new yp(e.Xdim,e.Ydim,e.Zdim),Te=new xd({color:re,opacity:.5,transparent:!0}),Ce=(_-p)/d,qe=2*Math.PI/l;let wt=p+Ce/2;const gt=Math.PI/2;let Et;for(let Xt=0;Xt<d;Xt++){let Un=H;for(let Ct=0;Ct<l;Ct++){Un+=qe,Et=new It(u*Math.cos(Un),u*Math.sin(Un),wt);const Kt=new ua(ce.clone(),Te);Kt.matrix.makeRotationFromEuler(new M0(R,0,gt+Un+S)),Kt.matrix.setPosition(Et),Kt.matrixAutoUpdate=!1,t.add(Kt)}wt+=Ce}this.loadingManager.itemLoaded("geom_from_params")}addLabelToObject(e,t,i){const r=this.controlsManager.getActiveControls(),s=this.getObjectPosition(t);this.getSceneManager().addLabelToObject(e,t,i,s,r)}getColorManager(){return this.colorManager}}var YAe=Se(6955),KAe=Se.n(YAe),AC=function(n){return n[n.NotForced=0]="NotForced",n[n.On=1]="On",n[n.Off=2]="Off",n}(AC||{});class Qd{icon;cameraPos;cameraTarget;name;clipping;clippingStartAngle;clippingOpeningAngle;constructor(e,t,i,r,s=AC.NotForced,a=0,l=0){this.name=e,this.cameraPos=t,this.cameraTarget=i,this.icon=r,this.clipping=s,this.clippingStartAngle=a,this.clippingOpeningAngle=l}getIconURL(){return"assets/preset-views/"+this.icon+".svg#"+this.icon}}function gC(n,e){var t=n.__state.conversionName.toString(),i=Math.round(n.r),r=Math.round(n.g),s=Math.round(n.b),a=n.a,l=Math.round(n.h),d=n.s.toFixed(1),u=n.v.toFixed(1);if(e||"THREE_CHAR_HEX"===t||"SIX_CHAR_HEX"===t){for(var p=n.hex.toString(16);p.length<6;)p="0"+p;return"#"+p}return"CSS_RGB"===t?"rgb("+i+","+r+","+s+")":"CSS_RGBA"===t?"rgba("+i+","+r+","+s+","+a+")":"HEX"===t?"0x"+n.hex.toString(16):"RGB_ARRAY"===t?"["+i+","+r+","+s+"]":"RGBA_ARRAY"===t?"["+i+","+r+","+s+","+a+"]":"RGB_OBJ"===t?"{r:"+i+",g:"+r+",b:"+s+"}":"RGBA_OBJ"===t?"{r:"+i+",g:"+r+",b:"+s+",a:"+a+"}":"HSV_OBJ"===t?"{h:"+l+",s:"+d+",v:"+u+"}":"HSVA_OBJ"===t?"{h:"+l+",s:"+d+",v:"+u+",a:"+a+"}":"unknown format"}var qq=Array.prototype.forEach,mE=Array.prototype.slice,Sr={BREAK:{},extend:function(e){return this.each(mE.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(r){this.isUndefined(t[r])||(e[r]=t[r])}.bind(this))},this),e},defaults:function(e){return this.each(mE.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(r){this.isUndefined(e[r])&&(e[r]=t[r])}.bind(this))},this),e},compose:function(){var e=mE.call(arguments);return function(){for(var t=mE.call(arguments),i=e.length-1;i>=0;i--)t=[e[i].apply(this,t)];return t[0]}},each:function(e,t,i){if(e)if(qq&&e.forEach&&e.forEach===qq)e.forEach(t,i);else if(e.length===e.length+0){var s,r=void 0;for(r=0,s=e.length;r<s;r++)if(r in e&&t.call(i,e[r],r)===this.BREAK)return}else for(var a in e)if(t.call(i,e[a],a)===this.BREAK)return},defer:function(e){setTimeout(e,0)},debounce:function(e,t,i){var r=void 0;return function(){var s=this,a=arguments,d=i||!r;clearTimeout(r),r=setTimeout(function l(){r=null,i||e.apply(s,a)},t),d&&e.apply(s,a)}},toArray:function(e){return e.toArray?e.toArray():mE.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(n){function e(t){return n.apply(this,arguments)}return e.toString=function(){return n.toString()},e}(function(n){return isNaN(n)}),isArray:Array.isArray||function(n){return n.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return e instanceof Function}},JAe=[{litmus:Sr.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:gC},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:gC},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:gC},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:gC}}},{litmus:Sr.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:Sr.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:Sr.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(Sr.isNumber(e.r)&&Sr.isNumber(e.g)&&Sr.isNumber(e.b)&&Sr.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(Sr.isNumber(e.r)&&Sr.isNumber(e.g)&&Sr.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(Sr.isNumber(e.h)&&Sr.isNumber(e.s)&&Sr.isNumber(e.v)&&Sr.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(Sr.isNumber(e.h)&&Sr.isNumber(e.s)&&Sr.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],AE=void 0,u4=void 0,h4=function(){u4=!1;var e=arguments.length>1?Sr.toArray(arguments):arguments[0];return Sr.each(JAe,function(t){if(t.litmus(e))return Sr.each(t.conversions,function(i,r){if(AE=i.read(e),!1===u4&&!1!==AE)return u4=AE,AE.conversionName=r,AE.conversion=i,Sr.BREAK}),Sr.BREAK}),u4},Qq=void 0,gE={hsv_to_rgb:function(e,t,i){var r=Math.floor(e/60)%6,s=e/60-Math.floor(e/60),a=i*(1-t),l=i*(1-s*t),d=i*(1-(1-s)*t),u=[[i,d,a],[l,i,a],[a,i,d],[a,l,i],[d,a,i],[i,a,l]][r];return{r:255*u[0],g:255*u[1],b:255*u[2]}},rgb_to_hsv:function(e,t,i){var r=Math.min(e,t,i),s=Math.max(e,t,i),a=s-r,l=void 0;return 0===s?{h:NaN,s:0,v:0}:(l=e===s?(t-i)/a:t===s?2+(i-e)/a:4+(e-t)/a,(l/=6)<0&&(l+=1),{h:360*l,s:a/s,v:s/255})},rgb_to_hex:function(e,t,i){var r=this.hex_with_component(0,2,e);return r=this.hex_with_component(r,1,t),this.hex_with_component(r,0,i)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(e,t,i){return i<<(Qq=8*t)|e&~(255<<Qq)}},ege="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},mg=function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")},Ag=function(){function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}(),Yy=function n(e,t,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var s=Object.getPrototypeOf(e);return null===s?void 0:n(s,t,i)}if("value"in r)return r.value;var a=r.get;return void 0===a?void 0:a.call(i)},Ky=function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(n,e):n.__proto__=e)},Zy=function(n,e){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?n:e},ku=function(){function n(){if(mg(this,n),this.__state=h4.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return Ag(n,[{key:"toString",value:function(){return gC(this)}},{key:"toHexString",value:function(){return gC(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),n}();function VF(n,e,t){Object.defineProperty(n,e,{get:function(){return"RGB"===this.__state.space||ku.recalculateRGB(this,e,t),this.__state[e]},set:function(r){"RGB"!==this.__state.space&&(ku.recalculateRGB(this,e,t),this.__state.space="RGB"),this.__state[e]=r}})}function GF(n,e){Object.defineProperty(n,e,{get:function(){return"HSV"===this.__state.space||ku.recalculateHSV(this),this.__state[e]},set:function(i){"HSV"!==this.__state.space&&(ku.recalculateHSV(this),this.__state.space="HSV"),this.__state[e]=i}})}ku.recalculateRGB=function(n,e,t){if("HEX"===n.__state.space)n.__state[e]=gE.component_from_hex(n.__state.hex,t);else{if("HSV"!==n.__state.space)throw new Error("Corrupted color state");Sr.extend(n.__state,gE.hsv_to_rgb(n.__state.h,n.__state.s,n.__state.v))}},ku.recalculateHSV=function(n){var e=gE.rgb_to_hsv(n.r,n.g,n.b);Sr.extend(n.__state,{s:e.s,v:e.v}),Sr.isNaN(e.h)?Sr.isUndefined(n.__state.h)&&(n.__state.h=0):n.__state.h=e.h},ku.COMPONENTS=["r","g","b","h","s","v","hex","a"],VF(ku.prototype,"r",2),VF(ku.prototype,"g",1),VF(ku.prototype,"b",0),GF(ku.prototype,"h"),GF(ku.prototype,"s"),GF(ku.prototype,"v"),Object.defineProperty(ku.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(ku.prototype,"hex",{get:function(){return"HEX"!==this.__state.space&&(this.__state.hex=gE.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var Jy=function(){function n(e,t){mg(this,n),this.initialValue=e[t],this.domElement=document.createElement("div"),this.object=e,this.property=t,this.__onChange=void 0,this.__onFinishChange=void 0}return Ag(n,[{key:"onChange",value:function(t){return this.__onChange=t,this}},{key:"onFinishChange",value:function(t){return this.__onFinishChange=t,this}},{key:"setValue",value:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),n}(),Wq={};Sr.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(n,e){Sr.each(n,function(t){Wq[t]=e})});var nge=/(\d+(\.\d+)?)px/;function I0(n){if("0"===n||Sr.isUndefined(n))return 0;var e=n.match(nge);return Sr.isNull(e)?0:parseFloat(e[1])}var Oi={makeSelectable:function(e,t){void 0===e||void 0===e.style||(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,i){var r=i,s=t;Sr.isUndefined(s)&&(s=!0),Sr.isUndefined(r)&&(r=!0),e.style.position="absolute",s&&(e.style.left=0,e.style.right=0),r&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,i,r){var s=i||{},a=Wq[t];if(!a)throw new Error("Event type "+t+" not supported.");var l=document.createEvent(a);switch(a){case"MouseEvents":l.initMouseEvent(t,s.bubbles||!1,s.cancelable||!0,window,s.clickCount||1,0,0,s.x||s.clientX||0,s.y||s.clientY||0,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var p=l.initKeyboardEvent||l.initKeyEvent;Sr.defaults(s,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),p(t,s.bubbles||!1,s.cancelable,window,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.keyCode,s.charCode);break;default:l.initEvent(t,s.bubbles||!1,s.cancelable||!0)}Sr.defaults(l,r),e.dispatchEvent(l)},bind:function(e,t,i,r){return e.addEventListener?e.addEventListener(t,i,r||!1):e.attachEvent&&e.attachEvent("on"+t,i),Oi},unbind:function(e,t,i,r){return e.removeEventListener?e.removeEventListener(t,i,r||!1):e.detachEvent&&e.detachEvent("on"+t,i),Oi},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var i=e.className.split(/ +/);-1===i.indexOf(t)&&(i.push(t),e.className=i.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return Oi},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var i=e.className.split(/ +/),r=i.indexOf(t);-1!==r&&(i.splice(r,1),e.className=i.join(" "))}else e.className=void 0;return Oi},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return I0(t["border-left-width"])+I0(t["border-right-width"])+I0(t["padding-left"])+I0(t["padding-right"])+I0(t.width)},getHeight:function(e){var t=getComputedStyle(e);return I0(t["border-top-width"])+I0(t["border-bottom-width"])+I0(t["padding-top"])+I0(t["padding-bottom"])+I0(t.height)},getOffset:function(e){var t=e,i={left:0,top:0};if(t.offsetParent)do{i.left+=t.offsetLeft,i.top+=t.offsetTop,t=t.offsetParent}while(t);return i},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},qF=function(n){function e(t,i){mg(this,e);var r=Zy(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),s=r;return r.__prev=r.getValue(),r.__checkbox=document.createElement("input"),r.__checkbox.setAttribute("type","checkbox"),Oi.bind(r.__checkbox,"change",function a(){s.setValue(!s.__prev)},!1),r.domElement.appendChild(r.__checkbox),r.updateDisplay(),r}return Ky(e,n),Ag(e,[{key:"setValue",value:function(i){var r=Yy(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,i);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),r}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),Yy(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(Jy),jq=function(n){function e(t,i,r){mg(this,e);var s=Zy(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),a=r,l=s;if(s.__select=document.createElement("select"),Sr.isArray(a)){var d={};Sr.each(a,function(u){d[u]=u}),a=d}return Sr.each(a,function(u,p){var _=document.createElement("option");_.innerHTML=p,_.setAttribute("value",u),l.__select.appendChild(_)}),s.updateDisplay(),Oi.bind(s.__select,"change",function(){l.setValue(this.options[this.selectedIndex].value)}),s.domElement.appendChild(s.__select),s}return Ky(e,n),Ag(e,[{key:"setValue",value:function(i){var r=Yy(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,i);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),r}},{key:"updateDisplay",value:function(){return Oi.isActive(this.__select)?this:(this.__select.value=this.getValue(),Yy(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this))}}]),e}(Jy),$q=function(n){function e(t,i){mg(this,e);var r=Zy(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),s=r;function a(){s.setValue(s.__input.value)}return r.__input=document.createElement("input"),r.__input.setAttribute("type","text"),Oi.bind(r.__input,"keyup",a),Oi.bind(r.__input,"change",a),Oi.bind(r.__input,"blur",function l(){s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}),Oi.bind(r.__input,"keydown",function(d){13===d.keyCode&&this.blur()}),r.updateDisplay(),r.domElement.appendChild(r.__input),r}return Ky(e,n),Ag(e,[{key:"updateDisplay",value:function(){return Oi.isActive(this.__input)||(this.__input.value=this.getValue()),Yy(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(Jy);function Xq(n){var e=n.toString();return e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}var QF=function(n){function e(t,i,r){mg(this,e);var s=Zy(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),a=r||{};return s.__min=a.min,s.__max=a.max,s.__step=a.step,s.__impliedStep=Sr.isUndefined(s.__step)?0===s.initialValue?1:Math.pow(10,Math.floor(Math.log(Math.abs(s.initialValue))/Math.LN10))/10:s.__step,s.__precision=Xq(s.__impliedStep),s}return Ky(e,n),Ag(e,[{key:"setValue",value:function(i){var r=i;return void 0!==this.__min&&r<this.__min?r=this.__min:void 0!==this.__max&&r>this.__max&&(r=this.__max),void 0!==this.__step&&r%this.__step!=0&&(r=Math.round(r/this.__step)*this.__step),Yy(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,r)}},{key:"min",value:function(i){return this.__min=i,this}},{key:"max",value:function(i){return this.__max=i,this}},{key:"step",value:function(i){return this.__step=i,this.__impliedStep=i,this.__precision=Xq(i),this}}]),e}(Jy),_E=function(n){function e(t,i,r){mg(this,e);var s=Zy(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,r));s.__truncationSuspended=!1;var a=s,l=void 0;function u(){a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}function _(H){var re=l-H.clientY;a.setValue(a.getValue()+re*a.__impliedStep),l=H.clientY}function S(){Oi.unbind(window,"mousemove",_),Oi.unbind(window,"mouseup",S),u()}return s.__input=document.createElement("input"),s.__input.setAttribute("type","text"),Oi.bind(s.__input,"change",function d(){var H=parseFloat(a.__input.value);Sr.isNaN(H)||a.setValue(H)}),Oi.bind(s.__input,"blur",function p(){u()}),Oi.bind(s.__input,"mousedown",function R(H){Oi.bind(window,"mousemove",_),Oi.bind(window,"mouseup",S),l=H.clientY}),Oi.bind(s.__input,"keydown",function(H){13===H.keyCode&&(a.__truncationSuspended=!0,this.blur(),a.__truncationSuspended=!1,u())}),s.updateDisplay(),s.domElement.appendChild(s.__input),s}return Ky(e,n),Ag(e,[{key:"updateDisplay",value:function(){return this.__input.value=this.__truncationSuspended?this.getValue():function ige(n,e){var t=Math.pow(10,e);return Math.round(n*t)/t}(this.getValue(),this.__precision),Yy(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(QF);function Yq(n,e,t,i,r){return i+(n-e)/(t-e)*(r-i)}var f4=function(n){function e(t,i,r,s,a){mg(this,e);var l=Zy(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,{min:r,max:s,step:a})),d=l;function p(re){re.preventDefault();var se=d.__background.getBoundingClientRect();return d.setValue(Yq(re.clientX,se.left,se.right,d.__min,d.__max)),!1}function _(){Oi.unbind(window,"mousemove",p),Oi.unbind(window,"mouseup",_),d.__onFinishChange&&d.__onFinishChange.call(d,d.getValue())}function R(re){var se=re.touches[0].clientX,ce=d.__background.getBoundingClientRect();d.setValue(Yq(se,ce.left,ce.right,d.__min,d.__max))}function H(){Oi.unbind(window,"touchmove",R),Oi.unbind(window,"touchend",H),d.__onFinishChange&&d.__onFinishChange.call(d,d.getValue())}return l.__background=document.createElement("div"),l.__foreground=document.createElement("div"),Oi.bind(l.__background,"mousedown",function u(re){document.activeElement.blur(),Oi.bind(window,"mousemove",p),Oi.bind(window,"mouseup",_),p(re)}),Oi.bind(l.__background,"touchstart",function S(re){1===re.touches.length&&(Oi.bind(window,"touchmove",R),Oi.bind(window,"touchend",H),R(re))}),Oi.addClass(l.__background,"slider"),Oi.addClass(l.__foreground,"slider-fg"),l.updateDisplay(),l.__background.appendChild(l.__foreground),l.domElement.appendChild(l.__background),l}return Ky(e,n),Ag(e,[{key:"updateDisplay",value:function(){var i=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*i+"%",Yy(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(QF),WF=function(n){function e(t,i,r){mg(this,e);var s=Zy(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),a=s;return s.__button=document.createElement("div"),s.__button.innerHTML=void 0===r?"Fire":r,Oi.bind(s.__button,"click",function(l){return l.preventDefault(),a.fire(),!1}),Oi.addClass(s.__button,"button"),s.domElement.appendChild(s.__button),s}return Ky(e,n),Ag(e,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),e}(Jy),p4=function(n){function e(t,i){mg(this,e);var r=Zy(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));r.__color=new ku(r.getValue()),r.__temp=new ku(0);var s=r;r.domElement=document.createElement("div"),Oi.makeSelectable(r.domElement,!1),r.__selector=document.createElement("div"),r.__selector.className="selector",r.__saturation_field=document.createElement("div"),r.__saturation_field.className="saturation-field",r.__field_knob=document.createElement("div"),r.__field_knob.className="field-knob",r.__field_knob_border="2px solid ",r.__hue_knob=document.createElement("div"),r.__hue_knob.className="hue-knob",r.__hue_field=document.createElement("div"),r.__hue_field.className="hue-field",r.__input=document.createElement("input"),r.__input.type="text",r.__input_textShadow="0 1px 1px ",Oi.bind(r.__input,"keydown",function(re){13===re.keyCode&&_.call(this)}),Oi.bind(r.__input,"blur",_),Oi.bind(r.__selector,"mousedown",function(){Oi.addClass(this,"drag").bind(window,"mouseup",function(){Oi.removeClass(s.__selector,"drag")})}),Oi.bind(r.__selector,"touchstart",function(){Oi.addClass(this,"drag").bind(window,"touchend",function(){Oi.removeClass(s.__selector,"drag")})});var a=document.createElement("div");function l(re){R(re),Oi.bind(window,"mousemove",R),Oi.bind(window,"touchmove",R),Oi.bind(window,"mouseup",u),Oi.bind(window,"touchend",u)}function d(re){H(re),Oi.bind(window,"mousemove",H),Oi.bind(window,"touchmove",H),Oi.bind(window,"mouseup",p),Oi.bind(window,"touchend",p)}function u(){Oi.unbind(window,"mousemove",R),Oi.unbind(window,"touchmove",R),Oi.unbind(window,"mouseup",u),Oi.unbind(window,"touchend",u),S()}function p(){Oi.unbind(window,"mousemove",H),Oi.unbind(window,"touchmove",H),Oi.unbind(window,"mouseup",p),Oi.unbind(window,"touchend",p),S()}function _(){var re=h4(this.value);!1!==re?(s.__color.__state=re,s.setValue(s.__color.toOriginal())):this.value=s.__color.toString()}function S(){s.__onFinishChange&&s.__onFinishChange.call(s,s.__color.toOriginal())}function R(re){-1===re.type.indexOf("touch")&&re.preventDefault();var se=s.__saturation_field.getBoundingClientRect(),ce=re.touches&&re.touches[0]||re,qe=(ce.clientX-se.left)/(se.right-se.left),wt=1-(ce.clientY-se.top)/(se.bottom-se.top);return wt>1?wt=1:wt<0&&(wt=0),qe>1?qe=1:qe<0&&(qe=0),s.__color.v=wt,s.__color.s=qe,s.setValue(s.__color.toOriginal()),!1}function H(re){-1===re.type.indexOf("touch")&&re.preventDefault();var se=s.__hue_field.getBoundingClientRect(),Ce=1-((re.touches&&re.touches[0]||re).clientY-se.top)/(se.bottom-se.top);return Ce>1?Ce=1:Ce<0&&(Ce=0),s.__color.h=360*Ce,s.setValue(s.__color.toOriginal()),!1}return Sr.extend(r.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),Sr.extend(r.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:r.__field_knob_border+(r.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),Sr.extend(r.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),Sr.extend(r.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),Sr.extend(a.style,{width:"100%",height:"100%",background:"none"}),Kq(a,"top","rgba(0,0,0,0)","#000"),Sr.extend(r.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),function sge(n){n.style.background="",n.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",n.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}(r.__hue_field),Sr.extend(r.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:r.__input_textShadow+"rgba(0,0,0,0.7)"}),Oi.bind(r.__saturation_field,"mousedown",l),Oi.bind(r.__saturation_field,"touchstart",l),Oi.bind(r.__field_knob,"mousedown",l),Oi.bind(r.__field_knob,"touchstart",l),Oi.bind(r.__hue_field,"mousedown",d),Oi.bind(r.__hue_field,"touchstart",d),r.__saturation_field.appendChild(a),r.__selector.appendChild(r.__field_knob),r.__selector.appendChild(r.__saturation_field),r.__selector.appendChild(r.__hue_field),r.__hue_field.appendChild(r.__hue_knob),r.domElement.appendChild(r.__input),r.domElement.appendChild(r.__selector),r.updateDisplay(),r}return Ky(e,n),Ag(e,[{key:"updateDisplay",value:function(){var i=h4(this.getValue());if(!1!==i){var r=!1;Sr.each(ku.COMPONENTS,function(l){if(!Sr.isUndefined(i[l])&&!Sr.isUndefined(this.__color.__state[l])&&i[l]!==this.__color.__state[l])return r=!0,{}},this),r&&Sr.extend(this.__color.__state,i)}Sr.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var s=this.__color.v<.5||this.__color.s>.5?255:0,a=255-s;Sr.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+s+","+s+","+s+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,Kq(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),Sr.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+s+","+s+","+s+")",textShadow:this.__input_textShadow+"rgba("+a+","+a+","+a+",.7)"})}}]),e}(Jy),rge=["-moz-","-o-","-webkit-","-ms-",""];function Kq(n,e,t,i){n.style.background="",Sr.each(rge,function(r){n.style.cssText+="background: "+r+"linear-gradient("+e+", "+t+" 0%, "+i+" 100%); "})}var lge=function(e,t){var i=e[t];return Sr.isArray(arguments[2])||Sr.isObject(arguments[2])?new jq(e,t,arguments[2]):Sr.isNumber(i)?Sr.isNumber(arguments[2])&&Sr.isNumber(arguments[3])?Sr.isNumber(arguments[4])?new f4(e,t,arguments[2],arguments[3],arguments[4]):new f4(e,t,arguments[2],arguments[3]):Sr.isNumber(arguments[4])?new _E(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new _E(e,t,{min:arguments[2],max:arguments[3]}):Sr.isString(i)?new $q(e,t):Sr.isFunction(i)?new WF(e,t,""):Sr.isBoolean(i)?new qF(e,t):null},dge=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function cge(n){setTimeout(n,1e3/60)},uge=function(){function n(){mg(this,n),this.backgroundElement=document.createElement("div"),Sr.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),Oi.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),Sr.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;Oi.bind(this.backgroundElement,"click",function(){e.hide()})}return Ag(n,[{key:"show",value:function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),Sr.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var t=this,i=function r(){t.domElement.style.display="none",t.backgroundElement.style.display="none",Oi.unbind(t.domElement,"webkitTransitionEnd",r),Oi.unbind(t.domElement,"transitionend",r),Oi.unbind(t.domElement,"oTransitionEnd",r)};Oi.bind(this.domElement,"webkitTransitionEnd",i),Oi.bind(this.domElement,"transitionend",i),Oi.bind(this.domElement,"oTransitionEnd",i),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-Oi.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-Oi.getHeight(this.domElement)/2+"px"}}]),n}();!function(e,t){var i=t||document,r=document.createElement("style");r.type="text/css",r.innerHTML=e;var s=i.getElementsByTagName("head")[0];try{s.appendChild(r)}catch{}}(function ZAe(n){if(n&&!(typeof window>"u")){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.innerHTML=n,document.head.appendChild(e),n}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n"));var yE="Default",vE=function(){try{return!!window.localStorage}catch{return!1}}(),bE=void 0,tQ=!0,_C=void 0,jF=!1,nQ=[],fc=function n(e){var t=this,i=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),Oi.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],i=Sr.defaults(i,{closeOnTop:!1,autoPlace:!0,width:n.DEFAULT_WIDTH}),i=Sr.defaults(i,{resizable:i.autoPlace,hideable:i.autoPlace}),Sr.isUndefined(i.load)?i.load={preset:yE}:i.preset&&(i.load.preset=i.preset),Sr.isUndefined(i.parent)&&i.hideable&&nQ.push(this),i.resizable=Sr.isUndefined(i.parent)&&i.resizable,i.autoPlace&&Sr.isUndefined(i.scrollable)&&(i.scrollable=!0);var r=vE&&"true"===localStorage.getItem(yC(0,"isLocal")),s=void 0,a=void 0;if(Object.defineProperties(this,{parent:{get:function(){return i.parent}},scrollable:{get:function(){return i.scrollable}},autoPlace:{get:function(){return i.autoPlace}},closeOnTop:{get:function(){return i.closeOnTop}},preset:{get:function(){return t.parent?t.getRoot().preset:i.load.preset},set:function(S){t.parent?t.getRoot().preset=S:i.load.preset=S,function Age(n){for(var e=0;e<n.__preset_select.length;e++)n.__preset_select[e].value===n.preset&&(n.__preset_select.selectedIndex=e)}(this),t.revert()}},width:{get:function(){return i.width},set:function(S){i.width=S,KF(t,S)}},name:{get:function(){return i.name},set:function(S){i.name=S,a&&(a.innerHTML=i.name)}},closed:{get:function(){return i.closed},set:function(S){i.closed=S,i.closed?Oi.addClass(t.__ul,n.CLASS_CLOSED):Oi.removeClass(t.__ul,n.CLASS_CLOSED),this.onResize(),t.__closeButton&&(t.__closeButton.innerHTML=S?n.TEXT_OPEN:n.TEXT_CLOSED)}},load:{get:function(){return i.load}},useLocalStorage:{get:function(){return r},set:function(S){vE&&(r=S,S?Oi.bind(window,"unload",s):Oi.unbind(window,"unload",s),localStorage.setItem(yC(0,"isLocal"),S))}}}),Sr.isUndefined(i.parent)){if(this.closed=i.closed||!1,Oi.addClass(this.domElement,n.CLASS_MAIN),Oi.makeSelectable(this.domElement,!1),vE&&r){t.useLocalStorage=!0;var l=localStorage.getItem(yC(0,"gui"));l&&(i.load=JSON.parse(l))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=n.TEXT_CLOSED,Oi.addClass(this.__closeButton,n.CLASS_CLOSE_BUTTON),i.closeOnTop?(Oi.addClass(this.__closeButton,n.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(Oi.addClass(this.__closeButton,n.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),Oi.bind(this.__closeButton,"click",function(){t.closed=!t.closed})}else{void 0===i.closed&&(i.closed=!0);var d=document.createTextNode(i.name);Oi.addClass(d,"controller-name"),a=$F(t,d),Oi.addClass(this.__ul,n.CLASS_CLOSED),Oi.addClass(a,"title"),Oi.bind(a,"click",function(S){return S.preventDefault(),t.closed=!t.closed,!1}),i.closed||(this.closed=!1)}i.autoPlace&&(Sr.isUndefined(i.parent)&&(tQ&&(_C=document.createElement("div"),Oi.addClass(_C,"dg"),Oi.addClass(_C,n.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(_C),tQ=!1),_C.appendChild(this.domElement),Oi.addClass(this.domElement,n.CLASS_AUTO_PLACE)),this.parent||KF(t,i.width)),this.__resizeHandler=function(){t.onResizeDebounced()},Oi.bind(window,"resize",this.__resizeHandler),Oi.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),Oi.bind(this.__ul,"transitionend",this.__resizeHandler),Oi.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),i.resizable&&function mge(n){var e=void 0;function t(s){return s.preventDefault(),n.width+=e-s.clientX,n.onResize(),e=s.clientX,!1}function i(){Oi.removeClass(n.__closeButton,fc.CLASS_DRAG),Oi.unbind(window,"mousemove",t),Oi.unbind(window,"mouseup",i)}function r(s){return s.preventDefault(),e=s.clientX,Oi.addClass(n.__closeButton,fc.CLASS_DRAG),Oi.bind(window,"mousemove",t),Oi.bind(window,"mouseup",i),!1}n.__resize_handle=document.createElement("div"),Sr.extend(n.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),Oi.bind(n.__resize_handle,"mousedown",r),Oi.bind(n.__closeButton,"mousedown",r),n.domElement.insertBefore(n.__resize_handle,n.domElement.firstElementChild)}(this),this.saveToLocalStorageIfPossible=s=function(){vE&&"true"===localStorage.getItem(yC(0,"isLocal"))&&localStorage.setItem(yC(0,"gui"),JSON.stringify(t.getSaveObject()))},i.parent||function p(){var _=t.getRoot();_.width+=1,Sr.defer(function(){_.width-=1})}()};function $F(n,e,t){var i=document.createElement("li");return e&&i.appendChild(e),t?n.__ul.insertBefore(i,t):n.__ul.appendChild(i),n.onResize(),i}function iQ(n){Oi.unbind(window,"resize",n.__resizeHandler),n.saveToLocalStorageIfPossible&&Oi.unbind(window,"unload",n.saveToLocalStorageIfPossible)}function XF(n,e){var t=n.__preset_select[n.__preset_select.selectedIndex];t.innerHTML=e?t.value+"*":t.value}function rQ(n,e){var t=n.getRoot(),i=t.__rememberedObjects.indexOf(e.object);if(-1!==i){var r=t.__rememberedObjectIndecesToControllers[i];if(void 0===r&&(t.__rememberedObjectIndecesToControllers[i]=r={}),r[e.property]=e,t.load&&t.load.remembered){var s=t.load.remembered,a=void 0;if(s[n.preset])a=s[n.preset];else{if(!s[yE])return;a=s[yE]}if(a[i]&&void 0!==a[i][e.property]){var l=a[i][e.property];e.initialValue=l,e.setValue(l)}}}}function xE(n,e,t,i){if(void 0===e[t])throw new Error('Object "'+e+'" has no property "'+t+'"');var r=void 0;if(i.color)r=new p4(e,t);else{var s=[e,t].concat(i.factoryArgs);r=lge.apply(n,s)}i.before instanceof Jy&&(i.before=i.before.__li),rQ(n,r),Oi.addClass(r.domElement,"c");var a=document.createElement("span");Oi.addClass(a,"property-name"),a.innerHTML=r.property;var l=document.createElement("div");l.appendChild(a),l.appendChild(r.domElement);var d=$F(n,l,i.before);return Oi.addClass(d,fc.CLASS_CONTROLLER_ROW),Oi.addClass(d,r instanceof p4?"color":ege(r.getValue())),function fge(n,e,t){if(t.__li=e,t.__gui=n,Sr.extend(t,{options:function(a){if(arguments.length>1){var l=t.__li.nextElementSibling;return t.remove(),xE(n,t.object,t.property,{before:l,factoryArgs:[Sr.toArray(arguments)]})}if(Sr.isArray(a)||Sr.isObject(a)){var d=t.__li.nextElementSibling;return t.remove(),xE(n,t.object,t.property,{before:d,factoryArgs:[a]})}},name:function(a){return t.__li.firstElementChild.firstElementChild.innerHTML=a,t},listen:function(){return t.__gui.listen(t),t},remove:function(){return t.__gui.remove(t),t}}),t instanceof f4){var i=new _E(t.object,t.property,{min:t.__min,max:t.__max,step:t.__step});Sr.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(s){var a=t[s],l=i[s];t[s]=i[s]=function(){var d=Array.prototype.slice.call(arguments);return l.apply(i,d),a.apply(t,d)}}),Oi.addClass(e,"has-slider"),t.domElement.insertBefore(i.domElement,t.domElement.firstElementChild)}else if(t instanceof _E){var r=function(a){if(Sr.isNumber(t.__min)&&Sr.isNumber(t.__max)){var l=t.__li.firstElementChild.firstElementChild.innerHTML,d=t.__gui.__listening.indexOf(t)>-1;t.remove();var u=xE(n,t.object,t.property,{before:t.__li.nextElementSibling,factoryArgs:[t.__min,t.__max,t.__step]});return u.name(l),d&&u.listen(),u}return a};t.min=Sr.compose(r,t.min),t.max=Sr.compose(r,t.max)}else t instanceof qF?(Oi.bind(e,"click",function(){Oi.fakeEvent(t.__checkbox,"click")}),Oi.bind(t.__checkbox,"click",function(s){s.stopPropagation()})):t instanceof WF?(Oi.bind(e,"click",function(){Oi.fakeEvent(t.__button,"click")}),Oi.bind(e,"mouseover",function(){Oi.addClass(t.__button,"hover")}),Oi.bind(e,"mouseout",function(){Oi.removeClass(t.__button,"hover")})):t instanceof p4&&(Oi.addClass(e,"color"),t.updateDisplay=Sr.compose(function(s){return e.style.borderLeftColor=t.__color.toString(),s},t.updateDisplay),t.updateDisplay());t.setValue=Sr.compose(function(s){return n.getRoot().__preset_select&&t.isModified()&&XF(n.getRoot(),!0),s},t.setValue)}(n,d,r),n.__controllers.push(r),r}function yC(n,e){return document.location.href+"."+e}function YF(n,e,t){var i=document.createElement("option");i.innerHTML=e,i.value=e,n.__preset_select.appendChild(i),t&&(n.__preset_select.selectedIndex=n.__preset_select.length-1)}function sQ(n,e){e.style.display=n.useLocalStorage?"block":"none"}function KF(n,e){n.domElement.style.width=e+"px",n.__save_row&&n.autoPlace&&(n.__save_row.style.width=e+"px"),n.__closeButton&&(n.__closeButton.style.width=e+"px")}function m4(n,e){var t={};return Sr.each(n.__rememberedObjects,function(i,r){var s={};Sr.each(n.__rememberedObjectIndecesToControllers[r],function(l,d){s[d]=e?l.initialValue:l.getValue()}),t[r]=s}),t}function oQ(n){0!==n.length&&dge.call(window,function(){oQ(n)}),Sr.each(n,function(e){e.updateDisplay()})}fc.toggleHide=function(){jF=!jF,Sr.each(nQ,function(n){n.domElement.style.display=jF?"none":""})},fc.CLASS_AUTO_PLACE="a",fc.CLASS_AUTO_PLACE_CONTAINER="ac",fc.CLASS_MAIN="main",fc.CLASS_CONTROLLER_ROW="cr",fc.CLASS_TOO_TALL="taller-than-window",fc.CLASS_CLOSED="closed",fc.CLASS_CLOSE_BUTTON="close-button",fc.CLASS_CLOSE_TOP="close-top",fc.CLASS_CLOSE_BOTTOM="close-bottom",fc.CLASS_DRAG="drag",fc.DEFAULT_WIDTH=245,fc.TEXT_CLOSED="Close Controls",fc.TEXT_OPEN="Open Controls",fc._keydownHandler=function(n){"text"!==document.activeElement.type&&(72===n.which||72===n.keyCode)&&fc.toggleHide()},Oi.bind(window,"keydown",fc._keydownHandler,!1),Sr.extend(fc.prototype,{add:function(e,t){return xE(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return xE(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;Sr.defer(function(){t.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&_C.removeChild(this.domElement);var e=this;Sr.each(this.__folders,function(t){e.removeFolder(t)}),Oi.unbind(window,"keydown",fc._keydownHandler,!1),iQ(this)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var i=new fc(t);this.__folders[e]=i;var r=$F(this,i.domElement);return Oi.addClass(r,"folder"),i},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],iQ(e);var t=this;Sr.each(e.__folders,function(i){e.removeFolder(i)}),Sr.defer(function(){t.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=Oi.getOffset(e.__ul).top,i=0;Sr.each(e.__ul.childNodes,function(r){e.autoPlace&&r===e.__save_row||(i+=Oi.getHeight(r))}),window.innerHeight-t-20<i?(Oi.addClass(e.domElement,fc.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-20+"px"):(Oi.removeClass(e.domElement,fc.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&Sr.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:Sr.debounce(function(){this.onResize()},50),remember:function(){if(Sr.isUndefined(bE)&&((bE=new uge).domElement.innerHTML='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>'),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;Sr.each(Array.prototype.slice.call(arguments),function(t){0===e.__rememberedObjects.length&&function pge(n){var e=n.__save_row=document.createElement("li");Oi.addClass(n.domElement,"has-save"),n.__ul.insertBefore(e,n.__ul.firstChild),Oi.addClass(e,"save-row");var t=document.createElement("span");t.innerHTML="&nbsp;",Oi.addClass(t,"button gears");var i=document.createElement("span");i.innerHTML="Save",Oi.addClass(i,"button"),Oi.addClass(i,"save");var r=document.createElement("span");r.innerHTML="New",Oi.addClass(r,"button"),Oi.addClass(r,"save-as");var s=document.createElement("span");s.innerHTML="Revert",Oi.addClass(s,"button"),Oi.addClass(s,"revert");var a=n.__preset_select=document.createElement("select");if(n.load&&n.load.remembered?Sr.each(n.load.remembered,function(_,S){YF(n,S,S===n.preset)}):YF(n,yE,!1),Oi.bind(a,"change",function(){for(var _=0;_<n.__preset_select.length;_++)n.__preset_select[_].innerHTML=n.__preset_select[_].value;n.preset=this.value}),e.appendChild(a),e.appendChild(t),e.appendChild(i),e.appendChild(r),e.appendChild(s),vE){var l=document.getElementById("dg-local-explain"),d=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(yC(0,"isLocal"))&&d.setAttribute("checked","checked"),sQ(n,l),Oi.bind(d,"change",function(){n.useLocalStorage=!n.useLocalStorage,sQ(n,l)})}var p=document.getElementById("dg-new-constructor");Oi.bind(p,"keydown",function(_){_.metaKey&&(67===_.which||67===_.keyCode)&&bE.hide()}),Oi.bind(t,"click",function(){p.innerHTML=JSON.stringify(n.getSaveObject(),void 0,2),bE.show(),p.focus(),p.select()}),Oi.bind(i,"click",function(){n.save()}),Oi.bind(r,"click",function(){var _=prompt("Enter a new preset name.");_&&n.saveAs(_)}),Oi.bind(s,"click",function(){n.revert()})}(e),-1===e.__rememberedObjects.indexOf(t)&&e.__rememberedObjects.push(t)}),this.autoPlace&&KF(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=m4(this)),e.folders={},Sr.each(this.__folders,function(t,i){e.folders[i]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=m4(this),XF(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[yE]=m4(this,!0)),this.load.remembered[e]=m4(this),this.preset=e,YF(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){Sr.each(this.__controllers,function(t){this.getRoot().load.remembered?rQ(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())},this),Sr.each(this.__folders,function(t){t.revert(t)}),e||XF(this.getRoot(),!1)},listen:function(e){var t=0===this.__listening.length;this.__listening.push(e),t&&oQ(this.__listening)},updateDisplay:function(){Sr.each(this.__controllers,function(e){e.updateDisplay()}),Sr.each(this.__folders,function(e){e.updateDisplay()})}});var aQ=fc;class lQ{three;sceneManager;gui;guiParameters={rotate:void 0,axis:void 0,lowRes:void 0,eventData:void 0,geometries:void 0,labels:void 0};geomFolder;eventFolder;labelsFolder;maxPositionX=4e3;maxPositionY=4e3;maxPositionZ=4e3;constructor(e="eventDisplay",t){this.three=t,this.gui=new aQ,this.gui.domElement.id="gui",this.gui.domElement.style.cssText="position: absolute; right: 0; top: 2rem; z-index: 11;",(document.getElementById(e)??document.body).appendChild(this.gui.domElement),this.geomFolder=null,this.eventFolder=null,this.labelsFolder=null,this.sceneManager=t.getSceneManager()}clear(){const e=document.getElementById("gui");e?.remove(),this.geomFolder=null}addGeometryFolder(){null===this.geomFolder&&(this.geomFolder=this.gui.addFolder(el.GEOMETRIES_ID)),this.guiParameters.geometries={show:!0,wireframe:!1},this.geomFolder.add(this.guiParameters.geometries,"show").name("Show").listen().onChange(i=>{this.sceneManager.objectVisibility(this.sceneManager.getObjectByName(el.GEOMETRIES_ID),i)}),this.geomFolder.add(this.guiParameters.geometries,"wireframe").name("Wireframe").listen().onChange(i=>{this.sceneManager.wireframeGeometries(i)})}addGeometry(e,t){const{name:i,material:r,visible:s}=e,a=r?.color;this.guiParameters[i]={show:s,color:a??"#000000",x:0,y:0,z:0,detectorOpacity:1,remove:this.removeOBJ(e),scale:1};const l=this.geomFolder.addFolder(i);l.addColor(this.guiParameters[i],"color").name("Color").onChange(S=>this.sceneManager.changeObjectColor(e,S)),l.add(this.guiParameters[i],"detectorOpacity",0,1).name("Opacity").onFinishChange(S=>this.sceneManager.setGeometryOpacity(e,S)),l.add(this.guiParameters[i],"show").name("Show").listen().onChange(S=>this.sceneManager.objectVisibility(e,S)),l.add(this.guiParameters[i],"scale",0,1e3).name("Scale").onChange(S=>{this.sceneManager.scaleObject(e,S)}),l.add(this.guiParameters[i],"x",-this.maxPositionX,this.maxPositionX).name("X").onChange(S=>this.sceneManager.getObjectPosition(i).setX(S)),l.add(this.guiParameters[i],"y",-this.maxPositionY,this.maxPositionY).name("Y").onChange(S=>this.sceneManager.getObjectPosition(i).setY(S)),l.add(this.guiParameters[i],"z",-this.maxPositionZ,this.maxPositionZ).name("Z").onChange(S=>this.sceneManager.getObjectPosition(i).setZ(S)),l.add(this.guiParameters[i],"remove").name("Remove")}removeOBJ(e){return()=>{const t=this.geomFolder.__folders[e.name];t&&this.geomFolder.removeFolder(t),this.sceneManager.removeGeometry(e)}}addEventDataFolder(){null!==this.eventFolder&&this.gui.removeFolder(this.eventFolder),this.eventFolder=this.gui.addFolder("Event Data"),this.guiParameters.eventData={show:!0,depthTest:!0},this.eventFolder.add(this.guiParameters.eventData,"show").name("Show").listen().onChange(i=>this.sceneManager.groupVisibility(el.EVENT_DATA_ID,i)),this.eventFolder.add(this.guiParameters.eventData,"depthTest").name("Depth Test").listen().onChange(i=>this.three.eventDataDepthTest(i))}addEventDataTypeFolder(e){const t=this.eventFolder.addFolder(e);this.guiParameters.eventData[e]=!0,t.add(this.guiParameters.eventData,e).name("Show").listen().onChange(r=>this.sceneManager.objectVisibility(this.sceneManager.getObjectByName(el.EVENT_DATA_ID).getObjectByName(e),r))}addCollection(e,t,i,r){const s=this.eventFolder.__folders[e];if(!s)return;this.guiParameters[t]={show:!0,color:0,randomColor:()=>this.three.getColorManager().collectionColorRandom(t),resetCut:()=>this.sceneManager.groupVisibility(t,!0,el.EVENT_DATA_ID)};const a=s.addFolder(t);a.add(this.guiParameters[t],"show").name("Show").listen().onChange(u=>{const p=this.sceneManager.getObjectByName(el.EVENT_DATA_ID).getObjectByName(t);this.sceneManager.objectVisibility(p,u)});const d=a.addColor(this.guiParameters[t],"color").name("Color");if(d.onChange(u=>this.three.getColorManager().collectionColor(t,u)),d.setValue(r?.getHex()),a.add(this.guiParameters[t],"randomColor").name("Random Color"),i){const u=a.addFolder("Cuts");u.add(this.guiParameters[t],"resetCut").name("Reset cuts");for(const p of i)u.add({minValue:p.minValue},"minValue",p.minValue,p.maxValue).name("min "+p.field).onChange(R=>{p.minValue=R,this.sceneManager.collectionFilter(t,i)}),u.add({maxValue:p.maxValue},"maxValue",p.minValue,p.maxValue).name("max "+p.field).onChange(R=>{p.maxValue=R,this.sceneManager.collectionFilter(t,i)})}}addLabelsFolder(e){if(null!==this.labelsFolder)return;const{onToggle:t,onSizeChange:i,onColorChange:r,onSaveLabels:s,onLoadLabels:a}=e;this.labelsFolder=this.gui.addFolder(el.LABELS_ID),this.guiParameters.labels={show:!0,size:1,color:"#a8a8a8",saveLabels:s,loadLabels:a},this.labelsFolder.add(this.guiParameters.labels,"show").name("Show").listen().onChange(t),this.labelsFolder.add(this.guiParameters.labels,"size",0,10).name("Size").onFinishChange(i),this.labelsFolder.addColor(this.guiParameters.labels,"color").name("Color").onChange(r),this.labelsFolder.add(this.guiParameters.labels,"saveLabels").name("Save Labels"),this.labelsFolder.add(this.guiParameters.labels,"loadLabels").name("Load Labels")}addLabel(e,t){this.guiParameters[e]={show:!0,color:11513775};const i=this.labelsFolder.addFolder(e);i.add(this.guiParameters[e],"show").name("Show").listen().onChange(a=>{const l=this.sceneManager.getObjectByName(el.LABELS_ID).getObjectByName(e);this.sceneManager.objectVisibility(l,a)}),i.addColor(this.guiParameters[e],"color").name("\xc7olor").onChange(a=>this.sceneManager.changeObjectColor(this.sceneManager.getObjectByName(e),a)),this.guiParameters[e].removeLabel=()=>{t?.(),this.removeLabel(e,i)},i.add(this.guiParameters[e],"removeLabel").name("Remove")}removeLabel(e,t){t||(t=this.labelsFolder.__folders[e]),t&&this.labelsFolder.removeFolder(t)}getEventDataTypeFolder(e){return this.eventFolder.__folders[e]}}var Am=function(n){return n.CHARGE="charge",n.MOM="mom",n.VERTEX="vertex",n}(Am||{});class bge{colorManager;collectionName;colorByOptions;selectedColorByOption;colorOptionsFolder;allColorByOptions=[{key:Am.CHARGE,name:"Charge "+$y.getPrettySymbol("charge"),initialize:this.initChargeColorOptions.bind(this),apply:this.applyChargeColorOptions.bind(this)},{key:Am.MOM,name:"Momentum "+$y.getPrettySymbol("mom"),initialize:this.initMomColorOptions.bind(this),apply:this.applyMomColorOptions.bind(this)},{key:Am.VERTEX,name:"Vertex",apply:this.applyVertexColorOptions.bind(this)}];chargeColors={"-1":"#ff0000",0:"#ff0000",1:"#ff0000"};momColors={min:{value:0,color:"#ff0000"},max:{value:5e4,color:"#ff0000"}};constructor(e,t,i,r){this.colorManager=e,this.collectionName=t.name,this.colorOptionsFolder=t.addChild("Color Options"),this.colorOptionsFolder.addConfig("color",{label:"Color",color:i?`#${i?.getHexString()}`:void 0,onChange:s=>this.colorManager.collectionColor(this.collectionName,s)}),this.colorOptionsFolder.addConfig("button",{label:"Random",onClick:()=>this.colorManager.collectionColorRandom(this.collectionName)}),r?.length>0&&(this.colorByOptions=this.allColorByOptions.filter(s=>r.includes(s.key)),this.initColorByOptions(),this.colorByOptions.forEach(s=>s.initialize?.()),this.onlySelectedColorByOption())}initColorByOptions(){this.selectedColorByOption=this.colorByOptions[0].key,this.colorOptionsFolder.addConfig("select",{label:"Color by",options:this.colorByOptions.map(e=>e.name),onChange:e=>{const t=this.colorByOptions.find(i=>i.name===e);this.selectedColorByOption=t?.key,t?.apply?.(),this.onlySelectedColorByOption()}})}initChargeColorOptions(){[-1,0,1].forEach(e=>{this.colorOptionsFolder.addConfig("color",{label:`${$y.getPrettySymbol("charge")}=${e}`,group:Am.CHARGE,color:this.chargeColors[e],onChange:t=>{this.chargeColors[e]=t,this.selectedColorByOption===Am.CHARGE&&this.colorManager.colorObjectsByProperty(t,this.collectionName,i=>this.shouldColorByCharge(i,e))}})})}applyChargeColorOptions(){[-1,0,1].forEach(e=>{this.colorManager.colorObjectsByProperty(this.chargeColors[e],this.collectionName,t=>this.shouldColorByCharge(t,e))})}shouldColorByCharge(e,t){return Math.sign(1/parseInt(e?.dparams?.[4]))===t||e?.charge===t||void 0}initMomColorOptions(){Object.entries(this.momColors).forEach(([e,t])=>{this.colorOptionsFolder.addConfig("slider",{label:$y.getPrettySymbol("mom")+" "+e,group:Am.MOM,min:this.momColors.min.value,max:this.momColors.max.value,value:this.momColors[e].value,step:10,allowCustomValue:!0,onChange:i=>{this.momColors[e].value=i,this.selectedColorByOption===Am.MOM&&(this.colorByMomentum("min"),this.colorByMomentum("max"))}}),this.colorOptionsFolder.addConfig("color",{label:$y.getPrettySymbol("mom")+" "+e+" color",group:Am.MOM,color:t.color,onChange:i=>{this.momColors[e].color=i,this.selectedColorByOption===Am.MOM&&this.colorByMomentum(e)}})})}applyMomColorOptions(){this.colorByMomentum("min"),this.colorByMomentum("max")}colorByMomentum(e){this.colorManager.colorObjectsByProperty(this.momColors[e].color,this.collectionName,t=>{const i=this.getMomentum(t),r=(this.momColors.min.value+this.momColors.max.value)/2;return"max"===e&&i>r&&i<this.momColors.max.value||"min"===e&&i<r&&i>this.momColors.min.value||void 0})}getMomentum(e){return e?.dparams?.[4]?Math.abs(1/parseFloat(e?.dparams?.[4])):e?.mom}applyVertexColorOptions(){this.colorManager.colorTracksByVertex(this.collectionName)}onlySelectedColorByOption(){this.colorOptionsFolder.configs.forEach(e=>{e.hidden=void 0!==e.group&&e.group!==this.selectedColorByOption})}}class ZF{phoenixMenuRoot;three;geomFolder;eventFolder;eventFolderState;labelsFolder;sceneManager;constructor(e,t){this.phoenixMenuRoot=e,this.three=t,this.geomFolder=null,this.eventFolder=null,this.labelsFolder=null,this.sceneManager=t.getSceneManager()}clear(){this.phoenixMenuRoot&&(this.phoenixMenuRoot.truncate(),this.phoenixMenuRoot=void 0),this.geomFolder=null,this.eventFolder=null,this.labelsFolder=null}addGeometryFolder(){null===this.geomFolder&&(this.geomFolder=this.phoenixMenuRoot.addChild("Detector",e=>{this.sceneManager.groupVisibility(el.GEOMETRIES_ID,e)},"perspective")),this.geomFolder.addConfig("checkbox",{label:"Wireframe",isChecked:!1,onChange:e=>{this.sceneManager.wireframeGeometries(e)}}).addConfig("slider",{label:"Opacity",min:0,max:1,step:.01,allowCustomValue:!0,onChange:e=>{this.sceneManager.setGeometryOpacity(this.sceneManager.getObjectByName(el.GEOMETRIES_ID),e)}}).addConfig("slider",{label:"Scale",min:0,max:20,step:.01,allowCustomValue:!0,onChange:e=>{this.sceneManager.scaleObject(this.sceneManager.getObjectByName(el.GEOMETRIES_ID),e)}})}addGeometry(e,t){const{name:i,material:r,visible:s}=e,a=r?.color;let l=this.geomFolder;t&&(l=this.geomFolder.findInTreeOrCreate(t));let d=i.lastIndexOf(" > ");d<0?d=0:d+=3;const u=l.addChild(i.substring(d),p=>{this.sceneManager.objectVisibility(e,p)});u.toggleState=s,u.addConfig("color",{label:"Color",color:a?`#${new Cr(a).getHexString()}`:void 0,onChange:p=>{this.sceneManager.changeObjectColor(e,p)}}).addConfig("slider",{label:"Opacity",min:0,max:1,step:.05,allowCustomValue:!0,onChange:p=>{this.sceneManager.setGeometryOpacity(e,p)}}).addConfig("button",{label:"Remove",onClick:()=>{u.remove(),this.sceneManager.removeGeometry(e)}})}addEventDataFolder(){null!==this.eventFolder&&(this.eventFolderState=this.eventFolder.getNodeState(),this.eventFolder.remove()),this.eventFolder=this.phoenixMenuRoot.addChild("Event Data",e=>{this.sceneManager.groupVisibility(el.EVENT_DATA_ID,e)},"event-folder"),this.eventFolder.addConfig("checkbox",{label:"Depth Test",isChecked:!0,onChange:e=>{this.three.eventDataDepthTest(e)}})}addEventDataTypeFolder(e){this.eventFolder.addChild(e,t=>{this.sceneManager.objectVisibility(this.sceneManager.getObjectByName(el.EVENT_DATA_ID).getObjectByName(e),t)})}addCollection(e,t,i,r){const s=this.eventFolder.children.find(d=>d.name===e);if(!s)return;const a=s.addChild(t,d=>{const u=this.sceneManager.getObjectByName(el.EVENT_DATA_ID).getObjectByName(t);this.sceneManager.objectVisibility(u,d)});this.addDrawOptions(a,t),i&&i.length>0&&this.addCutOptions(a,t,i);const l=[];"Tracks"===s.name&&l.push(Am.CHARGE,Am.MOM,Am.VERTEX),new bge(this.three.getColorManager(),a,r,l)}addCutOptions(e,t,i){const r=e.addChild("Cut Options");r.addConfig("label",{label:"Cuts"}).addConfig("button",{label:"Reset cuts",onClick:()=>{this.sceneManager.groupVisibility(t,!0,el.EVENT_DATA_ID);for(const s of i)s.reset()}});for(const s of i)r.addConfig("rangeSlider",{label:$y.getPrettySymbol(s.field),min:s.minValue,max:s.maxValue,step:s.step,value:s.minValue,highValue:s.maxValue,enableMin:s.minCutActive,enableMax:s.maxCutActive,onChange:({value:a,highValue:l})=>{s.minValue=a,s.maxValue=l,this.sceneManager.collectionFilter(t,i)},setEnableMin:a=>{s.enableMinCut(a),this.sceneManager.collectionFilter(t,i)},setEnableMax:a=>{s.enableMaxCut(a),this.sceneManager.collectionFilter(t,i)}})}addDrawOptions(e,t){const i=e.addChild("Draw Options");i.addConfig("slider",{label:"Opacity",min:.1,step:.1,max:1,onChange:r=>{const s=this.sceneManager.getObjectByName(el.EVENT_DATA_ID);if(s){const a=s.getObjectByName(t);a&&this.sceneManager.setGeometryOpacity(a,r)}}}),i.addConfig("checkbox",{label:"Wireframe",onChange:r=>this.sceneManager.wireframeObjects(this.sceneManager.getObjectByName(el.EVENT_DATA_ID).getObjectByName(t),r)})}addLabelsFolder(e){if(null!==this.labelsFolder)return;const{onToggle:t,onSizeChange:i,onColorChange:r,onSaveLabels:s,onLoadLabels:a}=e;this.labelsFolder=this.phoenixMenuRoot.addChild(el.LABELS_ID,t,"info"),this.labelsFolder.addConfig("slider",{label:"Size",min:0,max:10,step:.01,allowCustomValue:!0,onChange:i}),this.labelsFolder.addConfig("color",{label:"Color",color:"#a8a8a8",onChange:r}),this.labelsFolder.addConfig("button",{label:"Save Labels",onClick:s}),this.labelsFolder.addConfig("button",{label:"Load Labels",onClick:a})}addLabel(e,t){let i=this.labelsFolder.children.find(r=>r.name===e);i||(i=this.labelsFolder.addChild(e,r=>{const s=this.sceneManager.getObjectByName(el.LABELS_ID).getObjectByName(e);this.sceneManager.objectVisibility(s,r)}),i.addConfig("color",{label:"Color",color:"#a8a8a8",onChange:r=>{this.sceneManager.changeObjectColor(this.sceneManager.getObjectByName(e),r)}}),i.addConfig("button",{label:"Remove",onClick:()=>{t?.(),this.removeLabel(e,i)}}))}removeLabel(e,t){t||(t=this.labelsFolder?.children.find(i=>i.name===e)),t?.remove()}getEventDataTypeFolder(e){return this.eventFolder.children.find(t=>t.name===e)}loadEventFolderState(){this.eventFolderState&&this.eventFolder.loadStateFromJSON(this.eventFolderState)}}const cQ=n=>{try{return localStorage.getItem(n)}catch(e){console.warn("Exception in localStorage",e)}},wge=[{name:"Cavern to ID",positions:[{position:[66388.95051168812,5264.228603228927,-46910.7848593543],duration:1e3},{position:[12834.18729094943,677.7571205763458,135.68755273443463],duration:2e3},{position:[312.02688693297375,25.884223757326,270.10019006776236],duration:3500},{position:[263.3640855132258,19.874838262525053,-318.16541790248885],duration:3e3},{position:[5534.140362338047,234.03507981484574,-2933.619479808285],duration:2e3},{position:[2681.277288705242,646.5795158318147,5628.5248735111745],duration:1e3},{position:[-6062.586283740076,790.5876682946184,1381.1675900848818],duration:1e3},{position:[-1766.7693725879053,1007.1048030984678,-5928.901341784575],duration:1e3},{position:[12814.982506255355,2516.987185037266,-22891.902734328327],duration:1e3}],animateEventAfterInterval:5e3,collisionDuration:6e3}];class Cge{three;uiMenus=[];stats;geomFolderAdded=!1;labelsFolderAdded=!1;configuration;darkTheme;stateManager;constructor(e){this.three=e}init(e){this.clearUI(),this.configuration=e,this.showStats(e.elementId),this.uiMenus=[],e.enableDatGUIMenu&&this.uiMenus.push(new lQ(e.elementId,this.three)),e.phoenixMenuRoot&&this.uiMenus.push(new ZF(e.phoenixMenuRoot,this.three)),e.forceColourTheme?this.setDarkTheme("dark"==e.forceColourTheme.toLocaleLowerCase()):this.detectColorScheme(),this.stateManager=new ax,this.stateManager.setPhoenixMenuRoot(e.phoenixMenuRoot)}showStats(e="eventDisplay"){this.stats=new(KAe()),this.stats.showPanel(0),this.stats.dom.className="ui-element",this.stats.dom.id="statsElement",this.stats.domElement.style.cssText="position: absolute; left: 0px; cursor: pointer; opacity: 0.9; z-index: 10; bottom: 0px;";let t=document.getElementById(e);null==t&&(t=document.body),t.appendChild(this.stats.dom)}updateUI(){this.stats.update()}clearUI(){this.uiMenus.forEach(e=>e.clear()),this.geomFolderAdded=!1,this.labelsFolderAdded=!1}addGeomFolder(){this.geomFolderAdded=!0,this.uiMenus.forEach(e=>e.addGeometryFolder())}addGeometry(e,t){this.geomFolderAdded||this.addGeomFolder(),this.uiMenus.forEach(i=>i.addGeometry(e,t))}addEventDataFolder(){this.uiMenus.forEach(e=>e.addEventDataFolder())}addEventDataTypeFolder(e){this.uiMenus.forEach(t=>t.addEventDataTypeFolder(e))}addCollection(e,t,i,r){this.uiMenus.forEach(s=>s.addCollection(e,t,i,r))}addLabelsFolder(){const e=this.three.getSceneManager();this.labelsFolderAdded=!0;const t=l=>{e.objectVisibility(e.getObjectByName(el.LABELS_ID),l)},i=l=>{const d=e.getObjectByName(el.LABELS_ID);e.scaleObject(d,l)},r=l=>{const d=e.getObjectByName(el.LABELS_ID);e.changeObjectColor(d,l)},s=()=>{const l=this.configuration?.eventDataLoader?.getLabelsObject();l&&fC(JSON.stringify(l),"phoenix-labels.json")},a=()=>{this.loadLabelsFile()};this.uiMenus.forEach(l=>l.addLabelsFolder({onToggle:t,onSizeChange:i,onColorChange:r,onSaveLabels:s,onLoadLabels:a}))}addLabel(e){this.labelsFolderAdded||this.addLabelsFolder(),this.uiMenus.forEach(t=>t?.addLabel(e,()=>this.removeLabel(e)))}removeLabel(e,t){this.three.getSceneManager().removeLabel(e);const i=e.split(" > "),r=this.configuration.eventDataLoader?.getLabelsObject();delete r?.[i[0]]?.[i[1]]?.[i[2]],t&&this.uiMenus.forEach(s=>s.removeLabel(e))}geometryVisibility(e,t){const i=this.three.getSceneManager();i.objectVisibility(i.getObjectByName(e),t)}rotateStartAngleClipping(e){const t=this.stateManager.getOpeningClippingAngle();this.three.setClippingAngle(e,t),this.stateManager.setStartClippingAngle(e)}rotateOpeningAngleClipping(e){const t=this.stateManager.getStartClippingAngle();this.three.setClippingAngle(t,e),this.stateManager.setOpeningClippingAngle(e)}setClipping(e){this.three.setClipping(e),this.stateManager.setClippingEnabled(e)}detectColorScheme(){let e=!1;cQ("theme")?"dark"===cQ("theme")&&(e=!0):window.matchMedia&&matchMedia("(prefers-color-scheme: dark)").matches&&(e=!0),this.darkTheme=e,this.setDarkTheme(e)}setDarkTheme(e){const t=e?"dark":"light";((n,e)=>{try{localStorage.setItem("theme",e)}catch(t){console.warn("Exception in localStorage",t)}})(0,t),document.documentElement.setAttribute("data-theme",t),this.three.setDarkColor(e)}getDarkTheme(){return this.darkTheme}setAutoRotate(e){this.three.autoRotate(e)}setShowAxis(e){this.three.getSceneManager().setAxis(e)}translateCartesianGrid(e){this.three.getSceneManager().translateCartesianGrid(e)}translateCartesianLabels(e){this.three.getSceneManager().translateCartesianLabels(e)}showLabels(e){this.three.getSceneManager().showLabels(e)}setShowCartesianGrid(e,t,i){typeof i>"u"?this.three.getSceneManager().setCartesianGrid(e,t):this.three.getSceneManager().setCartesianGrid(e,t,i)}getCartesianGridConfig(){return this.three.getSceneManager().getCartesianGridConfig()}setShowEtaPhiGrid(e){this.three.getSceneManager().setEtaPhiGrid(e)}show3DMousePoints(e){this.three.show3DMousePoints(e)}show3DDistance(e){this.three.show3DDistance(e)}shiftCartesianGridByPointer(){this.three.shiftCartesianGrid()}getPresetViews(){return this.configuration?.presetViews}getPresetAnimations(){return this.configuration?.presetAnimations?this.configuration?.presetAnimations:wge}displayView(e){this.three.animateCameraTransform(e.cameraPos,e.cameraTarget,1e3),e.clipping!=AC.NotForced&&(this.rotateStartAngleClipping(e.clippingStartAngle),this.rotateOpeningAngleClipping(e.clippingOpeningAngle),this.setClipping(e.clipping==AC.On))}toggleOrthographicView(e){this.three.swapCameras(e)}setOverlayRenderer(e){this.three.setOverlayRenderer(e)}enableKeyboardControls(){document.addEventListener("keydown",e=>{if(!["input","textarea"].includes(e.target?.tagName.toLowerCase())&&e.shiftKey&&("KeyT"===e.code&&this.setDarkTheme(!this.getDarkTheme()),this.configuration?.presetViews&&e.code.startsWith("Digit"))){const i=parseInt(e.code.slice(-1))-1;this.configuration.presetViews?.[i]&&this.displayView(this.configuration.presetViews[i])}})}loadLabelsFile(){const e=this.configuration?.eventDataLoader,t=e?.getLabelsObject();e&&t&&bq(i=>{const r=JSON.parse(i);for(const s of Object.keys(r))for(const a of Object.keys(r[s])){const l=e.getCollection(a);for(const d of Object.keys(r[s][a])){const u=r[s][a][d],p=l[d].uuid,_=e.addLabelToEventObject(u,a,Number(d));this.addLabel(_),this.three.addLabelToObject(u,p,_)}}})}loadEventFolderPhoenixMenuState(){this.uiMenus.find(t=>t instanceof ZF)?.loadEventFolderState()}getUIMenus(){return this.uiMenus}}class Mge{infoLoggerList=[];maxEntries=10;add(e,t){this.infoLoggerList.length>this.maxEntries&&this.infoLoggerList.pop(),this.infoLoggerList.unshift(t?t+": "+e:e)}getInfoLoggerList(){return this.infoLoggerList}}class Cl{field;minValue;maxValue;step;minCutActive;maxCutActive;defaultMinValue;defaultMaxValue;defaultApplyMaxValue;defaultApplyMinValue;constructor(e,t,i,r=1,s=!0,a=!0){this.field=e,this.minValue=t,this.maxValue=i,this.step=r,this.minCutActive=s,this.maxCutActive=a,this.defaultMinValue=t,this.defaultMaxValue=i,this.defaultApplyMinValue=s,this.defaultApplyMaxValue=a}enableMaxCut(e){this.maxCutActive=e}enableMinCut(e){this.minCutActive=e}cutPassed(e){return(!this.maxCutActive||e<=this.maxValue)&&(!this.minCutActive||e>this.minValue)}reset(){this.minValue=this.defaultMinValue,this.maxValue=this.defaultMaxValue,this.minCutActive=this.defaultApplyMinValue,this.maxCutActive=this.defaultApplyMaxValue}}const Ege=new It,dQ=new class tme{constructor(e=new It,t=new It){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){nq.subVectors(e,this.start),ZI.subVectors(this.end,this.start);const i=ZI.dot(ZI);let s=ZI.dot(nq)/i;return t&&(s=bd(s,0,1)),s}closestPointToPoint(e,t,i){const r=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}},JF=new dA,uQ=new It,g4=new hm;class Tge{constructor(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new hQ,this.unassigned=new hQ,this.vertices=[]}setFromPoints(e){if(e.length>=4){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.vertices.push(new Dge(e[t]));this.compute()}return this}setFromObject(e){const t=[];return e.updateMatrixWorld(!0),e.traverse(function(i){const r=i.geometry;if(void 0!==r){const s=r.attributes.position;if(void 0!==s)for(let a=0,l=s.count;a<l;a++){const d=new It;d.fromBufferAttribute(s,a).applyMatrix4(i.matrixWorld),t.push(d)}}}),this.setFromPoints(t)}containsPoint(e){const t=this.faces;for(let i=0,r=t.length;i<r;i++)if(t[i].distanceToPoint(e)>this.tolerance)return!1;return!0}intersectRay(e,t){const i=this.faces;let r=-1/0,s=1/0;for(let a=0,l=i.length;a<l;a++){const d=i[a],u=d.distanceToPoint(e.origin),p=d.normal.dot(e.direction);if(u>0&&p>=0)return null;const _=0!==p?-u/p:0;if(!(_<=0)&&(p>0?s=Math.min(_,s):r=Math.max(_,r),r>s))return null}return e.at(r!==-1/0?r:s,t),t}intersectsRay(e){return null!==this.intersectRay(e,Ege)}makeEmpty(){return this.faces=[],this.vertices=[],this}addVertexToFace(e,t){return e.face=t,null===t.outside?this.assigned.append(e):this.assigned.insertBefore(t.outside,e),t.outside=e,this}removeVertexFromFace(e,t){return e===t.outside&&(t.outside=null!==e.next&&e.next.face===t?e.next:null),this.assigned.remove(e),this}removeAllVerticesFromFace(e){if(null!==e.outside){const t=e.outside;let i=e.outside;for(;null!==i.next&&i.next.face===e;)i=i.next;return this.assigned.removeSubList(t,i),t.prev=i.next=null,e.outside=null,t}}deleteFaceVertices(e,t){const i=this.removeAllVerticesFromFace(e);if(void 0!==i)if(void 0===t)this.unassigned.appendChain(i);else{let r=i;do{const s=r.next;t.distanceToPoint(r.point)>this.tolerance?this.addVertexToFace(r,t):this.unassigned.append(r),r=s}while(null!==r)}return this}resolveUnassignedPoints(e){if(!1===this.unassigned.isEmpty()){let t=this.unassigned.first();do{const i=t.next;let r=this.tolerance,s=null;for(let a=0;a<e.length;a++){const l=e[a];if(0===l.mark){const d=l.distanceToPoint(t.point);if(d>r&&(r=d,s=l),r>1e3*this.tolerance)break}}null!==s&&this.addVertexToFace(t,s),t=i}while(null!==t)}return this}computeExtremes(){const e=new It,t=new It,i=[],r=[];for(let s=0;s<3;s++)i[s]=r[s]=this.vertices[0];e.copy(this.vertices[0].point),t.copy(this.vertices[0].point);for(let s=0,a=this.vertices.length;s<a;s++){const l=this.vertices[s],d=l.point;for(let u=0;u<3;u++)d.getComponent(u)<e.getComponent(u)&&(e.setComponent(u,d.getComponent(u)),i[u]=l);for(let u=0;u<3;u++)d.getComponent(u)>t.getComponent(u)&&(t.setComponent(u,d.getComponent(u)),r[u]=l)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(e.x),Math.abs(t.x))+Math.max(Math.abs(e.y),Math.abs(t.y))+Math.max(Math.abs(e.z),Math.abs(t.z))),{min:i,max:r}}computeInitialHull(){const e=this.vertices,t=this.computeExtremes(),i=t.min,r=t.max;let s=0,a=0;for(let S=0;S<3;S++){const R=r[S].point.getComponent(S)-i[S].point.getComponent(S);R>s&&(s=R,a=S)}const l=i[a],d=r[a];let u,p;s=0,dQ.set(l.point,d.point);for(let S=0,R=this.vertices.length;S<R;S++){const H=e[S];if(H!==l&&H!==d){dQ.closestPointToPoint(H.point,!0,uQ);const re=uQ.distanceToSquared(H.point);re>s&&(s=re,u=H)}}s=-1,JF.setFromCoplanarPoints(l.point,d.point,u.point);for(let S=0,R=this.vertices.length;S<R;S++){const H=e[S];if(H!==l&&H!==d&&H!==u){const re=Math.abs(JF.distanceToPoint(H.point));re>s&&(s=re,p=H)}}const _=[];if(JF.distanceToPoint(p.point)<0){_.push(gg.create(l,d,u),gg.create(p,d,l),gg.create(p,u,d),gg.create(p,l,u));for(let S=0;S<3;S++){const R=(S+1)%3;_[S+1].getEdge(2).setTwin(_[0].getEdge(R)),_[S+1].getEdge(1).setTwin(_[R+1].getEdge(0))}}else{_.push(gg.create(l,u,d),gg.create(p,l,d),gg.create(p,d,u),gg.create(p,u,l));for(let S=0;S<3;S++){const R=(S+1)%3;_[S+1].getEdge(2).setTwin(_[0].getEdge((3-S)%3)),_[S+1].getEdge(0).setTwin(_[R+1].getEdge(1))}}for(let S=0;S<4;S++)this.faces.push(_[S]);for(let S=0,R=e.length;S<R;S++){const H=e[S];if(H!==l&&H!==d&&H!==u&&H!==p){s=this.tolerance;let re=null;for(let se=0;se<4;se++){const ce=this.faces[se].distanceToPoint(H.point);ce>s&&(s=ce,re=this.faces[se])}null!==re&&this.addVertexToFace(H,re)}}return this}reindexFaces(){const e=[];for(let t=0;t<this.faces.length;t++){const i=this.faces[t];0===i.mark&&e.push(i)}return this.faces=e,this}nextVertexToAdd(){if(!1===this.assigned.isEmpty()){let e,t=0;const i=this.assigned.first().face;let r=i.outside;do{const s=i.distanceToPoint(r.point);s>t&&(t=s,e=r),r=r.next}while(null!==r&&r.face===i);return e}}computeHorizon(e,t,i,r){let s;this.deleteFaceVertices(i),i.mark=1,s=null===t?t=i.getEdge(0):t.next;do{const a=s.twin,l=a.face;0===l.mark&&(l.distanceToPoint(e)>this.tolerance?this.computeHorizon(e,a,l,r):r.push(s)),s=s.next}while(s!==t);return this}addAdjoiningFace(e,t){const i=gg.create(e,t.tail(),t.head());return this.faces.push(i),i.getEdge(-1).setTwin(t.twin),i.getEdge(0)}addNewFaces(e,t){this.newFaces=[];let i=null,r=null;for(let s=0;s<t.length;s++){const l=this.addAdjoiningFace(e,t[s]);null===i?i=l:l.next.setTwin(r),this.newFaces.push(l.face),r=l}return i.next.setTwin(r),this}addVertexToHull(e){const t=[];return this.unassigned.clear(),this.removeVertexFromFace(e,e.face),this.computeHorizon(e.point,null,e.face,t),this.addNewFaces(e,t),this.resolveUnassignedPoints(this.newFaces),this}cleanup(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this}compute(){let e;for(this.computeInitialHull();void 0!==(e=this.nextVertexToAdd());)this.addVertexToHull(e);return this.reindexFaces(),this.cleanup(),this}}class gg{constructor(){this.normal=new It,this.midpoint=new It,this.area=0,this.constant=0,this.outside=null,this.mark=0,this.edge=null}static create(e,t,i){const r=new gg,s=new eO(e,r),a=new eO(t,r),l=new eO(i,r);return s.next=l.prev=a,a.next=s.prev=l,l.next=a.prev=s,r.edge=s,r.compute()}getEdge(e){let t=this.edge;for(;e>0;)t=t.next,e--;for(;e<0;)t=t.prev,e++;return t}compute(){const e=this.edge.tail(),t=this.edge.head(),i=this.edge.next.head();return g4.set(e.point,t.point,i.point),g4.getNormal(this.normal),g4.getMidpoint(this.midpoint),this.area=g4.getArea(),this.constant=this.normal.dot(this.midpoint),this}distanceToPoint(e){return this.normal.dot(e)-this.constant}}class eO{constructor(e,t){this.vertex=e,this.prev=null,this.next=null,this.twin=null,this.face=t}head(){return this.vertex}tail(){return this.prev?this.prev.vertex:null}length(){const e=this.head(),t=this.tail();return null!==t?t.point.distanceTo(e.point):-1}lengthSquared(){const e=this.head(),t=this.tail();return null!==t?t.point.distanceToSquared(e.point):-1}setTwin(e){return this.twin=e,e.twin=this,this}}class Dge{constructor(e){this.point=e,this.prev=null,this.next=null,this.face=null}}class hQ{constructor(){this.head=null,this.tail=null}first(){return this.head}last(){return this.tail}clear(){return this.head=this.tail=null,this}insertBefore(e,t){return t.prev=e.prev,t.next=e,null===t.prev?this.head=t:t.prev.next=t,e.prev=t,this}insertAfter(e,t){return t.prev=e,t.next=e.next,null===t.next?this.tail=t:t.next.prev=t,e.next=t,this}append(e){return null===this.head?this.head=e:this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e,this}appendChain(e){for(null===this.head?this.head=e:this.tail.next=e,e.prev=this.tail;null!==e.next;)e=e.next;return this.tail=e,this}remove(e){return null===e.prev?this.head=e.next:e.prev.next=e.next,null===e.next?this.tail=e.prev:e.next.prev=e.prev,this}removeSubList(e,t){return null===e.prev?this.head=t.next:e.prev.next=t.next,null===t.next?this.tail=e.prev:t.next.prev=e.prev,this}isEmpty(){return null===this.head}}class Ige extends no{constructor(e=[]){super();const t=[],i=[],s=(new Tge).setFromPoints(e).faces;for(let a=0;a<s.length;a++){const l=s[a];let d=l.edge;do{const u=d.head().point;t.push(u.x,u.y,u.z),i.push(l.normal.x,l.normal.y,l.normal.z),d=d.next}while(d!==l.edge)}this.setAttribute("position",new Ws(t,3)),this.setAttribute("normal",new Ws(i,3))}}const bp={Hits:new Cr(16711680),Tracks:new Cr(16711680),Jets:new Cr(2200782),CaloClusters:new Cr(16765286),MuonChambers:new Cr(16711680),Vertices:new Cr(16765286),MissingEnergy:new Cr(16777215),PlanarCaloCells:new Cr(16774810)};class tO{static step(e){const t=e.q/(e.unitC*e.p);let i,r,s,a,l,d,u;const p=nO.get(e.pos),_=e.dir.clone().cross(p).multiplyScalar(t),S=se=>{i=se*se,r=se/2;const ce=e.pos.clone().add(e.dir.clone().multiplyScalar(r)).add(_.clone().multiplyScalar(i/8));s=nO.get(ce),l=e.dir.clone().add(_.clone().multiplyScalar(r)).cross(s).multiplyScalar(t),d=e.dir.clone().add(l.clone().multiplyScalar(r)).cross(s).multiplyScalar(t);const Te=e.pos.clone().add(e.dir.clone().multiplyScalar(se)).add(d.clone().multiplyScalar(i/2));a=nO.get(Te),u=e.dir.clone().add(d.clone().multiplyScalar(se)).cross(a).multiplyScalar(t);const Ce=_.clone().sub(l).sub(d).add(u);return se*(Math.abs(Ce.x)+Math.abs(Ce.y)+Math.abs(Ce.z))};let R=S(e.stepSize);for(;R>2e-4;)e.stepSize*=.5,R=S(e.stepSize);const H=e.stepSize,re=Math.pow(H,2);return e.pos.add(e.dir.clone().multiplyScalar(H)).add(_.clone().add(l).add(d).multiplyScalar(re/6)),e.dir.add(_.clone().add(l.clone().multiplyScalar(2)).add(d.clone().multiplyScalar(2)).add(u).multiplyScalar(H/6)),e.dir.normalize(),e.stepSize}static propagate(e,t,i,r,s=-1,a=1e3,l=(()=>!0)){const d=new Bge;d.pos=e,d.dir=t,d.p=i,d.q=r,d.maxStepSize=s;const u=[];for(;d.pathLength<a;){d.pathLength+=tO.step(d);const p=JSON.parse(JSON.stringify(d));if(u.push({pos:p.pos,dir:p.dir}),!l(p.pos))break}return u}}class Bge{pos=new It(0,0,0);dir=new It(0,0,0);p=0;q=1;unitC=3.3333;stepSize=1e3;maxStepSize=10;pathLength=0}class nO{static get(e){return new It(0,0,2)}}class wE{static extrapolationLimit(e){return!(e.z>3e3||Math.sqrt(e.x*e.x+e.y*e.y)>1100)}static getTracksWithRungeKutta(e){const t=Object.assign({},e);for(const r of Object.keys(t))for(const s of t[r])s.pos=wE.extrapolateTrackPositions(s);return{}}static extrapolateTrackPositions(e,t=wE.extrapolationLimit){const i=e.dparams,r=i[0],a=i[2];let l=i[3];const d=i[4];let u;l<0&&(l+=Math.PI),u=0!==d?Math.abs(1/d):Number.MAX_VALUE;const p=Math.round(u*d),_=Ff.sphericalToCartesian(u,l,a),S=Ff.sphericalToCartesian(r,l,a),R=[];R.push([S.x,S.y,S.z]);const H=_.clone();H.normalize();const se=tO.propagate(S,H,u,p,5,1500,t).map(ce=>[ce.pos.x,ce.pos.y,ce.pos.z]);return R.concat(se)}}class Md{static getTracks(e){const t=new Oq,i=new SAe({lineWidth:2});for(const s of e){if(s.pos?.length>2||(s.dparams&&(s.pos=wE.extrapolateTrackPositions(s)),s.extended=!0),s.pos.length<2){console.log("Track too short, and extrapolation failed.");continue}s?.dparams&&(s?.phi||(s.phi=s.dparams[2]),s?.eta||(s.eta=Ff.thetaToEta(s.dparams[3])),s?.d0||(s.d0=s.dparams[0]),s?.z0||(s.z0=s.dparams[1]));const a=s.pos.map(p=>new It(p[0],p[1],p[2])),d=new X5(a).getPoints(50),u=s.color?parseInt(s.color,16):bp.Tracks.getHex();s.tid=t.addTrack(d,u),s.material=i}t.process();const r=new ua(t,i);r.name="Track";for(const s of e)s.uuid=r.uuid;return r}static getTrack(e){e.pos?.length>2||(e.dparams&&(e.pos=wE.extrapolateTrackPositions(e)),e.extended=!0);const t=e.pos;if(t.length<2)return void console.log("Track too short, and extrapolation failed.");e?.dparams&&(e?.phi||(e.phi=e.dparams[2]),e?.eta||(e.eta=Ff.thetaToEta(e.dparams[3])),e?.d0||(e.d0=e.dparams[0]),e?.z0||(e.z0=e.dparams[1]));const i=e.color?parseInt(e.color,16):bp.Tracks.getHex(),r=[];for(let H=0;H<t.length;H++){r.push(new It(t[H][0],t[H][1],t[H][2]));const re=Math.sqrt(t[H][0]*t[H][0]+t[H][1]*t[H][1]+t[H][2]*t[H][2]);Math.acos(t[H][2]/re)}const s=new X5(r),a=new Xb(s,void 0,2),l=new BG({color:i}),d=new ua(a,l),u=s.getPoints(50),p=(new no).setFromPoints(u),_=new Dc({color:i,linewidth:2}),S=new fg(p,_);S.name="Track";const R=new Wl;R.add(d),R.add(S);for(const H of[d,R,S])H.userData=Object.assign({},e),H.name="Track";return e.uuid=R.uuid,R}static getJet(e){const i=e.phi,r=e.theta?e.theta:Ff.etaToTheta(e.eta),s=.2*(e.energy?e.energy:e.et),a=Math.sin(i),l=Math.cos(i),d=Math.sin(r),u=Math.cos(r),p=new It(.5*s*l*d,.5*s*a*d,.5*s*u),_=e.coneR?s*Math.sin(e.coneR):.1*s,S=l*d,R=a*d,H=u,re=new It(0,1,0),se=new It(S,R,H),ce=new Gc;ce.setFromUnitVectors(re,se);const Te=new rC(_,10,s,50,50,!1),Ce=new xd({color:e.color??bp.Jets,opacity:.3,transparent:!0});Ce.opacity=.5;const qe=new ua(Te,Ce);return qe.position.copy(p),qe.quaternion.copy(ce),qe.userData=Object.assign({},e),qe.name="Jet",e.uuid=qe.uuid,qe}static getHits(e){let t,r="Point",s=3,a=!1;if(!(e.length>0))return console.log("No hits! Aborting from getHits."),new Pl;{const p=e[0];Array.isArray(p)?(a=!0,t={pos:e}):(t=e,"type"in p&&(r=p.type))}("Line"===r||"Box"===r)&&(s=6);const l=e.length*s;a&&(length=l);const d=new Float32Array(l);let u=0;for(const p of e)for(let _=0;_<s;++_,++u)d[u]=a?p[_]:p.pos[_];switch(r){case"Point":return Md.hitsToPoints(d,e,t);case"CircularPoint":return Md.hitsToCircularPoints(d,e,t);case"Line":return Md.hitsToLines(d,e,t);case"Box":return Md.hitsToBoxes(d,e,t);default:return void console.log("ERROR: Unknown hit type!")}}static hitsToPoints(e,t,i){const r=new no;r.setAttribute("position",new No(e,3)),r.computeBoundingSphere();const a=new X_({size:10,color:parseInt(t[0].color)??bp.Hits}),l=new Wb(r,a);return l.userData={},l.name="Hit",t.uuid=l.uuid,l}static hitsToCircularPoints(e,t,i){const r=new no;r.setAttribute("position",new No(e,3)),r.computeBoundingSphere();const s=document.createElement("canvas");s.width=128,s.height=128;const a=s.getContext("2d");a.clearRect(0,0,128,128),a.fillStyle="white",a.beginPath(),a.arc(64,64,64,0,2*Math.PI),a.fill();const l=new AG(s),d=new X_({size:t[0].size??10,color:t[0].color??bp.Hits,map:l,alphaMap:l,alphaTest:.5}),u=new Wb(r,d);return u.userData={},u.name="CircularHit",t.uuid=u.uuid,u}static hitsToLines(e,t,i){const r=new no;r.setAttribute("position",new No(e,3)),r.computeBoundingSphere();const s=new Dc({linewidth:2,color:t.color??bp.Hits}),a=new hc(r,s);return a.userData={},a.name="LineHit",t.uuid=a.uuid,a}static hitsToBoxes(e,t,i){const r=[];for(let d=0;d<e.length;d+=6){const u=new yp(e[d+3],e[d+4],e[d+5]);u.translate(e[d],e[d+1],e[d+2]),r.push(u)}const s=TF(r);s.computeBoundingSphere();const a=new pg({color:t.color??bp.Hits}),l=new ua(s,a);return l.userData={},l.name="BoxHit",t.uuid=l.uuid,l}static getCluster(e,t=1800,i=3600,r=.03){const l=Md.getCaloCube(e,e.side??40,e.energy*r),d=Md.getCaloPosition(e,t,i);return l.position.copy(d),l.lookAt(new It(0,0,0)),l.userData=Object.assign({},e),l.name="Cluster",e.uuid=l.uuid,l}static getCaloPosition(e,t=1800,i=3600,r=!0){const s=e.theta??Ff.etaToTheta(e.eta),l=Ff.sphericalToCartesian(r?e.radius??t+i:e.radius??t,s,e.phi);if(e.z&&l.setLength(l.length()*e.z/Math.abs(l.z)),!e.radius&&!e.z){Math.abs(l.z)>i&&l.setLength(l.length()*i/Math.abs(l.z));const d=l.x*l.x+l.y*l.y,u=t*t;d>u&&l.setLength(l.length()*Math.sqrt(u)/Math.sqrt(d))}return l}static getCaloCube(e,t=30,i=30){const r=e.side??t;let s=e.length??i;s<r&&(s=r);const a=new yp(r,r,s),l=new pg({color:e.color??bp.CaloClusters,opacity:e.opacity??1,transparent:1!=(e.opacity??1)});return new ua(a,l)}static getCaloCell(e){const a=Md.getCaloCube(e,30,30),l=Md.getCaloPosition(e,1700,2e3);return a.position.copy(l),e.radius||e.z?e.z&&!e.radius&&a.lookAt(new It(l.x,l.y,0)):a.lookAt(new It(0,0,0)),e.radius&&a.lookAt(new It(0,0,l.z)),a.userData=Object.assign({},e),a.name="Cluster",e.uuid=a.uuid,a}static getPlanarCaloCells(e){const t=[];for(const s of e){const a=s.pos;if(!a)continue;const l=.22*s.energy,d=s.cellSize,u=s.plane,p=new yp(d,d,l);p.translate(a[0],a[1],u[3]+l/2);const _=new Gc;_.setFromUnitVectors(new It(0,0,1),new It(...u.slice(0,3))),p.applyQuaternion(_),t.push(p)}const i=new pg({color:e[0].color??bp.PlanarCaloCells}),r=new ua(TF(t),i);r.userData=Object.assign({},e[0]),r.name="PlanarCaloCell";for(const s of e)s.uuid=r.uuid;return r}static getPlanarCaloCell(e){const t=e.pos;if(!t)return;const i=.22*e.energy,r=e.cellSize,s=e.plane,a=new yp(r,r,i),l=new Pl,d=new pg({color:e.color??bp.PlanarCaloCells}),u=new ua(a,d);l.add(u);const p=new It(...t.slice(0,2),s[3]+i/2);u.position.copy(p);const _=new Gc;return _.setFromUnitVectors(new It(0,0,1),new It(...s.slice(0,3))),l.quaternion.copy(_),l.userData=Object.assign({},e),l.name="PlanarCaloCell",e.uuid=l.uuid,l}static getVertex(e){const t=new Gy(e.size??3),i=new pg({color:e.color??bp.Vertices}),r=new ua(t,i);return"pos"in e?(r.position.x=e.pos[0],r.position.y=e.pos[1],r.position.z=e.pos[2]):(r.position.x=e.x,r.position.y=e.y,r.position.z=e.z),r.userData=Object.assign({},e),r.name="Vertex",e.uuid=r.uuid,r}static getMissingEnergy(e){const t=[];t.push(new It(0,0,0)),t.push(new It(e.etx,e.ety,0));const i=(new no).setFromPoints(t),r=new Yb({linewidth:2,dashSize:2,color:e.color??bp.MissingEnergy}),s=new fg(i,r);return s.computeLineDistances(),s.userData=Object.assign({},e),s.name="Missing Energy",e.uuid=s.uuid,s}static getIrregularCaloCell(e){const t=[];for(let l=0;l<24;l+=3)t.push(new It(e.vtx[l],e.vtx[l+1],e.vtx[l+2]));const i=new Ige(t),r=new Cr("rgb("+e.color[0].toString()+","+e.color[1].toString()+","+e.color[2].toString()+")"),s=new pg({color:r,transparent:!0,opacity:e.opacity}),a=new ua(i,s);return a.userData=Object.assign({},e),a.name="IrregularCaloCell",e.uuid=a.uuid,a}}const fQ=(n,e,t)=>`${n} > ${e} > ${t}`;class Z_{graphicsLibrary;ui;eventData;loadingManager;stateManager;labelsObject={};constructor(){this.loadingManager=new LF,this.stateManager=new ax}buildEventData(e,t,i,r){this.graphicsLibrary=t,this.ui=i,this.eventData=e,this.loadObjectTypes(e);const s=e["event number"]?e["event number"]:e.eventNumber,a=e["run number"]?e["run number"]:e.runNumber;r.add("Event#"+s+" from run#"+a,"Loaded"),this.stateManager.eventMetadata={runNumber:a,eventNumber:s}}getEventsList(e){const t=[];for(const i in e)null!==e[i]&&t.push(i);return t}getCollections(){if(!this.eventData)return null;const e=[];for(const t in this.eventData)if(this.eventData[t]&&"object"==typeof this.eventData[t])for(const i in this.eventData[t])e.push(i);return e}getCollection(e){if(!this.eventData)return null;for(const t in this.eventData)if(this.eventData[t])for(const i in this.eventData[t])if(i===e)return this.eventData[t][i]}loadObjectTypes(e){const t=parseFloat(Math.PI.toFixed(2));if(e.Tracks){const i=[new Cl("phi",-t,t,.01),new Cl("eta",-4,4,.1),new Cl("chi2",0,100),new Cl("dof",0,100),new Cl("pT",0,5e4,.1),new Cl("z0",-30,30,.1),new Cl("d0",-30,30,.1)];this.addObjectType(e.Tracks,Md.getTrack,"Tracks",!1,i)}if(e.Jets){const i=[new Cl("phi",-t,t,.01),new Cl("eta",-5,5,.1),new Cl("energy",0,6e5,100)],s=this.addScaleOptions("jetsScale","Jets Scale",a=>{this.graphicsLibrary.getSceneManager().scaleJets(a)});this.addObjectType(e.Jets,Md.getJet,"Jets",!1,i,s)}if(e.Hits&&this.addObjectType(e.Hits,Md.getHits,"Hits",!0),e.CaloClusters){const i=[new Cl("phi",-t,t,.01),new Cl("eta",-5,5,.1),new Cl("energy",0,1e4)],s=this.addScaleOptions("caloClustersScale","CaloClusters Scale",a=>{this.graphicsLibrary.getSceneManager().scaleChildObjects("CaloClusters",a,"z")});this.addObjectType(e.CaloClusters,Md.getCluster,"CaloClusters",!1,i,s)}if(e.CaloCells){const i=[new Cl("phi",-t,t,.01),new Cl("eta",-5,5,.1),new Cl("energy",0,1e4)],s=this.addScaleOptions("caloCellsScale","CaloCells Scale",a=>{this.graphicsLibrary.getSceneManager().scaleChildObjects("CaloCells",a,"z")});this.addObjectType(e.CaloCells,Md.getCaloCell,"CaloCells",!1,i,s)}if(e.PlanarCaloCells){const i=[new Cl("energy",0,1e4)],s=this.addScaleOptions("planarCaloCellsScale","PlanarCaloCells Scale",l=>{this.graphicsLibrary.getSceneManager().scaleChildObjects("PlanarCaloCells",l,"z")}),a={};for(const l in e.PlanarCaloCells){const d=e.PlanarCaloCells[l],u=d.plane,p=new It(...u.slice(0,3)).normalize();d.cells.forEach(_=>_.plane=[...p.toArray(),u[3]]),a[l]=d.cells}this.addObjectType(a,Md.getPlanarCaloCell,"PlanarCaloCells",!1,i,s)}if(e.IrregularCaloCells){const i=[new Cl("layer",0,10),new Cl("energy",0,1e4)],s=this.addScaleOptions("IrregularCaloCellsScale","IrregularCaloCells Scale",a=>{this.graphicsLibrary.getSceneManager().scaleChildObjects("IrregularCaloCells",a,"z")});this.addObjectType(e.IrregularCaloCells,Md.getIrregularCaloCell,"IrregularCaloCells",!1,i,s)}if(e.Muons){const i=[new Cl("phi",-t,t,.01),new Cl("eta",-4,4,.1),new Cl("energy",0,1e4),new Cl("pT",0,5e4)];this.addObjectType(e.Muons,this.getCompoundTrack,"Muons",!1,i)}if(e.Photons){const i=[new Cl("phi",-t,t,.01),new Cl("eta",-4,4,.1),new Cl("energy",0,1e4),new Cl("pT",0,5e4)];this.addObjectType(e.Photons,this.getCompoundCluster,"Photons",!1,i)}if(e.Electrons){const i=[new Cl("phi",-t,t,.01),new Cl("eta",-4,4,.1),new Cl("energy",0,1e4),new Cl("pT",0,5e4)];this.addObjectType(e.Electrons,this.getCompoundTrack,"Electrons",!1,i)}if(e.Vertices){const i=[new Cl("vertexType",0,5)],s=this.addScaleOptions("verticesScale","Vertices Scale",a=>{this.graphicsLibrary.getSceneManager().scaleChildObjects("Vertices",a)});this.addObjectType(e.Vertices,Md.getVertex,"Vertices",!1,i,s)}e.MissingEnergy&&this.addObjectType(e.MissingEnergy,Md.getMissingEnergy,"MissingEnergy",!1,[],(r,s)=>{const a=l=>{this.graphicsLibrary.getSceneManager().scaleChildObjects("MissingEnergy",l)};r&&r.add({jetsScale:100},"jetsScale",1,200).name("Size (%)").onChange(a),s&&s.addConfig("slider",{label:"Size (%)",value:100,min:1,max:200,allowCustomValue:!0,onChange:a})})}addObjectType(e,t,i,r=!1,s,a){const l=this.graphicsLibrary.addEventDataTypeGroup(i),d=this.getObjectTypeCollections(e);this.ui.addEventDataTypeFolder(i);for(const _ of d){const S=e[_];console.log(`${i} collection ${_} has ${S.length} constituents.`),0!=S.length?(this.addCollection(S,_,t,i,l,r),s=s?.filter(R=>R.field in S[0]),this.ui.addCollection(i,_,s)):console.log("Skipping")}const u=this.ui.getUIMenus().find(_=>_ instanceof lQ)?.getEventDataTypeFolder(i),p=this.ui.getUIMenus().find(_=>_ instanceof ZF)?.getEventDataTypeFolder(i);a?.(u,p)}addCollection(e,t,i,r,s,a){const l=new Wl;if(l.name=t,a){const d=i.bind(this)(e,r);d&&l.add(d)}else for(const d of e){const u=i.bind(this)(d,r);u&&l.add(u)}s.add(l)}getObjectTypeCollections(e){const t=[];for(const i in e)null!==e[i]&&t.push(i);return t}getCompoundTrack(e,t=""){return this.getCompound(e,t,!0,!1)}getCompoundCluster(e,t=""){return this.getCompound(e,t,!1,!0)}getCompound(e,t="",i=!1,r=!1){const s=new Wl;if("LinkedClusters"in e&&e.LinkedClusters)for(const a of e.LinkedClusters){const l=a.split(":")[0],d=a.split(":")[1];if(l&&d&&this.eventData.CaloClusters&&this.eventData.CaloClusters[l]){const u=this.eventData.CaloClusters[l][d];if(u){const p=Md.getCluster(u);p.name=t+" Cluster",s.add(p)}}}else if(r){const l=Md.getCluster({energy:e?.energy,phi:e?.phi,eta:e?.eta});l.name=t+" Cluster",s.add(l)}if("LinkedTracks"in e&&e.LinkedTracks)for(const a of e.LinkedTracks){const l=a.split(":")[0],d=a.split(":")[1];if(l&&d&&this.eventData.Tracks&&this.eventData.Tracks[l]){const u=this.eventData.Tracks[l][d];if(u){const p=Md.getTrack(u);p?(p.name=t+" Track",s.add(p)):console.log("WARNING: failed to get a track back.")}}}else if(i){new It(0,0,0);const l=Ff.etaToTheta(e.eta),d=e.pt/Math.cos(Math.PI/2-l);let u=0;"pdgId"in e&&(u=e.pdgId>0?1:-1);const _=Md.getTrack({dparams:[0,0,e.phi,l,u/d]});_?(_.name=t+" Track",s.add(_)):console.log("WARNING: failed to get a track back.")}return e.uuid=s.uuid,s.name=t,s}getEventMetadata(){const e=[],t=[[{keys:["runNumber","run number"],label:"Run"},{keys:["eventNumber","event number"],label:"Event"},{keys:["ls"],label:"LS"},{keys:["lumiBlock"],label:"LumiBlock"}],[{keys:["time"],label:"Data recorded"}]],i=Object.keys(this.eventData);for(const r of t){const s={};for(const a of r)for(const l of a.keys)if(i.includes(l)&&l in this.eventData){s[a.label]=this.eventData[l];break}Object.keys(s).length>0&&e.push({label:Object.keys(s).join(" / "),value:Object.values(s).join(" / ")})}return e}addLabelToEventObject(e,t,i){for(const r in this.eventData)if(this.eventData?.[r]?.[t])return this.labelsObject[r]=this.labelsObject[r]||{},this.labelsObject[r][t]=this.labelsObject[r][t]||{},this.labelsObject[r][t][i]=e,fQ(r,t,i)}getLabelsObject(){return this.labelsObject}addScaleOptions(e,t,i){return(r,s)=>{r&&r.add({[e]:1},e,.001,100).name(t).onChange(i),s&&s.addConfig("slider",{label:t,value:1,min:.001,step:.01,max:100,allowCustomValue:!0,onChange:i})}}}class CE extends Z_{data;constructor(){super(),this.data={}}process(e){console.log("Processing JiveXML event data"),this.data=e}getEventData(){const i=(new DOMParser).parseFromString(this.data,"text/xml").getElementsByTagName("Event")[0],r={eventNumber:i.getAttribute("eventNumber"),runNumber:i.getAttribute("runNumber"),lumiBlock:i.getAttribute("lumiBlock"),time:i.getAttribute("dateTime"),Hits:void 0,Tracks:{},Jets:{},CaloClusters:{},CaloCells:{},PlanarCaloCells:{},Vertices:{},Electrons:{},Muons:{},Photons:{},MissingEnergy:{}};return this.getPixelClusters(i,r),this.getSCTClusters(i,r),this.getTRT_DriftCircles(i,r),this.getMuonPRD(i,"MDT",r),this.getRPC(i,r),this.getMuonPRD(i,"TGC",r),this.getMuonPRD(i,"CSCD",r),this.getMuonPRD(i,"MM",r),this.getMuonPRD(i,"STGC",r),this.getTracks(i,r),this.getJets(i,r),this.getCaloClusters(i,r),this.getCaloCells(i,"LAr",r),this.getCaloCells(i,"HEC",r),this.getCaloCells(i,"Tile",r),this.getVertices(i,r),this.getMissingEnergy(i,r),this.getElectrons(i,r),this.getMuons(i,r),this.getPhotons(i,r),r}getNumberArrayFromHTML(e,t){let i=[];const r=e.getElementsByTagName(t);return r.length&&(i=r[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number)),i}getStringArrayFromHTML(e,t){return e.getElementsByTagName(t)[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(String)}getPositionOfHit(e,t){for(const i in t.Hits)for(const r of t.Hits[i])if(null==r)console.log("Empty hit");else if("id"in r&&r.id==e)return[!0,r.pos[0],r.pos[1],r.pos[2]];return[!1,0,0,0]}getTracks(e,t){const i=e.getElementsByTagName("Track"),r=Array.from(i),s={};for(const a of r){let l=a.getAttribute("storeGateKey");"Tracks"===l&&(l="Tracks_");const d=Number(a.getAttribute("count")),u=[];let _,S,R,H;if(0===a.getElementsByTagName("numPolyline").length)console.log("WARNING the track collection "+l+" has no line information. Will rely on Phoenix to extrapolate.");else{H=this.getNumberArrayFromHTML(a,"numPolyline");const Kt=a.getElementsByTagName("polylineX");Kt.length>0?(_=Kt[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),S=this.getNumberArrayFromHTML(a,"polylineY"),R=this.getNumberArrayFromHTML(a,"polylineZ")):(H=null,_=null,S=null,R=null)}const re=this.getNumberArrayFromHTML(a,"chi2"),se=this.getNumberArrayFromHTML(a,"numDoF"),ce=this.getNumberArrayFromHTML(a,"pt"),Te=this.getNumberArrayFromHTML(a,"d0"),Ce=this.getNumberArrayFromHTML(a,"z0"),qe=this.getNumberArrayFromHTML(a,"phi0"),wt=this.getNumberArrayFromHTML(a,"cotTheta");let Xt;this.getNumberArrayFromHTML(a,"hits"),this.getNumberArrayFromHTML(a,"numHits"),(d!=ce.length||d!=Te.length||d!=Ce.length||d!=wt.length)&&console.log("ERROR: Wrong number of some track variables. Corrupted JiveXML?"),a.getElementsByTagName("trackAuthor").length&&(Xt=this.getNumberArrayFromHTML(a,"trackAuthor"));let Un=0;H&&H.length!=d&&console.log("numPolyline ",H.length,"numOfTracks",d);for(let Kt=0;Kt<d;Kt++){let Gi=!0;const Yi=!1,En={chi2:0,dof:0,pT:0,phi:0,eta:0,pos:[],dparams:[],hits:{},author:{},badtrack:[]};re.length>=Kt&&(En.chi2=re[Kt]),se.length>=Kt&&(En.dof=se[Kt]),Xt?.length>=Kt&&(En.author=Xt[Kt]);let wi=Math.atan(1/wt[Kt]);En.pT=1e3*Math.abs(ce[Kt]);const zn=En.pT/Math.sin(wi);En.dparams=[Te[Kt],Ce[Kt],qe[Kt],wi,1/zn],En.phi=qe[Kt],wi<0&&(wi+=Math.PI),En.phi>Math.PI?En.phi-=2*Math.PI:En.phi<-Math.PI&&(En.phi+=2*Math.PI),Ff.anglesAreSane(wi,En.phi)||(s["Improper angles"]++,En.badtrack.push("Improper angles"),Gi=!1),En.eta=Ff.thetaToEta(wi),Number.isNaN(En.eta)&&(En.badtrack.push("Invalid eta"),Gi=!1);const oi=[];let vi=0,mr=0,Mr=0,is=0,$s=0;if(H){(Un+H[Kt]>_.length||Un+H[Kt]>S.length||Un+H[Kt]>R.length)&&console.log("ERROR: not enough points left for this track. Corrupted JiveXML?");for(let fi=0;fi<H[Kt];fi++)Mr=10*_[Un+fi],is=10*S[Un+fi],$s=10*R[Un+fi],oi.push([Mr,is,$s]),mr=Math.sqrt(Mr*Mr+is*is+$s*$s),mr<vi&&(console.log("WARNING: track positions do not seem to be sorted radially"),s["Hits not sorted"]++,En.badtrack.push("Hits not sorted")),Yi&&(console.log("pos: ",fi,"/",H[Kt],":",oi),console.log("theta:",wi,"theta from hit",Math.acos($s/mr))),vi=mr;Un+=H[Kt],En.pos=oi}Gi&&u.push(En)}H&&(Un!=_.length||Un!=S.length||Un!=R.length)&&console.log("ERROR: something has gone wrong with assigning the positions to the tracks!"),t.Tracks[l]=u}for(const a in s)s[a]>0&&console.log(s[a]+' tracks had "'+a+'" and were marked as bad.')}getPixelClusters(e,t){if(t.Hits={},0===e.getElementsByTagName("PixCluster").length)return;const i=e.getElementsByTagName("PixCluster")[0],r=Number(i.getAttribute("count")),s=this.getNumberArrayFromHTML(i,"id"),a=this.getNumberArrayFromHTML(i,"x0"),l=this.getNumberArrayFromHTML(i,"y0"),d=this.getNumberArrayFromHTML(i,"z0"),u=this.getNumberArrayFromHTML(i,"eloss");t.Hits.Pixel=[];for(let p=0;p<r;p++){const _={pos:[],id:0,energyLoss:0};_.pos=[10*a[p],10*l[p],10*d[p]],_.id=s[p],_.energyLoss=u[p],t.Hits.Pixel.push(_)}}getSCTClusters(e,t){if(0===e.getElementsByTagName("STC").length)return;const i=e.getElementsByTagName("STC")[0],r=Number(i.getAttribute("count")),s=this.getNumberArrayFromHTML(i,"id"),a=this.getNumberArrayFromHTML(i,"phiModule"),l=this.getNumberArrayFromHTML(i,"side"),d=this.getNumberArrayFromHTML(i,"x0"),u=this.getNumberArrayFromHTML(i,"y0"),p=this.getNumberArrayFromHTML(i,"z0");t.Hits.SCT=[];for(let _=0;_<r;_++){const S={pos:[],id:0,phiModule:0,side:0};S.pos=[10*d[_],10*u[_],10*p[_]],S.id=s[_],S.phiModule=a[_],S.side=l[_],t.Hits.SCT.push(S)}}getTRT_DriftCircles(e,t){if(0===e.getElementsByTagName("TRT").length)return;const i=e.getElementsByTagName("TRT")[0],r=Number(i.getAttribute("count")),s=this.getNumberArrayFromHTML(i,"driftR"),a=this.getNumberArrayFromHTML(i,"id"),l=this.getNumberArrayFromHTML(i,"noise"),d=this.getNumberArrayFromHTML(i,"phi"),u=this.getNumberArrayFromHTML(i,"rhoz"),p=this.getNumberArrayFromHTML(i,"sub"),_=this.getNumberArrayFromHTML(i,"threshold"),S=this.getNumberArrayFromHTML(i,"timeOverThreshold");t.Hits.TRT=[];for(let R=0;R<r;R++){const H={pos:[],id:0,type:"Line",driftR:0,threshold:0,timeOverThreshold:0,noise:!1};if(1==p[R]||2==p[R]){const re=1==p[R]?-3.5:3.5,se=1==p[R]?-742:742;H.pos=[Math.cos(d[R])*u[R]*10,Math.sin(d[R])*u[R]*10,re,Math.cos(d[R])*u[R]*10,Math.sin(d[R])*u[R]*10,se]}else{const re=Math.abs(u[R])>280?480:640,se=1030;H.pos=[Math.cos(d[R])*re,Math.sin(d[R])*re,10*u[R],Math.cos(d[R])*se,Math.sin(d[R])*se,10*u[R]]}H.id=a[R],H.driftR=s[R],H.noise=l[R],H.threshold=_[R],H.timeOverThreshold=S[R],t.Hits.TRT.push(H)}}getMuonPRD(e,t,i){if(0===e.getElementsByTagName(t).length)return;const r=e.getElementsByTagName(t)[0];"CSCD"==t&&(t="CSC");const s=Number(r.getAttribute("count")),a=this.getNumberArrayFromHTML(r,"x"),l=this.getNumberArrayFromHTML(r,"y"),d=this.getNumberArrayFromHTML(r,"z"),u=this.getNumberArrayFromHTML(r,"length"),p=this.getNumberArrayFromHTML(r,"id"),_=this.getStringArrayFromHTML(r,"identifier");i.Hits[t]=[];for(let S=0;S<s;S++){const R={pos:[],id:p[S],type:"Line",identifier:_[S]};R.pos=this.getMuonLinePositions(S,a,l,d,u),i.Hits[t].push(R)}}getRPC(e,t){const i="RPC";if(0===e.getElementsByTagName(i).length)return;const r=e.getElementsByTagName(i)[0],s=Number(r.getAttribute("count")),a=this.getNumberArrayFromHTML(r,"x"),l=this.getNumberArrayFromHTML(r,"y"),d=this.getNumberArrayFromHTML(r,"z"),u=this.getNumberArrayFromHTML(r,"length"),p=this.getNumberArrayFromHTML(r,"width"),_=this.getNumberArrayFromHTML(r,"id"),S=this.getStringArrayFromHTML(r,"identifier");t.Hits[i]=[];for(let R=0;R<s;R++){const H={pos:[],id:_[R],type:"Line",identifier:S[R],width:p[R]};H.pos=this.getMuonLinePositions(R,a,l,d,u),t.Hits[i].push(H)}}getMuonLinePositions(e,t,i,r,s){const a=Math.sqrt(t[e]*t[e]+i[e]*i[e]),l=s[e]/a;return[10*t[e]-i[e]*l*5,10*i[e]+t[e]*l*5,10*r[e],10*t[e]+i[e]*l*5,10*i[e]-t[e]*l*5,10*r[e]]}getJets(e,t){const i=e.getElementsByTagName("Jet"),r=Array.from(i);for(const s of r){const a=Number(s.getAttribute("count")),l=this.getNumberArrayFromHTML(s,"phi"),d=this.getNumberArrayFromHTML(s,"eta"),u=this.getNumberArrayFromHTML(s,"energy"),p=this.getNumberArrayFromHTML(s,"coneR"),_=[];for(let S=0;S<a;S++)_.push({coneR:p[S]??.4,phi:l[S],eta:d[S],energy:1e3*u[S]});t.Jets[s.getAttribute("storeGateKey")]=_}}getCaloClusters(e,t){const i=e.getElementsByTagName("Cluster"),r=Array.from(i);for(const s of r){const a=Number(s.getAttribute("count")),l=this.getNumberArrayFromHTML(s,"phi"),d=this.getNumberArrayFromHTML(s,"eta"),u=this.getNumberArrayFromHTML(s,"et"),p=[];for(let _=0;_<a;_++)p.push({phi:l[_],eta:d[_],energy:1e3*u[_]});t.CaloClusters[s.getAttribute("storeGateKey")]=p}}getFCALCaloCells(e,t,i){if(0===e.getElementsByTagName(t).length)return;const r=e.getElementsByTagName(t)[0],s=Number(r.getAttribute("count")),a=this.getNumberArrayFromHTML(r,"x"),l=this.getNumberArrayFromHTML(r,"y"),d=this.getNumberArrayFromHTML(r,"z"),u=this.getNumberArrayFromHTML(r,"dx"),_=(this.getNumberArrayFromHTML(r,"dy"),this.getNumberArrayFromHTML(r,"dz")),S=this.getNumberArrayFromHTML(r,"channel"),H=(this.getNumberArrayFromHTML(r,"energy"),this.getNumberArrayFromHTML(r,"id")),re=this.getStringArrayFromHTML(r,"slot");i.PlanarCaloCells[t]={cells:[]};let se=0;for(let ce=0;ce<s;ce++){const Te=d.length?10*d[ce]:10;i.PlanarCaloCells[t].cells.push({pos:[10*a[ce],10*l[ce],Te],length:_.length?10*_[ce]:u[ce],cellSize:10*u[ce],id:H[ce],slot:re[ce],channel:S[ce]}),se&&se!=Te&&console.log("WARNING - we're assuming that all cells have the same z. This is apparently not correct!"),se=Te}i.PlanarCaloCells[t].plane=[10,10,se]}getCaloCells(e,t="FCAL",i){if(0===e.getElementsByTagName(t).length)return;const r=e.getElementsByTagName(t)[0],s=Number(r.getAttribute("count")),a=this.getNumberArrayFromHTML(r,"eta"),l=this.getNumberArrayFromHTML(r,"phi"),d=this.getNumberArrayFromHTML(r,"channel"),u=this.getNumberArrayFromHTML(r,"energy"),p=this.getNumberArrayFromHTML(r,"id");this.getStringArrayFromHTML(r,"slot"),i.CaloCells[t]=[];for(let S=0;S<s;S++)i.CaloCells[t].push({eta:a[S],phi:l[S],id:p[S],energy:u[S],channel:d[S]})}getVertices(e,t){const i=e.getElementsByTagName("RVx"),r=Array.from(i);for(const s of r){const a=Number(s.getAttribute("count")),l=s.getElementsByTagName("x")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),d=s.getElementsByTagName("y")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),u=s.getElementsByTagName("z")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),p=s.getElementsByTagName("chi2")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),_=s.getElementsByTagName("primVxCand")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),S=s.getElementsByTagName("vertexType")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),R=s.getElementsByTagName("numTracks")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),H=s.getElementsByTagName("sgkey")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(String),re=s.getElementsByTagName("tracks")[0].innerHTML.replace(/\r\n|\n|\r/gm," ").trim().split(" ").map(Number),se=[];let ce=0;for(let Te=0;Te<a;Te++){const Ce=ce+R[Te],qe=[];for(;ce<Ce;ce++)ce>re.length&&console.log("Error! TrackIndex exceeds maximum number of track indices."),qe.push(re[ce]);se.push({x:l[Te],y:d[Te],z:u[Te],chi2:p[Te],primVxCand:_[Te],vertexType:S[Te],linkedTracks:qe,linkedTrackCollection:H[Te]})}t.Vertices[s.getAttribute("storeGateKey")]=se}}getMuons(e,t){const i=e.getElementsByTagName("Muon"),r=Array.from(i);for(const s of r){const a=Number(s.getAttribute("count")),l=[];for(let d=0;d<a;d++){const u=this.getNumberArrayFromHTML(s,"chi2"),p=this.getNumberArrayFromHTML(s,"energy"),_=this.getNumberArrayFromHTML(s,"eta"),S=this.getNumberArrayFromHTML(s,"phi"),R=this.getNumberArrayFromHTML(s,"pt"),H=this.getNumberArrayFromHTML(s,"pdgId");l.push({chi2:u[d],energy:p[d],eta:_[d],phi:S[d],pt:1e3*R[d],pdgId:H[d]})}t.Muons[s.getAttribute("storeGateKey")]=l}}getElectrons(e,t){const i=e.getElementsByTagName("Electron"),r=Array.from(i);for(const s of r){const a=Number(s.getAttribute("count")),l=[];for(let d=0;d<a;d++){const u=this.getStringArrayFromHTML(s,"author"),p=this.getNumberArrayFromHTML(s,"energy"),_=this.getNumberArrayFromHTML(s,"eta"),S=this.getNumberArrayFromHTML(s,"phi"),R=this.getNumberArrayFromHTML(s,"pt"),H=this.getNumberArrayFromHTML(s,"pdgId");l.push({author:u[d],energy:p[d],eta:_[d],phi:S[d],pt:1e3*R[d],pdgId:H[d]})}t.Electrons[s.getAttribute("storeGateKey")]=l}}getPhotons(e,t){const i=e.getElementsByTagName("Photon"),r=Array.from(i);for(const s of r){const a=Number(s.getAttribute("count")),l=[];for(let d=0;d<a;d++){const u=this.getStringArrayFromHTML(s,"author"),p=this.getNumberArrayFromHTML(s,"energy"),_=this.getNumberArrayFromHTML(s,"eta"),S=this.getNumberArrayFromHTML(s,"phi"),R=this.getNumberArrayFromHTML(s,"pt");l.push({author:u[d],energy:p[d],eta:_[d],phi:S[d],pt:1e3*R[d]})}t.Photons[s.getAttribute("storeGateKey")]=l}}getMissingEnergy(e,t){const i=e.getElementsByTagName("ETMis"),r=Array.from(i);for(const s of r){const a=Number(s.getAttribute("count")),l=[];for(let d=0;d<a;d++){const u=this.getStringArrayFromHTML(s,"et"),p=this.getNumberArrayFromHTML(s,"etx"),_=this.getNumberArrayFromHTML(s,"ety");l.push({et:u[d],etx:p[d],ety:_[d]})}t.MissingEnergy[s.getAttribute("storeGateKey")]=l}}}const pQ=function(){var n=(0,Ee.A)(function*(e){const t=new(d4()),i={};yield t.loadAsync(e);for(const r in t.files){const s=yield t.file(r).async("string");i[r]=s}return i});return function(t){return n.apply(this,arguments)}}(),Pge={file:"",type:"",config:"",hideWidgets:!1,embed:!1};class Rge{eventDisplay;configuration;urlOptions;constructor(e,t){this.eventDisplay=e,this.configuration=t,this.urlOptions=new URLSearchParams(window.location.href.substr(window.location.href.lastIndexOf("?")))}applyOptions(){this.applyEventOptions(this.configuration.defaultEventFile?.eventFile,this.configuration.defaultEventFile?.eventType),this.applyHideWidgetsOptions(),this.applyEmbedOption()}applyEventOptions(e,t){if(!("fetch"in window))return;let i,r;(!this.urlOptions.get("file")&&this.urlOptions.get("type")||this.urlOptions.get("file")&&!this.urlOptions.get("type"))&&(console.log("WARNING - if you set one of type or file, then you need to set both!"),console.log("WARNING - reverting to defaults!")),this.urlOptions.get("file")&&this.urlOptions.get("type")?(console.log("Setting and config from urlOptions"),i=this.urlOptions.get("file"),r=this.urlOptions.get("type").toLowerCase()):(console.log("Setting and config from defaults"),i=e,r=t),console.log("Loading ",i,"of type",r);const s=()=>{this.urlOptions.get("config")&&(this.eventDisplay.getLoadingManager().addLoadableItem("url_config"),fetch(this.urlOptions.get("config")).then(l=>l.json()).then(l=>{(new ax).loadStateFromJSON(l)}).finally(()=>{this.eventDisplay.getLoadingManager().itemLoaded("url_config")}))};i&&r?(this.eventDisplay.getLoadingManager().addLoadableItem("url_event"),(l=>"jivexml"===r?(console.log("Opening JiveXML"),this.handleJiveXMLEvent(l)):"zip"===r?(console.log("Opening zip file"),this.handleZipFileEvents(l)):this.handleJSONEvent(l))(i).catch(l=>{this.eventDisplay.getInfoLogger().add("Could not find the file specified in URL.","Error"),console.error("Could not find the file specified in URL.",l)}).finally(()=>{s(),this.eventDisplay.getLoadingManager().itemLoaded("url_event")})):s()}handleJiveXMLEvent(e){var t=this;return(0,Ee.A)(function*(){const i=yield(yield fetch(e)).text(),r=new CE;t.configuration.eventDataLoader=r,r.process(i);const s=r.getEventData();t.eventDisplay.buildEventDataFromJSON(s)})()}handleJSONEvent(e){var t=this;return(0,Ee.A)(function*(){const i=yield(yield fetch(e)).json();t.configuration.eventDataLoader=new Z_,t.eventDisplay.parsePhoenixEvents(i)})()}handleZipFileEvents(e){var t=this;return(0,Ee.A)(function*(){const i=yield(yield fetch(e)).arrayBuffer(),r={};let s;try{s=yield pQ(i)}catch(l){return console.error("Error while reading zip",l),void t.eventDisplay.getInfoLogger().add("Could not read zip file","Error")}Object.keys(s).filter(l=>l.endsWith(".json")).forEach(l=>{Object.assign(r,JSON.parse(s[l]))});const a=new CE;Object.keys(s).filter(l=>l.endsWith(".xml")||l.startsWith("JiveXML")).forEach(l=>{a.process(s[l]);const d=a.getEventData();Object.assign(r,{[l]:d})}),t.eventDisplay.parsePhoenixEvents(r)})()}applyHideWidgetsOptions(){this.hideIdsWithURLOption({hideWidgets:["mainLogo","uiMenu","experimentInfo","phoenixMenu","statsElement","gui"]})}applyEmbedOption(){"true"===this.urlOptions.get("embed")&&(this.hideIdsWithURLOption({embed:["mainLogo","uiMenu","experimentInfo","phoenixMenu","statsElement","gui"]}),document.getElementById("embedMenu")?.style.setProperty("display","block"))}hideIdsWithURLOption(e){Object.entries(e).forEach(([t,i])=>{"true"===this.urlOptions.get(t)&&i.forEach(r=>{document.getElementById(r)?.style.setProperty("display","none")})})}getURLOptions(){return this.urlOptions}}class kge{configuration;eventsData;onEventsChange=[];onDisplayedEventChange=[];graphicsLibrary;infoLogger;ui;loadingManager;stateManager;urlOptionsManager;constructor(e){this.loadingManager=new LF,this.infoLogger=new Mge,this.graphicsLibrary=new XAe(this.infoLogger),this.ui=new Cge(this.graphicsLibrary),e&&this.init(e)}init(e){this.configuration=e,this.graphicsLibrary.init(e),this.ui.init(e),this.getStateManager().setEventDisplay(this),this.graphicsLibrary.setAnimationLoop(()=>{this.ui.updateUI()}),this.urlOptionsManager=new Rge(this,e),!1!==e.allowUrlOptions&&this.urlOptionsManager.applyOptions(),this.enableEventDisplayConsole(),this.enableKeyboardControls()}initXR(e,t){this.graphicsLibrary.initXRSession(e,t)}endXR(e){this.graphicsLibrary.endXRSession(e)}parsePhoenixEvents(e){this.eventsData=e,typeof this.configuration.eventDataLoader>"u"&&(this.configuration.eventDataLoader=new Z_);const t=this.configuration.eventDataLoader.getEventsList(e);return this.loadEvent(t[0]),this.onEventsChange.forEach(i=>i(t)),t}buildEventDataFromJSON(e){this.resetLabels(),this.ui.addEventDataFolder(),this.ui.addLabelsFolder(),this.graphicsLibrary.clearEventData(),this.configuration.eventDataLoader.buildEventData(e,this.graphicsLibrary,this.ui,this.infoLogger),this.onDisplayedEventChange.forEach(t=>t(e)),this.ui.loadEventFolderPhoenixMenuState()}loadEvent(e){const t=this.eventsData[e];t&&this.buildEventDataFromJSON(t)}getThreeManager(){return this.graphicsLibrary}getUIManager(){return this.ui}getInfoLogger(){return this.infoLogger}getLoadingManager(){return this.loadingManager}getStateManager(){return this.stateManager||(this.stateManager=new ax),this.stateManager}getURLOptionsManager(){return this.urlOptionsManager}loadOBJGeometry(e,t,i,r,s,a=!0,l=!0){var d=this;return(0,Ee.A)(function*(){d.loadingManager.addLoadableItem(`obj_geom_${t}`);const{object:u}=yield d.graphicsLibrary.loadOBJGeometry(e,t,i,s,a,l);d.ui.addGeometry(u,r),d.loadingManager.itemLoaded(`obj_geom_${t}`),d.infoLogger.add(t,"Loaded OBJ geometry")})()}parseOBJGeometry(e,t,i,r=!0){this.loadingManager.addLoadableItem(`parse_obj_${t}`);const{object:s}=this.graphicsLibrary.parseOBJGeometry(e,t,r);this.ui.addGeometry(s,i),this.loadingManager.itemLoaded(`parse_obj_${t}`)}exportToOBJ(){this.graphicsLibrary.exportSceneToOBJ(),this.infoLogger.add("Exported scene to OBJ")}parsePhoenixDisplay(e){var t=this;return(0,Ee.A)(function*(){const i=JSON.parse(e);i.sceneConfiguration&&i.scene&&(t.ui.addEventDataFolder(),t.ui.addLabelsFolder(),t.graphicsLibrary.clearEventData(),t.loadSceneConfiguration(i.sceneConfiguration),t.loadingManager.addLoadableItem(`parse_phnx_${name}`),yield t.graphicsLibrary.parsePhnxScene(i.scene),t.loadingManager.itemLoaded(`parse_phnx_${name}`))})()}exportPhoenixDisplay(){this.graphicsLibrary.exportPhoenixScene()}exportGeometriesToGLTF(){this.graphicsLibrary.exportGeometriesToGLTF()}parseGLTFGeometry(e){var t=this;return(0,Ee.A)(function*(){const i=e.name.split("/").pop();t.loadingManager.addLoadableItem(`parse_gltf_${i}`);const r=yield t.graphicsLibrary.parseGLTFGeometry(e);for(const{object:s,menuNodeName:a}of r)t.ui.addGeometry(s,a);t.loadingManager.itemLoaded(`parse_gltf_${i}`)})()}loadGLTFGeometry(e,t,i,r,s=!0){var a=this;return(0,Ee.A)(function*(){a.loadingManager.addLoadableItem(`gltf_geom_${t}`);const l=yield a.graphicsLibrary.loadGLTFGeometry(e,t,i,r,s);for(const{object:d,menuNodeName:u}of l)a.ui.addGeometry(d,u);a.loadingManager.itemLoaded(`gltf_geom_${t}`)})()}loadJSONGeometry(e,t,i,r,s,a=!0){var l=this;return(0,Ee.A)(function*(){l.loadingManager.addLoadableItem(`json_geom_${t}`);const{object:d}=yield l.graphicsLibrary.loadJSONGeometry(e,t,r,s,a);l.ui.addGeometry(d,i),l.loadingManager.itemLoaded(`json_geom_${t}`),l.infoLogger.add(t,"Loaded JSON geometry")})()}loadRootJSONGeometry(e,t,i,r,s,a=!0){var l=this;return(0,Ee.A)(function*(){l.loadingManager.addLoadableItem("root_json_geom");const d=yield(0,qz.httpRequest)(e,"object");yield l.loadJSONGeometry((0,Qz.build)(d,{dflt_colors:!0}).toJSON(),t,i,r,s,a),l.loadingManager.itemLoaded("root_json_geom")})()}loadRootGeometry(e,t,i,r,s,a,l=!0){var d=this;return(0,Ee.A)(function*(){d.loadingManager.addLoadableItem("root_geom"),qz.settings.UseStamp=!1;const p=yield(yield(0,Wz.Tq)(e)).readObject(t);yield d.loadJSONGeometry((0,Qz.build)(p,{dflt_colors:!0}).toJSON(),i,r,s,a,l),d.loadingManager.itemLoaded("root_geom")})()}buildGeometryFromParameters(e){this.graphicsLibrary.addGeometryFromParameters(e)}zoomTo(e,t){this.graphicsLibrary.zoomTo(e,t)}loadSceneConfiguration(e){for(const t of Object.keys(e.eventData)){this.ui.addEventDataTypeFolder(t);const i=e.eventData[t];for(const r of i)this.ui.addCollection(t,r)}for(const t of e.geometries)this.ui.addGeometry(t,"#ffffff")}getCollection(e){return this.configuration.eventDataLoader.getCollection(e)}getCollections(){return this.configuration.eventDataLoader.getCollections()}listenToDisplayedEventChange(e){this.onDisplayedEventChange.push(e)}listenToLoadedEventsChange(e){this.onEventsChange.push(e)}getEventMetadata(){return this.configuration.eventDataLoader.getEventMetadata()}enableEventDisplayConsole(){window.EventDisplay={loadGLTFGeometry:(e,t)=>{this.loadGLTFGeometry(e,t)},loadOBJGeometry:(e,t,i,r,s)=>{this.loadOBJGeometry(e,t,i,r,s)},loadJSONGeometry:(e,t,i,r,s,a=!0)=>{this.loadJSONGeometry(e,t,i,r,s,a)},buildGeometryFromParameters:e=>this.buildGeometryFromParameters(e),scene:this.getThreeManager().getSceneManager().getScene()}}setOverlayRenderer(e){this.graphicsLibrary.setOverlayRenderer(e)}allowSelection(e){this.graphicsLibrary.setSelectedObjectDisplay(e)}enableSelecting(e){this.graphicsLibrary.enableSelecting(e)}fixOverlayView(e){this.graphicsLibrary.fixOverlayView(e)}getActiveObjectId(){return this.graphicsLibrary.getActiveObjectId()}lookAtObject(e,t=!1){1==t?(this.graphicsLibrary.lookAtObject(e,!0),this.graphicsLibrary.highlightObject(e,!0)):(this.graphicsLibrary.lookAtObject(e),this.graphicsLibrary.highlightObject(e))}highlightObject(e,t=!1){this.graphicsLibrary.highlightObject(e,1==t)}enableHighlighting(){this.graphicsLibrary.enableHighlighting()}disableHighlighting(){this.graphicsLibrary.disableHighlighting()}enableKeyboardControls(){this.ui.enableKeyboardControls(),this.graphicsLibrary.enableKeyboardControls()}animateThroughEvent(e,t,i){this.graphicsLibrary.animateThroughEvent(e,t,i)}animatePreset(e,t){this.graphicsLibrary.animatePreset(e,t)}animateEventWithCollision(e,t){this.graphicsLibrary.animateEventWithCollision(e,t)}animateClippingWithCollision(e,t){this.graphicsLibrary.animateClippingWithCollision(e,t)}addLabelToObject(e,t,i,r){const s=this.configuration.eventDataLoader.addLabelToEventObject(e,t,i);e?(this.ui.addLabel(s),this.graphicsLibrary.addLabelToObject(e,r,s)):this.ui.removeLabel(s,!0)}resetLabels(){const e=this.configuration.eventDataLoader.getLabelsObject();for(const t in e)for(const i in e[t])for(const r in e[t][i]){const s=fQ(t,i,r);this.ui.removeLabel(s,!0),delete e[t][i][r]}}}class lx{name;icon;onToggle;toggleState=!0;children=[];configs=[];nodeLevel=0;parent;childrenToggleState={};childrenActive=!1;configActive=!1;constructor(e,t,i,r,s,a){this.name=e,this.icon=t,this.onToggle=i,r&&(this.children=r),s&&(this.configs=s),a&&(this.parent=a)}addChild(e,t,i){const r=new lx(e,i,t);return r.parent=this,r.nodeLevel=this.nodeLevel+1,this.children.push(r),r}removeChild(e){const t=this.children.indexOf(e);return this.children.splice(t,1),this}remove(){this.parent?this.parent.removeChild(this):console.error("Cannot delete root node of phoenix menu. Set it to undefined/null instead.")}truncate(){this.children=[]}addConfig(e,t){const i=this.configs.push({type:e,...t});return this.applyConfigState(this.configs[i-1]),this}toggleSelfAndDescendants(e){this.onToggle?.(e),this.toggleState=e;for(const t of this.children)e?(t.toggleState=this.childrenToggleState[t.name],t.toggleSelfAndDescendants(t.toggleState)):(this.childrenToggleState[t.name]=t.toggleState,t.toggleSelfAndDescendants(e))}applyConfigState(e){"checkbox"===e.type&&e?.isChecked?e.onChange?.(e?.isChecked):"color"===e.type&&e?.color&&!e.group?e.onChange?.(e?.color):"slider"===e.type&&e?.value?e.onChange?.(e?.value):"rangeSlider"===e.type&&void 0!==e?.value&&(e.onChange?.({value:e?.value,highValue:e?.highValue}),e.setEnableMin?.(e?.enableMin),e.setEnableMax?.(e?.enableMax))}getNodeState(){const e={};e.name=this.name,e.nodeLevel=this.nodeLevel,e.toggleState=this.toggleState,e.childrenActive=this.childrenActive,e.configs=this.configs,e.children=[];for(const t of this.children)e.children.push(t.getNodeState());return e}loadStateFromJSON(e){let t;t="string"==typeof e?JSON.parse(e):e,this.childrenActive=t.childrenActive,this.toggleState=t.toggleState,void 0!==this.toggleState&&this.onToggle?.(this.toggleState);for(const i of t.configs){const r=this.configs.find(s=>s.type===i.type&&s.label===i.label);if(r){for(const s in i)r[s]=i[s];this.applyConfigState(r)}}for(const i of t.children){const r=this.children.filter(s=>s.name===i.name&&s.nodeLevel===i.nodeLevel)[0];r&&r.loadStateFromJSON(i)}}findInTree(e){if(this.name===e)return this;for(const t of this.children){const i=t.findInTree(e);if(i)return i}}findInTreeOrCreate(e){let t=this;return e.split(">").forEach(i=>{i=i.trim();const r=t.findInTree(i);t=r||t.addChild(i,()=>{})}),t}}class Fge{static getMuonChamber(e){let t=[];const i=(...u)=>{t=t.concat(...u.map(p=>e[p]))};i("front_1","front_2","front_3"),i("front_3","front_4","front_1"),i("back_1","back_2","back_3"),i("back_3","back_4","back_1"),i("back_1","back_2","front_2"),i("front_2","front_1","back_1"),i("back_4","back_3","front_3"),i("front_3","front_4","back_4"),i("front_1","front_4","back_4"),i("back_4","back_1","front_1"),i("front_2","back_2","back_3"),i("back_3","front_3","front_2");const r=new no;r.attributes.position=new No(new Float32Array(t),3),r.computeVertexNormals();const s=new ua(r,new xd({color:e.color??bp.MuonChambers,transparent:!0,opacity:.1,side:2}));s.userData=Object.assign({},e),s.name="MuonChamber";const a=new xG(r),l=new hc(a,new Dc({color:16777215,transparent:!0,opacity:.7})),d=new Wl;return d.add(s),d.add(l),e.uuid=s.uuid,d}}class mQ extends Z_{data;geometryScale=1e3;constructor(){super(),this.data={}}loadObjectTypes(e){super.loadObjectTypes(e),e.MuonChambers&&this.addObjectType(e.MuonChambers,Fge.getMuonChamber,"MuonChambers")}readIgArchive(e,t,i){this.loadingManager.addLoadableItem("ig_archive");const r=new(d4()),s=[],a=l=>{r.loadAsync(l).then(()=>{let d=Object.keys(r.files);i&&(d=d.filter(p=>p.includes(i)));let u=1;for(const p of d)p.toLowerCase().startsWith("events")?r.file(p).async("string").then(_=>{_=_.replace(/'/g,'"').replace(/\(/g,"[").replace(/\)/g,"]").replace(/nan/g,"0");const S=JSON.parse(_);S.eventPath=p,s.push(S),u===d.length&&(t(s),this.loadingManager.itemLoaded("ig_archive")),u++}):(u===d.length&&(t(s),this.loadingManager.itemLoaded("ig_archive")),u++)})};e instanceof File?a(e):fetch(e).then(l=>l.arrayBuffer()).then(l=>{a(l)})}loadEventDataFromIg(e,t,i){this.readIgArchive(e,r=>{i(r[0])},t)}getEventData(){const e=this.data?.Collections?.Event_V2?.[0],t={runNumber:e?.[0],eventNumber:e?.[1],ls:e?.[2],time:e?.[5],Hits:{},Tracks:{},Jets:{},CaloClusters:{},MuonChambers:{}};t.Hits=this.getTrackingClusters(t.Hits),t.Tracks=this.getTracks(),t.Jets=this.getJets(),t.CaloClusters=this.getCaloClusters(),t.MuonChambers=this.getMuonChambers();for(const i of["Hits","Tracks","Jets","CaloClusters","MuonChambers"])0===Object.keys(t[i]).length&&(t[i]=void 0);return t}getAllEventsData(e){const t={};for(const i of e)this.data=i,t[i.eventPath]=this.getEventData();return t}getTrackingClusters(e){const i=this.getObjectCollections(["TrackingRecHits_V1","SiStripClusters_V1","SiPixelClusters_V1","CSCLCTDigis_V1"],r=>{r.pos&&(r.pos=r.pos.map(s=>s*this.geometryScale))});return Object.assign(e,i),e}getCaloClusters(){return this.getObjectCollections(["SuperClusters_V1"],i=>{i.energy&&(i.energy*=this.geometryScale)})}getJets(){let e={};const t=Object.keys(this.data.Collections).filter(r=>r.toLowerCase().includes("jets"));return e=this.getObjectCollections(t,r=>{for(const s of["et","energy"])if(r[s]){r[s]*=this.geometryScale;break}},[{attribute:"et",min:10},{attribute:"energy",min:10}]),e}getMuonChambers(){return this.getObjectCollections(["MatchingCSCs_V1","MuonChambers_V1"],i=>{for(const r of Object.keys(i))(r.startsWith("front")||r.startsWith("back"))&&(i[r]=i[r].map(s=>s*this.geometryScale))})}getObjectCollections(e,t,i){const r={};e=e.filter(s=>this.data.Collections[s]);for(const s of e){r[s]=[];const a=this.data.Types[s];for(const l of this.data.Collections[s]){const d={};if(a.forEach((u,p)=>{d[u[0]]=l[p]}),i){let u=!0,p=!0;for(const _ of i)if(d[_.attribute]){if(_.max&&d[_.attribute]>_.max){u=!1;break}if(_.min&&d[_.attribute]<_.min){p=!1;break}}u&&p&&(t?.(d),r[s].push(d))}else t?.(d),r[s].push(d)}0===r[s].length&&delete r[s]}return r}getTracks(){const e={};let t=[{collection:"Tracks_V1",extras:"Extras_V1",assocs:"TrackExtras_V1",color:"0xff0000",min_pt:1},{collection:"Tracks_V2",extras:"Extras_V1",assocs:"TrackExtras_V1",color:"0xff0000",min_pt:1},{collection:"Tracks_V3",extras:"Extras_V1",assocs:"TrackExtras_V1",color:"0xff0000",min_pt:1},{collection:"StandaloneMuons_V2",extras:"Extras_V1",assocs:"MuonTrackExtras_V1",color:"0xf57842",min_pt:1},{collection:"PATStandaloneMuons_V1",extras:"Extras_V1",assocs:"PATMuonTrackExtras_V1",color:"0xf5aa42",min_pt:1},{collection:"TrackerMuons_V2",extras:"Extras_V1",assocs:"MuonTrackerExtras_V1",color:"0xe8d546",min_pt:2},{collection:"GsfElectrons_V1",extras:"Extras_V1",assocs:"GsfElectronExtras_V1",color:"0x1CFF1A",min_pt:10},{collection:"GsfElectrons_V2",extras:"Extras_V1",assocs:"GsfElectronExtras_V1",color:"0x1bcf9f",min_pt:10},{collection:"GsfElectrons_V3",extras:"Extras_V1",assocs:"GsfElectronExtras_V1",color:"0x1ad9ff",min_pt:10},{collection:"PATElectrons_V1",extras:"Extras_V1",assocs:"PATElectronExtras_V1",color:"0x1a40ff",min_pt:1}];t=t.filter(i=>this.data.Collections[i.collection]);for(const i of t){e[i.collection]=[];const r=this.data.Collections[i.collection],s=this.data.Collections[i.extras],a=this.data.Associations[i.assocs],l=this.data.Types[i.collection];let d,u,p,_,S,R,H,re,se,ce,Te,Ce;for(let qe=0;qe<a.length;qe++){if(Ce={},l.forEach((gt,Et)=>{Ce[gt[0]]=r[qe][Et]}),Ce.pt<i.min_pt)continue;Ce.color=i.color,d=a[qe][0][1],u=a[qe][1][1],p=new It(s[u][0][0],s[u][0][1],s[u][0][2]),_=new It(s[u][1][0],s[u][1][1],s[u][1][2]),_.normalize(),S=new It(s[u][2][0],s[u][2][1],s[u][2][2]),R=new It(s[u][3][0],s[u][3][1],s[u][3][2]),R.normalize(),H=p.distanceTo(S),re=.25*H,se=new It(p.x+re*_.x,p.y+re*_.y,p.z+re*_.z),ce=new It(S.x+re*R.x,S.y+re*R.y,S.z+re*R.z),Te=new Y5(p,se,S);const wt=[];for(const gt of Te.getPoints(24))gt.multiplyScalar(this.geometryScale),wt.push([gt.x,gt.y,gt.z]);Ce.pos=wt,e[i.collection].push(Ce)}0===e[i.collection].length&&delete e[i.collection]}return e}getEventMetadata(){const e=super.getEventMetadata(),t=this.data?.Collections?.Event_V2?.[0];return t?.[3]&&e.push({label:"Orbit",value:t[3]}),e}}class Oge extends Z_{rawEventData;constructor(){super(),this.eventData={}}setRawEventData(e){this.rawEventData=e}processEventData(){return Object.entries(this.rawEventData).forEach(([e,t])=>{const i={Vertices:{},Tracks:{},Hits:{},CaloCells:{},CaloClusters:{},Jets:{},MissingEnergy:{},ReconstructedParticles:{},"event number":this.getEventNumber(t),"run number":this.getRunNumber(t)};i.Vertices=this.getVertices(t),i.Tracks=this.getTracks(t),i.Hits=this.getHits(t),i.CaloCells=this.getCells(t),i.CaloClusters=this.getCaloClusters(t),i.Jets=this.getJets(t),i.MissingEnergy=this.getMissingEnergy(t),i.ReconstructedParticles=this.getReconstructedParticles(t,i.Tracks,i.CaloClusters),this.eventData[e]=i}),!0}getEventData(){return this.eventData}getNumEvents(){return Object.keys(this.rawEventData).length}getRunNumber(e){if(!("EventHeader"in e))return 0;const t=e.EventHeader.collection;return"runNumber"in t?0:t[0].runNumber}getEventNumber(e){if(!("EventHeader"in e))return 0;const t=e.EventHeader.collection;return"eventNumber"in t?0:t[0].eventNumber}colorTracks(e){let t,i,r,s;"ReconstructedParticles"in e&&(t=e.ReconstructedParticles.collection,"Particle"in e&&(i=e.Particle.collection,"MCRecoAssociations"in e&&(r=e.MCRecoAssociations.collection,"EFlowTrack"in e&&(s=e.EFlowTrack.collection,r.forEach(a=>{const u=i[a.sim.index].PDG;t[a.rec.index].tracks.forEach(_=>{const S=s[_.index];11===Math.abs(u)?(S.color="00ff00",S.pid="electron"):22===Math.abs(u)?(S.color="ff0000",S.pid="photon"):211===Math.abs(u)||111===Math.abs(u)?(S.color="a52a2a",S.pid="pion"):2212===Math.abs(u)?(S.color="778899",S.pid="proton"):321===Math.abs(u)?(S.color="5f9ea0",S.pid="kaon"):(S.color="0000cd",S.pid="other"),S.pdgid=u})})))))}getVertices(e){const t=[];for(const i in e){if(e[i].constructor!=Object)continue;const r=e[i];if(!("collType"in r)||!("collection"in r)||"edm4hep::VertexCollection"!==r.collType)continue;const s=[],a=r.collection,l=this.randomColor();a.forEach(d=>{const u=[];"position"in d&&(u.push(.1*d.position.x),u.push(.1*d.position.y),u.push(.1*d.position.z)),s.push({pos:u,size:.2,color:"#"+l})}),t[i]=s}return t}getTracks(e){const t=[];for(const i in e){if(e[i].constructor!=Object)continue;const r=e[i];if(!("collType"in r)||"edm4hep::TrackCollection"!==r.collType||!("collection"in r))continue;let s=null;"collID"in r&&(s=r.collID);const l=[],d=[],u=[],p=[],_=[],S=[];let R=0;r.collection.forEach(H=>{const re=[];"trackerHits"in H&&H.trackerHits.forEach(qe=>{const wt=this.getCollByID(e,qe.collectionID);if(wt&&"index"in qe&&qe.index>=0&&qe.index<wt.length){const gt=wt[qe.index];re.push([.1*gt.position.x,.1*gt.position.y,.1*gt.position.z])}}),"trackStates"in H&&0===re.length&&H.trackStates.forEach(qe=>{"referencePoint"in qe&&re.push([.1*qe.referencePoint.x,.1*qe.referencePoint.y,.1*qe.referencePoint.z])});let se="ee2222";"color"in H&&(se=H.color);let ce=-1;"chi2"in H&&(ce=H.chi2);const Te={pos:re,color:se,chi_square:ce,collID:s,index:R,associatedParticle:null};"pid"in H?"electron"==H.pid?l.push(Te):"photon"==H.pid?d.push(Te):"pion"==H.pid?u.push(Te):"proton"==H.pid?p.push(Te):"kaon"==H.pid?_.push(Te):S.push(Te):S.push(Te),R++}),t[i+" | Electrons"]=l,t[i+" | Photons"]=d,t[i+" | Pions"]=u,t[i+" | Protons"]=p,t[i+" | Kaons"]=_,t[i+" | Other"]=S}return t}getHits(e){const t=[];for(const i in e){if(e[i].constructor!=Object)continue;const r=e[i];if(!("collType"in r&&r.collType.includes("edm4hep::")&&r.collType.includes("TrackerHitCollection")&&"collection"in r))continue;const s=r.collection,a=[],l=this.randomColor();s.forEach(d=>{const u=[];"position"in d&&(u.push(.1*d.position.x),u.push(.1*d.position.y),u.push(.1*d.position.z)),a.push({type:"CircularPoint",pos:u,color:"#"+l,size:2})}),t[i]=a}return t}getCells(e){const t=[];for(const i in e){if(e[i].constructor!=Object)continue;const r=e[i];if(!("collType"in r&&r.collType.includes("edm4hep::")&&r.collType.includes("CalorimeterHitCollection")&&"collection"in r))continue;const s=r.collection,a=[];let l=1e9;for(let p=0;p<1e4;++p){const _=Math.floor(Math.random()*s.length),S=Math.floor(Math.random()*s.length);if(_===S)continue;const R=Math.pow(s[_].position.x-s[S].position.x,2),H=Math.pow(s[_].position.y-s[S].position.y,2),re=Math.pow(s[_].position.z-s[S].position.z,2),se=Math.sqrt(R+H+re);se<l&&(l=se)}const d=.1*Math.floor(l)>1?.1*Math.floor(l):1,u=Math.floor(358*Math.random());s.forEach(p=>{const _=.1*p.position.x,S=.1*p.position.y,R=.1*p.position.z,H=Math.sqrt(Math.pow(_,2)+Math.pow(S,2)+Math.pow(R,2)),re=Math.sqrt(Math.pow(_,2)+Math.pow(S,2)),se=Math.asinh(R/re),ce=Math.acos(_/re)*Math.sign(S),Te=this.valToLightness(p.energy,.001,1),Ce=this.valToOpacity(p.energy,.001,1),qe={eta:se,phi:ce,energy:p.energy,radius:H,side:d,length:d,color:"#"+this.convHSLtoHEX(u,90,Te),opacity:Ce};a.push(qe)}),t[i]=a}return t}getCaloClusters(e){const t=[];for(const i in e){if(e[i].constructor!=Object)continue;const r=e[i];if(!("collType"in r)||"edm4hep::ClusterCollection"!==r.collType||!("collection"in r))continue;let s=null;"collID"in r&&(s=r.collID);const l=[];let d=0;r.collection.forEach(u=>{const p=.1*u.position.x,_=.1*u.position.y,S=.1*u.position.z,R=Math.sqrt(Math.pow(p,2)+Math.pow(_,2)+Math.pow(S,2)),H=Math.sqrt(Math.pow(p,2)+Math.pow(_,2)),re=Math.asinh(S/H),se=Math.acos(p/H)*Math.sign(_);l.push({eta:re,phi:se,energy:100*u.energy,radius:R,side:4,collID:s,index:d,associatedParticle:null}),d++}),t[i]=l}return t}getJets(e){const t=[];for(const i in e){if(e[i].constructor!=Object)continue;const r=e[i];if(!("collType"in r)||"edm4hep::ReconstructedParticleCollection"!==r.collType||!i.includes("Jet")&&!i.includes("jet")||!("collection"in r))continue;const s=[];r.collection.forEach(l=>{if(!("momentum"in l)||!("energy"in l))return;const d=l.momentum.x,u=l.momentum.y,p=l.momentum.z,_=Math.sqrt(Math.pow(d,2)+Math.pow(u,2)),S=Math.asinh(p/_),R=Math.acos(d/_)*Math.sign(u);s.push({eta:S,phi:R,energy:1e3*l.energy})}),t[i]=s}return t}getReconstructedParticles(e,t,i){const r={},s={},a={};if(null!=t)for(const l of Object.values(t))for(const d of l)"index"in d&&"collID"in d&&(s[d.collID+" "+d.index]=d);if(null!=i)for(const l of Object.values(i))for(const d of l)"index"in d&&"collID"in d&&(a[d.collID+" "+d.index]=d);for(const l in e){if(e[l].constructor!=Object)continue;const d=e[l];let u=null;if("collID"in d&&(u=d.collID),!("collType"in d)||"edm4hep::ReconstructedParticleCollection"!==d.collType||!("collection"in d))continue;const p=[],_=d.collection;let S=0;for(const R of _){let H=null;if("energy"in R&&(H=R.energy,H<.01)){S++;continue}let re=null;"charge"in R&&(re=R.charge);let se=null;"mass"in R&&(se=R.mass);const ce={Px:null,Py:null,Pz:null};"momentum"in R&&(ce.Px=R.momentum.x,ce.Py=R.momentum.y,ce.Pz=R.momentum.z);const Te=[],Ce=[],qe={charge:re,mass:se,energy:H,momentum:ce,associatedTracks:null,associatedClusters:null,collID:u,index:S,toString(){return`{charge: ${this.charge}, mass: ${this.mass}, energy: ${this.energy}\n                      , momentum: {x: ${this.momentum.Px}, y: ${this.momentum.Py}, z: ${this.momentum.Pz}}, \n                       collID: ${this.collID}, index: ${this.index}}`}};if("tracks"in R&&R.tracks.length>0)for(const wt of R.tracks){const gt=wt.collectionID+" "+wt.index;gt in s&&(s[gt].associatedParticle=qe,Te.push(s[gt]))}if("clusters"in R&&R.clusters.length>0)for(const wt of R.clusters){const gt=wt.collectionID+" "+wt.index;gt in a&&(a[gt].associatedParticle=qe,Ce.push(a[gt]))}qe.associatedTracks=Te,qe.associatedClusters=Ce,p.push(qe),S++}r[l]=p}return r}getMissingEnergy(e){const t=[];for(const i in e){if(e[i].constructor!=Object)continue;const r=e[i];if(!("collType"in r)||"edm4hep::ReconstructedParticleCollection"!==r.collType||!i.includes("Missing")&&!i.includes("missing")||!("collection"in r))continue;const s=[];r.collection.forEach(d=>{if(!("momentum"in d)||!("energy"in d))return;const u=d.momentum.x,p=d.momentum.y,_=d.momentum.z,S=Math.sqrt(Math.pow(u,2)+Math.pow(p,2)+Math.pow(_,2));s.push({etx:d.energy*u/S*10,ety:d.energy*p/S*10,color:"#ff69b4"})}),t[i]=s}return t}randomColor(){return Math.floor(16777215*Math.random()).toString(16).padStart(6,"0").toUpperCase()}convHSLtoHEX(e,t,i){i/=100;const r=t*Math.min(i,1-i)/100,s=a=>{const l=(a+e/30)%12,d=i-r*Math.max(Math.min(l-3,9-l,1),-1);return Math.round(255*d).toString(16).padStart(2,"0")};return`${s(0)}${s(8)}${s(4)}`}valToLightness(e,t,i){let r=80-65*(e-t)/(i-t);return r<20&&(r=20),r>85&&(r=85),r}valToOpacity(e,t,i){let r=.2+.65*(e-t)/(i-t);return r<.2&&(r=.2),r>.8&&(r=.8),r}getCollByID(e,t){for(const i in e){if(e[i].constructor!=Object)continue;const r=e[i];if("collID"in r&&r.collID===t)return r.collection}}}class Lge extends Z_{hitData;particleData;truthData;constructor(){super(),this.hitData=[],this.particleData=[],this.truthData={}}processHits(e){const t=e.split("\n");let i;console.log("Event has this many hits:",t.length);for(let r=1;r<t.length;r++)i=t[r].split(","),this.hitData[i[0]]=[parseFloat(i[1]),parseFloat(i[2]),parseFloat(i[3])]}processParticles(e){const t=e.split("\n");let i;console.log("Event has this many particles:",t.length);for(let r=1;r<t.length;r++)i=t[r].split(","),this.particleData.push({particle_id:parseInt(i[0]),vertex_pos:[parseFloat(i[1]),parseFloat(i[2]),parseFloat(i[3])],mom:[parseFloat(i[4]),parseFloat(i[5]),parseFloat(i[6])]})}processTruth(e){const t=e.split("\n");let i;console.log("Event has this many truth: ",t.length);for(let r=1;r<t.length;r++)i=t[r].split(","),this.truthData[i[0]]=[i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8]]}getEventData(e){const t={eventNumber:e,runNumber:0,Hits:void 0,Tracks:void 0};if(this.hitData){t.Hits={},t.Hits.Reconstructed=[];let s=Math.round(this.hitData.length/5e3);s<1&&(s=1);let a=0;for(let l=1;l<this.hitData.length;l++)l%s||(t.Hits.Reconstructed[a++]=[[this.hitData[l][0],this.hitData[l][1],this.hitData[l][2]]])}if(console.log("Will show this many hits",t.Hits.Reconstructed.length),this.truthData){if(t.Tracks={Particles:[]},this.particleData)for(let d=0;d<this.particleData.length;d++)t.Tracks.Particles[d]={particle_id:this.particleData[d].particle_id,pos:[this.particleData[d].vertex_pos],mom:this.particleData[d].mom};let s,a;const l=parseInt(String(this.truthData.length/10));for(let d=1;d<this.truthData.length;d++){s=d,a=parseInt(this.truthData[d][0]);for(let u=0;u<t.Tracks.Particles.length;u++)t.Tracks.Particles[u].particle_id===a&&t.Tracks.Particles[u].pos.push([parseFloat(this.truthData[d][1]),parseFloat(this.truthData[d][2]),parseFloat(this.truthData[d][3])]);d%l==0&&(document.getElementById("info").innerHTML="Processed "+100*d/this.truthData.length+"% of event data.")}}for(let s=0;s<t.Tracks.Particles.length;s++);return t}}let pl=(()=>{class n extends kge{constructor(){super()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Nge=()=>({option:"TDR_o1_v01",loadIndividual:!0}),Uge=()=>({option:"TDR_o1_v02"});let AQ=(()=>{class n{eventDisplay;year;constructor(t){this.eventDisplay=t,this.year=(new Date).getFullYear(),this.eventDisplay.getThreeManager().stopAnimationLoop()}ngAfterViewInit(){this.eventDisplay.getUIManager().detectColorScheme()}static \u0275fac=function(i){return new(i||n)(Lt(pl))};static \u0275cmp=Zr({type:n,selectors:[["app-home"]],decls:89,vars:5,consts:[[1,"container"],[1,"pricing-header","p-3","pt-md-5","pb-md-4","text-center"],["src","assets/images/logo-text.svg","alt","",1,"logo","mb-4"],[1,"lead"],[1,"row","centered"],[1,"card"],["src","assets/images/cepc_tdr_v1.png","alt","CEPC Detector",1,"card-img-top"],[1,"card-body","d-flex","flex-column"],[1,"card-title"],[1,"card-text"],["routerLink","/cepc",1,"btn","btn-primary",3,"queryParams"],["src","assets/images/cepc_tdr_v2.png","alt","CEPC Detector",1,"card-img-top"],["src","assets/images/playground.svg","alt","Card image cap",1,"card-img-top"],["routerLink","/playground",1,"btn","btn-primary"],["src","assets/images/geometry.svg","alt","Card image cap",1,"card-img-top"],["routerLink","/geometry",1,"btn","btn-primary"],["src","assets/images/atlas.svg","alt","Card image cap",1,"card-img-top"],["routerLink","/atlas",1,"btn","btn-primary"],["src","assets/images/lhcb.svg","alt","Card image cap",1,"card-img-top"],["routerLink","/lhcb",1,"btn","btn-primary"],["src","assets/images/cms.svg","alt","Card image cap",1,"card-img-top"],["routerLink","/cms",1,"btn","btn-primary"],["src","assets/images/trackml2.png","alt","Card image cap",1,"card-img-top"],["routerLink","/trackml",1,"btn","btn-primary"],["href","https://github.com/HSF/phoenix"],["href","https://github.com/HSF/phoenix/blob/main/README.md"]],template:function(i,r){1&i&&(zt(0,"div",0)(1,"div",1),Fr(2,"img",2),zt(3,"p",3),Fi(4,"Application for visualizing High Energy Physics data."),an()(),zt(5,"div",4)(6,"div",5),Fr(7,"img",6),zt(8,"div",7)(9,"h5",8),Fi(10,"CEPC TDR_o1_v01"),an(),zt(11,"p",9),Fi(12,"CEPC geometry."),an(),zt(13,"a",10),Fi(14,"Show"),an()()(),zt(15,"div",5),Fr(16,"img",11),zt(17,"div",7)(18,"h5",8),Fi(19,"CEPC TDR_o1_v02"),an(),zt(20,"p",9),Fi(21,"CEPC geometry."),an(),zt(22,"a",10),Fi(23,"Show"),an()()(),zt(24,"div",5),Fr(25,"img",12),zt(26,"div",7)(27,"h5",8),Fi(28,"Playground"),an(),zt(29,"p",9),Fi(30," Get started with the different Phoenix features. "),an(),zt(31,"a",13),Fi(32,"Show"),an()()(),zt(33,"div",5),Fr(34,"img",14),zt(35,"div",7)(36,"h5",8),Fi(37,"Geometry display"),an(),zt(38,"p",9),Fi(39,"This test should show some simple geometry."),an(),zt(40,"a",15),Fi(41,"Show"),an()()(),zt(42,"div",5),Fr(43,"img",16),zt(44,"div",7)(45,"h5",8),Fi(46,"ATLAS"),an(),zt(47,"p",9),Fi(48,"Show the ATLAS detector. One simple event."),an(),zt(49,"a",17),Fi(50,"Show"),an()()(),zt(51,"div",5),Fr(52,"img",18),zt(53,"div",7)(54,"h5",8),Fi(55,"LHCb"),an(),zt(56,"p",9),Fi(57,"Show the LHCb detector. One simple event."),an(),zt(58,"a",19),Fi(59,"Show"),an()()(),zt(60,"div",5),Fr(61,"img",20),zt(62,"div",7)(63,"h5",8),Fi(64,"CMS"),an(),zt(65,"p",9),Fi(66,"Show the CMS detector. One simple event."),an(),zt(67,"a",21),Fi(68,"Show"),an()()(),zt(69,"div",5),Fr(70,"img",22),zt(71,"div",7)(72,"h5",8),Fi(73,"TrackML"),an(),zt(74,"p",9),Fi(75," Visualisation for TrackML. Shows how to write a custom event loader. "),an(),zt(76,"a",23),Fi(77,"Show"),an()()()()(),zt(78,"footer")(79,"p")(80,"em"),Fi(81),an(),Fi(82," Phoenix Project "),an(),zt(83,"p")(84,"a",24),Fi(85," Github "),an(),Fi(86," - "),zt(87,"a",25),Fi(88," Documentation "),an()()()),2&i&&(Vn(13),Hn("queryParams",tR(3,Nge)),Vn(9),Hn("queryParams",tR(4,Uge)),Vn(59),tA(r.year))},dependencies:[US],styles:["h1[_ngcontent-%COMP%]{font-family:Circular}.logo[_ngcontent-%COMP%]{margin-top:2em;max-width:24em}.row[_ngcontent-%COMP%]{justify-content:center}.card[_ngcontent-%COMP%]{margin:1.2em;border:1px solid rgba(88,88,88,.08);box-shadow:var(--phoenix-box-shadow);padding:1em;width:20em;background-color:var(--phoenix-background-color-secondary);border-radius:10px}.card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--phoenix-text-color-secondary)}.card[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{font-family:Circular;color:var(--phoenix-text-color)}.card[_ngcontent-%COMP%]   .card-img-top[_ngcontent-%COMP%]{width:100%;height:10em;object-fit:contain;border-radius:10px}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{justify-content:space-between}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{border-radius:10px}.lead[_ngcontent-%COMP%]{color:var(--phoenix-text-color-secondary)}footer[_ngcontent-%COMP%]{background-color:var(--phoenix-background-color);margin:5rem 1rem 3rem;color:var(--phoenix-text-color-secondary)}footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center}footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--phoenix-text-color-secondary)}footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--phoenix-text-color-secondary)}"]})}return n})(),ev=(()=>{class n{constructor(){}ngOnInit(){}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Zr({type:n,selectors:[["app-nav"]],decls:2,vars:0,consts:[["id","mainLogo","routerLink","/",1,"main-logo","fixed-top","p-2","mx-auto","mt-2"],["src","assets/images/logo-text.svg"]],template:function(i,r){1&i&&(zt(0,"a",0),Fr(1,"img",1),an())},dependencies:[US],styles:[".main-logo[_ngcontent-%COMP%]{width:140px;z-index:9999}.main-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{transition:all .5s}.main-logo[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:drop-shadow(0px 0px 10px var(--phoenix-text-color));transition:all .5s}"]})}return n})(),iO=(()=>{class n{error=new mC;subscribeToError(t){this.error.onUpdate(t)}setError(t){this.error.update(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const zge=n=>({"load-complete":n}),Hge=n=>({width:n});function Vge(n,e){if(1&n&&(zt(0,"div",7),Fr(1,"span"),an()),2&n){const t=Pr(2);Vn(),function JA(n){tg(b8,HY,n,!1)}(Sf(2,Hge,t.progress+"%"))}}function Gge(n,e){if(1&n&&(ng(0),Fr(1,"img",3),zt(2,"p",4),Fi(3," Loading..."),Fr(4,"br"),zt(5,"small",5),Fi(6,"(This may take a while)"),an()(),zs(7,Vge,2,4,"div",6),ig()),2&n){const t=Pr();Vn(7),Hn("ngIf",void 0!==t.progress)}}function qge(n,e){1&n&&(zt(0,"p"),Fi(1," An error occurred while loading the application. Please try refreshing the page. "),an())}let tv=(()=>{class n{errorMessageService;loaded=!1;progress;error;constructor(t){this.errorMessageService=t,this.errorMessageService.subscribeToError(i=>{this.loaded||(this.error=i)})}static \u0275fac=function(i){return new(i||n)(Lt(iO))};static \u0275cmp=Zr({type:n,selectors:[["app-loader"]],inputs:{loaded:"loaded",progress:"progress"},decls:4,vars:5,consts:[["errorContainer",""],[1,"loader-wrapper","d-flex","position-absolute","flex-column","justify-content-center","align-items-center","w-100","h-100","p-5","text-center",3,"ngClass"],[4,"ngIf","ngIfElse"],["src","assets/images/logo-small.svg","alt","Loader"],[1,"mt-5"],[1,"text-muted"],["class","loading-bar",4,"ngIf"],[1,"loading-bar"]],template:function(i,r){if(1&i&&(zt(0,"div",1),zs(1,Gge,8,1,"ng-container",2)(2,qge,2,0,"ng-template",null,0,nR),an()),2&i){const s=Ga(3);Hn("ngClass",Sf(3,zge,r.loaded)),Vn(),Hn("ngIf",void 0===r.error)("ngIfElse",s)}},dependencies:[om,Lh],styles:[".loader-wrapper[_ngcontent-%COMP%]{background:var(--phoenix-background-color);z-index:9998}.loader-wrapper.load-complete[_ngcontent-%COMP%]{display:none!important}.loader-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:5rem;height:5rem;animation:loader 2s infinite}.loader-wrapper[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--phoenix-text-color)}.loader-wrapper[_ngcontent-%COMP%]   .loading-bar[_ngcontent-%COMP%]{width:15rem;max-width:90%;height:.5rem;background:var(--phoenix-background-color-tertiary);border-radius:2.5rem;overflow:hidden}.loader-wrapper[_ngcontent-%COMP%]   .loading-bar[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;height:100%;border-radius:2.5rem;background:linear-gradient(to right,var(--phoenix-primary),var(--phoenix-secondary));transition:all .5s}@keyframes _ngcontent-%COMP%_app-loader_loader{0%,to{transform:scale(.1) rotate(0)}95%{transform:scale(1) rotate(15deg)}}"]})}return n})(),Qge=(()=>{class n{eventDisplay;loaded=!1;loadingProgress=0;constructor(t){this.eventDisplay=t}ngOnInit(){this.eventDisplay.init({}),this.eventDisplay.buildGeometryFromParameters({ModuleName:"Module 2",Xdim:10,Ydim:1,Zdim:45,NumPhiEl:64,NumZEl:10,Radius:75,MinZ:-250,MaxZ:250,TiltAngle:.3,PhiOffset:0,Colour:65280,EdgeColour:4494424}),this.eventDisplay.getLoadingManager().addProgressListener(i=>this.loadingProgress=i),this.eventDisplay.getLoadingManager().addLoadListenerWithCheck(()=>this.loaded=!0)}copyCode(){const t=document.getElementById("geometryCode").textContent.trim(),i=document.createElement("input");document.body.appendChild(i),i.value=t,i.select(),document.execCommand("copy"),document.body.removeChild(i)}static \u0275fac=function(i){return new(i||n)(Lt(pl))};static \u0275cmp=Zr({type:n,selectors:[["app-geometry"]],decls:14,vars:3,consts:[[3,"loaded","progress"],[1,"demo-info"],["id","geometryCode"],[1,"copy-code",3,"click"],["id","eventDisplay"]],template:function(i,r){1&i&&(Fr(0,"app-loader",0)(1,"app-nav"),zt(2,"div",1)(3,"p")(4,"b"),Fi(5,"Geometry Demo"),an()(),zt(6,"p"),Fi(7,"Try opening the console and typing:"),an(),zt(8,"code",2),Fi(9),an(),zt(10,"p",3),Ai("click",function(){return r.copyCode()}),zt(11,"b"),Fi(12,"Copy"),an()()(),Fr(13,"div",4)),2&i&&(Hn("loaded",r.loaded)("progress",r.loadingProgress),Vn(9),yl(" ",'var parameters = { ModuleName: "Module 3", Xdim: 10., Ydim: 1., Zdim: 45, NumPhiEl: 64, NumZEl: 10, Radius: 105, MinZ: -250, MaxZ: 250, TiltAngle: 0.3, PhiOffset: 0.0, Colour: 0xffff00, EdgeColour: 0x449458 }; window.EventDisplay.buildGeometryFromParameters(parameters);'," "))},dependencies:[ev,tv],styles:[".demo-info[_ngcontent-%COMP%]{position:absolute;top:5rem;left:1rem;font-size:.8rem;color:var(--phoenix-text-color-secondary);width:20rem;max-width:40%}.demo-info[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{color:var(--phoenix-text-color-secondary);cursor:text}.demo-info[_ngcontent-%COMP%]   .copy-code[_ngcontent-%COMP%]{cursor:pointer}"]})}return n})();var Yu=function(n){return n.JSON="JSON",n.EDM4HEPJSON="EDM4HEPJSON",n.JIVEXML="JIVEXML",n.IG="IG",n.ZIP="ZIP",n}(Yu||{});class cx{format;fileType;handler;accept;constructor(e,t,i,r){this.format=e,this.fileType=t,this.handler=i,this.accept=r}}const jge=JSON.parse('{"phoenixMenu":{"name":"Phoenix Menu","nodeLevel":0,"toggleState":true,"childrenActive":false,"configs":[{"type":"button","label":"Save state"},{"type":"button","label":"Load state"}],"children":[{"name":"Detector","nodeLevel":1,"toggleState":true,"childrenActive":false,"configs":[{"type":"checkbox","label":"Wireframe","isChecked":false},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.01,"allowCustomValue":true},{"type":"slider","label":"Scale","min":0,"max":20,"step":0.01,"allowCustomValue":true}],"children":[{"name":"Magnets","nodeLevel":2,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Barrel Toroid","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"Endcap","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"Feet","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"Warm structure","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]}]},{"name":"Calorimeters","nodeLevel":2,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"LAr Barrel","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"LAr EC1","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"LAr FCAL","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"LAr HEC","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"Tile Cal","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"Tile Cal EC","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]}]},{"name":"Inner Detector","nodeLevel":2,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Beam","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"Pixel","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"SCT","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"SCT Endcaps","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"TRT","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"TRT Endcaps","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]}]},{"name":"Muon Spectrometer","nodeLevel":2,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Endcaps","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Extra wheel","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"Big wheel","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"Outer Wheel","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"Big Wheel MDT ","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"Small Wheel","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"Small Wheel Hub","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"Small Wheel Feet","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"TGC2","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"TGC3","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]}]},{"name":"Barrel","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Muon Barrel Inner","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"Muon Barrel Middle","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]},{"name":"Muon Barrel Outer","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"slider","label":"Opacity","min":0,"max":1,"step":0.05,"allowCustomValue":true},{"type":"button","label":"Remove"}],"children":[]}]}]}]},{"name":"Event Data","nodeLevel":1,"toggleState":true,"childrenActive":false,"configs":[{"type":"checkbox","label":"Depth Test","isChecked":true}],"children":[{"name":"Tracks","nodeLevel":2,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Tracks_","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-4,"max":4,"step":0.1,"value":-4,"highValue":4},{"type":"rangeSlider","label":"\u{1d6d8}2","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"DOF","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"pT","min":0,"max":50000,"step":0.1,"value":0,"highValue":50000},{"type":"rangeSlider","label":"z0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30},{"type":"rangeSlider","label":"d0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color","hidden":false},{"type":"button","label":"Random","hidden":false},{"type":"select","label":"Color by","options":["Charge q","Momentum |p|","Vertex"],"hidden":false},{"type":"color","label":"q=-1","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=0","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=1","group":"charge","color":"#ff0000","hidden":false},{"type":"slider","label":"|p| min","group":"mom","min":0,"max":50000,"value":0,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| min color","group":"mom","color":"#ff0000","hidden":true},{"type":"slider","label":"|p| max","group":"mom","min":0,"max":50000,"value":50000,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| max color","group":"mom","color":"#ff0000","hidden":true}],"children":[]}]},{"name":"CombinedMuonTracks","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-4,"max":4,"step":0.1,"value":-4,"highValue":4},{"type":"rangeSlider","label":"\u{1d6d8}2","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"DOF","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"pT","min":0,"max":50000,"step":0.1,"value":0,"highValue":50000},{"type":"rangeSlider","label":"z0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30},{"type":"rangeSlider","label":"d0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30}],"children":[]},{"name":"Color Options","nodeLevel":4,"childrenActive":false,"configs":[{"type":"color","label":"Color","color":"#0adb2d","hidden":false},{"type":"button","label":"Random","hidden":false},{"type":"select","label":"Color by","options":["Charge q","Momentum |p|","Vertex"],"hidden":false},{"type":"color","label":"q=-1","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=0","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=1","group":"charge","color":"#ff0000","hidden":false},{"type":"slider","label":"|p| min","group":"mom","min":0,"max":50000,"value":0,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| min color","group":"mom","color":"#ff0000","hidden":true},{"type":"slider","label":"|p| max","group":"mom","min":0,"max":50000,"value":50000,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| max color","group":"mom","color":"#ff0000","hidden":true}],"children":[]}]},{"name":"MuonSpectrometerTracks","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-4,"max":4,"step":0.1,"value":-4,"highValue":4},{"type":"rangeSlider","label":"\u{1d6d8}2","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"DOF","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"pT","min":0,"max":50000,"step":0.1,"value":0,"highValue":50000},{"type":"rangeSlider","label":"z0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30},{"type":"rangeSlider","label":"d0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color","hidden":false},{"type":"button","label":"Random","hidden":false},{"type":"select","label":"Color by","options":["Charge q","Momentum |p|","Vertex"],"hidden":false},{"type":"color","label":"q=-1","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=0","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=1","group":"charge","color":"#ff0000","hidden":false},{"type":"slider","label":"|p| min","group":"mom","min":0,"max":50000,"value":0,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| min color","group":"mom","color":"#ff0000","hidden":true},{"type":"slider","label":"|p| max","group":"mom","min":0,"max":50000,"value":50000,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| max color","group":"mom","color":"#ff0000","hidden":true}],"children":[]}]},{"name":"CombinedInDetTracks","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-4,"max":4,"step":0.1,"value":-4,"highValue":4},{"type":"rangeSlider","label":"\u{1d6d8}2","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"DOF","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"pT","min":0,"max":50000,"step":0.1,"value":0,"highValue":50000},{"type":"rangeSlider","label":"z0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30},{"type":"rangeSlider","label":"d0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color","hidden":false},{"type":"button","label":"Random","hidden":false},{"type":"select","label":"Color by","options":["Charge q","Momentum |p|","Vertex"],"hidden":false},{"type":"color","label":"q=-1","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=0","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=1","group":"charge","color":"#ff0000","hidden":false},{"type":"slider","label":"|p| min","group":"mom","min":0,"max":50000,"value":0,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| min color","group":"mom","color":"#ff0000","hidden":true},{"type":"slider","label":"|p| max","group":"mom","min":0,"max":50000,"value":50000,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| max color","group":"mom","color":"#ff0000","hidden":true}],"children":[]}]},{"name":"GSFTracks","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-4,"max":4,"step":0.1,"value":-4,"highValue":4},{"type":"rangeSlider","label":"\u{1d6d8}2","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"DOF","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"pT","min":0,"max":50000,"step":0.1,"value":0,"highValue":50000},{"type":"rangeSlider","label":"z0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30},{"type":"rangeSlider","label":"d0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color","hidden":false},{"type":"button","label":"Random","hidden":false},{"type":"select","label":"Color by","options":["Charge q","Momentum |p|","Vertex"],"hidden":false},{"type":"color","label":"q=-1","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=0","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=1","group":"charge","color":"#ff0000","hidden":false},{"type":"slider","label":"|p| min","group":"mom","min":0,"max":50000,"value":0,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| min color","group":"mom","color":"#ff0000","hidden":true},{"type":"slider","label":"|p| max","group":"mom","min":0,"max":50000,"value":50000,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| max color","group":"mom","color":"#ff0000","hidden":true}],"children":[]}]},{"name":"InDetTrackParticles_xAOD","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-4,"max":4,"step":0.1,"value":-4,"highValue":4},{"type":"rangeSlider","label":"\u{1d6d8}2","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"DOF","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"pT","min":0,"max":50000,"step":0.1,"value":0,"highValue":50000},{"type":"rangeSlider","label":"z0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30},{"type":"rangeSlider","label":"d0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color","hidden":false},{"type":"button","label":"Random","hidden":false},{"type":"select","label":"Color by","options":["Charge q","Momentum |p|","Vertex"],"hidden":false},{"type":"color","label":"q=-1","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=0","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=1","group":"charge","color":"#ff0000","hidden":false},{"type":"slider","label":"|p| min","group":"mom","min":0,"max":50000,"value":0,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| min color","group":"mom","color":"#ff0000","hidden":true},{"type":"slider","label":"|p| max","group":"mom","min":0,"max":50000,"value":50000,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| max color","group":"mom","color":"#ff0000","hidden":true}],"children":[]}]},{"name":"CombinedMuonTrackParticles_xAOD","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-4,"max":4,"step":0.1,"value":-4,"highValue":4},{"type":"rangeSlider","label":"\u{1d6d8}2","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"DOF","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"pT","min":0,"max":50000,"step":0.1,"value":0,"highValue":50000},{"type":"rangeSlider","label":"z0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30},{"type":"rangeSlider","label":"d0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color","hidden":false},{"type":"button","label":"Random","hidden":false},{"type":"select","label":"Color by","options":["Charge q","Momentum |p|","Vertex"],"hidden":false},{"type":"color","label":"q=-1","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=0","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=1","group":"charge","color":"#ff0000","hidden":false},{"type":"slider","label":"|p| min","group":"mom","min":0,"max":50000,"value":0,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| min color","group":"mom","color":"#ff0000","hidden":true},{"type":"slider","label":"|p| max","group":"mom","min":0,"max":50000,"value":50000,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| max color","group":"mom","color":"#ff0000","hidden":true}],"children":[]}]},{"name":"GSFTrackParticles_xAOD","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-4,"max":4,"step":0.1,"value":-4,"highValue":4},{"type":"rangeSlider","label":"\u{1d6d8}2","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"DOF","min":0,"max":100,"step":1,"value":0,"highValue":100},{"type":"rangeSlider","label":"pT","min":0,"max":50000,"step":0.1,"value":0,"highValue":50000},{"type":"rangeSlider","label":"z0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30},{"type":"rangeSlider","label":"d0","min":-30,"max":30,"step":0.1,"value":-30,"highValue":30}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color","hidden":false},{"type":"button","label":"Random","hidden":false},{"type":"select","label":"Color by","options":["Charge q","Momentum |p|","Vertex"],"hidden":false},{"type":"color","label":"q=-1","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=0","group":"charge","color":"#ff0000","hidden":false},{"type":"color","label":"q=1","group":"charge","color":"#ff0000","hidden":false},{"type":"slider","label":"|p| min","group":"mom","min":0,"max":50000,"value":0,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| min color","group":"mom","color":"#ff0000","hidden":true},{"type":"slider","label":"|p| max","group":"mom","min":0,"max":50000,"value":50000,"step":10,"allowCustomValue":true,"hidden":true},{"type":"color","label":"|p| max color","group":"mom","color":"#ff0000","hidden":true}],"children":[]}]}]},{"name":"Jets","nodeLevel":2,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Jets Scale","value":1,"min":0.001,"step":0.01,"max":100,"allowCustomValue":true}],"children":[{"name":"AntiKt4EMTopoJets_xAOD","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-5,"max":5,"step":0.1,"value":-5,"highValue":5},{"type":"rangeSlider","label":"Energy","min":0,"max":100000,"step":100,"value":0,"highValue":100000}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"AntiKt4LCTopoJets_xAOD","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-5,"max":5,"step":0.1,"value":-5,"highValue":5},{"type":"rangeSlider","label":"Energy","min":0,"max":100000,"step":100,"value":0,"highValue":100000}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"AntiKt10LCTopoJets_xAOD","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-5,"max":5,"step":0.1,"value":-5,"highValue":5},{"type":"rangeSlider","label":"Energy","min":0,"max":100000,"step":100,"value":0,"highValue":100000}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]}]},{"name":"Hits","nodeLevel":2,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Pixel","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"SCT","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"TRT","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"MDT","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"RPC","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"TGC","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"CSC","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]}]},{"name":"CaloClusters","nodeLevel":2,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"CaloClusters Scale","value":1,"min":0.001,"step":0.01,"max":100,"allowCustomValue":true}],"children":[{"name":"egammaClusters_xAOD","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-5,"max":5,"step":0.1,"value":-5,"highValue":5},{"type":"rangeSlider","label":"Energy","min":0,"max":10000,"step":1,"value":0,"highValue":10000}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"CaloCalTopoClusters","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-5,"max":5,"step":0.1,"value":-5,"highValue":5},{"type":"rangeSlider","label":"Energy","min":0,"max":10000,"step":1,"value":0,"highValue":10000}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]}]},{"name":"CaloCells","nodeLevel":2,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"LAr","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-5,"max":5,"step":0.1,"value":-5,"highValue":5},{"type":"rangeSlider","label":"Energy","min":0,"max":10000,"step":1,"value":0,"highValue":10000}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"HEC","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-5,"max":5,"step":0.1,"value":-5,"highValue":5},{"type":"rangeSlider","label":"Energy","min":0,"max":10000,"step":1,"value":0,"highValue":10000}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":false,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]}]},{"name":"PlanarCaloCells","nodeLevel":2,"toggleState":false,"childrenActive":false,"configs":[{"type":"slider","label":"PlanarCaloCells Scale","value":1,"min":0.001,"step":0.01,"max":100,"allowCustomValue":true}],"children":[]},{"name":"Muons","nodeLevel":2,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Muons_xAOD","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-4,"max":4,"step":0.1,"value":-4,"highValue":4},{"type":"rangeSlider","label":"Energy","min":0,"max":10000,"step":1,"value":0,"highValue":10000}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"Muons","nodeLevel":3,"toggleState":false,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-4,"max":4,"step":0.1,"value":-4,"highValue":4},{"type":"rangeSlider","label":"Energy","min":0,"max":10000,"step":1,"value":0,"highValue":10000}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]}]},{"name":"Photons","nodeLevel":2,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Photons_xAOD","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-4,"max":4,"step":0.1,"value":-4,"highValue":4},{"type":"rangeSlider","label":"Energy","min":0,"max":10000,"step":1,"value":0,"highValue":10000}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]}]},{"name":"Electrons","nodeLevel":2,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Electrons_xAOD","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-4,"max":4,"step":0.1,"value":-4,"highValue":4},{"type":"rangeSlider","label":"Energy","min":0,"max":10000,"step":1,"value":0,"highValue":10000}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"ForwardElectrons_xAOD","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-4,"max":4,"step":0.1,"value":-4,"highValue":4},{"type":"rangeSlider","label":"Energy","min":0,"max":10000,"step":1,"value":0,"highValue":10000}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"HLT_xAOD__ElectronContainer_egamma_Electrons_xAOD","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"\u03d5","min":-3.14,"max":3.14,"step":0.01,"value":-3.14,"highValue":3.14},{"type":"rangeSlider","label":"\u03b7","min":-4,"max":4,"step":0.1,"value":-4,"highValue":4},{"type":"rangeSlider","label":"Energy","min":0,"max":10000,"step":1,"value":0,"highValue":10000}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]}]},{"name":"Vertices","nodeLevel":2,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Vertices Scale","value":1,"min":0.001,"step":0.01,"max":100,"allowCustomValue":true}],"children":[{"name":"Vertices_xAOD","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Cut Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"label","label":"Cuts"},{"type":"button","label":"Reset cuts"},{"type":"rangeSlider","label":"vertexType","min":0,"max":5,"step":1,"value":0,"highValue":5}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]}]},{"name":"MissingEnergy","nodeLevel":2,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Size (%)","value":100,"min":1,"max":200,"allowCustomValue":true}],"children":[{"name":"MET_Reference_AntiKt4EMTopo_xAOD","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"MET_Calo_xAOD","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"MET_LocHadTopo_xAOD","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]},{"name":"MET_Core_AntiKt4LCTopo_xAOD","nodeLevel":3,"toggleState":true,"childrenActive":false,"configs":[],"children":[{"name":"Draw Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Opacity","min":0.1,"step":0.1,"max":1},{"type":"checkbox","label":"Wireframe"}],"children":[]},{"name":"Color Options","nodeLevel":4,"toggleState":true,"childrenActive":false,"configs":[{"type":"color","label":"Color"},{"type":"button","label":"Random"}],"children":[]}]}]}]},{"name":"Labels","nodeLevel":1,"toggleState":true,"childrenActive":false,"configs":[{"type":"slider","label":"Size","min":0,"max":10,"step":0.01,"allowCustomValue":true},{"type":"color","label":"Color","color":"#a8a8a8"},{"type":"button","label":"Save Labels"},{"type":"button","label":"Load Labels"}],"children":[]}]},"eventDisplay":{"cameraPosition":[3096.1557286722164,2821.4315307500133,4232.068942374551],"startClippingAngle":0,"openingClippingAngle":90}}');let rO;try{rO=typeof Intl<"u"&&Intl.v8BreakIterator}catch{rO=!1}let ME,dx,sO,dd=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?E7(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!rO)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}static#e=this.\u0275fac=function(i){return new(i||n)(xi(Kp))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function B0(n){return function $ge(){if(null==ME&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>ME=!0}))}finally{ME=ME||!1}return ME}()?n:!!n.capture}function _Q(){if(null==dx){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return dx=!1,dx;if("scrollBehavior"in document.documentElement.style)dx=!0;else{const n=Element.prototype.scrollTo;dx=!!n&&!/\{\s*\[native code\]\s*\}/.test(n.toString())}}return dx}function oO(n){if(function Xge(){if(null==sO){const n=typeof document<"u"?document.head:null;sO=!(!n||!n.createShadowRoot&&!n.attachShadow)}return sO}()){const e=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}function aO(){let n=typeof document<"u"&&document?document.activeElement:null;for(;n&&n.shadowRoot;){const e=n.shadowRoot.activeElement;if(e===n)break;n=e}return n}function fA(n){return n.composedPath?n.composedPath()[0]:n.target}function lO(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function bC(n,...e){return e.length?e.some(t=>n[t]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}class d0e extends rt{constructor(e,t){super()}schedule(e,t=0){return this}}const b4={setInterval(n,e,...t){const{delegate:i}=b4;return i?.setInterval?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){const{delegate:e}=b4;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};class uO extends d0e{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var i;if(this.closed)return this;this.state=e;const r=this.id,s=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(s,r,t)),this.pending=!0,this.delay=t,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,i=0){return b4.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;null!=t&&b4.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Ne(i,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const wQ={now:()=>(wQ.delegate||Date).now(),delegate:void 0};class EE{constructor(e,t=EE.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}}EE.now=wQ.now;class hO extends EE{constructor(e,t=EE.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}const TE=new hO(uO),u0e=TE;function fO(n,e=TE){return ci((t,i)=>{let r=null,s=null,a=null;const l=()=>{if(r){r.unsubscribe(),r=null;const u=s;s=null,i.next(u)}};function d(){const u=a+n,p=e.now();if(p<u)return r=this.schedule(void 0,u-p),void i.add(r);l()}t.subscribe(Pi(i,u=>{s=u,a=e.now(),r||(r=e.schedule(d,n),i.add(r))},()=>{l(),i.complete()},void 0,()=>{s=r=null}))})}function pO(n){return od((e,t)=>n<=t)}function h0e(n,e){return n===e}function MQ(n){return null!=n&&"false"!=`${n}`}function ux(n,e=0){return function f0e(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}(n)?Number(n):e}function DE(n){return Array.isArray(n)?n:[n]}function hu(n){return null==n?"":"string"==typeof n?n:`${n}px`}function fu(n){return n instanceof oo?n.nativeElement:n}let SQ=(()=>{class n{create(t){return typeof MutationObserver>"u"?null:new MutationObserver(t)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),A0e=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({providers:[SQ]})}return n})();const EQ=new Set;let hx,g0e=(()=>{class n{constructor(t,i){this._platform=t,this._nonce=i,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):y0e}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function _0e(n,e){if(!EQ.has(n))try{hx||(hx=document.createElement("style"),e&&(hx.nonce=e),hx.setAttribute("type","text/css"),document.head.appendChild(hx)),hx.sheet&&(hx.sheet.insertRule(`@media ${n} {body{ }}`,0),EQ.add(n))}catch(t){console.error(t)}}(t,this._nonce),this._matchMedia(t)}static#e=this.\u0275fac=function(i){return new(i||n)(xi(dd),xi(Cv,8))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function y0e(n){return{matches:"all"===n||""===n,media:n,addListener:()=>{},removeListener:()=>{}}}let v0e=(()=>{class n{constructor(t,i){this._mediaMatcher=t,this._zone=i,this._queries=new Map,this._destroySubject=new hn}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return TQ(DE(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let s=bD(TQ(DE(t)).map(a=>this._registerQuery(a).observable));return s=CS(s.pipe(ad(1)),s.pipe(pO(1),fO(0))),s.pipe(bi(a=>{const l={matches:!1,breakpoints:{}};return a.forEach(({matches:d,query:u})=>{l.matches=l.matches||d,l.breakpoints[u]=d}),l}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const i=this._mediaMatcher.matchMedia(t),s={observable:new Pe(a=>{const l=d=>this._zone.run(()=>a.next(d));return i.addListener(l),()=>{i.removeListener(l)}}).pipe(sA(i),bi(({matches:a})=>({query:t,matches:a})),Ql(this._destroySubject)),mql:i};return this._queries.set(t,s),s}static#e=this.\u0275fac=function(i){return new(i||n)(xi(g0e),xi(io))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function TQ(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}function x4(n,e){return n.getAttribute(e)?.match(/\S+/g)??[]}const IQ="cdk-describedby-message",w4="cdk-describedby-host";let mO=0,w0e=(()=>{class n{constructor(t,i){this._platform=i,this._messageRegistry=new Map,this._messagesContainer=null,this._id=""+mO++,this._document=t,this._id=pi(y_)+"-"+mO++}describe(t,i,r){if(!this._canBeDescribed(t,i))return;const s=AO(i,r);"string"!=typeof i?(BQ(i,this._id),this._messageRegistry.set(s,{messageElement:i,referenceCount:0})):this._messageRegistry.has(s)||this._createMessageElement(i,r),this._isElementDescribedByMessage(t,s)||this._addMessageReference(t,s)}removeDescription(t,i,r){if(!i||!this._isElementNode(t))return;const s=AO(i,r);if(this._isElementDescribedByMessage(t,s)&&this._removeMessageReference(t,s),"string"==typeof i){const a=this._messageRegistry.get(s);a&&0===a.referenceCount&&this._deleteMessageElement(s)}0===this._messagesContainer?.childNodes.length&&(this._messagesContainer.remove(),this._messagesContainer=null)}ngOnDestroy(){const t=this._document.querySelectorAll(`[${w4}="${this._id}"]`);for(let i=0;i<t.length;i++)this._removeCdkDescribedByReferenceIds(t[i]),t[i].removeAttribute(w4);this._messagesContainer?.remove(),this._messagesContainer=null,this._messageRegistry.clear()}_createMessageElement(t,i){const r=this._document.createElement("div");BQ(r,this._id),r.textContent=t,i&&r.setAttribute("role",i),this._createMessagesContainer(),this._messagesContainer.appendChild(r),this._messageRegistry.set(AO(t,i),{messageElement:r,referenceCount:0})}_deleteMessageElement(t){this._messageRegistry.get(t)?.messageElement?.remove(),this._messageRegistry.delete(t)}_createMessagesContainer(){if(this._messagesContainer)return;const t="cdk-describedby-message-container",i=this._document.querySelectorAll(`.${t}[platform="server"]`);for(let s=0;s<i.length;s++)i[s].remove();const r=this._document.createElement("div");r.style.visibility="hidden",r.classList.add(t),r.classList.add("cdk-visually-hidden"),this._platform&&!this._platform.isBrowser&&r.setAttribute("platform","server"),this._document.body.appendChild(r),this._messagesContainer=r}_removeCdkDescribedByReferenceIds(t){const i=x4(t,"aria-describedby").filter(r=>0!=r.indexOf(IQ));t.setAttribute("aria-describedby",i.join(" "))}_addMessageReference(t,i){const r=this._messageRegistry.get(i);(function b0e(n,e,t){const i=x4(n,e);t=t.trim(),!i.some(r=>r.trim()===t)&&(i.push(t),n.setAttribute(e,i.join(" ")))})(t,"aria-describedby",r.messageElement.id),t.setAttribute(w4,this._id),r.referenceCount++}_removeMessageReference(t,i){const r=this._messageRegistry.get(i);r.referenceCount--,function x0e(n,e,t){const i=x4(n,e);t=t.trim();const r=i.filter(s=>s!==t);r.length?n.setAttribute(e,r.join(" ")):n.removeAttribute(e)}(t,"aria-describedby",r.messageElement.id),t.removeAttribute(w4)}_isElementDescribedByMessage(t,i){const r=x4(t,"aria-describedby"),s=this._messageRegistry.get(i),a=s&&s.messageElement.id;return!!a&&-1!=r.indexOf(a)}_canBeDescribed(t,i){if(!this._isElementNode(t))return!1;if(i&&"object"==typeof i)return!0;const r=null==i?"":`${i}`.trim(),s=t.getAttribute("aria-label");return!(!r||s&&s.trim()===r)}_isElementNode(t){return t.nodeType===this._document.ELEMENT_NODE}static#e=this.\u0275fac=function(i){return new(i||n)(xi(ba),xi(dd))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function AO(n,e){return"string"==typeof n?`${e||""}/${n}`:n}function BQ(n,e){n.id||(n.id=`${IQ}-${e}-${mO++}`)}class C0e{constructor(e){this._items=e,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new hn,this._typeaheadSubscription=rt.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._pageUpAndDown={enabled:!1,delta:10},this._skipPredicateFn=t=>t.disabled,this._pressedLetters=[],this.tabOut=new hn,this.change=new hn,e instanceof _f&&(this._itemChangesSubscription=e.changes.subscribe(t=>{if(this._activeItem){const r=t.toArray().indexOf(this._activeItem);r>-1&&r!==this._activeItemIndex&&(this._activeItemIndex=r)}}))}skipPredicate(e){return this._skipPredicateFn=e,this}withWrap(e=!0){return this._wrap=e,this}withVerticalOrientation(e=!0){return this._vertical=e,this}withHorizontalOrientation(e){return this._horizontal=e,this}withAllowedModifierKeys(e){return this._allowedModifierKeys=e,this}withTypeAhead(e=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(cu(t=>this._pressedLetters.push(t)),fO(e),od(()=>this._pressedLetters.length>0),bi(()=>this._pressedLetters.join(""))).subscribe(t=>{const i=this._getItemsArray();for(let r=1;r<i.length+1;r++){const s=(this._activeItemIndex+r)%i.length,a=i[s];if(!this._skipPredicateFn(a)&&0===a.getLabel().toUpperCase().trim().indexOf(t)){this.setActiveItem(s);break}}this._pressedLetters=[]}),this}cancelTypeahead(){return this._pressedLetters=[],this}withHomeAndEnd(e=!0){return this._homeAndEnd=e,this}withPageUpDown(e=!0,t=10){return this._pageUpAndDown={enabled:e,delta:t},this}setActiveItem(e){const t=this._activeItem;this.updateActiveItem(e),this._activeItem!==t&&this.change.next(this._activeItemIndex)}onKeydown(e){const t=e.keyCode,r=["altKey","ctrlKey","metaKey","shiftKey"].every(s=>!e[s]||this._allowedModifierKeys.indexOf(s)>-1);switch(t){case 9:return void this.tabOut.next();case 40:if(this._vertical&&r){this.setNextItemActive();break}return;case 38:if(this._vertical&&r){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&r){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&r){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case 36:if(this._homeAndEnd&&r){this.setFirstItemActive();break}return;case 35:if(this._homeAndEnd&&r){this.setLastItemActive();break}return;case 33:if(this._pageUpAndDown.enabled&&r){const s=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(s>0?s:0,1);break}return;case 34:if(this._pageUpAndDown.enabled&&r){const s=this._activeItemIndex+this._pageUpAndDown.delta,a=this._getItemsArray().length;this._setActiveItemByIndex(s<a?s:a-1,-1);break}return;default:return void((r||bC(e,"shiftKey"))&&(e.key&&1===e.key.length?this._letterKeyStream.next(e.key.toLocaleUpperCase()):(t>=65&&t<=90||t>=48&&t<=57)&&this._letterKeyStream.next(String.fromCharCode(t))))}this._pressedLetters=[],e.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(e){const t=this._getItemsArray(),i="number"==typeof e?e:t.indexOf(e);this._activeItem=t[i]??null,this._activeItemIndex=i}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._letterKeyStream.complete(),this.tabOut.complete(),this.change.complete(),this._pressedLetters=[]}_setActiveItemByDelta(e){this._wrap?this._setActiveInWrapMode(e):this._setActiveInDefaultMode(e)}_setActiveInWrapMode(e){const t=this._getItemsArray();for(let i=1;i<=t.length;i++){const r=(this._activeItemIndex+e*i+t.length)%t.length;if(!this._skipPredicateFn(t[r]))return void this.setActiveItem(r)}}_setActiveInDefaultMode(e){this._setActiveItemByIndex(this._activeItemIndex+e,e)}_setActiveItemByIndex(e,t){const i=this._getItemsArray();if(i[e]){for(;this._skipPredicateFn(i[e]);)if(!i[e+=t])return;this.setActiveItem(e)}}_getItemsArray(){return this._items instanceof _f?this._items.toArray():this._items}}class PQ extends C0e{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(e){return this._origin=e,this}setActiveItem(e){super.setActiveItem(e),this.activeItem&&this.activeItem.focus(this._origin)}}let gO=(()=>{class n{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function S0e(n){return!!(n.offsetWidth||n.offsetHeight||"function"==typeof n.getClientRects&&n.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const i=function M0e(n){try{return n.frameElement}catch{return null}}(function k0e(n){return n.ownerDocument&&n.ownerDocument.defaultView||window}(t));if(i&&(-1===kQ(i)||!this.isVisible(i)))return!1;let r=t.nodeName.toLowerCase(),s=kQ(t);return t.hasAttribute("contenteditable")?-1!==s:!("iframe"===r||"object"===r||this._platform.WEBKIT&&this._platform.IOS&&!function P0e(n){let e=n.nodeName.toLowerCase(),t="input"===e&&n.type;return"text"===t||"password"===t||"select"===e||"textarea"===e}(t))&&("audio"===r?!!t.hasAttribute("controls")&&-1!==s:"video"===r?-1!==s&&(null!==s||this._platform.FIREFOX||t.hasAttribute("controls")):t.tabIndex>=0)}isFocusable(t,i){return function R0e(n){return!function T0e(n){return function I0e(n){return"input"==n.nodeName.toLowerCase()}(n)&&"hidden"==n.type}(n)&&(function E0e(n){let e=n.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(n)||function D0e(n){return function B0e(n){return"a"==n.nodeName.toLowerCase()}(n)&&n.hasAttribute("href")}(n)||n.hasAttribute("contenteditable")||RQ(n))}(t)&&!this.isDisabled(t)&&(i?.ignoreVisibility||this.isVisible(t))}static#e=this.\u0275fac=function(i){return new(i||n)(xi(dd))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function RQ(n){if(!n.hasAttribute("tabindex")||void 0===n.tabIndex)return!1;let e=n.getAttribute("tabindex");return!(!e||isNaN(parseInt(e,10)))}function kQ(n){if(!RQ(n))return null;const e=parseInt(n.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}class FQ{get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}constructor(e,t,i,r,s=!1){this._element=e,this._checker=t,this._ngZone=i,this._document=r,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,s||this.attachAnchors()}destroy(){const e=this._startAnchor,t=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.remove()),t&&(t.removeEventListener("focus",this.endAnchorListener),t.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement(e)))})}focusFirstTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement(e)))})}focusLastTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement(e)))})}_getRegionBoundary(e){const t=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);return"start"==e?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(e){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(t){if(!this._checker.isFocusable(t)){const i=this._getFirstTabbableElement(t);return i?.focus(e),!!i}return t.focus(e),!0}return this.focusFirstTabbableElement(e)}focusFirstTabbableElement(e){const t=this._getRegionBoundary("start");return t&&t.focus(e),!!t}focusLastTabbableElement(e){const t=this._getRegionBoundary("end");return t&&t.focus(e),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let i=0;i<t.length;i++){const r=t[i].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[i]):null;if(r)return r}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let i=t.length-1;i>=0;i--){const r=t[i].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[i]):null;if(r)return r}return null}_createAnchor(){const e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,t){e?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._ngZone.isStable?e():this._ngZone.onStable.pipe(ad(1)).subscribe(e)}}let OQ=(()=>{class n{constructor(t,i,r){this._checker=t,this._ngZone=i,this._document=r}create(t,i=!1){return new FQ(t,this._checker,this._ngZone,this._document,i)}static#e=this.\u0275fac=function(i){return new(i||n)(xi(gO),xi(io),xi(ba))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function C4(n){return 0===n.buttons||0===n.detail}function M4(n){const e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}const F0e=new Bi("cdk-input-modality-detector-options"),O0e={ignoreKeys:[18,17,224,91,16]},xC=B0({passive:!0,capture:!0});let L0e=(()=>{class n{get mostRecentModality(){return this._modality.value}constructor(t,i,r,s){this._platform=t,this._mostRecentTarget=null,this._modality=new dn(null),this._lastTouchMs=0,this._onKeydown=a=>{this._options?.ignoreKeys?.some(l=>l===a.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=fA(a))},this._onMousedown=a=>{Date.now()-this._lastTouchMs<650||(this._modality.next(C4(a)?"keyboard":"mouse"),this._mostRecentTarget=fA(a))},this._onTouchstart=a=>{M4(a)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=fA(a))},this._options={...O0e,...s},this.modalityDetected=this._modality.pipe(pO(1)),this.modalityChanged=this.modalityDetected.pipe(function CQ(n,e=K){return n=n??h0e,ci((t,i)=>{let r,s=!0;t.subscribe(Pi(i,a=>{const l=e(a);(s||!n(r,l))&&(s=!1,r=l,i.next(a))}))})}()),t.isBrowser&&i.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,xC),r.addEventListener("mousedown",this._onMousedown,xC),r.addEventListener("touchstart",this._onTouchstart,xC)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,xC),document.removeEventListener("mousedown",this._onMousedown,xC),document.removeEventListener("touchstart",this._onTouchstart,xC))}static#e=this.\u0275fac=function(i){return new(i||n)(xi(dd),xi(io),xi(ba),xi(F0e,8))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var S4=function(n){return n[n.IMMEDIATE=0]="IMMEDIATE",n[n.EVENTUAL=1]="EVENTUAL",n}(S4||{});const U0e=new Bi("cdk-focus-monitor-default-options"),E4=B0({passive:!0,capture:!0});let J_=(()=>{class n{constructor(t,i,r,s,a){this._ngZone=t,this._platform=i,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new hn,this._rootNodeFocusAndBlurListener=l=>{for(let u=fA(l);u;u=u.parentElement)"focus"===l.type?this._onFocus(l,u):this._onBlur(l,u)},this._document=s,this._detectionMode=a?.detectionMode||S4.IMMEDIATE}monitor(t,i=!1){const r=fu(t);if(!this._platform.isBrowser||1!==r.nodeType)return po();const s=oO(r)||this._getDocument(),a=this._elementInfo.get(r);if(a)return i&&(a.checkChildren=!0),a.subject;const l={checkChildren:i,subject:new hn,rootNode:s};return this._elementInfo.set(r,l),this._registerGlobalListeners(l),l.subject}stopMonitoring(t){const i=fu(t),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(t,i,r){const s=fu(t);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([l,d])=>this._originChanged(l,i,d)):(this._setOrigin(i),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:t&&this._isLastInteractionFromInputLabel(t)?"mouse":"program"}_shouldBeAttributedToTouch(t){return this._detectionMode===S4.EVENTUAL||!!t?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(t,i){t.classList.toggle("cdk-focused",!!i),t.classList.toggle("cdk-touch-focused","touch"===i),t.classList.toggle("cdk-keyboard-focused","keyboard"===i),t.classList.toggle("cdk-mouse-focused","mouse"===i),t.classList.toggle("cdk-program-focused","program"===i)}_setOrigin(t,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&i,this._detectionMode===S4.IMMEDIATE&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,i){const r=this._elementInfo.get(i),s=fA(t);!r||!r.checkChildren&&i!==s||this._originChanged(i,this._getFocusOrigin(s),r)}_onBlur(t,i){const r=this._elementInfo.get(i);!r||r.checkChildren&&t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(this._setClasses(i),this._emitOrigin(r,null))}_emitOrigin(t,i){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(i))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const i=t.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,E4),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,E4)}),this._rootNodeFocusListenerCount.set(i,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Ql(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){const i=t.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,E4),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,E4),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,i,r){this._setClasses(t,i),this._emitOrigin(r,i),this._lastFocusOrigin=i}_getClosestElementsInfo(t){const i=[];return this._elementInfo.forEach((r,s)=>{(s===t||r.checkChildren&&s.contains(t))&&i.push([s,r])}),i}_isLastInteractionFromInputLabel(t){const{_mostRecentTarget:i,mostRecentModality:r}=this._inputModalityDetector;if("mouse"!==r||!i||i===t||"INPUT"!==t.nodeName&&"TEXTAREA"!==t.nodeName||t.disabled)return!1;const s=t.labels;if(s)for(let a=0;a<s.length;a++)if(s[a].contains(i))return!0;return!1}static#e=this.\u0275fac=function(i){return new(i||n)(xi(io),xi(dd),xi(L0e),xi(ba,8),xi(U0e,8))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var fx=function(n){return n[n.NONE=0]="NONE",n[n.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",n[n.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",n}(fx||{});const NQ="cdk-high-contrast-black-on-white",UQ="cdk-high-contrast-white-on-black",_O="cdk-high-contrast-active";let zQ=(()=>{class n{constructor(t,i){this._platform=t,this._document=i,this._breakpointSubscription=pi(v0e).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return fx.NONE;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return fx.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return fx.BLACK_ON_WHITE}return fx.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(_O,NQ,UQ),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();i===fx.BLACK_ON_WHITE?t.add(_O,NQ):i===fx.WHITE_ON_BLACK&&t.add(_O,UQ)}}static#e=this.\u0275fac=function(i){return new(i||n)(xi(dd),xi(ba))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),HQ=(()=>{class n{constructor(t){t._applyBodyHighContrastModeCssClasses()}static#e=this.\u0275fac=function(i){return new(i||n)(xi(zQ))};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({imports:[A0e]})}return n})();function gm(...n){const e=_S(n),t=function Die(n,e){return"number"==typeof $R(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?Nh(i[0]):e2(t)(lu(i,e)):rA}let yO,H0e=1;const T4={};function VQ(n){return n in T4&&(delete T4[n],!0)}const V0e={setImmediate(n){const e=H0e++;return T4[e]=!0,yO||(yO=Promise.resolve()),yO.then(()=>VQ(e)&&n()),e},clearImmediate(n){VQ(n)}},{setImmediate:G0e,clearImmediate:q0e}=V0e,D4={setImmediate(...n){const{delegate:e}=D4;return(e?.setImmediate||G0e)(...n)},clearImmediate(n){const{delegate:e}=D4;return(e?.clearImmediate||q0e)(n)},delegate:void 0},vO=new class W0e extends hO{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}}(class Q0e extends uO{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=D4.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(e,t,i);const{actions:s}=e;null!=t&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==t&&(D4.clearImmediate(t),e._scheduled===t&&(e._scheduled=void 0))}});function GQ(n,e){return e?t=>CS(e.pipe(ad(1),function j0e(){return ci((n,e)=>{n.subscribe(Pi(e,Ot))})}()),t.pipe(GQ(n))):Qu((t,i)=>Nh(n(t,i)).pipe(ad(1),G9(t)))}function I4(n=0,e,t=u0e){let i=-1;return null!=e&&(e9(e)?t=e:i=e),new Pe(r=>{let s=function $0e(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;s<0&&(s=0);let a=0;return t.schedule(function(){r.closed||(r.next(a++),0<=i?this.schedule(void 0,i):r.complete())},s)})}function qQ(n,e=TE){const t=I4(n,e);return GQ(()=>t)}const X0e=new Bi("cdk-dir-doc",{providedIn:"root",factory:function Y0e(){return pi(ba)}}),K0e=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let _m=(()=>{class n{constructor(t){this.value="ltr",this.change=new Ls,t&&(this.value=function Z0e(n){const e=n?.toLowerCase()||"";return"auto"===e&&typeof navigator<"u"&&navigator?.language?K0e.test(navigator.language)?"rtl":"ltr":"rtl"===e?"rtl":"ltr"}((t.body?t.body.dir:null)||(t.documentElement?t.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}static#e=this.\u0275fac=function(i){return new(i||n)(xi(X0e,8))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),IE=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({})}return n})();const J0e=["mat-internal-form-field",""],e_e=["*"],n_e=new Bi("mat-sanity-checks",{providedIn:"root",factory:function t_e(){return!0}});let Wd=(()=>{class n{constructor(t,i,r){this._sanityChecks=i,this._document=r,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!lO()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}static#e=this.\u0275fac=function(i){return new(i||n)(xi(zQ),xi(n_e,8),xi(ba))};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({imports:[IE,IE]})}return n})();var xp=function(n){return n[n.FADING_IN=0]="FADING_IN",n[n.VISIBLE=1]="VISIBLE",n[n.FADING_OUT=2]="FADING_OUT",n[n.HIDDEN=3]="HIDDEN",n}(xp||{});class c_e{constructor(e,t,i,r=!1){this._renderer=e,this.element=t,this.config=i,this._animationForciblyDisabledThroughCss=r,this.state=xp.HIDDEN}fadeOut(){this._renderer.fadeOutRipple(this)}}const jQ=B0({passive:!0,capture:!0});class d_e{constructor(){this._events=new Map,this._delegateEventHandler=e=>{const t=fA(e);t&&this._events.get(e.type)?.forEach((i,r)=>{(r===t||r.contains(t))&&i.forEach(s=>s.handleEvent(e))})}}addHandler(e,t,i,r){const s=this._events.get(t);if(s){const a=s.get(i);a?a.add(r):s.set(i,new Set([r]))}else this._events.set(t,new Map([[i,new Set([r])]])),e.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,jQ)})}removeHandler(e,t,i){const r=this._events.get(e);if(!r)return;const s=r.get(t);s&&(s.delete(i),0===s.size&&r.delete(t),0===r.size&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,jQ)))}}const $Q={enterDuration:225,exitDuration:150},XQ=B0({passive:!0,capture:!0}),YQ=["mousedown","touchstart"],KQ=["mouseup","mouseleave","touchend","touchcancel"];class B4{static#e=this._eventManager=new d_e;constructor(e,t,i,r){this._target=e,this._ngZone=t,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=fu(i))}fadeInRipple(e,t,i={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s={...$Q,...i.animation};i.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);const a=i.radius||function h_e(n,e,t){const i=Math.max(Math.abs(n-t.left),Math.abs(n-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(i*i+r*r)}(e,t,r),l=e-r.left,d=t-r.top,u=s.enterDuration,p=document.createElement("div");p.classList.add("mat-ripple-element"),p.style.left=l-a+"px",p.style.top=d-a+"px",p.style.height=2*a+"px",p.style.width=2*a+"px",null!=i.color&&(p.style.backgroundColor=i.color),p.style.transitionDuration=`${u}ms`,this._containerElement.appendChild(p);const _=window.getComputedStyle(p),R=_.transitionDuration,H="none"===_.transitionProperty||"0s"===R||"0s, 0s"===R||0===r.width&&0===r.height,re=new c_e(this,p,i,H);p.style.transform="scale3d(1, 1, 1)",re.state=xp.FADING_IN,i.persistent||(this._mostRecentTransientRipple=re);let se=null;return!H&&(u||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const ce=()=>this._finishRippleTransition(re),Te=()=>this._destroyRipple(re);p.addEventListener("transitionend",ce),p.addEventListener("transitioncancel",Te),se={onTransitionEnd:ce,onTransitionCancel:Te}}),this._activeRipples.set(re,se),(H||!u)&&this._finishRippleTransition(re),re}fadeOutRipple(e){if(e.state===xp.FADING_OUT||e.state===xp.HIDDEN)return;const t=e.element,i={...$Q,...e.config.animation};t.style.transitionDuration=`${i.exitDuration}ms`,t.style.opacity="0",e.state=xp.FADING_OUT,(e._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=fu(e);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,YQ.forEach(i=>{B4._eventManager.addHandler(this._ngZone,i,t,this)}))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{KQ.forEach(t=>{this._triggerElement.addEventListener(t,this,XQ)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){e.state===xp.FADING_IN?this._startFadeOutTransition(e):e.state===xp.FADING_OUT&&this._destroyRipple(e)}_startFadeOutTransition(e){const t=e===this._mostRecentTransientRipple,{persistent:i}=e.config;e.state=xp.VISIBLE,!i&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){const t=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=xp.HIDDEN,null!==t&&(e.element.removeEventListener("transitionend",t.onTransitionEnd),e.element.removeEventListener("transitioncancel",t.onTransitionCancel)),e.element.remove()}_onMousedown(e){const t=C4(e),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!M4(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;if(t)for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{!e.config.persistent&&(e.state===xp.VISIBLE||e.config.terminateOnPointerUp&&e.state===xp.FADING_IN)&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const e=this._triggerElement;e&&(YQ.forEach(t=>B4._eventManager.removeHandler(t,e,this)),this._pointerUpEventsRegistered&&KQ.forEach(t=>e.removeEventListener(t,this,XQ)))}}const bO=new Bi("mat-ripple-global-options");let R0=(()=>{class n{get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}constructor(t,i,r,s,a){this._elementRef=t,this._animationMode=a,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new B4(this,i,t,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,i=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,i,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...t})}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(oo),Lt(io),Lt(dd),Lt(bO,8),Lt(Od,8))};static#t=this.\u0275dir=Ft({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(i,r){2&i&&Ja("mat-ripple-unbounded",r.unbounded)},inputs:{color:[mi.None,"matRippleColor","color"],unbounded:[mi.None,"matRippleUnbounded","unbounded"],centered:[mi.None,"matRippleCentered","centered"],radius:[mi.None,"matRippleRadius","radius"],animation:[mi.None,"matRippleAnimation","animation"],disabled:[mi.None,"matRippleDisabled","disabled"],trigger:[mi.None,"matRippleTrigger","trigger"]},exportAs:["matRipple"],standalone:!0})}return n})(),P4=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({imports:[Wd,Wd]})}return n})();const ZQ={capture:!0},JQ=["focus","click","mouseenter","touchstart"],xO="mat-ripple-loader-uninitialized",wO="mat-ripple-loader-class-name",eW="mat-ripple-loader-centered",R4="mat-ripple-loader-disabled";let f_e=(()=>{class n{constructor(){this._document=pi(ba,{optional:!0}),this._animationMode=pi(Od,{optional:!0}),this._globalRippleOptions=pi(bO,{optional:!0}),this._platform=pi(dd),this._ngZone=pi(io),this._hosts=new Map,this._onInteraction=t=>{if(!(t.target instanceof HTMLElement))return;const r=t.target.closest(`[${xO}]`);r&&this._createRipple(r)},this._ngZone.runOutsideAngular(()=>{for(const t of JQ)this._document?.addEventListener(t,this._onInteraction,ZQ)})}ngOnDestroy(){const t=this._hosts.keys();for(const i of t)this.destroyRipple(i);for(const i of JQ)this._document?.removeEventListener(i,this._onInteraction,ZQ)}configureRipple(t,i){t.setAttribute(xO,""),(i.className||!t.hasAttribute(wO))&&t.setAttribute(wO,i.className||""),i.centered&&t.setAttribute(eW,""),i.disabled&&t.setAttribute(R4,"")}getRipple(t){return this._hosts.get(t)||this._createRipple(t)}setDisabled(t,i){const r=this._hosts.get(t);r?r.disabled=i:i?t.setAttribute(R4,""):t.removeAttribute(R4)}_createRipple(t){if(!this._document)return;const i=this._hosts.get(t);if(i)return i;t.querySelector(".mat-ripple")?.remove();const r=this._document.createElement("span");r.classList.add("mat-ripple",t.getAttribute(wO)),t.append(r);const s=new R0(new oo(r),this._ngZone,this._platform,this._globalRippleOptions?this._globalRippleOptions:void 0,this._animationMode?this._animationMode:void 0);return s._isInitialized=!0,s.trigger=t,s.centered=t.hasAttribute(eW),s.disabled=t.hasAttribute(R4),this.attachRipple(t,s),s}attachRipple(t,i){t.removeAttribute(xO),this._hosts.set(t,i)}destroyRipple(t){const i=this._hosts.get(t);i&&(i.ngOnDestroy(),this._hosts.delete(t))}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),CO=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=Zr({type:n,selectors:[["div","mat-internal-form-field",""]],hostAttrs:[1,"mdc-form-field","mat-internal-form-field"],hostVars:2,hostBindings:function(i,r){2&i&&Ja("mdc-form-field--align-end","before"===r.labelPosition)},inputs:{labelPosition:"labelPosition"},standalone:!0,features:[yd],attrs:J0e,ngContentSelectors:e_e,decls:1,vars:0,template:function(i,r){1&i&&(vh(),ru(0))},styles:[".mdc-form-field{display:inline-flex;align-items:center;vertical-align:middle}.mdc-form-field[hidden]{display:none}.mdc-form-field>label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0;order:0}[dir=rtl] .mdc-form-field>label,.mdc-form-field>label[dir=rtl]{margin-left:auto;margin-right:0}[dir=rtl] .mdc-form-field>label,.mdc-form-field>label[dir=rtl]{padding-left:0;padding-right:4px}.mdc-form-field--nowrap>label{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mdc-form-field--align-end>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px;order:-1}[dir=rtl] .mdc-form-field--align-end>label,.mdc-form-field--align-end>label[dir=rtl]{margin-left:0;margin-right:auto}[dir=rtl] .mdc-form-field--align-end>label,.mdc-form-field--align-end>label[dir=rtl]{padding-left:4px;padding-right:0}.mdc-form-field--space-between{justify-content:space-between}.mdc-form-field--space-between>label{margin:0}[dir=rtl] .mdc-form-field--space-between>label,.mdc-form-field--space-between>label[dir=rtl]{margin:0}.mdc-form-field{font-family:var(--mdc-form-field-label-text-font);line-height:var(--mdc-form-field-label-text-line-height);font-size:var(--mdc-form-field-label-text-size);font-weight:var(--mdc-form-field-label-text-weight);letter-spacing:var(--mdc-form-field-label-text-tracking);color:var(--mdc-form-field-label-text-color)}.mat-internal-form-field{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}"],encapsulation:2,changeDetection:0})}return n})();class MO{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;null!=e&&(this._attachedHost=null,e.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(e){this._attachedHost=e}}class e1 extends MO{constructor(e,t,i,r,s){super(),this.component=e,this.viewContainerRef=t,this.injector=i,this.componentFactoryResolver=r,this.projectableNodes=s}}class PE extends MO{constructor(e,t,i,r){super(),this.templateRef=e,this.viewContainerRef=t,this.context=i,this.injector=r}get origin(){return this.templateRef.elementRef}attach(e,t=this.context){return this.context=t,super.attach(e)}detach(){return this.context=void 0,super.detach()}}class p_e extends MO{constructor(e){super(),this.element=e instanceof oo?e.nativeElement:e}}class SO{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){return e instanceof e1?(this._attachedPortal=e,this.attachComponentPortal(e)):e instanceof PE?(this._attachedPortal=e,this.attachTemplatePortal(e)):this.attachDomPortal&&e instanceof p_e?(this._attachedPortal=e,this.attachDomPortal(e)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class m_e extends SO{constructor(e,t,i,r,s){super(),this.outletElement=e,this._componentFactoryResolver=t,this._appRef=i,this._defaultInjector=r,this.attachDomPortal=a=>{const l=a.element,d=this._document.createComment("dom-portal");l.parentNode.insertBefore(d,l),this.outletElement.appendChild(l),this._attachedPortal=a,super.setDisposeFn(()=>{d.parentNode&&d.parentNode.replaceChild(l,d)})},this._document=s}attachComponentPortal(e){const i=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component);let r;return e.viewContainerRef?(r=e.viewContainerRef.createComponent(i,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector,e.projectableNodes||void 0),this.setDisposeFn(()=>r.destroy())):(r=i.create(e.injector||this._defaultInjector||Al.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=e,r}attachTemplatePortal(e){let t=e.viewContainerRef,i=t.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return i.rootNodes.forEach(r=>this.outletElement.appendChild(r)),i.detectChanges(),this.setDisposeFn(()=>{let r=t.indexOf(i);-1!==r&&t.remove(r)}),this._attachedPortal=e,i}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}let wC=(()=>{class n extends SO{constructor(t,i,r){super(),this._componentFactoryResolver=t,this._viewContainerRef=i,this._isInitialized=!1,this.attached=new Ls,this.attachDomPortal=s=>{const a=s.element,l=this._document.createComment("dom-portal");s.setAttachedHost(this),a.parentNode.insertBefore(l,a),this._getRootNode().appendChild(a),this._attachedPortal=s,super.setDisposeFn(()=>{l.parentNode&&l.parentNode.replaceChild(a,l)})},this._document=r}get portal(){return this._attachedPortal}set portal(t){this.hasAttached()&&!t&&!this._isInitialized||(this.hasAttached()&&super.detach(),t&&super.attach(t),this._attachedPortal=t||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(t){t.setAttachedHost(this);const i=null!=t.viewContainerRef?t.viewContainerRef:this._viewContainerRef,s=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),a=i.createComponent(s,i.length,t.injector||i.injector,t.projectableNodes||void 0);return i!==this._viewContainerRef&&this._getRootNode().appendChild(a.hostView.rootNodes[0]),super.setDisposeFn(()=>a.destroy()),this._attachedPortal=t,this._attachedRef=a,this.attached.emit(a),a}attachTemplatePortal(t){t.setAttachedHost(this);const i=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=t,this._attachedRef=i,this.attached.emit(i),i}_getRootNode(){const t=this._viewContainerRef.element.nativeElement;return t.nodeType===t.ELEMENT_NODE?t:t.parentNode}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(p0),Lt(fs),Lt(ba))};static#t=this.\u0275dir=Ft({type:n,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:[mi.None,"cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],standalone:!0,features:[Lo]})}return n})(),k4=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({})}return n})();var aa=function(n){return n[n.State=0]="State",n[n.Transition=1]="Transition",n[n.Sequence=2]="Sequence",n[n.Group=3]="Group",n[n.Animate=4]="Animate",n[n.Keyframes=5]="Keyframes",n[n.Style=6]="Style",n[n.Trigger=7]="Trigger",n[n.Reference=8]="Reference",n[n.AnimateChild=9]="AnimateChild",n[n.AnimateRef=10]="AnimateRef",n[n.Query=11]="Query",n[n.Stagger=12]="Stagger",n}(aa||{});const t1="*";function RE(n,e){return{type:aa.Trigger,name:n,definitions:e,options:{}}}function k0(n,e=null){return{type:aa.Animate,styles:e,timings:n}}function Ku(n){return{type:aa.Style,styles:n,offset:null}}function n1(n,e,t){return{type:aa.State,name:n,styles:e,options:t}}function F0(n,e,t=null){return{type:aa.Transition,expr:n,animation:e,options:t}}class kE{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class rW{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,i=0,r=0;const s=this.players.length;0==s?queueMicrotask(()=>this._onFinish()):this.players.forEach(a=>{a.onDone(()=>{++t==s&&this._onFinish()}),a.onDestroy(()=>{++i==s&&this._onDestroy()}),a.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((a,l)=>Math.max(a,l.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,t/i.totalTime):1;i.setPosition(r)})}getPosition(){const e=this.players.reduce((t,i)=>null===t||i.totalTime>t.totalTime?i:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}const x_e=["addListener","removeListener"],w_e=["addEventListener","removeEventListener"],C_e=["on","off"];function px(n,e,t,i){if(Je(t)&&(i=t,t=void 0),i)return px(n,e,t).pipe(sk(i));const[r,s]=function E_e(n){return Je(n.addEventListener)&&Je(n.removeEventListener)}(n)?w_e.map(a=>l=>n[a](e,l,t)):function M_e(n){return Je(n.addListener)&&Je(n.removeListener)}(n)?x_e.map(sW(n,e)):function S_e(n){return Je(n.on)&&Je(n.off)}(n)?C_e.map(sW(n,e)):[];if(!r&&JR(n))return Qu(a=>px(a,e,t))(Nh(n));if(!r)throw new TypeError("Invalid event target");return new Pe(a=>{const l=(...d)=>a.next(1<d.length?d:d[0]);return r(l),()=>s(l)})}function sW(n,e){return t=>i=>n[t](e,i)}const FE={schedule(n){let e=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:i}=FE;i&&(e=i.requestAnimationFrame,t=i.cancelAnimationFrame);const r=e(s=>{t=void 0,n(s)});return new rt(()=>t?.(r))},requestAnimationFrame(...n){const{delegate:e}=FE;return(e?.requestAnimationFrame||requestAnimationFrame)(...n)},cancelAnimationFrame(...n){const{delegate:e}=FE;return(e?.cancelAnimationFrame||cancelAnimationFrame)(...n)},delegate:void 0},oW=new class D_e extends hO{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}}(class T_e extends uO{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=FE.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(e,t,i);const{actions:s}=e;null!=t&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==t&&(FE.cancelAnimationFrame(t),e._scheduled=void 0)}});function aW(n,e=TE){return function I_e(n){return ci((e,t)=>{let i=!1,r=null,s=null,a=!1;const l=()=>{if(s?.unsubscribe(),s=null,i){i=!1;const u=r;r=null,t.next(u)}a&&t.complete()},d=()=>{s=null,a&&t.complete()};e.subscribe(Pi(t,u=>{i=!0,r=u,s||Nh(n(u)).subscribe(s=Pi(t,l,d))},()=>{a=!0,(!i||!s||s.closed)&&t.complete()}))})}(()=>I4(n,e))}let F4=(()=>{class n{constructor(t,i,r){this._ngZone=t,this._platform=i,this._scrolled=new hn,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const i=this.scrollContainers.get(t);i&&(i.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new Pe(i=>{this._globalSubscription||this._addGlobalListener();const r=t>0?this._scrolled.pipe(aW(t)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):po()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(t,i){const r=this.getAncestorScrollContainers(t);return this.scrolled(i).pipe(od(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(t){const i=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,t)&&i.push(s)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,i){let r=fu(i),s=t.getElementRef().nativeElement;do{if(r==s)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>px(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}static#e=this.\u0275fac=function(i){return new(i||n)(xi(io),xi(dd),xi(ba,8))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),OE=(()=>{class n{constructor(t,i,r){this._platform=t,this._change=new hn,this._changeListener=s=>{this._change.next(s)},this._document=r,i.runOutsideAngular(()=>{if(t.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,i=this._getWindow(),r=t.documentElement,s=r.getBoundingClientRect();return{top:-s.top||t.body.scrollTop||i.scrollY||r.scrollTop||0,left:-s.left||t.body.scrollLeft||i.scrollX||r.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(aW(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}static#e=this.\u0275fac=function(i){return new(i||n)(xi(dd),xi(io),xi(ba,8))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),LE=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({})}return n})(),lW=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({imports:[IE,LE,IE,LE]})}return n})();const cW=_Q();class k_e{constructor(e,t){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){const e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=hu(-this._previousScrollPosition.left),e.style.top=hu(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const e=this._document.documentElement,i=e.style,r=this._document.body.style,s=i.scrollBehavior||"",a=r.scrollBehavior||"";this._isEnabled=!1,i.left=this._previousHTMLStyles.left,i.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),cW&&(i.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),cW&&(i.scrollBehavior=s,r.scrollBehavior=a)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,i=this._viewportRuler.getViewportSize();return t.scrollHeight>i.height||t.scrollWidth>i.width}}class F_e{constructor(e,t,i,r){this._scrollDispatcher=e,this._ngZone=t,this._viewportRuler=i,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef=e}enable(){if(this._scrollSubscription)return;const e=this._scrollDispatcher.scrolled(0).pipe(od(t=>!t||!this._overlayRef.overlayElement.contains(t.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class dW{enable(){}disable(){}attach(){}}function TO(n,e){return e.some(t=>n.bottom<t.top||n.top>t.bottom||n.right<t.left||n.left>t.right)}function uW(n,e){return e.some(t=>n.top<t.top||n.bottom>t.bottom||n.left<t.left||n.right>t.right)}class O_e{constructor(e,t,i,r){this._scrollDispatcher=e,this._viewportRuler=t,this._ngZone=i,this._config=r,this._scrollSubscription=null}attach(e){this._overlayRef=e}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:i,height:r}=this._viewportRuler.getViewportSize();TO(t,[{width:i,height:r,bottom:r,right:i,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let L_e=(()=>{class n{constructor(t,i,r,s){this._scrollDispatcher=t,this._viewportRuler=i,this._ngZone=r,this.noop=()=>new dW,this.close=a=>new F_e(this._scrollDispatcher,this._ngZone,this._viewportRuler,a),this.block=()=>new k_e(this._viewportRuler,this._document),this.reposition=a=>new O_e(this._scrollDispatcher,this._viewportRuler,this._ngZone,a),this._document=s}static#e=this.\u0275fac=function(i){return new(i||n)(xi(F4),xi(OE),xi(io),xi(ba))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class DO{constructor(e){if(this.scrollStrategy=new dW,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){const t=Object.keys(e);for(const i of t)void 0!==e[i]&&(this[i]=e[i])}}}class N_e{constructor(e,t){this.connectionPair=e,this.scrollableViewProperties=t}}let hW=(()=>{class n{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const i=this._attachedOverlays.indexOf(t);i>-1&&this._attachedOverlays.splice(i,1),0===this._attachedOverlays.length&&this.detach()}static#e=this.\u0275fac=function(i){return new(i||n)(xi(ba))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),U_e=(()=>{class n extends hW{constructor(t,i){super(t),this._ngZone=i,this._keydownListener=r=>{const s=this._attachedOverlays;for(let a=s.length-1;a>-1;a--)if(s[a]._keydownEvents.observers.length>0){const l=s[a]._keydownEvents;this._ngZone?this._ngZone.run(()=>l.next(r)):l.next(r);break}}}add(t){super.add(t),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}static#e=this.\u0275fac=function(i){return new(i||n)(xi(ba),xi(io,8))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),z_e=(()=>{class n extends hW{constructor(t,i,r){super(t),this._platform=i,this._ngZone=r,this._cursorStyleIsSet=!1,this._pointerDownListener=s=>{this._pointerDownEventTarget=fA(s)},this._clickListener=s=>{const a=fA(s),l="click"===s.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:a;this._pointerDownEventTarget=null;const d=this._attachedOverlays.slice();for(let u=d.length-1;u>-1;u--){const p=d[u];if(p._outsidePointerEvents.observers.length<1||!p.hasAttached())continue;if(p.overlayElement.contains(a)||p.overlayElement.contains(l))break;const _=p._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>_.next(s)):_.next(s)}}}add(t){if(super.add(t),!this._isAttached){const i=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(i)):this._addEventListeners(i),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=i.style.cursor,i.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const t=this._document.body;t.removeEventListener("pointerdown",this._pointerDownListener,!0),t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(t){t.addEventListener("pointerdown",this._pointerDownListener,!0),t.addEventListener("click",this._clickListener,!0),t.addEventListener("auxclick",this._clickListener,!0),t.addEventListener("contextmenu",this._clickListener,!0)}static#e=this.\u0275fac=function(i){return new(i||n)(xi(ba),xi(dd),xi(io,8))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),O4=(()=>{class n{constructor(t,i){this._platform=i,this._document=t}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||lO()){const r=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let s=0;s<r.length;s++)r[s].remove()}const i=this._document.createElement("div");i.classList.add(t),lO()?i.setAttribute("platform","test"):this._platform.isBrowser||i.setAttribute("platform","server"),this._document.body.appendChild(i),this._containerElement=i}static#e=this.\u0275fac=function(i){return new(i||n)(xi(ba),xi(dd))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class L4{constructor(e,t,i,r,s,a,l,d,u,p=!1){this._portalOutlet=e,this._host=t,this._pane=i,this._config=r,this._ngZone=s,this._keyboardDispatcher=a,this._document=l,this._location=d,this._outsideClickDispatcher=u,this._animationsDisabled=p,this._backdropElement=null,this._backdropClick=new hn,this._attachments=new hn,this._detachments=new hn,this._locationChanges=rt.EMPTY,this._backdropClickHandler=_=>this._backdropClick.next(_),this._backdropTransitionendHandler=_=>{this._disposeBackdrop(_.target)},this._keydownEvents=new hn,this._outsidePointerEvents=new hn,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const t=this._portalOutlet.attach(e);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(ad(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof t?.onDestroy&&t.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){const e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,e&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config={...this._config,...e},this._updateElementSize()}setDirection(e){this._config={...this._config,direction:e},this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){const e=this._config.direction;return e?"string"==typeof e?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const e=this._pane.style;e.width=hu(this._config.width),e.height=hu(this._config.height),e.minWidth=hu(this._config.minWidth),e.minHeight=hu(this._config.minHeight),e.maxWidth=hu(this._config.maxWidth),e.maxHeight=hu(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){const e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const e=this._backdropElement;if(e){if(this._animationsDisabled)return void this._disposeBackdrop(e);e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",this._backdropTransitionendHandler)}),e.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(e)},500))}}_toggleClasses(e,t,i){const r=DE(t||[]).filter(s=>!!s);r.length&&(i?e.classList.add(...r):e.classList.remove(...r))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const e=this._ngZone.onStable.pipe(Ql(gm(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),e.unsubscribe())})})}_disposeScrollStrategy(){const e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}_disposeBackdrop(e){e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",this._backdropTransitionendHandler),e.remove(),this._backdropElement===e&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const fW="cdk-overlay-connected-position-bounding-box",H_e=/([A-Za-z%]+)$/;class V_e{get positions(){return this._preferredPositions}constructor(e,t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new hn,this._resizeSubscription=rt.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}attach(e){this._validatePositions(),e.hostElement.classList.add(fW),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._originRect,t=this._overlayRect,i=this._viewportRect,r=this._containerRect,s=[];let a;for(let l of this._preferredPositions){let d=this._getOriginPoint(e,r,l),u=this._getOverlayPoint(d,t,l),p=this._getOverlayFit(u,t,i,l);if(p.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(l,d);this._canFitWithFlexibleDimensions(p,u,i)?s.push({position:l,origin:d,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(d,l)}):(!a||a.overlayFit.visibleArea<p.visibleArea)&&(a={overlayFit:p,overlayPoint:u,originPoint:d,position:l,overlayRect:t})}if(s.length){let l=null,d=-1;for(const u of s){const p=u.boundingBoxRect.width*u.boundingBoxRect.height*(u.position.weight||1);p>d&&(d=p,l=u)}return this._isPushed=!1,void this._applyPosition(l.position,l.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(a.position,a.originPoint);this._applyPosition(a.position,a.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&mx(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(fW),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const e=this._lastPosition;if(e){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._getOriginPoint(this._originRect,this._containerRect,e);this._applyPosition(e,t)}else this.apply()}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,-1===e.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,t,i){let r,s;if("center"==i.originX)r=e.left+e.width/2;else{const a=this._isRtl()?e.right:e.left,l=this._isRtl()?e.left:e.right;r="start"==i.originX?a:l}return t.left<0&&(r-=t.left),s="center"==i.originY?e.top+e.height/2:"top"==i.originY?e.top:e.bottom,t.top<0&&(s-=t.top),{x:r,y:s}}_getOverlayPoint(e,t,i){let r,s;return r="center"==i.overlayX?-t.width/2:"start"===i.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,s="center"==i.overlayY?-t.height/2:"top"==i.overlayY?0:-t.height,{x:e.x+r,y:e.y+s}}_getOverlayFit(e,t,i,r){const s=mW(t);let{x:a,y:l}=e,d=this._getOffset(r,"x"),u=this._getOffset(r,"y");d&&(a+=d),u&&(l+=u);let S=0-l,R=l+s.height-i.height,H=this._subtractOverflows(s.width,0-a,a+s.width-i.width),re=this._subtractOverflows(s.height,S,R),se=H*re;return{visibleArea:se,isCompletelyWithinViewport:s.width*s.height===se,fitsInViewportVertically:re===s.height,fitsInViewportHorizontally:H==s.width}}_canFitWithFlexibleDimensions(e,t,i){if(this._hasFlexibleDimensions){const r=i.bottom-t.y,s=i.right-t.x,a=pW(this._overlayRef.getConfig().minHeight),l=pW(this._overlayRef.getConfig().minWidth);return(e.fitsInViewportVertically||null!=a&&a<=r)&&(e.fitsInViewportHorizontally||null!=l&&l<=s)}return!1}_pushOverlayOnScreen(e,t,i){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};const r=mW(t),s=this._viewportRect,a=Math.max(e.x+r.width-s.width,0),l=Math.max(e.y+r.height-s.height,0),d=Math.max(s.top-i.top-e.y,0),u=Math.max(s.left-i.left-e.x,0);let p=0,_=0;return p=r.width<=s.width?u||-a:e.x<this._viewportMargin?s.left-i.left-e.x:0,_=r.height<=s.height?d||-l:e.y<this._viewportMargin?s.top-i.top-e.y:0,this._previousPushAmount={x:p,y:_},{x:e.x+p,y:e.y+_}}_applyPosition(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._positionChanges.observers.length){const i=this._getScrollVisibility();if(e!==this._lastPosition||!this._lastScrollVisibility||!function G_e(n,e){return n===e||n.isOriginClipped===e.isOriginClipped&&n.isOriginOutsideView===e.isOriginOutsideView&&n.isOverlayClipped===e.isOverlayClipped&&n.isOverlayOutsideView===e.isOverlayOutsideView}(this._lastScrollVisibility,i)){const r=new N_e(e,i);this._positionChanges.next(r)}this._lastScrollVisibility=i}this._lastPosition=e,this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;const t=this._boundingBox.querySelectorAll(this._transformOriginSelector);let i,r=e.overlayY;i="center"===e.overlayX?"center":this._isRtl()?"start"===e.overlayX?"right":"left":"start"===e.overlayX?"left":"right";for(let s=0;s<t.length;s++)t[s].style.transformOrigin=`${i} ${r}`}_calculateBoundingBoxRect(e,t){const i=this._viewportRect,r=this._isRtl();let s,a,l,p,_,S;if("top"===t.overlayY)a=e.y,s=i.height-a+this._viewportMargin;else if("bottom"===t.overlayY)l=i.height-e.y+2*this._viewportMargin,s=i.height-l+this._viewportMargin;else{const R=Math.min(i.bottom-e.y+i.top,e.y),H=this._lastBoundingBoxSize.height;s=2*R,a=e.y-R,s>H&&!this._isInitialRender&&!this._growAfterOpen&&(a=e.y-H/2)}if("end"===t.overlayX&&!r||"start"===t.overlayX&&r)S=i.width-e.x+2*this._viewportMargin,p=e.x-this._viewportMargin;else if("start"===t.overlayX&&!r||"end"===t.overlayX&&r)_=e.x,p=i.right-e.x;else{const R=Math.min(i.right-e.x+i.left,e.x),H=this._lastBoundingBoxSize.width;p=2*R,_=e.x-R,p>H&&!this._isInitialRender&&!this._growAfterOpen&&(_=e.x-H/2)}return{top:a,left:_,bottom:l,right:S,width:p,height:s}}_setBoundingBoxStyles(e,t){const i=this._calculateBoundingBoxRect(e,t);!this._isInitialRender&&!this._growAfterOpen&&(i.height=Math.min(i.height,this._lastBoundingBoxSize.height),i.width=Math.min(i.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const s=this._overlayRef.getConfig().maxHeight,a=this._overlayRef.getConfig().maxWidth;r.height=hu(i.height),r.top=hu(i.top),r.bottom=hu(i.bottom),r.width=hu(i.width),r.left=hu(i.left),r.right=hu(i.right),r.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",r.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",s&&(r.maxHeight=hu(s)),a&&(r.maxWidth=hu(a))}this._lastBoundingBoxSize=i,mx(this._boundingBox.style,r)}_resetBoundingBoxStyles(){mx(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){mx(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,t){const i={},r=this._hasExactPosition(),s=this._hasFlexibleDimensions,a=this._overlayRef.getConfig();if(r){const p=this._viewportRuler.getViewportScrollPosition();mx(i,this._getExactOverlayY(t,e,p)),mx(i,this._getExactOverlayX(t,e,p))}else i.position="static";let l="",d=this._getOffset(t,"x"),u=this._getOffset(t,"y");d&&(l+=`translateX(${d}px) `),u&&(l+=`translateY(${u}px)`),i.transform=l.trim(),a.maxHeight&&(r?i.maxHeight=hu(a.maxHeight):s&&(i.maxHeight="")),a.maxWidth&&(r?i.maxWidth=hu(a.maxWidth):s&&(i.maxWidth="")),mx(this._pane.style,i)}_getExactOverlayY(e,t,i){let r={top:"",bottom:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),"bottom"===e.overlayY?r.bottom=this._document.documentElement.clientHeight-(s.y+this._overlayRect.height)+"px":r.top=hu(s.y),r}_getExactOverlayX(e,t,i){let a,r={left:"",right:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),a=this._isRtl()?"end"===e.overlayX?"left":"right":"end"===e.overlayX?"right":"left","right"===a?r.right=this._document.documentElement.clientWidth-(s.x+this._overlayRect.width)+"px":r.left=hu(s.x),r}_getScrollVisibility(){const e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),i=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:uW(e,i),isOriginOutsideView:TO(e,i),isOverlayClipped:uW(t,i),isOverlayOutsideView:TO(t,i)}}_subtractOverflows(e,...t){return t.reduce((i,r)=>i-Math.max(r,0),e)}_getNarrowedViewportRect(){const e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,i=this._viewportRuler.getViewportScrollPosition();return{top:i.top+this._viewportMargin,left:i.left+this._viewportMargin,right:i.left+e-this._viewportMargin,bottom:i.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,t){return"x"===t?null==e.offsetX?this._offsetX:e.offsetX:null==e.offsetY?this._offsetY:e.offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&DE(e).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){const e=this._origin;if(e instanceof oo)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();const t=e.width||0,i=e.height||0;return{top:e.y,bottom:e.y+i,left:e.x,right:e.x+t,height:i,width:t}}}function mx(n,e){for(let t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function pW(n){if("number"!=typeof n&&null!=n){const[e,t]=n.split(H_e);return t&&"px"!==t?null:parseFloat(e)}return n||null}function mW(n){return{top:Math.floor(n.top),right:Math.floor(n.right),bottom:Math.floor(n.bottom),left:Math.floor(n.left),width:Math.floor(n.width),height:Math.floor(n.height)}}const AW="cdk-global-overlay-wrapper";class q_e{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(e){const t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(AW),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._xOffset=e,this._xPosition="left",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._xOffset=e,this._xPosition="right",this}start(e=""){return this._xOffset=e,this._xPosition="start",this}end(e=""){return this._xOffset=e,this._xPosition="end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._xPosition="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,i=this._overlayRef.getConfig(),{width:r,height:s,maxWidth:a,maxHeight:l}=i,d=!("100%"!==r&&"100vw"!==r||a&&"100%"!==a&&"100vw"!==a),u=!("100%"!==s&&"100vh"!==s||l&&"100%"!==l&&"100vh"!==l),p=this._xPosition,_=this._xOffset,S="rtl"===this._overlayRef.getConfig().direction;let R="",H="",re="";d?re="flex-start":"center"===p?(re="center",S?H=_:R=_):S?"left"===p||"end"===p?(re="flex-end",R=_):("right"===p||"start"===p)&&(re="flex-start",H=_):"left"===p||"start"===p?(re="flex-start",R=_):("right"===p||"end"===p)&&(re="flex-end",H=_),e.position=this._cssPosition,e.marginLeft=d?"0":R,e.marginTop=u?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=d?"0":H,t.justifyContent=re,t.alignItems=u?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,i=t.style;t.classList.remove(AW),i.justifyContent=i.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}}let Q_e=(()=>{class n{constructor(t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s}global(){return new q_e}flexibleConnectedTo(t){return new V_e(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}static#e=this.\u0275fac=function(i){return new(i||n)(xi(OE),xi(ba),xi(dd),xi(O4))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),W_e=0,pu=(()=>{class n{constructor(t,i,r,s,a,l,d,u,p,_,S,R){this.scrollStrategies=t,this._overlayContainer=i,this._componentFactoryResolver=r,this._positionBuilder=s,this._keyboardDispatcher=a,this._injector=l,this._ngZone=d,this._document=u,this._directionality=p,this._location=_,this._outsideClickDispatcher=S,this._animationsModuleType=R}create(t){const i=this._createHostElement(),r=this._createPaneElement(i),s=this._createPortalOutlet(r),a=new DO(t);return a.direction=a.direction||this._directionality.value,new L4(s,i,r,a,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(t){const i=this._document.createElement("div");return i.id="cdk-overlay-"+W_e++,i.classList.add("cdk-overlay-pane"),t.appendChild(i),i}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(R_)),new m_e(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}static#e=this.\u0275fac=function(i){return new(i||n)(xi(L_e),xi(O4),xi(p0),xi(Q_e),xi(U_e),xi(Al),xi(io),xi(ba),xi(_m),xi(_b),xi(z_e),xi(Od,8))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const X_e={provide:new Bi("cdk-connected-overlay-scroll-strategy",{providedIn:"root",factory:()=>{const n=pi(pu);return()=>n.scrollStrategies.reposition()}}),deps:[pu],useFactory:function $_e(n){return()=>n.scrollStrategies.reposition()}};let NE=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({providers:[pu,X_e],imports:[IE,k4,lW,lW]})}return n})();const Y_e=["mat-menu-item",""],K_e=[[["mat-icon"],["","matMenuItemIcon",""]],"*"],Z_e=["mat-icon, [matMenuItemIcon]","*"];function J_e(n,e){1&n&&(Fl(),zt(0,"svg",2),Fr(1,"polygon",3),an())}const e1e=["*"];function t1e(n,e){if(1&n){const t=ta();zt(0,"div",0),Ai("keydown",function(r){return Ci(t),Mi(Pr()._handleKeydown(r))})("click",function(){return Ci(t),Mi(Pr().closed.emit("click"))})("@transformMenu.start",function(r){return Ci(t),Mi(Pr()._onAnimationStart(r))})("@transformMenu.done",function(r){return Ci(t),Mi(Pr()._onAnimationDone(r))}),zt(1,"div",1),ru(2),an()()}if(2&n){const t=Pr();Hn("id",t.panelId)("ngClass",t._classList)("@transformMenu",t._panelAnimationState),sl("aria-label",t.ariaLabel||null)("aria-labelledby",t.ariaLabelledby||null)("aria-describedby",t.ariaDescribedby||null)}}const IO=new Bi("MAT_MENU_PANEL");let r1=(()=>{class n{constructor(t,i,r,s,a){this._elementRef=t,this._document=i,this._focusMonitor=r,this._parentMenu=s,this._changeDetectorRef=a,this.role="menuitem",this.disabled=!1,this.disableRipple=!1,this._hovered=new hn,this._focused=new hn,this._highlighted=!1,this._triggersSubmenu=!1,s?.addItem?.(this)}focus(t,i){this._focusMonitor&&t?this._focusMonitor.focusVia(this._getHostElement(),t,i):this._getHostElement().focus(i),this._focused.next(this)}ngAfterViewInit(){this._focusMonitor&&this._focusMonitor.monitor(this._elementRef,!1)}ngOnDestroy(){this._focusMonitor&&this._focusMonitor.stopMonitoring(this._elementRef),this._parentMenu&&this._parentMenu.removeItem&&this._parentMenu.removeItem(this),this._hovered.complete(),this._focused.complete()}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._elementRef.nativeElement}_checkDisabled(t){this.disabled&&(t.preventDefault(),t.stopPropagation())}_handleMouseEnter(){this._hovered.next(this)}getLabel(){const t=this._elementRef.nativeElement.cloneNode(!0),i=t.querySelectorAll("mat-icon, .material-icons");for(let r=0;r<i.length;r++)i[r].remove();return t.textContent?.trim()||""}_setHighlighted(t){this._highlighted=t,this._changeDetectorRef?.markForCheck()}_setTriggersSubmenu(t){this._triggersSubmenu=t,this._changeDetectorRef?.markForCheck()}_hasFocus(){return this._document&&this._document.activeElement===this._getHostElement()}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(oo),Lt(ba),Lt(J_),Lt(IO,8),Lt(Sc))};static#t=this.\u0275cmp=Zr({type:n,selectors:[["","mat-menu-item",""]],hostAttrs:[1,"mat-mdc-menu-item","mat-mdc-focus-indicator"],hostVars:8,hostBindings:function(i,r){1&i&&Ai("click",function(a){return r._checkDisabled(a)})("mouseenter",function(){return r._handleMouseEnter()}),2&i&&(sl("role",r.role)("tabindex",r._getTabIndex())("aria-disabled",r.disabled)("disabled",r.disabled||null),Ja("mat-mdc-menu-item-highlighted",r._highlighted)("mat-mdc-menu-item-submenu-trigger",r._triggersSubmenu))},inputs:{role:"role",disabled:[mi.HasDecoratorInputTransform,"disabled","disabled",_o],disableRipple:[mi.HasDecoratorInputTransform,"disableRipple","disableRipple",_o]},exportAs:["matMenuItem"],standalone:!0,features:[ql,yd],attrs:Y_e,ngContentSelectors:Z_e,decls:5,vars:3,consts:[[1,"mat-mdc-menu-item-text"],["matRipple","",1,"mat-mdc-menu-ripple",3,"matRippleDisabled","matRippleTrigger"],["viewBox","0 0 5 10","focusable","false","aria-hidden","true",1,"mat-mdc-menu-submenu-icon"],["points","0,0 5,5 0,10"]],template:function(i,r){1&i&&(vh(K_e),ru(0),zt(1,"span",0),ru(2,1),an(),Fr(3,"div",1),zs(4,J_e,2,0,":svg:svg",2)),2&i&&(Vn(3),Hn("matRippleDisabled",r.disableRipple||r.disabled)("matRippleTrigger",r._getHostElement()),Vn(),P_(4,r._triggersSubmenu?4:-1))},dependencies:[R0],encapsulation:2,changeDetection:0})}return n})();const n1e=new Bi("MatMenuContent"),N4={transformMenu:RE("transformMenu",[n1("void",Ku({opacity:0,transform:"scale(0.8)"})),F0("void => enter",k0("120ms cubic-bezier(0, 0, 0.2, 1)",Ku({opacity:1,transform:"scale(1)"}))),F0("* => void",k0("100ms 25ms linear",Ku({opacity:0})))]),fadeInItems:RE("fadeInItems",[n1("showing",Ku({opacity:1})),F0("void => *",[Ku({opacity:0}),k0("400ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let i1e=0;const r1e=new Bi("mat-menu-default-options",{providedIn:"root",factory:function s1e(){return{overlapTrigger:!1,xPosition:"after",yPosition:"below",backdropClass:"cdk-overlay-transparent-backdrop"}}});let s1=(()=>{class n{get xPosition(){return this._xPosition}set xPosition(t){this._xPosition=t,this.setPositionClasses()}get yPosition(){return this._yPosition}set yPosition(t){this._yPosition=t,this.setPositionClasses()}set panelClass(t){const i=this._previousPanelClass;i&&i.length&&i.split(" ").forEach(r=>{this._classList[r]=!1}),this._previousPanelClass=t,t&&t.length&&(t.split(" ").forEach(r=>{this._classList[r]=!0}),this._elementRef.nativeElement.className="")}get classList(){return this.panelClass}set classList(t){this.panelClass=t}constructor(t,i,r,s){this._elementRef=t,this._ngZone=i,this._changeDetectorRef=s,this._elevationPrefix="mat-elevation-z",this._baseElevation=8,this._directDescendantItems=new _f,this._classList={},this._panelAnimationState="void",this._animationDone=new hn,this.closed=new Ls,this.close=this.closed,this.panelId="mat-menu-panel-"+i1e++,this.overlayPanelClass=r.overlayPanelClass||"",this._xPosition=r.xPosition,this._yPosition=r.yPosition,this.backdropClass=r.backdropClass,this.overlapTrigger=r.overlapTrigger,this.hasBackdrop=r.hasBackdrop}ngOnInit(){this.setPositionClasses()}ngAfterContentInit(){this._updateDirectDescendants(),this._keyManager=new PQ(this._directDescendantItems).withWrap().withTypeAhead().withHomeAndEnd(),this._keyManager.tabOut.subscribe(()=>this.closed.emit("tab")),this._directDescendantItems.changes.pipe(sA(this._directDescendantItems),Df(t=>gm(...t.map(i=>i._focused)))).subscribe(t=>this._keyManager.updateActiveItem(t)),this._directDescendantItems.changes.subscribe(t=>{const i=this._keyManager;if("enter"===this._panelAnimationState&&i.activeItem?._hasFocus()){const r=t.toArray(),s=Math.max(0,Math.min(r.length-1,i.activeItemIndex||0));r[s]&&!r[s].disabled?i.setActiveItem(s):i.setNextItemActive()}})}ngOnDestroy(){this._keyManager?.destroy(),this._directDescendantItems.destroy(),this.closed.complete(),this._firstItemFocusSubscription?.unsubscribe()}_hovered(){return this._directDescendantItems.changes.pipe(sA(this._directDescendantItems),Df(i=>gm(...i.map(r=>r._hovered))))}addItem(t){}removeItem(t){}_handleKeydown(t){const i=t.keyCode,r=this._keyManager;switch(i){case 27:bC(t)||(t.preventDefault(),this.closed.emit("keydown"));break;case 37:this.parentMenu&&"ltr"===this.direction&&this.closed.emit("keydown");break;case 39:this.parentMenu&&"rtl"===this.direction&&this.closed.emit("keydown");break;default:return(38===i||40===i)&&r.setFocusOrigin("keyboard"),void r.onKeydown(t)}t.stopPropagation()}focusFirstItem(t="program"){this._firstItemFocusSubscription?.unsubscribe(),this._firstItemFocusSubscription=this._ngZone.onStable.pipe(ad(1)).subscribe(()=>{let i=null;if(this._directDescendantItems.length&&(i=this._directDescendantItems.first._getHostElement().closest('[role="menu"]')),!i||!i.contains(document.activeElement)){const r=this._keyManager;r.setFocusOrigin(t).setFirstItemActive(),!r.activeItem&&i&&i.focus()}})}resetActiveItem(){this._keyManager.setActiveItem(-1)}setElevation(t){const i=Math.min(this._baseElevation+t,24),r=`${this._elevationPrefix}${i}`,s=Object.keys(this._classList).find(a=>a.startsWith(this._elevationPrefix));(!s||s===this._previousElevation)&&(this._previousElevation&&(this._classList[this._previousElevation]=!1),this._classList[r]=!0,this._previousElevation=r)}setPositionClasses(t=this.xPosition,i=this.yPosition){const r=this._classList;r["mat-menu-before"]="before"===t,r["mat-menu-after"]="after"===t,r["mat-menu-above"]="above"===i,r["mat-menu-below"]="below"===i,this._changeDetectorRef?.markForCheck()}_startAnimation(){this._panelAnimationState="enter"}_resetAnimation(){this._panelAnimationState="void"}_onAnimationDone(t){this._animationDone.next(t),this._isAnimating=!1}_onAnimationStart(t){this._isAnimating=!0,"enter"===t.toState&&0===this._keyManager.activeItemIndex&&(t.element.scrollTop=0)}_updateDirectDescendants(){this._allItems.changes.pipe(sA(this._allItems)).subscribe(t=>{this._directDescendantItems.reset(t.filter(i=>i._parentMenu===this)),this._directDescendantItems.notifyOnChanges()})}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(oo),Lt(io),Lt(r1e),Lt(Sc))};static#t=this.\u0275cmp=Zr({type:n,selectors:[["mat-menu"]],contentQueries:function(i,r,s){if(1&i&&(mp(s,n1e,5),mp(s,r1,5),mp(s,r1,4)),2&i){let a;pa(a=ma())&&(r.lazyContent=a.first),pa(a=ma())&&(r._allItems=a),pa(a=ma())&&(r.items=a)}},viewQuery:function(i,r){if(1&i&&_l(Ud,5),2&i){let s;pa(s=ma())&&(r.templateRef=s.first)}},hostVars:3,hostBindings:function(i,r){2&i&&sl("aria-label",null)("aria-labelledby",null)("aria-describedby",null)},inputs:{backdropClass:"backdropClass",ariaLabel:[mi.None,"aria-label","ariaLabel"],ariaLabelledby:[mi.None,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[mi.None,"aria-describedby","ariaDescribedby"],xPosition:"xPosition",yPosition:"yPosition",overlapTrigger:[mi.HasDecoratorInputTransform,"overlapTrigger","overlapTrigger",_o],hasBackdrop:[mi.HasDecoratorInputTransform,"hasBackdrop","hasBackdrop",t=>null==t?null:_o(t)],panelClass:[mi.None,"class","panelClass"],classList:"classList"},outputs:{closed:"closed",close:"close"},exportAs:["matMenu"],standalone:!0,features:[qo([{provide:IO,useExisting:n}]),ql,yd],ngContentSelectors:e1e,decls:1,vars:0,consts:[["tabindex","-1","role","menu",1,"mat-mdc-menu-panel","mat-mdc-elevation-specific",3,"keydown","click","id","ngClass"],[1,"mat-mdc-menu-content"]],template:function(i,r){1&i&&(vh(),zs(0,t1e,3,6,"ng-template"))},dependencies:[om],styles:['mat-menu{display:none}.mat-mdc-menu-content{margin:0;padding:8px 0;list-style-type:none}.mat-mdc-menu-content:focus{outline:none}.mat-mdc-menu-content,.mat-mdc-menu-content .mat-mdc-menu-item .mat-mdc-menu-item-text{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;flex:1;white-space:normal;font-family:var(--mat-menu-item-label-text-font);line-height:var(--mat-menu-item-label-text-line-height);font-size:var(--mat-menu-item-label-text-size);letter-spacing:var(--mat-menu-item-label-text-tracking);font-weight:var(--mat-menu-item-label-text-weight)}.mat-mdc-menu-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;box-sizing:border-box;outline:0;border-radius:var(--mat-menu-container-shape);background-color:var(--mat-menu-container-color);will-change:transform,opacity}.mat-mdc-menu-panel.ng-animating{pointer-events:none}.cdk-high-contrast-active .mat-mdc-menu-panel{outline:solid 1px}.mat-divider{color:var(--mat-menu-divider-color);margin-bottom:var(--mat-menu-divider-bottom-spacing);margin-top:var(--mat-menu-divider-top-spacing)}.mat-mdc-menu-item{display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:0;padding-left:var(--mat-menu-item-leading-spacing);padding-right:var(--mat-menu-item-trailing-spacing);-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);cursor:pointer;width:100%;text-align:left;box-sizing:border-box;color:inherit;font-size:inherit;background:none;text-decoration:none;margin:0;align-items:center;min-height:48px}.mat-mdc-menu-item:focus{outline:none}[dir=rtl] .mat-mdc-menu-item,.mat-mdc-menu-item[dir=rtl]{padding-left:var(--mat-menu-item-trailing-spacing);padding-right:var(--mat-menu-item-leading-spacing)}.mat-mdc-menu-item:has(.material-icons,mat-icon,[matButtonIcon]){padding-left:var(--mat-menu-item-with-icon-leading-spacing);padding-right:var(--mat-menu-item-with-icon-trailing-spacing)}[dir=rtl] .mat-mdc-menu-item:has(.material-icons,mat-icon,[matButtonIcon]),.mat-mdc-menu-item:has(.material-icons,mat-icon,[matButtonIcon])[dir=rtl]{padding-left:var(--mat-menu-item-with-icon-trailing-spacing);padding-right:var(--mat-menu-item-with-icon-leading-spacing)}.mat-mdc-menu-item::-moz-focus-inner{border:0}.mat-mdc-menu-item,.mat-mdc-menu-item:visited,.mat-mdc-menu-item:link{color:var(--mat-menu-item-label-text-color)}.mat-mdc-menu-item .mat-icon-no-color,.mat-mdc-menu-item .mat-mdc-menu-submenu-icon{color:var(--mat-menu-item-icon-color)}.mat-mdc-menu-item[disabled]{cursor:default;opacity:.38}.mat-mdc-menu-item[disabled]::after{display:block;position:absolute;content:"";top:0;left:0;bottom:0;right:0}.mat-mdc-menu-item .mat-icon{flex-shrink:0;margin-right:var(--mat-menu-item-spacing);height:var(--mat-menu-item-icon-size);width:var(--mat-menu-item-icon-size)}[dir=rtl] .mat-mdc-menu-item{text-align:right}[dir=rtl] .mat-mdc-menu-item .mat-icon{margin-right:0;margin-left:var(--mat-menu-item-spacing)}.mat-mdc-menu-item:not([disabled]):hover{background-color:var(--mat-menu-item-hover-state-layer-color)}.mat-mdc-menu-item:not([disabled]).cdk-program-focused,.mat-mdc-menu-item:not([disabled]).cdk-keyboard-focused,.mat-mdc-menu-item:not([disabled]).mat-mdc-menu-item-highlighted{background-color:var(--mat-menu-item-focus-state-layer-color)}.cdk-high-contrast-active .mat-mdc-menu-item{margin-top:1px}.mat-mdc-menu-submenu-icon{width:var(--mat-menu-item-icon-size);height:10px;fill:currentColor;padding-left:var(--mat-menu-item-spacing)}[dir=rtl] .mat-mdc-menu-submenu-icon{right:auto;padding-right:var(--mat-menu-item-spacing);padding-left:0}.cdk-high-contrast-active .mat-mdc-menu-submenu-icon{fill:CanvasText}.mat-mdc-menu-item .mat-mdc-menu-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}'],encapsulation:2,data:{animation:[N4.transformMenu,N4.fadeInItems]},changeDetection:0})}return n})();const gW=new Bi("mat-menu-scroll-strategy",{providedIn:"root",factory:()=>{const n=pi(pu);return()=>n.scrollStrategies.reposition()}}),a1e={provide:gW,deps:[pu],useFactory:function o1e(n){return()=>n.scrollStrategies.reposition()}},_W=B0({passive:!0});let CC=(()=>{class n{get _deprecatedMatMenuTriggerFor(){return this.menu}set _deprecatedMatMenuTriggerFor(t){this.menu=t}get menu(){return this._menu}set menu(t){t!==this._menu&&(this._menu=t,this._menuCloseSubscription.unsubscribe(),t&&(this._menuCloseSubscription=t.close.subscribe(i=>{this._destroyMenu(i),("click"===i||"tab"===i)&&this._parentMaterialMenu&&this._parentMaterialMenu.closed.emit(i)})),this._menuItemInstance?._setTriggersSubmenu(this.triggersSubmenu()))}constructor(t,i,r,s,a,l,d,u,p){this._overlay=t,this._element=i,this._viewContainerRef=r,this._menuItemInstance=l,this._dir=d,this._focusMonitor=u,this._ngZone=p,this._overlayRef=null,this._menuOpen=!1,this._closingActionsSubscription=rt.EMPTY,this._hoverSubscription=rt.EMPTY,this._menuCloseSubscription=rt.EMPTY,this._changeDetectorRef=pi(Sc),this._handleTouchStart=_=>{M4(_)||(this._openedBy="touch")},this._openedBy=void 0,this.restoreFocus=!0,this.menuOpened=new Ls,this.onMenuOpen=this.menuOpened,this.menuClosed=new Ls,this.onMenuClose=this.menuClosed,this._scrollStrategy=s,this._parentMaterialMenu=a instanceof s1?a:void 0,i.nativeElement.addEventListener("touchstart",this._handleTouchStart,_W)}ngAfterContentInit(){this._handleHover()}ngOnDestroy(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=null),this._element.nativeElement.removeEventListener("touchstart",this._handleTouchStart,_W),this._menuCloseSubscription.unsubscribe(),this._closingActionsSubscription.unsubscribe(),this._hoverSubscription.unsubscribe()}get menuOpen(){return this._menuOpen}get dir(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}triggersSubmenu(){return!!(this._menuItemInstance&&this._parentMaterialMenu&&this.menu)}toggleMenu(){return this._menuOpen?this.closeMenu():this.openMenu()}openMenu(){const t=this.menu;if(this._menuOpen||!t)return;const i=this._createOverlay(t),r=i.getConfig(),s=r.positionStrategy;this._setPosition(t,s),r.hasBackdrop=null==t.hasBackdrop?!this.triggersSubmenu():t.hasBackdrop,i.attach(this._getPortal(t)),t.lazyContent&&t.lazyContent.attach(this.menuData),this._closingActionsSubscription=this._menuClosingActions().subscribe(()=>this.closeMenu()),this._initMenu(t),t instanceof s1&&(t._startAnimation(),t._directDescendantItems.changes.pipe(Ql(t.close)).subscribe(()=>{s.withLockedPosition(!1).reapplyLastPosition(),s.withLockedPosition(!0)}))}closeMenu(){this.menu?.close.emit()}focus(t,i){this._focusMonitor&&t?this._focusMonitor.focusVia(this._element,t,i):this._element.nativeElement.focus(i)}updatePosition(){this._overlayRef?.updatePosition()}_destroyMenu(t){if(!this._overlayRef||!this.menuOpen)return;const i=this.menu;this._closingActionsSubscription.unsubscribe(),this._overlayRef.detach(),this.restoreFocus&&("keydown"===t||!this._openedBy||!this.triggersSubmenu())&&this.focus(this._openedBy),this._openedBy=void 0,i instanceof s1?(i._resetAnimation(),i.lazyContent?i._animationDone.pipe(od(r=>"void"===r.toState),ad(1),Ql(i.lazyContent._attached)).subscribe({next:()=>i.lazyContent.detach(),complete:()=>this._setIsMenuOpen(!1)}):this._setIsMenuOpen(!1)):(this._setIsMenuOpen(!1),i?.lazyContent?.detach())}_initMenu(t){t.parentMenu=this.triggersSubmenu()?this._parentMaterialMenu:void 0,t.direction=this.dir,this._setMenuElevation(t),t.focusFirstItem(this._openedBy||"program"),this._setIsMenuOpen(!0)}_setMenuElevation(t){if(t.setElevation){let i=0,r=t.parentMenu;for(;r;)i++,r=r.parentMenu;t.setElevation(i)}}_setIsMenuOpen(t){t!==this._menuOpen&&(this._menuOpen=t,this._menuOpen?this.menuOpened.emit():this.menuClosed.emit(),this.triggersSubmenu()&&this._menuItemInstance._setHighlighted(t),this._changeDetectorRef.markForCheck())}_createOverlay(t){if(!this._overlayRef){const i=this._getOverlayConfig(t);this._subscribeToPositions(t,i.positionStrategy),this._overlayRef=this._overlay.create(i),this._overlayRef.keydownEvents().subscribe()}return this._overlayRef}_getOverlayConfig(t){return new DO({positionStrategy:this._overlay.position().flexibleConnectedTo(this._element).withLockedPosition().withGrowAfterOpen().withTransformOriginOn(".mat-menu-panel, .mat-mdc-menu-panel"),backdropClass:t.backdropClass||"cdk-overlay-transparent-backdrop",panelClass:t.overlayPanelClass,scrollStrategy:this._scrollStrategy(),direction:this._dir})}_subscribeToPositions(t,i){t.setPositionClasses&&i.positionChanges.subscribe(r=>{const s="start"===r.connectionPair.overlayX?"after":"before",a="top"===r.connectionPair.overlayY?"below":"above";this._ngZone?this._ngZone.run(()=>t.setPositionClasses(s,a)):t.setPositionClasses(s,a)})}_setPosition(t,i){let[r,s]="before"===t.xPosition?["end","start"]:["start","end"],[a,l]="above"===t.yPosition?["bottom","top"]:["top","bottom"],[d,u]=[a,l],[p,_]=[r,s],S=0;if(this.triggersSubmenu()){if(_=r="before"===t.xPosition?"start":"end",s=p="end"===r?"start":"end",this._parentMaterialMenu){if(null==this._parentInnerPadding){const R=this._parentMaterialMenu.items.first;this._parentInnerPadding=R?R._getHostElement().offsetTop:0}S="bottom"===a?this._parentInnerPadding:-this._parentInnerPadding}}else t.overlapTrigger||(d="top"===a?"bottom":"top",u="top"===l?"bottom":"top");i.withPositions([{originX:r,originY:d,overlayX:p,overlayY:a,offsetY:S},{originX:s,originY:d,overlayX:_,overlayY:a,offsetY:S},{originX:r,originY:u,overlayX:p,overlayY:l,offsetY:-S},{originX:s,originY:u,overlayX:_,overlayY:l,offsetY:-S}])}_menuClosingActions(){const t=this._overlayRef.backdropClick(),i=this._overlayRef.detachments();return gm(t,this._parentMaterialMenu?this._parentMaterialMenu.closed:po(),this._parentMaterialMenu?this._parentMaterialMenu._hovered().pipe(od(a=>a!==this._menuItemInstance),od(()=>this._menuOpen)):po(),i)}_handleMousedown(t){C4(t)||(this._openedBy=0===t.button?"mouse":void 0,this.triggersSubmenu()&&t.preventDefault())}_handleKeydown(t){const i=t.keyCode;(13===i||32===i)&&(this._openedBy="keyboard"),this.triggersSubmenu()&&(39===i&&"ltr"===this.dir||37===i&&"rtl"===this.dir)&&(this._openedBy="keyboard",this.openMenu())}_handleClick(t){this.triggersSubmenu()?(t.stopPropagation(),this.openMenu()):this.toggleMenu()}_handleHover(){!this.triggersSubmenu()||!this._parentMaterialMenu||(this._hoverSubscription=this._parentMaterialMenu._hovered().pipe(od(t=>t===this._menuItemInstance&&!t.disabled),qQ(0,vO)).subscribe(()=>{this._openedBy="mouse",this.menu instanceof s1&&this.menu._isAnimating?this.menu._animationDone.pipe(ad(1),qQ(0,vO),Ql(this._parentMaterialMenu._hovered())).subscribe(()=>this.openMenu()):this.openMenu()}))}_getPortal(t){return(!this._portal||this._portal.templateRef!==t.templateRef)&&(this._portal=new PE(t.templateRef,this._viewContainerRef)),this._portal}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(pu),Lt(oo),Lt(fs),Lt(gW),Lt(IO,8),Lt(r1,10),Lt(_m,8),Lt(J_),Lt(io))};static#t=this.\u0275dir=Ft({type:n,selectors:[["","mat-menu-trigger-for",""],["","matMenuTriggerFor",""]],hostAttrs:[1,"mat-mdc-menu-trigger"],hostVars:3,hostBindings:function(i,r){1&i&&Ai("click",function(a){return r._handleClick(a)})("mousedown",function(a){return r._handleMousedown(a)})("keydown",function(a){return r._handleKeydown(a)}),2&i&&sl("aria-haspopup",r.menu?"menu":null)("aria-expanded",r.menuOpen)("aria-controls",r.menuOpen?r.menu.panelId:null)},inputs:{_deprecatedMatMenuTriggerFor:[mi.None,"mat-menu-trigger-for","_deprecatedMatMenuTriggerFor"],menu:[mi.None,"matMenuTriggerFor","menu"],menuData:[mi.None,"matMenuTriggerData","menuData"],restoreFocus:[mi.None,"matMenuTriggerRestoreFocus","restoreFocus"]},outputs:{menuOpened:"menuOpened",onMenuOpen:"onMenuOpen",menuClosed:"menuClosed",onMenuClose:"onMenuClose"},exportAs:["matMenuTrigger"],standalone:!0})}return n})(),l1e=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({providers:[a1e],imports:[fS,P4,Wd,NE,LE,Wd]})}return n})();const c1e=["tooltip"],vW=new Bi("mat-tooltip-scroll-strategy",{providedIn:"root",factory:()=>{const n=pi(pu);return()=>n.scrollStrategies.reposition({scrollThrottle:20})}}),u1e={provide:vW,deps:[pu],useFactory:function d1e(n){return()=>n.scrollStrategies.reposition({scrollThrottle:20})}},f1e=new Bi("mat-tooltip-default-options",{providedIn:"root",factory:function h1e(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}}),bW="tooltip-panel",xW=B0({passive:!0});let o1=(()=>{class n{get position(){return this._position}set position(t){t!==this._position&&(this._position=t,this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition()))}get positionAtOrigin(){return this._positionAtOrigin}set positionAtOrigin(t){this._positionAtOrigin=MQ(t),this._detach(),this._overlayRef=null}get disabled(){return this._disabled}set disabled(t){this._disabled=MQ(t),this._disabled?this.hide(0):this._setupPointerEnterEventsIfNeeded()}get showDelay(){return this._showDelay}set showDelay(t){this._showDelay=ux(t)}get hideDelay(){return this._hideDelay}set hideDelay(t){this._hideDelay=ux(t),this._tooltipInstance&&(this._tooltipInstance._mouseLeaveHideDelay=this._hideDelay)}get message(){return this._message}set message(t){this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this._message,"tooltip"),this._message=null!=t?String(t).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipMessage(),this._ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._ariaDescriber.describe(this._elementRef.nativeElement,this.message,"tooltip")})}))}get tooltipClass(){return this._tooltipClass}set tooltipClass(t){this._tooltipClass=t,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}constructor(t,i,r,s,a,l,d,u,p,_,S,R){this._overlay=t,this._elementRef=i,this._scrollDispatcher=r,this._viewContainerRef=s,this._ngZone=a,this._platform=l,this._ariaDescriber=d,this._focusMonitor=u,this._dir=_,this._defaultOptions=S,this._position="below",this._positionAtOrigin=!1,this._disabled=!1,this._viewInitialized=!1,this._pointerExitEventsInitialized=!1,this._tooltipComponent=_1e,this._viewportMargin=8,this._cssClassPrefix="mat-mdc",this.touchGestures="auto",this._message="",this._passiveListeners=[],this._destroyed=new hn,this._scrollStrategy=p,this._document=R,S&&(this._showDelay=S.showDelay,this._hideDelay=S.hideDelay,S.position&&(this.position=S.position),S.positionAtOrigin&&(this.positionAtOrigin=S.positionAtOrigin),S.touchGestures&&(this.touchGestures=S.touchGestures)),_.change.pipe(Ql(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)}),this._viewportMargin=8}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe(Ql(this._destroyed)).subscribe(t=>{t?"keyboard"===t&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))})}ngOnDestroy(){const t=this._elementRef.nativeElement;clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([i,r])=>{t.removeEventListener(i,r,xW)}),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._ariaDescriber.removeDescription(t,this.message,"tooltip"),this._focusMonitor.stopMonitoring(t)}show(t=this.showDelay,i){if(this.disabled||!this.message||this._isTooltipVisible())return void this._tooltipInstance?._cancelPendingAnimations();const r=this._createOverlay(i);this._detach(),this._portal=this._portal||new e1(this._tooltipComponent,this._viewContainerRef);const s=this._tooltipInstance=r.attach(this._portal).instance;s._triggerElement=this._elementRef.nativeElement,s._mouseLeaveHideDelay=this._hideDelay,s.afterHidden().pipe(Ql(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),s.show(t)}hide(t=this.hideDelay){const i=this._tooltipInstance;i&&(i.isVisible()?i.hide(t):(i._cancelPendingAnimations(),this._detach()))}toggle(t){this._isTooltipVisible()?this.hide():this.show(void 0,t)}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(t){if(this._overlayRef){const s=this._overlayRef.getConfig().positionStrategy;if((!this.positionAtOrigin||!t)&&s._origin instanceof oo)return this._overlayRef;this._detach()}const i=this._scrollDispatcher.getAncestorScrollContainers(this._elementRef),r=this._overlay.position().flexibleConnectedTo(this.positionAtOrigin&&t||this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(i);return r.positionChanges.pipe(Ql(this._destroyed)).subscribe(s=>{this._updateCurrentPositionClass(s.connectionPair),this._tooltipInstance&&s.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=this._overlay.create({direction:this._dir,positionStrategy:r,panelClass:`${this._cssClassPrefix}-${bW}`,scrollStrategy:this._scrollStrategy()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe(Ql(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe(Ql(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe(Ql(this._destroyed)).subscribe(s=>{this._isTooltipVisible()&&27===s.keyCode&&!bC(s)&&(s.preventDefault(),s.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(t){const i=t.getConfig().positionStrategy,r=this._getOrigin(),s=this._getOverlayPosition();i.withPositions([this._addOffset({...r.main,...s.main}),this._addOffset({...r.fallback,...s.fallback})])}_addOffset(t){const r=!this._dir||"ltr"==this._dir.value;return"top"===t.originY?t.offsetY=-8:"bottom"===t.originY?t.offsetY=8:"start"===t.originX?t.offsetX=r?-8:8:"end"===t.originX&&(t.offsetX=r?8:-8),t}_getOrigin(){const t=!this._dir||"ltr"==this._dir.value,i=this.position;let r;"above"==i||"below"==i?r={originX:"center",originY:"above"==i?"top":"bottom"}:"before"==i||"left"==i&&t||"right"==i&&!t?r={originX:"start",originY:"center"}:("after"==i||"right"==i&&t||"left"==i&&!t)&&(r={originX:"end",originY:"center"});const{x:s,y:a}=this._invertPosition(r.originX,r.originY);return{main:r,fallback:{originX:s,originY:a}}}_getOverlayPosition(){const t=!this._dir||"ltr"==this._dir.value,i=this.position;let r;"above"==i?r={overlayX:"center",overlayY:"bottom"}:"below"==i?r={overlayX:"center",overlayY:"top"}:"before"==i||"left"==i&&t||"right"==i&&!t?r={overlayX:"end",overlayY:"center"}:("after"==i||"right"==i&&t||"left"==i&&!t)&&(r={overlayX:"start",overlayY:"center"});const{x:s,y:a}=this._invertPosition(r.overlayX,r.overlayY);return{main:r,fallback:{overlayX:s,overlayY:a}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),this._ngZone.onMicrotaskEmpty.pipe(ad(1),Ql(this._destroyed)).subscribe(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()}))}_setTooltipClass(t){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=t,this._tooltipInstance._markForCheck())}_invertPosition(t,i){return"above"===this.position||"below"===this.position?"top"===i?i="bottom":"bottom"===i&&(i="top"):"end"===t?t="start":"start"===t&&(t="end"),{x:t,y:i}}_updateCurrentPositionClass(t){const{overlayY:i,originX:r,originY:s}=t;let a;if(a="center"===i?this._dir&&"rtl"===this._dir.value?"end"===r?"left":"right":"start"===r?"left":"right":"bottom"===i&&"top"===s?"above":"below",a!==this._currentPosition){const l=this._overlayRef;if(l){const d=`${this._cssClassPrefix}-${bW}-`;l.removePanelClass(d+this._currentPosition),l.addPanelClass(d+a)}this._currentPosition=a}}_setupPointerEnterEventsIfNeeded(){this._disabled||!this.message||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",t=>{let i;this._setupPointerExitEventsIfNeeded(),void 0!==t.x&&void 0!==t.y&&(i=t),this.show(void 0,i)}]):"off"!==this.touchGestures&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",t=>{const i=t.targetTouches?.[0],r=i?{x:i.clientX,y:i.clientY}:void 0;this._setupPointerExitEventsIfNeeded(),clearTimeout(this._touchstartTimeout),this._touchstartTimeout=setTimeout(()=>this.show(void 0,r),this._defaultOptions.touchLongPressShowDelay??500)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;const t=[];if(this._platformSupportsMouseEvents())t.push(["mouseleave",i=>{const r=i.relatedTarget;(!r||!this._overlayRef?.overlayElement.contains(r))&&this.hide()}],["wheel",i=>this._wheelListener(i)]);else if("off"!==this.touchGestures){this._disableNativeGesturesIfNecessary();const i=()=>{clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions.touchendHideDelay)};t.push(["touchend",i],["touchcancel",i])}this._addListeners(t),this._passiveListeners.push(...t)}_addListeners(t){t.forEach(([i,r])=>{this._elementRef.nativeElement.addEventListener(i,r,xW)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(t){if(this._isTooltipVisible()){const i=this._document.elementFromPoint(t.clientX,t.clientY),r=this._elementRef.nativeElement;i!==r&&!r.contains(i)&&this.hide()}}_disableNativeGesturesIfNecessary(){const t=this.touchGestures;if("off"!==t){const i=this._elementRef.nativeElement,r=i.style;("on"===t||"INPUT"!==i.nodeName&&"TEXTAREA"!==i.nodeName)&&(r.userSelect=r.msUserSelect=r.webkitUserSelect=r.MozUserSelect="none"),("on"===t||!i.draggable)&&(r.webkitUserDrag="none"),r.touchAction="none",r.webkitTapHighlightColor="transparent"}}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(pu),Lt(oo),Lt(F4),Lt(fs),Lt(io),Lt(dd),Lt(w0e),Lt(J_),Lt(vW),Lt(_m),Lt(f1e,8),Lt(ba))};static#t=this.\u0275dir=Ft({type:n,selectors:[["","matTooltip",""]],hostAttrs:[1,"mat-mdc-tooltip-trigger"],hostVars:2,hostBindings:function(i,r){2&i&&Ja("mat-mdc-tooltip-disabled",r.disabled)},inputs:{position:[mi.None,"matTooltipPosition","position"],positionAtOrigin:[mi.None,"matTooltipPositionAtOrigin","positionAtOrigin"],disabled:[mi.None,"matTooltipDisabled","disabled"],showDelay:[mi.None,"matTooltipShowDelay","showDelay"],hideDelay:[mi.None,"matTooltipHideDelay","hideDelay"],touchGestures:[mi.None,"matTooltipTouchGestures","touchGestures"],message:[mi.None,"matTooltip","message"],tooltipClass:[mi.None,"matTooltipClass","tooltipClass"]},exportAs:["matTooltip"],standalone:!0})}return n})(),_1e=(()=>{class n{constructor(t,i,r){this._changeDetectorRef=t,this._elementRef=i,this._isMultiline=!1,this._closeOnInteraction=!1,this._isVisible=!1,this._onHide=new hn,this._showAnimation="mat-mdc-tooltip-show",this._hideAnimation="mat-mdc-tooltip-hide",this._animationsDisabled="NoopAnimations"===r}show(t){null!=this._hideTimeoutId&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleVisibility(!0),this._showTimeoutId=void 0},t)}hide(t){null!=this._showTimeoutId&&clearTimeout(this._showTimeoutId),this._hideTimeoutId=setTimeout(()=>{this._toggleVisibility(!1),this._hideTimeoutId=void 0},t)}afterHidden(){return this._onHide}isVisible(){return this._isVisible}ngOnDestroy(){this._cancelPendingAnimations(),this._onHide.complete(),this._triggerElement=null}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}_handleMouseLeave({relatedTarget:t}){(!t||!this._triggerElement.contains(t))&&(this.isVisible()?this.hide(this._mouseLeaveHideDelay):this._finalizeAnimation(!1))}_onShow(){this._isMultiline=this._isTooltipMultiline(),this._markForCheck()}_isTooltipMultiline(){const t=this._elementRef.nativeElement.getBoundingClientRect();return t.height>24&&t.width>=200}_handleAnimationEnd({animationName:t}){(t===this._showAnimation||t===this._hideAnimation)&&this._finalizeAnimation(t===this._showAnimation)}_cancelPendingAnimations(){null!=this._showTimeoutId&&clearTimeout(this._showTimeoutId),null!=this._hideTimeoutId&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=this._hideTimeoutId=void 0}_finalizeAnimation(t){t?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(t){const i=this._tooltip.nativeElement,r=this._showAnimation,s=this._hideAnimation;if(i.classList.remove(t?s:r),i.classList.add(t?r:s),this._isVisible=t,t&&!this._animationsDisabled&&"function"==typeof getComputedStyle){const a=getComputedStyle(i);("0s"===a.getPropertyValue("animation-duration")||"none"===a.getPropertyValue("animation-name"))&&(this._animationsDisabled=!0)}t&&this._onShow(),this._animationsDisabled&&(i.classList.add("_mat-animation-noopable"),this._finalizeAnimation(t))}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(Sc),Lt(oo),Lt(Od,8))};static#t=this.\u0275cmp=Zr({type:n,selectors:[["mat-tooltip-component"]],viewQuery:function(i,r){if(1&i&&_l(c1e,7),2&i){let s;pa(s=ma())&&(r._tooltip=s.first)}},hostAttrs:["aria-hidden","true"],hostVars:2,hostBindings:function(i,r){1&i&&Ai("mouseleave",function(a){return r._handleMouseLeave(a)}),2&i&&XM("zoom",r.isVisible()?1:null)},standalone:!0,features:[yd],decls:4,vars:4,consts:[["tooltip",""],[1,"mdc-tooltip","mdc-tooltip--shown","mat-mdc-tooltip",3,"animationend","ngClass"],[1,"mdc-tooltip__surface","mdc-tooltip__surface-animation"]],template:function(i,r){if(1&i){const s=ta();zt(0,"div",1,0),Ai("animationend",function(l){return Ci(s),Mi(r._handleAnimationEnd(l))}),zt(2,"div",2),Fi(3),an()()}2&i&&(Ja("mdc-tooltip--multiline",r._isMultiline),Hn("ngClass",r.tooltipClass),Vn(3),tA(r.message))},dependencies:[om],styles:['.mdc-tooltip__surface{word-break:break-all;word-break:var(--mdc-tooltip-word-break, normal);overflow-wrap:anywhere}.mdc-tooltip--showing-transition .mdc-tooltip__surface-animation{transition:opacity 150ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 150ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-tooltip--hide-transition .mdc-tooltip__surface-animation{transition:opacity 75ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-tooltip{position:fixed;display:none;z-index:9}.mdc-tooltip-wrapper--rich{position:relative}.mdc-tooltip--shown,.mdc-tooltip--showing,.mdc-tooltip--hide{display:inline-flex}.mdc-tooltip--shown.mdc-tooltip--rich,.mdc-tooltip--showing.mdc-tooltip--rich,.mdc-tooltip--hide.mdc-tooltip--rich{display:inline-block;left:-320px;position:absolute}.mdc-tooltip__surface{line-height:16px;padding:4px 8px;min-width:40px;max-width:200px;min-height:24px;max-height:40vh;box-sizing:border-box;overflow:hidden;text-align:center}.mdc-tooltip__surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-tooltip__surface::before{border-color:CanvasText}}.mdc-tooltip--rich .mdc-tooltip__surface{align-items:flex-start;display:flex;flex-direction:column;min-height:24px;min-width:40px;max-width:320px;position:relative}.mdc-tooltip--multiline .mdc-tooltip__surface{text-align:left}[dir=rtl] .mdc-tooltip--multiline .mdc-tooltip__surface,.mdc-tooltip--multiline .mdc-tooltip__surface[dir=rtl]{text-align:right}.mdc-tooltip__surface .mdc-tooltip__title{margin:0 8px}.mdc-tooltip__surface .mdc-tooltip__content{max-width:calc(200px - 2*8px);margin:8px;text-align:left}[dir=rtl] .mdc-tooltip__surface .mdc-tooltip__content,.mdc-tooltip__surface .mdc-tooltip__content[dir=rtl]{text-align:right}.mdc-tooltip--rich .mdc-tooltip__surface .mdc-tooltip__content{max-width:calc(320px - 2*8px);align-self:stretch}.mdc-tooltip__surface .mdc-tooltip__content-link{text-decoration:none}.mdc-tooltip--rich-actions,.mdc-tooltip__content,.mdc-tooltip__title{z-index:1}.mdc-tooltip__surface-animation{opacity:0;transform:scale(0.8);will-change:transform,opacity}.mdc-tooltip--shown .mdc-tooltip__surface-animation{transform:scale(1);opacity:1}.mdc-tooltip--hide .mdc-tooltip__surface-animation{transform:scale(1)}.mdc-tooltip__caret-surface-top,.mdc-tooltip__caret-surface-bottom{position:absolute;height:24px;width:24px;transform:rotate(35deg) skewY(20deg) scaleX(0.9396926208)}.mdc-tooltip__caret-surface-top .mdc-elevation-overlay,.mdc-tooltip__caret-surface-bottom .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-tooltip__caret-surface-bottom{box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12);outline:1px solid rgba(0,0,0,0);z-index:-1}@media screen and (forced-colors: active){.mdc-tooltip__caret-surface-bottom{outline-color:CanvasText}}.mat-mdc-tooltip .mdc-tooltip__surface{background-color:var(--mdc-plain-tooltip-container-color)}.mat-mdc-tooltip .mdc-tooltip__surface{border-radius:var(--mdc-plain-tooltip-container-shape)}.mat-mdc-tooltip .mdc-tooltip__caret-surface-top,.mat-mdc-tooltip .mdc-tooltip__caret-surface-bottom{border-radius:var(--mdc-plain-tooltip-container-shape)}.mat-mdc-tooltip .mdc-tooltip__surface{color:var(--mdc-plain-tooltip-supporting-text-color)}.mat-mdc-tooltip .mdc-tooltip__surface{font-family:var(--mdc-plain-tooltip-supporting-text-font);line-height:var(--mdc-plain-tooltip-supporting-text-line-height);font-size:var(--mdc-plain-tooltip-supporting-text-size);font-weight:var(--mdc-plain-tooltip-supporting-text-weight);letter-spacing:var(--mdc-plain-tooltip-supporting-text-tracking)}.mat-mdc-tooltip{position:relative;transform:scale(0)}.mat-mdc-tooltip::before{content:"";top:0;right:0;bottom:0;left:0;z-index:-1;position:absolute}.mat-mdc-tooltip-panel-below .mat-mdc-tooltip::before{top:-8px}.mat-mdc-tooltip-panel-above .mat-mdc-tooltip::before{bottom:-8px}.mat-mdc-tooltip-panel-right .mat-mdc-tooltip::before{left:-8px}.mat-mdc-tooltip-panel-left .mat-mdc-tooltip::before{right:-8px}.mat-mdc-tooltip._mat-animation-noopable{animation:none;transform:scale(1)}.mat-mdc-tooltip-panel.mat-mdc-tooltip-panel-non-interactive{pointer-events:none}@keyframes mat-mdc-tooltip-show{0%{opacity:0;transform:scale(0.8)}100%{opacity:1;transform:scale(1)}}@keyframes mat-mdc-tooltip-hide{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(0.8)}}.mat-mdc-tooltip-show{animation:mat-mdc-tooltip-show 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-mdc-tooltip-hide{animation:mat-mdc-tooltip-hide 75ms cubic-bezier(0.4, 0, 1, 1) forwards}'],encapsulation:2,changeDetection:0})}return n})(),y1e=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({providers:[u1e],imports:[HQ,fS,NE,Wd,Wd,LE]})}return n})();const v1e=n=>({disabled:n}),b1e=n=>({"active-icon":n});let qc=(()=>{class n{icon;active;tooltip;disabled=!1;static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Zr({type:n,selectors:[["app-menu-toggle"]],inputs:{icon:"icon",active:"active",tooltip:"tooltip",disabled:"disabled"},decls:3,vars:10,consts:[["matTooltipPosition","above","matTooltipTouchGestures","off",1,"menu-toggle",3,"ngClass","matTooltip"],[1,"menu-toggle-icon",3,"ngClass"]],template:function(i,r){1&i&&(zt(0,"button",0),Fl(),zt(1,"svg",1),Fr(2,"use"),an()()),2&i&&(Hn("ngClass",Sf(6,v1e,r.disabled))("matTooltip",r.tooltip),Vn(),Hn("ngClass",Sf(8,b1e,r.active)),Vn(),Nw("href","assets/icons/",r.icon,".svg#",r.icon,""))},dependencies:[om,o1],styles:["[_nghost-%COMP%]{display:flex;margin:0 .6rem}[_nghost-%COMP%]   .menu-toggle[_ngcontent-%COMP%]{display:flex;background:unset;border:none;height:2.5rem;width:2.5rem;min-height:2.5rem;min-width:2.5rem;padding:.65rem;cursor:pointer;align-self:center;transition:all .4s}[_nghost-%COMP%]   .menu-toggle-icon[_ngcontent-%COMP%]{width:100%;height:100%}[_nghost-%COMP%]   .menu-toggle-icon.active-icon[_ngcontent-%COMP%]{--phoenix-options-icon-path: #00bcd4}[_nghost-%COMP%]   .menu-toggle[_ngcontent-%COMP%]:hover{background-color:var(--phoenix-options-icon-bg);border-radius:40%;transition:all .4s}[_nghost-%COMP%]   .menu-toggle.disabled[_ngcontent-%COMP%]{cursor:not-allowed;opacity:.4}"]})}return n})();function x1e(n,e){if(1&n){const t=ta();zt(0,"button",2),Ai("click",function(){const r=Ci(t).$implicit;return Mi(Pr().animatePreset(r))}),Fi(1),an()}if(2&n){const t=e.$implicit;Vn(),yl(" ",t," ")}}const wW={"Cavern to ID":{name:"Cavern to ID",positions:[{position:[66388.95051168812,5264.228603228927,-46910.7848593543],duration:1e3},{position:[12834.18729094943,677.7571205763458,135.68755273443463],duration:2e3},{position:[312.02688693297375,25.884223757326,270.10019006776236],duration:3500},{position:[263.3640855132258,19.874838262525053,-318.16541790248885],duration:3e3},{position:[5534.140362338047,234.03507981484574,-2933.619479808285],duration:2e3},{position:[2681.277288705242,646.5795158318147,5628.5248735111745],duration:1e3},{position:[-6062.586283740076,790.5876682946184,1381.1675900848818],duration:1e3},{position:[-1766.7693725879053,1007.1048030984678,-5928.901341784575],duration:1e3},{position:[12814.982506255355,2516.987185037266,-22891.902734328327],duration:1e3}],animateEventAfterInterval:5e3,collisionDuration:6e3}};let BO=(()=>{class n{eventDisplay;animationPresets=wW;animationPresetsKeys=Object.keys(this.animationPresets);isAnimating=!1;constructor(t){this.eventDisplay=t}animatePreset(t){this.setDetectorOpacity(.2),this.eventDisplay.animatePreset(this.animationPresets[t],()=>{this.setDetectorOpacity(1)})}animateCamera(){this.isAnimating||(this.isAnimating=!0,this.eventDisplay.animateThroughEvent([11976,7262,11927],3e3,()=>{this.isAnimating=!1}))}setDetectorOpacity(t){const i=this.eventDisplay.getThreeManager().getSceneManager(),r=i.getObjectByName(el.GEOMETRIES_ID);i.setGeometryOpacity(r,t)}static \u0275fac=function(i){return new(i||n)(Lt(pl))};static \u0275cmp=Zr({type:n,selectors:[["app-animate-camera"]],inputs:{animationPresets:"animationPresets"},decls:6,vars:2,consts:[["animationPresets",""],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["mat-menu-item","",3,"click"],["tooltip","Preset animations","icon","animate-camera",3,"matMenuTriggerFor"]],template:function(i,r){if(1&i){const s=ta();zt(0,"mat-menu",null,0),zs(2,x1e,2,1,"button",1),zt(3,"button",2),Ai("click",function(){return Ci(s),Mi(r.animateCamera())}),Fi(4,"Animate camera"),an()(),Fr(5,"app-menu-toggle",3)}if(2&i){const s=Ga(1);Vn(2),Hn("ngForOf",r.animationPresetsKeys),Vn(3),Hn("matMenuTriggerFor",s)}},dependencies:[am,s1,r1,CC,qc]})}return n})();const w1e=["*"],C1e=n=>({"ui-menu-hidden":n});let PO=(()=>{class n{hideUIMenu=!1;static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Zr({type:n,selectors:[["app-ui-menu-wrapper"]],ngContentSelectors:w1e,decls:6,vars:5,consts:[["id","uiMenu"],["id","hideUIMenu","matTooltipPosition","above",3,"click","matTooltip","ngClass"],["href","assets/icons/expand.svg#expand"],["id","optionsPanel",3,"hidden"]],template:function(i,r){1&i&&(vh(),zt(0,"div",0)(1,"button",1),Ai("click",function(){return r.hideUIMenu=!r.hideUIMenu}),Fl(),zt(2,"svg"),Fr(3,"use",2),an()(),Ih(),zt(4,"div",3),ru(5),an()()),2&i&&(Vn(),Hn("matTooltip",r.hideUIMenu?"Show toolbar":"Hide toolbar")("ngClass",Sf(3,C1e,r.hideUIMenu)),Vn(3),Hn("hidden",r.hideUIMenu))},dependencies:[om,o1],styles:["#uiMenu[_ngcontent-%COMP%]{position:absolute;bottom:1rem;width:100%;box-sizing:border-box;display:flex;flex-direction:column;align-items:center}#optionsPanel[_ngcontent-%COMP%]{display:flex;align-items:center;background:var(--phoenix-background-color-secondary);border:1px solid var(--phoenix-background-color-tertiary);box-shadow:var(--phoenix-box-shadow);border-radius:30px;max-width:95%;padding:.3rem 1rem;overflow-x:scroll;z-index:90}#hideUIMenu[_ngcontent-%COMP%]{background:var(--phoenix-background-color-secondary);height:1.2rem;width:3rem;border:1px solid var(--phoenix-border);border-bottom:none;box-shadow:var(--phoenix-box-shadow);border-top-left-radius:15px;border-top-right-radius:15px;padding:3px}#hideUIMenu[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:100%;width:100%;vertical-align:top;transition:all .3s}#hideUIMenu.ui-menu-hidden[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{transform:scaleY(-1);transition:all .3s}"]})}return n})();let MW=(()=>{class n{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(KA),Lt(oo))};static#t=this.\u0275dir=Ft({type:n})}return n})(),Ax=(()=>{class n extends MW{static#e=this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Ca(n)))(r||n)}})();static#t=this.\u0275dir=Ft({type:n,features:[Lo]})}return n})();const Of=new Bi(""),S1e={provide:Of,useExisting:jt(()=>RO),multi:!0},T1e=new Bi("");let RO=(()=>{class n extends MW{constructor(t,i,r){super(t,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function E1e(){const n=Cy()?Cy().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(KA),Lt(oo),Lt(T1e,8))};static#t=this.\u0275dir=Ft({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){1&i&&Ai("input",function(a){return r._handleInput(a.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(a){return r._compositionEnd(a.target.value)})},features:[qo([S1e]),Lo]})}return n})();const mu=new Bi(""),iv=new Bi("");function OW(n){return null!=n}function LW(n){return cS(n)?lu(n):n}function NW(n){let e={};return n.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function UW(n,e){return e.map(t=>t(n))}function zW(n){return n.map(e=>function I1e(n){return!n.validate}(e)?e:t=>e.validate(t))}function kO(n){return null!=n?function HW(n){if(!n)return null;const e=n.filter(OW);return 0==e.length?null:function(t){return NW(UW(t,e))}}(zW(n)):null}function VW(n){if(!n)return null;const e=n.filter(OW);return 0==e.length?null:function(t){return function CW(...n){const e=t9(n),{args:t,keys:i}=U9(n),r=new Pe(s=>{const{length:a}=t;if(!a)return void s.complete();const l=new Array(a);let d=a,u=a;for(let p=0;p<a;p++){let _=!1;Nh(t[p]).subscribe(Pi(s,S=>{_||(_=!0,u--),l[p]=S},()=>d--,void 0,()=>{(!d||!_)&&(u||s.next(i?z9(i,l):l),s.complete())}))}});return e?r.pipe(sk(e)):r}(UW(t,e).map(LW)).pipe(bi(NW))}}function FO(n){return null!=n?VW(zW(n)):null}function GW(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function OO(n){return n?Array.isArray(n)?n:[n]:[]}function z4(n,e){return Array.isArray(n)?n.includes(e):n===e}function WW(n,e){const t=OO(e);return OO(n).forEach(r=>{z4(t,r)||t.push(r)}),t}function jW(n,e){return OO(e).filter(t=>!z4(n,t))}class $W{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=kO(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=FO(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class Lf extends $W{get formDirective(){return null}get path(){return null}}class rv extends $W{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class XW{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let LO=(()=>{class n extends XW{constructor(t){super(t)}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(rv,2))};static#t=this.\u0275dir=Ft({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){2&i&&Ja("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[Lo]})}return n})();const UE="VALID",V4="INVALID",MC="PENDING",zE="DISABLED";function G4(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}class VO{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===UE}get invalid(){return this.status===V4}get pending(){return this.status==MC}get disabled(){return this.status===zE}get enabled(){return this.status!==zE}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(WW(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(WW(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(jW(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(jW(e,this._rawAsyncValidators))}hasValidator(e){return z4(this._rawValidators,e)}hasAsyncValidator(e){return z4(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=MC,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=zE,this.errors=null,this._forEachChild(i=>{i.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=UE,this._forEachChild(i=>{i.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===UE||this.status===MC)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?zE:UE}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=MC,this._hasOwnPendingAsyncValidator=!0;const t=LW(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){const i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new Ls,this.statusChanges=new Ls}_calculateStatus(){return this._allControlsDisabled()?zE:this.errors?V4:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(MC)?MC:this._anyControlsHaveStatus(V4)?V4:UE}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){G4(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function F1e(n){return Array.isArray(n)?kO(n):n||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function O1e(n){return Array.isArray(n)?FO(n):n||null}(this._rawAsyncValidators)}}const SC=new Bi("CallSetDisabledState",{providedIn:"root",factory:()=>q4}),q4="always";function HE(n,e,t=q4){(function qO(n,e){const t=function qW(n){return n._rawValidators}(n);null!==e.validator?n.setValidators(GW(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const i=function QW(n){return n._rawAsyncValidators}(n);null!==e.asyncValidator?n.setAsyncValidators(GW(i,e.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const r=()=>n.updateValueAndValidity();j4(e._rawValidators,r),j4(e._rawAsyncValidators,r)})(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(n.disabled),function U1e(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&JW(n,e)})}(n,e),function H1e(n,e){const t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function z1e(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&JW(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function N1e(n,e){if(e.valueAccessor.setDisabledState){const t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function j4(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function JW(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function nj(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function ij(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}Promise.resolve();const rj=class extends VO{constructor(e=null,t,i){super(function zO(n){return(G4(n)?n.validators:n)||null}(t),function HO(n,e){return(G4(e)?e.asyncValidators:n)||null}(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),G4(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=ij(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){nj(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){nj(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){ij(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},X1e={provide:rv,useExisting:jt(()=>X4)},aj=Promise.resolve();let X4=(()=>{class n extends rv{constructor(t,i,r,s,a,l){super(),this._changeDetectorRef=a,this.callSetDisabledState=l,this.control=new rj,this._registered=!1,this.name="",this.update=new Ls,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function jO(n,e){if(!e)return null;let t,i,r;return Array.isArray(e),e.forEach(s=>{s.constructor===RO?t=s:function q1e(n){return Object.getPrototypeOf(n.constructor)===Ax}(s)?i=s:r=s}),r||i||t||null}(0,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function WO(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){HE(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){aj.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const i=t.isDisabled.currentValue,r=0!==i&&_o(i);aj.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?function Q4(n,e){return[...e.path,n]}(t,this._parent):[t]}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(Lf,9),Lt(mu,10),Lt(iv,10),Lt(Of,10),Lt(Sc,8),Lt(SC,8))};static#t=this.\u0275dir=Ft({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[mi.None,"disabled","isDisabled"],model:[mi.None,"ngModel","model"],options:[mi.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[qo([X1e]),Lo,kl]})}return n})();const oye={provide:Of,useExisting:jt(()=>ZO),multi:!0};function mj(n,e){return null==n?`${e}`:(e&&"object"==typeof e&&(e="Object"),`${n}: ${e}`.slice(0,50))}let ZO=(()=>{class n extends Ax{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;const r=mj(this._getOptionId(t),t);this.setProperty("value",r)}registerOnChange(t){this.onChange=i=>{this.value=this._getOptionValue(i),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),t))return i;return null}_getOptionValue(t){const i=function aye(n){return n.split(":")[0]}(t);return this._optionMap.has(i)?this._optionMap.get(i):t}static#e=this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Ca(n)))(r||n)}})();static#t=this.\u0275dir=Ft({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,r){1&i&&Ai("change",function(a){return r.onChange(a.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[qo([oye]),Lo]})}return n})(),EC=(()=>{class n{constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(t){null!=this._select&&(this._select._optionMap.set(this.id,t),this._setElementValue(mj(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(oo),Lt(KA),Lt(ZO,9))};static#t=this.\u0275dir=Ft({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}return n})();const lye={provide:Of,useExisting:jt(()=>JO),multi:!0};function Aj(n,e){return null==n?`${e}`:("string"==typeof e&&(e=`'${e}'`),e&&"object"==typeof e&&(e="Object"),`${n}: ${e}`.slice(0,50))}let JO=(()=>{class n extends Ax{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){let i;if(this.value=t,Array.isArray(t)){const r=t.map(s=>this._getOptionId(s));i=(s,a)=>{s._setSelected(r.indexOf(a.toString())>-1)}}else i=(r,s)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(t){this.onChange=i=>{const r=[],s=i.selectedOptions;if(void 0!==s){const a=s;for(let l=0;l<a.length;l++){const u=this._getOptionValue(a[l].value);r.push(u)}}else{const a=i.options;for(let l=0;l<a.length;l++){const d=a[l];if(d.selected){const u=this._getOptionValue(d.value);r.push(u)}}}this.value=r,t(r)}}_registerOption(t){const i=(this._idCounter++).toString();return this._optionMap.set(i,t),i}_getOptionId(t){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,t))return i;return null}_getOptionValue(t){const i=function cye(n){return n.split(":")[0]}(t);return this._optionMap.has(i)?this._optionMap.get(i)._value:t}static#e=this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Ca(n)))(r||n)}})();static#t=this.\u0275dir=Ft({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,r){1&i&&Ai("change",function(a){return r.onChange(a.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[qo([lye]),Lo]})}return n})(),TC=(()=>{class n{constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){null!=this._select&&(this._value=t,this._setElementValue(Aj(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(Aj(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(oo),Lt(KA),Lt(JO,9))};static#t=this.\u0275dir=Ft({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}return n})(),_ye=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({})}return n})(),vye=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:SC,useValue:t.callSetDisabledState??q4}]}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({imports:[_ye]})}return n})();const bye=["input"],xye=["label"],wye=["*"],Cye=new Bi("mat-checkbox-default-options",{providedIn:"root",factory:Mj});function Mj(){return{color:"accent",clickAction:"check-indeterminate"}}var qh=function(n){return n[n.Init=0]="Init",n[n.Checked=1]="Checked",n[n.Unchecked=2]="Unchecked",n[n.Indeterminate=3]="Indeterminate",n}(qh||{});const Mye={provide:Of,useExisting:jt(()=>sv),multi:!0};class Sye{}let Eye=0;const Sj=Mj();let sv=(()=>{class n{focus(){this._inputElement.nativeElement.focus()}_createChangeEvent(t){const i=new Sye;return i.source=this,i.checked=t,i}_getAnimationTargetElement(){return this._inputElement?.nativeElement}get inputId(){return`${this.id||this._uniqueId}-input`}constructor(t,i,r,s,a,l){this._elementRef=t,this._changeDetectorRef=i,this._ngZone=r,this._animationMode=a,this._options=l,this._animationClasses={uncheckedToChecked:"mdc-checkbox--anim-unchecked-checked",uncheckedToIndeterminate:"mdc-checkbox--anim-unchecked-indeterminate",checkedToUnchecked:"mdc-checkbox--anim-checked-unchecked",checkedToIndeterminate:"mdc-checkbox--anim-checked-indeterminate",indeterminateToChecked:"mdc-checkbox--anim-indeterminate-checked",indeterminateToUnchecked:"mdc-checkbox--anim-indeterminate-unchecked"},this.ariaLabel="",this.ariaLabelledby=null,this.labelPosition="after",this.name=null,this.change=new Ls,this.indeterminateChange=new Ls,this._onTouched=()=>{},this._currentAnimationClass="",this._currentCheckState=qh.Init,this._controlValueAccessorChangeFn=()=>{},this._validatorChangeFn=()=>{},this._checked=!1,this._disabled=!1,this._indeterminate=!1,this._options=this._options||Sj,this.color=this._options.color||Sj.color,this.tabIndex=parseInt(s)||0,this.id=this._uniqueId="mat-mdc-checkbox-"+ ++Eye}ngOnChanges(t){t.required&&this._validatorChangeFn()}ngAfterViewInit(){this._syncIndeterminate(this._indeterminate)}get checked(){return this._checked}set checked(t){t!=this.checked&&(this._checked=t,this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled}set disabled(t){t!==this.disabled&&(this._disabled=t,this._changeDetectorRef.markForCheck())}get indeterminate(){return this._indeterminate}set indeterminate(t){const i=t!=this._indeterminate;this._indeterminate=t,i&&(this._transitionCheckState(this._indeterminate?qh.Indeterminate:this.checked?qh.Checked:qh.Unchecked),this.indeterminateChange.emit(this._indeterminate)),this._syncIndeterminate(this._indeterminate)}_isRippleDisabled(){return this.disableRipple||this.disabled}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}writeValue(t){this.checked=!!t}registerOnChange(t){this._controlValueAccessorChangeFn=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t}validate(t){return this.required&&!0!==t.value?{required:!0}:null}registerOnValidatorChange(t){this._validatorChangeFn=t}_transitionCheckState(t){let i=this._currentCheckState,r=this._getAnimationTargetElement();if(i!==t&&r&&(this._currentAnimationClass&&r.classList.remove(this._currentAnimationClass),this._currentAnimationClass=this._getAnimationClassForCheckStateTransition(i,t),this._currentCheckState=t,this._currentAnimationClass.length>0)){r.classList.add(this._currentAnimationClass);const s=this._currentAnimationClass;this._ngZone.runOutsideAngular(()=>{setTimeout(()=>{r.classList.remove(s)},1e3)})}}_emitChangeEvent(){this._controlValueAccessorChangeFn(this.checked),this.change.emit(this._createChangeEvent(this.checked)),this._inputElement&&(this._inputElement.nativeElement.checked=this.checked)}toggle(){this.checked=!this.checked,this._controlValueAccessorChangeFn(this.checked)}_handleInputClick(){const t=this._options?.clickAction;this.disabled||"noop"===t?!this.disabled&&"noop"===t&&(this._inputElement.nativeElement.checked=this.checked,this._inputElement.nativeElement.indeterminate=this.indeterminate):(this.indeterminate&&"check"!==t&&Promise.resolve().then(()=>{this._indeterminate=!1,this.indeterminateChange.emit(this._indeterminate)}),this._checked=!this._checked,this._transitionCheckState(this._checked?qh.Checked:qh.Unchecked),this._emitChangeEvent())}_onInteractionEvent(t){t.stopPropagation()}_onBlur(){Promise.resolve().then(()=>{this._onTouched(),this._changeDetectorRef.markForCheck()})}_getAnimationClassForCheckStateTransition(t,i){if("NoopAnimations"===this._animationMode)return"";switch(t){case qh.Init:if(i===qh.Checked)return this._animationClasses.uncheckedToChecked;if(i==qh.Indeterminate)return this._checked?this._animationClasses.checkedToIndeterminate:this._animationClasses.uncheckedToIndeterminate;break;case qh.Unchecked:return i===qh.Checked?this._animationClasses.uncheckedToChecked:this._animationClasses.uncheckedToIndeterminate;case qh.Checked:return i===qh.Unchecked?this._animationClasses.checkedToUnchecked:this._animationClasses.checkedToIndeterminate;case qh.Indeterminate:return i===qh.Checked?this._animationClasses.indeterminateToChecked:this._animationClasses.indeterminateToUnchecked}return""}_syncIndeterminate(t){const i=this._inputElement;i&&(i.nativeElement.indeterminate=t)}_onInputClick(){this._handleInputClick()}_onTouchTargetClick(){this._handleInputClick(),this.disabled||this._inputElement.nativeElement.focus()}_preventBubblingFromLabel(t){t.target&&this._labelElement.nativeElement.contains(t.target)&&t.stopPropagation()}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(oo),Lt(Sc),Lt(io),xu("tabindex"),Lt(Od,8),Lt(Cye,8))};static#t=this.\u0275cmp=Zr({type:n,selectors:[["mat-checkbox"]],viewQuery:function(i,r){if(1&i&&(_l(bye,5),_l(xye,5),_l(R0,5)),2&i){let s;pa(s=ma())&&(r._inputElement=s.first),pa(s=ma())&&(r._labelElement=s.first),pa(s=ma())&&(r.ripple=s.first)}},hostAttrs:[1,"mat-mdc-checkbox"],hostVars:14,hostBindings:function(i,r){2&i&&(Hw("id",r.id),sl("tabindex",null)("aria-label",null)("aria-labelledby",null),B_(r.color?"mat-"+r.color:"mat-accent"),Ja("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mdc-checkbox--disabled",r.disabled)("mat-mdc-checkbox-disabled",r.disabled)("mat-mdc-checkbox-checked",r.checked))},inputs:{ariaLabel:[mi.None,"aria-label","ariaLabel"],ariaLabelledby:[mi.None,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[mi.None,"aria-describedby","ariaDescribedby"],id:"id",required:[mi.HasDecoratorInputTransform,"required","required",_o],labelPosition:"labelPosition",name:"name",value:"value",disableRipple:[mi.HasDecoratorInputTransform,"disableRipple","disableRipple",_o],tabIndex:[mi.HasDecoratorInputTransform,"tabIndex","tabIndex",t=>null==t?void 0:su(t)],color:"color",checked:[mi.HasDecoratorInputTransform,"checked","checked",_o],disabled:[mi.HasDecoratorInputTransform,"disabled","disabled",_o],indeterminate:[mi.HasDecoratorInputTransform,"indeterminate","indeterminate",_o]},outputs:{change:"change",indeterminateChange:"indeterminateChange"},exportAs:["matCheckbox"],standalone:!0,features:[qo([Mye,{provide:mu,useExisting:n,multi:!0}]),ql,kl,yd],ngContentSelectors:wye,decls:15,vars:19,consts:[["checkbox",""],["input",""],["label",""],["mat-internal-form-field","",3,"click","labelPosition"],[1,"mdc-checkbox"],[1,"mat-mdc-checkbox-touch-target",3,"click"],["type","checkbox",1,"mdc-checkbox__native-control",3,"blur","click","change","checked","indeterminate","disabled","id","required","tabIndex"],[1,"mdc-checkbox__ripple"],[1,"mdc-checkbox__background"],["focusable","false","viewBox","0 0 24 24","aria-hidden","true",1,"mdc-checkbox__checkmark"],["fill","none","d","M1.73,12.91 8.1,19.28 22.79,4.59",1,"mdc-checkbox__checkmark-path"],[1,"mdc-checkbox__mixedmark"],["mat-ripple","",1,"mat-mdc-checkbox-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mdc-label",3,"for"]],template:function(i,r){if(1&i){const s=ta();vh(),zt(0,"div",3),Ai("click",function(l){return Ci(s),Mi(r._preventBubblingFromLabel(l))}),zt(1,"div",4,0)(3,"div",5),Ai("click",function(){return Ci(s),Mi(r._onTouchTargetClick())}),an(),zt(4,"input",6,1),Ai("blur",function(){return Ci(s),Mi(r._onBlur())})("click",function(){return Ci(s),Mi(r._onInputClick())})("change",function(l){return Ci(s),Mi(r._onInteractionEvent(l))}),an(),Fr(6,"div",7),zt(7,"div",8),Fl(),zt(8,"svg",9),Fr(9,"path",10),an(),Ih(),Fr(10,"div",11),an(),Fr(11,"div",12),an(),zt(12,"label",13,2),ru(14),an()()}if(2&i){const s=Ga(2);Hn("labelPosition",r.labelPosition),Vn(4),Ja("mdc-checkbox--selected",r.checked),Hn("checked",r.checked)("indeterminate",r.indeterminate)("disabled",r.disabled)("id",r.inputId)("required",r.required)("tabIndex",r.disabled?-1:r.tabIndex),sl("aria-label",r.ariaLabel||null)("aria-labelledby",r.ariaLabelledby)("aria-describedby",r.ariaDescribedby)("aria-checked",r.indeterminate?"mixed":null)("name",r.name)("value",r.value),Vn(7),Hn("matRippleTrigger",s)("matRippleDisabled",r.disableRipple||r.disabled)("matRippleCentered",!0),Vn(),Hn("for",r.inputId)}},dependencies:[R0,CO],styles:['.mdc-touch-target-wrapper{display:inline}@keyframes mdc-checkbox-unchecked-checked-checkmark-path{0%,50%{stroke-dashoffset:29.7833385}50%{animation-timing-function:cubic-bezier(0, 0, 0.2, 1)}100%{stroke-dashoffset:0}}@keyframes mdc-checkbox-unchecked-indeterminate-mixedmark{0%,68.2%{transform:scaleX(0)}68.2%{animation-timing-function:cubic-bezier(0, 0, 0, 1)}100%{transform:scaleX(1)}}@keyframes mdc-checkbox-checked-unchecked-checkmark-path{from{animation-timing-function:cubic-bezier(0.4, 0, 1, 1);opacity:1;stroke-dashoffset:0}to{opacity:0;stroke-dashoffset:-29.7833385}}@keyframes mdc-checkbox-checked-indeterminate-checkmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(45deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-checked-checkmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(45deg);opacity:0}to{transform:rotate(360deg);opacity:1}}@keyframes mdc-checkbox-checked-indeterminate-mixedmark{from{animation-timing-function:mdc-animation-deceleration-curve-timing-function;transform:rotate(-45deg);opacity:0}to{transform:rotate(0deg);opacity:1}}@keyframes mdc-checkbox-indeterminate-checked-mixedmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(315deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-unchecked-mixedmark{0%{animation-timing-function:linear;transform:scaleX(1);opacity:1}32.8%,100%{transform:scaleX(0);opacity:0}}.mdc-checkbox{display:inline-block;position:relative;flex:0 0 18px;box-sizing:content-box;width:18px;height:18px;line-height:0;white-space:nowrap;cursor:pointer;vertical-align:bottom}.mdc-checkbox[hidden]{display:none}.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%}@media screen and (forced-colors: active){.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring{border-color:CanvasText}}.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring::after,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring::after,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring::after{border-color:CanvasText}}@media all and (-ms-high-contrast: none){.mdc-checkbox .mdc-checkbox__focus-ring{display:none}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-checkbox__mixedmark{margin:0 1px}}.mdc-checkbox--disabled{cursor:default;pointer-events:none}.mdc-checkbox__background{display:inline-flex;position:absolute;align-items:center;justify-content:center;box-sizing:border-box;width:18px;height:18px;border:2px solid currentColor;border-radius:2px;background-color:rgba(0,0,0,0);pointer-events:none;will-change:background-color,border-color;transition:background-color 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),border-color 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__checkmark{position:absolute;top:0;right:0;bottom:0;left:0;width:100%;opacity:0;transition:opacity 180ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox--upgraded .mdc-checkbox__checkmark{opacity:1}.mdc-checkbox__checkmark-path{transition:stroke-dashoffset 180ms 0ms cubic-bezier(0.4, 0, 0.6, 1);stroke:currentColor;stroke-width:3.12px;stroke-dashoffset:29.7833385;stroke-dasharray:29.7833385}.mdc-checkbox__mixedmark{width:100%;height:0;transform:scaleX(0) rotate(0deg);border-width:1px;border-style:solid;opacity:0;transition:opacity 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__background,.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__background,.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__background,.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__background{animation-duration:180ms;animation-timing-function:linear}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-unchecked-checked-checkmark-path 180ms linear 0s;transition:none}.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-unchecked-indeterminate-mixedmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-checked-unchecked-checkmark-path 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__checkmark{animation:mdc-checkbox-checked-indeterminate-checkmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-checked-indeterminate-mixedmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__checkmark{animation:mdc-checkbox-indeterminate-checked-checkmark 500ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-checked-mixedmark 500ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-unchecked-mixedmark 300ms linear 0s;transition:none}.mdc-checkbox__native-control:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background{transition:border-color 90ms 0ms cubic-bezier(0, 0, 0.2, 1),background-color 90ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__checkmark-path{stroke-dashoffset:0}.mdc-checkbox__native-control{position:absolute;margin:0;padding:0;opacity:0;cursor:inherit}.mdc-checkbox__native-control:disabled{cursor:default;pointer-events:none}.mdc-checkbox--touch{margin:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2)}.mdc-checkbox--touch .mdc-checkbox__native-control{top:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);right:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);left:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);width:var(--mdc-checkbox-state-layer-size);height:var(--mdc-checkbox-state-layer-size)}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark{transition:opacity 180ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 180ms 0ms cubic-bezier(0, 0, 0.2, 1);opacity:1}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(-45deg)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__checkmark{transform:rotate(45deg);opacity:0;transition:opacity 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__mixedmark,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(0deg);opacity:1}.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__background,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__checkmark,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__checkmark-path,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__mixedmark{transition:none}.mdc-checkbox{padding:calc((var(--mdc-checkbox-state-layer-size) - 18px) / 2);margin:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2)}.mdc-checkbox .mdc-checkbox__native-control[disabled]:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-disabled-unselected-icon-color);background-color:transparent}.mdc-checkbox .mdc-checkbox__native-control[disabled]:checked~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control[disabled]:indeterminate~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control[data-indeterminate=true][disabled]~.mdc-checkbox__background{border-color:transparent;background-color:var(--mdc-checkbox-disabled-selected-icon-color)}.mdc-checkbox .mdc-checkbox__native-control:enabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:var(--mdc-checkbox-selected-checkmark-color)}.mdc-checkbox .mdc-checkbox__native-control:enabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:var(--mdc-checkbox-selected-checkmark-color)}.mdc-checkbox .mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:var(--mdc-checkbox-disabled-selected-checkmark-color)}.mdc-checkbox .mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:var(--mdc-checkbox-disabled-selected-checkmark-color)}.mdc-checkbox .mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-icon-color);background-color:transparent}.mdc-checkbox .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-icon-color);background-color:var(--mdc-checkbox-selected-icon-color)}@keyframes mdc-checkbox-fade-in-background-8A000000FFF4433600000000FFF44336{0%{border-color:var(--mdc-checkbox-unselected-icon-color);background-color:transparent}50%{border-color:var(--mdc-checkbox-selected-icon-color);background-color:var(--mdc-checkbox-selected-icon-color)}}@keyframes mdc-checkbox-fade-out-background-8A000000FFF4433600000000FFF44336{0%,80%{border-color:var(--mdc-checkbox-selected-icon-color);background-color:var(--mdc-checkbox-selected-icon-color)}100%{border-color:var(--mdc-checkbox-unselected-icon-color);background-color:transparent}}.mdc-checkbox.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-8A000000FFF4433600000000FFF44336}.mdc-checkbox.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-8A000000FFF4433600000000FFF44336}.mdc-checkbox:hover .mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-hover-icon-color);background-color:transparent}.mdc-checkbox:hover .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox:hover .mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mdc-checkbox:hover .mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-hover-icon-color);background-color:var(--mdc-checkbox-selected-hover-icon-color)}@keyframes mdc-checkbox-fade-in-background-FF212121FFF4433600000000FFF44336{0%{border-color:var(--mdc-checkbox-unselected-hover-icon-color);background-color:transparent}50%{border-color:var(--mdc-checkbox-selected-hover-icon-color);background-color:var(--mdc-checkbox-selected-hover-icon-color)}}@keyframes mdc-checkbox-fade-out-background-FF212121FFF4433600000000FFF44336{0%,80%{border-color:var(--mdc-checkbox-selected-hover-icon-color);background-color:var(--mdc-checkbox-selected-hover-icon-color)}100%{border-color:var(--mdc-checkbox-unselected-hover-icon-color);background-color:transparent}}.mdc-checkbox:hover.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox:hover.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-FF212121FFF4433600000000FFF44336}.mdc-checkbox:hover.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox:hover.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-FF212121FFF4433600000000FFF44336}.mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-pressed-icon-color);background-color:transparent}.mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-pressed-icon-color);background-color:var(--mdc-checkbox-selected-pressed-icon-color)}@keyframes mdc-checkbox-fade-in-background-8A000000FFF4433600000000FFF44336{0%{border-color:var(--mdc-checkbox-unselected-pressed-icon-color);background-color:transparent}50%{border-color:var(--mdc-checkbox-selected-pressed-icon-color);background-color:var(--mdc-checkbox-selected-pressed-icon-color)}}@keyframes mdc-checkbox-fade-out-background-8A000000FFF4433600000000FFF44336{0%,80%{border-color:var(--mdc-checkbox-selected-pressed-icon-color);background-color:var(--mdc-checkbox-selected-pressed-icon-color)}100%{border-color:var(--mdc-checkbox-unselected-pressed-icon-color);background-color:transparent}}.mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-8A000000FFF4433600000000FFF44336}.mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-8A000000FFF4433600000000FFF44336}.mdc-checkbox .mdc-checkbox__background{top:calc((var(--mdc-checkbox-state-layer-size) - 18px) / 2);left:calc((var(--mdc-checkbox-state-layer-size) - 18px) / 2)}.mdc-checkbox .mdc-checkbox__native-control{top:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);right:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);left:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);width:var(--mdc-checkbox-state-layer-size);height:var(--mdc-checkbox-state-layer-size)}.mdc-checkbox .mdc-checkbox__native-control:enabled:focus:focus:not(:checked):not(:indeterminate)~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-focus-icon-color)}.mdc-checkbox .mdc-checkbox__native-control:enabled:focus:checked~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control:enabled:focus:indeterminate~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-focus-icon-color);background-color:var(--mdc-checkbox-selected-focus-icon-color)}.mdc-checkbox:hover .mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-hover-state-layer-opacity);background-color:var(--mdc-checkbox-unselected-hover-state-layer-color)}.mdc-checkbox:hover .mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-hover-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-focus-state-layer-opacity);background-color:var(--mdc-checkbox-unselected-focus-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-focus-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-pressed-state-layer-opacity);background-color:var(--mdc-checkbox-unselected-pressed-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-pressed-state-layer-color)}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-hover-state-layer-opacity);background-color:var(--mdc-checkbox-selected-hover-state-layer-color)}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-hover-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-focus-state-layer-opacity);background-color:var(--mdc-checkbox-selected-focus-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-focus-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-pressed-state-layer-opacity);background-color:var(--mdc-checkbox-selected-pressed-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-pressed-state-layer-color)}.mat-mdc-checkbox{display:inline-block;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-checkbox .mdc-checkbox__background{-webkit-print-color-adjust:exact;color-adjust:exact}.mat-mdc-checkbox._mat-animation-noopable *,.mat-mdc-checkbox._mat-animation-noopable *::before{transition:none !important;animation:none !important}.mat-mdc-checkbox label{cursor:pointer}.mat-mdc-checkbox.mat-mdc-checkbox-disabled label{cursor:default;color:var(--mat-checkbox-disabled-label-color)}.mat-mdc-checkbox label:empty{display:none}.cdk-high-contrast-active .mat-mdc-checkbox.mat-mdc-checkbox-disabled{opacity:.5}.cdk-high-contrast-active .mat-mdc-checkbox .mdc-checkbox__checkmark{--mdc-checkbox-selected-checkmark-color: CanvasText;--mdc-checkbox-disabled-selected-checkmark-color: CanvasText}.mat-mdc-checkbox .mdc-checkbox__ripple{opacity:0}.mat-mdc-checkbox-ripple,.mdc-checkbox__ripple{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:50%;pointer-events:none}.mat-mdc-checkbox-ripple:not(:empty),.mdc-checkbox__ripple:not(:empty){transform:translateZ(0)}.mat-mdc-checkbox-ripple .mat-ripple-element{opacity:.1}.mat-mdc-checkbox-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-checkbox-touch-target-display)}.mat-mdc-checkbox-ripple::before{border-radius:50%}.mdc-checkbox__native-control:focus~.mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}return n})(),Iye=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({imports:[sv,Wd,Wd]})}return n})();var Bye=Se(3511);function tL(n,e,t){for(let i in e)if(e.hasOwnProperty(i)){const r=e[i];r?n.setProperty(i,r,t?.has(i)?"important":""):n.removeProperty(i)}return n}function DC(n,e){const t=e?"":"none";tL(n.style,{"touch-action":e?"":"none","-webkit-user-drag":e?"":"none","-webkit-tap-highlight-color":e?"":"transparent","user-select":t,"-ms-user-select":t,"-webkit-user-select":t,"-moz-user-select":t})}function Ej(n,e,t){tL(n.style,{position:e?"":"fixed",top:e?"":"0",opacity:e?"":"0",left:e?"":"-999em"},t)}function K4(n,e){return e&&"none"!=e?n+" "+e:n}function Tj(n){const e=n.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(n)*e}function nL(n,e){return n.getPropertyValue(e).split(",").map(i=>i.trim())}function iL(n){const e=n.getBoundingClientRect();return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height,x:e.x,y:e.y}}function rL(n,e,t){const{top:i,bottom:r,left:s,right:a}=n;return t>=i&&t<=r&&e>=s&&e<=a}function GE(n,e,t){n.top+=e,n.bottom=n.top+n.height,n.left+=t,n.right=n.left+n.width}function Dj(n,e,t,i){const{top:r,right:s,bottom:a,left:l,width:d,height:u}=n,p=d*e,_=u*e;return i>r-_&&i<a+_&&t>l-p&&t<s+p}class Ij{constructor(e){this._document=e,this.positions=new Map}clear(){this.positions.clear()}cache(e){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),e.forEach(t=>{this.positions.set(t,{scrollPosition:{top:t.scrollTop,left:t.scrollLeft},clientRect:iL(t)})})}handleScroll(e){const t=fA(e),i=this.positions.get(t);if(!i)return null;const r=i.scrollPosition;let s,a;if(t===this._document){const u=this.getViewportScrollPosition();s=u.top,a=u.left}else s=t.scrollTop,a=t.scrollLeft;const l=r.top-s,d=r.left-a;return this.positions.forEach((u,p)=>{u.clientRect&&t!==p&&t.contains(p)&&GE(u.clientRect,l,d)}),r.top=s,r.left=a,{top:l,left:d}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}}function Bj(n){const e=n.cloneNode(!0),t=e.querySelectorAll("[id]"),i=n.nodeName.toLowerCase();e.removeAttribute("id");for(let r=0;r<t.length;r++)t[r].removeAttribute("id");return"canvas"===i?kj(n,e):("input"===i||"select"===i||"textarea"===i)&&Rj(n,e),Pj("canvas",n,e,kj),Pj("input, textarea, select",n,e,Rj),e}function Pj(n,e,t,i){const r=e.querySelectorAll(n);if(r.length){const s=t.querySelectorAll(n);for(let a=0;a<r.length;a++)i(r[a],s[a])}}let kye=0;function Rj(n,e){"file"!==e.type&&(e.value=n.value),"radio"===e.type&&e.name&&(e.name=`mat-clone-${e.name}-${kye++}`)}function kj(n,e){const t=e.getContext("2d");if(t)try{t.drawImage(n,0,0)}catch{}}const Fj=B0({passive:!0}),Z4=B0({passive:!1}),sL=new Set(["position"]);class Oye{get disabled(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)}set disabled(e){e!==this._disabled&&(this._disabled=e,this._toggleNativeDragInteractions(),this._handles.forEach(t=>DC(t,e)))}constructor(e,t,i,r,s,a){this._config=t,this._document=i,this._ngZone=r,this._viewportRuler=s,this._dragDropRegistry=a,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._hasStartedDragging=!1,this._moveEvents=new hn,this._pointerMoveSubscription=rt.EMPTY,this._pointerUpSubscription=rt.EMPTY,this._scrollSubscription=rt.EMPTY,this._resizeSubscription=rt.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new hn,this.started=new hn,this.released=new hn,this.ended=new hn,this.entered=new hn,this.exited=new hn,this.dropped=new hn,this.moved=this._moveEvents,this._pointerDown=l=>{if(this.beforeStarted.next(),this._handles.length){const d=this._getTargetHandle(l);d&&!this._disabledHandles.has(d)&&!this.disabled&&this._initializeDragSequence(d,l)}else this.disabled||this._initializeDragSequence(this._rootElement,l)},this._pointerMove=l=>{const d=this._getPointerPositionOnPage(l);if(!this._hasStartedDragging){if(Math.abs(d.x-this._pickupPositionOnPage.x)+Math.abs(d.y-this._pickupPositionOnPage.y)>=this._config.dragStartThreshold){const R=Date.now()>=this._dragStartTime+this._getDragStartDelay(l),H=this._dropContainer;if(!R)return void this._endDragSequence(l);(!H||!H.isDragging()&&!H.isReceiving())&&(l.preventDefault(),this._hasStartedDragging=!0,this._ngZone.run(()=>this._startDragSequence(l)))}return}l.preventDefault();const u=this._getConstrainedPointerPosition(d);if(this._hasMoved=!0,this._lastKnownPointerPosition=d,this._updatePointerDirectionDelta(u),this._dropContainer)this._updateActiveDropContainer(u,d);else{const p=this.constrainPosition?this._initialDomRect:this._pickupPositionOnPage,_=this._activeTransform;_.x=u.x-p.x+this._passiveTransform.x,_.y=u.y-p.y+this._passiveTransform.y,this._applyRootElementTransform(_.x,_.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:u,event:l,distance:this._getDragDistance(u),delta:this._pointerDirectionDelta})})},this._pointerUp=l=>{this._endDragSequence(l)},this._nativeDragStart=l=>{if(this._handles.length){const d=this._getTargetHandle(l);d&&!this._disabledHandles.has(d)&&!this.disabled&&l.preventDefault()}else this.disabled||l.preventDefault()},this.withRootElement(e).withParent(t.parentDragRef||null),this._parentPositions=new Ij(i),a.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(e){this._handles=e.map(i=>fu(i)),this._handles.forEach(i=>DC(i,this.disabled)),this._toggleNativeDragInteractions();const t=new Set;return this._disabledHandles.forEach(i=>{this._handles.indexOf(i)>-1&&t.add(i)}),this._disabledHandles=t,this}withPreviewTemplate(e){return this._previewTemplate=e,this}withPlaceholderTemplate(e){return this._placeholderTemplate=e,this}withRootElement(e){const t=fu(e);return t!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{t.addEventListener("mousedown",this._pointerDown,Z4),t.addEventListener("touchstart",this._pointerDown,Fj),t.addEventListener("dragstart",this._nativeDragStart,Z4)}),this._initialTransform=void 0,this._rootElement=t),typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(e){return this._boundaryElement=e?fu(e):null,this._resizeSubscription.unsubscribe(),e&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(e){return this._parentDragRef=e,this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&this._rootElement?.remove(),this._anchor?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeSubscriptions(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(e){!this._disabledHandles.has(e)&&this._handles.indexOf(e)>-1&&(this._disabledHandles.add(e),DC(e,!0))}enableHandle(e){this._disabledHandles.has(e)&&(this._disabledHandles.delete(e),DC(e,this.disabled))}withDirection(e){return this._direction=e,this}_withDropContainer(e){this._dropContainer=e}getFreeDragPosition(){const e=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:e.x,y:e.y}}setFreeDragPosition(e){return this._activeTransform={x:0,y:0},this._passiveTransform.x=e.x,this._passiveTransform.y=e.y,this._dropContainer||this._applyRootElementTransform(e.x,e.y),this}withPreviewContainer(e){return this._previewContainer=e,this}_sortFromLastPointerPosition(){const e=this._lastKnownPointerPosition;e&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(e),e)}_removeSubscriptions(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe()}_destroyPreview(){this._preview?.remove(),this._previewRef?.destroy(),this._preview=this._previewRef=null}_destroyPlaceholder(){this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(e){if(this._dragDropRegistry.isDragging(this)&&(this._removeSubscriptions(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging))if(this.released.next({source:this,event:e}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(e),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;const t=this._getPointerPositionOnPage(e);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(t),dropPoint:t,event:e})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(e){qE(e)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();const t=this._dropContainer;if(t){const i=this._rootElement,r=i.parentNode,s=this._placeholder=this._createPlaceholderElement(),a=this._anchor=this._anchor||this._document.createComment(""),l=this._getShadowRoot();r.insertBefore(a,i),this._initialTransform=i.style.transform||"",this._preview=this._createPreviewElement(),Ej(i,!1,sL),this._document.body.appendChild(r.replaceChild(s,i)),this._getPreviewInsertionPoint(r,l).appendChild(this._preview),this.started.next({source:this,event:e}),t.start(),this._initialContainer=t,this._initialIndex=t.getItemIndex(this)}else this.started.next({source:this,event:e}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(t?t.getScrollableParents():[])}_initializeDragSequence(e,t){this._parentDragRef&&t.stopPropagation();const i=this.isDragging(),r=qE(t),s=!r&&0!==t.button,a=this._rootElement,l=fA(t),d=!r&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now(),u=r?M4(t):C4(t);if(l&&l.draggable&&"mousedown"===t.type&&t.preventDefault(),i||s||d||u)return;if(this._handles.length){const S=a.style;this._rootElementTapHighlight=S.webkitTapHighlightColor||"",S.webkitTapHighlightColor="transparent"}this._hasStartedDragging=this._hasMoved=!1,this._removeSubscriptions(),this._initialDomRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(S=>this._updateOnScroll(S)),this._boundaryElement&&(this._boundaryRect=iL(this._boundaryElement));const p=this._previewTemplate;this._pickupPositionInElement=p&&p.template&&!p.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialDomRect,e,t);const _=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(t);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:_.x,y:_.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,t)}_cleanupDragArtifacts(e){Ej(this._rootElement,!0,sL),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._initialDomRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{const t=this._dropContainer,i=t.getItemIndex(this),r=this._getPointerPositionOnPage(e),s=this._getDragDistance(r),a=t._isOverContainer(r.x,r.y);this.ended.next({source:this,distance:s,dropPoint:r,event:e}),this.dropped.next({item:this,currentIndex:i,previousIndex:this._initialIndex,container:t,previousContainer:this._initialContainer,isPointerOverContainer:a,distance:s,dropPoint:r,event:e}),t.drop(this,i,this._initialIndex,this._initialContainer,a,s,r,e),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:e,y:t},{x:i,y:r}){let s=this._initialContainer._getSiblingContainerFromPosition(this,e,t);!s&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(e,t)&&(s=this._initialContainer),s&&s!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=s,this._dropContainer.enter(this,e,t,s===this._initialContainer&&s.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:s,currentIndex:s.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(i,r),this._dropContainer._sortItem(this,e,t,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(e,t):this._applyPreviewTransform(e-this._pickupPositionInElement.x,t-this._pickupPositionInElement.y))}_createPreviewElement(){const e=this._previewTemplate,t=this.previewClass,i=e?e.template:null;let r;if(i&&e){const s=e.matchSize?this._initialDomRect:null,a=e.viewContainer.createEmbeddedView(i,e.context);a.detectChanges(),r=Lj(a,this._document),this._previewRef=a,e.matchSize?Nj(r,s):r.style.transform=J4(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else r=Bj(this._rootElement),Nj(r,this._initialDomRect),this._initialTransform&&(r.style.transform=this._initialTransform);return tL(r.style,{"pointer-events":"none",margin:"0",position:"fixed",top:"0",left:"0","z-index":`${this._config.zIndex||1e3}`},sL),DC(r,!1),r.classList.add("cdk-drag-preview"),r.setAttribute("dir",this._direction),t&&(Array.isArray(t)?t.forEach(s=>r.classList.add(s)):r.classList.add(t)),r}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();const e=this._placeholder.getBoundingClientRect();this._preview.classList.add("cdk-drag-animating"),this._applyPreviewTransform(e.left,e.top);const t=function Rye(n){const e=getComputedStyle(n),t=nL(e,"transition-property"),i=t.find(l=>"transform"===l||"all"===l);if(!i)return 0;const r=t.indexOf(i),s=nL(e,"transition-duration"),a=nL(e,"transition-delay");return Tj(s[r])+Tj(a[r])}(this._preview);return 0===t?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(i=>{const r=a=>{(!a||fA(a)===this._preview&&"transform"===a.propertyName)&&(this._preview?.removeEventListener("transitionend",r),i(),clearTimeout(s))},s=setTimeout(r,1.5*t);this._preview.addEventListener("transitionend",r)}))}_createPlaceholderElement(){const e=this._placeholderTemplate,t=e?e.template:null;let i;return t?(this._placeholderRef=e.viewContainer.createEmbeddedView(t,e.context),this._placeholderRef.detectChanges(),i=Lj(this._placeholderRef,this._document)):i=Bj(this._rootElement),i.style.pointerEvents="none",i.classList.add("cdk-drag-placeholder"),i}_getPointerPositionInElement(e,t,i){const r=t===this._rootElement?null:t,s=r?r.getBoundingClientRect():e,a=qE(i)?i.targetTouches[0]:i,l=this._getViewportScrollPosition();return{x:s.left-e.left+(a.pageX-s.left-l.left),y:s.top-e.top+(a.pageY-s.top-l.top)}}_getPointerPositionOnPage(e){const t=this._getViewportScrollPosition(),i=qE(e)?e.touches[0]||e.changedTouches[0]||{pageX:0,pageY:0}:e,r=i.pageX-t.left,s=i.pageY-t.top;if(this._ownerSVGElement){const a=this._ownerSVGElement.getScreenCTM();if(a){const l=this._ownerSVGElement.createSVGPoint();return l.x=r,l.y=s,l.matrixTransform(a.inverse())}}return{x:r,y:s}}_getConstrainedPointerPosition(e){const t=this._dropContainer?this._dropContainer.lockAxis:null;let{x:i,y:r}=this.constrainPosition?this.constrainPosition(e,this,this._initialDomRect,this._pickupPositionInElement):e;if("x"===this.lockAxis||"x"===t?r=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):("y"===this.lockAxis||"y"===t)&&(i=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){const{x:s,y:a}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,l=this._boundaryRect,{width:d,height:u}=this._getPreviewRect(),p=l.top+a,_=l.bottom-(u-a);i=Oj(i,l.left+s,l.right-(d-s)),r=Oj(r,p,_)}return{x:i,y:r}}_updatePointerDirectionDelta(e){const{x:t,y:i}=e,r=this._pointerDirectionDelta,s=this._pointerPositionAtLastDirectionChange,a=Math.abs(t-s.x),l=Math.abs(i-s.y);return a>this._config.pointerDirectionChangeThreshold&&(r.x=t>s.x?1:-1,s.x=t),l>this._config.pointerDirectionChangeThreshold&&(r.y=i>s.y?1:-1,s.y=i),r}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;const e=this._handles.length>0||!this.isDragging();e!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=e,DC(this._rootElement,e))}_removeRootElementListeners(e){e.removeEventListener("mousedown",this._pointerDown,Z4),e.removeEventListener("touchstart",this._pointerDown,Fj),e.removeEventListener("dragstart",this._nativeDragStart,Z4)}_applyRootElementTransform(e,t){const i=J4(e,t),r=this._rootElement.style;null==this._initialTransform&&(this._initialTransform=r.transform&&"none"!=r.transform?r.transform:""),r.transform=K4(i,this._initialTransform)}_applyPreviewTransform(e,t){const i=this._previewTemplate?.template?void 0:this._initialTransform,r=J4(e,t);this._preview.style.transform=K4(r,i)}_getDragDistance(e){const t=this._pickupPositionOnPage;return t?{x:e.x-t.x,y:e.y-t.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:e,y:t}=this._passiveTransform;if(0===e&&0===t||this.isDragging()||!this._boundaryElement)return;const i=this._rootElement.getBoundingClientRect(),r=this._boundaryElement.getBoundingClientRect();if(0===r.width&&0===r.height||0===i.width&&0===i.height)return;const s=r.left-i.left,a=i.right-r.right,l=r.top-i.top,d=i.bottom-r.bottom;r.width>i.width?(s>0&&(e+=s),a>0&&(e-=a)):e=0,r.height>i.height?(l>0&&(t+=l),d>0&&(t-=d)):t=0,(e!==this._passiveTransform.x||t!==this._passiveTransform.y)&&this.setFreeDragPosition({y:t,x:e})}_getDragStartDelay(e){const t=this.dragStartDelay;return"number"==typeof t?t:qE(e)?t.touch:t?t.mouse:0}_updateOnScroll(e){const t=this._parentPositions.handleScroll(e);if(t){const i=fA(e);this._boundaryRect&&i!==this._boundaryElement&&i.contains(this._boundaryElement)&&GE(this._boundaryRect,t.top,t.left),this._pickupPositionOnPage.x+=t.left,this._pickupPositionOnPage.y+=t.top,this._dropContainer||(this._activeTransform.x-=t.left,this._activeTransform.y-=t.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return void 0===this._cachedShadowRoot&&(this._cachedShadowRoot=oO(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(e,t){const i=this._previewContainer||"global";if("parent"===i)return e;if("global"===i){const r=this._document;return t||r.fullscreenElement||r.webkitFullscreenElement||r.mozFullScreenElement||r.msFullscreenElement||r.body}return fu(i)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialDomRect),this._previewRect}_getTargetHandle(e){return this._handles.find(t=>e.target&&(e.target===t||t.contains(e.target)))}}function J4(n,e){return`translate3d(${Math.round(n)}px, ${Math.round(e)}px, 0)`}function Oj(n,e,t){return Math.max(e,Math.min(t,n))}function qE(n){return"t"===n.type[0]}function Lj(n,e){const t=n.rootNodes;if(1===t.length&&t[0].nodeType===e.ELEMENT_NODE)return t[0];const i=e.createElement("div");return t.forEach(r=>i.appendChild(r)),i}function Nj(n,e){n.style.width=`${e.width}px`,n.style.height=`${e.height}px`,n.style.transform=J4(e.left,e.top)}function QE(n,e){return Math.max(0,Math.min(e,n))}class Nye{constructor(e,t){this._element=e,this._dragDropRegistry=t,this._itemPositions=[],this.orientation="vertical",this._previousSwap={drag:null,delta:0,overlaps:!1}}start(e){this.withItems(e)}sort(e,t,i,r){const s=this._itemPositions,a=this._getItemIndexFromPointerPosition(e,t,i,r);if(-1===a&&s.length>0)return null;const l="horizontal"===this.orientation,d=s.findIndex(se=>se.drag===e),u=s[a],_=u.clientRect,S=d>a?1:-1,R=this._getItemOffsetPx(s[d].clientRect,_,S),H=this._getSiblingOffsetPx(d,s,S),re=s.slice();return function Lye(n,e,t){const i=QE(e,n.length-1),r=QE(t,n.length-1);if(i===r)return;const s=n[i],a=r<i?-1:1;for(let l=i;l!==r;l+=a)n[l]=n[l+a];n[r]=s}(s,d,a),s.forEach((se,ce)=>{if(re[ce]===se)return;const Te=se.drag===e,Ce=Te?R:H,qe=Te?e.getPlaceholderElement():se.drag.getRootElement();se.offset+=Ce,l?(qe.style.transform=K4(`translate3d(${Math.round(se.offset)}px, 0, 0)`,se.initialTransform),GE(se.clientRect,0,Ce)):(qe.style.transform=K4(`translate3d(0, ${Math.round(se.offset)}px, 0)`,se.initialTransform),GE(se.clientRect,Ce,0))}),this._previousSwap.overlaps=rL(_,t,i),this._previousSwap.drag=u.drag,this._previousSwap.delta=l?r.x:r.y,{previousIndex:d,currentIndex:a}}enter(e,t,i,r){const s=null==r||r<0?this._getItemIndexFromPointerPosition(e,t,i):r,a=this._activeDraggables,l=a.indexOf(e),d=e.getPlaceholderElement();let u=a[s];if(u===e&&(u=a[s+1]),!u&&(null==s||-1===s||s<a.length-1)&&this._shouldEnterAsFirstChild(t,i)&&(u=a[0]),l>-1&&a.splice(l,1),u&&!this._dragDropRegistry.isDragging(u)){const p=u.getRootElement();p.parentElement.insertBefore(d,p),a.splice(s,0,e)}else fu(this._element).appendChild(d),a.push(e);d.style.transform="",this._cacheItemPositions()}withItems(e){this._activeDraggables=e.slice(),this._cacheItemPositions()}withSortPredicate(e){this._sortPredicate=e}reset(){this._activeDraggables.forEach(e=>{const t=e.getRootElement();if(t){const i=this._itemPositions.find(r=>r.drag===e)?.initialTransform;t.style.transform=i||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(e){return("horizontal"===this.orientation&&"rtl"===this.direction?this._itemPositions.slice().reverse():this._itemPositions).findIndex(i=>i.drag===e)}updateOnScroll(e,t){this._itemPositions.forEach(({clientRect:i})=>{GE(i,e,t)}),this._itemPositions.forEach(({drag:i})=>{this._dragDropRegistry.isDragging(i)&&i._sortFromLastPointerPosition()})}_cacheItemPositions(){const e="horizontal"===this.orientation;this._itemPositions=this._activeDraggables.map(t=>{const i=t.getVisibleElement();return{drag:t,offset:0,initialTransform:i.style.transform||"",clientRect:iL(i)}}).sort((t,i)=>e?t.clientRect.left-i.clientRect.left:t.clientRect.top-i.clientRect.top)}_getItemOffsetPx(e,t,i){const r="horizontal"===this.orientation;let s=r?t.left-e.left:t.top-e.top;return-1===i&&(s+=r?t.width-e.width:t.height-e.height),s}_getSiblingOffsetPx(e,t,i){const r="horizontal"===this.orientation,s=t[e].clientRect,a=t[e+-1*i];let l=s[r?"width":"height"]*i;if(a){const d=r?"left":"top",u=r?"right":"bottom";-1===i?l-=a.clientRect[d]-s[u]:l+=s[d]-a.clientRect[u]}return l}_shouldEnterAsFirstChild(e,t){if(!this._activeDraggables.length)return!1;const i=this._itemPositions,r="horizontal"===this.orientation;if(i[0].drag!==this._activeDraggables[0]){const a=i[i.length-1].clientRect;return r?e>=a.right:t>=a.bottom}{const a=i[0].clientRect;return r?e<=a.left:t<=a.top}}_getItemIndexFromPointerPosition(e,t,i,r){const s="horizontal"===this.orientation,a=this._itemPositions.findIndex(({drag:l,clientRect:d})=>l!==e&&((!r||l!==this._previousSwap.drag||!this._previousSwap.overlaps||(s?r.x:r.y)!==this._previousSwap.delta)&&(s?t>=Math.floor(d.left)&&t<Math.floor(d.right):i>=Math.floor(d.top)&&i<Math.floor(d.bottom))));return-1!==a&&this._sortPredicate(a,e)?a:-1}}var pA=function(n){return n[n.NONE=0]="NONE",n[n.UP=1]="UP",n[n.DOWN=2]="DOWN",n}(pA||{}),Nf=function(n){return n[n.NONE=0]="NONE",n[n.LEFT=1]="LEFT",n[n.RIGHT=2]="RIGHT",n}(Nf||{});class Uye{constructor(e,t,i,r,s){this._dragDropRegistry=t,this._ngZone=r,this._viewportRuler=s,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.autoScrollStep=2,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.beforeStarted=new hn,this.entered=new hn,this.exited=new hn,this.dropped=new hn,this.sorted=new hn,this.receivingStarted=new hn,this.receivingStopped=new hn,this._isDragging=!1,this._draggables=[],this._siblings=[],this._activeSiblings=new Set,this._viewportScrollSubscription=rt.EMPTY,this._verticalScrollDirection=pA.NONE,this._horizontalScrollDirection=Nf.NONE,this._stopScrollTimers=new hn,this._cachedShadowRoot=null,this._startScrollInterval=()=>{this._stopScrolling(),function Pye(n=0,e=TE){return n<0&&(n=0),I4(n,n,e)}(0,oW).pipe(Ql(this._stopScrollTimers)).subscribe(()=>{const a=this._scrollNode,l=this.autoScrollStep;this._verticalScrollDirection===pA.UP?a.scrollBy(0,-l):this._verticalScrollDirection===pA.DOWN&&a.scrollBy(0,l),this._horizontalScrollDirection===Nf.LEFT?a.scrollBy(-l,0):this._horizontalScrollDirection===Nf.RIGHT&&a.scrollBy(l,0)})},this.element=fu(e),this._document=i,this.withScrollableParents([this.element]),t.registerDropContainer(this),this._parentPositions=new Ij(i),this._sortStrategy=new Nye(this.element,t),this._sortStrategy.withSortPredicate((a,l)=>this.sortPredicate(a,l,this))}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(e,t,i,r){this._draggingStarted(),null==r&&this.sortingDisabled&&(r=this._draggables.indexOf(e)),this._sortStrategy.enter(e,t,i,r),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:e,container:this,currentIndex:this.getItemIndex(e)})}exit(e){this._reset(),this.exited.next({item:e,container:this})}drop(e,t,i,r,s,a,l,d={}){this._reset(),this.dropped.next({item:e,currentIndex:t,previousIndex:i,container:this,previousContainer:r,isPointerOverContainer:s,distance:a,dropPoint:l,event:d})}withItems(e){const t=this._draggables;return this._draggables=e,e.forEach(i=>i._withDropContainer(this)),this.isDragging()&&(t.filter(r=>r.isDragging()).every(r=>-1===e.indexOf(r))?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(e){return this._sortStrategy.direction=e,this}connectedTo(e){return this._siblings=e.slice(),this}withOrientation(e){return this._sortStrategy.orientation=e,this}withScrollableParents(e){const t=fu(this.element);return this._scrollableElements=-1===e.indexOf(t)?[t,...e]:e.slice(),this}getScrollableParents(){return this._scrollableElements}getItemIndex(e){return this._isDragging?this._sortStrategy.getItemIndex(e):this._draggables.indexOf(e)}isReceiving(){return this._activeSiblings.size>0}_sortItem(e,t,i,r){if(this.sortingDisabled||!this._domRect||!Dj(this._domRect,.05,t,i))return;const s=this._sortStrategy.sort(e,t,i,r);s&&this.sorted.next({previousIndex:s.previousIndex,currentIndex:s.currentIndex,container:this,item:e})}_startScrollingIfNecessary(e,t){if(this.autoScrollDisabled)return;let i,r=pA.NONE,s=Nf.NONE;if(this._parentPositions.positions.forEach((a,l)=>{l===this._document||!a.clientRect||i||Dj(a.clientRect,.05,e,t)&&([r,s]=function zye(n,e,t,i,r){const s=Hj(e,r),a=Vj(e,i);let l=pA.NONE,d=Nf.NONE;if(s){const u=n.scrollTop;s===pA.UP?u>0&&(l=pA.UP):n.scrollHeight-u>n.clientHeight&&(l=pA.DOWN)}if(a){const u=n.scrollLeft;"rtl"===t?a===Nf.RIGHT?u<0&&(d=Nf.RIGHT):n.scrollWidth+u>n.clientWidth&&(d=Nf.LEFT):a===Nf.LEFT?u>0&&(d=Nf.LEFT):n.scrollWidth-u>n.clientWidth&&(d=Nf.RIGHT)}return[l,d]}(l,a.clientRect,this._sortStrategy.direction,e,t),(r||s)&&(i=l))}),!r&&!s){const{width:a,height:l}=this._viewportRuler.getViewportSize(),d={width:a,height:l,top:0,right:a,bottom:l,left:0};r=Hj(d,t),s=Vj(d,e),i=window}i&&(r!==this._verticalScrollDirection||s!==this._horizontalScrollDirection||i!==this._scrollNode)&&(this._verticalScrollDirection=r,this._horizontalScrollDirection=s,this._scrollNode=i,(r||s)&&i?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){const e=fu(this.element).style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=e.msScrollSnapType||e.scrollSnapType||"",e.scrollSnapType=e.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){const e=fu(this.element);this._parentPositions.cache(this._scrollableElements),this._domRect=this._parentPositions.positions.get(e).clientRect}_reset(){this._isDragging=!1;const e=fu(this.element).style;e.scrollSnapType=e.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(t=>t._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_isOverContainer(e,t){return null!=this._domRect&&rL(this._domRect,e,t)}_getSiblingContainerFromPosition(e,t,i){return this._siblings.find(r=>r._canReceive(e,t,i))}_canReceive(e,t,i){if(!this._domRect||!rL(this._domRect,t,i)||!this.enterPredicate(e,this))return!1;const r=this._getShadowRoot().elementFromPoint(t,i);if(!r)return!1;const s=fu(this.element);return r===s||s.contains(r)}_startReceiving(e,t){const i=this._activeSiblings;!i.has(e)&&t.every(r=>this.enterPredicate(r,this)||this._draggables.indexOf(r)>-1)&&(i.add(e),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:e,receiver:this,items:t}))}_stopReceiving(e){this._activeSiblings.delete(e),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:e,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(e=>{if(this.isDragging()){const t=this._parentPositions.handleScroll(e);t&&this._sortStrategy.updateOnScroll(t.top,t.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){const e=oO(fu(this.element));this._cachedShadowRoot=e||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){const e=this._sortStrategy.getActiveItemsSnapshot().filter(t=>t.isDragging());this._siblings.forEach(t=>t._startReceiving(this,e))}}function Hj(n,e){const{top:t,bottom:i,height:r}=n,s=.05*r;return e>=t-s&&e<=t+s?pA.UP:e>=i-s&&e<=i+s?pA.DOWN:pA.NONE}function Vj(n,e){const{left:t,right:i,width:r}=n,s=.05*r;return e>=t-s&&e<=t+s?Nf.LEFT:e>=i-s&&e<=i+s?Nf.RIGHT:Nf.NONE}const eB=B0({passive:!1,capture:!0});let Hye=(()=>{class n{constructor(t,i){this._ngZone=t,this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=[],this._globalListeners=new Map,this._draggingPredicate=r=>r.isDragging(),this.pointerMove=new hn,this.pointerUp=new hn,this.scroll=new hn,this._preventDefaultWhileDragging=r=>{this._activeDragInstances.length>0&&r.preventDefault()},this._persistentTouchmoveListener=r=>{this._activeDragInstances.length>0&&(this._activeDragInstances.some(this._draggingPredicate)&&r.preventDefault(),this.pointerMove.next(r))},this._document=i}registerDropContainer(t){this._dropInstances.has(t)||this._dropInstances.add(t)}registerDragItem(t){this._dragInstances.add(t),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._persistentTouchmoveListener,eB)})}removeDropContainer(t){this._dropInstances.delete(t)}removeDragItem(t){this._dragInstances.delete(t),this.stopDragging(t),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._persistentTouchmoveListener,eB)}startDragging(t,i){if(!(this._activeDragInstances.indexOf(t)>-1)&&(this._activeDragInstances.push(t),1===this._activeDragInstances.length)){const r=i.type.startsWith("touch");this._globalListeners.set(r?"touchend":"mouseup",{handler:s=>this.pointerUp.next(s),options:!0}).set("scroll",{handler:s=>this.scroll.next(s),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:eB}),r||this._globalListeners.set("mousemove",{handler:s=>this.pointerMove.next(s),options:eB}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((s,a)=>{this._document.addEventListener(a,s.handler,s.options)})})}}stopDragging(t){const i=this._activeDragInstances.indexOf(t);i>-1&&(this._activeDragInstances.splice(i,1),0===this._activeDragInstances.length&&this._clearGlobalListeners())}isDragging(t){return this._activeDragInstances.indexOf(t)>-1}scrolled(t){const i=[this.scroll];return t&&t!==this._document&&i.push(new Pe(r=>this._ngZone.runOutsideAngular(()=>{const a=l=>{this._activeDragInstances.length&&r.next(l)};return t.addEventListener("scroll",a,!0),()=>{t.removeEventListener("scroll",a,!0)}}))),gm(...i)}ngOnDestroy(){this._dragInstances.forEach(t=>this.removeDragItem(t)),this._dropInstances.forEach(t=>this.removeDropContainer(t)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((t,i)=>{this._document.removeEventListener(i,t.handler,t.options)}),this._globalListeners.clear()}static#e=this.\u0275fac=function(i){return new(i||n)(xi(io),xi(ba))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Vye={dragStartThreshold:5,pointerDirectionChangeThreshold:5};let oL=(()=>{class n{constructor(t,i,r,s){this._document=t,this._ngZone=i,this._viewportRuler=r,this._dragDropRegistry=s}createDrag(t,i=Vye){return new Oye(t,i,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(t){return new Uye(t,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}static#e=this.\u0275fac=function(i){return new(i||n)(xi(ba),xi(io),xi(OE),xi(Hye))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const WE=new Bi("CDK_DRAG_PARENT"),Gj=new Bi("CdkDragHandle");let qj=(()=>{class n{get disabled(){return this._disabled}set disabled(t){this._disabled=t,this._stateChanges.next(this)}constructor(t,i){this.element=t,this._parentDrag=i,this._stateChanges=new hn,this._disabled=!1,i?._addHandle(this)}ngOnDestroy(){this._parentDrag?._removeHandle(this),this._stateChanges.complete()}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(oo),Lt(WE,12))};static#t=this.\u0275dir=Ft({type:n,selectors:[["","cdkDragHandle",""]],hostAttrs:[1,"cdk-drag-handle"],inputs:{disabled:[mi.HasDecoratorInputTransform,"cdkDragHandleDisabled","disabled",_o]},standalone:!0,features:[qo([{provide:Gj,useExisting:n}]),ql]})}return n})();const Qj=new Bi("CDK_DRAG_CONFIG"),Wj=new Bi("CdkDropList");let aL=(()=>{class n{static#e=this._dragInstances=[];get disabled(){return this._disabled||this.dropContainer&&this.dropContainer.disabled}set disabled(t){this._disabled=t,this._dragRef.disabled=this._disabled}constructor(t,i,r,s,a,l,d,u,p,_,S){this.element=t,this.dropContainer=i,this._ngZone=s,this._viewContainerRef=a,this._dir=d,this._changeDetectorRef=p,this._selfHandle=_,this._parentDrag=S,this._destroyed=new hn,this._handles=new dn([]),this.started=new Ls,this.released=new Ls,this.ended=new Ls,this.entered=new Ls,this.exited=new Ls,this.dropped=new Ls,this.moved=new Pe(R=>{const H=this._dragRef.moved.pipe(bi(re=>({source:this,pointerPosition:re.pointerPosition,event:re.event,delta:re.delta,distance:re.distance}))).subscribe(R);return()=>{H.unsubscribe()}}),this._dragRef=u.createDrag(t,{dragStartThreshold:l&&null!=l.dragStartThreshold?l.dragStartThreshold:5,pointerDirectionChangeThreshold:l&&null!=l.pointerDirectionChangeThreshold?l.pointerDirectionChangeThreshold:5,zIndex:l?.zIndex}),this._dragRef.data=this,n._dragInstances.push(this),l&&this._assignDefaults(l),i&&(this._dragRef._withDropContainer(i._dropListRef),i.addItem(this)),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(t){this._dragRef.setFreeDragPosition(t)}ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(ad(1),Ql(this._destroyed)).subscribe(()=>{this._updateRootElement(),this._setupHandlesListener(),this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)})})}ngOnChanges(t){const i=t.rootElementSelector,r=t.freeDragPosition;i&&!i.firstChange&&this._updateRootElement(),r&&!r.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this);const t=n._dragInstances.indexOf(this);t>-1&&n._dragInstances.splice(t,1),this._ngZone.runOutsideAngular(()=>{this._handles.complete(),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_addHandle(t){const i=this._handles.getValue();i.push(t),this._handles.next(i)}_removeHandle(t){const i=this._handles.getValue(),r=i.indexOf(t);r>-1&&(i.splice(r,1),this._handles.next(i))}_setPreviewTemplate(t){this._previewTemplate=t}_resetPreviewTemplate(t){t===this._previewTemplate&&(this._previewTemplate=null)}_setPlaceholderTemplate(t){this._placeholderTemplate=t}_resetPlaceholderTemplate(t){t===this._placeholderTemplate&&(this._placeholderTemplate=null)}_updateRootElement(){const t=this.element.nativeElement;let i=t;this.rootElementSelector&&(i=void 0!==t.closest?t.closest(this.rootElementSelector):t.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(i||t)}_getBoundaryElement(){const t=this.boundaryElement;return t?"string"==typeof t?this.element.nativeElement.closest(t):fu(t):null}_syncInputs(t){t.beforeStarted.subscribe(()=>{if(!t.isDragging()){const i=this._dir,r=this.dragStartDelay,s=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,a=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;t.disabled=this.disabled,t.lockAxis=this.lockAxis,t.dragStartDelay="object"==typeof r&&r?r:ux(r),t.constrainPosition=this.constrainPosition,t.previewClass=this.previewClass,t.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(s).withPreviewTemplate(a).withPreviewContainer(this.previewContainer||"global"),i&&t.withDirection(i.value)}}),t.beforeStarted.pipe(ad(1)).subscribe(()=>{if(this._parentDrag)return void t.withParent(this._parentDrag._dragRef);let i=this.element.nativeElement.parentElement;for(;i;){if(i.classList.contains("cdk-drag")){t.withParent(n._dragInstances.find(r=>r.element.nativeElement===i)?._dragRef||null);break}i=i.parentElement}})}_handleEvents(t){t.started.subscribe(i=>{this.started.emit({source:this,event:i.event}),this._changeDetectorRef.markForCheck()}),t.released.subscribe(i=>{this.released.emit({source:this,event:i.event})}),t.ended.subscribe(i=>{this.ended.emit({source:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event}),this._changeDetectorRef.markForCheck()}),t.entered.subscribe(i=>{this.entered.emit({container:i.container.data,item:this,currentIndex:i.currentIndex})}),t.exited.subscribe(i=>{this.exited.emit({container:i.container.data,item:this})}),t.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,isPointerOverContainer:i.isPointerOverContainer,item:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event})})}_assignDefaults(t){const{lockAxis:i,dragStartDelay:r,constrainPosition:s,previewClass:a,boundaryElement:l,draggingDisabled:d,rootElementSelector:u,previewContainer:p}=t;this.disabled=d??!1,this.dragStartDelay=r||0,i&&(this.lockAxis=i),s&&(this.constrainPosition=s),a&&(this.previewClass=a),l&&(this.boundaryElement=l),u&&(this.rootElementSelector=u),p&&(this.previewContainer=p)}_setupHandlesListener(){this._handles.pipe(cu(t=>{const i=t.map(r=>r.element);this._selfHandle&&this.rootElementSelector&&i.push(this.element),this._dragRef.withHandles(i)}),Df(t=>gm(...t.map(i=>i._stateChanges.pipe(sA(i))))),Ql(this._destroyed)).subscribe(t=>{const i=this._dragRef,r=t.element.nativeElement;t.disabled?i.disableHandle(r):i.enableHandle(r)})}static#t=this.\u0275fac=function(i){return new(i||n)(Lt(oo),Lt(Wj,12),Lt(ba),Lt(io),Lt(fs),Lt(Qj,8),Lt(_m,8),Lt(oL),Lt(Sc),Lt(Gj,10),Lt(WE,12))};static#n=this.\u0275dir=Ft({type:n,selectors:[["","cdkDrag",""]],hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(i,r){2&i&&Ja("cdk-drag-disabled",r.disabled)("cdk-drag-dragging",r._dragRef.isDragging())},inputs:{data:[mi.None,"cdkDragData","data"],lockAxis:[mi.None,"cdkDragLockAxis","lockAxis"],rootElementSelector:[mi.None,"cdkDragRootElement","rootElementSelector"],boundaryElement:[mi.None,"cdkDragBoundary","boundaryElement"],dragStartDelay:[mi.None,"cdkDragStartDelay","dragStartDelay"],freeDragPosition:[mi.None,"cdkDragFreeDragPosition","freeDragPosition"],disabled:[mi.HasDecoratorInputTransform,"cdkDragDisabled","disabled",_o],constrainPosition:[mi.None,"cdkDragConstrainPosition","constrainPosition"],previewClass:[mi.None,"cdkDragPreviewClass","previewClass"],previewContainer:[mi.None,"cdkDragPreviewContainer","previewContainer"]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],standalone:!0,features:[qo([{provide:WE,useExisting:n}]),ql,kl]})}return n})(),Yye=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({providers:[oL],imports:[LE]})}return n})();const Kye=["overlayCard"],Zye=["resizeHandleCorner"],Jye=["*"],eve=n=>({"with-body":n}),tve=n=>({expand:n}),nve=n=>({"transparent-bg":n});function ive(n,e){if(1&n&&(zt(0,"div",11),Fl(),zt(1,"svg"),Fr(2,"use"),an()()),2&n){const t=Pr(2);Vn(2),Nw("href","assets/icons/",t.icon,".svg#",t.icon,"")}}function rve(n,e){if(1&n){const t=ta();zt(0,"div",6),zs(1,ive,3,3,"div",7),zt(2,"h5",8),Fi(3),an(),zt(4,"button",9),Ai("click",function(){Ci(t);const r=Pr();return Mi(r.showBody=!r.showBody)}),Fl(),zt(5,"svg"),Fr(6,"use",10),an()()()}if(2&n){const t=Pr();Hn("ngClass",Sf(4,eve,t.showBody)),Vn(),Hn("ngIf",t.icon),Vn(2),tA(t.overlayTitle),Vn(),Hn("ngClass",Sf(6,tve,t.showBody))}}function sve(n,e){if(1&n&&(zt(0,"div",12),ru(1),an()),2&n){const t=Pr();Hn("ngClass",Sf(1,nve,t.transparentBody))}}function ove(n,e){if(1&n){const t=ta();zt(0,"span",13,1),Ai("cdkDragMoved",function(){return Ci(t),Mi(Pr().onResize())}),an()}2&n&&Hn("hidden",!Pr().showBody)}let IC=(()=>{class n{overlayTitle;active=!1;icon;resizable=!1;transparentBody=!1;keepAspectRatioFixed=!1;showBody=!0;aspectRatio=window.innerWidth/window.innerHeight;overlayCard;resizeHandleCorner;MIN_RES_WIDTH=300;MIN_RES_HEIGHT=100;ngAfterViewInit(){if(this.resizable){const t=this.resizeHandleCorner.nativeElement;t.style.bottom="0",t.style.right="0",new Bye.ResizeSensor(this.overlayCard.nativeElement,()=>{this.resetHandlePosition()}),window.addEventListener("resize",()=>{this.resetHandlePosition()})}}onResize(){const i=this.overlayCard.nativeElement,r=this.resizeHandleCorner.nativeElement.getBoundingClientRect(),s=i.getBoundingClientRect(),a=r.left-s.left+r.width,l=r.top-s.top+r.height;this.setHandleTransform(s,r),a>this.MIN_RES_WIDTH&&l>this.MIN_RES_HEIGHT&&(i.style.width=a+"px",i.style.height=this.keepAspectRatioFixed?a/this.aspectRatio+30+"px":l+"px")}resetHandlePosition(){const t=this.resizeHandleCorner.nativeElement;this.setHandleTransform(this.overlayCard.nativeElement.getBoundingClientRect(),t.getBoundingClientRect()),t.style.bottom=null,t.style.right=null}setHandleTransform(t,i){this.resizeHandleCorner.nativeElement.style.transform=`translate3d(${t.width-i.width}px, ${t.height-i.height}px, 0)`}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Zr({type:n,selectors:[["app-overlay"]],viewQuery:function(i,r){if(1&i&&(_l(Kye,5),_l(Zye,5)),2&i){let s;pa(s=ma())&&(r.overlayCard=s.first),pa(s=ma())&&(r.resizeHandleCorner=s.first)}},inputs:{overlayTitle:"overlayTitle",active:"active",icon:"icon",resizable:"resizable",transparentBody:"transparentBody",keepAspectRatioFixed:"keepAspectRatioFixed"},ngContentSelectors:Jye,decls:5,vars:4,consts:[["overlayCard",""],["resizeHandleCorner",""],["cdkDrag","","cdkDragBoundary","body",1,"overlay-card","card",3,"hidden"],["class","card-header d-flex justify-content-between","cdkDragHandle","",3,"ngClass",4,"ngIf"],["class","overlay-card-content",3,"ngClass",4,"ngIf"],["class","resize-handle corner","cdkDrag","",3,"hidden","cdkDragMoved",4,"ngIf"],["cdkDragHandle","",1,"card-header","d-flex","justify-content-between",3,"ngClass"],["class","align-self-center card-icon",4,"ngIf"],[1,"align-self-center","m-0","px-2"],["matTooltip","Expand / Collapse","matTooltipPosition","right",1,"align-self-center","card-icon","btn-blank","expandCollapse",3,"click","ngClass"],["href","assets/icons/expand.svg#expand"],[1,"align-self-center","card-icon"],[1,"overlay-card-content",3,"ngClass"],["cdkDrag","",1,"resize-handle","corner",3,"cdkDragMoved","hidden"]],template:function(i,r){1&i&&(vh(),zt(0,"div",2,0),zs(2,rve,7,8,"div",3)(3,sve,2,3,"div",4)(4,ove,2,1,"span",5),an()),2&i&&(Hn("hidden",!r.active),Vn(2),Hn("ngIf",r.overlayTitle),Vn(),Hn("ngIf",r.showBody),Vn(),Hn("ngIf",r.resizable))},dependencies:[om,Lh,aL,qj,o1],styles:[".overlay-card.card{color:var(--phoenix-text-color);background:none;max-width:100vw;font-size:12px;min-width:300px;height:100%;max-height:70vh;box-shadow:none;border:none;position:relative;z-index:200}.overlay-card.card .card-header{width:12rem;background:var(--phoenix-background-color-secondary);box-shadow:var(--phoenix-box-shadow);padding:.4rem .8rem;border-radius:10px;border:none;cursor:move;text-align:center;transition:all .2s}.overlay-card.card .card-header.with-body{border-bottom-left-radius:0;border-bottom-right-radius:0}.overlay-card.card .card-header .card-icon{display:flex;height:.7rem;width:.7rem}.overlay-card.card .card-header h5{font-size:.9rem}.overlay-card.card .card-header .expandCollapse{cursor:pointer;transition:all .2s}.overlay-card.card .card-header .expandCollapse.expand{transform:scaleY(-1)}.overlay-card.card .card-header .expandCollapse svg{width:100%;height:100%}.overlay-card.card .overlay-card-content{background:var(--phoenix-background-color-secondary);box-shadow:var(--phoenix-box-shadow);border-radius:0 10px 10px;overflow:auto;height:100%}.overlay-card.card .overlay-card-content.transparent-bg{background:none}.overlay-card.card .list-group{color:var(--phoenix-text-color-secondary);background:var(--phoenix-background-color-secondary);max-height:40vh;overflow:auto}.overlay-card.card .list-group .list-group-item{background-color:var(--phoenix-background-color-secondary);border-color:var(--phoenix-border)}.overlay-card.card .resize-handle{width:1rem;height:1rem;cursor:nwse-resize;position:absolute}.overlay-card.card .resize-handle.corner{border-right:.2rem solid var(--phoenix-text-color);border-bottom:.2rem solid var(--phoenix-text-color)}\n"],encapsulation:2})}return n})();const ave=(n,e,t)=>({"active-object":n,"is-cut":e,"d-none":t});function lve(n,e){if(1&n&&(zt(0,"option",15),Fi(1),an()),2&n){const t=e.$implicit;Hn("value",t),Vn(),yl(" ",t," ")}}function cve(n,e){if(1&n){const t=ta();zt(0,"mat-checkbox",16),Ai("change",function(r){return Ci(t),Mi(Pr(3).toggleInvisible(r.checked))}),Fi(1," Hide Invisible Objects "),an()}}function dve(n,e){if(1&n){const t=ta();zt(0,"div",7)(1,"div",8)(2,"span"),Fi(3,"Choose a collection: "),an(),zt(4,"div",9)(5,"label",10),Fi(6,"Event"),an(),zt(7,"select",11),Ai("change",function(r){return Ci(t),Mi(Pr(2).changeCollection(r.target.value))}),zt(8,"option",12),Fi(9,"Choose Collection"),an(),zs(10,lve,2,2,"option",13),an()(),zs(11,cve,2,0,"mat-checkbox",14),an()()}if(2&n){const t=Pr(2);Vn(10),Hn("ngForOf",t.collections),Vn(),Hn("ngIf",t.showingCollection)}}function uve(n,e){if(1&n){const t=ta();zt(0,"th")(1,"div",20)(2,"div"),Fi(3),an(),zt(4,"div",21)(5,"button",22),Ai("click",function(){const r=Ci(t).$implicit;return Mi(Pr(3).sort(r,"dec"))}),Fl(),zt(6,"svg"),Fr(7,"use",23),an()(),Ih(),zt(8,"button",24),Ai("click",function(){const r=Ci(t).$implicit;return Mi(Pr(3).sort(r,"asc"))}),Fl(),zt(9,"svg"),Fr(10,"use",23),an()()()()()}if(2&n){const t=e.$implicit,i=Pr(3);Vn(3),yl(" ",i.getPrettySymbol(t)," ")}}function hve(n,e){if(1&n){const t=ta();zt(0,"div",33)(1,"button",34),Ai("click",function(){Ci(t);const r=Pr().$implicit;return Mi(Pr(3).lookAtObject(r.uuid))}),Fl(),zt(2,"svg"),Fr(3,"use",35),an()(),Ih(),zt(4,"button",36),Ai("click",function(){Ci(t);const r=Pr().$implicit;return Mi(Pr(3).highlightObject(r.uuid))}),Fl(),zt(5,"svg"),Fr(6,"use",37),an()()()}}function fve(n,e){if(1&n&&(zt(0,"td"),Fi(1),an()),2&n){const t=e.$implicit,i=Pr().$implicit;Vn(),yl(" ",i[t]," ")}}function pve(n,e){if(1&n){const t=ta();zt(0,"tr",25)(1,"td"),Fi(2),an(),zt(3,"td"),zs(4,hve,7,0,"div",26),an(),zt(5,"td")(6,"div",27)(7,"div",28),Fr(8,"input",29),an(),zt(9,"div",30)(10,"button",31),Ai("click",function(){const r=Ci(t),s=r.$implicit,a=r.index;return Mi(Pr(3).addLabel(a,s.uuid))}),Fl(),zt(11,"svg"),Fr(12,"use",32),an()()()()(),zs(13,fve,2,1,"td",18),an()}if(2&n){const t=e.$implicit,i=e.index,r=Pr(3);Hn("ngClass",L6(6,ave,r.activeObject&&r.activeObject.value===t.uuid,t.isCut,t.isCut&&r.hideInvisible)),sl("id",t.uuid),Vn(2),yl("#",i,""),Vn(2),Hn("ngIf",t.uuid),Vn(4),Hn("id","label"+i),Vn(5),Hn("ngForOf",r.collectionColumns)}}function mve(n,e){if(1&n&&(zt(0,"table",17)(1,"thead")(2,"tr")(3,"th"),Fi(4,"No."),an(),zt(5,"th"),Fi(6,"Selection"),an(),zt(7,"th"),Fi(8,"Label"),an(),zs(9,uve,11,1,"th",18),an()(),zt(10,"tbody"),zs(11,pve,14,10,"tr",19),an()()),2&n){const t=Pr(2);Vn(9),Hn("ngForOf",t.collectionColumns),Vn(2),Hn("ngForOf",t.showingCollection)}}function Ave(n,e){1&n&&(zt(0,"p",38),Fi(1," Load event data to be able to display information about the collections here. "),an())}function gve(n,e){if(1&n&&(zt(0,"div",2),zs(1,dve,12,2,"div",3),zt(2,"div",4),zs(3,mve,12,2,"table",5)(4,Ave,2,0,"p",6),an()()),2&n){const t=Pr();Vn(),Hn("ngIf",null!=t.collections),Vn(2),Hn("ngIf",t.showingCollection),Vn(),Hn("ngIf",!t.collections)}}let jj=(()=>{class n{elementRef;eventDisplay;showObjectsInfo;hideInvisible;collections;selectedCollection;showingCollection;collectionColumns;getPrettySymbol=$y.getPrettySymbol;activeObject;constructor(t,i){this.elementRef=t,this.eventDisplay=i}ngOnInit(){this.eventDisplay.listenToDisplayedEventChange(t=>this.collections=this.eventDisplay.getCollections()),this.activeObject=this.eventDisplay.getActiveObjectId(),this.activeObject.onUpdate(t=>{document.getElementById(t)&&document.getElementById(t).scrollIntoView(!1)})}changeCollection(t){const i=this.getEventDataGroup();this.selectedCollection=t,this.showingCollection=this.eventDisplay.getCollection(t).map(r=>({...r,isCut:!i.getObjectByProperty("uuid",r.uuid)?.visible})),this.collectionColumns=Object.keys(this.showingCollection[0]).filter(r=>!["uuid","hits","isCut"].includes(r))}sort(t,i){this.showingCollection.sort("asc"===i?(r,s)=>r[t]<s[t]?-1:1:(r,s)=>r[t]>s[t]?-1:1)}lookAtObject(t){t&&(this.activeObject.update(t),this.eventDisplay.lookAtObject(t))}highlightObject(t){t&&(this.activeObject.update(t),this.eventDisplay.highlightObject(t))}enableHighlighting(){this.eventDisplay.enableHighlighting()}disableHighlighting(){this.eventDisplay.disableHighlighting()}toggleInvisible(t){this.hideInvisible=t}addLabel(t,i){const r=this.elementRef.nativeElement.querySelector(`#label${t}`).value;this.selectedCollection&&this.eventDisplay.addLabelToObject(r,this.selectedCollection,t,i)}getEventDataGroup(){return this.eventDisplay.getThreeManager().getSceneManager().getScene().getObjectByName(el.EVENT_DATA_ID)}static \u0275fac=function(i){return new(i||n)(Lt(oo),Lt(pl))};static \u0275cmp=Zr({type:n,selectors:[["app-collections-info-overlay"]],inputs:{showObjectsInfo:"showObjectsInfo"},decls:2,vars:3,consts:[["overlayTitle","Collections Info","icon","info",3,"resizable","active"],["class","collectionsInfo m-2",4,"ngIf"],[1,"collectionsInfo","m-2"],["class","collectionSelector mb-2 d-flex align-items-center",4,"ngIf"],[1,"boxBody","table-responsive"],["id","collectionTable","class","table table-borderless table-sm",4,"ngIf"],["class","emptyBox",4,"ngIf"],[1,"collectionSelector","mb-2","d-flex","align-items-center"],[1,"d-flex","align-items-center"],[1,"eventSelector"],["for","event"],["id","collection","name","collection",3,"change"],["value","","selected","","disabled","","hidden",""],[3,"value",4,"ngFor","ngForOf"],[3,"change",4,"ngIf"],[3,"value"],[3,"change"],["id","collectionTable",1,"table","table-borderless","table-sm"],[4,"ngFor","ngForOf"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"head-wrapper"],[1,"sort-options"],[1,"icon-wrapper","icon-button","btn-blank","up",3,"click"],["href","assets/icons/expand.svg#expand"],[1,"icon-wrapper","icon-button","btn-blank",3,"click"],[3,"ngClass"],["class","row justify-content-center icon-wrapper",4,"ngIf"],[1,"row","m-0","add-label"],[1,"col-10","p-0"],["type","text",1,"form-control","form-control-sm",3,"id"],[1,"col-2","p-0","pl-2","text-center","icon-wrapper"],["matTooltip","Add, update or remove object label",1,"object-select","btn-blank",3,"click"],["href","assets/icons/update.svg#update"],[1,"row","justify-content-center","icon-wrapper"],["matTooltip","Move camera to object",1,"object-select","btn-blank",3,"click"],["href","assets/icons/views.svg#views"],["matTooltip","Highlight object",1,"object-select","btn-blank",3,"click"],["href","assets/icons/cursor.svg#cursor"],[1,"emptyBox"]],template:function(i,r){1&i&&(zt(0,"app-overlay",0),zs(1,gve,5,3,"div",1),an()),2&i&&(Hn("resizable",!0)("active",r.showObjectsInfo),Vn(),Hn("ngIf",r.showObjectsInfo))},dependencies:[om,am,Lh,o1,EC,TC,sv,IC],styles:[".collectionsInfo[_ngcontent-%COMP%]{height:95%}.collectionsInfo[_ngcontent-%COMP%]   .collectionSelector[_ngcontent-%COMP%]{height:15%;min-height:2rem}.collectionsInfo[_ngcontent-%COMP%]   .collectionSelector[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--phoenix-text-color-secondary);margin-right:1rem}.collectionsInfo[_ngcontent-%COMP%]   .collectionSelector[_ngcontent-%COMP%]   mat-checkbox[_ngcontent-%COMP%]{margin-left:1rem}.boxBody[_ngcontent-%COMP%]{height:85%;overflow:scroll}.boxBody[_ngcontent-%COMP%]   p.emptyBox[_ngcontent-%COMP%]{max-width:21em}.boxBody[_ngcontent-%COMP%]   .add-label[_ngcontent-%COMP%]{min-width:8rem}.boxBody[_ngcontent-%COMP%]   .add-label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:.1rem .3rem;font-size:.75rem}#collectionTable[_ngcontent-%COMP%]{position:relative;color:var(--phoenix-text-color-secondary)}#collectionTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;z-index:100;background:var(--phoenix-background-color-secondary)}#collectionTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .head-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center}#collectionTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .head-wrapper[_ngcontent-%COMP%]   .sort-options[_ngcontent-%COMP%]{display:flex;flex-direction:row}#collectionTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .head-wrapper[_ngcontent-%COMP%]   .sort-options[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{display:flex;width:1rem;height:1rem;padding:.2rem}#collectionTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .head-wrapper[_ngcontent-%COMP%]   .sort-options[_ngcontent-%COMP%]   .icon-wrapper.up[_ngcontent-%COMP%]{transform:rotate(180deg)}#collectionTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .head-wrapper[_ngcontent-%COMP%]   .sort-options[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:100%;height:100%}#collectionTable[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{padding-right:1.2rem}#collectionTable[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:last-child{padding-right:0}#collectionTable[_ngcontent-%COMP%]   tr.is-cut[_ngcontent-%COMP%]{opacity:.5}#collectionTable[_ngcontent-%COMP%]   tr.active-object[_ngcontent-%COMP%]{color:var(--phoenix-background-color);background:var(--phoenix-text-color);box-shadow:0 0 15px var(--phoenix-text-color)}#collectionTable[_ngcontent-%COMP%]   tr.active-object[_ngcontent-%COMP%]   div.icon-wrapper[_ngcontent-%COMP%]{--phoenix-options-icon-path: var(--phoenix-background-color);--phoenix-options-icon-bg: var(--phoenix-text-color-hover)}#collectionTable[_ngcontent-%COMP%]   tr.active-object[_ngcontent-%COMP%]   .add-label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{--phoenix-text-color: var(--phoenix-background-color);--phoenix-background-color-tertiary: var( --phoenix-text-color-secondary );--phoenix-border: var(--phoenix-background-color)}#collectionTable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .object-select[_ngcontent-%COMP%]{position:relative;width:1.6rem;height:1.6rem;margin-right:.4em;text-align:center;background-color:var(--phoenix-options-icon-bg);border-radius:10px;cursor:pointer}#collectionTable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .object-select[_ngcontent-%COMP%]:last-child{margin-right:0}#collectionTable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .object-select[_ngcontent-%COMP%]:hover{border:1px solid var(--phoenix-options-icon-path)}#collectionTable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .object-select[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:absolute;top:0;left:0;padding:.4rem;width:100%;height:100%;vertical-align:top}.eventSelector[_ngcontent-%COMP%]{display:flex}.eventSelector[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:none;color:var(--phoenix-text-color-secondary)}.eventSelector[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:9rem;padding:5px 10px;font-size:12px;border:1px solid rgba(88,88,88,.08);box-shadow:var(--phoenix-icon-shadow);background-color:var(--phoenix-background-color-tertiary);color:var(--phoenix-text-color-secondary)}"]})}return n})(),cL=(()=>{class n{overlay;showObjectsInfo=!1;overlayWindow;constructor(t){this.overlay=t}ngOnInit(){const t=this.overlay.create(),i=new e1(jj);this.overlayWindow=t.attach(i),this.overlayWindow.instance.showObjectsInfo=this.showObjectsInfo}ngOnDestroy(){this.overlayWindow.destroy()}toggleOverlay(){this.showObjectsInfo=!this.showObjectsInfo,this.overlayWindow.instance.showObjectsInfo=this.showObjectsInfo,this.showObjectsInfo?this.overlayWindow.instance.enableHighlighting():this.overlayWindow.instance.disableHighlighting()}static \u0275fac=function(i){return new(i||n)(Lt(pu))};static \u0275cmp=Zr({type:n,selectors:[["app-collections-info"]],decls:1,vars:1,consts:[["tooltip","Event data collections info","icon","info",3,"click","active"]],template:function(i,r){1&i&&(zt(0,"app-menu-toggle",0),Ai("click",function(){return r.toggleOverlay()}),an()),2&i&&Hn("active",r.showObjectsInfo)},dependencies:[qc]})}return n})();const _ve=n=>({"active-object":n});function yve(n,e){if(1&n&&(zt(0,"option",13),Fi(1),an()),2&n){const t=e.$implicit;Hn("value",t.name),Vn(),yl(" ",t.name," ")}}function vve(n,e){if(1&n){const t=ta();zt(0,"div",7)(1,"div",8)(2,"span"),Fi(3,"Choose a collection: "),an(),zt(4,"div",9)(5,"select",10),Ai("change",function(r){return Ci(t),Mi(Pr(2).changeCollection(r.target.value))}),zt(6,"option",11),Fi(7,"Choose Collection"),an(),zs(8,yve,2,2,"option",12),an()()()()}if(2&n){const t=Pr(2);Vn(8),Hn("ngForOf",t.children)}}function bve(n,e){if(1&n){const t=ta();zt(0,"div",18)(1,"button",19),Ai("click",function(){Ci(t);const r=Pr().$implicit;return Mi(Pr(3).lookAtObject(r.uuid))}),Fl(),zt(2,"svg"),Fr(3,"use",20),an()(),Ih(),zt(4,"button",21),Ai("click",function(){Ci(t);const r=Pr().$implicit;return Mi(Pr(3).highlightObject(r.uuid))}),Fl(),zt(5,"svg"),Fr(6,"use",22),an()()()}}function xve(n,e){if(1&n&&(zt(0,"tr",16)(1,"td"),Fi(2),an(),zt(3,"td"),zs(4,bve,7,0,"div",17),an()()),2&n){const t=e.$implicit,i=e.index,r=Pr(3);Hn("ngClass",Sf(4,_ve,r.activeObject&&r.activeObject.value===t.uuid)),sl("id",t.uuid),Vn(2),yl("#",i,""),Vn(2),Hn("ngIf",t.uuid)}}function wve(n,e){if(1&n&&(zt(0,"table",14)(1,"thead")(2,"tr")(3,"th"),Fi(4,"No."),an(),zt(5,"th"),Fi(6,"Selection"),an()()(),zt(7,"tbody"),zs(8,xve,5,6,"tr",15),an()()),2&n){const t=Pr(2);Vn(8),Hn("ngForOf",t.showingCollection)}}function Cve(n,e){1&n&&(zt(0,"p",23),Fi(1," Load event data to be able to display information about the collections here. "),an())}function Mve(n,e){if(1&n&&(zt(0,"div",2),zs(1,vve,9,1,"div",3),zt(2,"div",4),zs(3,wve,9,1,"table",5)(4,Cve,2,0,"p",6),an()()),2&n){const t=Pr();Vn(),Hn("ngIf",null!=t.children),Vn(2),Hn("ngIf",t.showingCollection),Vn(),Hn("ngIf",!t.children)}}let $j=(()=>{class n{eventDisplay;browseDetectorParts;selectedCollection;showingCollection;activeObject;children;constructor(t){this.eventDisplay=t}ngOnInit(){this.children=this.eventDisplay.getThreeManager().getSceneManager().getGeometries().children,this.activeObject=this.eventDisplay.getActiveObjectId(),this.activeObject.onUpdate(t=>{document.getElementById(t)&&document.getElementById(t).scrollIntoView(!1)})}changeCollection(t){this.selectedCollection=t;for(const i of this.children)if(i.name===this.selectedCollection){this.showingCollection=i.children;break}}lookAtObject(t){t&&(this.activeObject.update(t),this.eventDisplay.lookAtObject(t,!0))}highlightObject(t){t&&(this.activeObject.update(t),this.eventDisplay.highlightObject(t,!0))}enableHighlighting(){this.eventDisplay.enableHighlighting()}disableHighlighting(){this.eventDisplay.disableHighlighting()}static \u0275fac=function(i){return new(i||n)(Lt(pl))};static \u0275cmp=Zr({type:n,selectors:[["app-geometry-browser-overlay"]],inputs:{browseDetectorParts:"browseDetectorParts"},decls:2,vars:3,consts:[["overlayTitle","Browse Display","icon","info",3,"resizable","active"],["class","collectionsInfo m-2",4,"ngIf"],[1,"collectionsInfo","m-2"],["class","collectionSelector mb-2 d-flex align-items-center",4,"ngIf"],[1,"boxBody","table-responsive"],["id","collectionTable","class","table table-borderless table-sm",4,"ngIf"],["class","emptyBox",4,"ngIf"],[1,"collectionSelector","mb-2","d-flex","align-items-center"],[1,"d-flex","align-items-center"],[1,"eventSelector"],["id","detectorCollection","name","detectorCollection",3,"change"],["value","","selected","","disabled","","hidden",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["id","collectionTable",1,"table","table-borderless","table-sm"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["class","row justify-content-center icon-wrapper",4,"ngIf"],[1,"row","justify-content-center","icon-wrapper"],["matTooltip","Move camera to object",1,"object-select","btn-blank",3,"click"],["href","assets/icons/views.svg#views"],["matTooltip","Highlight object",1,"object-select","btn-blank",3,"click"],["href","assets/icons/cursor.svg#cursor"],[1,"emptyBox"]],template:function(i,r){1&i&&(zt(0,"app-overlay",0),zs(1,Mve,5,3,"div",1),an()),2&i&&(Hn("resizable",!0)("active",r.browseDetectorParts),Vn(),Hn("ngIf",r.browseDetectorParts))},dependencies:[om,am,Lh,o1,EC,TC,IC],styles:[".collectionsInfo[_ngcontent-%COMP%]{height:95%}.collectionsInfo[_ngcontent-%COMP%]   .collectionSelector[_ngcontent-%COMP%]{height:15%;min-height:2rem}.collectionsInfo[_ngcontent-%COMP%]   .collectionSelector[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--phoenix-text-color-secondary);margin-right:1rem}.boxBody[_ngcontent-%COMP%]{height:85%;overflow:scroll}.boxBody[_ngcontent-%COMP%]   p.emptyBox[_ngcontent-%COMP%]{max-width:21em}#collectionTable[_ngcontent-%COMP%]{position:relative;color:var(--phoenix-text-color-secondary)}#collectionTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;z-index:100;background:var(--phoenix-background-color-secondary)}#collectionTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin-right:10px;margin-left:-92px}#collectionTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{display:flex;width:1rem;height:1rem;padding:.2rem}#collectionTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:100%;height:100%}#collectionTable[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{padding-right:1.2rem}#collectionTable[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:last-child{padding-right:0}#collectionTable[_ngcontent-%COMP%]   tr.active-object[_ngcontent-%COMP%]{color:var(--phoenix-background-color);background:var(--phoenix-text-color);box-shadow:0 0 15px var(--phoenix-text-color)}#collectionTable[_ngcontent-%COMP%]   tr.active-object[_ngcontent-%COMP%]   div.icon-wrapper[_ngcontent-%COMP%]{--phoenix-options-icon-path: var(--phoenix-background-color);--phoenix-options-icon-bg: var(--phoenix-text-color-hover)}#collectionTable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .object-select[_ngcontent-%COMP%]{position:relative;width:1.6rem;height:1.6rem;margin-right:.4em;text-align:center;background-color:var(--phoenix-options-icon-bg);border-radius:10px;cursor:pointer}#collectionTable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .object-select[_ngcontent-%COMP%]:last-child{margin-right:0}#collectionTable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .object-select[_ngcontent-%COMP%]:hover{border:1px solid var(--phoenix-options-icon-path)}#collectionTable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .object-select[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:absolute;top:0;left:0;padding:.4rem;width:100%;height:100%;vertical-align:top}.eventSelector[_ngcontent-%COMP%]{display:flex}.eventSelector[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:none;color:var(--phoenix-text-color-secondary)}.eventSelector[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:9rem;padding:5px 10px;font-size:12px;border:1px solid rgba(88,88,88,.08);box-shadow:var(--phoenix-icon-shadow);background-color:var(--phoenix-background-color-tertiary);color:var(--phoenix-text-color-secondary)}"]})}return n})(),Xj=(()=>{class n{overlay;browseDetectorParts=!1;overlayWindow;constructor(t){this.overlay=t}ngOnInit(){const t=this.overlay.create(),i=new e1($j);this.overlayWindow=t.attach(i),this.overlayWindow.instance.browseDetectorParts=this.browseDetectorParts}ngOnDestroy(){this.overlayWindow.destroy()}toggleOverlay(){this.browseDetectorParts=!this.browseDetectorParts,this.overlayWindow.instance.browseDetectorParts=this.browseDetectorParts,this.browseDetectorParts?this.overlayWindow.instance.enableHighlighting():this.overlayWindow.instance.disableHighlighting()}static \u0275fac=function(i){return new(i||n)(Lt(pu))};static \u0275cmp=Zr({type:n,selectors:[["app-geometry-browser"]],decls:1,vars:1,consts:[["tooltip","Browse geometry","icon","info",3,"click","active"]],template:function(i,r){1&i&&(zt(0,"app-menu-toggle",0),Ai("click",function(){return r.toggleOverlay()}),an()),2&i&&Hn("active",r.browseDetectorParts)},dependencies:[qc]})}return n})();function Sve(n,e){}class tB{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.closeOnNavigation=!0,this.closeOnDestroy=!0,this.closeOnOverlayDetachments=!0}}let Yj=(()=>{class n extends SO{constructor(t,i,r,s,a,l,d,u){super(),this._elementRef=t,this._focusTrapFactory=i,this._config=s,this._interactivityChecker=a,this._ngZone=l,this._overlayRef=d,this._focusMonitor=u,this._platform=pi(dd),this._focusTrap=null,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this._ariaLabelledByQueue=[],this._changeDetectorRef=pi(Sc),this.attachDomPortal=p=>{this._portalOutlet.hasAttached();const _=this._portalOutlet.attachDomPortal(p);return this._contentAttached(),_},this._document=r,this._config.ariaLabelledBy&&this._ariaLabelledByQueue.push(this._config.ariaLabelledBy)}_addAriaLabelledBy(t){this._ariaLabelledByQueue.push(t),this._changeDetectorRef.markForCheck()}_removeAriaLabelledBy(t){const i=this._ariaLabelledByQueue.indexOf(t);i>-1&&(this._ariaLabelledByQueue.splice(i,1),this._changeDetectorRef.markForCheck())}_contentAttached(){this._initializeFocusTrap(),this._handleBackdropClicks(),this._captureInitialFocus()}_captureInitialFocus(){this._trapFocus()}ngOnDestroy(){this._restoreFocus()}attachComponentPortal(t){this._portalOutlet.hasAttached();const i=this._portalOutlet.attachComponentPortal(t);return this._contentAttached(),i}attachTemplatePortal(t){this._portalOutlet.hasAttached();const i=this._portalOutlet.attachTemplatePortal(t);return this._contentAttached(),i}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(t,i){this._interactivityChecker.isFocusable(t)||(t.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const r=()=>{t.removeEventListener("blur",r),t.removeEventListener("mousedown",r),t.removeAttribute("tabindex")};t.addEventListener("blur",r),t.addEventListener("mousedown",r)})),t.focus(i)}_focusByCssSelector(t,i){let r=this._elementRef.nativeElement.querySelector(t);r&&this._forceFocus(r,i)}_trapFocus(){const t=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||t.focus();break;case!0:case"first-tabbable":this._focusTrap?.focusInitialElementWhenReady().then(i=>{i||this._focusDialogContainer()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus)}}_restoreFocus(){const t=this._config.restoreFocus;let i=null;if("string"==typeof t?i=this._document.querySelector(t):"boolean"==typeof t?i=t?this._elementFocusedBeforeDialogWasOpened:null:t&&(i=t),this._config.restoreFocus&&i&&"function"==typeof i.focus){const r=aO(),s=this._elementRef.nativeElement;(!r||r===this._document.body||r===s||s.contains(r))&&(this._focusMonitor?(this._focusMonitor.focusVia(i,this._closeInteractionType),this._closeInteractionType=null):i.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){const t=this._elementRef.nativeElement,i=aO();return t===i||t.contains(i)}_initializeFocusTrap(){this._platform.isBrowser&&(this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=aO()))}_handleBackdropClicks(){this._overlayRef.backdropClick().subscribe(()=>{this._config.disableClose&&this._recaptureFocus()})}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(oo),Lt(OQ),Lt(ba,8),Lt(tB),Lt(gO),Lt(io),Lt(L4),Lt(J_))};static#t=this.\u0275cmp=Zr({type:n,selectors:[["cdk-dialog-container"]],viewQuery:function(i,r){if(1&i&&_l(wC,7),2&i){let s;pa(s=ma())&&(r._portalOutlet=s.first)}},hostAttrs:["tabindex","-1",1,"cdk-dialog-container"],hostVars:6,hostBindings:function(i,r){2&i&&sl("id",r._config.id||null)("role",r._config.role)("aria-modal",r._config.ariaModal)("aria-labelledby",r._config.ariaLabel?null:r._ariaLabelledByQueue[0])("aria-label",r._config.ariaLabel)("aria-describedby",r._config.ariaDescribedBy||null)},standalone:!0,features:[Lo,yd],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(i,r){1&i&&zs(0,Sve,0,0,"ng-template",0)},dependencies:[wC],styles:[".cdk-dialog-container{display:block;width:100%;height:100%;min-height:inherit;max-height:inherit}"],encapsulation:2})}return n})();class dL{constructor(e,t){this.overlayRef=e,this.config=t,this.closed=new hn,this.disableClose=t.disableClose,this.backdropClick=e.backdropClick(),this.keydownEvents=e.keydownEvents(),this.outsidePointerEvents=e.outsidePointerEvents(),this.id=t.id,this.keydownEvents.subscribe(i=>{27===i.keyCode&&!this.disableClose&&!bC(i)&&(i.preventDefault(),this.close(void 0,{focusOrigin:"keyboard"}))}),this.backdropClick.subscribe(()=>{this.disableClose||this.close(void 0,{focusOrigin:"mouse"})}),this._detachSubscription=e.detachments().subscribe(()=>{!1!==t.closeOnOverlayDetachments&&this.close()})}close(e,t){if(this.containerInstance){const i=this.closed;this.containerInstance._closeInteractionType=t?.focusOrigin||"program",this._detachSubscription.unsubscribe(),this.overlayRef.dispose(),i.next(e),i.complete(),this.componentInstance=this.containerInstance=null}}updatePosition(){return this.overlayRef.updatePosition(),this}updateSize(e="",t=""){return this.overlayRef.updateSize({width:e,height:t}),this}addPanelClass(e){return this.overlayRef.addPanelClass(e),this}removePanelClass(e){return this.overlayRef.removePanelClass(e),this}}const Kj=new Bi("DialogScrollStrategy",{providedIn:"root",factory:()=>{const n=pi(pu);return()=>n.scrollStrategies.block()}}),Eve=new Bi("DialogData"),Tve=new Bi("DefaultDialogConfig");let Ive=0,Zj=(()=>{class n{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}constructor(t,i,r,s,a,l){this._overlay=t,this._injector=i,this._defaultOptions=r,this._parentDialog=s,this._overlayContainer=a,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new hn,this._afterOpenedAtThisLevel=new hn,this._ariaHiddenElements=new Map,this.afterAllClosed=wD(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(sA(void 0))),this._scrollStrategy=l}open(t,i){(i={...this._defaultOptions||new tB,...i}).id=i.id||"cdk-dialog-"+Ive++,i.id&&this.getDialogById(i.id);const s=this._getOverlayConfig(i),a=this._overlay.create(s),l=new dL(a,i),d=this._attachContainer(a,l,i);return l.containerInstance=d,this._attachDialogContent(t,l,d,i),this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(l),l.closed.subscribe(()=>this._removeOpenDialog(l,!0)),this.afterOpened.next(l),l}closeAll(){uL(this.openDialogs,t=>t.close())}getDialogById(t){return this.openDialogs.find(i=>i.id===t)}ngOnDestroy(){uL(this._openDialogsAtThisLevel,t=>{!1===t.config.closeOnDestroy&&this._removeOpenDialog(t,!1)}),uL(this._openDialogsAtThisLevel,t=>t.close()),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._openDialogsAtThisLevel=[]}_getOverlayConfig(t){const i=new DO({positionStrategy:t.positionStrategy||this._overlay.position().global().centerHorizontally().centerVertically(),scrollStrategy:t.scrollStrategy||this._scrollStrategy(),panelClass:t.panelClass,hasBackdrop:t.hasBackdrop,direction:t.direction,minWidth:t.minWidth,minHeight:t.minHeight,maxWidth:t.maxWidth,maxHeight:t.maxHeight,width:t.width,height:t.height,disposeOnNavigation:t.closeOnNavigation});return t.backdropClass&&(i.backdropClass=t.backdropClass),i}_attachContainer(t,i,r){const s=r.injector||r.viewContainerRef?.injector,a=[{provide:tB,useValue:r},{provide:dL,useValue:i},{provide:L4,useValue:t}];let l;r.container?"function"==typeof r.container?l=r.container:(l=r.container.type,a.push(...r.container.providers(r))):l=Yj;const d=new e1(l,r.viewContainerRef,Al.create({parent:s||this._injector,providers:a}),r.componentFactoryResolver);return t.attach(d).instance}_attachDialogContent(t,i,r,s){if(t instanceof Ud){const a=this._createInjector(s,i,r,void 0);let l={$implicit:s.data,dialogRef:i};s.templateContext&&(l={...l,..."function"==typeof s.templateContext?s.templateContext():s.templateContext}),r.attachTemplatePortal(new PE(t,null,l,a))}else{const a=this._createInjector(s,i,r,this._injector),l=r.attachComponentPortal(new e1(t,s.viewContainerRef,a,s.componentFactoryResolver));i.componentRef=l,i.componentInstance=l.instance}}_createInjector(t,i,r,s){const a=t.injector||t.viewContainerRef?.injector,l=[{provide:Eve,useValue:t.data},{provide:dL,useValue:i}];return t.providers&&("function"==typeof t.providers?l.push(...t.providers(i,t,r)):l.push(...t.providers)),t.direction&&(!a||!a.get(_m,null,{optional:!0}))&&l.push({provide:_m,useValue:{value:t.direction,change:po()}}),Al.create({parent:a||s,providers:l})}_removeOpenDialog(t,i){const r=this.openDialogs.indexOf(t);r>-1&&(this.openDialogs.splice(r,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((s,a)=>{s?a.setAttribute("aria-hidden",s):a.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),i&&this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const t=this._overlayContainer.getContainerElement();if(t.parentElement){const i=t.parentElement.children;for(let r=i.length-1;r>-1;r--){const s=i[r];s!==t&&"SCRIPT"!==s.nodeName&&"STYLE"!==s.nodeName&&!s.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(s,s.getAttribute("aria-hidden")),s.setAttribute("aria-hidden","true"))}}}_getAfterAllClosed(){const t=this._parentDialog;return t?t._getAfterAllClosed():this._afterAllClosedAtThisLevel}static#e=this.\u0275fac=function(i){return new(i||n)(xi(pu),xi(Al),xi(Tve,8),xi(n,12),xi(O4),xi(Kj))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function uL(n,e){let t=n.length;for(;t--;)e(n[t])}let Bve=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({providers:[Zj],imports:[NE,k4,HQ,k4]})}return n})();function Pve(n,e){}class hL{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.delayFocusTrap=!0,this.closeOnNavigation=!0}}const fL="mdc-dialog--open",Jj="mdc-dialog--opening",e$="mdc-dialog--closing";let t$=(()=>{class n extends Yj{constructor(t,i,r,s,a,l,d,u,p){super(t,i,r,s,a,l,d,p),this._animationMode=u,this._animationStateChanged=new Ls,this._animationsEnabled="NoopAnimations"!==this._animationMode,this._actionSectionCount=0,this._hostElement=this._elementRef.nativeElement,this._enterAnimationDuration=this._animationsEnabled?i$(this._config.enterAnimationDuration)??150:0,this._exitAnimationDuration=this._animationsEnabled?i$(this._config.exitAnimationDuration)??75:0,this._animationTimer=null,this._finishDialogOpen=()=>{this._clearAnimationClasses(),this._openAnimationDone(this._enterAnimationDuration)},this._finishDialogClose=()=>{this._clearAnimationClasses(),this._animationStateChanged.emit({state:"closed",totalTime:this._exitAnimationDuration})}}_contentAttached(){super._contentAttached(),this._startOpenAnimation()}_startOpenAnimation(){this._animationStateChanged.emit({state:"opening",totalTime:this._enterAnimationDuration}),this._animationsEnabled?(this._hostElement.style.setProperty(n$,`${this._enterAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(Jj,fL)),this._waitForAnimationToComplete(this._enterAnimationDuration,this._finishDialogOpen)):(this._hostElement.classList.add(fL),Promise.resolve().then(()=>this._finishDialogOpen()))}_startExitAnimation(){this._animationStateChanged.emit({state:"closing",totalTime:this._exitAnimationDuration}),this._hostElement.classList.remove(fL),this._animationsEnabled?(this._hostElement.style.setProperty(n$,`${this._exitAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(e$)),this._waitForAnimationToComplete(this._exitAnimationDuration,this._finishDialogClose)):Promise.resolve().then(()=>this._finishDialogClose())}_updateActionSectionCount(t){this._actionSectionCount+=t,this._changeDetectorRef.markForCheck()}_clearAnimationClasses(){this._hostElement.classList.remove(Jj,e$)}_waitForAnimationToComplete(t,i){null!==this._animationTimer&&clearTimeout(this._animationTimer),this._animationTimer=setTimeout(i,t)}_requestAnimationFrame(t){this._ngZone.runOutsideAngular(()=>{"function"==typeof requestAnimationFrame?requestAnimationFrame(t):t()})}_captureInitialFocus(){this._config.delayFocusTrap||this._trapFocus()}_openAnimationDone(t){this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:t})}ngOnDestroy(){super.ngOnDestroy(),null!==this._animationTimer&&clearTimeout(this._animationTimer)}attachComponentPortal(t){const i=super.attachComponentPortal(t);return i.location.nativeElement.classList.add("mat-mdc-dialog-component-host"),i}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(oo),Lt(OQ),Lt(ba,8),Lt(hL),Lt(gO),Lt(io),Lt(L4),Lt(Od,8),Lt(J_))};static#t=this.\u0275cmp=Zr({type:n,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1",1,"mat-mdc-dialog-container","mdc-dialog"],hostVars:10,hostBindings:function(i,r){2&i&&(Hw("id",r._config.id),sl("aria-modal",r._config.ariaModal)("role",r._config.role)("aria-labelledby",r._config.ariaLabel?null:r._ariaLabelledByQueue[0])("aria-label",r._config.ariaLabel)("aria-describedby",r._config.ariaDescribedBy||null),Ja("_mat-animation-noopable",!r._animationsEnabled)("mat-mdc-dialog-container-with-actions",r._actionSectionCount>0))},standalone:!0,features:[Lo,yd],decls:3,vars:0,consts:[[1,"mdc-dialog__container"],[1,"mat-mdc-dialog-surface","mdc-dialog__surface"],["cdkPortalOutlet",""]],template:function(i,r){1&i&&(zt(0,"div",0)(1,"div",1),zs(2,Pve,0,0,"ng-template",2),an()())},dependencies:[wC],styles:['.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-dialog,.mdc-dialog__scrim{position:fixed;top:0;left:0;align-items:center;justify-content:center;box-sizing:border-box;width:100%;height:100%}.mdc-dialog{display:none;z-index:var(--mdc-dialog-z-index, 7)}.mdc-dialog .mdc-dialog__content{padding:20px 24px 20px 24px}.mdc-dialog .mdc-dialog__surface{min-width:280px}@media(max-width: 592px){.mdc-dialog .mdc-dialog__surface{max-width:calc(100vw - 32px)}}@media(min-width: 592px){.mdc-dialog .mdc-dialog__surface{max-width:560px}}.mdc-dialog .mdc-dialog__surface{max-height:calc(100% - 32px)}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-width:none}@media(max-width: 960px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:560px;width:560px}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}@media(max-width: 720px)and (max-width: 672px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:calc(100vw - 112px)}}@media(max-width: 720px)and (min-width: 672px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:560px}}@media(max-width: 720px)and (max-height: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:calc(100vh - 160px)}}@media(max-width: 720px)and (min-height: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:560px}}@media(max-width: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}@media(max-width: 720px)and (max-height: 400px),(max-width: 600px),(min-width: 720px)and (max-height: 400px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{height:100%;max-height:100vh;max-width:100vw;width:100vw;border-radius:0}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{order:-1;left:-12px}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__header{padding:0 16px 9px;justify-content:flex-start}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__title{margin-left:calc(16px - 2 * 12px)}}@media(min-width: 960px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:calc(100vw - 400px)}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}.mdc-dialog.mdc-dialog__scrim--hidden .mdc-dialog__scrim{opacity:0}.mdc-dialog__scrim{opacity:0;z-index:-1}.mdc-dialog__container{display:flex;flex-direction:row;align-items:center;justify-content:space-around;box-sizing:border-box;height:100%;opacity:0;pointer-events:none}.mdc-dialog__surface{position:relative;display:flex;flex-direction:column;flex-grow:0;flex-shrink:0;box-sizing:border-box;max-width:100%;max-height:100%;pointer-events:auto;overflow-y:auto;outline:0;transform:scale(0.8)}.mdc-dialog__surface .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}[dir=rtl] .mdc-dialog__surface,.mdc-dialog__surface[dir=rtl]{text-align:right}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-dialog__surface{outline:2px solid windowText}}.mdc-dialog__surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:2px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-dialog__surface::before{border-color:CanvasText}}@media screen and (-ms-high-contrast: active),screen and (-ms-high-contrast: none){.mdc-dialog__surface::before{content:none}}.mdc-dialog__title{display:block;margin-top:0;position:relative;flex-shrink:0;box-sizing:border-box;margin:0 0 1px;padding:0 24px 9px}.mdc-dialog__title::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}[dir=rtl] .mdc-dialog__title,.mdc-dialog__title[dir=rtl]{text-align:right}.mdc-dialog--scrollable .mdc-dialog__title{margin-bottom:1px;padding-bottom:15px}.mdc-dialog--fullscreen .mdc-dialog__header{align-items:baseline;border-bottom:1px solid rgba(0,0,0,0);display:inline-flex;justify-content:space-between;padding:0 24px 9px;z-index:1}@media screen and (forced-colors: active){.mdc-dialog--fullscreen .mdc-dialog__header{border-bottom-color:CanvasText}}.mdc-dialog--fullscreen .mdc-dialog__header .mdc-dialog__close{right:-12px}.mdc-dialog--fullscreen .mdc-dialog__title{margin-bottom:0;padding:0;border-bottom:0}.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__title{border-bottom:0;margin-bottom:0}.mdc-dialog--fullscreen .mdc-dialog__close{top:5px}.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__actions{border-top:1px solid rgba(0,0,0,0)}@media screen and (forced-colors: active){.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__actions{border-top-color:CanvasText}}.mdc-dialog--fullscreen--titleless .mdc-dialog__close{margin-top:4px}.mdc-dialog--fullscreen--titleless.mdc-dialog--scrollable .mdc-dialog__close{margin-top:0}.mdc-dialog__content{flex-grow:1;box-sizing:border-box;margin:0;overflow:auto}.mdc-dialog__content>:first-child{margin-top:0}.mdc-dialog__content>:last-child{margin-bottom:0}.mdc-dialog__title+.mdc-dialog__content,.mdc-dialog__header+.mdc-dialog__content{padding-top:0}.mdc-dialog--scrollable .mdc-dialog__title+.mdc-dialog__content{padding-top:8px;padding-bottom:8px}.mdc-dialog__content .mdc-deprecated-list:first-child:last-child{padding:6px 0 0}.mdc-dialog--scrollable .mdc-dialog__content .mdc-deprecated-list:first-child:last-child{padding:0}.mdc-dialog__actions{display:flex;position:relative;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:flex-end;box-sizing:border-box;min-height:52px;margin:0;padding:8px;border-top:1px solid rgba(0,0,0,0)}@media screen and (forced-colors: active){.mdc-dialog__actions{border-top-color:CanvasText}}.mdc-dialog--stacked .mdc-dialog__actions{flex-direction:column;align-items:flex-end}.mdc-dialog__button{margin-left:8px;margin-right:0;max-width:100%;text-align:right}[dir=rtl] .mdc-dialog__button,.mdc-dialog__button[dir=rtl]{margin-left:0;margin-right:8px}.mdc-dialog__button:first-child{margin-left:0;margin-right:0}[dir=rtl] .mdc-dialog__button:first-child,.mdc-dialog__button:first-child[dir=rtl]{margin-left:0;margin-right:0}[dir=rtl] .mdc-dialog__button,.mdc-dialog__button[dir=rtl]{text-align:left}.mdc-dialog--stacked .mdc-dialog__button:not(:first-child){margin-top:12px}.mdc-dialog--open,.mdc-dialog--opening,.mdc-dialog--closing{display:flex}.mdc-dialog--opening .mdc-dialog__scrim{transition:opacity 150ms linear}.mdc-dialog--opening .mdc-dialog__container{transition:opacity 75ms linear,transform 150ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-dialog--closing .mdc-dialog__scrim,.mdc-dialog--closing .mdc-dialog__container{transition:opacity 75ms linear}.mdc-dialog--closing .mdc-dialog__container{transform:none}.mdc-dialog--closing .mdc-dialog__surface{transform:none}.mdc-dialog--open .mdc-dialog__scrim{opacity:1}.mdc-dialog--open .mdc-dialog__container{opacity:1}.mdc-dialog--open .mdc-dialog__surface{transform:none}.mdc-dialog--open.mdc-dialog__surface-scrim--shown .mdc-dialog__surface-scrim{opacity:1}.mdc-dialog--open.mdc-dialog__surface-scrim--hiding .mdc-dialog__surface-scrim{transition:opacity 75ms linear}.mdc-dialog--open.mdc-dialog__surface-scrim--showing .mdc-dialog__surface-scrim{transition:opacity 150ms linear}.mdc-dialog__surface-scrim{display:none;opacity:0;position:absolute;width:100%;height:100%;z-index:1}.mdc-dialog__surface-scrim--shown .mdc-dialog__surface-scrim,.mdc-dialog__surface-scrim--showing .mdc-dialog__surface-scrim,.mdc-dialog__surface-scrim--hiding .mdc-dialog__surface-scrim{display:block}.mdc-dialog-scroll-lock{overflow:hidden}.mdc-dialog--no-content-padding .mdc-dialog__content{padding:0}.mdc-dialog--sheet .mdc-dialog__container .mdc-dialog__close{right:12px;top:9px;position:absolute;z-index:1}.mdc-dialog__scrim--removed{pointer-events:none}.mdc-dialog__scrim--removed .mdc-dialog__scrim,.mdc-dialog__scrim--removed .mdc-dialog__surface-scrim{display:none}.mat-mdc-dialog-content{max-height:65vh}.mat-mdc-dialog-container{position:static;display:block}.mat-mdc-dialog-container,.mat-mdc-dialog-container .mdc-dialog__container,.mat-mdc-dialog-container .mdc-dialog__surface{max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit}.mat-mdc-dialog-container .mdc-dialog__surface{width:100%;height:100%}.mat-mdc-dialog-component-host{display:contents}.mat-mdc-dialog-container{--mdc-dialog-container-elevation: var(--mdc-dialog-container-elevation-shadow);outline:0}.mat-mdc-dialog-container .mdc-dialog__surface{background-color:var(--mdc-dialog-container-color, white)}.mat-mdc-dialog-container .mdc-dialog__surface{box-shadow:var(--mdc-dialog-container-elevation, 0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12))}.mat-mdc-dialog-container .mdc-dialog__surface{border-radius:var(--mdc-dialog-container-shape, 4px)}.mat-mdc-dialog-container .mdc-dialog__title{font-family:var(--mdc-dialog-subhead-font, Roboto, sans-serif);line-height:var(--mdc-dialog-subhead-line-height, 1.5rem);font-size:var(--mdc-dialog-subhead-size, 1rem);font-weight:var(--mdc-dialog-subhead-weight, 400);letter-spacing:var(--mdc-dialog-subhead-tracking, 0.03125em)}.mat-mdc-dialog-container .mdc-dialog__title{color:var(--mdc-dialog-subhead-color, rgba(0, 0, 0, 0.87))}.mat-mdc-dialog-container .mdc-dialog__content{font-family:var(--mdc-dialog-supporting-text-font, Roboto, sans-serif);line-height:var(--mdc-dialog-supporting-text-line-height, 1.5rem);font-size:var(--mdc-dialog-supporting-text-size, 1rem);font-weight:var(--mdc-dialog-supporting-text-weight, 400);letter-spacing:var(--mdc-dialog-supporting-text-tracking, 0.03125em)}.mat-mdc-dialog-container .mdc-dialog__content{color:var(--mdc-dialog-supporting-text-color, rgba(0, 0, 0, 0.6))}.mat-mdc-dialog-container .mdc-dialog__container{transition:opacity linear var(--mat-dialog-transition-duration, 0ms)}.mat-mdc-dialog-container .mdc-dialog__surface{transition:transform var(--mat-dialog-transition-duration, 0ms) 0ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-dialog-container._mat-animation-noopable .mdc-dialog__container,.mat-mdc-dialog-container._mat-animation-noopable .mdc-dialog__surface{transition:none}.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-max-width, 80vw);min-width:var(--mat-dialog-container-min-width, 0)}@media(max-width: 599px){.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-small-max-width, 80vw)}}.mat-mdc-dialog-title{padding:var(--mat-dialog-headline-padding, 0 24px 9px)}.mat-mdc-dialog-content{display:block}.mat-mdc-dialog-container .mat-mdc-dialog-content{padding:var(--mat-dialog-content-padding, 20px 24px)}.mat-mdc-dialog-container-with-actions .mat-mdc-dialog-content{padding:var(--mat-dialog-with-actions-content-padding, 20px 24px)}.mat-mdc-dialog-container .mat-mdc-dialog-title+.mat-mdc-dialog-content{padding-top:0}.mat-mdc-dialog-actions{padding:var(--mat-dialog-actions-padding, 8px);justify-content:var(--mat-dialog-actions-alignment, start)}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-start,.mat-mdc-dialog-actions[align=start]{justify-content:start}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-center,.mat-mdc-dialog-actions[align=center]{justify-content:center}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-end,.mat-mdc-dialog-actions[align=end]{justify-content:flex-end}.mat-mdc-dialog-actions .mat-button-base+.mat-button-base,.mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-mdc-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}'],encapsulation:2})}return n})();const n$="--mat-dialog-transition-duration";function i$(n){return null==n?null:"number"==typeof n?n:n.endsWith("ms")?ux(n.substring(0,n.length-2)):n.endsWith("s")?1e3*ux(n.substring(0,n.length-1)):"0"===n?0:null}var nB=function(n){return n[n.OPEN=0]="OPEN",n[n.CLOSING=1]="CLOSING",n[n.CLOSED=2]="CLOSED",n}(nB||{});class _x{constructor(e,t,i){this._ref=e,this._containerInstance=i,this._afterOpened=new hn,this._beforeClosed=new hn,this._state=nB.OPEN,this.disableClose=t.disableClose,this.id=e.id,e.addPanelClass("mat-mdc-dialog-panel"),i._animationStateChanged.pipe(od(r=>"opened"===r.state),ad(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),i._animationStateChanged.pipe(od(r=>"closed"===r.state),ad(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),e.overlayRef.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._finishDialogClose()}),gm(this.backdropClick(),this.keydownEvents().pipe(od(r=>27===r.keyCode&&!this.disableClose&&!bC(r)))).subscribe(r=>{this.disableClose||(r.preventDefault(),function r$(n,e,t){return n._closeInteractionType=e,n.close(t)}(this,"keydown"===r.type?"keyboard":"mouse"))})}close(e){this._result=e,this._containerInstance._animationStateChanged.pipe(od(t=>"closing"===t.state),ad(1)).subscribe(t=>{this._beforeClosed.next(e),this._beforeClosed.complete(),this._ref.overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),t.totalTime+100)}),this._state=nB.CLOSING,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._ref.closed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}updatePosition(e){let t=this._ref.config.positionStrategy;return e&&(e.left||e.right)?e.left?t.left(e.left):t.right(e.right):t.centerHorizontally(),e&&(e.top||e.bottom)?e.top?t.top(e.top):t.bottom(e.bottom):t.centerVertically(),this._ref.updatePosition(),this}updateSize(e="",t=""){return this._ref.updateSize(e,t),this}addPanelClass(e){return this._ref.addPanelClass(e),this}removePanelClass(e){return this._ref.removePanelClass(e),this}getState(){return this._state}_finishDialogClose(){this._state=nB.CLOSED,this._ref.close(this._result,{focusOrigin:this._closeInteractionType}),this.componentInstance=null}}const pL=new Bi("MatMdcDialogData"),Fve=new Bi("mat-mdc-dialog-default-options"),s$=new Bi("mat-mdc-dialog-scroll-strategy",{providedIn:"root",factory:()=>{const n=pi(pu);return()=>n.scrollStrategies.block()}});let Lve=0,yx=(()=>{class n{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const t=this._parentDialog;return t?t._getAfterAllClosed():this._afterAllClosedAtThisLevel}constructor(t,i,r,s,a,l,d,u){this._overlay=t,this._defaultOptions=s,this._scrollStrategy=a,this._parentDialog=l,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new hn,this._afterOpenedAtThisLevel=new hn,this.dialogConfigClass=hL,this.afterAllClosed=wD(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(sA(void 0))),this._dialog=i.get(Zj),this._dialogRefConstructor=_x,this._dialogContainerType=t$,this._dialogDataToken=pL}open(t,i){let r;(i={...this._defaultOptions||new hL,...i}).id=i.id||"mat-mdc-dialog-"+Lve++,i.scrollStrategy=i.scrollStrategy||this._scrollStrategy();const s=this._dialog.open(t,{...i,positionStrategy:this._overlay.position().global().centerHorizontally().centerVertically(),disableClose:!0,closeOnDestroy:!1,closeOnOverlayDetachments:!1,container:{type:this._dialogContainerType,providers:()=>[{provide:this.dialogConfigClass,useValue:i},{provide:tB,useValue:i}]},templateContext:()=>({dialogRef:r}),providers:(a,l,d)=>(r=new this._dialogRefConstructor(a,i,d),r.updatePosition(i?.position),[{provide:this._dialogContainerType,useValue:d},{provide:this._dialogDataToken,useValue:l.data},{provide:this._dialogRefConstructor,useValue:r}])});return r.componentRef=s.componentRef,r.componentInstance=s.componentInstance,this.openDialogs.push(r),this.afterOpened.next(r),r.afterClosed().subscribe(()=>{const a=this.openDialogs.indexOf(r);a>-1&&(this.openDialogs.splice(a,1),this.openDialogs.length||this._getAfterAllClosed().next())}),r}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(t){return this.openDialogs.find(i=>i.id===t)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_closeDialogs(t){let i=t.length;for(;i--;)t[i].close()}static#e=this.\u0275fac=function(i){return new(i||n)(xi(pu),xi(Al),xi(_b,8),xi(Fve,8),xi(s$),xi(n,12),xi(O4),xi(Od,8))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Nve=0,o$=(()=>{class n{constructor(t,i,r){this._dialogRef=t,this._elementRef=i,this._dialog=r}ngOnInit(){this._dialogRef||(this._dialogRef=function a$(n,e){let t=n.nativeElement.parentElement;for(;t&&!t.classList.contains("mat-mdc-dialog-container");)t=t.parentElement;return t?e.find(i=>i.id===t.id):null}(this._elementRef,this._dialog.openDialogs)),this._dialogRef&&Promise.resolve().then(()=>{this._onAdd()})}ngOnDestroy(){this._dialogRef?._containerInstance&&Promise.resolve().then(()=>{this._onRemove()})}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(_x,8),Lt(oo),Lt(yx))};static#t=this.\u0275dir=Ft({type:n,standalone:!0})}return n})(),jE=(()=>{class n extends o${constructor(){super(...arguments),this.id="mat-mdc-dialog-title-"+Nve++}_onAdd(){this._dialogRef._containerInstance?._addAriaLabelledBy?.(this.id)}_onRemove(){this._dialogRef?._containerInstance?._removeAriaLabelledBy?.(this.id)}static#e=this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Ca(n)))(r||n)}})();static#t=this.\u0275dir=Ft({type:n,selectors:[["","mat-dialog-title",""],["","matDialogTitle",""]],hostAttrs:[1,"mat-mdc-dialog-title","mdc-dialog__title"],hostVars:1,hostBindings:function(i,r){2&i&&Hw("id",r.id)},inputs:{id:"id"},exportAs:["matDialogTitle"],standalone:!0,features:[Lo]})}return n})(),$E=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275dir=Ft({type:n,selectors:[["","mat-dialog-content",""],["mat-dialog-content"],["","matDialogContent",""]],hostAttrs:[1,"mat-mdc-dialog-content","mdc-dialog__content"],standalone:!0})}return n})(),XE=(()=>{class n extends o${_onAdd(){this._dialogRef._containerInstance?._updateActionSectionCount?.(1)}_onRemove(){this._dialogRef._containerInstance?._updateActionSectionCount?.(-1)}static#e=this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Ca(n)))(r||n)}})();static#t=this.\u0275dir=Ft({type:n,selectors:[["","mat-dialog-actions",""],["mat-dialog-actions"],["","matDialogActions",""]],hostAttrs:[1,"mat-mdc-dialog-actions","mdc-dialog__actions"],hostVars:6,hostBindings:function(i,r){2&i&&Ja("mat-mdc-dialog-actions-align-start","start"===r.align)("mat-mdc-dialog-actions-align-center","center"===r.align)("mat-mdc-dialog-actions-align-end","end"===r.align)},inputs:{align:"align"},standalone:!0,features:[Lo]})}return n})();let zve=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({providers:[yx],imports:[Bve,NE,k4,Wd,Wd]})}return n})();const Hve=["mat-button",""],Vve=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],Gve=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"],jve=new Bi("MAT_BUTTON_CONFIG"),$ve=[{attribute:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{attribute:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{attribute:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{attribute:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{attribute:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{attribute:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{attribute:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}];let c$=(()=>{class n{get ripple(){return this._rippleLoader?.getRipple(this._elementRef.nativeElement)}set ripple(t){this._rippleLoader?.attachRipple(this._elementRef.nativeElement,t)}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=t,this._updateRippleDisabled()}get disabled(){return this._disabled}set disabled(t){this._disabled=t,this._updateRippleDisabled()}constructor(t,i,r,s){this._elementRef=t,this._platform=i,this._ngZone=r,this._animationMode=s,this._focusMonitor=pi(J_),this._rippleLoader=pi(f_e),this._isFab=!1,this._disableRipple=!1,this._disabled=!1;const a=pi(jve,{optional:!0}),l=t.nativeElement,d=l.classList;this.disabledInteractive=a?.disabledInteractive??!1,this._rippleLoader?.configureRipple(l,{className:"mat-mdc-button-ripple"});for(const{attribute:u,mdcClasses:p}of $ve)l.hasAttribute(u)&&d.add(...p)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._rippleLoader?.destroyRipple(this._elementRef.nativeElement)}focus(t="program",i){t?this._focusMonitor.focusVia(this._elementRef.nativeElement,t,i):this._elementRef.nativeElement.focus(i)}_getAriaDisabled(){return null!=this.ariaDisabled?this.ariaDisabled:!(!this.disabled||!this.disabledInteractive)||null}_getDisabledAttribute(){return!(this.disabledInteractive||!this.disabled)||null}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}static#e=this.\u0275fac=function(i){pM()};static#t=this.\u0275dir=Ft({type:n,inputs:{color:"color",disableRipple:[mi.HasDecoratorInputTransform,"disableRipple","disableRipple",_o],disabled:[mi.HasDecoratorInputTransform,"disabled","disabled",_o],ariaDisabled:[mi.HasDecoratorInputTransform,"aria-disabled","ariaDisabled",_o],disabledInteractive:[mi.HasDecoratorInputTransform,"disabledInteractive","disabledInteractive",_o]},features:[ql]})}return n})(),BC=(()=>{class n extends c${constructor(t,i,r,s){super(t,i,r,s)}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(oo),Lt(dd),Lt(io),Lt(Od,8))};static#t=this.\u0275cmp=Zr({type:n,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:14,hostBindings:function(i,r){2&i&&(sl("disabled",r._getDisabledAttribute())("aria-disabled",r._getAriaDisabled()),B_(r.color?"mat-"+r.color:""),Ja("mat-mdc-button-disabled",r.disabled)("mat-mdc-button-disabled-interactive",r.disabledInteractive)("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mat-unthemed",!r.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],standalone:!0,features:[Lo,yd],attrs:Hve,ngContentSelectors:Gve,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(i,r){1&i&&(vh(Vve),Fr(0,"span",0),ru(1),zt(2,"span",1),ru(3,1),an(),ru(4,2),Fr(5,"span",2)(6,"span",3)),2&i&&Ja("mdc-button__ripple",!r._isFab)("mdc-fab__ripple",r._isFab)},styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button{position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;user-select:none;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0)}.mdc-button .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top}[dir=rtl] .mdc-button .mdc-button__icon,.mdc-button .mdc-button__icon[dir=rtl]{margin-left:8px;margin-right:0}.mdc-button .mdc-button__progress-indicator{font-size:0;position:absolute;transform:translate(-50%, -50%);top:50%;left:50%;line-height:initial}.mdc-button .mdc-button__label{position:relative}.mdc-button .mdc-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px);display:none}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring{border-color:CanvasText}}.mdc-button .mdc-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring::after{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring{display:block}}.mdc-button .mdc-button__touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:0}[dir=rtl] .mdc-button__label+.mdc-button__icon,.mdc-button__label+.mdc-button__icon[dir=rtl]{margin-left:0;margin-right:8px}svg.mdc-button__icon{fill:currentColor}.mdc-button--touch{margin-top:6px;margin-bottom:6px}.mdc-button{padding:0 8px 0 8px}.mdc-button--unelevated{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--unelevated.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--unelevated.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--raised{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--raised.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--raised.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--outlined{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button--outlined .mdc-button__ripple{border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button{font-family:var(--mdc-text-button-label-text-font);font-size:var(--mdc-text-button-label-text-size);letter-spacing:var(--mdc-text-button-label-text-tracking);font-weight:var(--mdc-text-button-label-text-weight);text-transform:var(--mdc-text-button-label-text-transform);height:var(--mdc-text-button-container-height);border-radius:var(--mdc-text-button-container-shape);padding:0 var(--mat-text-button-horizontal-padding, 8px)}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color)}.mat-mdc-button:disabled{color:var(--mdc-text-button-disabled-label-text-color)}.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape)}.mat-mdc-button:has(.material-icons,mat-icon,[matButtonIcon]){padding:0 var(--mat-text-button-with-icon-horizontal-padding, 8px)}.mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}[dir=rtl] .mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}.mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}.mat-mdc-button .mat-ripple-element{background-color:var(--mat-text-button-ripple-color)}.mat-mdc-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-state-layer-color)}.mat-mdc-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-disabled-state-layer-color)}.mat-mdc-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-hover-state-layer-opacity)}.mat-mdc-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-focus-state-layer-opacity)}.mat-mdc-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-pressed-state-layer-opacity)}.mat-mdc-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-text-button-touch-target-display)}.mat-mdc-button[disabled],.mat-mdc-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-text-button-disabled-label-text-color)}.mat-mdc-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-unelevated-button{font-family:var(--mdc-filled-button-label-text-font);font-size:var(--mdc-filled-button-label-text-size);letter-spacing:var(--mdc-filled-button-label-text-tracking);font-weight:var(--mdc-filled-button-label-text-weight);text-transform:var(--mdc-filled-button-label-text-transform);height:var(--mdc-filled-button-container-height);border-radius:var(--mdc-filled-button-container-shape);padding:0 var(--mat-filled-button-horizontal-padding, 16px)}.mat-mdc-unelevated-button:not(:disabled){background-color:var(--mdc-filled-button-container-color)}.mat-mdc-unelevated-button:disabled{background-color:var(--mdc-filled-button-disabled-container-color)}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color)}.mat-mdc-unelevated-button:disabled{color:var(--mdc-filled-button-disabled-label-text-color)}.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape)}.mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}.mat-mdc-unelevated-button .mat-ripple-element{background-color:var(--mat-filled-button-ripple-color)}.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-state-layer-color)}.mat-mdc-unelevated-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-disabled-state-layer-color)}.mat-mdc-unelevated-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-hover-state-layer-opacity)}.mat-mdc-unelevated-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-focus-state-layer-opacity)}.mat-mdc-unelevated-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-pressed-state-layer-opacity)}.mat-mdc-unelevated-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-filled-button-touch-target-display)}.mat-mdc-unelevated-button[disabled],.mat-mdc-unelevated-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-filled-button-disabled-label-text-color);background-color:var(--mdc-filled-button-disabled-container-color)}.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-raised-button{font-family:var(--mdc-protected-button-label-text-font);font-size:var(--mdc-protected-button-label-text-size);letter-spacing:var(--mdc-protected-button-label-text-tracking);font-weight:var(--mdc-protected-button-label-text-weight);text-transform:var(--mdc-protected-button-label-text-transform);height:var(--mdc-protected-button-container-height);border-radius:var(--mdc-protected-button-container-shape);padding:0 var(--mat-protected-button-horizontal-padding, 16px);box-shadow:var(--mdc-protected-button-container-elevation-shadow)}.mat-mdc-raised-button:not(:disabled){background-color:var(--mdc-protected-button-container-color)}.mat-mdc-raised-button:disabled{background-color:var(--mdc-protected-button-disabled-container-color)}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color)}.mat-mdc-raised-button:disabled{color:var(--mdc-protected-button-disabled-label-text-color)}.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape)}.mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}.mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}.mat-mdc-raised-button .mat-ripple-element{background-color:var(--mat-protected-button-ripple-color)}.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-state-layer-color)}.mat-mdc-raised-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-disabled-state-layer-color)}.mat-mdc-raised-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-hover-state-layer-opacity)}.mat-mdc-raised-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-focus-state-layer-opacity)}.mat-mdc-raised-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-pressed-state-layer-opacity)}.mat-mdc-raised-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-protected-button-touch-target-display)}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation-shadow)}.mat-mdc-raised-button:focus{box-shadow:var(--mdc-protected-button-focus-container-elevation-shadow)}.mat-mdc-raised-button:active,.mat-mdc-raised-button:focus:active{box-shadow:var(--mdc-protected-button-pressed-container-elevation-shadow)}.mat-mdc-raised-button[disabled],.mat-mdc-raised-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-protected-button-disabled-label-text-color);background-color:var(--mdc-protected-button-disabled-container-color)}.mat-mdc-raised-button[disabled].mat-mdc-button-disabled,.mat-mdc-raised-button.mat-mdc-button-disabled.mat-mdc-button-disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation-shadow)}.mat-mdc-raised-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button{font-family:var(--mdc-outlined-button-label-text-font);font-size:var(--mdc-outlined-button-label-text-size);letter-spacing:var(--mdc-outlined-button-label-text-tracking);font-weight:var(--mdc-outlined-button-label-text-weight);text-transform:var(--mdc-outlined-button-label-text-transform);height:var(--mdc-outlined-button-container-height);border-radius:var(--mdc-outlined-button-container-shape);padding:0 15px 0 15px;border-width:var(--mdc-outlined-button-outline-width);padding:0 var(--mat-outlined-button-horizontal-padding, 15px)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color)}.mat-mdc-outlined-button:disabled{color:var(--mdc-outlined-button-disabled-label-text-color)}.mat-mdc-outlined-button .mdc-button__ripple{border-radius:var(--mdc-outlined-button-container-shape)}.mat-mdc-outlined-button:not(:disabled){border-color:var(--mdc-outlined-button-outline-color)}.mat-mdc-outlined-button:disabled{border-color:var(--mdc-outlined-button-disabled-outline-color)}.mat-mdc-outlined-button.mdc-button--icon-trailing{padding:0 11px 0 15px}.mat-mdc-outlined-button.mdc-button--icon-leading{padding:0 15px 0 11px}.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:var(--mdc-outlined-button-outline-width)}.mat-mdc-outlined-button .mdc-button__touch{left:calc(-1 * var(--mdc-outlined-button-outline-width));width:calc(100% + 2 * var(--mdc-outlined-button-outline-width))}.mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-outlined-button-ripple-color)}.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-state-layer-color)}.mat-mdc-outlined-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-disabled-state-layer-color)}.mat-mdc-outlined-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-hover-state-layer-opacity)}.mat-mdc-outlined-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-focus-state-layer-opacity)}.mat-mdc-outlined-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-pressed-state-layer-opacity)}.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-outlined-button-touch-target-display)}.mat-mdc-outlined-button[disabled],.mat-mdc-outlined-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-outlined-button-disabled-label-text-color);border-color:var(--mdc-outlined-button-disabled-outline-color)}.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-button-base{text-decoration:none}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-button .mdc-button__label,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-outlined-button .mdc-button__label{z-index:1}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px)*-1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0})}return n})(),Kve=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({imports:[Wd,P4,Wd]})}return n})();function Zve(n,e){if(1&n){const t=ta();ng(0),zt(1,"input",30,5),Ai("change",function(r){return Mi(Ci(t).$implicit.handler(r.target.files))}),an(),zt(3,"button",13),Ai("click",function(){return Ci(t),Mi(Ga(2).click())}),Fr(4,"img",31),Fi(5),an(),ig()}if(2&n){const t=e.$implicit;Vn(),Hn("accept",t.accept),Vn(4),yl(" Load ",t.fileType," ")}}function Jve(n,e){if(1&n&&(zt(0,"div")(1,"p",10)(2,"b"),Fi(3,"Event data"),an()(),zt(4,"div",11),zs(5,Zve,6,2,"ng-container",29),an()()),2&n){const t=Pr();Vn(5),Hn("ngForOf",t.eventDataOptionsWithHandler)}}let d$=(()=>{class n{eventDisplay;dialogRef;eventDataImportOptions=[Yu.JSON];eventDataOptionsWithHandler;supportedEventDataFormats=[new cx(Yu.JSON,".json",this.handleJSONEventDataInput.bind(this),"application/json"),new cx(Yu.EDM4HEPJSON,".edm4hep.json",this.handleEDM4HEPJSONEventDataInput.bind(this),"application/json"),new cx(Yu.JIVEXML,".xml",this.handleJiveXMLDataInput.bind(this),"text/xml"),new cx(Yu.ZIP,".zip",this.handleZipEventDataInput.bind(this),".zip"),new cx(Yu.IG,".ig",this.handleIgEventDataInput.bind(this),".ig")];constructor(t,i){this.eventDisplay=t,this.dialogRef=i}ngOnInit(){this.eventDataOptionsWithHandler=this.supportedEventDataFormats.filter(t=>this.eventDataImportOptions.includes(t.format)),this.eventDataImportOptions.forEach(t=>{if(t instanceof cx){const i=t.handler.bind(this);t.handler=r=>{i(r),this.onClose()},this.eventDataOptionsWithHandler.push(t)}})}getSupportedEventDataFormats(){return this.eventDataImportOptions.map(t=>t instanceof cx?t.format:t).filter(t=>"ZIP"!==t).join(", ")}onClose(){this.dialogRef.close()}handleJSONEventDataInput(t){this.handleFileInput(t[0],"json",r=>{const s="string"==typeof r?JSON.parse(r):r;this.eventDisplay.parsePhoenixEvents(s)})}handleEDM4HEPJSONEventDataInput(t){this.handleFileInput(t[0],"json",r=>{const s="string"==typeof r?JSON.parse(r):r,a=new Oge;a.setRawEventData(s),a.processEventData(),this.eventDisplay.parsePhoenixEvents(a.getEventData())})}handleJiveXMLDataInput(t){this.handleFileInput(t[0],"xml",r=>{const s=new CE;s.process(r);const a=s.getEventData();this.eventDisplay.buildEventDataFromJSON(a)})}handleOBJInput(t){this.handleFileInput(t[0],"obj",(r,s)=>{this.eventDisplay.parseOBJGeometry(r,s)})}handleSceneInput(t){this.handleFileInput(t[0],"phnx",r=>{this.eventDisplay.parsePhoenixDisplay(r)})}handleGLTFInput(t){this.handleFileInput(t[0],"gltf,glb,gltf.zip,glb.zip",r=>{this.eventDisplay.parseGLTFGeometry(r)})}handlePhoenixInput(t){this.handleFileInput(t[0],"phnx",r=>{this.eventDisplay.parsePhoenixDisplay(r)})}handleROOTInput(t){var i=this;return(0,Ee.A)(function*(){const r=prompt("Enter object name in ROOT file");yield i.eventDisplay.loadRootGeometry(URL.createObjectURL(t[0]),r,t[0].name.split(".")[0]),i.onClose()})()}handleRootJSONInput(t){var i=this;return(0,Ee.A)(function*(){if(!i.isFileOfExtension(t[0].name,"gz"))return;const r=t[0].name.split(".")[0];yield i.eventDisplay.loadRootJSONGeometry(URL.createObjectURL(t[0]),r),i.onClose()})()}handleIgEventDataInput(t){const i=new mQ;i.readIgArchive(t[0],r=>{const s=i.getAllEventsData(r);this.eventDisplay.parsePhoenixEvents(s),this.onClose()})}handleZipEventDataInput(t){var i=this;return(0,Ee.A)(function*(){if(!i.isFileOfExtension(t[0].name,"zip"))return;const r={};let s;try{s=yield pQ(t[0])}catch(l){return console.error("Error while reading zip",l),void i.eventDisplay.getInfoLogger().add("Could not read zip file","Error")}Object.keys(s).filter(l=>l.endsWith(".json")).forEach(l=>{Object.assign(r,JSON.parse(s[l]))});const a=new CE;Object.keys(s).filter(l=>l.endsWith(".xml")||l.startsWith("JiveXML")).forEach(l=>{a.process(s[l]);const d=a.getEventData();Object.assign(r,{[l]:d})}),i.eventDisplay.parsePhoenixEvents(r),i.onClose()})()}handleFileInput(t,i,r){const s=new FileReader;this.isFileOfExtension(t.name,i)&&(s.onload=()=>{r(s.result.toString(),t.name.split(".")[0])},s.readAsText(t)),this.onClose()}isFileOfExtension(t,i){const r=i.toLowerCase().split(",").map(l=>l.trim()),s=t.lastIndexOf(".");if(-1===s)return console.error("Error: No file extension found!"),this.eventDisplay.getInfoLogger().add("No file extension found!","Error"),!1;const a=t.slice(s+1).toLowerCase();return!!r.includes(a)||(console.error("Error: Invalid file format!"),this.eventDisplay.getInfoLogger().add("Invalid file format!","Error"),!1)}saveScene(){this.eventDisplay.exportPhoenixDisplay()}exportOBJ(){this.eventDisplay.exportToOBJ()}exportGeometries(){this.eventDisplay.exportGeometriesToGLTF()}static \u0275fac=function(i){return new(i||n)(Lt(pl),Lt(_x))};static \u0275cmp=Zr({type:n,selectors:[["app-io-options-dialog"]],inputs:{eventDataImportOptions:"eventDataImportOptions"},decls:50,vars:1,consts:[["objFileInput",""],["gltfFileInput",""],["rootFileInput",""],["rootJSONFileInput",""],["loadSceneInput",""],["eventDataFileInput",""],[1,"dialog"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-content"],[4,"ngIf"],[1,"text-center"],[1,"row","centered"],["type","file","tabindex","-1","accept",".obj","name","image",1,"file-input",3,"change"],[1,"file-input-button",3,"click"],["src","assets/icons/obj.svg","alt",""],["type","file","tabindex","-1","accept",".gltf,.glb,.gltf.zip,.glb.zip","name","image",1,"file-input",3,"change"],["src","assets/icons/gltf.svg","alt",""],["type","file","tabindex","-1","accept",".root",1,"file-input",3,"change"],["src","assets/icons/file-import.svg","alt",""],["type","file","tabindex","-1","accept",".json.gz",1,"file-input",3,"change"],["id","exportScene",1,"file-input-button","load-export",3,"click"],["src","assets/icons/save.svg","alt",""],["type","file","tabindex","-1","accept",".phnx","name","image",1,"file-input",3,"change"],["id","importScene",1,"file-input-button","load-export",3,"click"],["src","assets/icons/upload.svg","alt",""],["id","exportOBJ",1,"file-input-button","export-button",3,"click"],["id","exportGeometries",1,"file-input-button","export-button",3,"click"],["mat-dialog-actions","","align","end"],["mat-flat-button","","color","primary","cdkFocusInitial","",3,"click"],[4,"ngFor","ngForOf"],["type","file","tabindex","-1",1,"file-input",3,"change","accept"],["src","assets/icons/eventData.svg","alt","Event data icon"]],template:function(i,r){if(1&i){const s=ta();zt(0,"div",6)(1,"h1",7),Fi(2,"Import and export"),an(),zt(3,"div",8),zs(4,Jve,6,1,"div",9),zt(5,"p",10)(6,"b"),Fi(7,"Geometries"),an()(),zt(8,"div",11)(9,"input",12,0),Ai("change",function(l){return Ci(s),Mi(r.handleOBJInput(l.target.files))}),an(),zt(11,"button",13),Ai("click",function(){return Ci(s),Mi(Ga(10).click())}),Fr(12,"img",14),Fi(13," Load .obj "),an(),zt(14,"input",15,1),Ai("change",function(l){return Ci(s),Mi(r.handleGLTFInput(l.target.files))}),an(),zt(16,"button",13),Ai("click",function(){return Ci(s),Mi(Ga(15).click())}),Fr(17,"img",16),Fi(18," Load .gltf/.glb "),an(),zt(19,"input",17,2),Ai("change",function(l){return Ci(s),Mi(r.handleROOTInput(l.target.files))}),an(),zt(21,"button",13),Ai("click",function(){return Ci(s),Mi(Ga(20).click())}),Fr(22,"img",18),Fi(23," Load .root "),an(),zt(24,"input",19,3),Ai("change",function(l){return Ci(s),Mi(r.handleRootJSONInput(l.target.files))}),an(),zt(26,"button",13),Ai("click",function(){return Ci(s),Mi(Ga(25).click())}),Fr(27,"img",18),Fi(28," Load .json.gz "),an()(),zt(29,"p",10)(30,"b"),Fi(31,"Scene"),an()(),zt(32,"div",11)(33,"button",20),Ai("click",function(){return Ci(s),Mi(r.saveScene())}),Fr(34,"img",21),Fi(35," Save scene "),an(),zt(36,"input",22,4),Ai("change",function(l){return Ci(s),Mi(r.handlePhoenixInput(l.target.files))}),an(),zt(38,"button",23),Ai("click",function(){return Ci(s),Mi(Ga(37).click())}),Fr(39,"img",24),Fi(40," Load scene "),an(),zt(41,"button",25),Ai("click",function(){return Ci(s),Mi(r.exportOBJ())}),Fr(42,"img",14),Fi(43," Save OBJ "),an(),zt(44,"button",26),Ai("click",function(){return Ci(s),Mi(r.exportGeometries())}),Fr(45,"img",16),Fi(46," Save Geometries "),an()()(),zt(47,"div",27)(48,"button",28),Ai("click",function(){return Ci(s),Mi(r.onClose())}),Fi(49," Close "),an()()()}2&i&&(Vn(4),Hn("ngIf",r.eventDataImportOptions.length>0))},dependencies:[am,Lh,jE,XE,$E,BC],styles:[".row[_ngcontent-%COMP%]{justify-content:center;margin:1rem 0}.file-input[_ngcontent-%COMP%]{width:.1px;height:.1px;opacity:0;overflow:hidden;position:absolute;z-index:-1}.file-input-button[_ngcontent-%COMP%]{font-size:1em;font-weight:700;color:#fff;background-color:#6eaece;padding:1em .5em;border:none;border-radius:10px;width:8rem;margin:0 .4rem}.file-input-button.load-export[_ngcontent-%COMP%]{padding:.8em .2em;width:7rem}.file-input-button.load-export[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:1.2em}.file-input-button.export-button[_ngcontent-%COMP%]{background-color:#cb7133}.file-input-button.export-button[_ngcontent-%COMP%]:hover{background-color:#ad5b2d}.file-input-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:2em;display:block;width:100%}.file-input-button[_ngcontent-%COMP%]:hover{background-color:#118ab2}#exportScene[_ngcontent-%COMP%]{background-color:#5bd99e}#exportScene[_ngcontent-%COMP%]:hover{background-color:#05c292}#importScene[_ngcontent-%COMP%]{background-color:#ecc25e}#importScene[_ngcontent-%COMP%]:hover{background-color:#d6b44d}"]})}return n})(),mL=(()=>{class n{dialog;eventDataImportOptions=Object.values(Yu);constructor(t){this.dialog=t}openIODialog(){this.dialog.open(d$,{panelClass:"dialog"}).componentInstance.eventDataImportOptions=this.eventDataImportOptions}static \u0275fac=function(i){return new(i||n)(Lt(yx))};static \u0275cmp=Zr({type:n,selectors:[["app-io-options"]],inputs:{eventDataImportOptions:"eventDataImportOptions"},decls:1,vars:1,consts:[["tooltip","Import and export options","icon","import",3,"click","active"]],template:function(i,r){1&i&&(zt(0,"app-menu-toggle",0),Ai("click",function(){return r.openIODialog()}),an()),2&i&&Hn("active",!1)},dependencies:[qc]})}return n})();const ebe=["overlayWindow"];let u$=(()=>{class n{eventDisplay;showOverlay=!0;transparentBody=!1;orthographicView=!1;overlayViewFixed=!1;overlayWindow;constructor(t){this.eventDisplay=t}ngAfterViewInit(){const t=this.initializeCanvas(this.overlayWindow.nativeElement);this.eventDisplay.setOverlayRenderer(t)}initializeCanvas(t){const i=window.innerWidth/2.5,r=window.innerHeight/2.5;return t.width=i,t.height=r,t.style.width=i.toString()+" px",t.style.height=r.toString()+" px",t}switchOverlayView(){this.orthographicView=!this.orthographicView,this.eventDisplay.getUIManager().toggleOrthographicView(this.orthographicView)}fixOverlayView(){this.overlayViewFixed=!this.overlayViewFixed,this.eventDisplay.fixOverlayView(this.overlayViewFixed)}toggleBgTransparency(){this.transparentBody=!this.transparentBody}static \u0275fac=function(i){return new(i||n)(Lt(pl))};static \u0275cmp=Zr({type:n,selectors:[["app-overlay-view-window"]],viewQuery:function(i,r){if(1&i&&_l(ebe,5),2&i){let s;pa(s=ma())&&(r.overlayWindow=s.first)}},inputs:{showOverlay:"showOverlay"},decls:8,vars:9,consts:[["overlayWindow",""],["overlayTitle","Overlay View","icon","overlay",3,"resizable","transparentBody","active","keepAspectRatioFixed"],[1,"overlay-view-wrapper"],["id","overlay-canvas",3,"hidden"],[1,"overlay-view-controls","position-absolute","d-flex","flex-row"],["icon","transparent","matTooltip","Toggle background transparency",1,"overlay-view-control",3,"click"],["icon","move-lock",1,"overlay-view-control",3,"click","matTooltip","active"],[1,"overlay-view-control",3,"click","icon","matTooltip"]],template:function(i,r){if(1&i){const s=ta();zt(0,"app-overlay",1)(1,"div",2),Fr(2,"canvas",3,0),zt(4,"div",4)(5,"app-menu-toggle",5),Ai("click",function(){return Ci(s),Mi(r.toggleBgTransparency())}),an(),zt(6,"app-menu-toggle",6),Ai("click",function(){return Ci(s),Mi(r.fixOverlayView())}),an(),zt(7,"app-menu-toggle",7),Ai("click",function(){return Ci(s),Mi(r.switchOverlayView())}),an()()()()}2&i&&(Hn("resizable",!0)("transparentBody",r.transparentBody)("active",r.showOverlay)("keepAspectRatioFixed",!0),Vn(2),Hn("hidden",!r.showOverlay),Vn(4),Hn("matTooltip",(r.overlayViewFixed?"Restore":"Fix")+" overlay view")("active",r.overlayViewFixed),Vn(),Hn("icon",r.orthographicView?"orthographic":"perspective")("matTooltip","Switch to "+(r.orthographicView?"orthographic":"perspective")+" view"))},dependencies:[o1,qc,IC],styles:["#overlay-canvas[_ngcontent-%COMP%]{background-color:#0000001a;width:100%}.overlay-view-controls[_ngcontent-%COMP%]{bottom:1em;right:1em;opacity:0;transition:opacity .2s}.overlay-view-controls[_ngcontent-%COMP%]   .overlay-view-control[_ngcontent-%COMP%]{background:var(--phoenix-background-color-secondary);box-shadow:var(--phoenix-box-shadow);overflow:hidden;width:2.5rem;height:2.5rem;border-radius:50%;display:flex;justify-content:center;align-items:center}.overlay-view-wrapper[_ngcontent-%COMP%]:hover   .overlay-view-controls[_ngcontent-%COMP%]{opacity:1;transition:opacity .2s}"]})}return n})(),AL=(()=>{class n{overlay;overlayWindow;showOverlay=!1;constructor(t){this.overlay=t}ngOnInit(){const t=this.overlay.create(),i=new e1(u$);this.overlayWindow=t.attach(i),this.overlayWindow.instance.showOverlay=this.showOverlay}ngOnDestroy(){this.overlayWindow.destroy()}toggleOverlay(){this.showOverlay=!this.showOverlay,this.overlayWindow.instance.showOverlay=this.showOverlay}static \u0275fac=function(i){return new(i||n)(Lt(pu))};static \u0275cmp=Zr({type:n,selectors:[["app-overlay-view"]],decls:1,vars:1,consts:[["tooltip","Overlay view","icon","overlay",3,"click","active"]],template:function(i,r){1&i&&(zt(0,"app-menu-toggle",0),Ai("click",function(){return r.toggleOverlay()}),an()),2&i&&Hn("active",r.showOverlay)},dependencies:[qc]})}return n})(),h$=(()=>{class n{transform(t,i){let r="";return Array.isArray(t)?(r+="\n",t.forEach(s=>r+=s+"\n")):r=t.toString(),r}static \u0275fac=function(i){return new(i||n)};static \u0275pipe=Ic({name:"attributePipe",type:n,pure:!0})}return n})();function tbe(n,e){if(1&n&&(zt(0,"div",4)(1,"strong"),Fi(2),an(),Fi(3),sS(4,"attributePipe"),an()),2&n){const t=e.$implicit;Vn(2),tA(t.attributeName),Vn(),yl(" : ",function G6(n,e,t){const i=n+Cs,r=Zi(),s=km(r,i);return oS(r,i)?N6(r,Yc(),e,s.transform,t,s):s.transform(t)}(4,2,t.attributeValue)," ")}}function nbe(n,e){if(1&n&&(zt(0,"div",2),zs(1,tbe,5,4,"div",3),an()),2&n){const t=Pr();Vn(),Hn("ngForOf",t.selectedObject.attributes)}}let f$=(()=>{class n{eventDisplay;hiddenSelectedInfo;selectedObject={name:"Object",attributes:[]};constructor(t){this.eventDisplay=t}ngOnInit(){this.eventDisplay.allowSelection(this.selectedObject)}static \u0275fac=function(i){return new(i||n)(Lt(pl))};static \u0275cmp=Zr({type:n,selectors:[["app-object-selection-overlay"]],inputs:{hiddenSelectedInfo:"hiddenSelectedInfo"},decls:2,vars:3,consts:[["icon","cursor",3,"overlayTitle","active"],["id","selectedObjectPanelBody","class","m-1",4,"ngIf"],["id","selectedObjectPanelBody",1,"m-1"],["class","attributeField",4,"ngFor","ngForOf"],[1,"attributeField"]],template:function(i,r){1&i&&(zt(0,"app-overlay",0),zs(1,nbe,2,1,"div",1),an()),2&i&&(Hn("overlayTitle",r.selectedObject.name)("active",!r.hiddenSelectedInfo),Vn(),Hn("ngIf",r.selectedObject.attributes.length>0))},dependencies:[am,Lh,IC,h$],styles:["#selectedObjectPanelBody[_ngcontent-%COMP%]{padding:0 .8em;overflow:auto;max-width:300px;max-height:16rem;min-width:7rem}"]})}return n})(),gL=(()=>{class n{overlay;eventDisplay;hiddenSelectedInfo=!0;overlayWindow;constructor(t,i){this.overlay=t,this.eventDisplay=i}ngOnInit(){const t=this.overlay.create(),i=new e1(f$);this.overlayWindow=t.attach(i),this.overlayWindow.instance.hiddenSelectedInfo=this.hiddenSelectedInfo}ngOnDestroy(){this.overlayWindow.destroy()}toggleOverlay(){this.hiddenSelectedInfo=!this.hiddenSelectedInfo,this.overlayWindow.instance.hiddenSelectedInfo=this.hiddenSelectedInfo,this.eventDisplay.enableSelecting(!this.hiddenSelectedInfo)}static \u0275fac=function(i){return new(i||n)(Lt(pu),Lt(pl))};static \u0275cmp=Zr({type:n,selectors:[["app-object-selection"]],decls:1,vars:1,consts:[["tooltip","Object selection","icon","cursor",3,"click","active"]],template:function(i,r){1&i&&(zt(0,"app-menu-toggle",0),Ai("click",function(){return r.toggleOverlay()}),an()),2&i&&Hn("active",!r.hiddenSelectedInfo)},dependencies:[qc]})}return n})();function ibe(n,e){if(1&n&&(zt(0,"option",4),Fi(1),an()),2&n){const t=e.$implicit;Hn("value",t),Vn(),yl(" ",t," ")}}function rbe(n,e){if(1&n){const t=ta();zt(0,"div",1)(1,"select",2),Ai("change",function(r){return Ci(t),Mi(Pr().changeEvent(r))}),zs(2,ibe,2,2,"option",3),an()()}if(2&n){const t=Pr();Vn(2),Hn("ngForOf",t.events)}}let _L=(()=>{class n{eventDisplay;events;constructor(t){this.eventDisplay=t}ngOnInit(){this.eventDisplay.listenToLoadedEventsChange(t=>this.events=t)}changeEvent(t){this.eventDisplay.loadEvent(t.target.value)}static \u0275fac=function(i){return new(i||n)(Lt(pl))};static \u0275cmp=Zr({type:n,selectors:[["app-event-selector"]],decls:1,vars:1,consts:[["class","eventSelector mx-2","matTooltip","Event selector","matTooltipPosition","above",4,"ngIf"],["matTooltip","Event selector","matTooltipPosition","above",1,"eventSelector","mx-2"],["name","event",3,"change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(i,r){1&i&&zs(0,rbe,3,1,"div",0),2&i&&Hn("ngIf",null!=r.events)},dependencies:[am,Lh,o1,EC,TC],styles:[".eventSelector[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:9rem;padding:5px 10px;font-size:12px;border:1px solid rgba(88,88,88,.08);box-shadow:var(--phoenix-icon-shadow);background-color:var(--phoenix-background-color-tertiary);color:var(--phoenix-text-color-secondary)}"]})}return n})();const sbe=["knob"],obe=["valueIndicatorContainer"];function abe(n,e){if(1&n&&(zt(0,"div",2,1)(2,"div",5)(3,"span",6),Fi(4),an()()()),2&n){const t=Pr();Vn(4),tA(t.valueIndicatorText)}}const lbe=["trackActive"],cbe=["*"];function dbe(n,e){if(1&n&&Fr(0,"div"),2&n){const t=e.$implicit,i=e.$index,r=Pr(3);B_(0===t?"mdc-slider__tick-mark--active":"mdc-slider__tick-mark--inactive"),XM("transform",r._calcTickMarkTransform(i))}}function ube(n,e){1&n&&function k3(n,e,t,i,r,s,a,l,d,u,p,_,S){im("NgControlFlow");const R=void 0!==d,H=Zi(),re=l?a.bind(H[Yo][Ka]):a,se=new dK(R,re);H[Cs+n]=se,zs(n+1,e,t,i,r,s),R&&zs(n+2,d,u,p,_,S)}(0,dbe,1,4,"div",8,R3),2&n&&function F3(n){const e=Ye(null),t=Lc();try{const i=Zi(),r=i[Gr],s=i[t];if(void 0===s.liveCollection){const l=t+1,d=QP(i,l),u=WP(r,l);s.liveCollection=new uK(d,i,u)}else s.liveCollection.reset();const a=s.liveCollection;if(function aK(n,e,t){let i,r,s=0,a=n.length-1;if(Array.isArray(e)){let l=e.length-1;for(;s<=a&&s<=l;){const d=n.at(s),u=e[s],p=GP(s,d,s,u,t);if(0!==p){p<0&&n.updateValue(s,u),s++;continue}const _=n.at(a),S=e[l],R=GP(a,_,l,S,t);if(0!==R){R<0&&n.updateValue(a,S),a--,l--;continue}const H=t(s,d),re=t(a,_),se=t(s,u);if(Object.is(se,re)){const ce=t(l,S);Object.is(ce,H)?(n.swap(s,a),n.updateValue(a,S),l--,a--):n.move(a,s),n.updateValue(s,u),s++}else if(i??=new E8,r??=S8(n,s,a,t),qP(n,i,s,se))n.updateValue(s,u),s++,a++;else if(r.has(se))i.set(H,n.detach(s)),a--;else{const ce=n.create(s,e[s]);n.attach(s,ce),s++,a++}}for(;s<=l;)M8(n,i,t,s,e[s]),s++}else if(null!=e){const l=e[Symbol.iterator]();let d=l.next();for(;!d.done&&s<=a;){const u=n.at(s),p=d.value,_=GP(s,u,s,p,t);if(0!==_)_<0&&n.updateValue(s,p),s++,d=l.next();else{i??=new E8,r??=S8(n,s,a,t);const S=t(s,p);if(qP(n,i,s,S))n.updateValue(s,p),s++,a++,d=l.next();else if(r.has(S)){const R=t(s,u);i.set(R,n.detach(s)),a--}else n.attach(s,n.create(s,p)),s++,a++,d=l.next()}}for(;!d.done;)M8(n,i,t,n.length,d.value),d=l.next()}for(;s<=a;)n.destroy(n.detach(a--));i?.forEach(l=>{n.destroy(l)})}(a,n,s.trackByFn),a.updateIndexes(),s.hasEmptyBlock){const l=fh(),d=0===a.length;if(Hd(i,l,d)){const u=t+2,p=QP(i,u);if(d){const _=WP(r,u),S=yy(p,_.tView.ssrId);Zv(p,Yv(i,_,void 0,{dehydratedView:S}),0,hy(_,S))}else hw(p,0)}}}finally{Ye(e)}}(Pr(2)._tickMarks)}function hbe(n,e){if(1&n&&(zt(0,"div",6,1),zs(2,ube,2,0),an()),2&n){const t=Pr();Vn(2),P_(2,t._cachedWidth?2:-1)}}function fbe(n,e){if(1&n&&Fr(0,"mat-slider-visual-thumb",7),2&n){const t=Pr();Hn("discrete",t.discrete)("thumbPosition",1)("valueIndicatorText",t.startValueIndicatorText)}}var na=function(n){return n[n.START=1]="START",n[n.END=2]="END",n}(na||{}),PC=function(n){return n[n.ACTIVE=0]="ACTIVE",n[n.INACTIVE=1]="INACTIVE",n}(PC||{});const iB=new Bi("_MatSlider"),p$=new Bi("_MatSliderThumb"),m$=new Bi("_MatSliderRangeThumb"),A$=new Bi("_MatSliderVisualThumb");let pbe=(()=>{class n{constructor(t,i,r,s){this._cdr=t,this._ngZone=i,this._slider=s,this._isHovered=!1,this._isActive=!1,this._isValueIndicatorVisible=!1,this._platform=pi(dd),this._onPointerMove=a=>{if(this._sliderInput._isFocused)return;const l=this._hostElement.getBoundingClientRect(),d=this._slider._isCursorOnSliderThumb(a,l);this._isHovered=d,d?this._showHoverRipple():this._hideRipple(this._hoverRippleRef)},this._onMouseLeave=()=>{this._isHovered=!1,this._hideRipple(this._hoverRippleRef)},this._onFocus=()=>{this._hideRipple(this._hoverRippleRef),this._showFocusRipple(),this._hostElement.classList.add("mdc-slider__thumb--focused")},this._onBlur=()=>{this._isActive||this._hideRipple(this._focusRippleRef),this._isHovered&&this._showHoverRipple(),this._hostElement.classList.remove("mdc-slider__thumb--focused")},this._onDragStart=a=>{0===a.button&&(this._isActive=!0,this._showActiveRipple())},this._onDragEnd=()=>{this._isActive=!1,this._hideRipple(this._activeRippleRef),this._sliderInput._isFocused||this._hideRipple(this._focusRippleRef),this._platform.SAFARI&&this._showHoverRipple()},this._hostElement=r.nativeElement}ngAfterViewInit(){this._ripple.radius=24,this._sliderInput=this._slider._getInput(this.thumbPosition),this._sliderInputEl=this._sliderInput._hostElement;const t=this._sliderInputEl;this._ngZone.runOutsideAngular(()=>{t.addEventListener("pointermove",this._onPointerMove),t.addEventListener("pointerdown",this._onDragStart),t.addEventListener("pointerup",this._onDragEnd),t.addEventListener("pointerleave",this._onMouseLeave),t.addEventListener("focus",this._onFocus),t.addEventListener("blur",this._onBlur)})}ngOnDestroy(){const t=this._sliderInputEl;t&&(t.removeEventListener("pointermove",this._onPointerMove),t.removeEventListener("pointerdown",this._onDragStart),t.removeEventListener("pointerup",this._onDragEnd),t.removeEventListener("pointerleave",this._onMouseLeave),t.removeEventListener("focus",this._onFocus),t.removeEventListener("blur",this._onBlur))}_showHoverRipple(){this._isShowingRipple(this._hoverRippleRef)||(this._hoverRippleRef=this._showRipple({enterDuration:0,exitDuration:0}),this._hoverRippleRef?.element.classList.add("mat-mdc-slider-hover-ripple"))}_showFocusRipple(){this._isShowingRipple(this._focusRippleRef)||(this._focusRippleRef=this._showRipple({enterDuration:0,exitDuration:0},!0),this._focusRippleRef?.element.classList.add("mat-mdc-slider-focus-ripple"))}_showActiveRipple(){this._isShowingRipple(this._activeRippleRef)||(this._activeRippleRef=this._showRipple({enterDuration:225,exitDuration:400}),this._activeRippleRef?.element.classList.add("mat-mdc-slider-active-ripple"))}_isShowingRipple(t){return t?.state===xp.FADING_IN||t?.state===xp.VISIBLE}_showRipple(t,i){if(!this._slider.disabled&&(this._showValueIndicator(),this._slider._isRange&&this._slider._getThumb(this.thumbPosition===na.START?na.END:na.START)._showValueIndicator(),!this._slider._globalRippleOptions?.disabled||i))return this._ripple.launch({animation:this._slider._noopAnimations?{enterDuration:0,exitDuration:0}:t,centered:!0,persistent:!0})}_hideRipple(t){if(t?.fadeOut(),this._isShowingAnyRipple())return;this._slider._isRange||this._hideValueIndicator();const i=this._getSibling();i._isShowingAnyRipple()||(this._hideValueIndicator(),i._hideValueIndicator())}_showValueIndicator(){this._hostElement.classList.add("mdc-slider__thumb--with-indicator")}_hideValueIndicator(){this._hostElement.classList.remove("mdc-slider__thumb--with-indicator")}_getSibling(){return this._slider._getThumb(this.thumbPosition===na.START?na.END:na.START)}_getValueIndicatorContainer(){return this._valueIndicatorContainer?.nativeElement}_getKnob(){return this._knob.nativeElement}_isShowingAnyRipple(){return this._isShowingRipple(this._hoverRippleRef)||this._isShowingRipple(this._focusRippleRef)||this._isShowingRipple(this._activeRippleRef)}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(Sc),Lt(io),Lt(oo),Lt(iB))};static#t=this.\u0275cmp=Zr({type:n,selectors:[["mat-slider-visual-thumb"]],viewQuery:function(i,r){if(1&i&&(_l(R0,5),_l(sbe,5),_l(obe,5)),2&i){let s;pa(s=ma())&&(r._ripple=s.first),pa(s=ma())&&(r._knob=s.first),pa(s=ma())&&(r._valueIndicatorContainer=s.first)}},hostAttrs:[1,"mdc-slider__thumb","mat-mdc-slider-visual-thumb"],inputs:{discrete:"discrete",thumbPosition:"thumbPosition",valueIndicatorText:"valueIndicatorText"},standalone:!0,features:[qo([{provide:A$,useExisting:n}]),yd],decls:4,vars:2,consts:[["knob",""],["valueIndicatorContainer",""],[1,"mdc-slider__value-indicator-container"],[1,"mdc-slider__thumb-knob"],["matRipple","",1,"mat-mdc-focus-indicator",3,"matRippleDisabled"],[1,"mdc-slider__value-indicator"],[1,"mdc-slider__value-indicator-text"]],template:function(i,r){1&i&&(zs(0,abe,5,1,"div",2),Fr(1,"div",3,0)(3,"div",4)),2&i&&(P_(0,r.discrete?0:-1),Vn(3),Hn("matRippleDisabled",!0))},dependencies:[R0],styles:[".mat-mdc-slider-visual-thumb .mat-ripple{height:100%;width:100%}.mat-mdc-slider .mdc-slider__tick-marks{justify-content:start}.mat-mdc-slider .mdc-slider__tick-marks .mdc-slider__tick-mark--active,.mat-mdc-slider .mdc-slider__tick-marks .mdc-slider__tick-mark--inactive{position:absolute;left:2px}"],encapsulation:2,changeDetection:0})}return n})(),yL=(()=>{class n{get disabled(){return this._disabled}set disabled(t){this._disabled=t;const i=this._getInput(na.END),r=this._getInput(na.START);i&&(i.disabled=this._disabled),r&&(r.disabled=this._disabled)}get discrete(){return this._discrete}set discrete(t){this._discrete=t,this._updateValueIndicatorUIs()}get min(){return this._min}set min(t){const i=isNaN(t)?this._min:t;this._min!==i&&this._updateMin(i)}_updateMin(t){const i=this._min;this._min=t,this._isRange?this._updateMinRange({old:i,new:t}):this._updateMinNonRange(t),this._onMinMaxOrStepChange()}_updateMinRange(t){const i=this._getInput(na.END),r=this._getInput(na.START),s=i.value,a=r.value;r.min=t.new,i.min=Math.max(t.new,r.value),r.max=Math.min(i.max,i.value),r._updateWidthInactive(),i._updateWidthInactive(),t.new<t.old?this._onTranslateXChangeBySideEffect(i,r):this._onTranslateXChangeBySideEffect(r,i),s!==i.value&&this._onValueChange(i),a!==r.value&&this._onValueChange(r)}_updateMinNonRange(t){const i=this._getInput(na.END);if(i){const r=i.value;i.min=t,i._updateThumbUIByValue(),this._updateTrackUI(i),r!==i.value&&this._onValueChange(i)}}get max(){return this._max}set max(t){const i=isNaN(t)?this._max:t;this._max!==i&&this._updateMax(i)}_updateMax(t){const i=this._max;this._max=t,this._isRange?this._updateMaxRange({old:i,new:t}):this._updateMaxNonRange(t),this._onMinMaxOrStepChange()}_updateMaxRange(t){const i=this._getInput(na.END),r=this._getInput(na.START),s=i.value,a=r.value;i.max=t.new,r.max=Math.min(t.new,i.value),i.min=r.value,i._updateWidthInactive(),r._updateWidthInactive(),t.new>t.old?this._onTranslateXChangeBySideEffect(r,i):this._onTranslateXChangeBySideEffect(i,r),s!==i.value&&this._onValueChange(i),a!==r.value&&this._onValueChange(r)}_updateMaxNonRange(t){const i=this._getInput(na.END);if(i){const r=i.value;i.max=t,i._updateThumbUIByValue(),this._updateTrackUI(i),r!==i.value&&this._onValueChange(i)}}get step(){return this._step}set step(t){const i=isNaN(t)?this._step:t;this._step!==i&&this._updateStep(i)}_updateStep(t){this._step=t,this._isRange?this._updateStepRange():this._updateStepNonRange(),this._onMinMaxOrStepChange()}_updateStepRange(){const t=this._getInput(na.END),i=this._getInput(na.START),r=t.value,s=i.value,a=i.value;t.min=this._min,i.max=this._max,t.step=this._step,i.step=this._step,this._platform.SAFARI&&(t.value=t.value,i.value=i.value),t.min=Math.max(this._min,i.value),i.max=Math.min(this._max,t.value),i._updateWidthInactive(),t._updateWidthInactive(),t.value<a?this._onTranslateXChangeBySideEffect(i,t):this._onTranslateXChangeBySideEffect(t,i),r!==t.value&&this._onValueChange(t),s!==i.value&&this._onValueChange(i)}_updateStepNonRange(){const t=this._getInput(na.END);if(t){const i=t.value;t.step=this._step,this._platform.SAFARI&&(t.value=t.value),t._updateThumbUIByValue(),i!==t.value&&this._onValueChange(t)}}constructor(t,i,r,s,a,l){this._ngZone=t,this._cdr=i,this._elementRef=r,this._dir=s,this._globalRippleOptions=a,this._disabled=!1,this._discrete=!1,this.showTickMarks=!1,this._min=0,this.disableRipple=!1,this._max=100,this._step=1,this.displayWith=d=>`${d}`,this._rippleRadius=24,this.startValueIndicatorText="",this.endValueIndicatorText="",this._isRange=!1,this._isRtl=!1,this._hasViewInitialized=!1,this._tickMarkTrackWidth=0,this._hasAnimation=!1,this._resizeTimer=null,this._platform=pi(dd),this._knobRadius=8,this._thumbsOverlap=!1,this._noopAnimations="NoopAnimations"===l,this._dirChangeSubscription=this._dir.change.subscribe(()=>this._onDirChange()),this._isRtl="rtl"===this._dir.value}ngAfterViewInit(){this._platform.isBrowser&&this._updateDimensions();const t=this._getInput(na.END),i=this._getInput(na.START);this._isRange=!!t&&!!i,this._cdr.detectChanges();const r=this._getThumb(na.END);this._rippleRadius=r._ripple.radius,this._inputPadding=this._rippleRadius-this._knobRadius,this._isRange?this._initUIRange(t,i):this._initUINonRange(t),this._updateTrackUI(t),this._updateTickMarkUI(),this._updateTickMarkTrackUI(),this._observeHostResize(),this._cdr.detectChanges()}_initUINonRange(t){t.initProps(),t.initUI(),this._updateValueIndicatorUI(t),this._hasViewInitialized=!0,t._updateThumbUIByValue()}_initUIRange(t,i){t.initProps(),t.initUI(),i.initProps(),i.initUI(),t._updateMinMax(),i._updateMinMax(),t._updateStaticStyles(),i._updateStaticStyles(),this._updateValueIndicatorUIs(),this._hasViewInitialized=!0,t._updateThumbUIByValue(),i._updateThumbUIByValue()}ngOnDestroy(){this._dirChangeSubscription.unsubscribe(),this._resizeObserver?.disconnect(),this._resizeObserver=null}_onDirChange(){this._isRtl="rtl"===this._dir.value,this._isRange?this._onDirChangeRange():this._onDirChangeNonRange(),this._updateTickMarkUI()}_onDirChangeRange(){const t=this._getInput(na.END),i=this._getInput(na.START);t._setIsLeftThumb(),i._setIsLeftThumb(),t.translateX=t._calcTranslateXByValue(),i.translateX=i._calcTranslateXByValue(),t._updateStaticStyles(),i._updateStaticStyles(),t._updateWidthInactive(),i._updateWidthInactive(),t._updateThumbUIByValue(),i._updateThumbUIByValue()}_onDirChangeNonRange(){this._getInput(na.END)._updateThumbUIByValue()}_observeHostResize(){typeof ResizeObserver>"u"||!ResizeObserver||this._ngZone.runOutsideAngular(()=>{this._resizeObserver=new ResizeObserver(()=>{this._isActive()||(this._resizeTimer&&clearTimeout(this._resizeTimer),this._onResize())}),this._resizeObserver.observe(this._elementRef.nativeElement)})}_isActive(){return this._getThumb(na.START)._isActive||this._getThumb(na.END)._isActive}_getValue(t=na.END){const i=this._getInput(t);return i?i.value:this.min}_skipUpdate(){return!(!this._getInput(na.START)?._skipUIUpdate&&!this._getInput(na.END)?._skipUIUpdate)}_updateDimensions(){this._cachedWidth=this._elementRef.nativeElement.offsetWidth,this._cachedLeft=this._elementRef.nativeElement.getBoundingClientRect().left}_setTrackActiveStyles(t){const i=this._trackActive.nativeElement.style;i.left=t.left,i.right=t.right,i.transformOrigin=t.transformOrigin,i.transform=t.transform}_calcTickMarkTransform(t){return`translateX(${t*(this._tickMarkTrackWidth/(this._tickMarks.length-1))}px`}_onTranslateXChange(t){this._hasViewInitialized&&(this._updateThumbUI(t),this._updateTrackUI(t),this._updateOverlappingThumbUI(t))}_onTranslateXChangeBySideEffect(t,i){this._hasViewInitialized&&(t._updateThumbUIByValue(),i._updateThumbUIByValue())}_onValueChange(t){this._hasViewInitialized&&(this._updateValueIndicatorUI(t),this._updateTickMarkUI(),this._cdr.detectChanges())}_onMinMaxOrStepChange(){this._hasViewInitialized&&(this._updateTickMarkUI(),this._updateTickMarkTrackUI(),this._cdr.markForCheck())}_onResize(){if(this._hasViewInitialized){if(this._updateDimensions(),this._isRange){const t=this._getInput(na.END),i=this._getInput(na.START);t._updateThumbUIByValue(),i._updateThumbUIByValue(),t._updateStaticStyles(),i._updateStaticStyles(),t._updateMinMax(),i._updateMinMax(),t._updateWidthInactive(),i._updateWidthInactive()}else{const t=this._getInput(na.END);t&&t._updateThumbUIByValue()}this._updateTickMarkUI(),this._updateTickMarkTrackUI(),this._cdr.detectChanges()}}_areThumbsOverlapping(){const t=this._getInput(na.START),i=this._getInput(na.END);return!(!t||!i)&&i.translateX-t.translateX<20}_updateOverlappingThumbClassNames(t){const i=t.getSibling(),r=this._getThumb(t.thumbPosition);this._getThumb(i.thumbPosition)._hostElement.classList.remove("mdc-slider__thumb--top"),r._hostElement.classList.toggle("mdc-slider__thumb--top",this._thumbsOverlap)}_updateOverlappingThumbUI(t){!this._isRange||this._skipUpdate()||this._thumbsOverlap!==this._areThumbsOverlapping()&&(this._thumbsOverlap=!this._thumbsOverlap,this._updateOverlappingThumbClassNames(t))}_updateThumbUI(t){this._skipUpdate()||(this._getThumb(t.thumbPosition===na.END?na.END:na.START)._hostElement.style.transform=`translateX(${t.translateX}px)`)}_updateValueIndicatorUI(t){if(this._skipUpdate())return;const i=this.displayWith(t.value);if(this._hasViewInitialized?t._valuetext=i:t._hostElement.setAttribute("aria-valuetext",i),this.discrete){t.thumbPosition===na.START?this.startValueIndicatorText=i:this.endValueIndicatorText=i;const r=this._getThumb(t.thumbPosition);i.length<3?r._hostElement.classList.add("mdc-slider__thumb--short-value"):r._hostElement.classList.remove("mdc-slider__thumb--short-value")}}_updateValueIndicatorUIs(){const t=this._getInput(na.END),i=this._getInput(na.START);t&&this._updateValueIndicatorUI(t),i&&this._updateValueIndicatorUI(i)}_updateTickMarkTrackUI(){if(!this.showTickMarks||this._skipUpdate())return;const t=this._step&&this._step>0?this._step:1,r=(Math.floor(this.max/t)*t-this.min)/(this.max-this.min);this._tickMarkTrackWidth=this._cachedWidth*r-6}_updateTrackUI(t){this._skipUpdate()||(this._isRange?this._updateTrackUIRange(t):this._updateTrackUINonRange(t))}_updateTrackUIRange(t){const i=t.getSibling();if(!i||!this._cachedWidth)return;const r=Math.abs(i.translateX-t.translateX)/this._cachedWidth;this._setTrackActiveStyles(t._isLeftThumb&&this._cachedWidth?{left:"auto",right:this._cachedWidth-i.translateX+"px",transformOrigin:"right",transform:`scaleX(${r})`}:{left:`${i.translateX}px`,right:"auto",transformOrigin:"left",transform:`scaleX(${r})`})}_updateTrackUINonRange(t){this._setTrackActiveStyles(this._isRtl?{left:"auto",right:"0px",transformOrigin:"right",transform:`scaleX(${1-t.fillPercentage})`}:{left:"0px",right:"auto",transformOrigin:"left",transform:`scaleX(${t.fillPercentage})`})}_updateTickMarkUI(){if(!this.showTickMarks||void 0===this.step||void 0===this.min||void 0===this.max)return;const t=this.step>0?this.step:1;this._isRange?this._updateTickMarkUIRange(t):this._updateTickMarkUINonRange(t),this._isRtl&&this._tickMarks.reverse()}_updateTickMarkUINonRange(t){const i=this._getValue();let r=Math.max(Math.floor((i-this.min)/t),0),s=Math.max(Math.floor((this.max-i)/t),0);this._isRtl?r++:s++,this._tickMarks=Array(r).fill(PC.ACTIVE).concat(Array(s).fill(PC.INACTIVE))}_updateTickMarkUIRange(t){const i=this._getValue(),r=this._getValue(na.START),s=Math.max(Math.floor((r-this.min)/t),0),a=Math.max(Math.floor((i-r)/t)+1,0),l=Math.max(Math.floor((this.max-i)/t),0);this._tickMarks=Array(s).fill(PC.INACTIVE).concat(Array(a).fill(PC.ACTIVE),Array(l).fill(PC.INACTIVE))}_getInput(t){return t===na.END&&this._input?this._input:this._inputs?.length?t===na.START?this._inputs.first:this._inputs.last:void 0}_getThumb(t){return t===na.END?this._thumbs?.last:this._thumbs?.first}_setTransition(t){this._hasAnimation=!this._platform.IOS&&t&&!this._noopAnimations,this._elementRef.nativeElement.classList.toggle("mat-mdc-slider-with-animation",this._hasAnimation)}_isCursorOnSliderThumb(t,i){const r=i.width/2,d=t.clientY-(i.y+r);return Math.pow(t.clientX-(i.x+r),2)+Math.pow(d,2)<Math.pow(r,2)}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(io),Lt(Sc),Lt(oo),Lt(_m,8),Lt(bO,8),Lt(Od,8))};static#t=this.\u0275cmp=Zr({type:n,selectors:[["mat-slider"]],contentQueries:function(i,r,s){if(1&i&&(mp(s,p$,5),mp(s,m$,4)),2&i){let a;pa(a=ma())&&(r._input=a.first),pa(a=ma())&&(r._inputs=a)}},viewQuery:function(i,r){if(1&i&&(_l(lbe,5),_l(A$,5)),2&i){let s;pa(s=ma())&&(r._trackActive=s.first),pa(s=ma())&&(r._thumbs=s)}},hostAttrs:[1,"mat-mdc-slider","mdc-slider"],hostVars:12,hostBindings:function(i,r){2&i&&(B_("mat-"+(r.color||"primary")),Ja("mdc-slider--range",r._isRange)("mdc-slider--disabled",r.disabled)("mdc-slider--discrete",r.discrete)("mdc-slider--tick-marks",r.showTickMarks)("_mat-animation-noopable",r._noopAnimations))},inputs:{disabled:[mi.HasDecoratorInputTransform,"disabled","disabled",_o],discrete:[mi.HasDecoratorInputTransform,"discrete","discrete",_o],showTickMarks:[mi.HasDecoratorInputTransform,"showTickMarks","showTickMarks",_o],min:[mi.HasDecoratorInputTransform,"min","min",su],color:"color",disableRipple:[mi.HasDecoratorInputTransform,"disableRipple","disableRipple",_o],max:[mi.HasDecoratorInputTransform,"max","max",su],step:[mi.HasDecoratorInputTransform,"step","step",su],displayWith:"displayWith"},exportAs:["matSlider"],standalone:!0,features:[qo([{provide:iB,useExisting:n}]),ql,yd],ngContentSelectors:cbe,decls:9,vars:5,consts:[["trackActive",""],["tickMarkContainer",""],[1,"mdc-slider__track"],[1,"mdc-slider__track--inactive"],[1,"mdc-slider__track--active"],[1,"mdc-slider__track--active_fill"],[1,"mdc-slider__tick-marks"],[3,"discrete","thumbPosition","valueIndicatorText"],[3,"class","transform"]],template:function(i,r){1&i&&(vh(),ru(0),zt(1,"div",2),Fr(2,"div",3),zt(3,"div",4),Fr(4,"div",5,0),an(),zs(6,hbe,3,1,"div",6),an(),zs(7,fbe,1,3,"mat-slider-visual-thumb",7),Fr(8,"mat-slider-visual-thumb",7)),2&i&&(Vn(6),P_(6,r.showTickMarks?6:-1),Vn(),P_(7,r._isRange?7:-1),Vn(),Hn("discrete",r.discrete)("thumbPosition",2)("valueIndicatorText",r.endValueIndicatorText))},dependencies:[pbe],styles:['.mdc-slider{cursor:pointer;height:48px;margin:0 24px;position:relative;touch-action:pan-y}.mdc-slider .mdc-slider__track{position:absolute;top:50%;transform:translateY(-50%);width:100%}.mdc-slider .mdc-slider__track--active,.mdc-slider .mdc-slider__track--inactive{display:flex;height:100%;position:absolute;width:100%}.mdc-slider .mdc-slider__track--active{overflow:hidden}.mdc-slider .mdc-slider__track--active_fill{border-top-style:solid;box-sizing:border-box;height:100%;width:100%;position:relative;-webkit-transform-origin:left;transform-origin:left}[dir=rtl] .mdc-slider .mdc-slider__track--active_fill,.mdc-slider .mdc-slider__track--active_fill[dir=rtl]{-webkit-transform-origin:right;transform-origin:right}.mdc-slider .mdc-slider__track--inactive{left:0;top:0}.mdc-slider .mdc-slider__track--inactive::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-slider .mdc-slider__track--inactive::before{border-color:CanvasText}}.mdc-slider .mdc-slider__value-indicator-container{bottom:44px;left:50%;left:var(--slider-value-indicator-container-left, 50%);pointer-events:none;position:absolute;right:var(--slider-value-indicator-container-right);transform:translateX(-50%);transform:var(--slider-value-indicator-container-transform, translateX(-50%))}.mdc-slider .mdc-slider__value-indicator{transition:transform 100ms 0ms cubic-bezier(0.4, 0, 1, 1);align-items:center;border-radius:4px;display:flex;height:32px;padding:0 12px;transform:scale(0);transform-origin:bottom}.mdc-slider .mdc-slider__value-indicator::before{border-left:6px solid rgba(0,0,0,0);border-right:6px solid rgba(0,0,0,0);border-top:6px solid;bottom:-5px;content:"";height:0;left:50%;left:var(--slider-value-indicator-caret-left, 50%);position:absolute;right:var(--slider-value-indicator-caret-right);transform:translateX(-50%);transform:var(--slider-value-indicator-caret-transform, translateX(-50%));width:0}.mdc-slider .mdc-slider__value-indicator::after{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-slider .mdc-slider__value-indicator::after{border-color:CanvasText}}.mdc-slider .mdc-slider__thumb--with-indicator .mdc-slider__value-indicator-container{pointer-events:auto}.mdc-slider .mdc-slider__thumb--with-indicator .mdc-slider__value-indicator{transition:transform 100ms 0ms cubic-bezier(0, 0, 0.2, 1);transform:scale(1)}@media(prefers-reduced-motion){.mdc-slider .mdc-slider__value-indicator,.mdc-slider .mdc-slider__thumb--with-indicator .mdc-slider__value-indicator{transition:none}}.mdc-slider .mdc-slider__thumb{display:flex;left:-24px;outline:none;position:absolute;user-select:none;height:48px;width:48px}.mdc-slider .mdc-slider__thumb--top{z-index:1}.mdc-slider .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-style:solid;border-width:1px;box-sizing:content-box}.mdc-slider .mdc-slider__thumb-knob{box-sizing:border-box;left:50%;position:absolute;top:50%;transform:translate(-50%, -50%)}.mdc-slider .mdc-slider__tick-marks{align-items:center;box-sizing:border-box;display:flex;height:100%;justify-content:space-between;padding:0 1px;position:absolute;width:100%}.mdc-slider--discrete .mdc-slider__thumb,.mdc-slider--discrete .mdc-slider__track--active_fill{transition:transform 80ms ease}@media(prefers-reduced-motion){.mdc-slider--discrete .mdc-slider__thumb,.mdc-slider--discrete .mdc-slider__track--active_fill{transition:none}}.mdc-slider--disabled{cursor:auto}.mdc-slider--disabled .mdc-slider__thumb{pointer-events:none}.mdc-slider__input{cursor:pointer;left:2px;margin:0;height:44px;opacity:0;pointer-events:none;position:absolute;top:2px;width:44px}.mat-mdc-slider{display:inline-block;box-sizing:border-box;outline:none;vertical-align:middle;margin-left:8px;margin-right:8px;width:auto;min-width:112px;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-slider .mdc-slider__thumb-knob{background-color:var(--mdc-slider-handle-color);border-color:var(--mdc-slider-handle-color)}.mat-mdc-slider .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__thumb-knob{background-color:var(--mdc-slider-disabled-handle-color);border-color:var(--mdc-slider-disabled-handle-color)}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider.mdc-slider--disabled .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider.mdc-slider--disabled .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider .mdc-slider__thumb::before,.mat-mdc-slider .mdc-slider__thumb::after{background-color:var(--mdc-slider-handle-color)}.mat-mdc-slider .mdc-slider__thumb:hover::before,.mat-mdc-slider .mdc-slider__thumb.mdc-ripple-surface--hover::before{opacity:var(--mdc-ripple-hover-opacity)}.mat-mdc-slider .mdc-slider__thumb.mdc-ripple-upgraded--background-focused::before,.mat-mdc-slider .mdc-slider__thumb:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:var(--mdc-ripple-focus-opacity)}.mat-mdc-slider .mdc-slider__thumb:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mat-mdc-slider .mdc-slider__thumb:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:var(--mdc-ripple-press-opacity)}.mat-mdc-slider .mdc-slider__thumb.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity)}.mat-mdc-slider .mdc-slider__track--active_fill{border-color:var(--mdc-slider-active-track-color)}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__track--active_fill{border-color:var(--mdc-slider-disabled-active-track-color)}.mat-mdc-slider .mdc-slider__track--inactive{background-color:var(--mdc-slider-inactive-track-color);opacity:.24}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__track--inactive{background-color:var(--mdc-slider-disabled-inactive-track-color);opacity:.24}.mat-mdc-slider .mdc-slider__tick-mark--active{background-color:var(--mdc-slider-with-tick-marks-active-container-color);opacity:var(--mdc-slider-with-tick-marks-active-container-opacity)}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__tick-mark--active{background-color:var(--mdc-slider-with-tick-marks-active-container-color);opacity:var(--mdc-slider-with-tick-marks-active-container-opacity)}.mat-mdc-slider .mdc-slider__tick-mark--inactive{background-color:var(--mdc-slider-with-tick-marks-inactive-container-color);opacity:var(--mdc-slider-with-tick-marks-inactive-container-opacity)}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__tick-mark--inactive{background-color:var(--mdc-slider-with-tick-marks-disabled-container-color);opacity:var(--mdc-slider-with-tick-marks-inactive-container-opacity)}.mat-mdc-slider .mdc-slider__value-indicator{background-color:var(--mdc-slider-label-container-color);opacity:1}.mat-mdc-slider .mdc-slider__value-indicator::before{border-top-color:var(--mdc-slider-label-container-color)}.mat-mdc-slider .mdc-slider__value-indicator{color:var(--mdc-slider-label-label-text-color)}.mat-mdc-slider .mdc-slider__track{height:var(--mdc-slider-inactive-track-height)}.mat-mdc-slider .mdc-slider__track--active{height:var(--mdc-slider-active-track-height);top:calc((var(--mdc-slider-inactive-track-height) - var(--mdc-slider-active-track-height)) / 2)}.mat-mdc-slider .mdc-slider__track--active_fill{border-top-width:var(--mdc-slider-active-track-height)}.mat-mdc-slider .mdc-slider__track--inactive{height:var(--mdc-slider-inactive-track-height)}.mat-mdc-slider .mdc-slider__tick-mark--active,.mat-mdc-slider .mdc-slider__tick-mark--inactive{height:var(--mdc-slider-with-tick-marks-container-size);width:var(--mdc-slider-with-tick-marks-container-size)}.mat-mdc-slider.mdc-slider--disabled{opacity:0.38}.mat-mdc-slider .mdc-slider__value-indicator-text{letter-spacing:var(--mdc-slider-label-label-text-tracking);font-size:var(--mdc-slider-label-label-text-size);font-family:var(--mdc-slider-label-label-text-font);font-weight:var(--mdc-slider-label-label-text-weight);line-height:var(--mdc-slider-label-label-text-line-height)}.mat-mdc-slider .mdc-slider__track--active{border-radius:var(--mdc-slider-active-track-shape)}.mat-mdc-slider .mdc-slider__track--inactive{border-radius:var(--mdc-slider-inactive-track-shape)}.mat-mdc-slider .mdc-slider__thumb-knob{border-radius:var(--mdc-slider-handle-shape);width:var(--mdc-slider-handle-width);height:var(--mdc-slider-handle-height);border-style:solid;border-width:calc(var(--mdc-slider-handle-height) / 2) calc(var(--mdc-slider-handle-width) / 2)}.mat-mdc-slider .mdc-slider__tick-mark--active,.mat-mdc-slider .mdc-slider__tick-mark--inactive{border-radius:var(--mdc-slider-with-tick-marks-container-shape)}.mat-mdc-slider .mdc-slider__thumb:hover .mdc-slider__thumb-knob{background-color:var(--mdc-slider-hover-handle-color);border-color:var(--mdc-slider-hover-handle-color)}.mat-mdc-slider .mdc-slider__thumb:hover .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb:hover .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb:hover .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider .mdc-slider__thumb--focused .mdc-slider__thumb-knob{background-color:var(--mdc-slider-focus-handle-color);border-color:var(--mdc-slider-focus-handle-color)}.mat-mdc-slider .mdc-slider__thumb--focused .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--focused .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--focused .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider .mdc-slider__thumb:not(:disabled):active .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb:not(:disabled):active .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb:not(:disabled):active .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:var(--mdc-slider-with-overlap-handle-outline-color);border-width:var(--mdc-slider-with-overlap-handle-outline-width)}.mat-mdc-slider .mdc-slider__thumb-knob{box-shadow:var(--mdc-slider-handle-elevation)}.mat-mdc-slider .mdc-slider__input{box-sizing:content-box;pointer-events:auto}.mat-mdc-slider .mdc-slider__input.mat-mdc-slider-input-no-pointer-events{pointer-events:none}.mat-mdc-slider .mdc-slider__input.mat-slider__right-input{left:auto;right:0}.mat-mdc-slider .mdc-slider__thumb,.mat-mdc-slider .mdc-slider__track--active_fill{transition-duration:0ms}.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__thumb,.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__track--active_fill{transition-duration:80ms}.mat-mdc-slider.mdc-slider--discrete .mdc-slider__thumb,.mat-mdc-slider.mdc-slider--discrete .mdc-slider__track--active_fill{transition-duration:0ms}.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__thumb,.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__track--active_fill{transition-duration:80ms}.mat-mdc-slider .mdc-slider__track,.mat-mdc-slider .mdc-slider__thumb{pointer-events:none}.mat-mdc-slider .mdc-slider__value-indicator-container{transform:var(--mat-slider-value-indicator-container-transform)}.mat-mdc-slider .mdc-slider__value-indicator{width:var(--mat-slider-value-indicator-width);height:var(--mat-slider-value-indicator-height);padding:var(--mat-slider-value-indicator-padding);opacity:var(--mat-slider-value-indicator-opacity);border-radius:var(--mat-slider-value-indicator-border-radius)}.mat-mdc-slider .mdc-slider__value-indicator::before{display:var(--mat-slider-value-indicator-caret-display)}.mat-mdc-slider .mdc-slider__value-indicator-text{width:var(--mat-slider-value-indicator-width);transform:var(--mat-slider-value-indicator-text-transform)}.mat-mdc-slider .mat-ripple .mat-ripple-element{background-color:var(--mat-slider-ripple-color)}.mat-mdc-slider .mat-ripple .mat-mdc-slider-hover-ripple{background-color:var(--mat-slider-hover-state-layer-color)}.mat-mdc-slider .mat-ripple .mat-mdc-slider-focus-ripple,.mat-mdc-slider .mat-ripple .mat-mdc-slider-active-ripple{background-color:var(--mat-slider-focus-state-layer-color)}.mat-mdc-slider._mat-animation-noopable.mdc-slider--discrete .mdc-slider__thumb,.mat-mdc-slider._mat-animation-noopable.mdc-slider--discrete .mdc-slider__track--active_fill,.mat-mdc-slider._mat-animation-noopable .mdc-slider__value-indicator{transition:none}.mat-mdc-slider .mat-mdc-focus-indicator::before{border-radius:50%}.mat-mdc-slider .mdc-slider__value-indicator{word-break:normal}.mat-mdc-slider .mdc-slider__value-indicator-text{text-align:center}.mdc-slider__thumb--focused .mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}return n})();const Abe={provide:Of,useExisting:jt(()=>YE),multi:!0};let YE=(()=>{class n{get value(){return su(this._hostElement.value,0)}set value(t){const i=(t=isNaN(t)?0:t)+"";this._hasSetInitialValue?this._isActive||this._setValue(i):this._initialValue=i}_setValue(t){this._hostElement.value=t,this._updateThumbUIByValue(),this._slider._onValueChange(this),this._cdr.detectChanges(),this._slider._cdr.markForCheck()}get translateX(){return this._slider.min>=this._slider.max?(this._translateX=this._tickMarkOffset,this._translateX):(void 0===this._translateX&&(this._translateX=this._calcTranslateXByValue()),this._translateX)}set translateX(t){this._translateX=t}get min(){return su(this._hostElement.min,0)}set min(t){this._hostElement.min=t+"",this._cdr.detectChanges()}get max(){return su(this._hostElement.max,0)}set max(t){this._hostElement.max=t+"",this._cdr.detectChanges()}get step(){return su(this._hostElement.step,0)}set step(t){this._hostElement.step=t+"",this._cdr.detectChanges()}get disabled(){return _o(this._hostElement.disabled)}set disabled(t){this._hostElement.disabled=t,this._cdr.detectChanges(),this._slider.disabled!==this.disabled&&(this._slider.disabled=this.disabled)}get percentage(){return this._slider.min>=this._slider.max?this._slider._isRtl?1:0:(this.value-this._slider.min)/(this._slider.max-this._slider.min)}get fillPercentage(){return this._slider._cachedWidth?0===this._translateX?0:this.translateX/this._slider._cachedWidth:this._slider._isRtl?1:0}_setIsFocused(t){this._isFocused=t}constructor(t,i,r,s){this._ngZone=t,this._elementRef=i,this._cdr=r,this._slider=s,this.valueChange=new Ls,this.dragStart=new Ls,this.dragEnd=new Ls,this.thumbPosition=na.END,this._knobRadius=8,this._tickMarkOffset=3,this._isActive=!1,this._isFocused=!1,this._hasSetInitialValue=!1,this._destroyed=new hn,this._skipUIUpdate=!1,this._onTouchedFn=()=>{},this._isControlInitialized=!1,this._platform=pi(dd),this._hostElement=i.nativeElement,this._ngZone.runOutsideAngular(()=>{this._hostElement.addEventListener("pointerdown",this._onPointerDown.bind(this)),this._hostElement.addEventListener("pointermove",this._onPointerMove.bind(this)),this._hostElement.addEventListener("pointerup",this._onPointerUp.bind(this))})}ngOnDestroy(){this._hostElement.removeEventListener("pointerdown",this._onPointerDown),this._hostElement.removeEventListener("pointermove",this._onPointerMove),this._hostElement.removeEventListener("pointerup",this._onPointerUp),this._destroyed.next(),this._destroyed.complete(),this.dragStart.complete(),this.dragEnd.complete()}initProps(){this._updateWidthInactive(),this.disabled!==this._slider.disabled&&(this._slider.disabled=!0),this.step=this._slider.step,this.min=this._slider.min,this.max=this._slider.max,this._initValue()}initUI(){this._updateThumbUIByValue()}_initValue(){this._hasSetInitialValue=!0,void 0===this._initialValue?this.value=this._getDefaultValue():(this._hostElement.value=this._initialValue,this._updateThumbUIByValue(),this._slider._onValueChange(this),this._cdr.detectChanges())}_getDefaultValue(){return this.min}_onBlur(){this._setIsFocused(!1),this._onTouchedFn()}_onFocus(){this._slider._setTransition(!1),this._slider._updateTrackUI(this),this._setIsFocused(!0)}_onChange(){this.valueChange.emit(this.value),this._isActive&&this._updateThumbUIByValue({withAnimation:!0})}_onInput(){this._onChangeFn?.(this.value),(this._slider.step||!this._isActive)&&this._updateThumbUIByValue({withAnimation:!0}),this._slider._onValueChange(this)}_onNgControlValueChange(){(!this._isActive||!this._isFocused)&&(this._slider._onValueChange(this),this._updateThumbUIByValue()),this._slider.disabled=this._formControl.disabled}_onPointerDown(t){if(!this.disabled&&0===t.button){if(this._platform.IOS){const i=this._slider._isCursorOnSliderThumb(t,this._slider._getThumb(this.thumbPosition)._hostElement.getBoundingClientRect());return this._isActive=i,this._updateWidthActive(),void this._slider._updateDimensions()}this._isActive=!0,this._setIsFocused(!0),this._updateWidthActive(),this._slider._updateDimensions(),this._slider.step||this._updateThumbUIByPointerEvent(t,{withAnimation:!0}),this.disabled||(this._handleValueCorrection(t),this.dragStart.emit({source:this,parent:this._slider,value:this.value}))}}_handleValueCorrection(t){this._skipUIUpdate=!0,setTimeout(()=>{this._skipUIUpdate=!1,this._fixValue(t)},0)}_fixValue(t){const i=t.clientX-this._slider._cachedLeft,r=this._slider._cachedWidth,s=0===this._slider.step?1:this._slider.step,a=Math.floor((this._slider.max-this._slider.min)/s),u=Math.round((this._slider._isRtl?1-i/r:i/r)*a)/a*(this._slider.max-this._slider.min)+this._slider.min,p=Math.round(u/s)*s;if(p===this.value)return this._slider._onValueChange(this),void(this._slider.step>0?this._updateThumbUIByValue():this._updateThumbUIByPointerEvent(t,{withAnimation:this._slider._hasAnimation}));this.value=p,this.valueChange.emit(this.value),this._onChangeFn?.(this.value),this._slider._onValueChange(this),this._slider.step>0?this._updateThumbUIByValue():this._updateThumbUIByPointerEvent(t,{withAnimation:this._slider._hasAnimation})}_onPointerMove(t){!this._slider.step&&this._isActive&&this._updateThumbUIByPointerEvent(t)}_onPointerUp(){this._isActive&&(this._isActive=!1,this._platform.SAFARI&&this._setIsFocused(!1),this.dragEnd.emit({source:this,parent:this._slider,value:this.value}),setTimeout(()=>this._updateWidthInactive(),this._platform.IOS?10:0))}_clamp(t){const i=this._tickMarkOffset;return Math.max(Math.min(t,this._slider._cachedWidth-this._tickMarkOffset),i)}_calcTranslateXByValue(){return this._slider._isRtl?(1-this.percentage)*(this._slider._cachedWidth-2*this._tickMarkOffset)+this._tickMarkOffset:this.percentage*(this._slider._cachedWidth-2*this._tickMarkOffset)+this._tickMarkOffset}_calcTranslateXByPointerEvent(t){return t.clientX-this._slider._cachedLeft}_updateWidthActive(){}_updateWidthInactive(){this._hostElement.style.padding=`0 ${this._slider._inputPadding}px`,this._hostElement.style.width=`calc(100% + ${this._slider._inputPadding-2*this._tickMarkOffset}px)`,this._hostElement.style.left=`-${this._slider._rippleRadius-this._tickMarkOffset}px`}_updateThumbUIByValue(t){this.translateX=this._clamp(this._calcTranslateXByValue()),this._updateThumbUI(t)}_updateThumbUIByPointerEvent(t,i){this.translateX=this._clamp(this._calcTranslateXByPointerEvent(t)),this._updateThumbUI(i)}_updateThumbUI(t){this._slider._setTransition(!!t?.withAnimation),this._slider._onTranslateXChange(this)}writeValue(t){(this._isControlInitialized||null!==t)&&(this.value=t)}registerOnChange(t){this._onChangeFn=t,this._isControlInitialized=!0}registerOnTouched(t){this._onTouchedFn=t}setDisabledState(t){this.disabled=t}focus(){this._hostElement.focus()}blur(){this._hostElement.blur()}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(io),Lt(oo),Lt(Sc),Lt(iB))};static#t=this.\u0275dir=Ft({type:n,selectors:[["input","matSliderThumb",""]],hostAttrs:["type","range",1,"mdc-slider__input"],hostVars:1,hostBindings:function(i,r){1&i&&Ai("change",function(){return r._onChange()})("input",function(){return r._onInput()})("blur",function(){return r._onBlur()})("focus",function(){return r._onFocus()}),2&i&&sl("aria-valuetext",r._valuetext)},inputs:{value:[mi.HasDecoratorInputTransform,"value","value",su]},outputs:{valueChange:"valueChange",dragStart:"dragStart",dragEnd:"dragEnd"},exportAs:["matSliderThumb"],standalone:!0,features:[qo([Abe,{provide:p$,useExisting:n}]),ql]})}return n})(),ybe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({imports:[Wd,P4]})}return n})(),vL=(()=>{class n{eventDisplay;clippingEnabled;startClippingAngle;openingClippingAngle;constructor(t){this.eventDisplay=t;const i=this.eventDisplay.getStateManager();i.clippingEnabled.onUpdate(r=>this.clippingEnabled=r),i.startClippingAngle.onUpdate(r=>this.startClippingAngle=r),i.openingClippingAngle.onUpdate(r=>this.openingClippingAngle=r)}changeStartClippingAngle(t){this.eventDisplay.getUIManager().rotateStartAngleClipping(t)}changeOpeningClippingAngle(t){this.eventDisplay.getUIManager().rotateOpeningAngleClipping(t)}toggleClipping(t){const i=t.checked;this.eventDisplay.getUIManager().setClipping(i),this.clippingEnabled=i}static \u0275fac=function(i){return new(i||n)(Lt(pl))};static \u0275cmp=Zr({type:n,selectors:[["app-object-clipping"]],decls:17,vars:5,consts:[["menu",""],["clippingCheckbox",""],["startingAngleSlider",""],["openingAngleSlider",""],[1,"mat-menu"],["mat-menu-item","",3,"click"],[3,"click","change","checked"],["mat-menu-item","",1,"slider-btn",3,"focus"],["min","0","max","360","step","1","thumbLabel",""],["matSliderThumb","",3,"valueChange","value"],["tooltip","Geometry clipping","icon","clipping",3,"matMenuTriggerFor","active"]],template:function(i,r){if(1&i){const s=ta();zt(0,"mat-menu",4,0)(2,"button",5),Ai("click",function(l){Ci(s);const d=Ga(4);return l.stopPropagation(),Mi(d._inputElement.nativeElement.click())}),zt(3,"mat-checkbox",6,1),Ai("click",function(l){return Ci(s),Mi(l.stopPropagation())})("change",function(l){return Ci(s),Mi(r.toggleClipping(l))}),Fi(5," Clipping "),an()(),zt(6,"button",7),Ai("focus",function(){return Ci(s),Mi(Ga(9).focus())}),zt(7,"mat-slider",8)(8,"input",9,2),Ai("valueChange",function(l){return Ci(s),Mi(r.changeStartClippingAngle(l))}),an()(),Fi(10," Start Angle "),an(),zt(11,"button",7),Ai("focus",function(){return Ci(s),Mi(Ga(14).focus())}),zt(12,"mat-slider",8)(13,"input",9,3),Ai("valueChange",function(l){return Ci(s),Mi(r.changeOpeningClippingAngle(l))}),an()(),Fi(15," Opening Angle "),an()(),Fr(16,"app-menu-toggle",10)}if(2&i){const s=Ga(1);Vn(3),Hn("checked",r.clippingEnabled),Vn(5),Hn("value",r.startClippingAngle),Vn(5),Hn("value",r.openingClippingAngle),Vn(3),Hn("matMenuTriggerFor",s)("active",r.clippingEnabled)}},dependencies:[s1,r1,CC,yL,YE,sv,qc],styles:[".slider-btn[_ngcontent-%COMP%]{overflow:visible}mat-slider[_ngcontent-%COMP%]{margin-left:.75rem;margin-right:.75rem}"]})}return n})(),rB=(()=>{class n{eventDisplay;darkTheme=!1;constructor(t){this.eventDisplay=t}ngOnInit(){this.darkTheme=this.eventDisplay.getUIManager().getDarkTheme()}setDarkTheme(){this.darkTheme=!this.darkTheme,this.eventDisplay.getUIManager().setDarkTheme(this.darkTheme)}static \u0275fac=function(i){return new(i||n)(Lt(pl))};static \u0275cmp=Zr({type:n,selectors:[["app-dark-theme"]],decls:1,vars:1,consts:[["tooltip","Dark theme","icon","dark",3,"click","active"]],template:function(i,r){1&i&&(zt(0,"app-menu-toggle",0),Ai("click",function(){return r.setDarkTheme()}),an()),2&i&&Hn("active",r.darkTheme)},dependencies:[qc]})}return n})(),sB=(()=>{class n{eventDisplay;autoRotate=!1;constructor(t){this.eventDisplay=t}toggleAutoRotate(){this.autoRotate=!this.autoRotate,this.eventDisplay.getUIManager().setAutoRotate(this.autoRotate)}static \u0275fac=function(i){return new(i||n)(Lt(pl))};static \u0275cmp=Zr({type:n,selectors:[["app-auto-rotate"]],decls:1,vars:1,consts:[["tooltip","Auto rotate","icon","rotate",3,"click","active"]],template:function(i,r){1&i&&(zt(0,"app-menu-toggle",0),Ai("click",function(){return r.toggleAutoRotate()}),an()),2&i&&Hn("active",r.autoRotate)},dependencies:[qc]})}return n})(),g$=(()=>{class n{data;dialogRef;eventDisplay;cartesianPos=new It;originChangedSub=null;stopShiftingSub=null;showCartesianGrid;gridConfig;scale;shiftGrid;constructor(t,i,r){this.data=t,this.dialogRef=i,this.eventDisplay=r}ngOnInit(){this.shiftGrid=this.eventDisplay.getThreeManager().shiftGrid,this.showCartesianGrid=this.data.gridVisible,this.scale=this.data.scale,this.gridConfig=this.eventDisplay.getUIManager().getCartesianGridConfig(),this.cartesianPos=this.eventDisplay.getThreeManager().origin}onClose(){this.dialogRef.close()}onSave(t,i,r){this.shiftCartesianGridByValues(new It(10*t,10*i,10*r))}shiftCartesianGridByPointer(){this.shiftGrid=!0,this.eventDisplay.getUIManager().shiftCartesianGridByPointer(),this.originChangedSub=this.eventDisplay.getThreeManager().originChanged.subscribe(t=>{this.translateGrid(t)}),this.stopShiftingSub=this.eventDisplay.getThreeManager().stopShifting.subscribe(t=>{t&&(this.originChangedSub.unsubscribe(),this.stopShiftingSub.unsubscribe())}),this.onClose()}shiftCartesianGridByValues(t){this.translateGrid(t),this.eventDisplay.getThreeManager().originChangedEmit(t)}translateGrid(t){const i=t,r=this.cartesianPos,s=new It(i.x-r.x,i.y-r.y,i.z-r.z);this.eventDisplay.getUIManager().translateCartesianGrid(s.clone()),this.eventDisplay.getUIManager().translateCartesianLabels(s.clone()),this.cartesianPos=i}addXYPlanes(t){this.gridConfig.zDistance=Number(t.target.value),this.callSetShowCartesianGrid()}addYZPlanes(t){this.gridConfig.xDistance=Number(t.target.value),this.callSetShowCartesianGrid()}addZXPlanes(t){this.gridConfig.yDistance=Number(t.target.value),this.callSetShowCartesianGrid()}changeSparsity(t){this.gridConfig.sparsity=Number(t.target.value),this.callSetShowCartesianGrid()}showXYPlanes(t){this.gridConfig.showXY=t.checked,this.callSetShowCartesianGrid()}showYZPlanes(t){this.gridConfig.showYZ=t.checked,this.callSetShowCartesianGrid()}showZXPlanes(t){this.gridConfig.showZX=t.checked,this.callSetShowCartesianGrid()}callSetShowCartesianGrid(){this.eventDisplay.getUIManager().setShowCartesianGrid(this.showCartesianGrid,this.scale,this.gridConfig)}calcPlanes(t){return Math.max(0,1+2*Math.floor(10*t/(this.scale*this.gridConfig.sparsity)))}static \u0275fac=function(i){return new(i||n)(Lt(pL),Lt(_x),Lt(pl))};static \u0275cmp=Zr({type:n,selectors:[["app-cartesian-grid-config"]],decls:65,vars:28,consts:[["xPos",""],["yPos",""],["zPos",""],["showXYPlanesCheckbox",""],["xyPlaneSlider",""],["showYZPlanesCheckbox",""],["yzPlaneSlider",""],["showZXPlanesCheckbox",""],["zxPlaneSlider",""],["sparsitySlider",""],["mat-dialog-title",""],["mat-dialog-content","",1,"container","dialog-content"],[1,"item-config-single"],[1,"item-config-group"],["for","xPos",1,"item-config-label"],["type","number","placeholder","Origin X","name","xPos","id","xPos",1,"form-control",3,"value"],["for","yPos",1,"item-config-label"],["type","number","placeholder","Origin Y","name","yPos","id","yPos",1,"form-control",3,"value"],["for","zPos",1,"item-config-label"],["type","number","placeholder","Origin Z","name","zPos","id","zPos",1,"form-control",3,"value"],["mat-stroked-button","",3,"click","disabled"],["mat-menu-item","",1,"explain-button",2,"margin","0.5rem 0",3,"click","disabled"],[1,"explain-text"],["mat-menu-item","",3,"click"],[3,"ngModelChange","click","change","ngModel"],["mat-menu-item","",1,"slider-btn",3,"focus"],["min","-300","step","300","thumbLabel","",3,"max"],["matSliderThumb","",3,"input","value"],["min","1","max","5","step","1","thumbLabel",""],["mat-dialog-actions","","align","end"],["mat-flat-button","","color","primary","cdkFocusInitial","",3,"click"]],template:function(i,r){if(1&i){const s=ta();zt(0,"div")(1,"h1",10),Fi(2,"Customize Cartesian Grid"),an(),zt(3,"div",11)(4,"div",12)(5,"div",13)(6,"label",14),Fi(7,"x (cm) : "),an(),Fr(8,"input",15,0),sS(10,"number"),an(),zt(11,"div",13)(12,"label",16),Fi(13,"y (cm) : "),an(),Fr(14,"input",17,1),sS(16,"number"),an(),zt(17,"div",13)(18,"label",18),Fi(19,"z (cm) : "),an(),Fr(20,"input",19,2),sS(22,"number"),an(),zt(23,"button",20),Ai("click",function(){Ci(s);const l=Ga(9),d=Ga(15),u=Ga(21);return Mi(r.onSave(l.value,d.value,u.value))}),Fi(24," Save "),an(),zt(25,"button",21),Ai("click",function(l){return Ci(s),l.stopPropagation(),Mi(r.shiftCartesianGridByPointer())}),Fi(26," Shift Cartesian Grid on click "),zt(27,"p",22),Fi(28," Click on a point to shift the grid. Keep clicking at various points to continue shifting. Right click to stop. "),an()()(),zt(29,"div")(30,"button",23),Ai("click",function(){return Ci(s),Mi(Ga(32)._inputElement.nativeElement.click())}),zt(31,"mat-checkbox",24,3),Qw("ngModelChange",function(l){return Ci(s),iS(r.gridConfig.showXY,l)||(r.gridConfig.showXY=l),Mi(l)}),Ai("click",function(l){return Ci(s),Mi(l.stopPropagation())})("change",function(l){return Ci(s),Mi(r.showXYPlanes(l))}),Fi(33,"Show XY Planes "),an()(),zt(34,"button",25),Ai("focus",function(){return Ci(s),Mi(Ga(37).focus())}),zt(35,"mat-slider",26)(36,"input",27,4),Ai("input",function(l){return Ci(s),Mi(r.addXYPlanes(l))}),an()(),Fi(38),an(),zt(39,"button",23),Ai("click",function(){return Ci(s),Mi(Ga(41)._inputElement.nativeElement.click())}),zt(40,"mat-checkbox",24,5),Qw("ngModelChange",function(l){return Ci(s),iS(r.gridConfig.showYZ,l)||(r.gridConfig.showYZ=l),Mi(l)}),Ai("click",function(l){return Ci(s),Mi(l.stopPropagation())})("change",function(l){return Ci(s),Mi(r.showYZPlanes(l))}),Fi(42,"Show YZ Planes "),an()(),zt(43,"button",25),Ai("focus",function(){return Ci(s),Mi(Ga(46).focus())}),zt(44,"mat-slider",26)(45,"input",27,6),Ai("input",function(l){return Ci(s),Mi(r.addYZPlanes(l))}),an()(),Fi(47),an(),zt(48,"button",23),Ai("click",function(){return Ci(s),Mi(Ga(50)._inputElement.nativeElement.click())}),zt(49,"mat-checkbox",24,7),Qw("ngModelChange",function(l){return Ci(s),iS(r.gridConfig.showZX,l)||(r.gridConfig.showZX=l),Mi(l)}),Ai("click",function(l){return Ci(s),Mi(l.stopPropagation())})("change",function(l){return Ci(s),Mi(r.showZXPlanes(l))}),Fi(51,"Show ZX Planes "),an()(),zt(52,"button",25),Ai("focus",function(){return Ci(s),Mi(Ga(55).focus())}),zt(53,"mat-slider",26)(54,"input",27,8),Ai("input",function(l){return Ci(s),Mi(r.addZXPlanes(l))}),an()(),Fi(56),an(),zt(57,"button",25),Ai("focus",function(){return Ci(s),Mi(Ga(60).focus())}),zt(58,"mat-slider",28)(59,"input",27,9),Ai("input",function(l){return Ci(s),Mi(r.changeSparsity(l))}),an()(),Fi(61),an()()(),zt(62,"div",29)(63,"button",30),Ai("click",function(){return Ci(s),Mi(r.onClose())}),Fi(64," Close "),an()()()}2&i&&(Vn(8),Hn("value",V3(10,19,r.cartesianPos.x/10,"1.2-2")),Vn(6),Hn("value",V3(16,22,r.cartesianPos.y/10,"1.2-2")),Vn(6),Hn("value",V3(22,25,r.cartesianPos.z/10,"1.2-2")),Vn(3),Hn("disabled",r.shiftGrid),Vn(2),Hn("disabled",r.shiftGrid),Vn(6),qw("ngModel",r.gridConfig.showXY),Vn(4),Hn("max",r.scale),Vn(),Hn("value",r.gridConfig.zDistance),Vn(2),yl(" XY Plane (",r.calcPlanes(r.gridConfig.zDistance),") "),Vn(2),qw("ngModel",r.gridConfig.showYZ),Vn(4),Hn("max",r.scale),Vn(),Hn("value",r.gridConfig.xDistance),Vn(2),yl(" YZ Plane (",r.calcPlanes(r.gridConfig.xDistance),") "),Vn(2),qw("ngModel",r.gridConfig.showZX),Vn(4),Hn("max",r.scale),Vn(),Hn("value",r.gridConfig.yDistance),Vn(2),yl(" ZX Plane (",r.calcPlanes(r.gridConfig.yDistance),") "),Vn(3),Hn("value",r.gridConfig.sparsity),Vn(2),yl(" Sparsity (",r.gridConfig.sparsity,") "))},dependencies:[jE,XE,$E,BC,LO,X4,r1,yL,YE,sv,M7],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:row}.item-config-single[_ngcontent-%COMP%]{display:flex;flex-direction:column}.item-config-single[_ngcontent-%COMP%]   .item-config-group[_ngcontent-%COMP%]{margin:.1rem 2rem}.item-config-single[_ngcontent-%COMP%]   .item-config-group[_ngcontent-%COMP%]   .item-config-label[_ngcontent-%COMP%]{display:inline;margin:1rem}.item-config-single[_ngcontent-%COMP%]   .item-config-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{width:60%;display:inline}.item-config-single[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:.5rem 4rem}.item-config-single[_ngcontent-%COMP%]   .explain-button[_ngcontent-%COMP%]{padding-top:1rem}.item-config-single[_ngcontent-%COMP%]   .explain-text[_ngcontent-%COMP%]{width:20rem;opacity:.7;margin-top:.5rem;font-size:.9rem}"]})}return n})();function vbe(n,e){if(1&n&&(Fl(),zt(0,"svg",15),Fr(1,"use"),an()),2&n){const t=Pr().$implicit;Vn(),Nw("href","assets/icons/",t.icon,".svg#",t.icon,"")}}function bbe(n,e){if(1&n){const t=ta();zt(0,"button",11),Ai("click",function(r){const s=Ci(t).$implicit;return Mi(Pr().displayView(r,s))}),zs(1,vbe,2,3,"svg",14),Fi(2),an()}if(2&n){const t=e.$implicit;Vn(),Hn("ngIf",t.icon),Vn(),yl(" ",t.name," ")}}let bL=(()=>{class n{eventDisplay;dialog;trigger;showCartesianGrid=!1;scale=3e3;views;show3DPoints;origin=new It(0,0,0);sub;constructor(t,i){this.eventDisplay=t,this.dialog=i}ngOnInit(){this.views=this.eventDisplay.getUIManager().getPresetViews(),this.sub=this.eventDisplay.getThreeManager().originChanged.subscribe(t=>{this.origin=t})}openCartesianGridConfigDialog(){this.dialog.open(g$,{data:{gridVisible:this.showCartesianGrid,scale:this.scale},position:{bottom:"5rem",left:"3rem"}})}displayView(t,i){t.stopPropagation(),this.eventDisplay.getUIManager().displayView(i)}setAxis(t){const i=t.checked;this.eventDisplay.getUIManager().setShowAxis(i)}setEtaPhiGrid(t){const i=t.checked;this.eventDisplay.getUIManager().setShowEtaPhiGrid(i)}setCartesianGrid(t){this.showCartesianGrid=t.checked,this.eventDisplay.getUIManager().setShowCartesianGrid(this.showCartesianGrid,this.scale)}showLabels(t){this.eventDisplay.getUIManager().showLabels(t.checked)}show3DMousePoints(t){this.show3DPoints=t.checked,this.eventDisplay.getUIManager().show3DMousePoints(this.show3DPoints)}toggleShowDistance(t){this.trigger.closeMenu(),this.eventDisplay.getUIManager().show3DDistance(t.checked)}ngOnDestroy(){this.sub.unsubscribe()}static \u0275fac=function(i){return new(i||n)(Lt(pl),Lt(yx))};static \u0275cmp=Zr({type:n,selectors:[["app-view-options"]],viewQuery:function(i,r){if(1&i&&_l(CC,5),2&i){let s;pa(s=ma())&&(r.trigger=s.first)}},decls:31,vars:3,consts:[["viewOptions",""],["showCartesianGridCheckbox",""],["showEtaPhiGridCheckbox",""],["showAxisCheckbox",""],["showLabelsCheckbox",""],["showMouse3DPointsCheckbox",""],["show3DDistanceCheckbox",""],["mat-menu-item",""],[3,"click","change"],[1,"icon-wrapper","icon-button","btn-blank","item-settings",3,"click"],["href","assets/icons/gear.svg#gear"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["tooltip","View options and Tools","icon","views",3,"matMenuTriggerFor","active"],["class","view-icon",4,"ngIf"],[1,"view-icon"]],template:function(i,r){if(1&i){const s=ta();zt(0,"mat-menu",null,0)(2,"button",7)(3,"mat-checkbox",8,1),Ai("click",function(l){return Ci(s),Mi(l.stopPropagation())})("change",function(l){return Ci(s),Mi(r.setCartesianGrid(l))}),Fi(5,"Show Cartesian Grid "),an(),zt(6,"button",9),Ai("click",function(){return Ci(s),Mi(r.openCartesianGridConfigDialog())}),Fl(),zt(7,"svg"),Fr(8,"use",10),an()()(),Ih(),zt(9,"button",11),Ai("click",function(l){Ci(s);const d=Ga(11);return l.stopPropagation(),Mi(d._inputElement.nativeElement.click())}),zt(10,"mat-checkbox",8,2),Ai("click",function(l){return Ci(s),Mi(l.stopPropagation())})("change",function(l){return Ci(s),Mi(r.setEtaPhiGrid(l))}),Fi(12,"Show Eta Phi Grid "),an()(),zt(13,"button",11),Ai("click",function(l){Ci(s);const d=Ga(15);return l.stopPropagation(),Mi(d._inputElement.nativeElement.click())}),zt(14,"mat-checkbox",8,3),Ai("click",function(l){return Ci(s),Mi(l.stopPropagation())})("change",function(l){return Ci(s),Mi(r.setAxis(l))}),Fi(16,"Show Axis "),an()(),zt(17,"button",11),Ai("click",function(){return Ci(s),Mi(Ga(19)._inputElement.nativeElement.click())}),zt(18,"mat-checkbox",8,4),Ai("click",function(l){return Ci(s),Mi(l.stopPropagation())})("change",function(l){return Ci(s),Mi(r.showLabels(l))}),Fi(20,"Show Labels "),an()(),zt(21,"button",11),Ai("click",function(l){Ci(s);const d=Ga(23);return l.stopPropagation(),Mi(d._inputElement.nativeElement.click())}),zt(22,"mat-checkbox",8,5),Ai("click",function(l){return Ci(s),Mi(l.stopPropagation())})("change",function(l){return Ci(s),Mi(r.show3DMousePoints(l))}),Fi(24,"Show 3D Coordinates "),an()(),zt(25,"button",11),Ai("click",function(l){Ci(s);const d=Ga(27);return l.stopPropagation(),Mi(d._inputElement.nativeElement.click())}),zt(26,"mat-checkbox",8,6),Ai("click",function(l){return Ci(s),Mi(l.stopPropagation())})("change",function(l){return Ci(s),Mi(r.toggleShowDistance(l))}),Fi(28,"Show 3D Distance "),an()(),zs(29,bbe,3,2,"button",12),an(),Fr(30,"app-menu-toggle",13)}if(2&i){const s=Ga(1);Vn(29),Hn("ngForOf",r.views),Vn(),Hn("matMenuTriggerFor",s)("active",!1)}},dependencies:[am,Lh,s1,r1,CC,sv,qc],styles:[".view-icon[_ngcontent-%COMP%]{width:1.2rem;height:1.2rem;margin-right:.5rem}.icon-wrapper[_ngcontent-%COMP%]{display:inline-block;width:1.5rem;height:1.5rem;padding:.23rem;transition:all .4s;transform:translateY(27%)}.icon-wrapper.icon-button[_ngcontent-%COMP%]:hover{background:var(--phoenix-options-icon-bg);border-radius:40%;cursor:pointer}.icon-wrapper[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:top}.item-settings[_ngcontent-%COMP%]{margin-right:.2rem;margin-left:.5rem}"]})}return n})();function wbe(n,e){1&n&&(zt(0,"li",2),Fi(1," No actions. "),an())}function Cbe(n,e){if(1&n&&(zt(0,"li",2),Fi(1),an()),2&n){const t=e.$implicit;Vn(),yl(" ",t," ")}}let _$=(()=>{class n{eventDisplay;showInfoPanel;actionsList=[];version="2.16.0";constructor(t){this.eventDisplay=t}ngOnInit(){this.actionsList=this.eventDisplay.getInfoLogger().getInfoLoggerList()}static \u0275fac=function(i){return new(i||n)(Lt(pl))};static \u0275cmp=Zr({type:n,selectors:[["app-info-panel-overlay"]],inputs:{showInfoPanel:"showInfoPanel"},decls:6,vars:5,consts:[["overlayTitle","Info Panel","icon","info-panel",3,"resizable","active"],[1,"list-group","list-group-flush"],[1,"list-group-item"],["class","list-group-item",4,"ngIf"],["class","list-group-item",4,"ngFor","ngForOf"]],template:function(i,r){1&i&&(zt(0,"app-overlay",0)(1,"ul",1)(2,"li",2),Fi(3),an(),zs(4,wbe,2,0,"li",3)(5,Cbe,2,1,"li",4),an()()),2&i&&(Hn("resizable",!0)("active",r.showInfoPanel),Vn(3),yl(" Phoenix Version: ",r.version," "),Vn(),Hn("ngIf",0===r.actionsList.length),Vn(),Hn("ngForOf",r.actionsList))},dependencies:[am,Lh,IC],styles:[".list-group-item[_ngcontent-%COMP%]{font-size:.8rem;padding:.5rem 1rem}"]})}return n})(),xL=(()=>{class n{overlay;showInfoPanel=!1;overlayWindow;constructor(t){this.overlay=t}ngOnInit(){const t=this.overlay.create(),i=new e1(_$);this.overlayWindow=t.attach(i),this.overlayWindow.instance.showInfoPanel=this.showInfoPanel}ngOnDestroy(){this.overlayWindow.destroy()}toggleOverlay(){this.showInfoPanel=!this.showInfoPanel,this.overlayWindow.instance.showInfoPanel=this.showInfoPanel}static \u0275fac=function(i){return new(i||n)(Lt(pu))};static \u0275cmp=Zr({type:n,selectors:[["app-info-panel"]],decls:1,vars:1,consts:[["tooltip","Info panel","icon","info-panel",3,"click","active"]],template:function(i,r){1&i&&(zt(0,"app-menu-toggle",0),Ai("click",function(){return r.toggleOverlay()}),an()),2&i&&Hn("active",r.showInfoPanel)},dependencies:[qc]})}return n})(),oB=(()=>{class n{eventDisplay;orthographicView=!1;constructor(t){this.eventDisplay=t}switchMainView(){this.orthographicView=!this.orthographicView,this.eventDisplay.getUIManager().toggleOrthographicView(this.orthographicView)}static \u0275fac=function(i){return new(i||n)(Lt(pl))};static \u0275cmp=Zr({type:n,selectors:[["app-main-view-toggle"]],decls:1,vars:2,consts:[[3,"click","icon","matTooltip"]],template:function(i,r){1&i&&(zt(0,"app-menu-toggle",0),Ai("click",function(){return r.switchMainView()}),an()),2&i&&Hn("icon",r.orthographicView?"perspective":"orthographic")("matTooltip","Switch to "+(r.orthographicView?"perspective":"orthographic")+" view")},dependencies:[o1,qc]})}return n})(),wL=(()=>{class n{eventDisplay;allCameras;zoomFactor=1.1;zoomTimeout;zoomTime=200;constructor(t){this.eventDisplay=t}zoomTo(t){this.zoomTime=this.zoomTime>30?Math.floor(this.zoomTime/1.1):this.zoomTime,this.eventDisplay.zoomTo(t,this.zoomTime),this.zoomTimeout=setTimeout(()=>{this.zoomTo(t)},this.zoomTime)}zoomIn(t){t&&this.zoomTo(1/this.zoomFactor)}zoomOut(t){t&&this.zoomTo(this.zoomFactor)}clearZoom(){this.zoomTime=200,clearTimeout(this.zoomTimeout)}static \u0275fac=function(i){return new(i||n)(Lt(pl))};static \u0275cmp=Zr({type:n,selectors:[["app-zoom-controls"]],decls:3,vars:2,consts:[[1,"d-flex"],["tooltip","Zoom out (hold)","icon","zoom-out",3,"click","touchstart","mousedown","mouseup","mouseleave","touchend","touchcancel","touchmove","active"],["tooltip","Zoom in (hold)","icon","zoom-in",3,"click","touchstart","mousedown","mouseup","mouseleave","touchend","touchcancel","touchmove","active"]],template:function(i,r){1&i&&(zt(0,"div",0)(1,"app-menu-toggle",1),Ai("click",function(){return r.zoomOut(!0),r.clearZoom()})("touchstart",function(){return r.zoomOut(!0)})("mousedown",function(a){return r.zoomOut(0===a.button)})("mouseup",function(){return r.clearZoom()})("mouseleave",function(){return r.clearZoom()})("touchend",function(){return r.clearZoom()})("touchcancel",function(){return r.clearZoom()})("touchmove",function(){return r.clearZoom()}),an(),zt(2,"app-menu-toggle",2),Ai("click",function(){return r.zoomIn(!0),r.clearZoom()})("touchstart",function(){return r.zoomIn(!0)})("mousedown",function(a){return r.zoomIn(0===a.button)})("mouseup",function(){return r.clearZoom()})("mouseleave",function(){return r.clearZoom()})("touchend",function(){return r.clearZoom()})("touchcancel",function(){return r.clearZoom()})("touchmove",function(){return r.clearZoom()}),an()()),2&i&&(Vn(),Hn("active",!1),Vn(),Hn("active",!1))},dependencies:[qc]})}return n})(),aB=(()=>{class n{eventDisplay;isAnimating=!1;constructor(t){this.eventDisplay=t}toggleAnimateEvent(){this.isAnimating||(this.isAnimating=!0,this.eventDisplay.animateEventWithCollision(1e4,()=>{this.isAnimating=!1}))}static \u0275fac=function(i){return new(i||n)(Lt(pl))};static \u0275cmp=Zr({type:n,selectors:[["app-animate-event"]],decls:1,vars:1,consts:[["tooltip","Animate event","icon","event-folder",3,"click","active"]],template:function(i,r){1&i&&(zt(0,"app-menu-toggle",0),Ai("click",function(){return r.toggleAnimateEvent()}),an()),2&i&&Hn("active",r.isAnimating)},dependencies:[qc]})}return n})(),CL=(()=>{class n{eventDisplay;vrSupported=!1;vrActive=!1;constructor(t){this.eventDisplay=t,navigator?.xr?.isSessionSupported?.(Gq.SESSION_TYPE).then(i=>{i&&(this.vrSupported=!0)}).catch(i=>console.warn("Error in VR",i))}toggleVr(){this.vrActive?(this.eventDisplay.endXR(mm.VR),this.vrActive=!1):(this.eventDisplay.initXR(mm.VR,()=>{this.vrActive=!1,this.eventDisplay.endXR(mm.VR)}),this.vrActive=!0)}static \u0275fac=function(i){return new(i||n)(Lt(pl))};static \u0275cmp=Zr({type:n,selectors:[["app-vr-toggle"]],decls:1,vars:3,consts:[["icon","vr",3,"click","disabled","active","tooltip"]],template:function(i,r){1&i&&(zt(0,"app-menu-toggle",0),Ai("click",function(){return r.vrSupported&&r.toggleVr()}),an()),2&i&&Hn("disabled",!r.vrSupported)("active",r.vrActive)("tooltip",r.vrSupported?r.vrActive?"Exit VR":"Enter VR":"VR not supported")},dependencies:[qc]})}return n})();function Mbe(n,e){if(1&n){const t=ta();ng(0),zt(1,"button",4),Ai("click",function(){return Ci(t),Mi(Pr().toggleAr(!0))}),Fi(2,"AR with overlays"),an(),zt(3,"button",4),Ai("click",function(){return Ci(t),Mi(Pr().toggleAr(!1))}),Fi(4,"AR without overlays"),an(),ig()}}function Sbe(n,e){1&n&&(zt(0,"button",5),Fi(1,"AR not supported"),an())}let ML=(()=>{class n{eventDisplay;arSupported=!1;arActive=!1;constructor(t){this.eventDisplay=t,navigator.xr?.isSessionSupported?.(HF.SESSION_TYPE).then(i=>{i&&(this.arSupported=!0)}).catch(i=>console.warn("Error in AR",i))}toggleAr(t=!0){HF.enableDomOverlay=t,this.arActive?(this.eventDisplay.endXR(mm.AR),this.arActive=!1):(this.eventDisplay.initXR(mm.AR,()=>{this.arActive=!1,this.eventDisplay.endXR(mm.AR)}),this.arActive=!0)}static \u0275fac=function(i){return new(i||n)(Lt(pl))};static \u0275cmp=Zr({type:n,selectors:[["app-ar-toggle"]],decls:5,vars:6,consts:[["arToggleOptions",""],[4,"ngIf"],["mat-menu-item","","disabled","",4,"ngIf"],["icon","ar",3,"click","matMenuTriggerFor","disabled","active","tooltip"],["mat-menu-item","",3,"click"],["mat-menu-item","","disabled",""]],template:function(i,r){if(1&i){const s=ta();zt(0,"mat-menu",null,0),zs(2,Mbe,5,0,"ng-container",1)(3,Sbe,2,0,"button",2),an(),zt(4,"app-menu-toggle",3),Ai("click",function(){return Ci(s),Mi(r.arSupported&&(r.arActive?r.toggleAr():null))}),an()}if(2&i){const s=Ga(1);Vn(2),Hn("ngIf",r.arSupported),Vn(),Hn("ngIf",!r.arSupported),Vn(),Hn("matMenuTriggerFor",s)("disabled",!r.arSupported)("active",r.arActive)("tooltip",r.arSupported?r.arActive?"Exit AR":"Enter AR":"AR not supported")}},dependencies:[Lh,s1,r1,CC,qc]})}return n})(),SL=(()=>{class n{ssMode=!1;ngOnInit(){document.onfullscreenchange=()=>{document.fullscreenElement||this.toggleSSMode()}}toggleSSMode(){this.ssMode=!this.ssMode,document.body.classList.toggle("ss-mode"),this.ssMode?(setTimeout(()=>{document.addEventListener("click",this.onDocumentClick),document.addEventListener("touchstart",this.onDocumentClick)},1),document.documentElement.requestFullscreen?.()):(document.removeEventListener("click",this.onDocumentClick),document.removeEventListener("touchstart",this.onDocumentClick))}onDocumentClick=()=>{document.exitFullscreen?.()};static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Zr({type:n,selectors:[["app-ss-mode"]],decls:1,vars:1,consts:[["tooltip","Screenshot mode: phoenix will become fullscreen and the menu is suppressed","icon","ss-mode",3,"click","active"]],template:function(i,r){1&i&&(zt(0,"app-menu-toggle",0),Ai("click",function(){return r.toggleSSMode()}),an()),2&i&&Hn("active",r.ssMode)},dependencies:[qc],styles:["#uiMenu,#phoenixMenu,#mainLogo,#statsElement{transition:opacity .4s}.ss-mode #uiMenu,.ss-mode #phoenixMenu,.ss-mode #mainLogo,.ss-mode #statsElement{visibility:hidden;opacity:0}\n"],encapsulation:2})}return n})(),Dbe=(()=>{class n{constructor(){this._listeners=[]}notify(t,i){for(let r of this._listeners)r(t,i)}listen(t){return this._listeners.push(t),()=>{this._listeners=this._listeners.filter(i=>t!==i)}}ngOnDestroy(){this._listeners=[]}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Ibe=["input"],Bbe=["formField"],Pbe=["*"];let y$=0;class v${constructor(e,t){this.source=e,this.value=t}}const Rbe={provide:Of,useExisting:jt(()=>x$),multi:!0},b$=new Bi("MatRadioGroup"),kbe=new Bi("mat-radio-default-options",{providedIn:"root",factory:function Fbe(){return{color:"accent"}}});let x$=(()=>{class n{get name(){return this._name}set name(t){this._name=t,this._updateRadioButtonNames()}get labelPosition(){return this._labelPosition}set labelPosition(t){this._labelPosition="before"===t?"before":"after",this._markRadiosForCheck()}get value(){return this._value}set value(t){this._value!==t&&(this._value=t,this._updateSelectedRadioFromValue(),this._checkSelectedRadioButton())}_checkSelectedRadioButton(){this._selected&&!this._selected.checked&&(this._selected.checked=!0)}get selected(){return this._selected}set selected(t){this._selected=t,this.value=t?t.value:null,this._checkSelectedRadioButton()}get disabled(){return this._disabled}set disabled(t){this._disabled=t,this._markRadiosForCheck()}get required(){return this._required}set required(t){this._required=t,this._markRadiosForCheck()}constructor(t){this._changeDetector=t,this._value=null,this._name="mat-radio-group-"+y$++,this._selected=null,this._isInitialized=!1,this._labelPosition="after",this._disabled=!1,this._required=!1,this._controlValueAccessorChangeFn=()=>{},this.onTouched=()=>{},this.change=new Ls}ngAfterContentInit(){this._isInitialized=!0,this._buttonChanges=this._radios.changes.subscribe(()=>{this.selected&&!this._radios.find(t=>t===this.selected)&&(this._selected=null)})}ngOnDestroy(){this._buttonChanges?.unsubscribe()}_touch(){this.onTouched&&this.onTouched()}_updateRadioButtonNames(){this._radios&&this._radios.forEach(t=>{t.name=this.name,t._markForCheck()})}_updateSelectedRadioFromValue(){this._radios&&(null===this._selected||this._selected.value!==this._value)&&(this._selected=null,this._radios.forEach(i=>{i.checked=this.value===i.value,i.checked&&(this._selected=i)}))}_emitChangeEvent(){this._isInitialized&&this.change.emit(new v$(this._selected,this._value))}_markRadiosForCheck(){this._radios&&this._radios.forEach(t=>t._markForCheck())}writeValue(t){this.value=t,this._changeDetector.markForCheck()}registerOnChange(t){this._controlValueAccessorChangeFn=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this.disabled=t,this._changeDetector.markForCheck()}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(Sc))};static#t=this.\u0275dir=Ft({type:n,selectors:[["mat-radio-group"]],contentQueries:function(i,r,s){if(1&i&&mp(s,TL,5),2&i){let a;pa(a=ma())&&(r._radios=a)}},hostAttrs:["role","radiogroup",1,"mat-mdc-radio-group"],inputs:{color:"color",name:"name",labelPosition:"labelPosition",value:"value",selected:"selected",disabled:[mi.HasDecoratorInputTransform,"disabled","disabled",_o],required:[mi.HasDecoratorInputTransform,"required","required",_o]},outputs:{change:"change"},exportAs:["matRadioGroup"],standalone:!0,features:[qo([Rbe,{provide:b$,useExisting:n}]),ql]})}return n})(),TL=(()=>{class n{get checked(){return this._checked}set checked(t){this._checked!==t&&(this._checked=t,t&&this.radioGroup&&this.radioGroup.value!==this.value?this.radioGroup.selected=this:!t&&this.radioGroup&&this.radioGroup.value===this.value&&(this.radioGroup.selected=null),t&&this._radioDispatcher.notify(this.id,this.name),this._changeDetector.markForCheck())}get value(){return this._value}set value(t){this._value!==t&&(this._value=t,null!==this.radioGroup&&(this.checked||(this.checked=this.radioGroup.value===t),this.checked&&(this.radioGroup.selected=this)))}get labelPosition(){return this._labelPosition||this.radioGroup&&this.radioGroup.labelPosition||"after"}set labelPosition(t){this._labelPosition=t}get disabled(){return this._disabled||null!==this.radioGroup&&this.radioGroup.disabled}set disabled(t){this._setDisabled(t)}get required(){return this._required||this.radioGroup&&this.radioGroup.required}set required(t){this._required=t}get color(){return this._color||this.radioGroup&&this.radioGroup.color||this._providerOverride&&this._providerOverride.color||"accent"}set color(t){this._color=t}get inputId(){return`${this.id||this._uniqueId}-input`}constructor(t,i,r,s,a,l,d,u){this._elementRef=i,this._changeDetector=r,this._focusMonitor=s,this._radioDispatcher=a,this._providerOverride=d,this._uniqueId="mat-radio-"+ ++y$,this.id=this._uniqueId,this.disableRipple=!1,this.tabIndex=0,this.change=new Ls,this._checked=!1,this._value=null,this._removeUniqueSelectionListener=()=>{},this.radioGroup=t,this._noopAnimations="NoopAnimations"===l,u&&(this.tabIndex=su(u,0))}focus(t,i){i?this._focusMonitor.focusVia(this._inputElement,i,t):this._inputElement.nativeElement.focus(t)}_markForCheck(){this._changeDetector.markForCheck()}ngOnInit(){this.radioGroup&&(this.checked=this.radioGroup.value===this._value,this.checked&&(this.radioGroup.selected=this),this.name=this.radioGroup.name),this._removeUniqueSelectionListener=this._radioDispatcher.listen((t,i)=>{t!==this.id&&i===this.name&&(this.checked=!1)})}ngDoCheck(){this._updateTabIndex()}ngAfterViewInit(){this._updateTabIndex(),this._focusMonitor.monitor(this._elementRef,!0).subscribe(t=>{!t&&this.radioGroup&&this.radioGroup._touch()})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._removeUniqueSelectionListener()}_emitChangeEvent(){this.change.emit(new v$(this,this._value))}_isRippleDisabled(){return this.disableRipple||this.disabled}_onInputClick(t){t.stopPropagation()}_onInputInteraction(t){if(t.stopPropagation(),!this.checked&&!this.disabled){const i=this.radioGroup&&this.value!==this.radioGroup.value;this.checked=!0,this._emitChangeEvent(),this.radioGroup&&(this.radioGroup._controlValueAccessorChangeFn(this.value),i&&this.radioGroup._emitChangeEvent())}}_onTouchTargetClick(t){this._onInputInteraction(t),this.disabled||this._inputElement.nativeElement.focus()}_setDisabled(t){this._disabled!==t&&(this._disabled=t,this._changeDetector.markForCheck())}_updateTabIndex(){const t=this.radioGroup;let i;if(i=t&&t.selected&&!this.disabled?t.selected===this?this.tabIndex:-1:this.tabIndex,i!==this._previousTabIndex){const r=this._inputElement?.nativeElement;r&&(r.setAttribute("tabindex",i+""),this._previousTabIndex=i)}}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(b$,8),Lt(oo),Lt(Sc),Lt(J_),Lt(Dbe),Lt(Od,8),Lt(kbe,8),xu("tabindex"))};static#t=this.\u0275cmp=Zr({type:n,selectors:[["mat-radio-button"]],viewQuery:function(i,r){if(1&i&&(_l(Ibe,5),_l(Bbe,7,oo)),2&i){let s;pa(s=ma())&&(r._inputElement=s.first),pa(s=ma())&&(r._rippleTrigger=s.first)}},hostAttrs:[1,"mat-mdc-radio-button"],hostVars:15,hostBindings:function(i,r){1&i&&Ai("focus",function(){return r._inputElement.nativeElement.focus()}),2&i&&(sl("id",r.id)("tabindex",null)("aria-label",null)("aria-labelledby",null)("aria-describedby",null),Ja("mat-primary","primary"===r.color)("mat-accent","accent"===r.color)("mat-warn","warn"===r.color)("mat-mdc-radio-checked",r.checked)("_mat-animation-noopable",r._noopAnimations))},inputs:{id:"id",name:"name",ariaLabel:[mi.None,"aria-label","ariaLabel"],ariaLabelledby:[mi.None,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[mi.None,"aria-describedby","ariaDescribedby"],disableRipple:[mi.HasDecoratorInputTransform,"disableRipple","disableRipple",_o],tabIndex:[mi.HasDecoratorInputTransform,"tabIndex","tabIndex",t=>null==t?0:su(t)],checked:[mi.HasDecoratorInputTransform,"checked","checked",_o],value:"value",labelPosition:"labelPosition",disabled:[mi.HasDecoratorInputTransform,"disabled","disabled",_o],required:[mi.HasDecoratorInputTransform,"required","required",_o],color:"color"},outputs:{change:"change"},exportAs:["matRadioButton"],standalone:!0,features:[ql,yd],ngContentSelectors:Pbe,decls:13,vars:16,consts:[["formField",""],["input",""],["mat-internal-form-field","",3,"labelPosition"],[1,"mdc-radio"],[1,"mat-mdc-radio-touch-target",3,"click"],["type","radio",1,"mdc-radio__native-control",3,"change","id","checked","disabled","required"],[1,"mdc-radio__background"],[1,"mdc-radio__outer-circle"],[1,"mdc-radio__inner-circle"],["mat-ripple","",1,"mat-radio-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mat-ripple-element","mat-radio-persistent-ripple"],[1,"mdc-label",3,"for"]],template:function(i,r){if(1&i){const s=ta();vh(),zt(0,"div",2,0)(2,"div",3)(3,"div",4),Ai("click",function(l){return Ci(s),Mi(r._onTouchTargetClick(l))}),an(),zt(4,"input",5,1),Ai("change",function(l){return Ci(s),Mi(r._onInputInteraction(l))}),an(),zt(6,"div",6),Fr(7,"div",7)(8,"div",8),an(),zt(9,"div",9),Fr(10,"div",10),an()(),zt(11,"label",11),ru(12),an()()}2&i&&(Hn("labelPosition",r.labelPosition),Vn(2),Ja("mdc-radio--disabled",r.disabled),Vn(2),Hn("id",r.inputId)("checked",r.checked)("disabled",r.disabled)("required",r.required),sl("name",r.name)("value",r.value)("aria-label",r.ariaLabel)("aria-labelledby",r.ariaLabelledby)("aria-describedby",r.ariaDescribedby),Vn(5),Hn("matRippleTrigger",r._rippleTrigger.nativeElement)("matRippleDisabled",r._isRippleDisabled())("matRippleCentered",!0),Vn(2),Hn("for",r.inputId))},dependencies:[R0,CO],styles:['.mdc-radio{display:inline-block;position:relative;flex:0 0 auto;box-sizing:content-box;width:20px;height:20px;cursor:pointer;will-change:opacity,transform,border-color,color}.mdc-radio[hidden]{display:none}.mdc-radio__background{display:inline-block;position:relative;box-sizing:border-box;width:20px;height:20px}.mdc-radio__background::before{position:absolute;transform:scale(0, 0);border-radius:50%;opacity:0;pointer-events:none;content:"";transition:opacity 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-radio__outer-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;border-width:2px;border-style:solid;border-radius:50%;transition:border-color 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-radio__inner-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;transform:scale(0, 0);border-width:10px;border-style:solid;border-radius:50%;transition:transform 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1),border-color 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-radio__native-control{position:absolute;margin:0;padding:0;opacity:0;cursor:inherit;z-index:1}.mdc-radio--touch{margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}.mdc-radio--touch .mdc-radio__native-control{top:calc((40px - 48px) / 2);right:calc((40px - 48px) / 2);left:calc((40px - 48px) / 2);width:48px;height:48px}.mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__focus-ring,.mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%}@media screen and (forced-colors: active){.mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__focus-ring,.mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__focus-ring{border-color:CanvasText}}.mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__focus-ring::after,.mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__focus-ring::after,.mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__focus-ring::after{border-color:CanvasText}}.mdc-radio__native-control:checked+.mdc-radio__background,.mdc-radio__native-control:disabled+.mdc-radio__background{transition:opacity 120ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__outer-circle{transition:border-color 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__inner-circle,.mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle{transition:transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1),border-color 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio--disabled{cursor:default;pointer-events:none}.mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__inner-circle{transform:scale(0.5);transition:transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1),border-color 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio__native-control:disabled+.mdc-radio__background,[aria-disabled=true] .mdc-radio__native-control+.mdc-radio__background{cursor:default}.mdc-radio__native-control:focus+.mdc-radio__background::before{transform:scale(1);opacity:.12;transition:opacity 120ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-radio-button .mdc-radio{padding:calc((var(--mdc-radio-state-layer-size) - 20px) / 2)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-selected-icon-color)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-disabled-selected-icon-color)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled:checked+.mdc-radio__background .mdc-radio__outer-circle{opacity:var(--mdc-radio-disabled-selected-icon-opacity)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle{opacity:var(--mdc-radio-disabled-selected-icon-opacity)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-unselected-icon-color)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{opacity:var(--mdc-radio-disabled-unselected-icon-opacity)}.mat-mdc-radio-button .mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-selected-focus-icon-color)}.mat-mdc-radio-button .mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__native-control:enabled+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__native-control:enabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-focus-icon-color)}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-selected-hover-icon-color)}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:enabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-hover-icon-color)}.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-selected-icon-color)}.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:enabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-icon-color)}.mat-mdc-radio-button .mdc-radio:not(:disabled):active .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-selected-pressed-icon-color)}.mat-mdc-radio-button .mdc-radio:not(:disabled):active .mdc-radio__native-control:enabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-pressed-icon-color)}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-hover-icon-color)}.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-icon-color)}.mat-mdc-radio-button .mdc-radio:not(:disabled):active .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-pressed-icon-color)}.mat-mdc-radio-button .mdc-radio .mdc-radio__background::before{top:calc(-1 * (var(--mdc-radio-state-layer-size) - 20px) / 2);left:calc(-1 * (var(--mdc-radio-state-layer-size) - 20px) / 2);width:var(--mdc-radio-state-layer-size);height:var(--mdc-radio-state-layer-size)}.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control{top:calc((var(--mdc-radio-state-layer-size) - var(--mdc-radio-state-layer-size)) / 2);right:calc((var(--mdc-radio-state-layer-size) - var(--mdc-radio-state-layer-size)) / 2);left:calc((var(--mdc-radio-state-layer-size) - var(--mdc-radio-state-layer-size)) / 2);width:var(--mdc-radio-state-layer-size);height:var(--mdc-radio-state-layer-size)}.mat-mdc-radio-button .mdc-radio .mdc-radio__background::before{background-color:var(--mat-radio-ripple-color)}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:not([disabled]):not(:focus)~.mdc-radio__background::before{opacity:.04;transform:scale(1)}.mat-mdc-radio-button.mat-mdc-radio-checked .mdc-radio__background::before{background-color:var(--mat-radio-checked-ripple-color)}.mat-mdc-radio-button.mat-mdc-radio-checked .mat-ripple-element{background-color:var(--mat-radio-checked-ripple-color)}.mat-mdc-radio-button .mdc-radio--disabled+label{color:var(--mat-radio-disabled-label-color)}.mat-mdc-radio-button .mat-radio-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:50%}.mat-mdc-radio-button .mat-radio-ripple .mat-ripple-element{opacity:.14}.mat-mdc-radio-button .mat-radio-ripple::before{border-radius:50%}.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__background::before,.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__outer-circle,.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__inner-circle{transition:none !important}.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:focus:enabled:not(:checked)~.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-focus-icon-color, black)}.mat-mdc-radio-button.cdk-focused .mat-mdc-focus-indicator::before{content:""}.mat-mdc-radio-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-radio-touch-target-display)}[dir=rtl] .mat-mdc-radio-touch-target{left:0;right:50%;transform:translate(50%, -50%)}'],encapsulation:2,changeDetection:0})}return n})(),Obe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({imports:[Wd,fS,P4,TL,Wd]})}return n})();function Lbe(n,e){if(1&n&&(zt(0,"mat-radio-button",12),Fi(1),an()),2&n){const t=e.$implicit;Hn("value",t),Vn(),yl("",t," ")}}let DL=(()=>{class n{eventDisplay;fittings=["Crop","Stretch"];fitting="Crop";width=3840;height=2160;disabled=!1;constructor(t){this.eventDisplay=t}ngOnInit(){}checkSize(){return this.eventDisplay.getThreeManager().checkScreenShotCanvasSize(this.width,this.height,this.fitting)}setWidth(t){this.width=t,this.disabled=!this.checkSize()}setHeight(t){this.height=t,this.disabled=!this.checkSize()}buttonText(){return this.disabled?"Size too large":"Create picture"}makePicture(){this.eventDisplay.getThreeManager().makeScreenShot(this.width,this.height,this.fitting)}static \u0275fac=function(i){return new(i||n)(Lt(pl))};static \u0275cmp=Zr({type:n,selectors:[["app-make-picture"]],decls:20,vars:11,consts:[["menu",""],["width",""],["height",""],[1,"mat-menu"],["mat-menu-item","",1,"size-input",3,"click"],["mapInput","","type","number",3,"change","click","value"],["mat-menu-item","",3,"click"],[1,"fitting-radios",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["mat-menu-item","",1,"make-picture",3,"click","disabled"],["tooltip","Creates a picture from the current view: directly saves a png of arbitrary size from the current view","icon","png",3,"matMenuTriggerFor"],["hidden","","id","screenshotCanvas"],[3,"value"]],template:function(i,r){if(1&i){const s=ta();zt(0,"mat-menu",3,0)(2,"button",4),Ai("click",function(l){return Ci(s),Mi(l.stopPropagation())}),zt(3,"label"),Fi(4,"width"),an(),zt(5,"input",5,1),Ai("change",function(){Ci(s);const l=Ga(6);return Mi(r.setWidth(l.value))})("click",function(l){return Ci(s),Mi(l.stopPropagation())}),an()(),zt(7,"button",4),Ai("click",function(l){return Ci(s),Mi(l.stopPropagation())}),zt(8,"label"),Fi(9,"height"),an(),zt(10,"input",5,2),Ai("change",function(){Ci(s);const l=Ga(11);return Mi(r.setHeight(l.value))})("click",function(l){return Ci(s),Mi(l.stopPropagation())}),an()(),zt(12,"button",6),Ai("click",function(l){return Ci(s),Mi(l.stopPropagation())}),zt(13,"mat-radio-group",7),Qw("ngModelChange",function(l){return Ci(s),iS(r.fitting,l)||(r.fitting=l),Mi(l)}),zs(14,Lbe,2,2,"mat-radio-button",8),an()(),zt(15,"button",9),Ai("click",function(){return Ci(s),Mi(r.makePicture())}),Fi(16),an()(),Fr(17,"app-menu-toggle",10),zt(18,"div"),Fr(19,"canvas",11),an()}if(2&i){const s=Ga(1);Vn(5),Ja("badSize",r.disabled),Hn("value",3840),Vn(5),Ja("badSize",r.disabled),Hn("value",2610),Vn(3),qw("ngModel",r.fitting),Vn(),Hn("ngForOf",r.fittings),Vn(),Hn("disabled",r.disabled),Vn(),yl(" ",r.buttonText()," "),Vn(),Hn("matMenuTriggerFor",s)}},dependencies:[am,LO,X4,s1,r1,CC,x$,TL,qc],styles:[".size-input{background:transparent;color:var(--phoenix-text-color);text-align:center}.size-input label{width:60px}.size-input input{background:transparent;color:var(--phoenix-text-color);width:80px}.badSize{border-color:red}.make-picture{text-align:center;display:block}.make-picture span{padding:5px 25px;border:2px solid var(--phoenix-text-color);border-radius:8px}\n"],encapsulation:2})}return n})(),IL=(()=>{class n{eventDisplay;performanceMode=!1;constructor(t){this.eventDisplay=t}togglePerformance(){this.performanceMode=!this.performanceMode,this.eventDisplay.getThreeManager().setAntialiasing(!this.performanceMode)}static \u0275fac=function(i){return new(i||n)(Lt(pl))};static \u0275cmp=Zr({type:n,selectors:[["app-performance-toggle"]],decls:1,vars:1,consts:[["tooltip","Performance mode","icon","performance",3,"click","active"]],template:function(i,r){1&i&&(zt(0,"app-menu-toggle",0),Ai("click",function(){return r.togglePerformance()}),an()),2&i&&Hn("active",r.performanceMode)},dependencies:[qc]})}return n})();var Nbe=Se(1230);const Ube=["qrcodeCanvas"];let w$=(()=>{class n{dialogRef;baseLink;shareLink;embedLink;urlOptions=Object.assign({},Pge);qrcodeCanvas;constructor(t){this.dialogRef=t;const i=window.location.href,r=-1===i.lastIndexOf("?")?i.length:i.lastIndexOf("?");this.baseLink=i.slice(0,r),this.shareLink=new mC(this.baseLink),this.embedLink=this.getEmbedLink()}ngAfterViewInit(){this.updateQRCode(this.shareLink.value),this.shareLink.onUpdate(this.updateQRCode.bind(this))}onClose(){this.dialogRef.close()}getEmbedLink(t=""){return`<iframe src="${this.baseLink}?embed=true${t?"&":""}${t}"></iframe>`}setOptionValue(t,i){this.urlOptions[t]=i,this.onOptionsChange()}onOptionsChange(){const t=Object.getOwnPropertyNames(this.urlOptions).reduce((i,r)=>(this.urlOptions[r]&&i.push(`${r}=${encodeURI(this.urlOptions[r])}`),i),[]).join("&");this.shareLink.update(this.baseLink+(t?"?":"")+t),this.embedLink=this.getEmbedLink(t)}copyText(t,i){const r=document.createElement("input");document.body.appendChild(r),r.value=t,r.select(),document.execCommand("copy"),document.body.removeChild(r),i.focus(),i.innerText="COPIED",setTimeout(()=>{i.innerText="COPY"},2e3)}updateQRCode(t){Nbe.toCanvas(this.qrcodeCanvas.nativeElement,t)}static \u0275fac=function(i){return new(i||n)(Lt(_x))};static \u0275cmp=Zr({type:n,selectors:[["app-share-link-dialog"]],viewQuery:function(i,r){if(1&i&&_l(Ube,5),2&i){let s;pa(s=ma())&&(r.qrcodeCanvas=s.first)}},decls:49,vars:5,consts:[["qrcodeCanvas",""],[1,"dialog"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-content"],[1,"form-group","mt-2"],["for","eventDataFile"],["type","text","id","eventDataFile","placeholder","assets/files/event_data/atlaseventdump2.json",1,"form-control",3,"input","value"],[1,"form-group"],["for","eventDataType"],["id","eventDataType",1,"form-control",3,"input"],["selected","","value",""],["value","jivexml"],["value","json"],["for","configuration"],["type","text","id","configuration","placeholder","assets/files/config/phoenix-config.json",1,"form-control",3,"input","value"],[3,"change","checked"],[1,"share-box","my-2"],[1,"share-box-copy",3,"click"],[1,"qrcode","d-flex","justify-content-center"],["mat-dialog-actions",""],["mat-button","","cdkFocusInitial","",3,"click"]],template:function(i,r){if(1&i){const s=ta();zt(0,"div",1)(1,"h1",2),Fi(2,"Create shareable link"),an(),zt(3,"div",3)(4,"h5"),Fi(5,"URL options"),an(),zt(6,"div",4)(7,"label",5),Fi(8,"Event data file (URL or path)"),an(),zt(9,"input",6),Ai("input",function(l){return Ci(s),Mi(r.setOptionValue("file",l.target.value))}),an()(),zt(10,"div",7)(11,"label",8),Fi(12,"Event data type"),an(),zt(13,"select",9),Ai("input",function(l){return Ci(s),Mi(r.setOptionValue("type",l.target.value))}),zt(14,"option",10),Fi(15,"Select"),an(),zt(16,"option",11),Fi(17,"JiveXML"),an(),zt(18,"option",12),Fi(19,"JSON"),an()()(),zt(20,"div",7)(21,"label",13),Fi(22,"Configuration (URL or path)"),an(),zt(23,"input",14),Ai("input",function(l){return Ci(s),Mi(r.setOptionValue("config",l.target.value))}),an()(),zt(24,"div",7)(25,"mat-checkbox",15),Ai("change",function(l){return Ci(s),Mi(r.setOptionValue("hideWidgets",l.checked))}),Fi(26," Hide all widgets "),an()(),zt(27,"h5"),Fi(28,"Share"),an(),zt(29,"div",16)(30,"span"),Fi(31),an(),zt(32,"button",17),Ai("click",function(l){return Ci(s),Mi(r.copyText(r.shareLink.value,l.target))}),Fi(33," COPY "),an()(),zt(34,"h5"),Fi(35,"Embed"),an(),zt(36,"div",16)(37,"span"),Fi(38),an(),zt(39,"button",17),Ai("click",function(l){return Ci(s),Mi(r.copyText(r.embedLink,l.target))}),Fi(40," COPY "),an()(),zt(41,"h5"),Fi(42,"QR Code"),an(),zt(43,"div",18),Fr(44,"canvas",null,0),an()(),zt(46,"div",19)(47,"button",20),Ai("click",function(){return Ci(s),Mi(r.onClose())}),Fi(48,"Close"),an()()()}2&i&&(Vn(9),Hn("value",r.urlOptions.file),Vn(14),Hn("value",r.urlOptions.config),Vn(2),Hn("checked",r.urlOptions.hideWidgets),Vn(6),tA(r.shareLink.value),Vn(7),tA(r.embedLink))},dependencies:[jE,XE,$E,BC,EC,TC,sv],styles:[".share-box[_ngcontent-%COMP%]{width:30rem;max-width:100%;position:relative;background:var(--phoenix-background-color-tertiary);border:1px solid var(--phoenix-border);border-radius:.5rem;padding:1.25rem;word-wrap:break-word}.share-box[_ngcontent-%COMP%]   .share-box-copy[_ngcontent-%COMP%]{position:absolute;top:-1px;right:-1px;background:transparent;color:inherit;cursor:pointer;padding:.25rem .5rem;font-size:.75rem;border:1px solid var(--phoenix-border);border-radius:.5rem}.share-box[_ngcontent-%COMP%]   .share-box-copy[_ngcontent-%COMP%]:hover{background:var(--phoenix-border)}"]})}return n})(),BL=(()=>{class n{dialog;constructor(t){this.dialog=t}openShareLinkDialog(){this.dialog.open(w$)}static \u0275fac=function(i){return new(i||n)(Lt(yx))};static \u0275cmp=Zr({type:n,selectors:[["app-share-link"]],decls:1,vars:1,consts:[["tooltip","Create shareable link","icon","share",3,"click","active"]],template:function(i,r){1&i&&(zt(0,"app-menu-toggle",0),Ai("click",function(){return r.openShareLinkDialog()}),an()),2&i&&Hn("active",!1)},dependencies:[qc]})}return n})();const zbe=["*"];let RC=(()=>{class n{eventDataImportOptions=Object.values(Yu);animationPresets=wW;static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Zr({type:n,selectors:[["app-ui-menu"]],inputs:{eventDataImportOptions:"eventDataImportOptions",animationPresets:"animationPresets"},ngContentSelectors:zbe,decls:23,vars:2,consts:[[3,"animationPresets"],[3,"eventDataImportOptions"]],template:function(i,r){1&i&&(vh(),zt(0,"app-ui-menu-wrapper"),Fr(1,"app-event-selector")(2,"app-zoom-controls")(3,"app-view-options")(4,"app-auto-rotate")(5,"app-dark-theme")(6,"app-object-clipping")(7,"app-main-view-toggle")(8,"app-overlay-view")(9,"app-object-selection")(10,"app-info-panel")(11,"app-animate-event")(12,"app-animate-camera",0)(13,"app-collections-info")(14,"app-geometry-browser")(15,"app-performance-toggle")(16,"app-vr-toggle")(17,"app-ar-toggle")(18,"app-ss-mode")(19,"app-make-picture")(20,"app-io-options",1)(21,"app-share-link"),ru(22),an()),2&i&&(Vn(12),Hn("animationPresets",r.animationPresets),Vn(8),Hn("eventDataImportOptions",r.eventDataImportOptions))},dependencies:[PO,cL,Xj,mL,AL,gL,_L,vL,rB,sB,bL,xL,oB,wL,BO,aB,CL,ML,SL,DL,IL,BL]})}return n})();function Hbe(n,e){if(1&n&&(zt(0,"a",5),Fr(1,"img",6),an()),2&n){const t=Pr();Hn("href",t.url,Y1),Vn(),Hn("src",t.logo,Y1)}}function Vbe(n,e){if(1&n&&(zt(0,"p")(1,"b"),Fi(2),an()()),2&n){const t=Pr();Vn(2),tA(t.tagline)}}function Gbe(n,e){if(1&n&&(ng(0),zt(1,"b"),Fi(2),an(),Fi(3),ig()),2&n){const t=Pr().$implicit;Vn(2),yl("",t.label,": "),Vn(),yl("",t.value," ")}}function qbe(n,e){if(1&n&&(ng(0),Fi(1),ig()),2&n){const t=Pr().$implicit;Vn(),yl(" ",t," ")}}function Qbe(n,e){if(1&n&&(zt(0,"p"),zs(1,Gbe,4,2,"ng-container",3)(2,qbe,2,1,"ng-container",3),an()),2&n){const t=e.$implicit;Vn(),Hn("ngIf",t.label),Vn(),Hn("ngIf",!t.label)}}let lB=(()=>{class n{eventDisplay;experimentInfo;url;logo;tagline;constructor(t){this.eventDisplay=t}ngOnInit(){this.eventDisplay.listenToDisplayedEventChange(()=>{this.experimentInfo=this.eventDisplay.getEventMetadata()})}static \u0275fac=function(i){return new(i||n)(Lt(pl))};static \u0275cmp=Zr({type:n,selectors:[["app-experiment-info"]],inputs:{url:"url",logo:"logo",tagline:"tagline"},decls:5,vars:3,consts:[["id","experimentInfo","cdkDrag","","cdkDragBoundary","body",1,"experimentInfo"],["class","experimentLogoWrapper","target","_blank","rel","noopener noreferrer",3,"href",4,"ngIf"],[1,"textInfo"],[4,"ngIf"],[4,"ngFor","ngForOf"],["target","_blank","rel","noopener noreferrer",1,"experimentLogoWrapper",3,"href"],["alt","",1,"experimentLogo",3,"src"]],template:function(i,r){1&i&&(zt(0,"div",0),zs(1,Hbe,2,2,"a",1),zt(2,"div",2),zs(3,Vbe,3,1,"p",3)(4,Qbe,3,2,"p",4),an()()),2&i&&(Vn(),Hn("ngIf",r.url),Vn(2),Hn("ngIf",r.tagline),Vn(),Hn("ngForOf",r.experimentInfo))},dependencies:[am,Lh,aL],styles:[".experimentInfo[_ngcontent-%COMP%]{position:absolute;top:5rem;left:1rem;display:flex;flex-direction:row;justify-items:flex-end;justify-content:flex-end;align-items:center;align-content:center;font-family:Courier New,Lucida Console,monospace;cursor:move}.experimentLogoWrapper[_ngcontent-%COMP%]{width:6rem}.experimentLogoWrapper[_ngcontent-%COMP%]   .experimentLogo[_ngcontent-%COMP%]{width:100%;height:100%}.textInfo[_ngcontent-%COMP%]{margin-left:1rem}.textInfo[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--phoenix-text-color-secondary);font-size:.8rem;margin-bottom:.5rem;-webkit-user-select:none;user-select:none}@media screen and (max-width: 768px){.experimentInfo[_ngcontent-%COMP%]{top:4rem;max-width:40%}.experimentLogoWrapper[_ngcontent-%COMP%]{height:4rem}.textInfo[_ngcontent-%COMP%]{display:none}}"]})}return n})();const Wbe=["switch"],jbe=["*"];function $be(n,e){1&n&&(zt(0,"div",10),Fl(),zt(1,"svg",12),Fr(2,"path",13),an(),zt(3,"svg",14),Fr(4,"path",15),an()())}const Xbe=new Bi("mat-slide-toggle-default-options",{providedIn:"root",factory:()=>({disableToggleValue:!1,hideIcon:!1})}),Ybe={provide:Of,useExisting:jt(()=>PL),multi:!0};class C${constructor(e,t){this.source=e,this.checked=t}}let Kbe=0,PL=(()=>{class n{_createChangeEvent(t){return new C$(this,t)}get buttonId(){return`${this.id||this._uniqueId}-button`}focus(){this._switchElement.nativeElement.focus()}get checked(){return this._checked}set checked(t){this._checked=t,this._changeDetectorRef.markForCheck()}get inputId(){return`${this.id||this._uniqueId}-input`}constructor(t,i,r,s,a,l){this._elementRef=t,this._focusMonitor=i,this._changeDetectorRef=r,this.defaults=a,this._onChange=d=>{},this._onTouched=()=>{},this._validatorOnChange=()=>{},this._checked=!1,this.name=null,this.labelPosition="after",this.ariaLabel=null,this.ariaLabelledby=null,this.disabled=!1,this.disableRipple=!1,this.tabIndex=0,this.change=new Ls,this.toggleChange=new Ls,this.tabIndex=parseInt(s)||0,this.color=a.color||"accent",this._noopAnimations="NoopAnimations"===l,this.id=this._uniqueId="mat-mdc-slide-toggle-"+ ++Kbe,this.hideIcon=a.hideIcon??!1,this._labelId=this._uniqueId+"-label"}ngAfterContentInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(t=>{"keyboard"===t||"program"===t?(this._focused=!0,this._changeDetectorRef.markForCheck()):t||Promise.resolve().then(()=>{this._focused=!1,this._onTouched(),this._changeDetectorRef.markForCheck()})})}ngOnChanges(t){t.required&&this._validatorOnChange()}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}writeValue(t){this.checked=!!t}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}validate(t){return this.required&&!0!==t.value?{required:!0}:null}registerOnValidatorChange(t){this._validatorOnChange=t}setDisabledState(t){this.disabled=t,this._changeDetectorRef.markForCheck()}toggle(){this.checked=!this.checked,this._onChange(this.checked)}_emitChangeEvent(){this._onChange(this.checked),this.change.emit(this._createChangeEvent(this.checked))}_handleClick(){this.toggleChange.emit(),this.defaults.disableToggleValue||(this.checked=!this.checked,this._onChange(this.checked),this.change.emit(new C$(this,this.checked)))}_getAriaLabelledBy(){return this.ariaLabelledby?this.ariaLabelledby:this.ariaLabel?null:this._labelId}static#e=this.\u0275fac=function(i){return new(i||n)(Lt(oo),Lt(J_),Lt(Sc),xu("tabindex"),Lt(Xbe),Lt(Od,8))};static#t=this.\u0275cmp=Zr({type:n,selectors:[["mat-slide-toggle"]],viewQuery:function(i,r){if(1&i&&_l(Wbe,5),2&i){let s;pa(s=ma())&&(r._switchElement=s.first)}},hostAttrs:[1,"mat-mdc-slide-toggle"],hostVars:13,hostBindings:function(i,r){2&i&&(Hw("id",r.id),sl("tabindex",null)("aria-label",null)("name",null)("aria-labelledby",null),B_(r.color?"mat-"+r.color:""),Ja("mat-mdc-slide-toggle-focused",r._focused)("mat-mdc-slide-toggle-checked",r.checked)("_mat-animation-noopable",r._noopAnimations))},inputs:{name:"name",id:"id",labelPosition:"labelPosition",ariaLabel:[mi.None,"aria-label","ariaLabel"],ariaLabelledby:[mi.None,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[mi.None,"aria-describedby","ariaDescribedby"],required:[mi.HasDecoratorInputTransform,"required","required",_o],color:"color",disabled:[mi.HasDecoratorInputTransform,"disabled","disabled",_o],disableRipple:[mi.HasDecoratorInputTransform,"disableRipple","disableRipple",_o],tabIndex:[mi.HasDecoratorInputTransform,"tabIndex","tabIndex",t=>null==t?0:su(t)],checked:[mi.HasDecoratorInputTransform,"checked","checked",_o],hideIcon:[mi.HasDecoratorInputTransform,"hideIcon","hideIcon",_o]},outputs:{change:"change",toggleChange:"toggleChange"},exportAs:["matSlideToggle"],standalone:!0,features:[qo([Ybe,{provide:mu,useExisting:n,multi:!0}]),ql,kl,yd],ngContentSelectors:jbe,decls:13,vars:24,consts:[["switch",""],["mat-internal-form-field","",3,"labelPosition"],["role","switch","type","button",1,"mdc-switch",3,"click","tabIndex","disabled"],[1,"mdc-switch__track"],[1,"mdc-switch__handle-track"],[1,"mdc-switch__handle"],[1,"mdc-switch__shadow"],[1,"mdc-elevation-overlay"],[1,"mdc-switch__ripple"],["mat-ripple","",1,"mat-mdc-slide-toggle-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mdc-switch__icons"],[1,"mdc-label",3,"click","for"],["viewBox","0 0 24 24","aria-hidden","true",1,"mdc-switch__icon","mdc-switch__icon--on"],["d","M19.69,5.23L8.96,15.96l-4.23-4.23L2.96,13.5l6,6L21.46,7L19.69,5.23z"],["viewBox","0 0 24 24","aria-hidden","true",1,"mdc-switch__icon","mdc-switch__icon--off"],["d","M20 13H4v-2h16v2z"]],template:function(i,r){if(1&i){const s=ta();vh(),zt(0,"div",1)(1,"button",2,0),Ai("click",function(){return Ci(s),Mi(r._handleClick())}),Fr(3,"div",3),zt(4,"div",4)(5,"div",5)(6,"div",6),Fr(7,"div",7),an(),zt(8,"div",8),Fr(9,"div",9),an(),zs(10,$be,5,0,"div",10),an()()(),zt(11,"label",11),Ai("click",function(l){return Ci(s),Mi(l.stopPropagation())}),ru(12),an()()}if(2&i){const s=Ga(2);Hn("labelPosition",r.labelPosition),Vn(),Ja("mdc-switch--selected",r.checked)("mdc-switch--unselected",!r.checked)("mdc-switch--checked",r.checked)("mdc-switch--disabled",r.disabled),Hn("tabIndex",r.disabled?-1:r.tabIndex)("disabled",r.disabled),sl("id",r.buttonId)("name",r.name)("aria-label",r.ariaLabel)("aria-labelledby",r._getAriaLabelledBy())("aria-describedby",r.ariaDescribedby)("aria-required",r.required||null)("aria-checked",r.checked),Vn(8),Hn("matRippleTrigger",s)("matRippleDisabled",r.disableRipple||r.disabled)("matRippleCentered",!0),Vn(),P_(10,r.hideIcon?-1:10),Vn(),Hn("for",r.buttonId),sl("id",r._labelId)}},dependencies:[R0,CO],styles:['.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1);background-color:var(--mdc-elevation-overlay-color)}.mdc-switch{align-items:center;background:none;border:none;cursor:pointer;display:inline-flex;flex-shrink:0;margin:0;outline:none;overflow:visible;padding:0;position:relative}.mdc-switch[hidden]{display:none}.mdc-switch:disabled{cursor:default;pointer-events:none}.mdc-switch__track{overflow:hidden;position:relative;width:100%}.mdc-switch__track::before,.mdc-switch__track::after{border:1px solid rgba(0,0,0,0);border-radius:inherit;box-sizing:border-box;content:"";height:100%;left:0;position:absolute;width:100%}@media screen and (forced-colors: active){.mdc-switch__track::before,.mdc-switch__track::after{border-color:currentColor}}.mdc-switch__track::before{transition:transform 75ms 0ms cubic-bezier(0, 0, 0.2, 1);transform:translateX(0)}.mdc-switch__track::after{transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.6, 1);transform:translateX(-100%)}[dir=rtl] .mdc-switch__track::after,.mdc-switch__track[dir=rtl]::after{transform:translateX(100%)}.mdc-switch--selected .mdc-switch__track::before{transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.6, 1);transform:translateX(100%)}[dir=rtl] .mdc-switch--selected .mdc-switch__track::before,.mdc-switch--selected .mdc-switch__track[dir=rtl]::before{transform:translateX(-100%)}.mdc-switch--selected .mdc-switch__track::after{transition:transform 75ms 0ms cubic-bezier(0, 0, 0.2, 1);transform:translateX(0)}.mdc-switch__handle-track{height:100%;pointer-events:none;position:absolute;top:0;transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);left:0;right:auto;transform:translateX(0)}[dir=rtl] .mdc-switch__handle-track,.mdc-switch__handle-track[dir=rtl]{left:auto;right:0}.mdc-switch--selected .mdc-switch__handle-track{transform:translateX(100%)}[dir=rtl] .mdc-switch--selected .mdc-switch__handle-track,.mdc-switch--selected .mdc-switch__handle-track[dir=rtl]{transform:translateX(-100%)}.mdc-switch__handle{display:flex;pointer-events:auto;position:absolute;top:50%;transform:translateY(-50%);left:0;right:auto}[dir=rtl] .mdc-switch__handle,.mdc-switch__handle[dir=rtl]{left:auto;right:0}.mdc-switch__handle::before,.mdc-switch__handle::after{border:1px solid rgba(0,0,0,0);border-radius:inherit;box-sizing:border-box;content:"";width:100%;height:100%;left:0;position:absolute;top:0;transition:background-color 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1),border-color 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);z-index:-1}@media screen and (forced-colors: active){.mdc-switch__handle::before,.mdc-switch__handle::after{border-color:currentColor}}.mdc-switch__shadow{border-radius:inherit;bottom:0;left:0;position:absolute;right:0;top:0}.mdc-elevation-overlay{bottom:0;left:0;right:0;top:0}.mdc-switch__ripple{left:50%;position:absolute;top:50%;transform:translate(-50%, -50%);z-index:-1}.mdc-switch:disabled .mdc-switch__ripple{display:none}.mdc-switch__icons{height:100%;position:relative;width:100%;z-index:1}.mdc-switch__icon{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0;opacity:0;transition:opacity 30ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-switch--selected .mdc-switch__icon--on,.mdc-switch--unselected .mdc-switch__icon--off{opacity:1;transition:opacity 45ms 30ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-slide-toggle .mdc-switch--disabled+label{color:var(--mdc-switch-disabled-label-text-color)}.mdc-switch{width:var(--mdc-switch-track-width)}.mdc-switch.mdc-switch--selected:enabled .mdc-switch__handle::after{background:var(--mdc-switch-selected-handle-color)}.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus):not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-selected-hover-handle-color)}.mdc-switch.mdc-switch--selected:enabled:focus:not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-selected-focus-handle-color)}.mdc-switch.mdc-switch--selected:enabled:active .mdc-switch__handle::after{background:var(--mdc-switch-selected-pressed-handle-color)}.mdc-switch.mdc-switch--selected:disabled .mdc-switch__handle::after{background:var(--mdc-switch-disabled-selected-handle-color)}.mdc-switch.mdc-switch--unselected:enabled .mdc-switch__handle::after{background:var(--mdc-switch-unselected-handle-color)}.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus):not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-unselected-hover-handle-color)}.mdc-switch.mdc-switch--unselected:enabled:focus:not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-unselected-focus-handle-color)}.mdc-switch.mdc-switch--unselected:enabled:active .mdc-switch__handle::after{background:var(--mdc-switch-unselected-pressed-handle-color)}.mdc-switch.mdc-switch--unselected:disabled .mdc-switch__handle::after{background:var(--mdc-switch-disabled-unselected-handle-color)}.mdc-switch .mdc-switch__handle::before{background:var(--mdc-switch-handle-surface-color)}.mdc-switch:enabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-handle-elevation)}.mdc-switch:disabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-disabled-handle-elevation)}.mdc-switch .mdc-switch__focus-ring-wrapper,.mdc-switch .mdc-switch__handle{height:var(--mdc-switch-handle-height)}.mdc-switch .mdc-switch__handle{border-radius:var(--mdc-switch-handle-shape)}.mdc-switch .mdc-switch__handle{width:var(--mdc-switch-handle-width)}.mdc-switch .mdc-switch__handle-track{width:calc(100% - var(--mdc-switch-handle-width))}.mdc-switch.mdc-switch--selected:enabled .mdc-switch__icon{fill:var(--mdc-switch-selected-icon-color)}.mdc-switch.mdc-switch--selected:disabled .mdc-switch__icon{fill:var(--mdc-switch-disabled-selected-icon-color)}.mdc-switch.mdc-switch--unselected:enabled .mdc-switch__icon{fill:var(--mdc-switch-unselected-icon-color)}.mdc-switch.mdc-switch--unselected:disabled .mdc-switch__icon{fill:var(--mdc-switch-disabled-unselected-icon-color)}.mdc-switch.mdc-switch--selected:disabled .mdc-switch__icons{opacity:var(--mdc-switch-disabled-selected-icon-opacity)}.mdc-switch.mdc-switch--unselected:disabled .mdc-switch__icons{opacity:var(--mdc-switch-disabled-unselected-icon-opacity)}.mdc-switch.mdc-switch--selected .mdc-switch__icon{width:var(--mdc-switch-selected-icon-size);height:var(--mdc-switch-selected-icon-size)}.mdc-switch.mdc-switch--unselected .mdc-switch__icon{width:var(--mdc-switch-unselected-icon-size);height:var(--mdc-switch-unselected-icon-size)}.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus) .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus) .mdc-switch__ripple::after{background-color:var(--mdc-switch-selected-hover-state-layer-color)}.mdc-switch.mdc-switch--selected:enabled:focus .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:focus .mdc-switch__ripple::after{background-color:var(--mdc-switch-selected-focus-state-layer-color)}.mdc-switch.mdc-switch--selected:enabled:active .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:active .mdc-switch__ripple::after{background-color:var(--mdc-switch-selected-pressed-state-layer-color)}.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus) .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus) .mdc-switch__ripple::after{background-color:var(--mdc-switch-unselected-hover-state-layer-color)}.mdc-switch.mdc-switch--unselected:enabled:focus .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:focus .mdc-switch__ripple::after{background-color:var(--mdc-switch-unselected-focus-state-layer-color)}.mdc-switch.mdc-switch--unselected:enabled:active .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:active .mdc-switch__ripple::after{background-color:var(--mdc-switch-unselected-pressed-state-layer-color)}.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus):hover .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus).mdc-ripple-surface--hover .mdc-switch__ripple::before{opacity:var(--mdc-switch-selected-hover-state-layer-opacity)}.mdc-switch.mdc-switch--selected:enabled:focus.mdc-ripple-upgraded--background-focused .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:focus:not(.mdc-ripple-upgraded):focus .mdc-switch__ripple::before{transition-duration:75ms;opacity:var(--mdc-switch-selected-focus-state-layer-opacity)}.mdc-switch.mdc-switch--selected:enabled:active:not(.mdc-ripple-upgraded) .mdc-switch__ripple::after{transition:opacity 150ms linear}.mdc-switch.mdc-switch--selected:enabled:active:not(.mdc-ripple-upgraded):active .mdc-switch__ripple::after{transition-duration:75ms;opacity:var(--mdc-switch-selected-pressed-state-layer-opacity)}.mdc-switch.mdc-switch--selected:enabled:active.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-switch-selected-pressed-state-layer-opacity)}.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus):hover .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus).mdc-ripple-surface--hover .mdc-switch__ripple::before{opacity:var(--mdc-switch-unselected-hover-state-layer-opacity)}.mdc-switch.mdc-switch--unselected:enabled:focus.mdc-ripple-upgraded--background-focused .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:focus:not(.mdc-ripple-upgraded):focus .mdc-switch__ripple::before{transition-duration:75ms;opacity:var(--mdc-switch-unselected-focus-state-layer-opacity)}.mdc-switch.mdc-switch--unselected:enabled:active:not(.mdc-ripple-upgraded) .mdc-switch__ripple::after{transition:opacity 150ms linear}.mdc-switch.mdc-switch--unselected:enabled:active:not(.mdc-ripple-upgraded):active .mdc-switch__ripple::after{transition-duration:75ms;opacity:var(--mdc-switch-unselected-pressed-state-layer-opacity)}.mdc-switch.mdc-switch--unselected:enabled:active.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-switch-unselected-pressed-state-layer-opacity)}.mdc-switch .mdc-switch__ripple{height:var(--mdc-switch-state-layer-size);width:var(--mdc-switch-state-layer-size)}.mdc-switch .mdc-switch__track{height:var(--mdc-switch-track-height)}.mdc-switch:disabled .mdc-switch__track{opacity:var(--mdc-switch-disabled-track-opacity)}.mdc-switch:enabled .mdc-switch__track::after{background:var(--mdc-switch-selected-track-color)}.mdc-switch:enabled:hover:not(:focus):not(:active) .mdc-switch__track::after{background:var(--mdc-switch-selected-hover-track-color)}.mdc-switch:enabled:focus:not(:active) .mdc-switch__track::after{background:var(--mdc-switch-selected-focus-track-color)}.mdc-switch:enabled:active .mdc-switch__track::after{background:var(--mdc-switch-selected-pressed-track-color)}.mdc-switch:disabled .mdc-switch__track::after{background:var(--mdc-switch-disabled-selected-track-color)}.mdc-switch:enabled .mdc-switch__track::before{background:var(--mdc-switch-unselected-track-color)}.mdc-switch:enabled:hover:not(:focus):not(:active) .mdc-switch__track::before{background:var(--mdc-switch-unselected-hover-track-color)}.mdc-switch:enabled:focus:not(:active) .mdc-switch__track::before{background:var(--mdc-switch-unselected-focus-track-color)}.mdc-switch:enabled:active .mdc-switch__track::before{background:var(--mdc-switch-unselected-pressed-track-color)}.mdc-switch:disabled .mdc-switch__track::before{background:var(--mdc-switch-disabled-unselected-track-color)}.mdc-switch .mdc-switch__track{border-radius:var(--mdc-switch-track-shape)}.mdc-switch:enabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-handle-elevation-shadow)}.mdc-switch:disabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-disabled-handle-elevation-shadow)}.mat-mdc-slide-toggle{display:inline-block;-webkit-tap-highlight-color:rgba(0,0,0,0);outline:0}.mat-mdc-slide-toggle .mat-mdc-slide-toggle-ripple,.mat-mdc-slide-toggle .mdc-switch__ripple::after{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:50%;pointer-events:none}.mat-mdc-slide-toggle .mat-mdc-slide-toggle-ripple:not(:empty),.mat-mdc-slide-toggle .mdc-switch__ripple::after:not(:empty){transform:translateZ(0)}.mat-mdc-slide-toggle .mdc-switch__ripple::after{content:"";opacity:0}.mat-mdc-slide-toggle .mdc-switch:hover .mdc-switch__ripple::after{opacity:.04;transition:opacity 75ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-slide-toggle.mat-mdc-slide-toggle-focused .mdc-switch .mdc-switch__ripple::after{opacity:.12}.mat-mdc-slide-toggle.mat-mdc-slide-toggle-focused .mat-mdc-focus-indicator::before{content:""}.mat-mdc-slide-toggle .mat-ripple-element{opacity:.12}.mat-mdc-slide-toggle .mat-mdc-focus-indicator::before{border-radius:50%}.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle-track,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-elevation-overlay,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__icon,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle::before,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle::after,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__track::before,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__track::after{transition:none}.mat-mdc-slide-toggle .mdc-switch:enabled+.mdc-label{cursor:pointer}.mdc-switch__handle{transition:width 75ms cubic-bezier(0.4, 0, 0.2, 1),height 75ms cubic-bezier(0.4, 0, 0.2, 1),margin 75ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-switch--selected .mdc-switch__track::before{opacity:var(--mat-switch-hidden-track-opacity);transition:var(--mat-switch-hidden-track-transition)}.mdc-switch--selected .mdc-switch__track::after{opacity:var(--mat-switch-visible-track-opacity);transition:var(--mat-switch-visible-track-transition)}.mdc-switch--unselected .mdc-switch__track::before{opacity:var(--mat-switch-visible-track-opacity);transition:var(--mat-switch-visible-track-transition)}.mdc-switch--unselected .mdc-switch__track::after{opacity:var(--mat-switch-hidden-track-opacity);transition:var(--mat-switch-hidden-track-transition)}.mat-mdc-slide-toggle .mdc-switch--unselected .mdc-switch__handle{width:var(--mat-switch-unselected-handle-size);height:var(--mat-switch-unselected-handle-size)}.mat-mdc-slide-toggle .mdc-switch--selected .mdc-switch__handle{width:var(--mat-switch-selected-handle-size);height:var(--mat-switch-selected-handle-size)}.mat-mdc-slide-toggle .mdc-switch__handle:has(.mdc-switch__icons){width:var(--mat-switch-with-icon-handle-size);height:var(--mat-switch-with-icon-handle-size)}.mat-mdc-slide-toggle:active .mdc-switch:not(.mdc-switch--disabled) .mdc-switch__handle{width:var(--mat-switch-pressed-handle-size);height:var(--mat-switch-pressed-handle-size)}.mat-mdc-slide-toggle .mdc-switch--selected .mdc-switch__handle{margin:var(--mat-switch-selected-handle-horizontal-margin)}.mat-mdc-slide-toggle .mdc-switch--selected .mdc-switch__handle:has(.mdc-switch__icons){margin:var(--mat-switch-selected-with-icon-handle-horizontal-margin)}.mat-mdc-slide-toggle .mdc-switch--unselected .mdc-switch__handle{margin:var(--mat-switch-unselected-handle-horizontal-margin)}.mat-mdc-slide-toggle .mdc-switch--unselected .mdc-switch__handle:has(.mdc-switch__icons){margin:var(--mat-switch-unselected-with-icon-handle-horizontal-margin)}.mat-mdc-slide-toggle:active .mdc-switch--selected:not(.mdc-switch--disabled) .mdc-switch__handle{margin:var(--mat-switch-selected-pressed-handle-horizontal-margin)}.mat-mdc-slide-toggle:active .mdc-switch--unselected:not(.mdc-switch--disabled) .mdc-switch__handle{margin:var(--mat-switch-unselected-pressed-handle-horizontal-margin)}.mdc-switch__track::after,.mdc-switch__track::before{border-width:var(--mat-switch-track-outline-width);border-color:var(--mat-switch-track-outline-color)}.mdc-switch--selected .mdc-switch__track::after,.mdc-switch--selected .mdc-switch__track::before{border-width:var(--mat-switch-selected-track-outline-width)}.mdc-switch--disabled .mdc-switch__track::after,.mdc-switch--disabled .mdc-switch__track::before{border-width:var(--mat-switch-disabled-unselected-track-outline-width);border-color:var(--mat-switch-disabled-unselected-track-outline-color)}.mdc-switch--disabled.mdc-switch--selected .mdc-switch__handle::after{opacity:var(--mat-switch-disabled-selected-handle-opacity)}.mdc-switch--disabled.mdc-switch--unselected .mdc-switch__handle::after{opacity:var(--mat-switch-disabled-unselected-handle-opacity)}'],encapsulation:2,changeDetection:0})}return n})(),exe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({imports:[PL,Wd,Wd]})}return n})();function txe(n,e){if(1&n){const t=ta();zt(0,"input",4),Ai("input",function(r){return Ci(t),Mi(Pr().onValueChange(r.target.value))}),an()}2&n&&Hn("value",Pr().value)}let M$=(()=>{class n{value=0;min=0;oldMin=0;max=100;oldMax=0;step=1;allowCustomValue=!1;onChange=new Ls;onValueChange(t){t&&this.onChange.emit(t)}toggleMinCut(t){t.checked?this.min=this.oldMin:(this.oldMin=this.min,this.min=Number.MIN_SAFE_INTEGER)}toggleMaxCut(t){t.checked?this.max=this.oldMax:(this.oldMax=this.max,this.max=Number.MAX_SAFE_INTEGER)}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Zr({type:n,selectors:[["app-config-slider"]],inputs:{value:"value",min:"min",max:"max",step:"step",allowCustomValue:"allowCustomValue"},outputs:{onChange:"onChange"},decls:4,vars:5,consts:[[1,"d-flex","flex-row","align-items-center"],["thumbLabel","",1,"mx-2",3,"min","max","step"],["matSliderThumb","",3,"valueChange","value"],["class","config-slider-input","type","number",3,"value","input",4,"ngIf"],["type","number",1,"config-slider-input",3,"input","value"]],template:function(i,r){1&i&&(zt(0,"div",0)(1,"mat-slider",1)(2,"input",2),Ai("valueChange",function(a){return r.onValueChange(a)}),an()(),zs(3,txe,1,1,"input",3),an()),2&i&&(Vn(),Hn("min",r.min)("max",r.max)("step",r.step),Vn(),Hn("value",r.value),Vn(),Hn("ngIf",r.allowCustomValue))},dependencies:[Lh,yL,YE],styles:[".config-slider-input[_ngcontent-%COMP%]{background:transparent;color:var(--phoenix-text-color);border:none;border-bottom:1px solid var(--phoenix-text-color);width:25%;-moz-appearance:textfield}input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none}"]})}return n})();const nxe=["phoenixMenuItem"],ixe=(n,e)=>({display:n,"top.px":e}),rxe=n=>({"font-weight-bold w-100":n}),sxe=n=>({"p-0":n}),oxe=n=>({expanded:n});function axe(n,e){1&n&&zw(0)}function lxe(n,e){if(1&n){const t=ta();ng(0),zt(1,"mat-slide-toggle",9),Ai("change",function(r){return Ci(t),Mi(Pr().currentNode.toggleSelfAndDescendants(r.checked))}),zs(2,axe,1,0,"ng-container",10),an(),ig()}if(2&n){const t=Pr(),i=Ga(5);Vn(),Hn("checked",t.currentNode.toggleState),Vn(),Hn("ngTemplateOutlet",i)}}function cxe(n,e){if(1&n&&(zt(0,"span",14),Fl(),zt(1,"svg"),Fr(2,"use"),an()()),2&n){const t=Pr(2);Vn(2),Nw("href","assets/icons/",t.currentNode.icon,".svg#",t.currentNode.icon,"")}}function dxe(n,e){if(1&n&&(zt(0,"span",11),zs(1,cxe,3,3,"span",12),zt(2,"span",13),Fi(3),an()()),2&n){const t=Pr();Vn(),Hn("ngIf",t.currentNode.icon),Vn(),Hn("title",t.currentNode.name),Vn(),tA(t.currentNode.name)}}function uxe(n,e){if(1&n){const t=ta();zt(0,"div",20),Ai("click",function(){return Ci(t),Mi(Pr(2).currentNode.configActive=!1)}),an()}}function hxe(n,e){if(1&n&&(zt(0,"label",26),Fi(1),an()),2&n){const t=Pr(2).$implicit;Hn("ngClass",Sf(2,rxe,"label"===t.type)),Vn(),yl(" ",t.label," ")}}function fxe(n,e){if(1&n){const t=ta();zt(0,"mat-checkbox",9),Ai("change",function(r){Ci(t);const s=Pr(3).$implicit;return s.onChange(r.checked),Mi(s.isChecked=r.checked)}),an()}2&n&&Hn("checked",Pr(3).$implicit.isChecked)}function pxe(n,e){if(1&n){const t=ta();zt(0,"app-config-slider",34),Ai("onChange",function(r){Ci(t);const s=Pr(3).$implicit;return s.onChange(r),Mi(s.value=r)}),an()}if(2&n){const t=Pr(3).$implicit;Hn("value",t.value)("min",t.min)("max",t.max)("step",t.step)("allowCustomValue",t.allowCustomValue)}}function mxe(n,e){if(1&n){const t=ta();zt(0,"button",35),Ai("click",function(){return Ci(t),Mi(Pr(3).$implicit.onClick())}),Fi(1),an()}if(2&n){const t=Pr(3).$implicit;Vn(),yl(" ",t.label," ")}}function Axe(n,e){if(1&n){const t=ta();zt(0,"input",36),Ai("input",function(r){Ci(t);const s=Pr(3).$implicit;return s.onChange(r.target.value),Mi(s.color=r.target.value)}),an()}2&n&&Hn("value",Pr(3).$implicit.color)}function gxe(n,e){if(1&n){const t=ta();zt(0,"div",37)(1,"div",38)(2,"mat-checkbox",9),Ai("change",function(r){return Ci(t),Mi(Pr(3).$implicit.setEnableMin(r.checked))}),an(),zt(3,"mat-checkbox",9),Ai("change",function(r){return Ci(t),Mi(Pr(3).$implicit.setEnableMax(r.checked))}),an()(),zt(4,"div",38)(5,"input",39),Ai("input",function(r){Ci(t);const s=Pr(3).$implicit;return s.value=r.target.value,Mi(s.onChange(s))}),an(),zt(6,"input",40),Ai("input",function(r){Ci(t);const s=Pr(3).$implicit;return s.highValue=r.target.value,Mi(s.onChange(s))}),an()()()}if(2&n){const t=Pr(3).$implicit;Vn(2),Hn("checked",t.enableMin),Vn(),Hn("checked",t.enableMax),Vn(2),Hn("value",t.value),Vn(),Hn("value",t.highValue)}}function _xe(n,e){if(1&n&&(zt(0,"option",43),Fi(1),an()),2&n){const t=e.$implicit;Hn("value",t),Vn(),yl(" ",t," ")}}function yxe(n,e){if(1&n){const t=ta();zt(0,"select",41),Ai("change",function(r){return Ci(t),Mi(Pr(3).$implicit.onChange(r.target.value))}),zs(1,_xe,2,2,"option",42),an()}if(2&n){const t=Pr(3).$implicit;Vn(),Hn("ngForOf",t.options)}}function vxe(n,e){if(1&n&&(zt(0,"div",27),zs(1,fxe,1,1,"mat-checkbox",28)(2,pxe,1,5,"app-config-slider",29)(3,mxe,2,1,"button",30)(4,Axe,1,1,"input",31)(5,gxe,7,4,"div",32)(6,yxe,2,1,"select",33),an()),2&n){const t=Pr(2).$implicit;Hn("ngClass",Sf(7,sxe,"button"===t.type)),Vn(),Hn("ngSwitchCase","checkbox"),Vn(),Hn("ngSwitchCase","slider"),Vn(),Hn("ngSwitchCase","button"),Vn(),Hn("ngSwitchCase","color"),Vn(),Hn("ngSwitchCase","rangeSlider"),Vn(),Hn("ngSwitchCase","select")}}function bxe(n,e){if(1&n&&(zt(0,"div",23),zs(1,hxe,2,4,"label",24)(2,vxe,7,9,"div",25),an()),2&n){const t=Pr().$implicit;Vn(),Hn("ngIf","button"!==t.type),Vn(),Hn("ngIf","label"!==t.type)}}function xxe(n,e){if(1&n&&(ng(0,21),zs(1,bxe,3,2,"div",22),ig()),2&n){const t=e.$implicit;Hn("ngSwitch",t.type),Vn(),Hn("ngIf",!t.hidden)}}function wxe(n,e){if(1&n){const t=ta();zt(0,"div")(1,"button",15),Ai("click",function(){Ci(t);const r=Pr();return r.calculateConfigTop(),Mi(r.currentNode.configActive=!r.currentNode.configActive)}),Fl(),zt(2,"svg"),Fr(3,"use",16),an()(),zs(4,uxe,1,0,"div",17),Ih(),zt(5,"div",18),zs(6,xxe,2,2,"ng-container",19),an()()}if(2&n){const t=Pr();Vn(4),Hn("ngIf",t.currentNode.configActive),Vn(),Hn("ngStyle",H3(3,ixe,t.currentNode.configActive?"block":"none",t.configTop)),Vn(),Hn("ngForOf",t.castConfigsToAny(t.currentNode.configs))}}function Cxe(n,e){if(1&n){const t=ta();zt(0,"button",44),Ai("click",function(){Ci(t);const r=Pr();return Mi(r.currentNode.childrenActive=!r.currentNode.childrenActive)}),Fl(),zt(1,"svg"),Fr(2,"use",45),an()()}if(2&n){const t=Pr();Hn("ngClass",Sf(1,oxe,t.currentNode.childrenActive))}}function Mxe(n,e){1&n&&Fr(0,"app-phoenix-menu-item",48),2&n&&Hn("currentNode",e.$implicit)}function Sxe(n,e){if(1&n&&(zt(0,"div",46),zs(1,Mxe,1,1,"app-phoenix-menu-item",47),an()),2&n){const t=Pr();Vn(),Hn("ngForOf",t.currentNode.children)}}let S$=(()=>{class n{cdr;currentNode;phoenixMenuItem;configTop;constructor(t){this.cdr=t}calculateConfigTop(){this.phoenixMenuItem&&(this.configTop=this.phoenixMenuItem.nativeElement.getBoundingClientRect().top,this.cdr.detectChanges())}castConfigsToAny(t){return t}static \u0275fac=function(i){return new(i||n)(Lt(Sc))};static \u0275cmp=Zr({type:n,selectors:[["app-phoenix-menu-item"]],viewQuery:function(i,r){if(1&i&&_l(nxe,5),2&i){let s;pa(s=ma())&&(r.phoenixMenuItem=s.first)}},inputs:{currentNode:"currentNode"},decls:10,vars:5,consts:[["phoenixMenuItem",""],["nodeName",""],[1,"phoenix-menu-item"],[1,"phoenix-menu-item-left","align-items-center"],[4,"ngIf","ngIfElse"],[1,"phoenix-menu-item-right"],[4,"ngIf"],["class","icon-wrapper icon-button btn-blank item-expand","data-testid","dropdown",3,"ngClass","click",4,"ngIf"],["class","phoenix-menu-children",4,"ngIf"],[3,"change","checked"],[4,"ngTemplateOutlet"],[1,"d-flex","w-100","align-items-center"],["class","icon-wrapper item-icon",4,"ngIf"],[1,"item-name",3,"title"],[1,"icon-wrapper","item-icon"],[1,"icon-wrapper","icon-button","btn-blank","item-settings",3,"click"],["href","assets/icons/gear.svg#gear"],["class","item-config-backdrop",3,"click",4,"ngIf"],[1,"item-config",3,"ngStyle"],[3,"ngSwitch",4,"ngFor","ngForOf"],[1,"item-config-backdrop",3,"click"],[3,"ngSwitch"],["class","item-config-single",4,"ngIf"],[1,"item-config-single"],["class","item-config-label","for","item-config-field",3,"ngClass",4,"ngIf"],["class","item-config-data",3,"ngClass",4,"ngIf"],["for","item-config-field",1,"item-config-label",3,"ngClass"],[1,"item-config-data",3,"ngClass"],[3,"checked","change",4,"ngSwitchCase"],[3,"value","min","max","step","allowCustomValue","onChange",4,"ngSwitchCase"],["class","w-100","mat-button","","mat-stroked-button","",3,"click",4,"ngSwitchCase"],["id","item-config-field","type","color",3,"value","input",4,"ngSwitchCase"],["class","range-slider",4,"ngSwitchCase"],["id","item-config-field","class","w-100",3,"change",4,"ngSwitchCase"],[3,"onChange","value","min","max","step","allowCustomValue"],["mat-button","","mat-stroked-button","",1,"w-100",3,"click"],["id","item-config-field","type","color",3,"input","value"],[1,"range-slider"],[1,"range-slider-inputs","d-flex","justify-content-between"],["type","number","placeholder","Min","step","config.step",1,"form-control","form-control-sm",3,"input","value"],["type","number","placeholder","Max","step","config.step",1,"form-control","form-control-sm",3,"input","value"],["id","item-config-field",1,"w-100",3,"change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["data-testid","dropdown",1,"icon-wrapper","icon-button","btn-blank","item-expand",3,"click","ngClass"],["href","assets/icons/expand.svg#expand"],[1,"phoenix-menu-children"],[3,"currentNode",4,"ngFor","ngForOf"],[3,"currentNode"]],template:function(i,r){if(1&i&&(zt(0,"div",2,0)(2,"div",3),zs(3,lxe,3,2,"ng-container",4)(4,dxe,4,3,"ng-template",null,1,nR),an(),zt(6,"div",5),zs(7,wxe,7,6,"div",6)(8,Cxe,3,3,"button",7),an()(),zs(9,Sxe,2,1,"div",8)),2&i){const s=Ga(5);Vn(3),Hn("ngIf",r.currentNode.onToggle)("ngIfElse",s),Vn(4),Hn("ngIf",r.currentNode.configs.length>0),Vn(),Hn("ngIf",r.currentNode.children.length>0),Vn(),Hn("ngIf",r.currentNode.childrenActive)}},dependencies:[om,am,Lh,w7,x7,fD,v7,BC,EC,TC,PL,sv,n,M$],styles:[".phoenix-menu-item{width:100%;padding:.6rem;background:var(--phoenix-background-color-secondary);color:var(--phoenix-text-color);font-size:.8rem;transition:all .5s;display:flex;justify-content:space-between;align-items:center}.phoenix-menu-item-left{display:flex;justify-content:flex-start;min-width:0;padding-right:.5rem;overflow:hidden}.phoenix-menu-item-left .item-name{flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.phoenix-menu-item-left .item-icon{margin-right:.2rem}.phoenix-menu-item-right{display:flex;justify-content:flex-end}.phoenix-menu-item-right .item-expand.expanded{transform:scaleY(-1)}.phoenix-menu-item-right .item-settings{margin-right:.2rem}.phoenix-menu-item-right .item-config-backdrop{position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:110}.phoenix-menu-item-right .item-config{position:absolute;margin-top:-5rem;right:100%;width:14rem;padding:.5rem;background:var(--phoenix-background-color-secondary);color:var(--phoenix-text-color-secondary);box-shadow:var(--phoenix-box-shadow);display:flex;flex-direction:column;z-index:120}.phoenix-menu-item-right .item-config>*{margin-bottom:.4rem}.phoenix-menu-item-right .item-config>*:last-child{margin-bottom:0}.phoenix-menu-item-right .item-config .item-config-single{display:flex;flex-direction:row}.phoenix-menu-item-right .item-config .item-config-single .item-config-label{width:30%}.phoenix-menu-item-right .item-config .item-config-single .item-config-data{flex-grow:1;padding-left:.5rem}.phoenix-menu-item .icon-wrapper{display:inline-block;width:1.3rem;height:1.3rem;padding:.23rem;transition:all .4s}.phoenix-menu-item .icon-wrapper.icon-button:hover{background:var(--phoenix-options-icon-bg);border-radius:40%;cursor:pointer}.phoenix-menu-item .icon-wrapper svg{width:100%;height:100%;vertical-align:top}.phoenix-menu-item .mat-slide-toggle-bar{width:30px!important}.phoenix-menu-item .mat-slide-toggle-thumb{width:15px!important;height:15px!important;position:absolute;top:2px}.phoenix-menu-item .mat-slider-horizontal{min-width:0;width:100%;height:20px}.phoenix-menu-item .mat-slider-horizontal .mat-slider-wrapper{top:10px}.phoenix-menu-item label.mat-checkbox-layout{margin:0}@media screen and (max-width: 768px){.phoenix-menu-item{font-size:.75rem;padding:.5rem}.phoenix-menu-item .icon-wrapper{width:1rem;height:1rem;padding:.15rem}}.phoenix-menu-children{margin-left:.5rem;border-left:1px solid var(--phoenix-accent)}.range-slider .range-slider-inputs{gap:20%}\n"],encapsulation:2})}return n})(),kC=(()=>{class n{rootNode;static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Zr({type:n,selectors:[["app-phoenix-menu"]],inputs:{rootNode:"rootNode"},decls:2,vars:1,consts:[["id","phoenixMenu"],[3,"currentNode"]],template:function(i,r){1&i&&(zt(0,"div",0),Fr(1,"app-phoenix-menu-item",1),an()),2&i&&(Vn(),Hn("currentNode",r.rootNode))},dependencies:[S$],styles:["[_nghost-%COMP%]{width:15rem;max-width:45%;position:absolute;top:5rem;right:1rem}#phoenixMenu[_ngcontent-%COMP%]{background:var(--phoenix-background-color-secondary);max-height:75vh;overflow-y:auto;box-shadow:var(--phoenix-box-shadow);z-index:100}@media screen and (max-width: 768px){#phoenixMenu[_ngcontent-%COMP%]{top:4rem}}"]})}return n})(),E$=(()=>{class n{experimentLink;ngOnInit(){const t=new URL(window.location.href);t.searchParams.delete("embed"),this.experimentLink=t.toString()}goToExperiment(){window.open(this.experimentLink,"_blank")}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Zr({type:n,selectors:[["app-experiment-link"]],decls:1,vars:0,consts:[["tooltip","See full event display","icon","link",3,"click"]],template:function(i,r){1&i&&(zt(0,"app-menu-toggle",0),Ai("click",function(){return r.goToExperiment()}),an())},dependencies:[qc]})}return n})(),vx=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Zr({type:n,selectors:[["app-embed-menu"]],decls:8,vars:0,consts:[["id","embedMenu"],["id","embedMenuInner"]],template:function(i,r){1&i&&(zt(0,"div",0)(1,"div",1),Fr(2,"app-dark-theme")(3,"app-auto-rotate")(4,"app-main-view-toggle")(5,"app-animate-event")(6,"app-animate-camera")(7,"app-experiment-link"),an()())},dependencies:[rB,sB,oB,BO,aB,E$],styles:["#embedMenu[_ngcontent-%COMP%]{display:none}#embedMenu[_ngcontent-%COMP%]   #embedMenuInner[_ngcontent-%COMP%]{display:flex;position:absolute;left:1rem;bottom:1rem;background:var(--phoenix-background-color-secondary);border:1px solid var(--phoenix-background-color-tertiary);box-shadow:var(--phoenix-box-shadow);border-radius:30px;padding:.25rem 0}"]})}return n})(),T$=(()=>{class n{eventDisplay;phoenixMenuRoot=new lx("Phoenix Menu","phoenix-menu");eventDataImportOptions=[Yu.JSON,Yu.JIVEXML,Yu.ZIP];loaded=!1;loadingProgress=0;constructor(t){this.eventDisplay=t}ngOnInit(){let t;t={eventFile:"assets/files/JiveXML/JiveXML_336567_2327102923.xml",eventType:"jivexml"};const i={eventDataLoader:new Z_,presetViews:[new Qd("Left View",[0,0,-12e3],[0,0,0],"left-cube"),new Qd("Center View",[-500,12e3,0],[0,0,0],"top-cube"),new Qd("Right View",[0,0,12e3],[0,0,0],"right-cube")],defaultView:[4e3,0,4e3,0,0,0],phoenixMenuRoot:this.phoenixMenuRoot,defaultEventFile:t};this.eventDisplay.init(i),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Barrel-Toroid.gltf.zip","Barrel Toroid","Magnets",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/End-Cap-Toroid.gltf.zip","Endcap","Magnets",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Feet.gltf.zip","Feet","Magnets",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Warm-Structure.gltf.zip","Warm structure","Magnets",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Lar-Barrel.gltf.zip","LAr Barrel","Calorimeters",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Lar-EMEC.gltf.zip","LAr EC1","Calorimeters",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Lar-FCAL.gltf.zip","LAr FCAL","Calorimeters",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Lar-HEC.gltf.zip","LAr HEC","Calorimeters",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Tile-Barrel.gltf.zip","Tile Cal","Calorimeters",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Tile-End-Cap.gltf.zip","Tile Cal EC","Calorimeters",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Beam.gltf.zip","Beam","Inner Detector",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Pixel.gltf.zip","Pixel","Inner Detector",1e3,!0),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/SCT-BAR.gltf.zip","SCT","Inner Detector",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/SCT-EC.gltf.zip","SCT Endcaps","Inner Detector",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/TRT-BAR.gltf.zip","TRT","Inner Detector",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/TRT-EC.gltf.zip","TRT Endcaps","Inner Detector",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Extra-Wheel.gltf.zip","Extra wheel","Muon Spectrometer > Endcaps",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Big-Wheel.gltf.zip","Big wheel","Muon Spectrometer > Endcaps",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Outer-Wheel.gltf.zip","Outer Wheel","Muon Spectrometer > Endcaps",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Muon-Barrel-Inner.gltf.zip","Muon Barrel Inner","Muon Spectrometer > Barrel",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Muon-Barrel-Middle.gltf.zip","Muon Barrel Middle","Muon Spectrometer > Barrel",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Muon-Barrel-Outer.gltf.zip","Muon Barrel Outer","Muon Spectrometer > Barrel",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Muon-Big-Wheel-MDT.gltf.zip","Big Wheel MDT ","Muon Spectrometer > Endcaps",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Small-Wheel-Chambers.gltf.zip","Small Wheel","Muon Spectrometer > Endcaps",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Small-Wheel-Hub.gltf.zip","Small Wheel Hub","Muon Spectrometer > Endcaps",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/Small-Wheel-NJD.gltf.zip","Small Wheel Feet","Muon Spectrometer > Endcaps",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/TGC2.gltf.zip","TGC2","Muon Spectrometer > Endcaps",1e3),this.eventDisplay.loadGLTFGeometry("assets/geometry/ATLAS/TGC3.gltf.zip","TGC3","Muon Spectrometer > Endcaps",1e3),this.eventDisplay.getLoadingManager().addProgressListener(r=>this.loadingProgress=r),this.eventDisplay.getLoadingManager().addLoadListenerWithCheck(()=>{console.log("Loading default configuration."),this.loaded=!0,this.eventDisplay.getURLOptionsManager().getURLOptions().get("config")||(new ax).loadStateFromJSON(jge)})}static \u0275fac=function(i){return new(i||n)(Lt(pl))};static \u0275cmp=Zr({type:n,selectors:[["app-atlas"]],decls:7,vars:4,consts:[[3,"loaded","progress"],[3,"eventDataImportOptions"],["logo","assets/images/atlas.svg","url","https://home.cern/science/experiments/atlas","tagline","ATLAS Experiment at CERN"],[3,"rootNode"],["id","eventDisplay"]],template:function(i,r){1&i&&Fr(0,"app-loader",0)(1,"app-nav")(2,"app-ui-menu",1)(3,"app-embed-menu")(4,"app-experiment-info",2)(5,"app-phoenix-menu",3)(6,"div",4),2&i&&(Hn("loaded",r.loaded)("progress",r.loadingProgress),Vn(2),Hn("eventDataImportOptions",r.eventDataImportOptions),Vn(3),Hn("rootNode",r.phoenixMenuRoot))},dependencies:[ev,RC,lB,kC,tv,vx]})}return n})(),D$=(()=>{class n{lastEventsURL="";lastEventsOptions=!1;unzip(t){return(0,Ee.A)(function*(){const i=new(d4());yield i.loadAsync(t);let r="",s=!1;for(const a in i.files){if(s){console.error("Zip archive contains more than one file. Ignoring all but first");break}r=yield i.file(a).async("string"),s=!0}return r})()}makeRequest(t,i,r,s={}){return fetch(t,s).then(a=>a[i]()).then(a=>{"blob"===i?a.arrayBuffer().then(l=>this.unzip(l)).then(l=>r(l)):r(a)}).catch(a=>(console.error(a),!0)),!1}loadJSONEvent(t,i){i.parsePhoenixEvents(JSON.parse(t))}loadJiveXMLEvent(t,i){const r=new CE;r.process(t);const s=r.getEventData();i.buildEventDataFromJSON(s)}loadEvent(t,i,r={}){this.lastEventsURL=t,this.lastEventsOptions=r;const s="zip"===t.split(".").pop(),a=s?t.substring(0,t.length-4):t;return this.makeRequest(t,s?"blob":"text",l=>{switch(a.split(".").pop()){case"xml":this.loadJiveXMLEvent(l,i);break;case"json":this.loadJSONEvent(l,i)}},r)}reloadLastEvents(t){this.lastEventsURL.length>0&&this.loadEvent(this.lastEventsURL,t,this.lastEventsOptions)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=qi({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Exe=(n,e)=>({"active-icon":n,"reload-icon":e});let I$=(()=>{class n{eventDisplay;fileLoader;interval;tooltip;icon;active=!1;reloading=!1;intervalId;events;constructor(t,i){this.eventDisplay=t,this.fileLoader=i}ngOnInit(){this.eventDisplay.listenToLoadedEventsChange(t=>{this.events=t,this.active&&(clearInterval(this.intervalId),this.startCycleInterval())})}toggleCycle(){this.reloading=this.active&&!this.reloading,this.active=!this.active||this.reloading,console.log(this.active,this.reloading),clearInterval(this.intervalId),this.active&&this.startCycleInterval()}startCycleInterval(t=0){let i=t;this.eventDisplay.loadEvent(this.events[i]),i=i+1>=this.events.length?-1:i+1,this.intervalId=setInterval(()=>{-1==i&&(this.reloading&&this.fileLoader.reloadLastEvents(this.eventDisplay),i=0),this.eventDisplay.loadEvent(this.events[i]),i=i+1>=this.events.length?-1:i+1},this.interval)}static \u0275fac=function(i){return new(i||n)(Lt(pl),Lt(D$))};static \u0275cmp=Zr({type:n,selectors:[["app-cycle-events"]],inputs:{interval:"interval",tooltip:"tooltip",icon:"icon"},decls:3,vars:4,consts:[["matTooltip","Cycle (off/on/on+reload)","matTooltipPosition","above","matTooltipTouchGestures","off",1,"cycle-events",3,"click"],[1,"cycle-events-icon",3,"ngClass"],["href","assets/icons/cycle-events.svg#cycle-events"]],template:function(i,r){1&i&&(zt(0,"button",0),Ai("click",function(){return r.toggleCycle()}),Fl(),zt(1,"svg",1),Fr(2,"use",2),an()()),2&i&&(Vn(),Hn("ngClass",H3(1,Exe,r.active,r.reloading)))},dependencies:[om,o1],styles:["[_nghost-%COMP%]{display:flex;margin:0 .6rem}[_nghost-%COMP%]   .cycle-events[_ngcontent-%COMP%]{display:flex;background:unset;border:none;height:2.5rem;width:2.5rem;min-height:2.5rem;min-width:2.5rem;padding:.65rem;cursor:pointer;align-self:center;transition:all .4s}[_nghost-%COMP%]   .cycle-events-icon[_ngcontent-%COMP%]{width:100%;height:100%}[_nghost-%COMP%]   .cycle-events-icon.active-icon[_ngcontent-%COMP%]{--phoenix-options-icon-path: #00bcd4}[_nghost-%COMP%]   .cycle-events-icon.reload-icon[_ngcontent-%COMP%]{--phoenix-options-icon-path: #77dd77}[_nghost-%COMP%]   .cycle-events[_ngcontent-%COMP%]:hover{background-color:var(--phoenix-options-icon-bg);border-radius:40%;transition:all .4s}[_nghost-%COMP%]   .cycle-events.disabled[_ngcontent-%COMP%]{cursor:not-allowed;opacity:.4}"]})}return n})(),Txe=(()=>{class n{eventDisplay;open=!1;constructor(t){this.eventDisplay=t}moveVP(t,i){for(const r of["Modules","Support","RFFoil","DeliveryPipes"])t.getObjectByName("VP > Left > "+r).position.setComponent(0,i),t.getObjectByName("VP > Right > "+r).position.setComponent(0,-i)}toggleVP(){this.open=!this.open,this.moveVP(this.eventDisplay.getThreeManager().getSceneManager(),this.open?30:0)}static \u0275fac=function(i){return new(i||n)(Lt(pl))};static \u0275cmp=Zr({type:n,selectors:[["app-vp-toggle"]],decls:1,vars:2,consts:[[3,"click","tooltip","icon"]],template:function(i,r){1&i&&(zt(0,"app-menu-toggle",0),Ai("click",function(){return r.toggleVP()}),an()),2&i&&Hn("tooltip",(r.open?"Close":"Open")+"VP")("icon",r.open?"closevp":"openvp")},dependencies:[qc]})}return n})(),Dxe=(()=>{class n{eventDisplay;events;phoenixMenuRoot=new lx("Phoenix Menu","phoenix-menu");loaded=!1;loadingProgress=0;eventDataImportOptions=[Yu.JSON,Yu.ZIP];constructor(t){this.eventDisplay=t}ngOnInit(){const t={eventDataLoader:new Z_,presetViews:[new Qd("Global View",[-8e3,6e3,0],[0,0,8e3],"perspective",AC.On,90,90),new Qd("Calo View",[-8e3,6e3,16e3],[0,0,12e3],"perspective",AC.On,90,90),new Qd("Side View",[-12e3,0,12e3],[0,0,12e3],"right-cube"),new Qd("Vertex Locator View",[-500,1e3,0],[0,0,0],"top-cube"),new Qd("Front View",[0,0,-6e3],[0,0,0],"left-cube"),new Qd("Top View",[0,16e3,12e3],[0,0,12e3],"top-cube")],defaultView:[-8e3,6e3,0,0,0,8e3],phoenixMenuRoot:this.phoenixMenuRoot,defaultEventFile:{eventFile:"assets/files/lhcb/LHCbEventData.json",eventType:"json"}};this.eventDisplay.init(t);try{this.eventDisplay.loadGLTFGeometry("assets/geometry/LHCb/LHCb.glb.zip",void 0,void 0,1,!0)}catch(i){console.log("Error:",i)}this.eventDisplay.getLoadingManager().addProgressListener(i=>this.loadingProgress=i),this.eventDisplay.getLoadingManager().addLoadListenerWithCheck(()=>this.loaded=!0)}static \u0275fac=function(i){return new(i||n)(Lt(pl))};static \u0275cmp=Zr({type:n,selectors:[["app-lhcb"]],decls:28,vars:5,consts:[[3,"loaded","progress"],[3,"interval"],[3,"eventDataImportOptions"],["logo","assets/images/lhcb.svg","url","https://home.cern/science/experiments/lhcb","tagline","LHCb Experiment at CERN"],[3,"rootNode"],["id","eventDisplay"]],template:function(i,r){1&i&&(Fr(0,"app-loader",0)(1,"app-nav"),zt(2,"app-ui-menu-wrapper"),Fr(3,"app-event-selector")(4,"app-cycle-events",1)(5,"app-zoom-controls")(6,"app-view-options")(7,"app-auto-rotate")(8,"app-dark-theme")(9,"app-object-clipping")(10,"app-main-view-toggle")(11,"app-overlay-view")(12,"app-object-selection")(13,"app-info-panel")(14,"app-animate-event")(15,"app-collections-info")(16,"app-performance-toggle")(17,"app-vr-toggle")(18,"app-ar-toggle")(19,"app-ss-mode")(20,"app-make-picture")(21,"app-io-options",2)(22,"app-share-link")(23,"app-vp-toggle"),an(),Fr(24,"app-embed-menu")(25,"app-experiment-info",3)(26,"app-phoenix-menu",4)(27,"div",5)),2&i&&(Hn("loaded",r.loaded)("progress",r.loadingProgress),Vn(4),Hn("interval",5e3),Vn(17),Hn("eventDataImportOptions",r.eventDataImportOptions),Vn(5),Hn("rootNode",r.phoenixMenuRoot))},dependencies:[ev,PO,cL,mL,AL,gL,_L,vL,rB,sB,bL,lB,xL,oB,wL,kC,aB,CL,ML,SL,DL,IL,tv,BL,vx,I$,Txe]})}return n})(),Ixe=(()=>{class n{eventDisplay;phoenixMenuRoot=new lx("Phoenix Menu","phoenix-menu");loaded=!1;loadingProgress=0;eventDataImportOptions=[Yu.JSON,Yu.IG];constructor(t){this.eventDisplay=t}ngOnInit(){const t=new mQ,i={eventDataLoader:t,presetViews:[new Qd("Left View",[0,0,-12e3],[0,0,0],"left-cube"),new Qd("Center View",[-500,12e3,0],[0,0,0],"top-cube"),new Qd("Right View",[0,0,12e3],[0,0,0],"right-cube")],defaultView:[4e3,0,4e3,0,0,0],phoenixMenuRoot:this.phoenixMenuRoot};this.eventDisplay.init(i),this.eventDisplay.loadRootJSONGeometry("https://root.cern/js/files/geom/cms.json.gz","CMS Detector",void 0,10,!0),t.readIgArchive("assets/files/cms/Hto4l_120-130GeV.ig",r=>{const s=t.getAllEventsData(r);this.eventDisplay.parsePhoenixEvents(s)}),this.eventDisplay.getLoadingManager().addProgressListener(r=>this.loadingProgress=r),this.eventDisplay.getLoadingManager().addLoadListenerWithCheck(()=>this.loaded=!0)}static \u0275fac=function(i){return new(i||n)(Lt(pl))};static \u0275cmp=Zr({type:n,selectors:[["app-cms"]],decls:7,vars:4,consts:[[3,"loaded","progress"],[3,"eventDataImportOptions"],["logo","assets/images/cms.svg","url","https://home.cern/science/experiments/cms","tagline","CMS Experiment at LHC, CERN"],[3,"rootNode"],["id","eventDisplay"]],template:function(i,r){1&i&&Fr(0,"app-loader",0)(1,"app-nav")(2,"app-ui-menu",1)(3,"app-embed-menu")(4,"app-experiment-info",2)(5,"app-phoenix-menu",3)(6,"div",4),2&i&&(Hn("loaded",r.loaded)("progress",r.loadingProgress),Vn(2),Hn("eventDataImportOptions",r.eventDataImportOptions),Vn(3),Hn("rootNode",r.phoenixMenuRoot))},dependencies:[ev,RC,lB,kC,tv,vx]})}return n})(),Bxe=(()=>{class n{eventDisplay;http;hitsFile="assets/files/TrackML/event000001000-hits.csv";particlesFile="assets/files/TrackML/event000001000-particles.csv";truthFile="assets/files/TrackML/event000001000-truth.csv";filesProcessed=0;numFiles=3;trackMLLoader;httpOptions={headers:new lm({}),responseType:"text"};phoenixMenuRoot=new lx("Phoenix Menu","phoenix-menu");loaded=!1;loadingProgress=0;constructor(t,i){this.eventDisplay=t,this.http=i}ngOnInit(){this.trackMLLoader=new Lge;const t={eventDataLoader:this.trackMLLoader,presetViews:[new Qd("Right View",[0,0,6e3],[0,0,0],"right-cube"),new Qd("Center View",[-500,1e3,0],[0,0,0],"top-cube"),new Qd("Left View",[0,0,-6e3],[0,0,0],"left-cube")],defaultView:[4e3,0,4e3,0,0,0],phoenixMenuRoot:this.phoenixMenuRoot};this.eventDisplay.init(t),this.eventDisplay.loadOBJGeometry("assets/geometry/TrackML/strip_long_simplified.obj","Long Strip",15311419,void 0,!0),this.eventDisplay.loadOBJGeometry("assets/geometry/TrackML/pixel_simplified.obj","Pixel",14854632,void 0,!0),this.eventDisplay.loadOBJGeometry("assets/geometry/TrackML/strip_short_simplified.obj","Short Strip",3579797,void 0,!0),this.eventDisplay.loadOBJGeometry("assets/geometry/TrackML/beampipe_simplified.obj","Beampipe",8355711,void 0,!0),this.eventDisplay.loadOBJGeometry("assets/geometry/TrackML/pixel_support_tube_simplified.obj","PST",8107007,void 0,!0),this.loadTrackMLData(),this.eventDisplay.getLoadingManager().addProgressListener(i=>this.loadingProgress=i),this.eventDisplay.getLoadingManager().addLoadListenerWithCheck(()=>this.loaded=!0)}loadTrackMLData(){this.http.get(this.hitsFile,this.httpOptions).subscribe(t=>{this.loadHits(t),this.http.get(this.particlesFile,this.httpOptions).subscribe(i=>{this.loadParticles(i),this.http.get(this.truthFile,this.httpOptions).subscribe(r=>this.loadTruth(r))})})}loadHits(t){console.log("loading hits"),this.trackMLLoader.processHits(t),this.filesProcessed++,this.finishConversion()}loadParticles(t){console.log("loading particles"),this.trackMLLoader.processParticles(t),this.filesProcessed++,this.finishConversion()}loadTruth(t){console.log("loading truth"),this.trackMLLoader.processTruth(t),this.filesProcessed++,this.finishConversion()}finishConversion(){if(this.filesProcessed===this.numFiles){const t=this.trackMLLoader.getEventData("TrackMLEvent");this.eventDisplay.buildEventDataFromJSON(t)}}static \u0275fac=function(i){return new(i||n)(Lt(pl),Lt(bS))};static \u0275cmp=Zr({type:n,selectors:[["app-trackml"]],decls:6,vars:3,consts:[[3,"loaded","progress"],[3,"rootNode"],["id","eventDisplay"]],template:function(i,r){1&i&&Fr(0,"app-loader",0)(1,"app-nav")(2,"app-ui-menu")(3,"app-embed-menu")(4,"app-phoenix-menu",1)(5,"div",2),2&i&&(Hn("loaded",r.loaded)("progress",r.loadingProgress),Vn(4),Hn("rootNode",r.phoenixMenuRoot))},dependencies:[ev,RC,kC,tv,vx]})}return n})(),Pxe=(()=>{class n{eventDisplay;route;phoenixMenuRoot=new lx("Phoenix Menu","phoenix-menu");loaded=!1;loadingProgress=0;option="TDR_o1_v01";loadIndividual=!1;eventDataImportOptions=[Yu.JSON,Yu.EDM4HEPJSON];constructor(t,i){this.eventDisplay=t,this.route=i}ngOnInit(){this.route.queryParams.subscribe(i=>{this.option=i.option,this.loadIndividual=i.loadIndividual});const t={presetViews:[new Qd("Left View",[0,0,-12e3],[0,0,0],"left-cube"),new Qd("Center View",[-500,12e3,0],[0,0,0],"top-cube"),new Qd("Right View",[0,0,12e3],[0,0,0],"right-cube")],defaultView:[4e3,0,4e3,0,0,0],phoenixMenuRoot:this.phoenixMenuRoot};this.eventDisplay.init(t),this.loadIndividual?new Map([["BeamPipe","BeamPipe"],["VXD","VXD"],["ITK_Barrel","ITK > Barrel"],["ITK_Endcap","ITK > Endcap"],["TPC","TPC"],["OTK_Barrel","OTK > Barrel"],["OTK_Endcap","OTK > Endcap"],["ECAL_Barrel","ECAL > Barrel"],["ECAL_Endcap","ECAL > Endcap"],["HCAL_Barrel","HCAL > Barrel"],["HCAL_Endcap","HCAL > Endcap"],["Lumical","Lumical"],["coil","coil"],["Muon_Barrel","MUON > Barrel"],["Muon_Endcap","MUON > Endcap"]]).forEach((r,s)=>{this.eventDisplay.loadRootGeometry(`assets/geometry/CEPC/${this.option}_${s}.root`,"Default",s,r)}):this.eventDisplay.loadRootGeometry(`assets/geometry/CEPC/${this.option}.root`,"Default",`CEPC Detector ${this.option}`),this.eventDisplay.getLoadingManager().addProgressListener(i=>this.loadingProgress=i),this.eventDisplay.getLoadingManager().addLoadListenerWithCheck(()=>this.loaded=!0)}static \u0275fac=function(i){return new(i||n)(Lt(pl),Lt(Cb))};static \u0275cmp=Zr({type:n,selectors:[["app-cepc"]],decls:6,vars:4,consts:[[3,"loaded","progress"],[3,"eventDataImportOptions"],[3,"rootNode"],["id","eventDisplay"]],template:function(i,r){1&i&&Fr(0,"app-loader",0)(1,"app-nav")(2,"app-ui-menu",1)(3,"app-embed-menu")(4,"app-phoenix-menu",2)(5,"div",3),2&i&&(Hn("loaded",r.loaded)("progress",r.loadingProgress),Vn(2),Hn("eventDataImportOptions",r.eventDataImportOptions),Vn(2),Hn("rootNode",r.phoenixMenuRoot))},dependencies:[ev,RC,kC,tv,vx]})}return n})(),Qxe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({imports:[Wd,Wd]})}return n})(),Kxe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({})}return n})(),Rwe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({imports:[Wd,Wd]})}return n})(),Zwe=(()=>{class n{injector;constructor(t){this.injector=t}handleError(t){console.error("ERROR IN PHOENIX APP","\n",t),this.injector.get(iO).setError(t)}static \u0275fac=function(i){return new(i||n)(xi(Al))};static \u0275prov=qi({token:n,factory:n.\u0275fac})}return n})(),Jwe=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=vo({type:n});static \u0275inj=ra({providers:[pl,iO,{provide:xl,useClass:Zwe}],imports:[fS,Vz,Yye,zve,Kve,y1e,NE,vye,l1e,Obe,ybe,exe,Iye,Qxe,Kxe,Rwe]})}return n})(),e2e=(()=>{class n{eventDisplay;http;loaded=!1;loadingProgress=0;constructor(t,i){this.eventDisplay=t,this.http=i}ngOnInit(){const t={presetViews:[new Qd("Left View",[0,0,-12e3],[0,0,0],"left-cube"),new Qd("Center View",[-500,12e3,0],[0,0,0],"top-cube"),new Qd("Right View",[0,0,12e3],[0,0,0],"right-cube")]};this.eventDisplay.init(t),this.eventDisplay.getLoadingManager().addProgressListener(i=>this.loadingProgress=i),this.eventDisplay.getLoadingManager().addLoadListenerWithCheck(()=>this.loaded=!0)}static \u0275fac=function(i){return new(i||n)(Lt(pl),Lt(bS))};static \u0275cmp=Zr({type:n,selectors:[["app-playground"]],decls:5,vars:2,consts:[[3,"loaded","progress"],["id","eventDisplay"]],template:function(i,r){1&i&&Fr(0,"app-loader",0)(1,"app-nav")(2,"app-ui-menu")(3,"app-embed-menu")(4,"div",1),2&i&&Hn("loaded",r.loaded)("progress",r.loadingProgress)},dependencies:[ev,RC,tv,vx]})}return n})();function Y$(n){return new Ln(3e3,!1)}function av(n){switch(n.length){case 0:return new kE;case 1:return n[0];default:return new rW(n)}}function K$(n,e,t=new Map,i=new Map){const r=[],s=[];let a=-1,l=null;if(e.forEach(d=>{const u=d.get("offset"),p=u==a,_=p&&l||new Map;d.forEach((S,R)=>{let H=R,re=S;if("offset"!==R)switch(H=n.normalizePropertyName(H,r),re){case"!":re=t.get(R);break;case t1:re=i.get(R);break;default:re=n.normalizeStyleValue(R,H,re,r)}_.set(H,re)}),p||s.push(_),l=_,a=u}),r.length)throw function w2e(n){return new Ln(3502,!1)}();return s}function NL(n,e,t,i){switch(e){case"start":n.onStart(()=>i(t&&UL(t,"start",n)));break;case"done":n.onDone(()=>i(t&&UL(t,"done",n)));break;case"destroy":n.onDestroy(()=>i(t&&UL(t,"destroy",n)))}}function UL(n,e,t){const s=zL(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,t.totalTime??n.totalTime,!!t.disabled),a=n._data;return null!=a&&(s._data=a),s}function zL(n,e,t,i,r="",s=0,a){return{element:n,triggerName:e,fromState:t,toState:i,phaseName:r,totalTime:s,disabled:!!a}}function ym(n,e,t){let i=n.get(e);return i||n.set(e,i=t),i}function Z$(n){const e=n.indexOf(":");return[n.substring(1,e),n.slice(e+1)]}const F2e=typeof document>"u"?null:document.documentElement;function HL(n){const e=n.parentNode||n.host||null;return e===F2e?null:e}let xx=null,J$=!1;function eX(n,e){for(;e;){if(e===n)return!0;e=HL(e)}return!1}function tX(n,e,t){if(t)return Array.from(n.querySelectorAll(e));const i=n.querySelector(e);return i?[i]:[]}let VL=(()=>{class n{validateStyleProperty(t){return function L2e(n){xx||(xx=function N2e(){return typeof document<"u"?document.body:null}()||{},J$=!!xx.style&&"WebkitAppearance"in xx.style);let e=!0;return xx.style&&!function O2e(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in xx.style,!e&&J$&&(e="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in xx.style)),e}(t)}matchesElement(t,i){return!1}containsElement(t,i){return eX(t,i)}getParentElement(t){return HL(t)}query(t,i,r){return tX(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,s,a,l=[],d){return new kE(r,s)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac})}return n})();class GL{static#e=this.NOOP=new VL}class qL{}const z2e=1e3,QL="ng-enter",mB="ng-leave",AB="ng-trigger",gB=".ng-trigger",iX="ng-animating",WL=".ng-animating";function a1(n){if("number"==typeof n)return n;const e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:jL(parseFloat(e[1]),e[2])}function jL(n,e){return"s"===e?n*z2e:n}function _B(n,e,t){return n.hasOwnProperty("duration")?n:function V2e(n,e,t){let r,s=0,a="";if("string"==typeof n){const l=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===l)return e.push(Y$()),{duration:0,delay:0,easing:""};r=jL(parseFloat(l[1]),l[2]);const d=l[3];null!=d&&(s=jL(parseFloat(d),l[4]));const u=l[5];u&&(a=u)}else r=n;if(!t){let l=!1,d=e.length;r<0&&(e.push(function t2e(){return new Ln(3100,!1)}()),l=!0),s<0&&(e.push(function n2e(){return new Ln(3101,!1)}()),l=!0),l&&e.splice(d,0,Y$())}return{duration:r,delay:s,easing:a}}(n,e,t)}function L0(n,e,t){e.forEach((i,r)=>{const s=XL(r);t&&!t.has(r)&&t.set(r,n.style[s]),n.style[s]=i})}function wx(n,e){e.forEach((t,i)=>{const r=XL(i);n.style[r]=""})}function JE(n){return Array.isArray(n)?1==n.length?n[0]:function g_e(n,e=null){return{type:aa.Sequence,steps:n,options:e}}(n):n}const $L=new RegExp("{{\\s*(.+?)\\s*}}","g");function sX(n){let e=[];if("string"==typeof n){let t;for(;t=$L.exec(n);)e.push(t[1]);$L.lastIndex=0}return e}function eT(n,e,t){const i=`${n}`,r=i.replace($L,(s,a)=>{let l=e[a];return null==l&&(t.push(function r2e(n){return new Ln(3003,!1)}()),l=""),l.toString()});return r==i?n:r}const Q2e=/-+([a-z0-9])/g;function XL(n){return n.replace(Q2e,(...e)=>e[1].toUpperCase())}function vm(n,e,t){switch(e.type){case aa.Trigger:return n.visitTrigger(e,t);case aa.State:return n.visitState(e,t);case aa.Transition:return n.visitTransition(e,t);case aa.Sequence:return n.visitSequence(e,t);case aa.Group:return n.visitGroup(e,t);case aa.Animate:return n.visitAnimate(e,t);case aa.Keyframes:return n.visitKeyframes(e,t);case aa.Style:return n.visitStyle(e,t);case aa.Reference:return n.visitReference(e,t);case aa.AnimateChild:return n.visitAnimateChild(e,t);case aa.AnimateRef:return n.visitAnimateRef(e,t);case aa.Query:return n.visitQuery(e,t);case aa.Stagger:return n.visitStagger(e,t);default:throw function s2e(n){return new Ln(3004,!1)}()}}function YL(n,e){return window.getComputedStyle(n)[e]}const $2e=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class oX extends qL{normalizePropertyName(e,t){return XL(e)}normalizeStyleValue(e,t,i,r){let s="";const a=i.toString().trim();if($2e.has(t)&&0!==i&&"0"!==i)if("number"==typeof i)s="px";else{const l=i.match(/^[+-]?[\d\.]+([a-z]*)$/);l&&0==l[1].length&&r.push(function o2e(n,e){return new Ln(3005,!1)}())}return a+s}}const yB="*";const vB=new Set(["true","1"]),bB=new Set(["false","0"]);function aX(n,e){const t=vB.has(n)||bB.has(n),i=vB.has(e)||bB.has(e);return(r,s)=>{let a=n==yB||n==r,l=e==yB||e==s;return!a&&t&&"boolean"==typeof r&&(a=r?vB.has(n):bB.has(n)),!l&&i&&"boolean"==typeof s&&(l=s?vB.has(e):bB.has(e)),a&&l}}const Z2e=new RegExp("s*:selfs*,?","g");function KL(n,e,t,i){return new J2e(n).build(e,t,i)}class J2e{constructor(e){this._driver=e}build(e,t,i){const r=new nCe(t);return this._resetContextStyleTimingState(r),vm(this,JE(e),r)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let i=t.queryCount=0,r=t.depCount=0;const s=[],a=[];return"@"==e.name.charAt(0)&&t.errors.push(function a2e(){return new Ln(3006,!1)}()),e.definitions.forEach(l=>{if(this._resetContextStyleTimingState(t),l.type==aa.State){const d=l,u=d.name;u.toString().split(/\s*,\s*/).forEach(p=>{d.name=p,s.push(this.visitState(d,t))}),d.name=u}else if(l.type==aa.Transition){const d=this.visitTransition(l,t);i+=d.queryCount,r+=d.depCount,a.push(d)}else t.errors.push(function l2e(){return new Ln(3007,!1)}())}),{type:aa.Trigger,name:e.name,states:s,transitions:a,queryCount:i,depCount:r,options:null}}visitState(e,t){const i=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(i.containsDynamicStyles){const s=new Set,a=r||{};i.styles.forEach(l=>{l instanceof Map&&l.forEach(d=>{sX(d).forEach(u=>{a.hasOwnProperty(u)||s.add(u)})})}),s.size&&t.errors.push(function c2e(n,e){return new Ln(3008,!1)}(0,s.values()))}return{type:aa.State,name:e.name,style:i,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const i=vm(this,JE(e.animation),t),r=function X2e(n,e){const t=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function Y2e(n,e,t){if(":"==n[0]){const d=function K2e(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,i)=>parseFloat(i)>parseFloat(t);case":decrement":return(t,i)=>parseFloat(i)<parseFloat(t);default:return e.push(function y2e(n){return new Ln(3016,!1)}()),"* => *"}}(n,t);if("function"==typeof d)return void e.push(d);n=d}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return t.push(function _2e(n){return new Ln(3015,!1)}()),e;const r=i[1],s=i[2],a=i[3];e.push(aX(r,a)),"<"==s[0]&&(r!=yB||a!=yB)&&e.push(aX(a,r))}(i,t,e)):t.push(n),t}(e.expr,t.errors);return{type:aa.Transition,matchers:r,animation:i,queryCount:t.queryCount,depCount:t.depCount,options:Cx(e.options)}}visitSequence(e,t){return{type:aa.Sequence,steps:e.steps.map(i=>vm(this,i,t)),options:Cx(e.options)}}visitGroup(e,t){const i=t.currentTime;let r=0;const s=e.steps.map(a=>{t.currentTime=i;const l=vm(this,a,t);return r=Math.max(r,t.currentTime),l});return t.currentTime=r,{type:aa.Group,steps:s,options:Cx(e.options)}}visitAnimate(e,t){const i=function rCe(n,e){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return ZL(_B(n,e).duration,0,"");const t=n;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=ZL(0,0,"");return s.dynamic=!0,s.strValue=t,s}const r=_B(t,e);return ZL(r.duration,r.delay,r.easing)}(e.timings,t.errors);t.currentAnimateTimings=i;let r,s=e.styles?e.styles:Ku({});if(s.type==aa.Keyframes)r=this.visitKeyframes(s,t);else{let a=e.styles,l=!1;if(!a){l=!0;const u={};i.easing&&(u.easing=i.easing),a=Ku(u)}t.currentTime+=i.duration+i.delay;const d=this.visitStyle(a,t);d.isEmptyStep=l,r=d}return t.currentAnimateTimings=null,{type:aa.Animate,timings:i,style:r,options:null}}visitStyle(e,t){const i=this._makeStyleAst(e,t);return this._validateStyleAst(i,t),i}_makeStyleAst(e,t){const i=[],r=Array.isArray(e.styles)?e.styles:[e.styles];for(let l of r)"string"==typeof l?l===t1?i.push(l):t.errors.push(new Ln(3002,!1)):i.push(new Map(Object.entries(l)));let s=!1,a=null;return i.forEach(l=>{if(l instanceof Map&&(l.has("easing")&&(a=l.get("easing"),l.delete("easing")),!s))for(let d of l.values())if(d.toString().indexOf("{{")>=0){s=!0;break}}),{type:aa.Style,styles:i,easing:a,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const i=t.currentAnimateTimings;let r=t.currentTime,s=t.currentTime;i&&s>0&&(s-=i.duration+i.delay),e.styles.forEach(a=>{"string"!=typeof a&&a.forEach((l,d)=>{const u=t.collectedStyles.get(t.currentQuerySelector),p=u.get(d);let _=!0;p&&(s!=r&&s>=p.startTime&&r<=p.endTime&&(t.errors.push(function u2e(n,e,t,i,r){return new Ln(3010,!1)}()),_=!1),s=p.startTime),_&&u.set(d,{startTime:s,endTime:r}),t.options&&function q2e(n,e,t){const i=e.params||{},r=sX(n);r.length&&r.forEach(s=>{i.hasOwnProperty(s)||t.push(function i2e(n){return new Ln(3001,!1)}())})}(l,t.options,t.errors)})})}visitKeyframes(e,t){const i={type:aa.Keyframes,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function h2e(){return new Ln(3011,!1)}()),i;let s=0;const a=[];let l=!1,d=!1,u=0;const p=e.steps.map(ce=>{const Te=this._makeStyleAst(ce,t);let Ce=null!=Te.offset?Te.offset:function iCe(n){if("string"==typeof n)return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(t instanceof Map&&t.has("offset")){const i=t;e=parseFloat(i.get("offset")),i.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const t=n;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(Te.styles),qe=0;return null!=Ce&&(s++,qe=Te.offset=Ce),d=d||qe<0||qe>1,l=l||qe<u,u=qe,a.push(qe),Te});d&&t.errors.push(function f2e(){return new Ln(3012,!1)}()),l&&t.errors.push(function p2e(){return new Ln(3200,!1)}());const _=e.steps.length;let S=0;s>0&&s<_?t.errors.push(function m2e(){return new Ln(3202,!1)}()):0==s&&(S=1/(_-1));const R=_-1,H=t.currentTime,re=t.currentAnimateTimings,se=re.duration;return p.forEach((ce,Te)=>{const Ce=S>0?Te==R?1:S*Te:a[Te],qe=Ce*se;t.currentTime=H+re.delay+qe,re.duration=qe,this._validateStyleAst(ce,t),ce.offset=Ce,i.styles.push(ce)}),i}visitReference(e,t){return{type:aa.Reference,animation:vm(this,JE(e.animation),t),options:Cx(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:aa.AnimateChild,options:Cx(e.options)}}visitAnimateRef(e,t){return{type:aa.AnimateRef,animation:this.visitReference(e.animation,t),options:Cx(e.options)}}visitQuery(e,t){const i=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[s,a]=function eCe(n){const e=!!n.split(/\s*,\s*/).find(t=>":self"==t);return e&&(n=n.replace(Z2e,"")),n=n.replace(/@\*/g,gB).replace(/@\w+/g,t=>gB+"-"+t.slice(1)).replace(/:animating/g,WL),[n,e]}(e.selector);t.currentQuerySelector=i.length?i+" "+s:s,ym(t.collectedStyles,t.currentQuerySelector,new Map);const l=vm(this,JE(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:aa.Query,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:a,animation:l,originalSelector:e.selector,options:Cx(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function A2e(){return new Ln(3013,!1)}());const i="full"===e.timings?{duration:0,delay:0,easing:"full"}:_B(e.timings,t.errors,!0);return{type:aa.Stagger,animation:vm(this,JE(e.animation),t),timings:i,options:null}}}class nCe{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Cx(n){return n?(n={...n}).params&&(n.params=function tCe(n){return n?{...n}:null}(n.params)):n={},n}function ZL(n,e,t){return{duration:n,delay:e,easing:t}}function JL(n,e,t,i,r,s,a=null,l=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:a,subTimeline:l}}class xB{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let i=this._map.get(e);i||this._map.set(e,i=[]),i.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const aCe=new RegExp(":enter","g"),cCe=new RegExp(":leave","g");function eN(n,e,t,i,r,s=new Map,a=new Map,l,d,u=[]){return(new dCe).buildKeyframes(n,e,t,i,r,s,a,l,d,u)}class dCe{buildKeyframes(e,t,i,r,s,a,l,d,u,p=[]){u=u||new xB;const _=new tN(e,t,u,r,s,p,[]);_.options=d;const S=d.delay?a1(d.delay):0;_.currentTimeline.delayNextStep(S),_.currentTimeline.setStyles([a],null,_.errors,d),vm(this,i,_);const R=_.timelines.filter(H=>H.containsAnimation());if(R.length&&l.size){let H;for(let re=R.length-1;re>=0;re--){const se=R[re];if(se.element===t){H=se;break}}H&&!H.allowOnlyTimelineStyles()&&H.setStyles([l],null,_.errors,d)}return R.length?R.map(H=>H.buildKeyframes()):[JL(t,[],[],[],0,S,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const i=t.subInstructions.get(t.element);if(i){const r=t.createSubContext(e.options),s=t.currentTimeline.currentTime,a=this._visitSubInstructions(i,r,r.options);s!=a&&t.transformIntoNewTimeline(a)}t.previousNode=e}visitAnimateRef(e,t){const i=t.createSubContext(e.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,i),this.visitReference(e.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,i){for(const r of e){const s=r?.delay;if(s){const a="number"==typeof s?s:a1(eT(s,r?.params??{},t.errors));i.delayNextStep(a)}}}_visitSubInstructions(e,t,i){let s=t.currentTimeline.currentTime;const a=null!=i.duration?a1(i.duration):null,l=null!=i.delay?a1(i.delay):null;return 0!==a&&e.forEach(d=>{const u=t.appendInstructionToTimeline(d,a,l);s=Math.max(s,u.duration+u.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),vm(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const i=t.subContextCount;let r=t;const s=e.options;if(s&&(s.params||s.delay)&&(r=t.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){r.previousNode.type==aa.Style&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=wB);const a=a1(s.delay);r.delayNextStep(a)}e.steps.length&&(e.steps.forEach(a=>vm(this,a,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const i=[];let r=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?a1(e.options.delay):0;e.steps.forEach(a=>{const l=t.createSubContext(e.options);s&&l.delayNextStep(s),vm(this,a,l),r=Math.max(r,l.currentTimeline.currentTime),i.push(l.currentTimeline)}),i.forEach(a=>t.currentTimeline.mergeTimelineCollectedStyles(a)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const i=e.strValue;return _B(t.params?eT(i,t.params,t.errors):i,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const i=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),r.snapshotCurrentStyles());const s=e.style;s.type==aa.Keyframes?this.visitKeyframes(s,t):(t.incrementTime(i.duration),this.visitStyle(s,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const i=t.currentTimeline,r=t.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const s=r&&r.easing||e.easing;e.isEmptyStep?i.applyEmptyStep(s):i.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const i=t.currentAnimateTimings,r=t.currentTimeline.duration,s=i.duration,l=t.createSubContext().currentTimeline;l.easing=i.easing,e.styles.forEach(d=>{l.forwardTime((d.offset||0)*s),l.setStyles(d.styles,d.easing,t.errors,t.options),l.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(l),t.transformIntoNewTimeline(r+s),t.previousNode=e}visitQuery(e,t){const i=t.currentTimeline.currentTime,r=e.options||{},s=r.delay?a1(r.delay):0;s&&(t.previousNode.type===aa.Style||0==i&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=wB);let a=i;const l=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=l.length;let d=null;l.forEach((u,p)=>{t.currentQueryIndex=p;const _=t.createSubContext(e.options,u);s&&_.delayNextStep(s),u===t.element&&(d=_.currentTimeline),vm(this,e.animation,_),_.currentTimeline.applyStylesToKeyframe(),a=Math.max(a,_.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(a),d&&(t.currentTimeline.mergeTimelineCollectedStyles(d),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const i=t.parentContext,r=t.currentTimeline,s=e.timings,a=Math.abs(s.duration),l=a*(t.currentQueryTotal-1);let d=a*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":d=l-d;break;case"full":d=i.currentStaggerTime}const p=t.currentTimeline;d&&p.delayNextStep(d);const _=p.currentTime;vm(this,e.animation,t),t.previousNode=e,i.currentStaggerTime=r.currentTime-_+(r.startTime-i.currentTimeline.startTime)}}const wB={};class tN{constructor(e,t,i,r,s,a,l,d){this._driver=e,this.element=t,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=s,this.errors=a,this.timelines=l,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=wB,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=d||new CB(this._driver,t,0),l.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const i=e;let r=this.options;null!=i.duration&&(r.duration=a1(i.duration)),null!=i.delay&&(r.delay=a1(i.delay));const s=i.params;if(s){let a=r.params;a||(a=this.options.params={}),Object.keys(s).forEach(l=>{(!t||!a.hasOwnProperty(l))&&(a[l]=eT(s[l],a,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const i=e.params={};Object.keys(t).forEach(r=>{i[r]=t[r]})}}return e}createSubContext(e=null,t,i){const r=t||this.element,s=new tN(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=wB,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,i){const r={duration:t??e.duration,delay:this.currentTimeline.currentTime+(i??0)+e.delay,easing:""},s=new uCe(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,i,r,s,a){let l=[];if(r&&l.push(this.element),e.length>0){e=(e=e.replace(aCe,"."+this._enterClassName)).replace(cCe,"."+this._leaveClassName);let u=this._driver.query(this.element,e,1!=i);0!==i&&(u=i<0?u.slice(u.length+i,u.length):u.slice(0,i)),l.push(...u)}return!s&&0==l.length&&a.push(function g2e(n){return new Ln(3014,!1)}()),l}}class CB{constructor(e,t,i,r){this._driver=e,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new CB(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,i]of this._globalTimelineStyles)this._backFill.set(t,i||t1),this._currentKeyframe.set(t,t1);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,i,r){t&&this._previousKeyframe.set("easing",t);const s=r&&r.params||{},a=function hCe(n,e){const t=new Map;let i;return n.forEach(r=>{if("*"===r){i??=e.keys();for(let s of i)t.set(s,t1)}else for(let[s,a]of r)t.set(s,a)}),t}(e,this._globalTimelineStyles);for(let[l,d]of a){const u=eT(d,s,i);this._pendingStyles.set(l,u),this._localTimelineStyles.has(l)||this._backFill.set(l,this._globalTimelineStyles.get(l)??t1),this._updateStyle(l,u)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,i)=>{const r=this._styleSummary.get(i);(!r||t.time>r.time)&&this._updateStyle(i,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((l,d)=>{const u=new Map([...this._backFill,...l]);u.forEach((p,_)=>{"!"===p?e.add(_):p===t1&&t.add(_)}),i||u.set("offset",d/this.duration),r.push(u)});const s=[...e.values()],a=[...t.values()];if(i){const l=r[0],d=new Map(l);l.set("offset",0),d.set("offset",1),r=[l,d]}return JL(this.element,r,s,a,this.duration,this.startTime,this.easing,!1)}}class uCe extends CB{constructor(e,t,i,r,s,a,l=!1){super(e,t,a.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=l,this.timings={duration:a.duration,delay:a.delay,easing:a.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],a=i+t,l=t/a,d=new Map(e[0]);d.set("offset",0),s.push(d);const u=new Map(e[0]);u.set("offset",dX(l)),s.push(u);const p=e.length-1;for(let _=1;_<=p;_++){let S=new Map(e[_]);const R=S.get("offset");S.set("offset",dX((t+R*i)/a)),s.push(S)}i=a,t=0,r="",e=s}return JL(this.element,e,this.preStyleProps,this.postStyleProps,i,t,r,!0)}}function dX(n,e=3){const t=Math.pow(10,e-1);return Math.round(n*t)/t}function uX(n,e,t,i,r,s,a,l,d,u,p,_,S){return{type:0,element:n,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:s,toState:i,toStyles:a,timelines:l,queriedElements:d,preStyleProps:u,postStyleProps:p,totalTime:_,errors:S}}const nN={};class hX{constructor(e,t,i){this._triggerName=e,this.ast=t,this._stateStyles=i}match(e,t,i,r){return function fCe(n,e,t,i,r){return n.some(s=>s(e,t,i,r))}(this.ast.matchers,e,t,i,r)}buildStyles(e,t,i){let r=this._stateStyles.get("*");return void 0!==e&&(r=this._stateStyles.get(e?.toString())||r),r?r.buildStyles(t,i):new Map}build(e,t,i,r,s,a,l,d,u,p){const _=[],S=this.ast.options&&this.ast.options.params||nN,H=this.buildStyles(i,l&&l.params||nN,_),re=d&&d.params||nN,se=this.buildStyles(r,re,_),ce=new Set,Te=new Map,Ce=new Map,qe="void"===r,wt={params:fX(re,S),delay:this.ast.options?.delay},gt=p?[]:eN(e,t,this.ast.animation,s,a,H,se,wt,u,_);let Et=0;return gt.forEach(Xt=>{Et=Math.max(Xt.duration+Xt.delay,Et)}),_.length?uX(t,this._triggerName,i,r,qe,H,se,[],[],Te,Ce,Et,_):(gt.forEach(Xt=>{const Un=Xt.element,Ct=ym(Te,Un,new Set);Xt.preStyleProps.forEach(Gi=>Ct.add(Gi));const Kt=ym(Ce,Un,new Set);Xt.postStyleProps.forEach(Gi=>Kt.add(Gi)),Un!==t&&ce.add(Un)}),uX(t,this._triggerName,i,r,qe,H,se,gt,[...ce.values()],Te,Ce,Et))}}function fX(n,e){const t={...e};return Object.entries(n).forEach(([i,r])=>{null!=r&&(t[i]=r)}),t}class pCe{constructor(e,t,i){this.styles=e,this.defaultParams=t,this.normalizer=i}buildStyles(e,t){const i=new Map,r=fX(e,this.defaultParams);return this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((a,l)=>{a&&(a=eT(a,r,t));const d=this.normalizer.normalizePropertyName(l,t);a=this.normalizer.normalizeStyleValue(l,d,a,t),i.set(l,a)})}),i}}class ACe{constructor(e,t,i){this.name=e,this.ast=t,this._normalizer=i,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{this.states.set(r.name,new pCe(r.style,r.options&&r.options.params||{},i))}),pX(this.states,"true","1"),pX(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new hX(e,r,this.states))}),this.fallbackTransition=function gCe(n,e,t){return new hX(n,{type:aa.Transition,animation:{type:aa.Sequence,steps:[],options:null},matchers:[(a,l)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,i,r){return this.transitionFactories.find(a=>a.match(e,t,i,r))||null}matchStyles(e,t,i){return this.fallbackTransition.buildStyles(e,t,i)}}function pX(n,e,t){n.has(e)?n.has(t)||n.set(t,n.get(e)):n.has(t)&&n.set(e,n.get(t))}const _Ce=new xB;class yCe{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const i=[],s=KL(this._driver,t,i,[]);if(i.length)throw function C2e(n){return new Ln(3503,!1)}();this._animations.set(e,s)}_buildPlayer(e,t,i){const r=e.element,s=K$(this._normalizer,e.keyframes,t,i);return this._driver.animate(r,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,i={}){const r=[],s=this._animations.get(e);let a;const l=new Map;if(s?(a=eN(this._driver,t,s,QL,mB,new Map,new Map,i,_Ce,r),a.forEach(p=>{const _=ym(l,p.element,new Map);p.postStyleProps.forEach(S=>_.set(S,null))})):(r.push(function M2e(){return new Ln(3300,!1)}()),a=[]),r.length)throw function S2e(n){return new Ln(3504,!1)}();l.forEach((p,_)=>{p.forEach((S,R)=>{p.set(R,this._driver.computeStyle(_,R,t1))})});const u=av(a.map(p=>{const _=l.get(p.element);return this._buildPlayer(p,new Map,_)}));return this._playersById.set(e,u),u.onDestroy(()=>this.destroy(e)),this.players.push(u),u}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function E2e(n){return new Ln(3301,!1)}();return t}listen(e,t,i,r){const s=zL(t,"","","");return NL(this._getPlayer(e),i,s,r),()=>{}}command(e,t,i,r){if("register"==i)return void this.register(e,r[0]);if("create"==i)return void this.create(e,t,r[0]||{});const s=this._getPlayer(e);switch(i){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const mX="ng-animate-queued",iN="ng-animate-disabled",CCe=[],AX={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},MCe={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},yg="__ng_removed";class rN{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const i=e&&e.hasOwnProperty("value");if(this.value=function DCe(n){return n??null}(i?e.value:e),i){const{value:s,...a}=e;this.options=a}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const i=this.options.params;Object.keys(t).forEach(r=>{null==i[r]&&(i[r]=t[r])})}}}const tT="void",sN=new rN(tT);class SCe{constructor(e,t,i){this.id=e,this.hostElement=t,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,mA(t,this._hostClassName)}listen(e,t,i,r){if(!this._triggers.has(t))throw function T2e(n,e){return new Ln(3302,!1)}();if(null==i||0==i.length)throw function D2e(n){return new Ln(3303,!1)}();if(!function ICe(n){return"start"==n||"done"==n}(i))throw function I2e(n,e){return new Ln(3400,!1)}();const s=ym(this._elementListeners,e,[]),a={name:t,phase:i,callback:r};s.push(a);const l=ym(this._engine.statesByElement,e,new Map);return l.has(t)||(mA(e,AB),mA(e,AB+"-"+t),l.set(t,sN)),()=>{this._engine.afterFlush(()=>{const d=s.indexOf(a);d>=0&&s.splice(d,1),this._triggers.has(t)||l.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function B2e(n){return new Ln(3401,!1)}();return t}trigger(e,t,i,r=!0){const s=this._getTrigger(t),a=new oN(this.id,t,e);let l=this._engine.statesByElement.get(e);l||(mA(e,AB),mA(e,AB+"-"+t),this._engine.statesByElement.set(e,l=new Map));let d=l.get(t);const u=new rN(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&d&&u.absorbOptions(d.options),l.set(t,u),d||(d=sN),u.value!==tT&&d.value===u.value){if(!function RCe(n,e){const t=Object.keys(n),i=Object.keys(e);if(t.length!=i.length)return!1;for(let r=0;r<t.length;r++){const s=t[r];if(!e.hasOwnProperty(s)||n[s]!==e[s])return!1}return!0}(d.params,u.params)){const re=[],se=s.matchStyles(d.value,d.params,re),ce=s.matchStyles(u.value,u.params,re);re.length?this._engine.reportError(re):this._engine.afterFlush(()=>{wx(e,se),L0(e,ce)})}return}const S=ym(this._engine.playersByElement,e,[]);S.forEach(re=>{re.namespaceId==this.id&&re.triggerName==t&&re.queued&&re.destroy()});let R=s.matchTransition(d.value,u.value,e,u.params),H=!1;if(!R){if(!r)return;R=s.fallbackTransition,H=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:R,fromState:d,toState:u,player:a,isFallbackTransition:H}),H||(mA(e,mX),a.onStart(()=>{OC(e,mX)})),a.onDone(()=>{let re=this.players.indexOf(a);re>=0&&this.players.splice(re,1);const se=this._engine.playersByElement.get(e);if(se){let ce=se.indexOf(a);ce>=0&&se.splice(ce,1)}}),this.players.push(a),S.push(a),a}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(i=>i.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const i=this._engine.driver.query(e,gB,!0);i.forEach(r=>{if(r[yg])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(a=>a.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,i,r){const s=this._engine.statesByElement.get(e),a=new Map;if(s){const l=[];if(s.forEach((d,u)=>{if(a.set(u,d.value),this._triggers.has(u)){const p=this.trigger(e,u,tT,r);p&&l.push(p)}}),l.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,a),i&&av(l).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),i=this._engine.statesByElement.get(e);if(t&&i){const r=new Set;t.forEach(s=>{const a=s.name;if(r.has(a))return;r.add(a);const d=this._triggers.get(a).fallbackTransition,u=i.get(a)||sN,p=new rN(tT),_=new oN(this.id,a,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:a,transition:d,fromState:u,toState:p,player:_,isFallbackTransition:!0})})}}removeNode(e,t){const i=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(i.totalAnimations){const s=i.players.length?i.playersByQueriedElement.get(e):[];if(s&&s.length)r=!0;else{let a=e;for(;a=a.parentNode;)if(i.statesByElement.get(a)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)i.markElementAsRemoved(this.id,e,!1,t);else{const s=e[yg];(!s||s===AX)&&(i.afterFlush(()=>this.clearElementCache(e)),i.destroyInnerAnimations(e),i._onRemovalComplete(e,t))}}insertNode(e,t){mA(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const s=i.element,a=this._elementListeners.get(s);a&&a.forEach(l=>{if(l.name==i.triggerName){const d=zL(s,i.triggerName,i.fromState.value,i.toState.value);d._data=e,NL(i.player,l.phase,d,l.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(i)}),this._queue=[],t.sort((i,r)=>{const s=i.transition.ast.depCount,a=r.transition.ast.depCount;return 0==s||0==a?s-a:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}}class ECe{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,i,r){this.bodyNode=e,this.driver=t,this._normalizer=i,this.scheduler=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(s,a)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(i=>{i.queued&&e.push(i)})}),e}createNamespace(e,t){const i=new SCe(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[e]=i}_balanceNamespaceList(e,t){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let a=!1,l=this.driver.getParentElement(t);for(;l;){const d=r.get(l);if(d){const u=i.indexOf(d);i.splice(u+1,0,e),a=!0;break}l=this.driver.getParentElement(l)}a||i.unshift(e)}else i.push(e);return r.set(t,e),e}register(e,t){let i=this._namespaceLookup[e];return i||(i=this.createNamespace(e,t)),i}registerTrigger(e,t,i){let r=this._namespaceLookup[e];r&&r.register(t,i)&&this.totalAnimations++}destroy(e,t){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const i=this._fetchNamespace(e);this.namespacesByHostElement.delete(i.hostElement);const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1),i.destroy(t),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,i=this.statesByElement.get(e);if(i)for(let r of i.values())if(r.namespaceId){const s=this._fetchNamespace(r.namespaceId);s&&t.add(s)}return t}trigger(e,t,i,r){if(MB(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,i,r),!0}return!1}insertNode(e,t,i,r){if(!MB(t))return;const s=t[yg];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const a=this.collectedLeaveElements.indexOf(t);a>=0&&this.collectedLeaveElements.splice(a,1)}if(e){const a=this._fetchNamespace(e);a&&a.insertNode(t,i)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),mA(e,iN)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),OC(e,iN))}removeNode(e,t,i){if(MB(t)){this.scheduler?.notify();const r=e?this._fetchNamespace(e):null;r?r.removeNode(t,i):this.markElementAsRemoved(e,t,!1,i);const s=this.namespacesByHostElement.get(t);s&&s.id!==e&&s.removeNode(t,i)}else this._onRemovalComplete(t,i)}markElementAsRemoved(e,t,i,r,s){this.collectedLeaveElements.push(t),t[yg]={namespaceId:e,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,i,r,s){return MB(t)?this._fetchNamespace(e).listen(t,i,r,s):()=>{}}_buildInstruction(e,t,i,r,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,i,r,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,gB,!0);t.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,WL,!0),t.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return av(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[yg];if(t&&t.setForRemoval){if(e[yg]=AX,t.namespaceId){this.destroyInnerAnimations(e);const i=this._fetchNamespace(t.namespaceId);i&&i.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(iN)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)mA(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,e)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],t.length?av(t).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(e){throw function P2e(n){return new Ln(3402,!1)}()}_flushAnimations(e,t){const i=new xB,r=[],s=new Map,a=[],l=new Map,d=new Map,u=new Map,p=new Set;this.disabledNodes.forEach(zn=>{p.add(zn);const oi=this.driver.query(zn,".ng-animate-queued",!0);for(let hi=0;hi<oi.length;hi++)p.add(oi[hi])});const _=this.bodyNode,S=Array.from(this.statesByElement.keys()),R=yX(S,this.collectedEnterElements),H=new Map;let re=0;R.forEach((zn,oi)=>{const hi=QL+re++;H.set(oi,hi),zn.forEach(vi=>mA(vi,hi))});const se=[],ce=new Set,Te=new Set;for(let zn=0;zn<this.collectedLeaveElements.length;zn++){const oi=this.collectedLeaveElements[zn],hi=oi[yg];hi&&hi.setForRemoval&&(se.push(oi),ce.add(oi),hi.hasAnimation?this.driver.query(oi,".ng-star-inserted",!0).forEach(vi=>ce.add(vi)):Te.add(oi))}const Ce=new Map,qe=yX(S,Array.from(ce));qe.forEach((zn,oi)=>{const hi=mB+re++;Ce.set(oi,hi),zn.forEach(vi=>mA(vi,hi))}),e.push(()=>{R.forEach((zn,oi)=>{const hi=H.get(oi);zn.forEach(vi=>OC(vi,hi))}),qe.forEach((zn,oi)=>{const hi=Ce.get(oi);zn.forEach(vi=>OC(vi,hi))}),se.forEach(zn=>{this.processLeaveNode(zn)})});const wt=[],gt=[];for(let zn=this._namespaceList.length-1;zn>=0;zn--)this._namespaceList[zn].drainQueuedTransitions(t).forEach(hi=>{const vi=hi.player,mr=hi.element;if(wt.push(vi),this.collectedEnterElements.length){const Fs=mr[yg];if(Fs&&Fs.setForMove){if(Fs.previousTriggersValues&&Fs.previousTriggersValues.has(hi.triggerName)){const Us=Fs.previousTriggersValues.get(hi.triggerName),ws=this.statesByElement.get(hi.element);if(ws&&ws.has(hi.triggerName)){const Co=ws.get(hi.triggerName);Co.value=Us,ws.set(hi.triggerName,Co)}}return void vi.destroy()}}const Mr=!_||!this.driver.containsElement(_,mr),is=Ce.get(mr),$s=H.get(mr),fi=this._buildInstruction(hi,i,$s,is,Mr);if(fi.errors&&fi.errors.length)return void gt.push(fi);if(Mr)return vi.onStart(()=>wx(mr,fi.fromStyles)),vi.onDestroy(()=>L0(mr,fi.toStyles)),void r.push(vi);if(hi.isFallbackTransition)return vi.onStart(()=>wx(mr,fi.fromStyles)),vi.onDestroy(()=>L0(mr,fi.toStyles)),void r.push(vi);const Rr=[];fi.timelines.forEach(Fs=>{Fs.stretchStartingKeyframe=!0,this.disabledNodes.has(Fs.element)||Rr.push(Fs)}),fi.timelines=Rr,i.append(mr,fi.timelines),a.push({instruction:fi,player:vi,element:mr}),fi.queriedElements.forEach(Fs=>ym(l,Fs,[]).push(vi)),fi.preStyleProps.forEach((Fs,Us)=>{if(Fs.size){let ws=d.get(Us);ws||d.set(Us,ws=new Set),Fs.forEach((Co,lo)=>ws.add(lo))}}),fi.postStyleProps.forEach((Fs,Us)=>{let ws=u.get(Us);ws||u.set(Us,ws=new Set),Fs.forEach((Co,lo)=>ws.add(lo))})});if(gt.length){const zn=[];gt.forEach(oi=>{zn.push(function R2e(n,e){return new Ln(3505,!1)}())}),wt.forEach(oi=>oi.destroy()),this.reportError(zn)}const Et=new Map,Xt=new Map;a.forEach(zn=>{const oi=zn.element;i.has(oi)&&(Xt.set(oi,oi),this._beforeAnimationBuild(zn.player.namespaceId,zn.instruction,Et))}),r.forEach(zn=>{const oi=zn.element;this._getPreviousPlayers(oi,!1,zn.namespaceId,zn.triggerName,null).forEach(vi=>{ym(Et,oi,[]).push(vi),vi.destroy()})});const Un=se.filter(zn=>bX(zn,d,u)),Ct=new Map;_X(Ct,this.driver,Te,u,t1).forEach(zn=>{bX(zn,d,u)&&Un.push(zn)});const Gi=new Map;R.forEach((zn,oi)=>{_X(Gi,this.driver,new Set(zn),d,"!")}),Un.forEach(zn=>{const oi=Ct.get(zn),hi=Gi.get(zn);Ct.set(zn,new Map([...oi?.entries()??[],...hi?.entries()??[]]))});const Yi=[],En=[],wi={};a.forEach(zn=>{const{element:oi,player:hi,instruction:vi}=zn;if(i.has(oi)){if(p.has(oi))return hi.onDestroy(()=>L0(oi,vi.toStyles)),hi.disabled=!0,hi.overrideTotalTime(vi.totalTime),void r.push(hi);let mr=wi;if(Xt.size>1){let is=oi;const $s=[];for(;is=is.parentNode;){const fi=Xt.get(is);if(fi){mr=fi;break}$s.push(is)}$s.forEach(fi=>Xt.set(fi,mr))}const Mr=this._buildAnimation(hi.namespaceId,vi,Et,s,Gi,Ct);if(hi.setRealPlayer(Mr),mr===wi)Yi.push(hi);else{const is=this.playersByElement.get(mr);is&&is.length&&(hi.parentPlayer=av(is)),r.push(hi)}}else wx(oi,vi.fromStyles),hi.onDestroy(()=>L0(oi,vi.toStyles)),En.push(hi),p.has(oi)&&r.push(hi)}),En.forEach(zn=>{const oi=s.get(zn.element);if(oi&&oi.length){const hi=av(oi);zn.setRealPlayer(hi)}}),r.forEach(zn=>{zn.parentPlayer?zn.syncPlayerEvents(zn.parentPlayer):zn.destroy()});for(let zn=0;zn<se.length;zn++){const oi=se[zn],hi=oi[yg];if(OC(oi,mB),hi&&hi.hasAnimation)continue;let vi=[];if(l.size){let Mr=l.get(oi);Mr&&Mr.length&&vi.push(...Mr);let is=this.driver.query(oi,WL,!0);for(let $s=0;$s<is.length;$s++){let fi=l.get(is[$s]);fi&&fi.length&&vi.push(...fi)}}const mr=vi.filter(Mr=>!Mr.destroyed);mr.length?BCe(this,oi,mr):this.processLeaveNode(oi)}return se.length=0,Yi.forEach(zn=>{this.players.push(zn),zn.onDone(()=>{zn.destroy();const oi=this.players.indexOf(zn);this.players.splice(oi,1)}),zn.play()}),Yi}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,i,r,s){let a=[];if(t){const l=this.playersByQueriedElement.get(e);l&&(a=l)}else{const l=this.playersByElement.get(e);if(l){const d=!s||s==tT;l.forEach(u=>{u.queued||!d&&u.triggerName!=r||a.push(u)})}}return(i||r)&&(a=a.filter(l=>!(i&&i!=l.namespaceId||r&&r!=l.triggerName))),a}_beforeAnimationBuild(e,t,i){const s=t.element,a=t.isRemovalTransition?void 0:e,l=t.isRemovalTransition?void 0:t.triggerName;for(const d of t.timelines){const u=d.element,p=u!==s,_=ym(i,u,[]);this._getPreviousPlayers(u,p,a,l,t.toState).forEach(R=>{const H=R.getRealPlayer();H.beforeDestroy&&H.beforeDestroy(),R.destroy(),_.push(R)})}wx(s,t.fromStyles)}_buildAnimation(e,t,i,r,s,a){const l=t.triggerName,d=t.element,u=[],p=new Set,_=new Set,S=t.timelines.map(H=>{const re=H.element;p.add(re);const se=re[yg];if(se&&se.removedBeforeQueried)return new kE(H.duration,H.delay);const ce=re!==d,Te=function PCe(n){const e=[];return vX(n,e),e}((i.get(re)||CCe).map(Et=>Et.getRealPlayer())).filter(Et=>!!Et.element&&Et.element===re),Ce=s.get(re),qe=a.get(re),wt=K$(this._normalizer,H.keyframes,Ce,qe),gt=this._buildPlayer(H,wt,Te);if(H.subTimeline&&r&&_.add(re),ce){const Et=new oN(e,l,re);Et.setRealPlayer(gt),u.push(Et)}return gt});u.forEach(H=>{ym(this.playersByQueriedElement,H.element,[]).push(H),H.onDone(()=>function TCe(n,e,t){let i=n.get(e);if(i){if(i.length){const r=i.indexOf(t);i.splice(r,1)}0==i.length&&n.delete(e)}return i}(this.playersByQueriedElement,H.element,H))}),p.forEach(H=>mA(H,iX));const R=av(S);return R.onDestroy(()=>{p.forEach(H=>OC(H,iX)),L0(d,t.toStyles)}),_.forEach(H=>{ym(r,H,[]).push(R)}),R}_buildPlayer(e,t,i){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,i):new kE(e.duration,e.delay)}}class oN{constructor(e,t,i){this.namespaceId=e,this.triggerName=t,this.element=i,this._player=new kE,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,i)=>{t.forEach(r=>NL(e,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){ym(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function MB(n){return n&&1===n.nodeType}function gX(n,e){const t=n.style.display;return n.style.display=e??"none",t}function _X(n,e,t,i,r){const s=[];t.forEach(d=>s.push(gX(d)));const a=[];i.forEach((d,u)=>{const p=new Map;d.forEach(_=>{const S=e.computeStyle(u,_,r);p.set(_,S),(!S||0==S.length)&&(u[yg]=MCe,a.push(u))}),n.set(u,p)});let l=0;return t.forEach(d=>gX(d,s[l++])),a}function yX(n,e){const t=new Map;if(n.forEach(l=>t.set(l,[])),0==e.length)return t;const r=new Set(e),s=new Map;function a(l){if(!l)return 1;let d=s.get(l);if(d)return d;const u=l.parentNode;return d=t.has(u)?u:r.has(u)?1:a(u),s.set(l,d),d}return e.forEach(l=>{const d=a(l);1!==d&&t.get(d).push(l)}),t}function mA(n,e){n.classList?.add(e)}function OC(n,e){n.classList?.remove(e)}function BCe(n,e,t){av(t).onDone(()=>n.processLeaveNode(e))}function vX(n,e){for(let t=0;t<n.length;t++){const i=n[t];i instanceof rW?vX(i.players,e):e.push(i)}}function bX(n,e,t){const i=t.get(n);if(!i)return!1;let r=e.get(n);return r?i.forEach(s=>r.add(s)):e.set(n,i),t.delete(n),!0}class nT{constructor(e,t,i,r){this._driver=t,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(s,a)=>{},this._transitionEngine=new ECe(e.body,t,i,r),this._timelineEngine=new yCe(e.body,t,i),this._transitionEngine.onRemovalComplete=(s,a)=>this.onRemovalComplete(s,a)}registerTrigger(e,t,i,r,s){const a=e+"-"+r;let l=this._triggerCache[a];if(!l){const d=[],p=KL(this._driver,s,d,[]);if(d.length)throw function x2e(n,e){return new Ln(3404,!1)}();l=function mCe(n,e,t){return new ACe(n,e,t)}(r,p,this._normalizer),this._triggerCache[a]=l}this._transitionEngine.registerTrigger(t,r,l)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,i,r){this._transitionEngine.insertNode(e,t,i,r)}onRemove(e,t,i){this._transitionEngine.removeNode(e,t,i)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,i,r){if("@"==i.charAt(0)){const[s,a]=Z$(i);this._timelineEngine.command(s,t,a,r)}else this._transitionEngine.trigger(e,t,i,r)}listen(e,t,i,r,s){if("@"==i.charAt(0)){const[a,l]=Z$(i);return this._timelineEngine.listen(a,t,l,s)}return this._transitionEngine.listen(e,t,i,r,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}}class iT{static#e=this.initialStylesByElement=new WeakMap;constructor(e,t,i){this._element=e,this._startStyles=t,this._endStyles=i,this._state=0;let r=iT.initialStylesByElement.get(e);r||iT.initialStylesByElement.set(e,r=new Map),this._initialStyles=r}start(){this._state<1&&(this._startStyles&&L0(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(L0(this._element,this._initialStyles),this._endStyles&&(L0(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(iT.initialStylesByElement.delete(this._element),this._startStyles&&(wx(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(wx(this._element,this._endStyles),this._endStyles=null),L0(this._element,this._initialStyles),this._state=3)}}function aN(n){let e=null;return n.forEach((t,i)=>{(function FCe(n){return"display"===n||"position"===n})(i)&&(e=e||new Map,e.set(i,t))}),e}class xX{constructor(e,t,i,r){this.element=e,this.keyframes=t,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map;const t=()=>this._onFinish();this.domPlayer.addEventListener("finish",t),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",t)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(i=>{t.push(Object.fromEntries(i))}),t}_triggerWebAnimation(e,t,i){return e.animate(this._convertKeyframesToObject(t),i)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&e.set(r,this._finished?i:YL(this.element,r))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class wX{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return eX(e,t)}getParentElement(e){return HL(e)}query(e,t,i){return tX(e,t,i)}computeStyle(e,t,i){return YL(e,t)}animate(e,t,i,r,s,a=[]){const d={duration:i,delay:r,fill:0==r?"both":"forwards"};s&&(d.easing=s);const u=new Map,p=a.filter(R=>R instanceof xX);(function W2e(n,e){return 0===n||0===e})(i,r)&&p.forEach(R=>{R.currentSnapshot.forEach((H,re)=>u.set(re,H))});let _=function G2e(n){return n.length?n[0]instanceof Map?n:n.map(e=>new Map(Object.entries(e))):[]}(t).map(R=>new Map(R));_=function j2e(n,e,t){if(t.size&&e.length){let i=e[0],r=[];if(t.forEach((s,a)=>{i.has(a)||r.push(a),i.set(a,s)}),r.length)for(let s=1;s<e.length;s++){let a=e[s];r.forEach(l=>a.set(l,YL(n,l)))}}return e}(e,_,u);const S=function kCe(n,e){let t=null,i=null;return Array.isArray(e)&&e.length?(t=aN(e[0]),e.length>1&&(i=aN(e[e.length-1]))):e instanceof Map&&(t=aN(e)),t||i?new iT(n,t,i):null}(e,_);return new xX(e,_,d,S)}}const CX="@.disabled";class MX{constructor(e,t,i,r){this.namespaceId=e,this.delegate=t,this.engine=i,this._onDestroy=r,this.\u0275type=0}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,i,r=!0){this.delegate.insertBefore(e,t,i),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,i){this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,r){this.delegate.setAttribute(e,t,i,r)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,r){this.delegate.setStyle(e,t,i,r)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){"@"==t.charAt(0)&&t==CX?this.disableAnimations(e,!!i):this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i){return this.delegate.listen(e,t,i)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class OCe extends MX{constructor(e,t,i,r,s){super(t,i,r,s),this.factory=e,this.namespaceId=t}setProperty(e,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==CX?this.disableAnimations(e,i=void 0===i||!!i):this.engine.process(this.namespaceId,e,t.slice(1),i):this.delegate.setProperty(e,t,i)}listen(e,t,i){if("@"==t.charAt(0)){const r=function LCe(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(e);let s=t.slice(1),a="";return"@"!=s.charAt(0)&&([s,a]=function NCe(n){const e=n.indexOf(".");return[n.substring(0,e),n.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,r,s,a,l=>{this.factory.scheduleListenerCallback(l._data||-1,i,l)})}return this.delegate.listen(e,t,i)}}class UCe{constructor(e,t,i){this.delegate=e,this.engine=t,this._zone=i,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,t.onRemovalComplete=(r,s)=>{const a=s?.parentNode(r);a&&s.removeChild(a,r)}}createRenderer(e,t){const r=this.delegate.createRenderer(e,t);if(!e||!t?.data?.animation){const u=this._rendererCache;let p=u.get(r);return p||(p=new MX("",r,this.engine,()=>u.delete(r)),u.set(r,p)),p}const s=t.id,a=t.id+"-"+this._currentId;this._currentId++,this.engine.register(a,e);const l=u=>{Array.isArray(u)?u.forEach(l):this.engine.registerTrigger(s,a,e,u.name,u)};return t.data.animation.forEach(l),new OCe(this,a,r,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(e,t,i){if(e>=0&&e<this._microtaskId)return void this._zone.run(()=>t(i));const r=this._animationCallbacksBuffer;0==r.length&&queueMicrotask(()=>{this._zone.run(()=>{r.forEach(s=>{const[a,l]=s;a(l)}),this._animationCallbacksBuffer=[]})}),r.push([t,i])}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}const SX=[{provide:qL,useFactory:function HCe(){return new oX}},{provide:nT,useClass:(()=>{class n extends nT{constructor(t,i,r){super(t,i,r,pi(ob,{optional:!0}))}ngOnDestroy(){this.flush()}static#e=this.\u0275fac=function(i){return new(i||n)(xi(ba),xi(GL),xi(qL))};static#t=this.\u0275prov=qi({token:n,factory:n.\u0275fac})}return n})()},{provide:LM,useFactory:function VCe(n,e,t){return new UCe(n,e,t)},deps:[qR,nT,io]}],lN=[{provide:GL,useFactory:()=>new wX},{provide:Od,useValue:"BrowserAnimations"},...SX],EX=[{provide:GL,useClass:VL},{provide:Od,useValue:"NoopAnimations"},...SX];let cN,GCe=(()=>{class n{static withConfig(t){return{ngModule:n,providers:t.disableAnimations?EX:lN}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=vo({type:n});static#n=this.\u0275inj=ra({providers:lN,imports:[Y7]})}return n})();cN=[{path:"",component:AQ},{path:"home",component:AQ},{path:"geometry",component:Qge},{path:"atlas",component:T$},{path:"lhcb",component:Dxe},{path:"cms",component:Ixe},{path:"trackml",component:Bxe},{path:"playground",component:e2e},{path:"cepc",component:Pxe}];let qCe=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=vo({type:n,bootstrap:[Cae]});static \u0275inj=ra({imports:[Y7,Nre,Vz.forRoot(cN,{useHash:!0}),GCe,Jwe]})}return n})();xie().bootstrapModule(qCe).catch(n=>console.error(n))},3511:(Yr,mt,Se)=>{Yr.exports={ResizeSensor:Se(626),ElementQueries:Se(4868)}},4868:function(Yr,mt,Se){"use strict";var Ee,x,L;typeof window<"u"&&window,x=[Se(626)],void 0!==(L="function"==typeof(Ee=function(ve){var ke=function(){var Ye,Ze={},Re=[];function He(v){v||(v=document.documentElement);var f=window.getComputedStyle(v,null).fontSize;return parseFloat(f)||16}function De(v,f){var C=f.split(/\d/),I=C[C.length-1];switch(f=parseFloat(f),I){case"px":default:return f;case"em":return f*He(v);case"rem":return f*He();case"vw":return f*document.documentElement.clientWidth/100;case"vh":return f*document.documentElement.clientHeight/100;case"vmin":case"vmax":var U=document.documentElement.clientWidth/100,k=document.documentElement.clientHeight/100;return f*(0,Math["vmin"===I?"min":"max"])(U,k)}}function F(v,f){this.element=v;var C,I,U,k,Z,ee,he,G,b=["min-width","min-height","max-width","max-height"];this.call=function(){for(C in U=function Ve(v){if(!v.getBoundingClientRect)return{width:v.offsetWidth,height:v.offsetHeight};var f=v.getBoundingClientRect();return{width:Math.round(f.width),height:Math.round(f.height)}}(this.element),ee={},Ze[f])Ze[f].hasOwnProperty(C)&&(k=De(this.element,(I=Ze[f][C]).value),Z="width"===I.property?U.width:U.height,he="","min"===I.mode&&Z>=k&&(he+=I.value),"max"===I.mode&&Z<=k&&(he+=I.value),ee[G=I.mode+"-"+I.property]||(ee[G]=""),he&&-1===(" "+ee[G]+" ").indexOf(" "+he+" ")&&(ee[G]+=" "+he));for(var P in b)b.hasOwnProperty(P)&&(ee[b[P]]?this.element.setAttribute(b[P],ee[b[P]].substr(1)):this.element.removeAttribute(b[P]))}}function J(v,f){v.elementQueriesSetupInformation||(v.elementQueriesSetupInformation=new F(v,f)),v.elementQueriesSensor||(v.elementQueriesSensor=new ve(v,function(){v.elementQueriesSetupInformation.call()}))}function Y(v,f,C,I){if(typeof Ze[v]>"u"){Ze[v]=[];var U=Re.length;Ye.innerHTML+="\n"+v+" {animation: 0.1s element-queries;}",Ye.innerHTML+="\n"+v+" > .resize-sensor {min-width: "+U+"px;}",Re.push(v)}Ze[v].push({mode:f,property:C,value:I})}function ue(v){var f;if(document.querySelectorAll&&(f=v?v.querySelectorAll.bind(v):document.querySelectorAll.bind(document)),!f&&typeof $$<"u"&&(f=$$),!f&&typeof jQuery<"u"&&(f=jQuery),!f)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return f}function me(v){var f=[],C=[],I=[],U=0,k=-1,Z=[];for(var ee in v.children)if(v.children.hasOwnProperty(ee)&&v.children[ee].tagName&&"img"===v.children[ee].tagName.toLowerCase()){f.push(v.children[ee]);var he=v.children[ee].getAttribute("min-width")||v.children[ee].getAttribute("data-min-width"),G=v.children[ee].getAttribute("data-src")||v.children[ee].getAttribute("url");I.push(G),C.push({minWidth:he}),he?v.children[ee].style.display="none":(U=f.length-1,v.children[ee].style.display="block")}function P(){var z,T=!1;for(z in f)f.hasOwnProperty(z)&&C[z].minWidth&&v.offsetWidth>C[z].minWidth&&(T=z);if(T||(T=U),k!==T)if(Z[T])f[k].style.display="none",f[T].style.display="block",k=T;else{var W=new Image;W.onload=function(){f[T].src=I[T],f[k].style.display="none",f[T].style.display="block",Z[T]=!0,k=T},W.src=I[T]}else f[T].src=I[T]}k=U,v.resizeSensorInstance=new ve(v,P),P()}var B=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,$=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim;function A(v){var f,C,I,U;for(v=v.replace(/'/g,'"');null!==(f=B.exec(v));)for(C=f[1]+f[3],I=f[2];null!==(U=$.exec(I));)Y(C,U[1],U[2],U[3])}function E(v){var f="";if(v)if("string"==typeof v)(-1!==(v=v.toLowerCase()).indexOf("min-width")||-1!==v.indexOf("max-width"))&&A(v);else for(var C=0,I=v.length;C<I;C++)1===v[C].type?(-1!==(f=v[C].selectorText||v[C].cssText).indexOf("min-height")||-1!==f.indexOf("max-height")||-1!==f.indexOf("min-width")||-1!==f.indexOf("max-width"))&&A(f):4===v[C].type?E(v[C].cssRules||v[C].rules):3===v[C].type&&v[C].styleSheet.hasOwnProperty("cssRules")&&E(v[C].styleSheet.cssRules)}var g=!1;this.init=function(){var v="animationstart";typeof document.documentElement.style.webkitAnimationName<"u"?v="webkitAnimationStart":typeof document.documentElement.style.MozAnimationName<"u"?v="mozanimationstart":typeof document.documentElement.style.OAnimationName<"u"&&(v="oanimationstart"),document.body.addEventListener(v,function(I){var U=I.target,k=U&&window.getComputedStyle(U,null),Z=k&&k.getPropertyValue("animation-name");if(Z&&-1!==Z.indexOf("element-queries")){U.elementQueriesSensor=new ve(U,function(){U.elementQueriesSetupInformation&&U.elementQueriesSetupInformation.call()});var G=window.getComputedStyle(U.resizeSensor,null).getPropertyValue("min-width");G=parseInt(G.replace("px","")),J(I.target,Re[G])}}),g||((Ye=document.createElement("style")).type="text/css",Ye.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",Ye.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(Ye),g=!0);for(var f=0,C=document.styleSheets.length;f<C;f++)try{document.styleSheets[f].href&&0===document.styleSheets[f].href.indexOf("file://")&&console.warn("CssElementQueries: unable to parse local css files, "+document.styleSheets[f].href),E(document.styleSheets[f].cssRules||document.styleSheets[f].rules||document.styleSheets[f].cssText)}catch{}!function X(){for(var f=ue()("[data-responsive-image],[responsive-image]"),C=0,I=f.length;C<I;C++)me(f[C])}()},this.findElementQueriesElements=function(v){!function Q(v){var f=ue(v);for(var C in Ze)if(Ze.hasOwnProperty(C))for(var I=f(C,v),U=0,k=I.length;U<k;U++)J(I[U],C)}(v)},this.update=function(){this.init()}};ke.update=function(){ke.instance.update()},ke.detach=function(Ye){Ye.elementQueriesSetupInformation?(Ye.elementQueriesSensor.detach(),delete Ye.elementQueriesSetupInformation,delete Ye.elementQueriesSensor):Ye.resizeSensorInstance&&(Ye.resizeSensorInstance.detach(),delete Ye.resizeSensorInstance)},ke.init=function(){ke.instance||(ke.instance=new ke),ke.instance.init()};return ke.findElementQueriesElements=function(Ye){ke.instance.findElementQueriesElements(Ye)},ke.listen=function(){!function(Ye){if(document.addEventListener)document.addEventListener("DOMContentLoaded",Ye,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var Ze=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(Ye(),clearInterval(Ze))},10);else window.onload=Ye}(ke.init)},ke})?Ee.apply(mt,x):Ee)&&(Yr.exports=L)},626:function(Yr,mt,Se){"use strict";var Ee,x;typeof window<"u"&&window,void 0!==(x="function"==typeof(Ee=function(){if(typeof window>"u")return null;var L=typeof window<"u"&&window.Math==Math?window:typeof self<"u"&&self.Math==Math?self:Function("return this")(),ve=L.requestAnimationFrame||L.mozRequestAnimationFrame||L.webkitRequestAnimationFrame||function(Ve){return L.setTimeout(Ve,20)},ke=L.cancelAnimationFrame||L.mozCancelAnimationFrame||L.webkitCancelAnimationFrame||function(Ve){L.clearTimeout(Ve)};function ot(Ve,De){var F=Object.prototype.toString.call(Ve),J="[object Array]"===F||"[object NodeList]"===F||"[object HTMLCollection]"===F||"[object Object]"===F||typeof jQuery<"u"&&Ve instanceof jQuery||typeof Elements<"u"&&Ve instanceof Elements,Y=0,ue=Ve.length;if(J)for(;Y<ue;Y++)De(Ve[Y]);else De(Ve)}function Ye(Ve){if(!Ve.getBoundingClientRect)return{width:Ve.offsetWidth,height:Ve.offsetHeight};var De=Ve.getBoundingClientRect();return{width:Math.round(De.width),height:Math.round(De.height)}}function Ze(Ve,De){Object.keys(De).forEach(function(F){Ve.style[F]=De[F]})}var Re=function(Ve,De){var F=0;function J(){var Q,me,ue=[];this.add=function(X){ue.push(X)},this.call=function(X){for(Q=0,me=ue.length;Q<me;Q++)ue[Q].call(this,X)},this.remove=function(X){var B=[];for(Q=0,me=ue.length;Q<me;Q++)ue[Q]!==X&&B.push(ue[Q]);ue=B},this.length=function(){return ue.length}}function Y(ue,Q){if(ue){if(ue.resizedAttached)return void ue.resizedAttached.add(Q);ue.resizedAttached=new J,ue.resizedAttached.add(Q),ue.resizeSensor=document.createElement("div"),ue.resizeSensor.dir="ltr",ue.resizeSensor.className="resize-sensor";var me={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},X={position:"absolute",left:"0px",top:"0px",transition:"0s"};Ze(ue.resizeSensor,me);var B=document.createElement("div");B.className="resize-sensor-expand",Ze(B,me);var $=document.createElement("div");Ze($,X),B.appendChild($);var A=document.createElement("div");A.className="resize-sensor-shrink",Ze(A,me);var E=document.createElement("div");Ze(E,X),Ze(E,{width:"200%",height:"200%"}),A.appendChild(E),ue.resizeSensor.appendChild(B),ue.resizeSensor.appendChild(A),ue.appendChild(ue.resizeSensor);var g=window.getComputedStyle(ue),v=g?g.getPropertyValue("position"):null;"absolute"!==v&&"relative"!==v&&"fixed"!==v&&"sticky"!==v&&(ue.style.position="relative");var f=!1,C=0,I=Ye(ue),U=0,k=0,Z=!0;F=0;var he=function(){if(Z){if(0===ue.offsetWidth&&0===ue.offsetHeight)return void(F||(F=ve(function(){F=0,he()})));Z=!1}var T,z;z=ue.offsetHeight,$.style.width=(T=ue.offsetWidth)+10+"px",$.style.height=z+10+"px",B.scrollLeft=T+10,B.scrollTop=z+10,A.scrollLeft=T+10,A.scrollTop=z+10};ue.resizeSensor.resetSensor=he;var G=function(){C=0,f&&(U=I.width,k=I.height,ue.resizedAttached&&ue.resizedAttached.call(I))},b=function(){I=Ye(ue),(f=I.width!==U||I.height!==k)&&!C&&(C=ve(G)),he()},P=function(T,z,W){T.attachEvent?T.attachEvent("on"+z,W):T.addEventListener(z,W)};P(B,"scroll",b),P(A,"scroll",b),F=ve(function(){F=0,he()})}}ot(Ve,function(ue){Y(ue,De)}),this.detach=function(ue){F||(ke(F),F=0),Re.detach(Ve,ue)},this.reset=function(){Ve.resizeSensor.resetSensor()}};if(Re.reset=function(Ve){ot(Ve,function(De){De.resizeSensor.resetSensor()})},Re.detach=function(Ve,De){ot(Ve,function(F){F&&(F.resizedAttached&&"function"==typeof De&&(F.resizedAttached.remove(De),F.resizedAttached.length())||F.resizeSensor&&(F.contains(F.resizeSensor)&&F.removeChild(F.resizeSensor),delete F.resizeSensor,delete F.resizedAttached))})},typeof MutationObserver<"u"){var He=new MutationObserver(function(Ve){for(var De in Ve)if(Ve.hasOwnProperty(De))for(var F=Ve[De].addedNodes,J=0;J<F.length;J++)F[J].resizeSensor&&Re.reset(F[J])});document.addEventListener("DOMContentLoaded",function(Ve){He.observe(document.body,{childList:!0,subtree:!0})})}return Re})?Ee.call(mt,Se,mt,Yr):Ee)&&(Yr.exports=x)},2623:Yr=>{"use strict";var mt={single_source_shortest_paths:function(Se,Ee,x){var L={},ve={};ve[Ee]=0;var ot,Ye,Ze,Re,He,De,ke=mt.PriorityQueue.make();for(ke.push(Ee,0);!ke.empty();)for(Ze in Re=(ot=ke.pop()).cost,He=Se[Ye=ot.value]||{})He.hasOwnProperty(Ze)&&(De=Re+He[Ze],(typeof ve[Ze]>"u"||ve[Ze]>De)&&(ve[Ze]=De,ke.push(Ze,De),L[Ze]=Ye));if(typeof x<"u"&&typeof ve[x]>"u"){var Y=["Could not find a path from ",Ee," to ",x,"."].join("");throw new Error(Y)}return L},extract_shortest_path_from_predecessor_list:function(Se,Ee){for(var x=[],L=Ee;L;)x.push(L),L=Se[L];return x.reverse(),x},find_path:function(Se,Ee,x){var L=mt.single_source_shortest_paths(Se,Ee,x);return mt.extract_shortest_path_from_predecessor_list(L,x)},PriorityQueue:{make:function(Se){var L,Ee=mt.PriorityQueue,x={};for(L in Se=Se||{},Ee)Ee.hasOwnProperty(L)&&(x[L]=Ee[L]);return x.queue=[],x.sorter=Se.sorter||Ee.default_sorter,x},default_sorter:function(Se,Ee){return Se.cost-Ee.cost},push:function(Se,Ee){this.queue.push({value:Se,cost:Ee}),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};Yr.exports=mt},5474:Yr=>{"use strict";Yr.exports=function(Se){for(var Ee=[],x=Se.length,L=0;L<x;L++){var ve=Se.charCodeAt(L);if(ve>=55296&&ve<=56319&&x>L+1){var ke=Se.charCodeAt(L+1);ke>=56320&&ke<=57343&&(ve=1024*(ve-55296)+ke-56320+65536,L+=1)}ve<128?Ee.push(ve):ve<2048?(Ee.push(ve>>6|192),Ee.push(63&ve|128)):ve<55296||ve>=57344&&ve<65536?(Ee.push(ve>>12|224),Ee.push(ve>>6&63|128),Ee.push(63&ve|128)):ve>=65536&&ve<=1114111?(Ee.push(ve>>18|240),Ee.push(ve>>12&63|128),Ee.push(ve>>6&63|128),Ee.push(63&ve|128)):Ee.push(239,191,189)}return new Uint8Array(Ee).buffer}},5747:function(Yr){Yr.exports=function(){"use strict";var mt=function(ne,j){return(mt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(le,ae){le.__proto__=ae}||function(le,ae){for(var Ue in ae)Object.prototype.hasOwnProperty.call(ae,Ue)&&(le[Ue]=ae[Ue])})(ne,j)};function Se(ne,j){if("function"!=typeof j&&null!==j)throw new TypeError("Class extends value "+String(j)+" is not a constructor or null");function le(){this.constructor=ne}mt(ne,j),ne.prototype=null===j?Object.create(j):(le.prototype=j.prototype,new le)}var Ee=function(){return Ee=Object.assign||function(j){for(var le,ae=1,Ue=arguments.length;ae<Ue;ae++)for(var dt in le=arguments[ae])Object.prototype.hasOwnProperty.call(le,dt)&&(j[dt]=le[dt]);return j},Ee.apply(this,arguments)};function x(ne,j,le,ae){return new(le||(le=Promise))(function(dt,Bt){function ln(Zn){try{jn(ae.next(Zn))}catch(ri){Bt(ri)}}function on(Zn){try{jn(ae.throw(Zn))}catch(ri){Bt(ri)}}function jn(Zn){Zn.done?dt(Zn.value):function Ue(dt){return dt instanceof le?dt:new le(function(Bt){Bt(dt)})}(Zn.value).then(ln,on)}jn((ae=ae.apply(ne,j||[])).next())})}function L(ne,j){var ae,Ue,dt,Bt,le={label:0,sent:function(){if(1&dt[0])throw dt[1];return dt[1]},trys:[],ops:[]};return Bt={next:ln(0),throw:ln(1),return:ln(2)},"function"==typeof Symbol&&(Bt[Symbol.iterator]=function(){return this}),Bt;function ln(jn){return function(Zn){return function on(jn){if(ae)throw new TypeError("Generator is already executing.");for(;le;)try{if(ae=1,Ue&&(dt=2&jn[0]?Ue.return:jn[0]?Ue.throw||((dt=Ue.return)&&dt.call(Ue),0):Ue.next)&&!(dt=dt.call(Ue,jn[1])).done)return dt;switch(Ue=0,dt&&(jn=[2&jn[0],dt.value]),jn[0]){case 0:case 1:dt=jn;break;case 4:return le.label++,{value:jn[1],done:!1};case 5:le.label++,Ue=jn[1],jn=[0];continue;case 7:jn=le.ops.pop(),le.trys.pop();continue;default:if(!(dt=(dt=le.trys).length>0&&dt[dt.length-1])&&(6===jn[0]||2===jn[0])){le=0;continue}if(3===jn[0]&&(!dt||jn[1]>dt[0]&&jn[1]<dt[3])){le.label=jn[1];break}if(6===jn[0]&&le.label<dt[1]){le.label=dt[1],dt=jn;break}if(dt&&le.label<dt[2]){le.label=dt[2],le.ops.push(jn);break}dt[2]&&le.ops.pop(),le.trys.pop();continue}jn=j.call(ne,le)}catch(Zn){jn=[6,Zn],Ue=0}finally{ae=dt=0}if(5&jn[0])throw jn[1];return{value:jn[0]?jn[1]:void 0,done:!0}}([jn,Zn])}}}function ve(ne,j,le){if(le||2===arguments.length)for(var dt,ae=0,Ue=j.length;ae<Ue;ae++)(dt||!(ae in j))&&(dt||(dt=Array.prototype.slice.call(j,0,ae)),dt[ae]=j[ae]);return ne.concat(dt||j)}for(var ke=function(){function ne(j,le,ae,Ue){this.left=j,this.top=le,this.width=ae,this.height=Ue}return ne.prototype.add=function(j,le,ae,Ue){return new ne(this.left+j,this.top+le,this.width+ae,this.height+Ue)},ne.fromClientRect=function(j,le){return new ne(le.left+j.windowBounds.left,le.top+j.windowBounds.top,le.width,le.height)},ne.fromDOMRectList=function(j,le){var ae=Array.from(le).find(function(Ue){return 0!==Ue.width});return ae?new ne(ae.left+j.windowBounds.left,ae.top+j.windowBounds.top,ae.width,ae.height):ne.EMPTY},ne.EMPTY=new ne(0,0,0,0),ne}(),ot=function(ne,j){return ke.fromClientRect(ne,j.getBoundingClientRect())},Ze=function(ne){for(var j=[],le=0,ae=ne.length;le<ae;){var Ue=ne.charCodeAt(le++);if(Ue>=55296&&Ue<=56319&&le<ae){var dt=ne.charCodeAt(le++);56320==(64512&dt)?j.push(((1023&Ue)<<10)+(1023&dt)+65536):(j.push(Ue),le--)}else j.push(Ue)}return j},Re=function(){for(var ne=[],j=0;j<arguments.length;j++)ne[j]=arguments[j];if(String.fromCodePoint)return String.fromCodePoint.apply(String,ne);var le=ne.length;if(!le)return"";for(var ae=[],Ue=-1,dt="";++Ue<le;){var Bt=ne[Ue];Bt<=65535?ae.push(Bt):ae.push(55296+((Bt-=65536)>>10),Bt%1024+56320),(Ue+1===le||ae.length>16384)&&(dt+=String.fromCharCode.apply(String,ae),ae.length=0)}return dt},He="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ve=typeof Uint8Array>"u"?[]:new Uint8Array(256),De=0;De<64;De++)Ve[He.charCodeAt(De)]=De;for(var F="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",J=typeof Uint8Array>"u"?[]:new Uint8Array(256),Y=0;Y<64;Y++)J[F.charCodeAt(Y)]=Y;for(var G=function(ne,j,le){return ne.slice?ne.slice(j,le):new Uint16Array(Array.prototype.slice.call(ne,j,le))},T=function(){function ne(j,le,ae,Ue,dt,Bt){this.initialValue=j,this.errorValue=le,this.highStart=ae,this.highValueIndex=Ue,this.index=dt,this.data=Bt}return ne.prototype.get=function(j){var le;if(j>=0){if(j<55296||j>56319&&j<=65535)return this.data[le=((le=this.index[j>>5])<<2)+(31&j)];if(j<=65535)return this.data[le=((le=this.index[2048+(j-55296>>5)])<<2)+(31&j)];if(j<this.highStart)return le=this.index[le=2080+(j>>11)],this.data[le=((le=this.index[le+=j>>5&63])<<2)+(31&j)];if(j<=1114111)return this.data[this.highValueIndex]}return this.errorValue},ne}(),z="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",W=typeof Uint8Array>"u"?[]:new Uint8Array(256),fe=0;fe<64;fe++)W[z.charCodeAt(fe)]=fe;var le,ae,Ue,Bt,ln,Ne=10,pt=13,vt=15,qt=17,Ot=18,Bn=19,Mn=20,bn=21,Dn=22,Cn=24,yn=25,Sn=26,ii=27,ai=28,ti=30,ss=32,Bs=33,yo=34,xt=35,ge=37,ye=38,Pe=39,At=40,Nt=42,hn=[9001,65288],dn="\xd7",ci=(le=function(ne){var ae,dt,Bt,ln,on,j=.75*ne.length,le=ne.length,Ue=0;"="===ne[ne.length-1]&&(j--,"="===ne[ne.length-2]&&j--);var jn=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(j):new Array(j),Zn=Array.isArray(jn)?jn:new Uint8Array(jn);for(ae=0;ae<le;ae+=4)dt=J[ne.charCodeAt(ae)],Bt=J[ne.charCodeAt(ae+1)],ln=J[ne.charCodeAt(ae+2)],on=J[ne.charCodeAt(ae+3)],Zn[Ue++]=dt<<2|Bt>>4,Zn[Ue++]=(15&Bt)<<4|ln>>2,Zn[Ue++]=(3&ln)<<6|63&on;return jn}("KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA=="),ae=Array.isArray(le)?function(ne){for(var j=ne.length,le=[],ae=0;ae<j;ae+=4)le.push(ne[ae+3]<<24|ne[ae+2]<<16|ne[ae+1]<<8|ne[ae]);return le}(le):new Uint32Array(le),Ue=Array.isArray(le)?function(ne){for(var j=ne.length,le=[],ae=0;ae<j;ae+=2)le.push(ne[ae+1]<<8|ne[ae]);return le}(le):new Uint16Array(le),Bt=G(Ue,12,ae[4]/2),ln=2===ae[5]?G(Ue,(24+ae[4])/2):function(ne,j,le){return ne.slice?ne.slice(j,le):new Uint32Array(Array.prototype.slice.call(ne,j,le))}(ae,Math.ceil((24+ae[4])/4)),new T(ae[0],ae[1],ae[2],ae[3],Bt,ln)),Pi=[ti,36],Si=[1,2,3,5],bi=[Ne,8],Jn=[ii,Sn],Wi=Si.concat(bi),Ln=[ye,Pe,At,yo,xt],Rs=[vt,pt],D=function(ne,j,le,ae){var Ue=ae[le];if(Array.isArray(ne)?-1!==ne.indexOf(Ue):ne===Ue)for(var dt=le;dt<=ae.length;){if((Bt=ae[++dt])===j)return!0;if(Bt!==Ne)break}if(Ue===Ne)for(dt=le;dt>0;){var ln=ae[--dt];if(Array.isArray(ne)?-1!==ne.indexOf(ln):ne===ln)for(var on=le;on<=ae.length;){var Bt;if((Bt=ae[++on])===j)return!0;if(Bt!==Ne)break}if(ln!==Ne)break}return!1},O=function(ne,j){for(var le=ne;le>=0;){var ae=j[le];if(ae!==Ne)return ae;le--}return 0},ie=function(ne,j,le,ae,Ue){if(0===le[ae])return dn;var dt=ae-1;if(Array.isArray(Ue)&&!0===Ue[dt])return dn;var Bt=dt-1,ln=dt+1,on=j[dt],jn=Bt>=0?j[Bt]:0,Zn=j[ln];if(2===on&&3===Zn)return dn;if(-1!==Si.indexOf(on))return"!";if(-1!==Si.indexOf(Zn)||-1!==bi.indexOf(Zn))return dn;if(8===O(dt,j))return"\xf7";if(11===ci.get(ne[dt])||(on===ss||on===Bs)&&11===ci.get(ne[ln])||7===on||7===Zn||9===on||-1===[Ne,pt,vt].indexOf(on)&&9===Zn||-1!==[qt,Ot,Bn,Cn,ai].indexOf(Zn)||O(dt,j)===Dn||D(23,Dn,dt,j)||D([qt,Ot],bn,dt,j)||D(12,12,dt,j))return dn;if(on===Ne)return"\xf7";if(23===on||23===Zn)return dn;if(16===Zn||16===on)return"\xf7";if(-1!==[pt,vt,bn].indexOf(Zn)||14===on||36===jn&&-1!==Rs.indexOf(on)||on===ai&&36===Zn||Zn===Mn||-1!==Pi.indexOf(Zn)&&on===yn||-1!==Pi.indexOf(on)&&Zn===yn||on===ii&&-1!==[ge,ss,Bs].indexOf(Zn)||-1!==[ge,ss,Bs].indexOf(on)&&Zn===Sn||-1!==Pi.indexOf(on)&&-1!==Jn.indexOf(Zn)||-1!==Jn.indexOf(on)&&-1!==Pi.indexOf(Zn)||-1!==[ii,Sn].indexOf(on)&&(Zn===yn||-1!==[Dn,vt].indexOf(Zn)&&j[ln+1]===yn)||-1!==[Dn,vt].indexOf(on)&&Zn===yn||on===yn&&-1!==[yn,ai,Cn].indexOf(Zn))return dn;if(-1!==[yn,ai,Cn,qt,Ot].indexOf(Zn))for(var ri=dt;ri>=0;){if((Xi=j[ri])===yn)return dn;if(-1===[ai,Cn].indexOf(Xi))break;ri--}if(-1!==[ii,Sn].indexOf(Zn))for(ri=-1!==[qt,Ot].indexOf(on)?Bt:dt;ri>=0;){var Xi;if((Xi=j[ri])===yn)return dn;if(-1===[ai,Cn].indexOf(Xi))break;ri--}if(ye===on&&-1!==[ye,Pe,yo,xt].indexOf(Zn)||-1!==[Pe,yo].indexOf(on)&&-1!==[Pe,At].indexOf(Zn)||-1!==[At,xt].indexOf(on)&&Zn===At||-1!==Ln.indexOf(on)&&-1!==[Mn,Sn].indexOf(Zn)||-1!==Ln.indexOf(Zn)&&on===ii||-1!==Pi.indexOf(on)&&-1!==Pi.indexOf(Zn)||on===Cn&&-1!==Pi.indexOf(Zn)||-1!==Pi.concat(yn).indexOf(on)&&Zn===Dn&&-1===hn.indexOf(ne[ln])||-1!==Pi.concat(yn).indexOf(Zn)&&on===Ot)return dn;if(41===on&&41===Zn){for(var Ss=le[dt],zr=1;Ss>0&&41===j[--Ss];)zr++;if(zr%2!=0)return dn}return on===ss&&Zn===Bs?dn:"\xf7"},_e=function(ne,j){j||(j={lineBreak:"normal",wordBreak:"normal"});var le=function(ne,j){void 0===j&&(j="strict");var le=[],ae=[],Ue=[];return ne.forEach(function(dt,Bt){var ln=ci.get(dt);if(ln>50?(Ue.push(!0),ln-=50):Ue.push(!1),-1!==["normal","auto","loose"].indexOf(j)&&-1!==[8208,8211,12316,12448].indexOf(dt))return ae.push(Bt),le.push(16);if(4===ln||11===ln){if(0===Bt)return ae.push(Bt),le.push(ti);var on=le[Bt-1];return-1===Wi.indexOf(on)?(ae.push(ae[Bt-1]),le.push(on)):(ae.push(Bt),le.push(ti))}return ae.push(Bt),31===ln?le.push("strict"===j?bn:ge):ln===Nt||29===ln?le.push(ti):43===ln?le.push(dt>=131072&&dt<=196605||dt>=196608&&dt<=262141?ge:ti):void le.push(ln)}),[ae,le,Ue]}(ne,j.lineBreak),ae=le[0],Ue=le[1],dt=le[2];return("break-all"===j.wordBreak||"break-word"===j.wordBreak)&&(Ue=Ue.map(function(ln){return-1!==[yn,ti,Nt].indexOf(ln)?ge:ln})),[ae,Ue,"keep-all"===j.wordBreak?dt.map(function(ln,on){return ln&&ne[on]>=19968&&ne[on]<=40959}):void 0]},Oe=function(){function ne(j,le,ae,Ue){this.codePoints=j,this.required="!"===le,this.start=ae,this.end=Ue}return ne.prototype.slice=function(){return Re.apply(void 0,this.codePoints.slice(this.start,this.end))},ne}(),$o=function(ne){return ne>=48&&ne<=57},Uf=function(ne){return $o(ne)||ne>=65&&ne<=70||ne>=97&&ne<=102},xm=function(ne){return 10===ne||9===ne||32===ne},bg=function(ne){return function(ne){return function(ne){return ne>=97&&ne<=122}(ne)||function(ne){return ne>=65&&ne<=90}(ne)}(ne)||function(ne){return ne>=128}(ne)||95===ne},$h=function(ne){return bg(ne)||$o(ne)||45===ne},xg=function(ne){return ne>=0&&ne<=8||11===ne||ne>=14&&ne<=31||127===ne},Hf=function(ne,j){return 92===ne&&10!==j},go=function(ne,j,le){return 45===ne?bg(j)||Hf(j,le):!!bg(ne)||!(92!==ne||!Hf(ne,j))},Wa=function(ne,j,le){return 43===ne||45===ne?!!$o(j)||46===j&&$o(le):$o(46===ne?j:ne)},NC=function(ne){var j=0,le=1;(43===ne[j]||45===ne[j])&&(45===ne[j]&&(le=-1),j++);for(var ae=[];$o(ne[j]);)ae.push(ne[j++]);var Ue=ae.length?parseInt(Re.apply(void 0,ae),10):0;46===ne[j]&&j++;for(var dt=[];$o(ne[j]);)dt.push(ne[j++]);var Bt=dt.length,ln=Bt?parseInt(Re.apply(void 0,dt),10):0;(69===ne[j]||101===ne[j])&&j++;var on=1;(43===ne[j]||45===ne[j])&&(45===ne[j]&&(on=-1),j++);for(var jn=[];$o(ne[j]);)jn.push(ne[j++]);var Zn=jn.length?parseInt(Re.apply(void 0,jn),10):0;return le*(Ue+ln*Math.pow(10,-Bt))*Math.pow(10,on*Zn)},Tx={type:2},Dx={type:3},Ix={type:4},wg={type:13},Cg={type:8},va={type:21},Mg={type:9},d1={type:10},$d={type:11},u1={type:12},Bx={type:14},U0={type:23},wp={type:1},h1={type:25},z0={type:24},Px={type:26},Rx={type:27},kx={type:28},lv={type:29},gA={type:31},f1={type:32},Vf=function(){function ne(){this._value=[]}return ne.prototype.write=function(j){this._value=this._value.concat(Ze(j))},ne.prototype.read=function(){for(var j=[],le=this.consumeToken();le!==f1;)j.push(le),le=this.consumeToken();return j},ne.prototype.consumeToken=function(){var j=this.consumeCodePoint();switch(j){case 34:return this.consumeStringToken(34);case 35:var le=this.peekCodePoint(0),ae=this.peekCodePoint(1),Ue=this.peekCodePoint(2);if($h(le)||Hf(ae,Ue)){var dt=go(le,ae,Ue)?2:1;return{type:5,value:this.consumeName(),flags:dt}}break;case 36:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),wg;break;case 39:return this.consumeStringToken(39);case 40:return Tx;case 41:return Dx;case 42:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),Bx;break;case 43:if(Wa(j,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(j),this.consumeNumericToken();break;case 44:return Ix;case 45:var ln=j,on=this.peekCodePoint(0),jn=this.peekCodePoint(1);if(Wa(ln,on,jn))return this.reconsumeCodePoint(j),this.consumeNumericToken();if(go(ln,on,jn))return this.reconsumeCodePoint(j),this.consumeIdentLikeToken();if(45===on&&62===jn)return this.consumeCodePoint(),this.consumeCodePoint(),z0;break;case 46:if(Wa(j,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(j),this.consumeNumericToken();break;case 47:if(42===this.peekCodePoint(0))for(this.consumeCodePoint();;){var Zn=this.consumeCodePoint();if(42===Zn&&47===(Zn=this.consumeCodePoint()))return this.consumeToken();if(-1===Zn)return this.consumeToken()}break;case 58:return Px;case 59:return Rx;case 60:if(33===this.peekCodePoint(0)&&45===this.peekCodePoint(1)&&45===this.peekCodePoint(2))return this.consumeCodePoint(),this.consumeCodePoint(),h1;break;case 64:var ri=this.peekCodePoint(0),Xi=this.peekCodePoint(1),Ss=this.peekCodePoint(2);if(go(ri,Xi,Ss))return{type:7,value:this.consumeName()};break;case 91:return kx;case 92:if(Hf(j,this.peekCodePoint(0)))return this.reconsumeCodePoint(j),this.consumeIdentLikeToken();break;case 93:return lv;case 61:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),Cg;break;case 123:return $d;case 125:return u1;case 117:case 85:var zr=this.peekCodePoint(0),Hr=this.peekCodePoint(1);return 43===zr&&(Uf(Hr)||63===Hr)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(j),this.consumeIdentLikeToken();case 124:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),Mg;if(124===this.peekCodePoint(0))return this.consumeCodePoint(),va;break;case 126:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),d1;break;case-1:return f1}return xm(j)?(this.consumeWhiteSpace(),gA):$o(j)?(this.reconsumeCodePoint(j),this.consumeNumericToken()):bg(j)?(this.reconsumeCodePoint(j),this.consumeIdentLikeToken()):{type:6,value:Re(j)}},ne.prototype.consumeCodePoint=function(){var j=this._value.shift();return typeof j>"u"?-1:j},ne.prototype.reconsumeCodePoint=function(j){this._value.unshift(j)},ne.prototype.peekCodePoint=function(j){return j>=this._value.length?-1:this._value[j]},ne.prototype.consumeUnicodeRangeToken=function(){for(var j=[],le=this.consumeCodePoint();Uf(le)&&j.length<6;)j.push(le),le=this.consumeCodePoint();for(var ae=!1;63===le&&j.length<6;)j.push(le),le=this.consumeCodePoint(),ae=!0;if(ae)return{type:30,start:parseInt(Re.apply(void 0,j.map(function(on){return 63===on?48:on})),16),end:parseInt(Re.apply(void 0,j.map(function(on){return 63===on?70:on})),16)};var Bt=parseInt(Re.apply(void 0,j),16);if(45===this.peekCodePoint(0)&&Uf(this.peekCodePoint(1))){this.consumeCodePoint(),le=this.consumeCodePoint();for(var ln=[];Uf(le)&&ln.length<6;)ln.push(le),le=this.consumeCodePoint();return{type:30,start:Bt,end:parseInt(Re.apply(void 0,ln),16)}}return{type:30,start:Bt,end:Bt}},ne.prototype.consumeIdentLikeToken=function(){var j=this.consumeName();return"url"===j.toLowerCase()&&40===this.peekCodePoint(0)?(this.consumeCodePoint(),this.consumeUrlToken()):40===this.peekCodePoint(0)?(this.consumeCodePoint(),{type:19,value:j}):{type:20,value:j}},ne.prototype.consumeUrlToken=function(){var j=[];if(this.consumeWhiteSpace(),-1===this.peekCodePoint(0))return{type:22,value:""};var le=this.peekCodePoint(0);if(39===le||34===le){var ae=this.consumeStringToken(this.consumeCodePoint());return 0===ae.type&&(this.consumeWhiteSpace(),-1===this.peekCodePoint(0)||41===this.peekCodePoint(0))?(this.consumeCodePoint(),{type:22,value:ae.value}):(this.consumeBadUrlRemnants(),U0)}for(;;){var Ue=this.consumeCodePoint();if(-1===Ue||41===Ue)return{type:22,value:Re.apply(void 0,j)};if(xm(Ue))return this.consumeWhiteSpace(),-1===this.peekCodePoint(0)||41===this.peekCodePoint(0)?(this.consumeCodePoint(),{type:22,value:Re.apply(void 0,j)}):(this.consumeBadUrlRemnants(),U0);if(34===Ue||39===Ue||40===Ue||xg(Ue))return this.consumeBadUrlRemnants(),U0;if(92===Ue){if(!Hf(Ue,this.peekCodePoint(0)))return this.consumeBadUrlRemnants(),U0;j.push(this.consumeEscapedCodePoint())}else j.push(Ue)}},ne.prototype.consumeWhiteSpace=function(){for(;xm(this.peekCodePoint(0));)this.consumeCodePoint()},ne.prototype.consumeBadUrlRemnants=function(){for(;;){var j=this.consumeCodePoint();if(41===j||-1===j)return;Hf(j,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},ne.prototype.consumeStringSlice=function(j){for(var ae="";j>0;){var Ue=Math.min(5e4,j);ae+=Re.apply(void 0,this._value.splice(0,Ue)),j-=Ue}return this._value.shift(),ae},ne.prototype.consumeStringToken=function(j){for(var le="",ae=0;;){var Ue=this._value[ae];if(-1===Ue||void 0===Ue||Ue===j)return{type:0,value:le+=this.consumeStringSlice(ae)};if(10===Ue)return this._value.splice(0,ae),wp;if(92===Ue){var dt=this._value[ae+1];-1!==dt&&void 0!==dt&&(10===dt?(le+=this.consumeStringSlice(ae),ae=-1,this._value.shift()):Hf(Ue,dt)&&(le+=this.consumeStringSlice(ae),le+=Re(this.consumeEscapedCodePoint()),ae=-1))}ae++}},ne.prototype.consumeNumber=function(){var j=[],le=4,ae=this.peekCodePoint(0);for((43===ae||45===ae)&&j.push(this.consumeCodePoint());$o(this.peekCodePoint(0));)j.push(this.consumeCodePoint());ae=this.peekCodePoint(0);var Ue=this.peekCodePoint(1);if(46===ae&&$o(Ue))for(j.push(this.consumeCodePoint(),this.consumeCodePoint()),le=8;$o(this.peekCodePoint(0));)j.push(this.consumeCodePoint());ae=this.peekCodePoint(0),Ue=this.peekCodePoint(1);var dt=this.peekCodePoint(2);if((69===ae||101===ae)&&((43===Ue||45===Ue)&&$o(dt)||$o(Ue)))for(j.push(this.consumeCodePoint(),this.consumeCodePoint()),le=8;$o(this.peekCodePoint(0));)j.push(this.consumeCodePoint());return[NC(j),le]},ne.prototype.consumeNumericToken=function(){var j=this.consumeNumber(),le=j[0],ae=j[1],Ue=this.peekCodePoint(0),dt=this.peekCodePoint(1),Bt=this.peekCodePoint(2);return go(Ue,dt,Bt)?{type:15,number:le,flags:ae,unit:this.consumeName()}:37===Ue?(this.consumeCodePoint(),{type:16,number:le,flags:ae}):{type:17,number:le,flags:ae}},ne.prototype.consumeEscapedCodePoint=function(){var j=this.consumeCodePoint();if(Uf(j)){for(var le=Re(j);Uf(this.peekCodePoint(0))&&le.length<6;)le+=Re(this.consumeCodePoint());xm(this.peekCodePoint(0))&&this.consumeCodePoint();var ae=parseInt(le,16);return 0===ae||function(ne){return ne>=55296&&ne<=57343}(ae)||ae>1114111?65533:ae}return-1===j?65533:j},ne.prototype.consumeName=function(){for(var j="";;){var le=this.consumeCodePoint();if($h(le))j+=Re(le);else{if(!Hf(le,this.peekCodePoint(0)))return this.reconsumeCodePoint(le),j;j+=Re(this.consumeEscapedCodePoint())}}},ne}(),H0=function(){function ne(j){this._tokens=j}return ne.create=function(j){var le=new Vf;return le.write(j),new ne(le.read())},ne.parseValue=function(j){return ne.create(j).parseComponentValue()},ne.parseValues=function(j){return ne.create(j).parseComponentValues()},ne.prototype.parseComponentValue=function(){for(var j=this.consumeToken();31===j.type;)j=this.consumeToken();if(32===j.type)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(j);var le=this.consumeComponentValue();do{j=this.consumeToken()}while(31===j.type);if(32===j.type)return le;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},ne.prototype.parseComponentValues=function(){for(var j=[];;){var le=this.consumeComponentValue();if(32===le.type)return j;j.push(le),j.push()}},ne.prototype.consumeComponentValue=function(){var j=this.consumeToken();switch(j.type){case 11:case 28:case 2:return this.consumeSimpleBlock(j.type);case 19:return this.consumeFunction(j)}return j},ne.prototype.consumeSimpleBlock=function(j){for(var le={type:j,values:[]},ae=this.consumeToken();;){if(32===ae.type||gu(ae,j))return le;this.reconsumeToken(ae),le.values.push(this.consumeComponentValue()),ae=this.consumeToken()}},ne.prototype.consumeFunction=function(j){for(var le={name:j.value,values:[],type:18};;){var ae=this.consumeToken();if(32===ae.type||3===ae.type)return le;this.reconsumeToken(ae),le.values.push(this.consumeComponentValue())}},ne.prototype.consumeToken=function(){var j=this._tokens.shift();return typeof j>"u"?f1:j},ne.prototype.reconsumeToken=function(j){this._tokens.unshift(j)},ne}(),xi=function(ne){return 15===ne.type},Dd=function(ne){return 17===ne.type},pi=function(ne){return 20===ne.type},xh=function(ne){return 0===ne.type},Ac=function(ne,j){return pi(ne)&&ne.value===j},Cp=function(ne){return 31!==ne.type},Xd=function(ne){return 31!==ne.type&&4!==ne.type},pd=function(ne){var j=[],le=[];return ne.forEach(function(ae){if(4===ae.type){if(0===le.length)throw new Error("Error parsing function args, zero tokens for arg");return j.push(le),void(le=[])}31!==ae.type&&le.push(ae)}),le.length&&j.push(le),j},gu=function(ne,j){return 11===j&&12===ne.type||28===j&&29===ne.type||2===j&&3===ne.type},nl=function(ne){return 17===ne.type||15===ne.type},cl=function(ne){return 16===ne.type||nl(ne)},V0=function(ne){return ne.length>1?[ne[0],ne[1]]:[ne[0]]},Xl={type:17,number:0,flags:4},Gf={type:16,number:50,flags:4},md={type:16,number:100,flags:4},wm=function(ne,j,le){var ae=ne[0],Ue=ne[1];return[ha(ae,j),ha(typeof Ue<"u"?Ue:ae,le)]},ha=function(ne,j){if(16===ne.type)return ne.number/100*j;if(xi(ne))switch(ne.unit){case"rem":case"em":return 16*ne.number;default:return ne.number}return ne.number},Fu_parse=function(ne,j){if(15===j.type)switch(j.unit){case"deg":return Math.PI*j.number/180;case"grad":return Math.PI/200*j.number;case"rad":return j.number;case"turn":return 2*Math.PI*j.number}throw new Error("Unsupported angle type")},p1=function(ne){return 15===ne.type&&("deg"===ne.unit||"grad"===ne.unit||"rad"===ne.unit||"turn"===ne.unit)},Xh=function(ne){switch(ne.filter(pi).map(function(le){return le.value}).join(" ")){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Xl,Xl];case"to top":case"bottom":return _u(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Xl,md];case"to right":case"left":return _u(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[md,md];case"to bottom":case"top":return _u(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[md,Xl];case"to left":case"right":return _u(270)}return 0},_u=function(ne){return Math.PI*ne/180},Yl_parse=function(ne,j){if(18===j.type){var le=zo[j.name];if(typeof le>"u")throw new Error('Attempting to parse an unsupported color function "'+j.name+'"');return le(ne,j.values)}if(5===j.type){if(3===j.value.length){var ae=j.value.substring(0,1),Ue=j.value.substring(1,2),dt=j.value.substring(2,3);return Kl(parseInt(ae+ae,16),parseInt(Ue+Ue,16),parseInt(dt+dt,16),1)}if(4===j.value.length){ae=j.value.substring(0,1),Ue=j.value.substring(1,2),dt=j.value.substring(2,3);var Bt=j.value.substring(3,4);return Kl(parseInt(ae+ae,16),parseInt(Ue+Ue,16),parseInt(dt+dt,16),parseInt(Bt+Bt,16)/255)}if(6===j.value.length)return ae=j.value.substring(0,2),Ue=j.value.substring(2,4),dt=j.value.substring(4,6),Kl(parseInt(ae,16),parseInt(Ue,16),parseInt(dt,16),1);if(8===j.value.length)return ae=j.value.substring(0,2),Ue=j.value.substring(2,4),dt=j.value.substring(4,6),Bt=j.value.substring(6,8),Kl(parseInt(ae,16),parseInt(Ue,16),parseInt(dt,16),parseInt(Bt,16)/255)}if(20===j.type){var ln=Wc[j.value.toUpperCase()];if(typeof ln<"u")return ln}return Wc.TRANSPARENT},Yd=function(ne){return!(255&ne)},vl=function(ne){var j=255&ne,le=255&ne>>8,ae=255&ne>>16,Ue=255&ne>>24;return j<255?"rgba("+Ue+","+ae+","+le+","+j/255+")":"rgb("+Ue+","+ae+","+le+")"},Kl=function(ne,j,le,ae){return(ne<<24|j<<16|le<<8|Math.round(255*ae))>>>0},ko=function(ne,j){if(17===ne.type)return ne.number;if(16===ne.type){var le=3===j?1:255;return 3===j?ne.number/100*le:Math.round(ne.number/100*le)}return 0},wh=function(ne,j){var le=j.filter(Xd);if(3===le.length){var ae=le.map(ko);return Kl(ae[0],ae[1],ae[2],1)}if(4===le.length){var ln=le.map(ko);return Kl(ln[0],ln[1],ln[2],ln[3])}return 0};function za(ne,j,le){return le<0&&(le+=1),le>=1&&(le-=1),le<1/6?(j-ne)*le*6+ne:le<.5?j:le<2/3?6*(j-ne)*(2/3-le)+ne:ne}var zi=function(ne,j){var le=j.filter(Xd),ae=le[0],Ue=le[1],dt=le[2],Bt=le[3],ln=(17===ae.type?_u(ae.number):Fu_parse(ne,ae))/(2*Math.PI),on=cl(Ue)?Ue.number/100:0,jn=cl(dt)?dt.number/100:0,Zn=typeof Bt<"u"&&cl(Bt)?ha(Bt,1):1;if(0===on)return Kl(255*jn,255*jn,255*jn,1);var ri=jn<=.5?jn*(on+1):jn+on-jn*on,Xi=2*jn-ri,Ss=za(Xi,ri,ln+1/3),zr=za(Xi,ri,ln),Hr=za(Xi,ri,ln-1/3);return Kl(255*Ss,255*zr,255*Hr,Zn)},zo={hsl:zi,hsla:zi,rgb:wh,rgba:wh},th=function(ne,j){return Yl_parse(ne,H0.create(j).parseComponentValue())},Wc={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},Eg={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(ne,j){return j.map(function(le){if(pi(le))switch(le.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},Ad={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},mi=function(ne,j){var le=Yl_parse(ne,j[0]),ae=j[1];return ae&&cl(ae)?{color:le,stop:ae}:{color:le,stop:null}},Tg=function(ne,j){var le=ne[0],ae=ne[ne.length-1];null===le.stop&&(le.stop=Xl),null===ae.stop&&(ae.stop=md);for(var Ue=[],dt=0,Bt=0;Bt<ne.length;Bt++){var ln=ne[Bt].stop;if(null!==ln){var on=ha(ln,j);Ue.push(on>dt?on:dt),dt=on}else Ue.push(null)}var jn=null;for(Bt=0;Bt<Ue.length;Bt++){var Zn=Ue[Bt];if(null===Zn)null===jn&&(jn=Bt);else if(null!==jn){for(var ri=Bt-jn,Ss=(Zn-Ue[jn-1])/(ri+1),zr=1;zr<=ri;zr++)Ue[jn+zr-1]=Ss*zr;jn=null}}return ne.map(function(Hr,Ho){return{color:Hr.color,stop:Math.max(Math.min(1,Ue[Ho]/j),0)}})},Cm=function(ne,j,le){var ae="number"==typeof ne?ne:function(ne,j,le){var ae=j/2,Ue=le/2,dt=ha(ne[0],j)-ae,Bt=Ue-ha(ne[1],le);return(Math.atan2(Bt,dt)+2*Math.PI)%(2*Math.PI)}(ne,j,le),Ue=Math.abs(j*Math.sin(ae))+Math.abs(le*Math.cos(ae)),dt=j/2,Bt=le/2,ln=Ue/2,on=Math.sin(ae-Math.PI/2)*ln,jn=Math.cos(ae-Math.PI/2)*ln;return[Ue,dt-jn,dt+jn,Bt-on,Bt+on]},yu=function(ne,j){return Math.sqrt(ne*ne+j*j)},Mp=function(ne,j,le,ae,Ue){return[[0,0],[0,j],[ne,0],[ne,j]].reduce(function(Bt,ln){var Zn=yu(le-ln[0],ae-ln[1]);return(Ue?Zn<Bt.optimumDistance:Zn>Bt.optimumDistance)?{optimumCorner:ln,optimumDistance:Zn}:Bt},{optimumDistance:Ue?1/0:-1/0,optimumCorner:null}).optimumCorner},Ya=function(ne,j){var le=_u(180),ae=[];return pd(j).forEach(function(Ue,dt){if(0===dt){var Bt=Ue[0];if(20===Bt.type&&-1!==["top","left","right","bottom"].indexOf(Bt.value))return void(le=Xh(Ue));if(p1(Bt))return void(le=(Fu_parse(ne,Bt)+_u(270))%_u(360))}var ln=mi(ne,Ue);ae.push(ln)}),{angle:le,stops:ae,type:1}},Ig="closest-side",Wf="farthest-side",vu="closest-corner",cv="farthest-corner",$f="ellipse",bu="contain",yA=function(ne,j){var le=0,ae=3,Ue=[],dt=[];return pd(j).forEach(function(Bt,ln){var on=!0;if(0===ln?on=Bt.reduce(function(Zn,ri){if(pi(ri))switch(ri.value){case"center":return dt.push(Gf),!1;case"top":case"left":return dt.push(Xl),!1;case"right":case"bottom":return dt.push(md),!1}else if(cl(ri)||nl(ri))return dt.push(ri),!1;return Zn},on):1===ln&&(on=Bt.reduce(function(Zn,ri){if(pi(ri))switch(ri.value){case"circle":return le=0,!1;case $f:return le=1,!1;case bu:case Ig:return ae=0,!1;case Wf:return ae=1,!1;case vu:return ae=2,!1;case"cover":case cv:return ae=3,!1}else if(nl(ri)||cl(ri))return Array.isArray(ae)||(ae=[]),ae.push(ri),!1;return Zn},on)),on){var jn=mi(ne,Bt);Ue.push(jn)}}),{size:ae,shape:le,stops:Ue,position:dt,type:2}},nh_parse=function(ne,j){if(22===j.type){var le={url:j.value,type:0};return ne.cache.addImage(j.value),le}if(18===j.type){var ae=Bg[j.name];if(typeof ae>"u")throw new Error('Attempting to parse an unsupported image function "'+j.name+'"');return ae(ne,j.values)}throw new Error("Unsupported image type "+j.type)};for(var Bg={"linear-gradient":function(ne,j){var le=_u(180),ae=[];return pd(j).forEach(function(Ue,dt){if(0===dt){var Bt=Ue[0];if(20===Bt.type&&"to"===Bt.value)return void(le=Xh(Ue));if(p1(Bt))return void(le=Fu_parse(ne,Bt))}var ln=mi(ne,Ue);ae.push(ln)}),{angle:le,stops:ae,type:1}},"-moz-linear-gradient":Ya,"-ms-linear-gradient":Ya,"-o-linear-gradient":Ya,"-webkit-linear-gradient":Ya,"radial-gradient":function(ne,j){var le=0,ae=3,Ue=[],dt=[];return pd(j).forEach(function(Bt,ln){var on=!0;if(0===ln){var jn=!1;on=Bt.reduce(function(ri,Xi){if(jn)if(pi(Xi))switch(Xi.value){case"center":return dt.push(Gf),ri;case"top":case"left":return dt.push(Xl),ri;case"right":case"bottom":return dt.push(md),ri}else(cl(Xi)||nl(Xi))&&dt.push(Xi);else if(pi(Xi))switch(Xi.value){case"circle":return le=0,!1;case $f:return le=1,!1;case"at":return jn=!0,!1;case Ig:return ae=0,!1;case"cover":case Wf:return ae=1,!1;case bu:case vu:return ae=2,!1;case cv:return ae=3,!1}else if(nl(Xi)||cl(Xi))return Array.isArray(ae)||(ae=[]),ae.push(Xi),!1;return ri},on)}if(on){var Zn=mi(ne,Bt);Ue.push(Zn)}}),{size:ae,shape:le,stops:Ue,position:dt,type:2}},"-moz-radial-gradient":yA,"-ms-radial-gradient":yA,"-o-radial-gradient":yA,"-webkit-radial-gradient":yA,"-webkit-gradient":function(ne,j){var le=_u(180),ae=[],Ue=1;return pd(j).forEach(function(on,jn){var Zn=on[0];if(0===jn){if(pi(Zn)&&"linear"===Zn.value)return void(Ue=1);if(pi(Zn)&&"radial"===Zn.value)return void(Ue=2)}if(18===Zn.type)if("from"===Zn.name){var ri=Yl_parse(ne,Zn.values[0]);ae.push({stop:Xl,color:ri})}else if("to"===Zn.name)ri=Yl_parse(ne,Zn.values[0]),ae.push({stop:md,color:ri});else if("color-stop"===Zn.name){var Xi=Zn.values.filter(Xd);if(2===Xi.length){ri=Yl_parse(ne,Xi[1]);var Ss=Xi[0];Dd(Ss)&&ae.push({stop:{type:16,number:100*Ss.number,flags:Ss.flags},color:ri})}}}),1===Ue?{angle:(le+_u(180))%_u(360),stops:ae,type:Ue}:{size:3,shape:0,stops:ae,position:[],type:Ue}}},Os={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(ne,j){if(0===j.length)return[];var le=j[0];return 20===le.type&&"none"===le.value?[]:j.filter(function(ae){return Xd(ae)&&function Zr(ne){return!(20===ne.type&&"none"===ne.value||18===ne.type&&!Bg[ne.name])}(ae)}).map(function(ae){return nh_parse(ne,ae)})}},vo={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(ne,j){return j.map(function(le){if(pi(le))switch(le.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},Lu={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(ne,j){return pd(j).map(function(le){return le.filter(cl)}).map(V0)}},Ft={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(ne,j){return pd(j).map(function(le){return le.filter(pi).map(function(ae){return ae.value}).join(" ")}).map(Ic)}},Ic=function(ne){switch(ne){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;default:return 0}},Wo=function(ne){return ne.AUTO="auto",ne.CONTAIN="contain",ne.COVER="cover",ne}(Wo||{}),rl={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(ne,j){return pd(j).map(function(le){return le.filter(bl)})}},bl=function(ne){return pi(ne)||cl(ne)},Sl=function(ne){return{name:"border-"+ne+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},Bc=Sl("top"),Sp=Sl("right"),Ep=Sl("bottom"),_c=Sl("left"),Pc=function(ne){return{name:"border-radius-"+ne,initialValue:"0 0",prefix:!1,type:1,parse:function(j,le){return V0(le.filter(cl))}}},Kh=Pc("top-left"),Nu=Pc("top-right"),Mm=Pc("bottom-right"),Tp=Pc("bottom-left"),Dp=function(ne){return{name:"border-"+ne+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(j,le){switch(le){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},Uu=Dp("top"),A1=Dp("right"),q0=Dp("bottom"),vA=Dp("left"),Zh=function(ne){return{name:"border-"+ne+"-width",initialValue:"0",type:0,prefix:!1,parse:function(j,le){return xi(le)?le.number:0}}},Kd=Zh("top"),Pg=Zh("right"),Ip=Zh("bottom"),dv=Zh("left"),ih={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},yc={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(ne,j){return"rtl"===j?1:0}},Rg={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(ne,j){return j.filter(pi).reduce(function(le,ae){return le|Jh(ae.value)},0)}},Jh=function(ne){switch(ne){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},bo={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(ne,j){switch(j){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},Rc={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(ne,j){return 20===j.type&&"normal"===j.value?0:17===j.type||15===j.type?j.number:0}},jc=function(ne){return ne.NORMAL="normal",ne.STRICT="strict",ne}(jc||{}),kg={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(ne,j){return"strict"===j?jc.STRICT:jc.NORMAL}},Sm={name:"line-height",initialValue:"normal",prefix:!1,type:4},rh=function(ne,j){return pi(ne)&&"normal"===ne.value?1.2*j:17===ne.type?j*ne.number:cl(ne)?ha(ne,j):j},Em={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(ne,j){return 20===j.type&&"none"===j.value?null:nh_parse(ne,j)}},vc={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(ne,j){return"inside"===j?0:1}},bA={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(ne,j){switch(j){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;default:return-1}}},Bp=function(ne){return{name:"margin-"+ne,initialValue:"0",prefix:!1,type:4}},ef=Bp("top"),Q0=Bp("right"),El=Bp("bottom"),Pp=Bp("left"),W0={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(ne,j){return j.filter(pi).map(function(le){switch(le.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;default:return 0}})}},xA={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(ne,j){return"break-word"===j?"break-word":"normal"}},Nl=function(ne){return{name:"padding-"+ne,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},Rp=Nl("top"),sa=Nl("right"),Id=Nl("bottom"),g1=Nl("left"),Fg={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(ne,j){switch(j){case"right":return 2;case"center":case"justify":return 1;default:return 0}}},Fx={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(ne,j){switch(j){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},_1={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(ne,j){return 1===j.length&&Ac(j[0],"none")?[]:pd(j).map(function(le){for(var ae={color:Wc.TRANSPARENT,offsetX:Xl,offsetY:Xl,blur:Xl},Ue=0,dt=0;dt<le.length;dt++){var Bt=le[dt];nl(Bt)?(0===Ue?ae.offsetX=Bt:1===Ue?ae.offsetY=Bt:ae.blur=Bt,Ue++):ae.color=Yl_parse(ne,Bt)}return ae})}},Og={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(ne,j){switch(j){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},wA={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(ne,j){if(20===j.type&&"none"===j.value)return null;if(18===j.type){var le=CA[j.name];if(typeof le>"u")throw new Error('Attempting to parse an unsupported transform function "'+j.name+'"');return le(j.values)}return null}},CA={matrix:function(ne){var j=ne.filter(function(le){return 17===le.type}).map(function(le){return le.number});return 6===j.length?j:null},matrix3d:function(ne){var j=ne.filter(function(on){return 17===on.type}).map(function(on){return on.number});return 16===j.length?[j[0],j[1],j[4],j[5],j[12],j[13]]:null}},sh={type:16,number:50,flags:4},Tl=[sh,sh],Gr={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(ne,j){var le=j.filter(cl);return 2!==le.length?Tl:[le[0],le[1]]}},so={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(ne,j){switch(j){case"hidden":return 1;case"collapse":return 2;default:return 0}}},ml=function(ne){return ne.NORMAL="normal",ne.BREAK_ALL="break-all",ne.KEEP_ALL="keep-all",ne}(ml||{}),Zd={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(ne,j){switch(j){case"break-all":return ml.BREAK_ALL;case"keep-all":return ml.KEEP_ALL;default:return ml.NORMAL}}},oc={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(ne,j){if(20===j.type)return{auto:!0,order:0};if(Dd(j))return{auto:!1,order:j.number};throw new Error("Invalid z-index number parsed")}},Ul={name:"time",parse:function(ne,j){if(15===j.type)switch(j.unit.toLowerCase()){case"s":return 1e3*j.number;case"ms":return j.number}throw new Error("Unsupported time type")}},tf={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(ne,j){return Dd(j)?j.number:1}},Ka={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},$c={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(ne,j){return j.filter(pi).map(function(le){switch(le.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(le){return 0!==le})}},zu={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(ne,j){var le=[],ae=[];return j.forEach(function(Ue){switch(Ue.type){case 20:case 0:le.push(Ue.value);break;case 17:le.push(Ue.number.toString());break;case 4:ae.push(le.join(" ")),le.length=0}}),le.length&&ae.push(le.join(" ")),ae.map(function(Ue){return-1===Ue.indexOf(" ")?Ue:"'"+Ue+"'"})}},Mo={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},kp={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(ne,j){return Dd(j)?j.number:pi(j)&&"bold"===j.value?700:400}},j0={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(ne,j){return j.filter(pi).map(function(le){return le.value})}},nf={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(ne,j){switch(j){case"oblique":return"oblique";case"italic":return"italic";default:return"normal"}}},Yo=function(ne,j){return!!(ne&j)},Rl={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(ne,j){if(0===j.length)return[];var le=j[0];return 20===le.type&&"none"===le.value?[]:j}},Tm={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(ne,j){if(0===j.length)return null;var le=j[0];if(20===le.type&&"none"===le.value)return null;for(var ae=[],Ue=j.filter(Cp),dt=0;dt<Ue.length;dt++){var Bt=Ue[dt],ln=Ue[dt+1];if(20===Bt.type){var on=ln&&Dd(ln)?ln.number:1;ae.push({counter:Bt.value,increment:on})}}return ae}},bc={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(ne,j){if(0===j.length)return[];for(var le=[],ae=j.filter(Cp),Ue=0;Ue<ae.length;Ue++){var dt=ae[Ue],Bt=ae[Ue+1];if(pi(dt)&&"none"!==dt.value){var ln=Bt&&Dd(Bt)?Bt.number:0;le.push({counter:dt.value,reset:ln})}}return le}},Fp={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(ne,j){return j.filter(xi).map(function(le){return Ul.parse(ne,le)})}},Op={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(ne,j){if(0===j.length)return null;var le=j[0];if(20===le.type&&"none"===le.value)return null;var ae=[],Ue=j.filter(xh);if(Ue.length%2!=0)return null;for(var dt=0;dt<Ue.length;dt+=2)ae.push({open:Ue[dt].value,close:Ue[dt+1].value});return ae}},ac=function(ne,j,le){if(!ne)return"";var ae=ne[Math.min(j,ne.length-1)];return ae?le?ae.open:ae.close:""},Bd={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(ne,j){return 1===j.length&&Ac(j[0],"none")?[]:pd(j).map(function(le){for(var ae={color:255,offsetX:Xl,offsetY:Xl,blur:Xl,spread:Xl,inset:!1},Ue=0,dt=0;dt<le.length;dt++){var Bt=le[dt];Ac(Bt,"inset")?ae.inset=!0:nl(Bt)?(0===Ue?ae.offsetX=Bt:1===Ue?ae.offsetY=Bt:2===Ue?ae.blur=Bt:ae.spread=Bt,Ue++):ae.color=Yl_parse(ne,Bt)}return ae})}},Dl={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(ne,j){var ae=[];return j.filter(pi).forEach(function(Ue){switch(Ue.value){case"stroke":ae.push(1);break;case"fill":ae.push(0);break;case"markers":ae.push(2)}}),[0,1,2].forEach(function(Ue){-1===ae.indexOf(Ue)&&ae.push(Ue)}),ae}},Cs={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},Mh={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(ne,j){return xi(j)?j.number:0}},rf=function(){function ne(j,le){var ae,Ue;this.animationDuration=cs(j,Fp,le.animationDuration),this.backgroundClip=cs(j,Eg,le.backgroundClip),this.backgroundColor=cs(j,Ad,le.backgroundColor),this.backgroundImage=cs(j,Os,le.backgroundImage),this.backgroundOrigin=cs(j,vo,le.backgroundOrigin),this.backgroundPosition=cs(j,Lu,le.backgroundPosition),this.backgroundRepeat=cs(j,Ft,le.backgroundRepeat),this.backgroundSize=cs(j,rl,le.backgroundSize),this.borderTopColor=cs(j,Bc,le.borderTopColor),this.borderRightColor=cs(j,Sp,le.borderRightColor),this.borderBottomColor=cs(j,Ep,le.borderBottomColor),this.borderLeftColor=cs(j,_c,le.borderLeftColor),this.borderTopLeftRadius=cs(j,Kh,le.borderTopLeftRadius),this.borderTopRightRadius=cs(j,Nu,le.borderTopRightRadius),this.borderBottomRightRadius=cs(j,Mm,le.borderBottomRightRadius),this.borderBottomLeftRadius=cs(j,Tp,le.borderBottomLeftRadius),this.borderTopStyle=cs(j,Uu,le.borderTopStyle),this.borderRightStyle=cs(j,A1,le.borderRightStyle),this.borderBottomStyle=cs(j,q0,le.borderBottomStyle),this.borderLeftStyle=cs(j,vA,le.borderLeftStyle),this.borderTopWidth=cs(j,Kd,le.borderTopWidth),this.borderRightWidth=cs(j,Pg,le.borderRightWidth),this.borderBottomWidth=cs(j,Ip,le.borderBottomWidth),this.borderLeftWidth=cs(j,dv,le.borderLeftWidth),this.boxShadow=cs(j,Bd,le.boxShadow),this.color=cs(j,ih,le.color),this.direction=cs(j,yc,le.direction),this.display=cs(j,Rg,le.display),this.float=cs(j,bo,le.cssFloat),this.fontFamily=cs(j,zu,le.fontFamily),this.fontSize=cs(j,Mo,le.fontSize),this.fontStyle=cs(j,nf,le.fontStyle),this.fontVariant=cs(j,j0,le.fontVariant),this.fontWeight=cs(j,kp,le.fontWeight),this.letterSpacing=cs(j,Rc,le.letterSpacing),this.lineBreak=cs(j,kg,le.lineBreak),this.lineHeight=cs(j,Sm,le.lineHeight),this.listStyleImage=cs(j,Em,le.listStyleImage),this.listStylePosition=cs(j,vc,le.listStylePosition),this.listStyleType=cs(j,bA,le.listStyleType),this.marginTop=cs(j,ef,le.marginTop),this.marginRight=cs(j,Q0,le.marginRight),this.marginBottom=cs(j,El,le.marginBottom),this.marginLeft=cs(j,Pp,le.marginLeft),this.opacity=cs(j,tf,le.opacity);var dt=cs(j,W0,le.overflow);this.overflowX=dt[0],this.overflowY=dt[dt.length>1?1:0],this.overflowWrap=cs(j,xA,le.overflowWrap),this.paddingTop=cs(j,Rp,le.paddingTop),this.paddingRight=cs(j,sa,le.paddingRight),this.paddingBottom=cs(j,Id,le.paddingBottom),this.paddingLeft=cs(j,g1,le.paddingLeft),this.paintOrder=cs(j,Dl,le.paintOrder),this.position=cs(j,Fx,le.position),this.textAlign=cs(j,Fg,le.textAlign),this.textDecorationColor=cs(j,Ka,null!==(ae=le.textDecorationColor)&&void 0!==ae?ae:le.color),this.textDecorationLine=cs(j,$c,null!==(Ue=le.textDecorationLine)&&void 0!==Ue?Ue:le.textDecoration),this.textShadow=cs(j,_1,le.textShadow),this.textTransform=cs(j,Og,le.textTransform),this.transform=cs(j,wA,le.transform),this.transformOrigin=cs(j,Gr,le.transformOrigin),this.visibility=cs(j,so,le.visibility),this.webkitTextStrokeColor=cs(j,Cs,le.webkitTextStrokeColor),this.webkitTextStrokeWidth=cs(j,Mh,le.webkitTextStrokeWidth),this.wordBreak=cs(j,Zd,le.wordBreak),this.zIndex=cs(j,oc,le.zIndex)}return ne.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&0===this.visibility},ne.prototype.isTransparent=function(){return Yd(this.backgroundColor)},ne.prototype.isTransformed=function(){return null!==this.transform},ne.prototype.isPositioned=function(){return 0!==this.position},ne.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},ne.prototype.isFloating=function(){return 0!==this.float},ne.prototype.isInlineLevel=function(){return Yo(this.display,4)||Yo(this.display,33554432)||Yo(this.display,268435456)||Yo(this.display,536870912)||Yo(this.display,67108864)||Yo(this.display,134217728)},ne}(),oh=function(){return function ne(j,le){this.content=cs(j,Rl,le.content),this.quotes=cs(j,Op,le.quotes)}}(),kc=function(){return function ne(j,le){this.counterIncrement=cs(j,Tm,le.counterIncrement),this.counterReset=cs(j,bc,le.counterReset)}}(),cs=function(ne,j,le){var ae=new Vf,Ue=null!==le&&typeof le<"u"?le.toString():j.initialValue;ae.write(Ue);var dt=new H0(ae.read());switch(j.type){case 2:var Bt=dt.parseComponentValue();return j.parse(ne,pi(Bt)?Bt.value:j.initialValue);case 0:return j.parse(ne,dt.parseComponentValue());case 1:return j.parse(ne,dt.parseComponentValues());case 4:return dt.parseComponentValue();case 3:switch(j.format){case"angle":return Fu_parse(ne,dt.parseComponentValue());case"color":return Yl_parse(ne,dt.parseComponentValue());case"image":return nh_parse(ne,dt.parseComponentValue());case"length":var ln=dt.parseComponentValue();return nl(ln)?ln:Xl;case"length-percentage":var on=dt.parseComponentValue();return cl(on)?on:Xl;case"time":return Ul.parse(ne,dt.parseComponentValue())}}},Fc=function(ne,j){var le=function(ne){switch(ne.getAttribute("data-html2canvas-debug")){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}}(ne);return 1===le||j===le},dl=function(){return function ne(j,le){this.context=j,this.textNodes=[],this.elements=[],this.flags=0,Fc(le,3),this.styles=new rf(j,window.getComputedStyle(le,null)),e_(le)&&(this.styles.animationDuration.some(function(ae){return ae>0})&&(le.style.animationDuration="0s"),null!==this.styles.transform&&(le.style.transform="none")),this.bounds=ot(this.context,le),Fc(le,4)&&(this.flags|=16)}}(),sf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",zl=typeof Uint8Array>"u"?[]:new Uint8Array(256),Hl=0;Hl<64;Hl++)zl[sf.charCodeAt(Hl)]=Hl;for(var lc=function(ne,j,le){return ne.slice?ne.slice(j,le):new Uint16Array(Array.prototype.slice.call(ne,j,le))},Jd=function(){function ne(j,le,ae,Ue,dt,Bt){this.initialValue=j,this.errorValue=le,this.highStart=ae,this.highValueIndex=Ue,this.index=dt,this.data=Bt}return ne.prototype.get=function(j){var le;if(j>=0){if(j<55296||j>56319&&j<=65535)return this.data[le=((le=this.index[j>>5])<<2)+(31&j)];if(j<=65535)return this.data[le=((le=this.index[2048+(j-55296>>5)])<<2)+(31&j)];if(j<this.highStart)return le=this.index[le=2080+(j>>11)],this.data[le=((le=this.index[le+=j>>5&63])<<2)+(31&j)];if(j<=1114111)return this.data[this.highValueIndex]}return this.errorValue},ne}(),Im="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",v1=typeof Uint8Array>"u"?[]:new Uint8Array(256),Eh=0;Eh<64;Eh++)v1[Im.charCodeAt(Eh)]=Eh;var df=8,Bm=9,Zf=11,Jf=12,hv=function(){for(var ne=[],j=0;j<arguments.length;j++)ne[j]=arguments[j];if(String.fromCodePoint)return String.fromCodePoint.apply(String,ne);var le=ne.length;if(!le)return"";for(var ae=[],Ue=-1,dt="";++Ue<le;){var Bt=ne[Ue];Bt<=65535?ae.push(Bt):ae.push(55296+((Bt-=65536)>>10),Bt%1024+56320),(Ue+1===le||ae.length>16384)&&(dt+=String.fromCharCode.apply(String,ae),ae.length=0)}return dt},Pm=function(ne,j){var le=function(ne){var ae,dt,Bt,ln,on,j=.75*ne.length,le=ne.length,Ue=0;"="===ne[ne.length-1]&&(j--,"="===ne[ne.length-2]&&j--);var jn=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(j):new Array(j),Zn=Array.isArray(jn)?jn:new Uint8Array(jn);for(ae=0;ae<le;ae+=4)dt=zl[ne.charCodeAt(ae)],Bt=zl[ne.charCodeAt(ae+1)],ln=zl[ne.charCodeAt(ae+2)],on=zl[ne.charCodeAt(ae+3)],Zn[Ue++]=dt<<2|Bt>>4,Zn[Ue++]=(15&Bt)<<4|ln>>2,Zn[Ue++]=(3&ln)<<6|63&on;return jn}(ne),ae=Array.isArray(le)?function(ne){for(var j=ne.length,le=[],ae=0;ae<j;ae+=4)le.push(ne[ae+3]<<24|ne[ae+2]<<16|ne[ae+1]<<8|ne[ae]);return le}(le):new Uint32Array(le),Ue=Array.isArray(le)?function(ne){for(var j=ne.length,le=[],ae=0;ae<j;ae+=2)le.push(ne[ae+1]<<8|ne[ae]);return le}(le):new Uint16Array(le),Bt=lc(Ue,12,ae[4]/2),ln=2===ae[5]?lc(Ue,(24+ae[4])/2):function(ne,j,le){return ne.slice?ne.slice(j,le):new Uint32Array(Array.prototype.slice.call(ne,j,le))}(ae,Math.ceil((24+ae[4])/4));return new Jd(ae[0],ae[1],ae[2],ae[3],Bt,ln)}("AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA="),IA=function(ne){return Pm.get(ne)},Pd=function(ne,j,le){var ae=le-2,Ue=j[ae],dt=j[le-1],Bt=j[le];if(2===dt&&3===Bt)return"\xd7";if(2===dt||3===dt||4===dt||2===Bt||3===Bt||4===Bt)return"\xf7";if(dt===df&&-1!==[df,Bm,Zf,Jf].indexOf(Bt)||(dt===Zf||dt===Bm)&&(Bt===Bm||10===Bt)||(dt===Jf||10===dt)&&10===Bt||13===Bt||5===Bt||7===Bt||1===dt)return"\xd7";if(13===dt&&14===Bt){for(;5===Ue;)Ue=j[--ae];if(14===Ue)return"\xd7"}if(15===dt&&15===Bt){for(var ln=0;15===Ue;)ln++,Ue=j[--ae];if(ln%2==0)return"\xd7"}return"\xf7"},Rm=function(ne){var j=function(ne){for(var j=[],le=0,ae=ne.length;le<ae;){var Ue=ne.charCodeAt(le++);if(Ue>=55296&&Ue<=56319&&le<ae){var dt=ne.charCodeAt(le++);56320==(64512&dt)?j.push(((1023&Ue)<<10)+(1023&dt)+65536):(j.push(Ue),le--)}else j.push(Ue)}return j}(ne),le=j.length,ae=0,Ue=0,dt=j.map(IA);return{next:function(){if(ae>=le)return{done:!0,value:null};for(var Bt="\xd7";ae<le&&"\xd7"===(Bt=Pd(0,dt,++ae)););if("\xd7"!==Bt||ae===le){var ln=hv.apply(null,j.slice(Ue,ae));return Ue=ae,{value:ln,done:!1}}return{done:!0,value:null}}}},Vu=function(ne){return 0===ne[0]&&255===ne[1]&&0===ne[2]&&255===ne[3]},Y0=function(ne,j,le,ae,Ue){var dt="http://www.w3.org/2000/svg",Bt=document.createElementNS(dt,"svg"),ln=document.createElementNS(dt,"foreignObject");return Bt.setAttributeNS(null,"width",ne.toString()),Bt.setAttributeNS(null,"height",j.toString()),ln.setAttributeNS(null,"width","100%"),ln.setAttributeNS(null,"height","100%"),ln.setAttributeNS(null,"x",le.toString()),ln.setAttributeNS(null,"y",ae.toString()),ln.setAttributeNS(null,"externalResourcesRequired","true"),Bt.appendChild(ln),ln.appendChild(Ue),Bt},K0=function(ne){return new Promise(function(j,le){var ae=new Image;ae.onload=function(){return j(ae)},ae.onerror=le,ae.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(ne))})},Oc={get SUPPORT_RANGE_BOUNDS(){var ne=function(ne){if(ne.createRange){var le=ne.createRange();if(le.getBoundingClientRect){var ae=ne.createElement("boundtest");ae.style.height="123px",ae.style.display="block",ne.body.appendChild(ae),le.selectNode(ae);var Ue=le.getBoundingClientRect(),dt=Math.round(Ue.height);if(ne.body.removeChild(ae),123===dt)return!0}}return!1}(document);return Object.defineProperty(Oc,"SUPPORT_RANGE_BOUNDS",{value:ne}),ne},get SUPPORT_WORD_BREAKING(){var ne=Oc.SUPPORT_RANGE_BOUNDS&&function(ne){var j=ne.createElement("boundtest");j.style.width="50px",j.style.display="block",j.style.fontSize="12px",j.style.letterSpacing="0px",j.style.wordSpacing="0px",ne.body.appendChild(j);var le=ne.createRange();j.innerHTML="function"==typeof"".repeat?"&#128104;".repeat(10):"";var ae=j.firstChild,Ue=Ze(ae.data).map(function(on){return Re(on)}),dt=0,Bt={},ln=Ue.every(function(on,jn){le.setStart(ae,dt),le.setEnd(ae,dt+on.length);var Zn=le.getBoundingClientRect();dt+=on.length;var ri=Zn.x>Bt.x||Zn.y>Bt.y;return Bt=Zn,0===jn||ri});return ne.body.removeChild(j),ln}(document);return Object.defineProperty(Oc,"SUPPORT_WORD_BREAKING",{value:ne}),ne},get SUPPORT_SVG_DRAWING(){var ne=function(ne){var j=new Image,le=ne.createElement("canvas"),ae=le.getContext("2d");if(!ae)return!1;j.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{ae.drawImage(j,0,0),le.toDataURL()}catch{return!1}return!0}(document);return Object.defineProperty(Oc,"SUPPORT_SVG_DRAWING",{value:ne}),ne},get SUPPORT_FOREIGNOBJECT_DRAWING(){var ne="function"==typeof Array.from&&"function"==typeof window.fetch?function(ne){var j=ne.createElement("canvas"),le=100;j.width=le,j.height=le;var ae=j.getContext("2d");if(!ae)return Promise.reject(!1);ae.fillStyle="rgb(0, 255, 0)",ae.fillRect(0,0,le,le);var Ue=new Image,dt=j.toDataURL();Ue.src=dt;var Bt=Y0(le,le,0,0,Ue);return ae.fillStyle="red",ae.fillRect(0,0,le,le),K0(Bt).then(function(ln){ae.drawImage(ln,0,0);var on=ae.getImageData(0,0,le,le).data;ae.fillStyle="red",ae.fillRect(0,0,le,le);var jn=ne.createElement("div");return jn.style.backgroundImage="url("+dt+")",jn.style.height="100px",Vu(on)?K0(Y0(le,le,0,0,jn)):Promise.reject(!1)}).then(function(ln){return ae.drawImage(ln,0,0),Vu(ae.getImageData(0,0,le,le).data)}).catch(function(){return!1})}(document):Promise.resolve(!1);return Object.defineProperty(Oc,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:ne}),ne},get SUPPORT_CORS_IMAGES(){var ne=typeof(new Image).crossOrigin<"u";return Object.defineProperty(Oc,"SUPPORT_CORS_IMAGES",{value:ne}),ne},get SUPPORT_RESPONSE_TYPE(){var ne="string"==typeof(new XMLHttpRequest).responseType;return Object.defineProperty(Oc,"SUPPORT_RESPONSE_TYPE",{value:ne}),ne},get SUPPORT_CORS_XHR(){var ne="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Oc,"SUPPORT_CORS_XHR",{value:ne}),ne},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var ne=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Oc,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:ne}),ne}},ff=function(){return function ne(j,le){this.text=j,this.bounds=le}}(),tp=function(ne,j){var le=j.ownerDocument;if(le){var ae=le.createElement("html2canvaswrapper");ae.appendChild(j.cloneNode(!0));var Ue=j.parentNode;if(Ue){Ue.replaceChild(ae,j);var dt=ot(ne,ae);return ae.firstChild&&Ue.replaceChild(ae.firstChild,ae),dt}}return ke.EMPTY},zg=function(ne,j,le){var ae=ne.ownerDocument;if(!ae)throw new Error("Node has no owner document");var Ue=ae.createRange();return Ue.setStart(ne,j),Ue.setEnd(ne,j+le),Ue},Dh=function(ne){if(Oc.SUPPORT_NATIVE_TEXT_SEGMENTATION){var j=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(j.segment(ne)).map(function(le){return le.segment})}return function(ne){for(var ae,j=Rm(ne),le=[];!(ae=j.next()).done;)ae.value&&le.push(ae.value.slice());return le}(ne)},x1=function(ne,j){return 0!==j.letterSpacing?Dh(ne):function(ne,j){if(Oc.SUPPORT_NATIVE_TEXT_SEGMENTATION){var le=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(le.segment(ne)).map(function(ae){return ae.segment})}return ja(ne,j)}(ne,j)},Ox=[32,160,4961,65792,65793,4153,4241],ja=function(ne,j){for(var Ue,le=function(ne,j){var le=Ze(ne),ae=_e(le,j),Ue=ae[0],dt=ae[1],Bt=ae[2],ln=le.length,on=0,jn=0;return{next:function(){if(jn>=ln)return{done:!0,value:null};for(var Zn=dn;jn<ln&&(Zn=ie(le,dt,Ue,++jn,Bt))===dn;);if(Zn!==dn||jn===ln){var ri=new Oe(le,Zn,on,jn);return on=jn,{value:ri,done:!1}}return{done:!0,value:null}}}}(ne,{lineBreak:j.lineBreak,wordBreak:"break-word"===j.overflowWrap?"break-word":j.wordBreak}),ae=[],dt=function(){if(Ue.value){var Bt=Ue.value.slice(),ln=Ze(Bt),on="";ln.forEach(function(jn){-1===Ox.indexOf(jn)?on+=Re(jn):(on.length&&ae.push(on),ae.push(Re(jn)),on="")}),on.length&&ae.push(on)}};!(Ue=le.next()).done;)dt();return ae},fv=function(){return function ne(j,le,ae){this.text=PA(le.data,ae.textTransform),this.textBounds=function(ne,j,le,ae){var Ue=x1(j,le),dt=[],Bt=0;return Ue.forEach(function(ln){if(le.textDecorationLine.length||ln.trim().length>0)if(Oc.SUPPORT_RANGE_BOUNDS){var on=zg(ae,Bt,ln.length).getClientRects();if(on.length>1){var jn=Dh(ln),Zn=0;jn.forEach(function(Xi){dt.push(new ff(Xi,ke.fromDOMRectList(ne,zg(ae,Zn+Bt,Xi.length).getClientRects()))),Zn+=Xi.length})}else dt.push(new ff(ln,ke.fromDOMRectList(ne,on)))}else{var ri=ae.splitText(ln.length);dt.push(new ff(ln,tp(ne,ae))),ae=ri}else Oc.SUPPORT_RANGE_BOUNDS||(ae=ae.splitText(ln.length));Bt+=ln.length}),dt}(j,this.text,ae,le)}}(),PA=function(ne,j){switch(j){case 1:return ne.toLowerCase();case 3:return ne.replace(Fm,Om);case 2:return ne.toUpperCase();default:return ne}},Fm=/(^|\s|:|-|\(|\))([a-z])/g,Om=function(ne,j,le){return ne.length>0?j+le.toUpperCase():ne},w1=function(ne){function j(le,ae){var Ue=ne.call(this,le,ae)||this;return Ue.src=ae.currentSrc||ae.src,Ue.intrinsicWidth=ae.naturalWidth,Ue.intrinsicHeight=ae.naturalHeight,Ue.context.cache.addImage(Ue.src),Ue}return Se(j,ne),j}(dl),C1=function(ne){function j(le,ae){var Ue=ne.call(this,le,ae)||this;return Ue.canvas=ae,Ue.intrinsicWidth=ae.width,Ue.intrinsicHeight=ae.height,Ue}return Se(j,ne),j}(dl),M1=function(ne){function j(le,ae){var Ue=ne.call(this,le,ae)||this,dt=new XMLSerializer,Bt=ot(le,ae);return ae.setAttribute("width",Bt.width+"px"),ae.setAttribute("height",Bt.height+"px"),Ue.svg="data:image/svg+xml,"+encodeURIComponent(dt.serializeToString(ae)),Ue.intrinsicWidth=ae.width.baseVal.value,Ue.intrinsicHeight=ae.height.baseVal.value,Ue.context.cache.addImage(Ue.svg),Ue}return Se(j,ne),j}(dl),S1=function(ne){function j(le,ae){var Ue=ne.call(this,le,ae)||this;return Ue.value=ae.value,Ue}return Se(j,ne),j}(dl),Hg=function(ne){function j(le,ae){var Ue=ne.call(this,le,ae)||this;return Ue.start=ae.start,Ue.reversed="boolean"==typeof ae.reversed&&!0===ae.reversed,Ue}return Se(j,ne),j}(dl),Zi=[{type:15,flags:0,unit:"px",number:3}],wa=[{type:16,flags:0,number:50}],Ha="checkbox",RA="radio",Lm="password",uh=707406591,kA=function(ne){function j(le,ae){var Ue=ne.call(this,le,ae)||this;switch(Ue.type=ae.type.toLowerCase(),Ue.checked=ae.checked,Ue.value=function(ne){var j=ne.type===Lm?new Array(ne.value.length+1).join("\u2022"):ne.value;return 0===j.length?ne.placeholder||"":j}(ae),(Ue.type===Ha||Ue.type===RA)&&(Ue.styles.backgroundColor=3739148031,Ue.styles.borderTopColor=Ue.styles.borderRightColor=Ue.styles.borderBottomColor=Ue.styles.borderLeftColor=2779096575,Ue.styles.borderTopWidth=Ue.styles.borderRightWidth=Ue.styles.borderBottomWidth=Ue.styles.borderLeftWidth=1,Ue.styles.borderTopStyle=Ue.styles.borderRightStyle=Ue.styles.borderBottomStyle=Ue.styles.borderLeftStyle=1,Ue.styles.backgroundClip=[0],Ue.styles.backgroundOrigin=[0],Ue.bounds=function(ne){return ne.width>ne.height?new ke(ne.left+(ne.width-ne.height)/2,ne.top,ne.height,ne.height):ne.width<ne.height?new ke(ne.left,ne.top+(ne.height-ne.width)/2,ne.width,ne.width):ne}(Ue.bounds)),Ue.type){case Ha:Ue.styles.borderTopRightRadius=Ue.styles.borderTopLeftRadius=Ue.styles.borderBottomRightRadius=Ue.styles.borderBottomLeftRadius=Zi;break;case RA:Ue.styles.borderTopRightRadius=Ue.styles.borderTopLeftRadius=Ue.styles.borderBottomRightRadius=Ue.styles.borderBottomLeftRadius=wa}return Ue}return Se(j,ne),j}(dl),Vg=function(ne){function j(le,ae){var Ue=ne.call(this,le,ae)||this,dt=ae.options[ae.selectedIndex||0];return Ue.value=dt&&dt.text||"",Ue}return Se(j,ne),j}(dl),E1=function(ne){function j(le,ae){var Ue=ne.call(this,le,ae)||this;return Ue.value=ae.value,Ue}return Se(j,ne),j}(dl),pv=function(ne){function j(le,ae){var Ue=ne.call(this,le,ae)||this;Ue.src=ae.src,Ue.width=parseInt(ae.width,10)||0,Ue.height=parseInt(ae.height,10)||0,Ue.backgroundColor=Ue.styles.backgroundColor;try{if(ae.contentWindow&&ae.contentWindow.document&&ae.contentWindow.document.documentElement){Ue.tree=Z0(le,ae.contentWindow.document.documentElement);var dt=ae.contentWindow.document.documentElement?th(le,getComputedStyle(ae.contentWindow.document.documentElement).backgroundColor):Wc.TRANSPARENT,Bt=ae.contentWindow.document.body?th(le,getComputedStyle(ae.contentWindow.document.body).backgroundColor):Wc.TRANSPARENT;Ue.backgroundColor=Yd(dt)?Yd(Bt)?Ue.styles.backgroundColor:Bt:dt}}catch{}return Ue}return Se(j,ne),j}(dl),T1=["OL","UL","MENU"],Yc=function(ne,j,le,ae){for(var Ue=j.firstChild,dt=void 0;Ue;Ue=dt)if(dt=Ue.nextSibling,J0(Ue)&&Ue.data.trim().length>0)le.textNodes.push(new fv(ne,Ue,le.styles));else if(Vp(Ue))if(np(Ue)&&Ue.assignedNodes)Ue.assignedNodes().forEach(function(ln){return Yc(ne,ln,le,ae)});else{var Bt=hh(ne,Ue);Bt.styles.isVisible()&&(fh(Ue,Bt,ae)?Bt.flags|=4:pf(Bt.styles)&&(Bt.flags|=2),-1!==T1.indexOf(Ue.tagName)&&(Bt.flags|=8),le.elements.push(Bt),Ue.shadowRoot?Yc(ne,Ue.shadowRoot,Bt,ae):!OA(Ue)&&!D1(Ue)&&!Lc(Ue)&&Yc(ne,Ue,Bt,ae))}},hh=function(ne,j){return Wg(j)?new w1(ne,j):Qg(j)?new C1(ne,j):D1(j)?new M1(ne,j):t_(j)?new S1(ne,j):n_(j)?new Hg(ne,j):i_(j)?new kA(ne,j):Lc(j)?new Vg(ne,j):OA(j)?new E1(ne,j):s_(j)?new pv(ne,j):new dl(ne,j)},Z0=function(ne,j){var le=hh(ne,j);return le.flags|=4,Yc(ne,j,le,le),le},fh=function(ne,j,le){return j.styles.isPositionedWithZIndex()||j.styles.opacity<1||j.styles.isTransformed()||qg(ne)&&le.styles.isTransparent()},pf=function(ne){return ne.isPositioned()||ne.isFloating()},J0=function(ne){return ne.nodeType===Node.TEXT_NODE},Vp=function(ne){return ne.nodeType===Node.ELEMENT_NODE},e_=function(ne){return Vp(ne)&&typeof ne.style<"u"&&!Gg(ne)},Gg=function(ne){return"object"==typeof ne.className},t_=function(ne){return"LI"===ne.tagName},n_=function(ne){return"OL"===ne.tagName},i_=function(ne){return"INPUT"===ne.tagName},D1=function(ne){return"svg"===ne.tagName},qg=function(ne){return"BODY"===ne.tagName},Qg=function(ne){return"CANVAS"===ne.tagName},r_=function(ne){return"VIDEO"===ne.tagName},Wg=function(ne){return"IMG"===ne.tagName},s_=function(ne){return"IFRAME"===ne.tagName},o_=function(ne){return"STYLE"===ne.tagName},OA=function(ne){return"TEXTAREA"===ne.tagName},Lc=function(ne){return"SELECT"===ne.tagName},np=function(ne){return"SLOT"===ne.tagName},gl=function(ne){return ne.tagName.indexOf("-")>0},Fl=function(){function ne(){this.counters={}}return ne.prototype.getCounterValue=function(j){var le=this.counters[j];return le&&le.length?le[le.length-1]:1},ne.prototype.getCounterValues=function(j){return this.counters[j]||[]},ne.prototype.pop=function(j){var le=this;j.forEach(function(ae){return le.counters[ae].pop()})},ne.prototype.parse=function(j){var le=this,ae=j.counterIncrement,Ue=j.counterReset,dt=!0;null!==ae&&ae.forEach(function(ln){var on=le.counters[ln.counter];on&&0!==ln.increment&&(dt=!1,on.length||on.push(1),on[Math.max(0,on.length-1)]+=ln.increment)});var Bt=[];return dt&&Ue.forEach(function(ln){var on=le.counters[ln.counter];Bt.push(ln.counter),on||(on=le.counters[ln.counter]=[]),on.push(ln.reset)}),Bt},ne}(),I1={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},Ih={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["\u0554","\u0553","\u0552","\u0551","\u0550","\u054f","\u054e","\u054d","\u054c","\u054b","\u054a","\u0549","\u0548","\u0547","\u0546","\u0545","\u0544","\u0543","\u0542","\u0541","\u0540","\u053f","\u053e","\u053d","\u053c","\u053b","\u053a","\u0539","\u0538","\u0537","\u0536","\u0535","\u0534","\u0533","\u0532","\u0531"]},mv={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["\u05d9\u05f3","\u05d8\u05f3","\u05d7\u05f3","\u05d6\u05f3","\u05d5\u05f3","\u05d4\u05f3","\u05d3\u05f3","\u05d2\u05f3","\u05d1\u05f3","\u05d0\u05f3","\u05ea","\u05e9","\u05e8","\u05e7","\u05e6","\u05e4","\u05e2","\u05e1","\u05e0","\u05de","\u05dc","\u05db","\u05d9\u05d8","\u05d9\u05d7","\u05d9\u05d6","\u05d8\u05d6","\u05d8\u05d5","\u05d9","\u05d8","\u05d7","\u05d6","\u05d5","\u05d4","\u05d3","\u05d2","\u05d1","\u05d0"]},B1={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["\u10f5","\u10f0","\u10ef","\u10f4","\u10ee","\u10ed","\u10ec","\u10eb","\u10ea","\u10e9","\u10e8","\u10e7","\u10e6","\u10e5","\u10e4","\u10f3","\u10e2","\u10e1","\u10e0","\u10df","\u10de","\u10dd","\u10f2","\u10dc","\u10db","\u10da","\u10d9","\u10d8","\u10d7","\u10f1","\u10d6","\u10d5","\u10d4","\u10d3","\u10d2","\u10d1","\u10d0"]},Gp=function(ne,j,le,ae,Ue,dt){return ne<j||ne>le?Um(ne,Ue,dt.length>0):ae.integers.reduce(function(Bt,ln,on){for(;ne>=ln;)ne-=ln,Bt+=ae.values[on];return Bt},"")+dt},Nm=function(ne,j,le,ae){var Ue="";do{le||ne--,Ue=ae(ne)+Ue,ne/=j}while(ne*j>=j);return Ue},Za=function(ne,j,le,ae,Ue){var dt=le-j+1;return(ne<0?"-":"")+(Nm(Math.abs(ne),dt,ae,function(Bt){return Re(Math.floor(Bt%dt)+j)})+Ue)},qp=function(ne,j,le){void 0===le&&(le=". ");var ae=j.length;return Nm(Math.abs(ne),ae,!1,function(Ue){return j[Math.floor(Ue%ae)]})+le},Bh=function(ne,j,le,ae,Ue,dt){if(ne<-9999||ne>9999)return Um(ne,4,Ue.length>0);var Bt=Math.abs(ne),ln=Ue;if(0===Bt)return j[0]+ln;for(var on=0;Bt>0&&on<=4;on++){var jn=Bt%10;0===jn&&Yo(dt,1)&&""!==ln?ln=j[jn]+ln:jn>1||1===jn&&0===on||1===jn&&1===on&&Yo(dt,2)||1===jn&&1===on&&Yo(dt,4)&&ne>100||1===jn&&on>1&&Yo(dt,8)?ln=j[jn]+(on>0?le[on-1]:"")+ln:1===jn&&on>0&&(ln=le[on-1]+ln),Bt=Math.floor(Bt/10)}return(ne<0?ae:"")+ln},rp="\ub9c8\uc774\ub108\uc2a4",Um=function(ne,j,le){var ae=le?". ":"",Ue=le?"\u3001":"",dt=le?", ":"",Bt=le?" ":"";switch(j){case 0:return"\u2022"+Bt;case 1:return"\u25e6"+Bt;case 2:return"\u25fe"+Bt;case 5:var ln=Za(ne,48,57,!0,ae);return ln.length<4?"0"+ln:ln;case 4:return qp(ne,"\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d",Ue);case 6:return Gp(ne,1,3999,I1,3,ae).toLowerCase();case 7:return Gp(ne,1,3999,I1,3,ae);case 8:return Za(ne,945,969,!1,ae);case 9:return Za(ne,97,122,!1,ae);case 10:return Za(ne,65,90,!1,ae);case 11:return Za(ne,1632,1641,!0,ae);case 12:case 49:return Gp(ne,1,9999,Ih,3,ae);case 35:return Gp(ne,1,9999,Ih,3,ae).toLowerCase();case 13:return Za(ne,2534,2543,!0,ae);case 14:case 30:return Za(ne,6112,6121,!0,ae);case 15:return qp(ne,"\u5b50\u4e11\u5bc5\u536f\u8fb0\u5df3\u5348\u672a\u7533\u9149\u620c\u4ea5",Ue);case 16:return qp(ne,"\u7532\u4e59\u4e19\u4e01\u620a\u5df1\u5e9a\u8f9b\u58ec\u7678",Ue);case 17:case 48:return Bh(ne,"\u96f6\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d","\u5341\u767e\u5343\u842c","\u8ca0",Ue,14);case 47:return Bh(ne,"\u96f6\u58f9\u8cb3\u53c3\u8086\u4f0d\u9678\u67d2\u634c\u7396","\u62fe\u4f70\u4edf\u842c","\u8ca0",Ue,15);case 42:return Bh(ne,"\u96f6\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d","\u5341\u767e\u5343\u842c","\u8d1f",Ue,14);case 41:return Bh(ne,"\u96f6\u58f9\u8d30\u53c1\u8086\u4f0d\u9646\u67d2\u634c\u7396","\u62fe\u4f70\u4edf\u842c","\u8d1f",Ue,15);case 26:return Bh(ne,"\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d","\u5341\u767e\u5343\u4e07","\u30de\u30a4\u30ca\u30b9",Ue,0);case 25:return Bh(ne,"\u96f6\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d","\u62fe\u767e\u5343\u4e07","\u30de\u30a4\u30ca\u30b9",Ue,7);case 31:return Bh(ne,"\uc601\uc77c\uc774\uc0bc\uc0ac\uc624\uc721\uce60\ud314\uad6c","\uc2ed\ubc31\ucc9c\ub9cc",rp,dt,7);case 33:return Bh(ne,"\u96f6\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d","\u5341\u767e\u5343\u842c",rp,dt,0);case 32:return Bh(ne,"\u96f6\u58f9\u8cb3\u53c3\u56db\u4e94\u516d\u4e03\u516b\u4e5d","\u62fe\u767e\u5343",rp,dt,7);case 18:return Za(ne,2406,2415,!0,ae);case 20:return Gp(ne,1,19999,B1,3,ae);case 21:return Za(ne,2790,2799,!0,ae);case 22:return Za(ne,2662,2671,!0,ae);case 22:return Gp(ne,1,10999,mv,3,ae);case 23:return qp(ne,"\u3042\u3044\u3046\u3048\u304a\u304b\u304d\u304f\u3051\u3053\u3055\u3057\u3059\u305b\u305d\u305f\u3061\u3064\u3066\u3068\u306a\u306b\u306c\u306d\u306e\u306f\u3072\u3075\u3078\u307b\u307e\u307f\u3080\u3081\u3082\u3084\u3086\u3088\u3089\u308a\u308b\u308c\u308d\u308f\u3090\u3091\u3092\u3093");case 24:return qp(ne,"\u3044\u308d\u306f\u306b\u307b\u3078\u3068\u3061\u308a\u306c\u308b\u3092\u308f\u304b\u3088\u305f\u308c\u305d\u3064\u306d\u306a\u3089\u3080\u3046\u3090\u306e\u304a\u304f\u3084\u307e\u3051\u3075\u3053\u3048\u3066\u3042\u3055\u304d\u3086\u3081\u307f\u3057\u3091\u3072\u3082\u305b\u3059");case 27:return Za(ne,3302,3311,!0,ae);case 28:return qp(ne,"\u30a2\u30a4\u30a6\u30a8\u30aa\u30ab\u30ad\u30af\u30b1\u30b3\u30b5\u30b7\u30b9\u30bb\u30bd\u30bf\u30c1\u30c4\u30c6\u30c8\u30ca\u30cb\u30cc\u30cd\u30ce\u30cf\u30d2\u30d5\u30d8\u30db\u30de\u30df\u30e0\u30e1\u30e2\u30e4\u30e6\u30e8\u30e9\u30ea\u30eb\u30ec\u30ed\u30ef\u30f0\u30f1\u30f2\u30f3",Ue);case 29:return qp(ne,"\u30a4\u30ed\u30cf\u30cb\u30db\u30d8\u30c8\u30c1\u30ea\u30cc\u30eb\u30f2\u30ef\u30ab\u30e8\u30bf\u30ec\u30bd\u30c4\u30cd\u30ca\u30e9\u30e0\u30a6\u30f0\u30ce\u30aa\u30af\u30e4\u30de\u30b1\u30d5\u30b3\u30a8\u30c6\u30a2\u30b5\u30ad\u30e6\u30e1\u30df\u30b7\u30f1\u30d2\u30e2\u30bb\u30b9",Ue);case 34:return Za(ne,3792,3801,!0,ae);case 37:return Za(ne,6160,6169,!0,ae);case 38:return Za(ne,4160,4169,!0,ae);case 39:return Za(ne,2918,2927,!0,ae);case 40:return Za(ne,1776,1785,!0,ae);case 43:return Za(ne,3046,3055,!0,ae);case 44:return Za(ne,3174,3183,!0,ae);case 45:return Za(ne,3664,3673,!0,ae);case 46:return Za(ne,3872,3881,!0,ae);default:return Za(ne,48,57,!0,ae)}},Af="data-html2canvas-ignore",jg=function(){function ne(j,le,ae){if(this.context=j,this.options=ae,this.scrolledElements=[],this.referenceElement=le,this.counters=new Fl,this.quoteDepth=0,!le.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(le.ownerDocument.documentElement,!1)}return ne.prototype.toIFrame=function(j,le){var ae=this,Ue=Xg(j,le);if(!Ue.contentWindow)return Promise.reject("Unable to find iframe window");var dt=j.defaultView.pageXOffset,Bt=j.defaultView.pageYOffset,ln=Ue.contentWindow,on=ln.document,jn=Yg(Ue).then(function(){return x(ae,void 0,void 0,function(){var Zn,ri;return L(this,function(Xi){switch(Xi.label){case 0:return this.scrolledElements.forEach(d_),ln&&(ln.scrollTo(le.left,le.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(ln.scrollY!==le.top||ln.scrollX!==le.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(ln.scrollX-le.left,ln.scrollY-le.top,0,0))),Zn=this.options.onclone,typeof(ri=this.clonedReferenceElement)>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:on.fonts&&on.fonts.ready?[4,on.fonts.ready]:[3,2];case 1:Xi.sent(),Xi.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,Lx(on)]:[3,4];case 3:Xi.sent(),Xi.label=4;case 4:return"function"==typeof Zn?[2,Promise.resolve().then(function(){return Zn(on,ri)}).then(function(){return Ue})]:[2,Ue]}})})});return on.open(),on.write(Kg(document.doctype)+"<html></html>"),c_(this.referenceElement.ownerDocument,dt,Bt),on.replaceChild(on.adoptNode(this.documentElement),on.documentElement),on.close(),jn},ne.prototype.createElementClone=function(j){if(Fc(j,2),Qg(j))return this.createCanvasClone(j);if(r_(j))return this.createVideoClone(j);if(o_(j))return this.createStyleClone(j);var le=j.cloneNode(!1);return Wg(le)&&(Wg(j)&&j.currentSrc&&j.currentSrc!==j.src&&(le.src=j.currentSrc,le.srcset=""),"lazy"===le.loading&&(le.loading="eager")),gl(le)?this.createCustomElementClone(le):le},ne.prototype.createCustomElementClone=function(j){var le=document.createElement("html2canvascustomelement");return R1(j.style,le),le},ne.prototype.createStyleClone=function(j){try{var le=j.sheet;if(le&&le.cssRules){var ae=[].slice.call(le.cssRules,0).reduce(function(dt,Bt){return Bt&&"string"==typeof Bt.cssText?dt+Bt.cssText:dt},""),Ue=j.cloneNode(!1);return Ue.textContent=ae,Ue}}catch(dt){if(this.context.logger.error("Unable to access cssRules property",dt),"SecurityError"!==dt.name)throw dt}return j.cloneNode(!1)},ne.prototype.createCanvasClone=function(j){var le;if(this.options.inlineImages&&j.ownerDocument){var ae=j.ownerDocument.createElement("img");try{return ae.src=j.toDataURL(),ae}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",j)}}var Ue=j.cloneNode(!1);try{Ue.width=j.width,Ue.height=j.height;var dt=j.getContext("2d"),Bt=Ue.getContext("2d");if(Bt)if(!this.options.allowTaint&&dt)Bt.putImageData(dt.getImageData(0,0,j.width,j.height),0,0);else{var ln=null!==(le=j.getContext("webgl2"))&&void 0!==le?le:j.getContext("webgl");if(ln){var on=ln.getContextAttributes();!1===on?.preserveDrawingBuffer&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",j)}Bt.drawImage(j,0,0)}return Ue}catch{this.context.logger.info("Unable to clone canvas as it is tainted",j)}return Ue},ne.prototype.createVideoClone=function(j){var le=j.ownerDocument.createElement("canvas");le.width=j.offsetWidth,le.height=j.offsetHeight;var ae=le.getContext("2d");try{return ae&&(ae.drawImage(j,0,0,le.width,le.height),this.options.allowTaint||ae.getImageData(0,0,le.width,le.height)),le}catch{this.context.logger.info("Unable to clone video as it is tainted",j)}var Ue=j.ownerDocument.createElement("canvas");return Ue.width=j.offsetWidth,Ue.height=j.offsetHeight,Ue},ne.prototype.appendChildNode=function(j,le,ae){(!Vp(le)||!function(ne){return"SCRIPT"===ne.tagName}(le)&&!le.hasAttribute(Af)&&("function"!=typeof this.options.ignoreElements||!this.options.ignoreElements(le)))&&(!this.options.copyStyles||!Vp(le)||!o_(le))&&j.appendChild(this.cloneNode(le,ae))},ne.prototype.cloneChildNodes=function(j,le,ae){for(var Ue=this,dt=j.shadowRoot?j.shadowRoot.firstChild:j.firstChild;dt;dt=dt.nextSibling)if(Vp(dt)&&np(dt)&&"function"==typeof dt.assignedNodes){var Bt=dt.assignedNodes();Bt.length&&Bt.forEach(function(ln){return Ue.appendChildNode(le,ln,ae)})}else this.appendChildNode(le,dt,ae)},ne.prototype.cloneNode=function(j,le){if(J0(j))return document.createTextNode(j.data);if(!j.ownerDocument)return j.cloneNode(!1);var ae=j.ownerDocument.defaultView;if(ae&&Vp(j)&&(e_(j)||Gg(j))){var Ue=this.createElementClone(j);Ue.style.transitionProperty="none";var dt=ae.getComputedStyle(j),Bt=ae.getComputedStyle(j,":before"),ln=ae.getComputedStyle(j,":after");this.referenceElement===j&&e_(Ue)&&(this.clonedReferenceElement=Ue),qg(Ue)&&UC(Ue);var on=this.counters.parse(new kc(this.context,dt)),jn=this.resolvePseudoContent(j,Ue,Bt,$g.BEFORE);gl(j)&&(le=!0),r_(j)||this.cloneChildNodes(j,Ue,le),jn&&Ue.insertBefore(jn,Ue.firstChild);var Zn=this.resolvePseudoContent(j,Ue,ln,$g.AFTER);return Zn&&Ue.appendChild(Zn),this.counters.pop(on),(dt&&(this.options.copyStyles||Gg(j))&&!s_(j)||le)&&R1(dt,Ue),(0!==j.scrollTop||0!==j.scrollLeft)&&this.scrolledElements.push([Ue,j.scrollLeft,j.scrollTop]),(OA(j)||Lc(j))&&(OA(Ue)||Lc(Ue))&&(Ue.value=j.value),Ue}return j.cloneNode(!1)},ne.prototype.resolvePseudoContent=function(j,le,ae,Ue){var dt=this;if(ae){var Bt=ae.content,ln=le.ownerDocument;if(ln&&Bt&&"none"!==Bt&&"-moz-alt-content"!==Bt&&"none"!==ae.display){this.counters.parse(new kc(this.context,ae));var on=new oh(this.context,ae),jn=ln.createElement("html2canvaspseudoelement");R1(ae,jn),on.content.forEach(function(ri){if(0===ri.type)jn.appendChild(ln.createTextNode(ri.value));else if(22===ri.type){var Xi=ln.createElement("img");Xi.src=ri.value,Xi.style.opacity="1",jn.appendChild(Xi)}else if(18===ri.type){if("attr"===ri.name){var Ss=ri.values.filter(pi);Ss.length&&jn.appendChild(ln.createTextNode(j.getAttribute(Ss[0].value)||""))}else if("counter"===ri.name){var zr=ri.values.filter(Xd),Ho=zr[1];if((Hr=zr[0])&&pi(Hr)){var Ns=dt.counters.getCounterValue(Hr.value),Jr=Ho&&pi(Ho)?bA.parse(dt.context,Ho.value):3;jn.appendChild(ln.createTextNode(Um(Ns,Jr,!1)))}}else if("counters"===ri.name){var Hr,So=ri.values.filter(Xd),Xo=So[1];if(Ho=So[2],(Hr=So[0])&&pi(Hr)){var Fo=dt.counters.getCounterValues(Hr.value),Es=Ho&&pi(Ho)?bA.parse(dt.context,Ho.value):3,La=Xo&&0===Xo.type?Xo.value:"",Ba=Fo.map(function(tu){return Um(tu,Es,!1)}).join(La);jn.appendChild(ln.createTextNode(Ba))}}}else if(20===ri.type)switch(ri.value){case"open-quote":jn.appendChild(ln.createTextNode(ac(on.quotes,dt.quoteDepth++,!0)));break;case"close-quote":jn.appendChild(ln.createTextNode(ac(on.quotes,--dt.quoteDepth,!1)));break;default:jn.appendChild(ln.createTextNode(ri.value))}}),jn.className=u_+" "+Zg;var Zn=Ue===$g.BEFORE?" "+u_:" "+Zg;return Gg(le)?le.className.baseValue+=Zn:le.className+=Zn,jn}}},ne.destroy=function(j){return!!j.parentNode&&(j.parentNode.removeChild(j),!0)},ne}(),$g=function(ne){return ne[ne.BEFORE=0]="BEFORE",ne[ne.AFTER=1]="AFTER",ne}($g||{}),Xg=function(ne,j){var le=ne.createElement("iframe");return le.className="html2canvas-container",le.style.visibility="hidden",le.style.position="fixed",le.style.left="-10000px",le.style.top="0px",le.style.border="0",le.width=j.width.toString(),le.height=j.height.toString(),le.scrolling="no",le.setAttribute(Af,"true"),ne.body.appendChild(le),le},Av=function(ne){return new Promise(function(j){ne.complete?j():ne.src?(ne.onload=j,ne.onerror=j):j()})},Lx=function(ne){return Promise.all([].slice.call(ne.images,0).map(Av))},Yg=function(ne){return new Promise(function(j,le){var ae=ne.contentWindow;if(!ae)return le("No window assigned for iframe");var Ue=ae.document;ae.onload=ne.onload=function(){ae.onload=ne.onload=null;var dt=setInterval(function(){Ue.body.childNodes.length>0&&"complete"===Ue.readyState&&(clearInterval(dt),j(ne))},50)}})},LA=["all","d","content"],R1=function(ne,j){for(var le=ne.length-1;le>=0;le--){var ae=ne.item(le);-1===LA.indexOf(ae)&&j.style.setProperty(ae,ne.getPropertyValue(ae))}return j},Kg=function(ne){var j="";return ne&&(j+="<!DOCTYPE ",ne.name&&(j+=ne.name),ne.internalSubset&&(j+=ne.internalSubset),ne.publicId&&(j+='"'+ne.publicId+'"'),ne.systemId&&(j+='"'+ne.systemId+'"'),j+=">"),j},c_=function(ne,j,le){ne&&ne.defaultView&&(j!==ne.defaultView.pageXOffset||le!==ne.defaultView.pageYOffset)&&ne.defaultView.scrollTo(j,le)},d_=function(ne){var j=ne[0],ae=ne[2];j.scrollLeft=ne[1],j.scrollTop=ae},u_="___html2canvas___pseudoelement_before",Zg="___html2canvas___pseudoelement_after",Ph='{\n    content: "" !important;\n    display: none !important;\n}',UC=function(ne){zm(ne,"."+u_+":before"+Ph+"\n         ."+Zg+":after"+Ph)},zm=function(ne,j){var le=ne.ownerDocument;if(le){var ae=le.createElement("style");ae.textContent=j,ne.appendChild(ae)}},Rh=function(){function ne(){}return ne.getOrigin=function(j){var le=ne._link;return le?(le.href=j,le.href=le.href,le.protocol+le.hostname+le.port):"about:blank"},ne.isSameOrigin=function(j){return ne.getOrigin(j)===ne._origin},ne.setContext=function(j){ne._link=j.document.createElement("a"),ne._origin=ne.getOrigin(j.location.href)},ne._origin="about:blank",ne}(),_v=function(){function ne(j,le){this.context=j,this._options=le,this._cache={}}return ne.prototype.addImage=function(j){var le=Promise.resolve();return this.has(j)||(p_(j)||Nx(j))&&(this._cache[j]=this.loadImage(j)).catch(function(){}),le},ne.prototype.match=function(j){return this._cache[j]},ne.prototype.loadImage=function(j){return x(this,void 0,void 0,function(){var le,ae,Ue,dt,Bt=this;return L(this,function(ln){switch(ln.label){case 0:return le=Rh.isSameOrigin(j),ae=!f_(j)&&!0===this._options.useCORS&&Oc.SUPPORT_CORS_IMAGES&&!le,Ue=!f_(j)&&!le&&!p_(j)&&"string"==typeof this._options.proxy&&Oc.SUPPORT_CORS_XHR&&!ae,le||!1!==this._options.allowTaint||f_(j)||p_(j)||Ue||ae?(dt=j,Ue?[4,this.proxy(dt)]:[3,2]):[2];case 1:dt=ln.sent(),ln.label=2;case 2:return this.context.logger.debug("Added image "+j.substring(0,256)),[4,new Promise(function(on,jn){var Zn=new Image;Zn.onload=function(){return on(Zn)},Zn.onerror=jn,(Jg(dt)||ae)&&(Zn.crossOrigin="anonymous"),Zn.src=dt,!0===Zn.complete&&setTimeout(function(){return on(Zn)},500),Bt._options.imageTimeout>0&&setTimeout(function(){return jn("Timed out ("+Bt._options.imageTimeout+"ms) loading image")},Bt._options.imageTimeout)})];case 3:return[2,ln.sent()]}})})},ne.prototype.has=function(j){return typeof this._cache[j]<"u"},ne.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},ne.prototype.proxy=function(j){var le=this,ae=this._options.proxy;if(!ae)throw new Error("No proxy defined");var Ue=j.substring(0,256);return new Promise(function(dt,Bt){var ln=Oc.SUPPORT_RESPONSE_TYPE?"blob":"text",on=new XMLHttpRequest;on.onload=function(){if(200===on.status)if("text"===ln)dt(on.response);else{var ri=new FileReader;ri.addEventListener("load",function(){return dt(ri.result)},!1),ri.addEventListener("error",function(Xi){return Bt(Xi)},!1),ri.readAsDataURL(on.response)}else Bt("Failed to proxy resource "+Ue+" with status code "+on.status)},on.onerror=Bt;var jn=ae.indexOf("?")>-1?"&":"?";if(on.open("GET",""+ae+jn+"url="+encodeURIComponent(j)+"&responseType="+ln),"text"!==ln&&on instanceof XMLHttpRequest&&(on.responseType=ln),le._options.imageTimeout){var Zn=le._options.imageTimeout;on.timeout=Zn,on.ontimeout=function(){return Bt("Timed out ("+Zn+"ms) proxying "+Ue)}}on.send()})},ne}(),h_=/^data:image\/svg\+xml/i,k1=/^data:image\/.*;base64,/i,yv=/^data:image\/.*/i,Nx=function(ne){return Oc.SUPPORT_SVG_DRAWING||!Ux(ne)},f_=function(ne){return yv.test(ne)},Jg=function(ne){return k1.test(ne)},p_=function(ne){return"blob"===ne.substr(0,4)},Ux=function(ne){return"svg"===ne.substr(-3).toLowerCase()||h_.test(ne)},vs=function(){function ne(j,le){this.type=0,this.x=j,this.y=le}return ne.prototype.add=function(j,le){return new ne(this.x+j,this.y+le)},ne}(),Gu=function(ne,j,le){return new vs(ne.x+(j.x-ne.x)*le,ne.y+(j.y-ne.y)*le)},F1=function(){function ne(j,le,ae,Ue){this.type=1,this.start=j,this.startControl=le,this.endControl=ae,this.end=Ue}return ne.prototype.subdivide=function(j,le){var ae=Gu(this.start,this.startControl,j),Ue=Gu(this.startControl,this.endControl,j),dt=Gu(this.endControl,this.end,j),Bt=Gu(ae,Ue,j),ln=Gu(Ue,dt,j),on=Gu(Bt,ln,j);return le?new ne(this.start,ae,Bt,on):new ne(on,ln,dt,this.end)},ne.prototype.add=function(j,le){return new ne(this.start.add(j,le),this.startControl.add(j,le),this.endControl.add(j,le),this.end.add(j,le))},ne.prototype.reverse=function(){return new ne(this.end,this.endControl,this.startControl,this.start)},ne}(),Nc=function(ne){return 1===ne.type},O1=function(){return function ne(j){var le=j.styles,ae=j.bounds,Ue=wm(le.borderTopLeftRadius,ae.width,ae.height),dt=Ue[0],Bt=Ue[1],ln=wm(le.borderTopRightRadius,ae.width,ae.height),on=ln[0],jn=ln[1],Zn=wm(le.borderBottomRightRadius,ae.width,ae.height),ri=Zn[0],Xi=Zn[1],Ss=wm(le.borderBottomLeftRadius,ae.width,ae.height),zr=Ss[0],Hr=Ss[1],Ho=[];Ho.push((dt+on)/ae.width),Ho.push((zr+ri)/ae.width),Ho.push((Bt+Hr)/ae.height),Ho.push((jn+Xi)/ae.height);var Ns=Math.max.apply(Math,Ho);Ns>1&&(dt/=Ns,Bt/=Ns,on/=Ns,jn/=Ns,ri/=Ns,Xi/=Ns,zr/=Ns,Hr/=Ns);var Jr=ae.width-on,So=ae.height-Xi,Xo=ae.width-ri,Fo=ae.height-Hr,Es=le.borderTopWidth,La=le.borderRightWidth,Ba=le.borderBottomWidth,Vo=le.borderLeftWidth,wc=ha(le.paddingTop,j.bounds.width),tu=ha(le.paddingRight,j.bounds.width),wu=ha(le.paddingBottom,j.bounds.width),ul=ha(le.paddingLeft,j.bounds.width);this.topLeftBorderDoubleOuterBox=dt>0||Bt>0?Oa(ae.left+Vo/3,ae.top+Es/3,dt-Vo/3,Bt-Es/3,Po.TOP_LEFT):new vs(ae.left+Vo/3,ae.top+Es/3),this.topRightBorderDoubleOuterBox=dt>0||Bt>0?Oa(ae.left+Jr,ae.top+Es/3,on-La/3,jn-Es/3,Po.TOP_RIGHT):new vs(ae.left+ae.width-La/3,ae.top+Es/3),this.bottomRightBorderDoubleOuterBox=ri>0||Xi>0?Oa(ae.left+Xo,ae.top+So,ri-La/3,Xi-Ba/3,Po.BOTTOM_RIGHT):new vs(ae.left+ae.width-La/3,ae.top+ae.height-Ba/3),this.bottomLeftBorderDoubleOuterBox=zr>0||Hr>0?Oa(ae.left+Vo/3,ae.top+Fo,zr-Vo/3,Hr-Ba/3,Po.BOTTOM_LEFT):new vs(ae.left+Vo/3,ae.top+ae.height-Ba/3),this.topLeftBorderDoubleInnerBox=dt>0||Bt>0?Oa(ae.left+2*Vo/3,ae.top+2*Es/3,dt-2*Vo/3,Bt-2*Es/3,Po.TOP_LEFT):new vs(ae.left+2*Vo/3,ae.top+2*Es/3),this.topRightBorderDoubleInnerBox=dt>0||Bt>0?Oa(ae.left+Jr,ae.top+2*Es/3,on-2*La/3,jn-2*Es/3,Po.TOP_RIGHT):new vs(ae.left+ae.width-2*La/3,ae.top+2*Es/3),this.bottomRightBorderDoubleInnerBox=ri>0||Xi>0?Oa(ae.left+Xo,ae.top+So,ri-2*La/3,Xi-2*Ba/3,Po.BOTTOM_RIGHT):new vs(ae.left+ae.width-2*La/3,ae.top+ae.height-2*Ba/3),this.bottomLeftBorderDoubleInnerBox=zr>0||Hr>0?Oa(ae.left+2*Vo/3,ae.top+Fo,zr-2*Vo/3,Hr-2*Ba/3,Po.BOTTOM_LEFT):new vs(ae.left+2*Vo/3,ae.top+ae.height-2*Ba/3),this.topLeftBorderStroke=dt>0||Bt>0?Oa(ae.left+Vo/2,ae.top+Es/2,dt-Vo/2,Bt-Es/2,Po.TOP_LEFT):new vs(ae.left+Vo/2,ae.top+Es/2),this.topRightBorderStroke=dt>0||Bt>0?Oa(ae.left+Jr,ae.top+Es/2,on-La/2,jn-Es/2,Po.TOP_RIGHT):new vs(ae.left+ae.width-La/2,ae.top+Es/2),this.bottomRightBorderStroke=ri>0||Xi>0?Oa(ae.left+Xo,ae.top+So,ri-La/2,Xi-Ba/2,Po.BOTTOM_RIGHT):new vs(ae.left+ae.width-La/2,ae.top+ae.height-Ba/2),this.bottomLeftBorderStroke=zr>0||Hr>0?Oa(ae.left+Vo/2,ae.top+Fo,zr-Vo/2,Hr-Ba/2,Po.BOTTOM_LEFT):new vs(ae.left+Vo/2,ae.top+ae.height-Ba/2),this.topLeftBorderBox=dt>0||Bt>0?Oa(ae.left,ae.top,dt,Bt,Po.TOP_LEFT):new vs(ae.left,ae.top),this.topRightBorderBox=on>0||jn>0?Oa(ae.left+Jr,ae.top,on,jn,Po.TOP_RIGHT):new vs(ae.left+ae.width,ae.top),this.bottomRightBorderBox=ri>0||Xi>0?Oa(ae.left+Xo,ae.top+So,ri,Xi,Po.BOTTOM_RIGHT):new vs(ae.left+ae.width,ae.top+ae.height),this.bottomLeftBorderBox=zr>0||Hr>0?Oa(ae.left,ae.top+Fo,zr,Hr,Po.BOTTOM_LEFT):new vs(ae.left,ae.top+ae.height),this.topLeftPaddingBox=dt>0||Bt>0?Oa(ae.left+Vo,ae.top+Es,Math.max(0,dt-Vo),Math.max(0,Bt-Es),Po.TOP_LEFT):new vs(ae.left+Vo,ae.top+Es),this.topRightPaddingBox=on>0||jn>0?Oa(ae.left+Math.min(Jr,ae.width-La),ae.top+Es,Jr>ae.width+La?0:Math.max(0,on-La),Math.max(0,jn-Es),Po.TOP_RIGHT):new vs(ae.left+ae.width-La,ae.top+Es),this.bottomRightPaddingBox=ri>0||Xi>0?Oa(ae.left+Math.min(Xo,ae.width-Vo),ae.top+Math.min(So,ae.height-Ba),Math.max(0,ri-La),Math.max(0,Xi-Ba),Po.BOTTOM_RIGHT):new vs(ae.left+ae.width-La,ae.top+ae.height-Ba),this.bottomLeftPaddingBox=zr>0||Hr>0?Oa(ae.left+Vo,ae.top+Math.min(Fo,ae.height-Ba),Math.max(0,zr-Vo),Math.max(0,Hr-Ba),Po.BOTTOM_LEFT):new vs(ae.left+Vo,ae.top+ae.height-Ba),this.topLeftContentBox=dt>0||Bt>0?Oa(ae.left+Vo+ul,ae.top+Es+wc,Math.max(0,dt-(Vo+ul)),Math.max(0,Bt-(Es+wc)),Po.TOP_LEFT):new vs(ae.left+Vo+ul,ae.top+Es+wc),this.topRightContentBox=on>0||jn>0?Oa(ae.left+Math.min(Jr,ae.width+Vo+ul),ae.top+Es+wc,Jr>ae.width+Vo+ul?0:on-Vo+ul,jn-(Es+wc),Po.TOP_RIGHT):new vs(ae.left+ae.width-(La+tu),ae.top+Es+wc),this.bottomRightContentBox=ri>0||Xi>0?Oa(ae.left+Math.min(Xo,ae.width-(Vo+ul)),ae.top+Math.min(So,ae.height+Es+wc),Math.max(0,ri-(La+tu)),Xi-(Ba+wu),Po.BOTTOM_RIGHT):new vs(ae.left+ae.width-(La+tu),ae.top+ae.height-(Ba+wu)),this.bottomLeftContentBox=zr>0||Hr>0?Oa(ae.left+Vo+ul,ae.top+Fo,Math.max(0,zr-(Vo+ul)),Hr-(Ba+wu),Po.BOTTOM_LEFT):new vs(ae.left+Vo+ul,ae.top+ae.height-(Ba+wu))}}(),Po=function(ne){return ne[ne.TOP_LEFT=0]="TOP_LEFT",ne[ne.TOP_RIGHT=1]="TOP_RIGHT",ne[ne.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",ne[ne.BOTTOM_LEFT=3]="BOTTOM_LEFT",ne}(Po||{}),Oa=function(ne,j,le,ae,Ue){var dt=(Math.sqrt(2)-1)/3*4,Bt=le*dt,ln=ae*dt,on=ne+le,jn=j+ae;switch(Ue){case Po.TOP_LEFT:return new F1(new vs(ne,jn),new vs(ne,jn-ln),new vs(on-Bt,j),new vs(on,j));case Po.TOP_RIGHT:return new F1(new vs(ne,j),new vs(ne+Bt,j),new vs(on,jn-ln),new vs(on,jn));case Po.BOTTOM_RIGHT:return new F1(new vs(on,j),new vs(on,j+ln),new vs(ne+Bt,jn),new vs(ne,jn));default:return new F1(new vs(on,jn),new vs(on-Bt,jn),new vs(ne,j+ln),new vs(ne,j))}},cc=function(ne){return[ne.topLeftBorderBox,ne.topRightBorderBox,ne.bottomRightBorderBox,ne.bottomLeftBorderBox]},Ca=function(ne){return[ne.topLeftPaddingBox,ne.topRightPaddingBox,ne.bottomRightPaddingBox,ne.bottomLeftPaddingBox]},Wp=function(){return function ne(j,le,ae){this.offsetX=j,this.offsetY=le,this.matrix=ae,this.type=0,this.target=6}}(),gd=function(){return function ne(j,le){this.path=j,this.target=le,this.type=1}}(),NA=function(){return function ne(j){this.opacity=j,this.type=2,this.target=6}}(),vv=function(ne){return 1===ne.type},e0=function(ne,j){return ne.length===j.length&&ne.some(function(le,ae){return le===j[ae]})},ds=function(){return function ne(j){this.element=j,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}}(),Ah=function(){function ne(j,le){if(this.container=j,this.parent=le,this.effects=[],this.curves=new O1(this.container),this.container.styles.opacity<1&&this.effects.push(new NA(this.container.styles.opacity)),null!==this.container.styles.transform&&this.effects.push(new Wp(this.container.bounds.left+this.container.styles.transformOrigin[0].number,this.container.bounds.top+this.container.styles.transformOrigin[1].number,this.container.styles.transform)),0!==this.container.styles.overflowX){var Bt=cc(this.curves),ln=Ca(this.curves);e0(Bt,ln)?this.effects.push(new gd(Bt,6)):(this.effects.push(new gd(Bt,2)),this.effects.push(new gd(ln,4)))}}return ne.prototype.getEffects=function(j){for(var le=-1===[2,3].indexOf(this.container.styles.position),ae=this.parent,Ue=this.effects.slice(0);ae;){var dt=ae.effects.filter(function(on){return!vv(on)});if(le||0!==ae.container.styles.position||!ae.parent){if(Ue.unshift.apply(Ue,dt),le=-1===[2,3].indexOf(ae.container.styles.position),0!==ae.container.styles.overflowX){var Bt=cc(ae.curves),ln=Ca(ae.curves);e0(Bt,ln)||Ue.unshift(new gd(ln,6))}}else Ue.unshift.apply(Ue,dt);ae=ae.parent}return Ue.filter(function(on){return Yo(on.target,j)})},ne}(),Hm=function(ne,j,le,ae){ne.container.elements.forEach(function(Ue){var dt=Yo(Ue.flags,4),Bt=Yo(Ue.flags,2),ln=new Ah(Ue,ne);Yo(Ue.styles.display,2048)&&ae.push(ln);var on=Yo(Ue.flags,8)?[]:ae;if(dt||Bt){var jn=dt||Ue.styles.isPositioned()?le:j,Zn=new ds(ln);if(Ue.styles.isPositioned()||Ue.styles.opacity<1||Ue.styles.isTransformed()){var ri=Ue.styles.zIndex.order;if(ri<0){var Xi=0;jn.negativeZIndex.some(function(zr,Hr){return ri>zr.element.container.styles.zIndex.order?(Xi=Hr,!1):Xi>0}),jn.negativeZIndex.splice(Xi,0,Zn)}else if(ri>0){var Ss=0;jn.positiveZIndex.some(function(zr,Hr){return ri>=zr.element.container.styles.zIndex.order?(Ss=Hr+1,!1):Ss>0}),jn.positiveZIndex.splice(Ss,0,Zn)}else jn.zeroOrAutoZIndexOrTransformedOrOpacity.push(Zn)}else Ue.styles.isFloating()?jn.nonPositionedFloats.push(Zn):jn.nonPositionedInlineLevel.push(Zn);Hm(ln,Zn,dt?Zn:le,on)}else Ue.styles.isInlineLevel()?j.inlineLevel.push(ln):j.nonInlineLevel.push(ln),Hm(ln,j,le,on);Yo(Ue.flags,8)&&N1(Ue,on)})},N1=function(ne,j){for(var le=ne instanceof Hg?ne.start:1,ae=ne instanceof Hg&&ne.reversed,Ue=0;Ue<j.length;Ue++){var dt=j[Ue];dt.container instanceof S1&&"number"==typeof dt.container.value&&0!==dt.container.value&&(le=dt.container.value),dt.listValue=Um(le,dt.container.styles.listStyleType,!0),le+=ae?-1:1}},z1=function(ne,j){switch(j){case 0:return Zl(ne.topLeftBorderBox,ne.topLeftPaddingBox,ne.topRightBorderBox,ne.topRightPaddingBox);case 1:return Zl(ne.topRightBorderBox,ne.topRightPaddingBox,ne.bottomRightBorderBox,ne.bottomRightPaddingBox);case 2:return Zl(ne.bottomRightBorderBox,ne.bottomRightPaddingBox,ne.bottomLeftBorderBox,ne.bottomLeftPaddingBox);default:return Zl(ne.bottomLeftBorderBox,ne.bottomLeftPaddingBox,ne.topLeftBorderBox,ne.topLeftPaddingBox)}},Vl=function(ne,j){var le=[];return Nc(ne)?le.push(ne.subdivide(.5,!1)):le.push(ne),Nc(j)?le.push(j.subdivide(.5,!0)):le.push(j),le},Zl=function(ne,j,le,ae){var Ue=[];return Nc(ne)?Ue.push(ne.subdivide(.5,!1)):Ue.push(ne),Nc(le)?Ue.push(le.subdivide(.5,!0)):Ue.push(le),Nc(ae)?Ue.push(ae.subdivide(.5,!0).reverse()):Ue.push(ae),Nc(j)?Ue.push(j.subdivide(.5,!1).reverse()):Ue.push(j),Ue},gf=function(ne){var le=ne.styles;return ne.bounds.add(le.borderLeftWidth,le.borderTopWidth,-(le.borderRightWidth+le.borderLeftWidth),-(le.borderTopWidth+le.borderBottomWidth))},Al=function(ne){var j=ne.styles,le=ne.bounds,ae=ha(j.paddingLeft,le.width),Ue=ha(j.paddingRight,le.width),dt=ha(j.paddingTop,le.width),Bt=ha(j.paddingBottom,le.width);return le.add(ae+j.borderLeftWidth,dt+j.borderTopWidth,-(j.borderRightWidth+j.borderLeftWidth+ae+Ue),-(j.borderTopWidth+j.borderBottomWidth+dt+Bt))},op=function(ne,j,le){var ae=function(ne,j){return 0===ne?j.bounds:2===ne?Al(j):gf(j)}(Uc(ne.styles.backgroundOrigin,j),ne),Ue=function(ne,j){return 0===ne?j.bounds:2===ne?Al(j):gf(j)}(Uc(ne.styles.backgroundClip,j),ne),dt=t0(Uc(ne.styles.backgroundSize,j),le,ae),Bt=dt[0],ln=dt[1],on=wm(Uc(ne.styles.backgroundPosition,j),ae.width-Bt,ae.height-ln);return[m_(Uc(ne.styles.backgroundRepeat,j),on,dt,ae,Ue),Math.round(ae.left+on[0]),Math.round(ae.top+on[1]),Bt,ln]},kd=function(ne){return pi(ne)&&ne.value===Wo.AUTO},xl=function(ne){return"number"==typeof ne},t0=function(ne,j,le){var ae=j[0],Ue=j[1],dt=j[2],Bt=ne[0],ln=ne[1];if(!Bt)return[0,0];if(cl(Bt)&&ln&&cl(ln))return[ha(Bt,le.width),ha(ln,le.height)];var on=xl(dt);if(pi(Bt)&&(Bt.value===Wo.CONTAIN||Bt.value===Wo.COVER))return xl(dt)?le.width/le.height<dt!=(Bt.value===Wo.COVER)?[le.width,le.width/dt]:[le.height*dt,le.height]:[le.width,le.height];var Zn=xl(ae),ri=xl(Ue),Xi=Zn||ri;if(kd(Bt)&&(!ln||kd(ln)))return Zn&&ri?[ae,Ue]:on||Xi?Xi&&on?[Zn?ae:Ue*dt,ri?Ue:ae/dt]:[Zn?ae:le.width,ri?Ue:le.height]:[le.width,le.height];if(on){var Ns=0,Jr=0;return cl(Bt)?Ns=ha(Bt,le.width):cl(ln)&&(Jr=ha(ln,le.height)),kd(Bt)?Ns=Jr*dt:(!ln||kd(ln))&&(Jr=Ns/dt),[Ns,Jr]}var So=null,Xo=null;if(cl(Bt)?So=ha(Bt,le.width):ln&&cl(ln)&&(Xo=ha(ln,le.height)),null!==So&&(!ln||kd(ln))&&(Xo=Zn&&ri?So/ae*Ue:le.height),null!==Xo&&kd(Bt)&&(So=Zn&&ri?Xo/Ue*ae:le.width),null!==So&&null!==Xo)return[So,Xo];throw new Error("Unable to calculate background-size for element")},Uc=function(ne,j){var le=ne[j];return typeof le>"u"?ne[0]:le},m_=function(ne,j,le,ae,Ue){var dt=j[0],Bt=j[1],ln=le[0],on=le[1];switch(ne){case 2:return[new vs(Math.round(ae.left),Math.round(ae.top+Bt)),new vs(Math.round(ae.left+ae.width),Math.round(ae.top+Bt)),new vs(Math.round(ae.left+ae.width),Math.round(on+ae.top+Bt)),new vs(Math.round(ae.left),Math.round(on+ae.top+Bt))];case 3:return[new vs(Math.round(ae.left+dt),Math.round(ae.top)),new vs(Math.round(ae.left+dt+ln),Math.round(ae.top)),new vs(Math.round(ae.left+dt+ln),Math.round(ae.height+ae.top)),new vs(Math.round(ae.left+dt),Math.round(ae.height+ae.top))];case 1:return[new vs(Math.round(ae.left+dt),Math.round(ae.top+Bt)),new vs(Math.round(ae.left+dt+ln),Math.round(ae.top+Bt)),new vs(Math.round(ae.left+dt+ln),Math.round(ae.top+Bt+on)),new vs(Math.round(ae.left+dt),Math.round(ae.top+Bt+on))];default:return[new vs(Math.round(Ue.left),Math.round(Ue.top)),new vs(Math.round(Ue.left+Ue.width),Math.round(Ue.top)),new vs(Math.round(Ue.left+Ue.width),Math.round(Ue.height+Ue.top)),new vs(Math.round(Ue.left),Math.round(Ue.height+Ue.top))]}},Vm="Hidden Text",H1=function(){function ne(j){this._data={},this._document=j}return ne.prototype.parseMetrics=function(j,le){var ae=this._document.createElement("div"),Ue=this._document.createElement("img"),dt=this._document.createElement("span"),Bt=this._document.body;ae.style.visibility="hidden",ae.style.fontFamily=j,ae.style.fontSize=le,ae.style.margin="0",ae.style.padding="0",ae.style.whiteSpace="nowrap",Bt.appendChild(ae),Ue.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",Ue.width=1,Ue.height=1,Ue.style.margin="0",Ue.style.padding="0",Ue.style.verticalAlign="baseline",dt.style.fontFamily=j,dt.style.fontSize=le,dt.style.margin="0",dt.style.padding="0",dt.appendChild(this._document.createTextNode(Vm)),ae.appendChild(dt),ae.appendChild(Ue);var ln=Ue.offsetTop-dt.offsetTop+2;ae.removeChild(dt),ae.appendChild(this._document.createTextNode(Vm)),ae.style.lineHeight="normal",Ue.style.verticalAlign="super";var on=Ue.offsetTop-ae.offsetTop+2;return Bt.removeChild(ae),{baseline:ln,middle:on}},ne.prototype.getMetrics=function(j,le){var ae=j+" "+le;return typeof this._data[ae]>"u"&&(this._data[ae]=this.parseMetrics(j,le)),this._data[ae]},ne}(),n0=function(){return function ne(j,le){this.context=j,this.options=le}}(),VA=function(ne){function j(le,ae){var Ue=ne.call(this,le,ae)||this;return Ue._activeEffects=[],Ue.canvas=ae.canvas?ae.canvas:document.createElement("canvas"),Ue.ctx=Ue.canvas.getContext("2d"),ae.canvas||(Ue.canvas.width=Math.floor(ae.width*ae.scale),Ue.canvas.height=Math.floor(ae.height*ae.scale),Ue.canvas.style.width=ae.width+"px",Ue.canvas.style.height=ae.height+"px"),Ue.fontMetrics=new H1(document),Ue.ctx.scale(Ue.options.scale,Ue.options.scale),Ue.ctx.translate(-ae.x,-ae.y),Ue.ctx.textBaseline="bottom",Ue._activeEffects=[],Ue.context.logger.debug("Canvas renderer initialized ("+ae.width+"x"+ae.height+") with scale "+ae.scale),Ue}return Se(j,ne),j.prototype.applyEffects=function(le){for(var ae=this;this._activeEffects.length;)this.popEffect();le.forEach(function(Ue){return ae.applyEffect(Ue)})},j.prototype.applyEffect=function(le){this.ctx.save(),function(ne){return 2===ne.type}(le)&&(this.ctx.globalAlpha=le.opacity),function(ne){return 0===ne.type}(le)&&(this.ctx.translate(le.offsetX,le.offsetY),this.ctx.transform(le.matrix[0],le.matrix[1],le.matrix[2],le.matrix[3],le.matrix[4],le.matrix[5]),this.ctx.translate(-le.offsetX,-le.offsetY)),vv(le)&&(this.path(le.path),this.ctx.clip()),this._activeEffects.push(le)},j.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},j.prototype.renderStack=function(le){return x(this,void 0,void 0,function(){return L(this,function(Ue){switch(Ue.label){case 0:return le.element.container.styles.isVisible()?[4,this.renderStackContent(le)]:[3,2];case 1:Ue.sent(),Ue.label=2;case 2:return[2]}})})},j.prototype.renderNode=function(le){return x(this,void 0,void 0,function(){return L(this,function(ae){switch(ae.label){case 0:return Yo(le.container.flags,16),le.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(le)]:[3,3];case 1:return ae.sent(),[4,this.renderNodeContent(le)];case 2:ae.sent(),ae.label=3;case 3:return[2]}})})},j.prototype.renderTextWithLetterSpacing=function(le,ae,Ue){var dt=this;0===ae?this.ctx.fillText(le.text,le.bounds.left,le.bounds.top+Ue):Dh(le.text).reduce(function(ln,on){return dt.ctx.fillText(on,ln,le.bounds.top+Ue),ln+dt.ctx.measureText(on).width},le.bounds.left)},j.prototype.createFontStyle=function(le){var ae=le.fontVariant.filter(function(Bt){return"normal"===Bt||"small-caps"===Bt}).join(""),Ue=Qm(le.fontFamily).join(", "),dt=xi(le.fontSize)?""+le.fontSize.number+le.fontSize.unit:le.fontSize.number+"px";return[[le.fontStyle,ae,le.fontWeight,dt,Ue].join(" "),Ue,dt]},j.prototype.renderTextNode=function(le,ae){return x(this,void 0,void 0,function(){var Ue,Bt,ln,on,jn,Zn,ri,Xi=this;return L(this,function(Ss){return Ue=this.createFontStyle(ae),Bt=Ue[1],ln=Ue[2],this.ctx.font=Ue[0],this.ctx.direction=1===ae.direction?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",on=this.fontMetrics.getMetrics(Bt,ln),jn=on.baseline,Zn=on.middle,ri=ae.paintOrder,le.textBounds.forEach(function(zr){ri.forEach(function(Hr){switch(Hr){case 0:Xi.ctx.fillStyle=vl(ae.color),Xi.renderTextWithLetterSpacing(zr,ae.letterSpacing,jn);var Ho=ae.textShadow;Ho.length&&zr.text.trim().length&&(Ho.slice(0).reverse().forEach(function(Ns){Xi.ctx.shadowColor=vl(Ns.color),Xi.ctx.shadowOffsetX=Ns.offsetX.number*Xi.options.scale,Xi.ctx.shadowOffsetY=Ns.offsetY.number*Xi.options.scale,Xi.ctx.shadowBlur=Ns.blur.number,Xi.renderTextWithLetterSpacing(zr,ae.letterSpacing,jn)}),Xi.ctx.shadowColor="",Xi.ctx.shadowOffsetX=0,Xi.ctx.shadowOffsetY=0,Xi.ctx.shadowBlur=0),ae.textDecorationLine.length&&(Xi.ctx.fillStyle=vl(ae.textDecorationColor||ae.color),ae.textDecorationLine.forEach(function(Ns){switch(Ns){case 1:Xi.ctx.fillRect(zr.bounds.left,Math.round(zr.bounds.top+jn),zr.bounds.width,1);break;case 2:Xi.ctx.fillRect(zr.bounds.left,Math.round(zr.bounds.top),zr.bounds.width,1);break;case 3:Xi.ctx.fillRect(zr.bounds.left,Math.ceil(zr.bounds.top+Zn),zr.bounds.width,1)}}));break;case 1:ae.webkitTextStrokeWidth&&zr.text.trim().length&&(Xi.ctx.strokeStyle=vl(ae.webkitTextStrokeColor),Xi.ctx.lineWidth=ae.webkitTextStrokeWidth,Xi.ctx.lineJoin=window.chrome?"miter":"round",Xi.ctx.strokeText(zr.text,zr.bounds.left,zr.bounds.top+jn)),Xi.ctx.strokeStyle="",Xi.ctx.lineWidth=0,Xi.ctx.lineJoin="miter"}})}),[2]})})},j.prototype.renderReplacedElement=function(le,ae,Ue){if(Ue&&le.intrinsicWidth>0&&le.intrinsicHeight>0){var dt=Al(le),Bt=Ca(ae);this.path(Bt),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(Ue,0,0,le.intrinsicWidth,le.intrinsicHeight,dt.left,dt.top,dt.width,dt.height),this.ctx.restore()}},j.prototype.renderNodeContent=function(le){return x(this,void 0,void 0,function(){var ae,Ue,dt,Bt,ln,Zn,ri,Xi,zr,Hr,Ho,Ns,Jr,So,Xo,Fo;return L(this,function(Es){switch(Es.label){case 0:this.applyEffects(le.getEffects(4)),Ue=le.curves,dt=(ae=le.container).styles,Bt=0,ln=ae.textNodes,Es.label=1;case 1:return Bt<ln.length?[4,this.renderTextNode(ln[Bt],dt)]:[3,4];case 2:Es.sent(),Es.label=3;case 3:return Bt++,[3,1];case 4:if(!(ae instanceof w1))return[3,8];Es.label=5;case 5:return Es.trys.push([5,7,,8]),[4,this.context.cache.match(ae.src)];case 6:return Jr=Es.sent(),this.renderReplacedElement(ae,Ue,Jr),[3,8];case 7:return Es.sent(),this.context.logger.error("Error loading image "+ae.src),[3,8];case 8:if(ae instanceof C1&&this.renderReplacedElement(ae,Ue,ae.canvas),!(ae instanceof M1))return[3,12];Es.label=9;case 9:return Es.trys.push([9,11,,12]),[4,this.context.cache.match(ae.svg)];case 10:return Jr=Es.sent(),this.renderReplacedElement(ae,Ue,Jr),[3,12];case 11:return Es.sent(),this.context.logger.error("Error loading svg "+ae.svg.substring(0,255)),[3,12];case 12:return ae instanceof pv&&ae.tree?[4,new j(this.context,{scale:this.options.scale,backgroundColor:ae.backgroundColor,x:0,y:0,width:ae.width,height:ae.height}).render(ae.tree)]:[3,14];case 13:Zn=Es.sent(),ae.width&&ae.height&&this.ctx.drawImage(Zn,0,0,ae.width,ae.height,ae.bounds.left,ae.bounds.top,ae.bounds.width,ae.bounds.height),Es.label=14;case 14:if(ae instanceof kA&&(ri=Math.min(ae.bounds.width,ae.bounds.height),ae.type===Ha?ae.checked&&(this.ctx.save(),this.path([new vs(ae.bounds.left+.39363*ri,ae.bounds.top+.79*ri),new vs(ae.bounds.left+.16*ri,ae.bounds.top+.5549*ri),new vs(ae.bounds.left+.27347*ri,ae.bounds.top+.44071*ri),new vs(ae.bounds.left+.39694*ri,ae.bounds.top+.5649*ri),new vs(ae.bounds.left+.72983*ri,ae.bounds.top+.23*ri),new vs(ae.bounds.left+.84*ri,ae.bounds.top+.34085*ri),new vs(ae.bounds.left+.39363*ri,ae.bounds.top+.79*ri)]),this.ctx.fillStyle=vl(uh),this.ctx.fill(),this.ctx.restore()):ae.type===RA&&ae.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(ae.bounds.left+ri/2,ae.bounds.top+ri/2,ri/4,0,2*Math.PI,!0),this.ctx.fillStyle=vl(uh),this.ctx.fill(),this.ctx.restore())),A_(ae)&&ae.value.length){switch(Xi=this.createFontStyle(dt),zr=this.fontMetrics.getMetrics(Xo=Xi[0],Xi[1]).baseline,this.ctx.font=Xo,this.ctx.fillStyle=vl(dt.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=qm(ae.styles.textAlign),Fo=Al(ae),Hr=0,ae.styles.textAlign){case 1:Hr+=Fo.width/2;break;case 2:Hr+=Fo.width}Ho=Fo.add(Hr,0,0,-Fo.height/2+1),this.ctx.save(),this.path([new vs(Fo.left,Fo.top),new vs(Fo.left+Fo.width,Fo.top),new vs(Fo.left+Fo.width,Fo.top+Fo.height),new vs(Fo.left,Fo.top+Fo.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new ff(ae.value,Ho),dt.letterSpacing,zr),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!Yo(ae.styles.display,2048))return[3,20];if(null===ae.styles.listStyleImage)return[3,19];if(0!==(Ns=ae.styles.listStyleImage).type)return[3,18];Jr=void 0,So=Ns.url,Es.label=15;case 15:return Es.trys.push([15,17,,18]),[4,this.context.cache.match(So)];case 16:return Jr=Es.sent(),this.ctx.drawImage(Jr,ae.bounds.left-(Jr.width+10),ae.bounds.top),[3,18];case 17:return Es.sent(),this.context.logger.error("Error loading list-style-image "+So),[3,18];case 18:return[3,20];case 19:le.listValue&&-1!==ae.styles.listStyleType&&(Xo=this.createFontStyle(dt)[0],this.ctx.font=Xo,this.ctx.fillStyle=vl(dt.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",Fo=new ke(ae.bounds.left,ae.bounds.top+ha(ae.styles.paddingTop,ae.bounds.width),ae.bounds.width,rh(dt.lineHeight,dt.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new ff(le.listValue,Fo),dt.letterSpacing,rh(dt.lineHeight,dt.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),Es.label=20;case 20:return[2]}})})},j.prototype.renderStackContent=function(le){return x(this,void 0,void 0,function(){var ae,Ue,dt,Bt,ln,on,jn,Zn,ri,Xi,Ss,zr,Hr,Ho;return L(this,function(Jr){switch(Jr.label){case 0:return Yo(le.element.container.flags,16),[4,this.renderNodeBackgroundAndBorders(le.element)];case 1:Jr.sent(),ae=0,Ue=le.negativeZIndex,Jr.label=2;case 2:return ae<Ue.length?[4,this.renderStack(Ue[ae])]:[3,5];case 3:Jr.sent(),Jr.label=4;case 4:return ae++,[3,2];case 5:return[4,this.renderNodeContent(le.element)];case 6:Jr.sent(),dt=0,Bt=le.nonInlineLevel,Jr.label=7;case 7:return dt<Bt.length?[4,this.renderNode(Bt[dt])]:[3,10];case 8:Jr.sent(),Jr.label=9;case 9:return dt++,[3,7];case 10:ln=0,on=le.nonPositionedFloats,Jr.label=11;case 11:return ln<on.length?[4,this.renderStack(on[ln])]:[3,14];case 12:Jr.sent(),Jr.label=13;case 13:return ln++,[3,11];case 14:jn=0,Zn=le.nonPositionedInlineLevel,Jr.label=15;case 15:return jn<Zn.length?[4,this.renderStack(Zn[jn])]:[3,18];case 16:Jr.sent(),Jr.label=17;case 17:return jn++,[3,15];case 18:ri=0,Xi=le.inlineLevel,Jr.label=19;case 19:return ri<Xi.length?[4,this.renderNode(Xi[ri])]:[3,22];case 20:Jr.sent(),Jr.label=21;case 21:return ri++,[3,19];case 22:Ss=0,zr=le.zeroOrAutoZIndexOrTransformedOrOpacity,Jr.label=23;case 23:return Ss<zr.length?[4,this.renderStack(zr[Ss])]:[3,26];case 24:Jr.sent(),Jr.label=25;case 25:return Ss++,[3,23];case 26:Hr=0,Ho=le.positiveZIndex,Jr.label=27;case 27:return Hr<Ho.length?[4,this.renderStack(Ho[Hr])]:[3,30];case 28:Jr.sent(),Jr.label=29;case 29:return Hr++,[3,27];case 30:return[2]}})})},j.prototype.mask=function(le){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(le.slice(0).reverse()),this.ctx.closePath()},j.prototype.path=function(le){this.ctx.beginPath(),this.formatPath(le),this.ctx.closePath()},j.prototype.formatPath=function(le){var ae=this;le.forEach(function(Ue,dt){var Bt=Nc(Ue)?Ue.start:Ue;0===dt?ae.ctx.moveTo(Bt.x,Bt.y):ae.ctx.lineTo(Bt.x,Bt.y),Nc(Ue)&&ae.ctx.bezierCurveTo(Ue.startControl.x,Ue.startControl.y,Ue.endControl.x,Ue.endControl.y,Ue.end.x,Ue.end.y)})},j.prototype.renderRepeat=function(le,ae,Ue,dt){this.path(le),this.ctx.fillStyle=ae,this.ctx.translate(Ue,dt),this.ctx.fill(),this.ctx.translate(-Ue,-dt)},j.prototype.resizeImage=function(le,ae,Ue){var dt;if(le.width===ae&&le.height===Ue)return le;var ln=(null!==(dt=this.canvas.ownerDocument)&&void 0!==dt?dt:document).createElement("canvas");return ln.width=Math.max(1,ae),ln.height=Math.max(1,Ue),ln.getContext("2d").drawImage(le,0,0,le.width,le.height,0,0,ae,Ue),ln},j.prototype.renderBackgroundImage=function(le){return x(this,void 0,void 0,function(){var ae,Ue,dt,Bt,ln;return L(this,function(jn){switch(jn.label){case 0:ae=le.styles.backgroundImage.length-1,Ue=function(Zn){var ri,Xi,Ss,zr,Hr,Ho,Ns,Jr,So,Xo,Fo,Es,La,Ba,Vo,wc,tu,wu,ul,Kc,yf,ed,Fd,lp,gh,vf,$p,Xp,bf,Yp,kh;return L(this,function(GA){switch(GA.label){case 0:if(0!==Zn.type)return[3,5];ri=void 0,Xi=Zn.url,GA.label=1;case 1:return GA.trys.push([1,3,,4]),[4,dt.context.cache.match(Xi)];case 2:return ri=GA.sent(),[3,4];case 3:return GA.sent(),dt.context.logger.error("Error loading background-image "+Xi),[3,4];case 4:return ri&&(Ss=op(le,ae,[ri.width,ri.height,ri.width/ri.height]),wc=Ss[0],ed=Ss[1],Fd=Ss[2],Ba=dt.ctx.createPattern(dt.resizeImage(ri,ul=Ss[3],Kc=Ss[4]),"repeat"),dt.renderRepeat(wc,Ba,ed,Fd)),[3,6];case 5:!function(ne){return 1===ne.type}(Zn)?function(ne){return 2===ne.type}(Zn)&&(Vo=op(le,ae,[null,null,null]),wc=Vo[0],tu=Vo[1],wu=Vo[2],Kc=Vo[4],ed=ha((yf=0===Zn.position.length?[Gf]:Zn.position)[0],ul=Vo[3]),Fd=ha(yf[yf.length-1],Kc),lp=function(ne,j,le,ae,Ue){var dt=0,Bt=0;switch(ne.size){case 0:0===ne.shape?dt=Bt=Math.min(Math.abs(j),Math.abs(j-ae),Math.abs(le),Math.abs(le-Ue)):1===ne.shape&&(dt=Math.min(Math.abs(j),Math.abs(j-ae)),Bt=Math.min(Math.abs(le),Math.abs(le-Ue)));break;case 2:if(0===ne.shape)dt=Bt=Math.min(yu(j,le),yu(j,le-Ue),yu(j-ae,le),yu(j-ae,le-Ue));else if(1===ne.shape){var ln=Math.min(Math.abs(le),Math.abs(le-Ue))/Math.min(Math.abs(j),Math.abs(j-ae)),on=Mp(ae,Ue,j,le,!0);Bt=ln*(dt=yu(on[0]-j,(on[1]-le)/ln))}break;case 1:0===ne.shape?dt=Bt=Math.max(Math.abs(j),Math.abs(j-ae),Math.abs(le),Math.abs(le-Ue)):1===ne.shape&&(dt=Math.max(Math.abs(j),Math.abs(j-ae)),Bt=Math.max(Math.abs(le),Math.abs(le-Ue)));break;case 3:if(0===ne.shape)dt=Bt=Math.max(yu(j,le),yu(j,le-Ue),yu(j-ae,le),yu(j-ae,le-Ue));else if(1===ne.shape){ln=Math.max(Math.abs(le),Math.abs(le-Ue))/Math.max(Math.abs(j),Math.abs(j-ae));var ri=Mp(ae,Ue,j,le,!1);Bt=ln*(dt=yu(ri[0]-j,(ri[1]-le)/ln))}}return Array.isArray(ne.size)&&(dt=ha(ne.size[0],ae),Bt=2===ne.size.length?ha(ne.size[1],Ue):dt),[dt,Bt]}(Zn,ed,Fd,ul,Kc),vf=lp[1],(gh=lp[0])>0&&vf>0&&($p=dt.ctx.createRadialGradient(tu+ed,wu+Fd,0,tu+ed,wu+Fd,gh),Tg(Zn.stops,2*gh).forEach(function(jm){return $p.addColorStop(jm.stop,vl(jm.color))}),dt.path(wc),dt.ctx.fillStyle=$p,gh!==vf?(Xp=le.bounds.left+.5*le.bounds.width,bf=le.bounds.top+.5*le.bounds.height,kh=1/(Yp=vf/gh),dt.ctx.save(),dt.ctx.translate(Xp,bf),dt.ctx.transform(1,0,0,Yp,0,0),dt.ctx.translate(-Xp,-bf),dt.ctx.fillRect(tu,kh*(wu-bf)+bf,ul,Kc*kh),dt.ctx.restore()):dt.ctx.fill())):(zr=op(le,ae,[null,null,null]),wc=zr[0],ed=zr[1],Fd=zr[2],Hr=Cm(Zn.angle,ul=zr[3],Kc=zr[4]),Ho=Hr[0],Ns=Hr[1],Jr=Hr[2],So=Hr[3],Xo=Hr[4],(Fo=document.createElement("canvas")).width=ul,Fo.height=Kc,Es=Fo.getContext("2d"),La=Es.createLinearGradient(Ns,So,Jr,Xo),Tg(Zn.stops,Ho).forEach(function(jm){return La.addColorStop(jm.stop,vl(jm.color))}),Es.fillStyle=La,Es.fillRect(0,0,ul,Kc),ul>0&&Kc>0&&(Ba=dt.ctx.createPattern(Fo,"repeat"),dt.renderRepeat(wc,Ba,ed,Fd))),GA.label=6;case 6:return ae--,[2]}})},dt=this,Bt=0,ln=le.styles.backgroundImage.slice(0).reverse(),jn.label=1;case 1:return Bt<ln.length?[5,Ue(ln[Bt])]:[3,4];case 2:jn.sent(),jn.label=3;case 3:return Bt++,[3,1];case 4:return[2]}})})},j.prototype.renderSolidBorder=function(le,ae,Ue){return x(this,void 0,void 0,function(){return L(this,function(dt){return this.path(z1(Ue,ae)),this.ctx.fillStyle=vl(le),this.ctx.fill(),[2]})})},j.prototype.renderDoubleBorder=function(le,ae,Ue,dt){return x(this,void 0,void 0,function(){var Bt,ln;return L(this,function(on){switch(on.label){case 0:return ae<3?[4,this.renderSolidBorder(le,Ue,dt)]:[3,2];case 1:return on.sent(),[2];case 2:return Bt=function(ne,j){switch(j){case 0:return Zl(ne.topLeftBorderBox,ne.topLeftBorderDoubleOuterBox,ne.topRightBorderBox,ne.topRightBorderDoubleOuterBox);case 1:return Zl(ne.topRightBorderBox,ne.topRightBorderDoubleOuterBox,ne.bottomRightBorderBox,ne.bottomRightBorderDoubleOuterBox);case 2:return Zl(ne.bottomRightBorderBox,ne.bottomRightBorderDoubleOuterBox,ne.bottomLeftBorderBox,ne.bottomLeftBorderDoubleOuterBox);default:return Zl(ne.bottomLeftBorderBox,ne.bottomLeftBorderDoubleOuterBox,ne.topLeftBorderBox,ne.topLeftBorderDoubleOuterBox)}}(dt,Ue),this.path(Bt),this.ctx.fillStyle=vl(le),this.ctx.fill(),ln=function(ne,j){switch(j){case 0:return Zl(ne.topLeftBorderDoubleInnerBox,ne.topLeftPaddingBox,ne.topRightBorderDoubleInnerBox,ne.topRightPaddingBox);case 1:return Zl(ne.topRightBorderDoubleInnerBox,ne.topRightPaddingBox,ne.bottomRightBorderDoubleInnerBox,ne.bottomRightPaddingBox);case 2:return Zl(ne.bottomRightBorderDoubleInnerBox,ne.bottomRightPaddingBox,ne.bottomLeftBorderDoubleInnerBox,ne.bottomLeftPaddingBox);default:return Zl(ne.bottomLeftBorderDoubleInnerBox,ne.bottomLeftPaddingBox,ne.topLeftBorderDoubleInnerBox,ne.topLeftPaddingBox)}}(dt,Ue),this.path(ln),this.ctx.fill(),[2]}})})},j.prototype.renderNodeBackgroundAndBorders=function(le){return x(this,void 0,void 0,function(){var ae,Ue,dt,Bt,ln,on,jn,Zn,ri=this;return L(this,function(Xi){switch(Xi.label){case 0:return this.applyEffects(le.getEffects(2)),Ue=!Yd((ae=le.container.styles).backgroundColor)||ae.backgroundImage.length,dt=[{style:ae.borderTopStyle,color:ae.borderTopColor,width:ae.borderTopWidth},{style:ae.borderRightStyle,color:ae.borderRightColor,width:ae.borderRightWidth},{style:ae.borderBottomStyle,color:ae.borderBottomColor,width:ae.borderBottomWidth},{style:ae.borderLeftStyle,color:ae.borderLeftColor,width:ae.borderLeftWidth}],Bt=g_(Uc(ae.backgroundClip,0),le.curves),Ue||ae.boxShadow.length?(this.ctx.save(),this.path(Bt),this.ctx.clip(),Yd(ae.backgroundColor)||(this.ctx.fillStyle=vl(ae.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(le.container)]):[3,2];case 1:Xi.sent(),this.ctx.restore(),ae.boxShadow.slice(0).reverse().forEach(function(Ss){ri.ctx.save();var zr=cc(le.curves),Hr=Ss.inset?0:1e4,Ho=function(ne,j,le,ae,Ue){return ne.map(function(dt,Bt){switch(Bt){case 0:return dt.add(j,le);case 1:return dt.add(j+ae,le);case 2:return dt.add(j+ae,le+Ue);case 3:return dt.add(j,le+Ue)}return dt})}(zr,(Ss.inset?1:-1)*Ss.spread.number-Hr,(Ss.inset?1:-1)*Ss.spread.number,Ss.spread.number*(Ss.inset?-2:2),Ss.spread.number*(Ss.inset?-2:2));Ss.inset?(ri.path(zr),ri.ctx.clip(),ri.mask(Ho)):(ri.mask(zr),ri.ctx.clip(),ri.path(Ho)),ri.ctx.shadowOffsetX=Ss.offsetX.number+Hr,ri.ctx.shadowOffsetY=Ss.offsetY.number,ri.ctx.shadowColor=vl(Ss.color),ri.ctx.shadowBlur=Ss.blur.number,ri.ctx.fillStyle=Ss.inset?vl(Ss.color):"rgba(0,0,0,1)",ri.ctx.fill(),ri.ctx.restore()}),Xi.label=2;case 2:ln=0,on=0,jn=dt,Xi.label=3;case 3:return on<jn.length?0!==(Zn=jn[on]).style&&!Yd(Zn.color)&&Zn.width>0?2!==Zn.style?[3,5]:[4,this.renderDashedDottedBorder(Zn.color,Zn.width,ln,le.curves,2)]:[3,11]:[3,13];case 4:return Xi.sent(),[3,11];case 5:return 3!==Zn.style?[3,7]:[4,this.renderDashedDottedBorder(Zn.color,Zn.width,ln,le.curves,3)];case 6:return Xi.sent(),[3,11];case 7:return 4!==Zn.style?[3,9]:[4,this.renderDoubleBorder(Zn.color,Zn.width,ln,le.curves)];case 8:return Xi.sent(),[3,11];case 9:return[4,this.renderSolidBorder(Zn.color,ln,le.curves)];case 10:Xi.sent(),Xi.label=11;case 11:ln++,Xi.label=12;case 12:return on++,[3,3];case 13:return[2]}})})},j.prototype.renderDashedDottedBorder=function(le,ae,Ue,dt,Bt){return x(this,void 0,void 0,function(){var ln,on,jn,Zn,ri,Xi,Ss,zr,Hr,Ho,Ns,Jr,So,Xo,Fo,Es;return L(this,function(La){return this.ctx.save(),ln=function(ne,j){switch(j){case 0:return Vl(ne.topLeftBorderStroke,ne.topRightBorderStroke);case 1:return Vl(ne.topRightBorderStroke,ne.bottomRightBorderStroke);case 2:return Vl(ne.bottomRightBorderStroke,ne.bottomLeftBorderStroke);default:return Vl(ne.bottomLeftBorderStroke,ne.topLeftBorderStroke)}}(dt,Ue),on=z1(dt,Ue),2===Bt&&(this.path(on),this.ctx.clip()),Nc(on[0])?(jn=on[0].start.x,Zn=on[0].start.y):(jn=on[0].x,Zn=on[0].y),Nc(on[1])?(ri=on[1].end.x,Xi=on[1].end.y):(ri=on[1].x,Xi=on[1].y),Ss=0===Ue||2===Ue?Math.abs(jn-ri):Math.abs(Zn-Xi),this.ctx.beginPath(),this.formatPath(3===Bt?ln:on.slice(0,2)),zr=ae<3?3*ae:2*ae,Hr=ae<3?2*ae:ae,3===Bt&&(zr=ae,Hr=ae),Ho=!0,Ss<=2*zr?Ho=!1:Ss<=2*zr+Hr?(zr*=Ns=Ss/(2*zr+Hr),Hr*=Ns):(Jr=Math.floor((Ss+Hr)/(zr+Hr)),So=(Ss-Jr*zr)/(Jr-1),Hr=(Xo=(Ss-(Jr+1)*zr)/Jr)<=0||Math.abs(Hr-So)<Math.abs(Hr-Xo)?So:Xo),Ho&&this.ctx.setLineDash(3===Bt?[0,zr+Hr]:[zr,Hr]),3===Bt?(this.ctx.lineCap="round",this.ctx.lineWidth=ae):this.ctx.lineWidth=2*ae+1.1,this.ctx.strokeStyle=vl(le),this.ctx.stroke(),this.ctx.setLineDash([]),2===Bt&&(Nc(on[0])&&(Fo=on[3],Es=on[0],this.ctx.beginPath(),this.formatPath([new vs(Fo.end.x,Fo.end.y),new vs(Es.start.x,Es.start.y)]),this.ctx.stroke()),Nc(on[1])&&(Fo=on[1],Es=on[2],this.ctx.beginPath(),this.formatPath([new vs(Fo.end.x,Fo.end.y),new vs(Es.start.x,Es.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},j.prototype.render=function(le){return x(this,void 0,void 0,function(){var ae;return L(this,function(Ue){switch(Ue.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=vl(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),ae=function(ne){var j=new Ah(ne,null),le=new ds(j),ae=[];return Hm(j,le,le,ae),N1(j.container,ae),le}(le),[4,this.renderStack(ae)];case 1:return Ue.sent(),this.applyEffects([]),[2,this.canvas]}})})},j}(n0),A_=function(ne){return ne instanceof E1||ne instanceof Vg||ne instanceof kA&&ne.type!==RA&&ne.type!==Ha},g_=function(ne,j){switch(ne){case 0:return cc(j);case 2:return function(ne){return[ne.topLeftContentBox,ne.topRightContentBox,ne.bottomRightContentBox,ne.bottomLeftContentBox]}(j);default:return Ca(j)}},qm=function(ne){switch(ne){case 1:return"center";case 2:return"right";default:return"left"}},oo=["-apple-system","system-ui"],Qm=function(ne){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?ne.filter(function(j){return-1===oo.indexOf(j)}):ne},__=function(ne){function j(le,ae){var Ue=ne.call(this,le,ae)||this;return Ue.canvas=ae.canvas?ae.canvas:document.createElement("canvas"),Ue.ctx=Ue.canvas.getContext("2d"),Ue.options=ae,Ue.canvas.width=Math.floor(ae.width*ae.scale),Ue.canvas.height=Math.floor(ae.height*ae.scale),Ue.canvas.style.width=ae.width+"px",Ue.canvas.style.height=ae.height+"px",Ue.ctx.scale(Ue.options.scale,Ue.options.scale),Ue.ctx.translate(-ae.x,-ae.y),Ue.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+ae.width+"x"+ae.height+" at "+ae.x+","+ae.y+") with scale "+ae.scale),Ue}return Se(j,ne),j.prototype.render=function(le){return x(this,void 0,void 0,function(){var ae,Ue;return L(this,function(dt){switch(dt.label){case 0:return ae=Y0(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,le),[4,Wm(ae)];case 1:return Ue=dt.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=vl(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(Ue,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},j}(n0),Wm=function(ne){return new Promise(function(j,le){var ae=new Image;ae.onload=function(){j(ae)},ae.onerror=le,ae.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(ne))})},Ls=function(){function ne(j){var ae=j.enabled;this.id=j.id,this.enabled=ae,this.start=Date.now()}return ne.prototype.debug=function(){for(var j=[],le=0;le<arguments.length;le++)j[le]=arguments[le];this.enabled&&(typeof window<"u"&&window.console&&"function"==typeof console.debug?console.debug.apply(console,ve([this.id,this.getTime()+"ms"],j)):this.info.apply(this,j))},ne.prototype.getTime=function(){return Date.now()-this.start},ne.prototype.info=function(){for(var j=[],le=0;le<arguments.length;le++)j[le]=arguments[le];this.enabled&&typeof window<"u"&&window.console&&"function"==typeof console.info&&console.info.apply(console,ve([this.id,this.getTime()+"ms"],j))},ne.prototype.warn=function(){for(var j=[],le=0;le<arguments.length;le++)j[le]=arguments[le];this.enabled&&(typeof window<"u"&&window.console&&"function"==typeof console.warn?console.warn.apply(console,ve([this.id,this.getTime()+"ms"],j)):this.info.apply(this,j))},ne.prototype.error=function(){for(var j=[],le=0;le<arguments.length;le++)j[le]=arguments[le];this.enabled&&(typeof window<"u"&&window.console&&"function"==typeof console.error?console.error.apply(console,ve([this.id,this.getTime()+"ms"],j)):this.info.apply(this,j))},ne.instances={},ne}(),r0=function(){function ne(j,le){var ae;this.windowBounds=le,this.instanceName="#"+ne.instanceCount++,this.logger=new Ls({id:this.instanceName,enabled:j.logging}),this.cache=null!==(ae=j.cache)&&void 0!==ae?ae:new _v(this,j)}return ne.instanceCount=1,ne}();typeof window<"u"&&Rh.setContext(window);var ap=function(ne,j){return x(void 0,void 0,void 0,function(){var le,ae,Ue,dt,Bt,ln,on,jn,Zn,ri,Xi,Ss,zr,Hr,Ho,Ns,Jr,So,Xo,Fo,Es,Ba,Vo,wc,tu,wu,ul,Kc,yf,ed,Fd,lp,gh,vf,$p,Xp,bf,Yp;return L(this,function(kh){switch(kh.label){case 0:if(!ne||"object"!=typeof ne)return[2,Promise.reject("Invalid element provided as first argument")];if(!(le=ne.ownerDocument))throw new Error("Element is not attached to a Document");if(!(ae=le.defaultView))throw new Error("Document is not attached to a Window");return Ue={allowTaint:null!==(Ba=j.allowTaint)&&void 0!==Ba&&Ba,imageTimeout:null!==(Vo=j.imageTimeout)&&void 0!==Vo?Vo:15e3,proxy:j.proxy,useCORS:null!==(wc=j.useCORS)&&void 0!==wc&&wc},dt=Ee({logging:null===(tu=j.logging)||void 0===tu||tu,cache:j.cache},Ue),Bt={windowWidth:null!==(wu=j.windowWidth)&&void 0!==wu?wu:ae.innerWidth,windowHeight:null!==(ul=j.windowHeight)&&void 0!==ul?ul:ae.innerHeight,scrollX:null!==(Kc=j.scrollX)&&void 0!==Kc?Kc:ae.pageXOffset,scrollY:null!==(yf=j.scrollY)&&void 0!==yf?yf:ae.pageYOffset},ln=new ke(Bt.scrollX,Bt.scrollY,Bt.windowWidth,Bt.windowHeight),on=new r0(dt,ln),jn=null!==(ed=j.foreignObjectRendering)&&void 0!==ed&&ed,Zn={allowTaint:null!==(Fd=j.allowTaint)&&void 0!==Fd&&Fd,onclone:j.onclone,ignoreElements:j.ignoreElements,inlineImages:jn,copyStyles:jn},on.logger.debug("Starting document clone with size "+ln.width+"x"+ln.height+" scrolled to "+-ln.left+","+-ln.top),ri=new jg(on,ne,Zn),(Xi=ri.clonedReferenceElement)?[4,ri.toIFrame(le,ln)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return Ss=kh.sent(),zr=qg(Xi)||function(ne){return"HTML"===ne.tagName}(Xi)?function(ne){var j=ne.body,le=ne.documentElement;if(!j||!le)throw new Error("Unable to get document size");var ae=Math.max(Math.max(j.scrollWidth,le.scrollWidth),Math.max(j.offsetWidth,le.offsetWidth),Math.max(j.clientWidth,le.clientWidth)),Ue=Math.max(Math.max(j.scrollHeight,le.scrollHeight),Math.max(j.offsetHeight,le.offsetHeight),Math.max(j.clientHeight,le.clientHeight));return new ke(0,0,ae,Ue)}(Xi.ownerDocument):ot(on,Xi),Hr=zr.width,Ho=zr.height,Ns=zr.left,Jr=zr.top,So=s0(on,Xi,j.backgroundColor),Xo={canvas:j.canvas,backgroundColor:So,scale:null!==(gh=null!==(lp=j.scale)&&void 0!==lp?lp:ae.devicePixelRatio)&&void 0!==gh?gh:1,x:(null!==(vf=j.x)&&void 0!==vf?vf:0)+Ns,y:(null!==($p=j.y)&&void 0!==$p?$p:0)+Jr,width:null!==(Xp=j.width)&&void 0!==Xp?Xp:Math.ceil(Hr),height:null!==(bf=j.height)&&void 0!==bf?bf:Math.ceil(Ho)},jn?(on.logger.debug("Document cloned, using foreign object rendering"),[4,new __(on,Xo).render(Xi)]):[3,3];case 2:return Fo=kh.sent(),[3,5];case 3:return on.logger.debug("Document cloned, element located at "+Ns+","+Jr+" with size "+Hr+"x"+Ho+" using computed rendering"),on.logger.debug("Starting DOM parsing"),Es=Z0(on,Xi),So===Es.styles.backgroundColor&&(Es.styles.backgroundColor=Wc.TRANSPARENT),on.logger.debug("Starting renderer for element at "+Xo.x+","+Xo.y+" with size "+Xo.width+"x"+Xo.height),[4,new VA(on,Xo).render(Es)];case 4:Fo=kh.sent(),kh.label=5;case 5:return(!(null!==(Yp=j.removeContainer)&&void 0!==Yp)||Yp)&&(jg.destroy(Ss)||on.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),on.logger.debug("Finished rendering"),[2,Fo]}})})},s0=function(ne,j,le){var ae=j.ownerDocument,Ue=ae.documentElement?th(ne,getComputedStyle(ae.documentElement).backgroundColor):Wc.TRANSPARENT,dt=ae.body?th(ne,getComputedStyle(ae.body).backgroundColor):Wc.TRANSPARENT,Bt="string"==typeof le?th(ne,le):null===le?Wc.TRANSPARENT:4294967295;return j===ae.documentElement?Yd(Ue)?Yd(dt)?Bt:dt:Ue:Bt};return function(ne,j){return void 0===j&&(j={}),ap(ne,j)}}()},1747:Yr=>{Yr.exports=function mt(Se,Ee,x){function L(ot,Ye){if(!Ee[ot]){if(!Se[ot]){if(ve)return ve(ot,!0);var Re=new Error("Cannot find module '"+ot+"'");throw Re.code="MODULE_NOT_FOUND",Re}var He=Ee[ot]={exports:{}};Se[ot][0].call(He.exports,function(Ve){return L(Se[ot][1][Ve]||Ve)},He,He.exports,mt,Se,Ee,x)}return Ee[ot].exports}for(var ve=void 0,ke=0;ke<x.length;ke++)L(x[ke]);return L}({1:[function(mt,Se,Ee){"use strict";var x=mt("./utils"),L=mt("./support"),ve="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";Ee.encode=function(ke){for(var ot,Ye,Ze,He,Ve,De,F=[],J=0,Y=ke.length,ue=Y,Q="string"!==x.getTypeOf(ke);J<ke.length;)ue=Y-J,Ze=Q?(ot=ke[J++],Ye=J<Y?ke[J++]:0,J<Y?ke[J++]:0):(ot=ke.charCodeAt(J++),Ye=J<Y?ke.charCodeAt(J++):0,J<Y?ke.charCodeAt(J++):0),He=(3&ot)<<4|Ye>>4,Ve=1<ue?(15&Ye)<<2|Ze>>6:64,De=2<ue?63&Ze:64,F.push(ve.charAt(ot>>2)+ve.charAt(He)+ve.charAt(Ve)+ve.charAt(De));return F.join("")},Ee.decode=function(ke){var ot,Ye,Ze,Re,He,Ve,De=0,F=0,J="data:";if(ke.substr(0,5)===J)throw new Error("Invalid base64 input, it looks like a data url.");var Y,ue=3*(ke=ke.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(ke.charAt(ke.length-1)===ve.charAt(64)&&ue--,ke.charAt(ke.length-2)===ve.charAt(64)&&ue--,ue%1!=0)throw new Error("Invalid base64 input, bad content length.");for(Y=L.uint8array?new Uint8Array(0|ue):new Array(0|ue);De<ke.length;)ot=ve.indexOf(ke.charAt(De++))<<2|(Re=ve.indexOf(ke.charAt(De++)))>>4,Ye=(15&Re)<<4|(He=ve.indexOf(ke.charAt(De++)))>>2,Ze=(3&He)<<6|(Ve=ve.indexOf(ke.charAt(De++))),Y[F++]=ot,64!==He&&(Y[F++]=Ye),64!==Ve&&(Y[F++]=Ze);return Y}},{"./support":30,"./utils":32}],2:[function(mt,Se,Ee){"use strict";var x=mt("./external"),L=mt("./stream/DataWorker"),ve=mt("./stream/Crc32Probe"),ke=mt("./stream/DataLengthProbe");function ot(Ye,Ze,Re,He,Ve){this.compressedSize=Ye,this.uncompressedSize=Ze,this.crc32=Re,this.compression=He,this.compressedContent=Ve}ot.prototype={getContentWorker:function(){var Ye=new L(x.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new ke("data_length")),Ze=this;return Ye.on("end",function(){if(this.streamInfo.data_length!==Ze.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),Ye},getCompressedWorker:function(){return new L(x.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},ot.createWorkerFrom=function(Ye,Ze,Re){return Ye.pipe(new ve).pipe(new ke("uncompressedSize")).pipe(Ze.compressWorker(Re)).pipe(new ke("compressedSize")).withStreamInfo("compression",Ze)},Se.exports=ot},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(mt,Se,Ee){"use strict";var x=mt("./stream/GenericWorker");Ee.STORE={magic:"\0\0",compressWorker:function(){return new x("STORE compression")},uncompressWorker:function(){return new x("STORE decompression")}},Ee.DEFLATE=mt("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(mt,Se,Ee){"use strict";var x=mt("./utils"),L=function(){for(var ve,ke=[],ot=0;ot<256;ot++){ve=ot;for(var Ye=0;Ye<8;Ye++)ve=1&ve?3988292384^ve>>>1:ve>>>1;ke[ot]=ve}return ke}();Se.exports=function(ve,ke){return void 0!==ve&&ve.length?"string"!==x.getTypeOf(ve)?function(ot,Ye,Ze,Re){var He=L,Ve=0+Ze;ot^=-1;for(var De=0;De<Ve;De++)ot=ot>>>8^He[255&(ot^Ye[De])];return~ot}(0|ke,ve,ve.length):function(ot,Ye,Ze,Re){var He=L,Ve=0+Ze;ot^=-1;for(var De=0;De<Ve;De++)ot=ot>>>8^He[255&(ot^Ye.charCodeAt(De))];return~ot}(0|ke,ve,ve.length):0}},{"./utils":32}],5:[function(mt,Se,Ee){"use strict";Ee.base64=!1,Ee.binary=!1,Ee.dir=!1,Ee.createFolders=!0,Ee.date=null,Ee.compression=null,Ee.compressionOptions=null,Ee.comment=null,Ee.unixPermissions=null,Ee.dosPermissions=null},{}],6:[function(mt,Se,Ee){"use strict";var x;x=typeof Promise<"u"?Promise:mt("lie"),Se.exports={Promise:x}},{lie:37}],7:[function(mt,Se,Ee){"use strict";var x=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",L=mt("pako"),ve=mt("./utils"),ke=mt("./stream/GenericWorker"),ot=x?"uint8array":"array";function Ye(Ze,Re){ke.call(this,"FlateWorker/"+Ze),this._pako=null,this._pakoAction=Ze,this._pakoOptions=Re,this.meta={}}Ee.magic="\b\0",ve.inherits(Ye,ke),Ye.prototype.processChunk=function(Ze){this.meta=Ze.meta,null===this._pako&&this._createPako(),this._pako.push(ve.transformTo(ot,Ze.data),!1)},Ye.prototype.flush=function(){ke.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},Ye.prototype.cleanUp=function(){ke.prototype.cleanUp.call(this),this._pako=null},Ye.prototype._createPako=function(){this._pako=new L[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var Ze=this;this._pako.onData=function(Re){Ze.push({data:Re,meta:Ze.meta})}},Ee.compressWorker=function(Ze){return new Ye("Deflate",Ze)},Ee.uncompressWorker=function(){return new Ye("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(mt,Se,Ee){"use strict";function x(He,Ve){var De,F="";for(De=0;De<Ve;De++)F+=String.fromCharCode(255&He),He>>>=8;return F}function L(He,Ve,De,F,J,Y){var ue,Q,me=He.file,X=He.compression,B=Y!==ot.utf8encode,$=ve.transformTo("string",Y(me.name)),A=ve.transformTo("string",ot.utf8encode(me.name)),E=me.comment,g=ve.transformTo("string",Y(E)),v=ve.transformTo("string",ot.utf8encode(E)),f=A.length!==me.name.length,C=v.length!==E.length,I="",U="",k="",Z=me.dir,ee=me.date,he={crc32:0,compressedSize:0,uncompressedSize:0};Ve&&!De||(he.crc32=He.crc32,he.compressedSize=He.compressedSize,he.uncompressedSize=He.uncompressedSize);var G=0;Ve&&(G|=8),B||!f&&!C||(G|=2048);var z,fe,b=0,P=0;Z&&(b|=16),"UNIX"===J?(P=798,b|=(fe=z=me.unixPermissions,z||(fe=Z?16893:33204),(65535&fe)<<16)):(P=20,b|=function(z){return 63&(z||0)}(me.dosPermissions)),ue=ee.getUTCHours(),ue<<=6,ue|=ee.getUTCMinutes(),ue<<=5,ue|=ee.getUTCSeconds()/2,Q=ee.getUTCFullYear()-1980,Q<<=4,Q|=ee.getUTCMonth()+1,Q<<=5,Q|=ee.getUTCDate(),f&&(U=x(1,1)+x(Ye($),4)+A,I+="up"+x(U.length,2)+U),C&&(k=x(1,1)+x(Ye(g),4)+v,I+="uc"+x(k.length,2)+k);var T="";return T+="\n\0",T+=x(G,2),T+=X.magic,T+=x(ue,2),T+=x(Q,2),T+=x(he.crc32,4),T+=x(he.compressedSize,4),T+=x(he.uncompressedSize,4),T+=x($.length,2),T+=x(I.length,2),{fileRecord:Ze.LOCAL_FILE_HEADER+T+$+I,dirRecord:Ze.CENTRAL_FILE_HEADER+x(P,2)+T+x(g.length,2)+"\0\0\0\0"+x(b,4)+x(F,4)+$+I+g}}var ve=mt("../utils"),ke=mt("../stream/GenericWorker"),ot=mt("../utf8"),Ye=mt("../crc32"),Ze=mt("../signature");function Re(He,Ve,De,F){ke.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=Ve,this.zipPlatform=De,this.encodeFileName=F,this.streamFiles=He,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}ve.inherits(Re,ke),Re.prototype.push=function(He){var Ve=He.meta.percent||0,De=this.entriesCount,F=this._sources.length;this.accumulate?this.contentBuffer.push(He):(this.bytesWritten+=He.data.length,ke.prototype.push.call(this,{data:He.data,meta:{currentFile:this.currentFile,percent:De?(Ve+100*(De-F-1))/De:100}}))},Re.prototype.openedSource=function(He){this.currentSourceOffset=this.bytesWritten,this.currentFile=He.file.name;var Ve=this.streamFiles&&!He.file.dir;if(Ve){var De=L(He,Ve,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:De.fileRecord,meta:{percent:0}})}else this.accumulate=!0},Re.prototype.closedSource=function(He){this.accumulate=!1;var F,Ve=this.streamFiles&&!He.file.dir,De=L(He,Ve,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(De.dirRecord),Ve)this.push({data:(F=He,Ze.DATA_DESCRIPTOR+x(F.crc32,4)+x(F.compressedSize,4)+x(F.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:De.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},Re.prototype.flush=function(){for(var He=this.bytesWritten,Ve=0;Ve<this.dirRecords.length;Ve++)this.push({data:this.dirRecords[Ve],meta:{percent:100}});var J,Y,ue,X,F=(J=this.dirRecords.length,Y=this.bytesWritten-He,ue=He,X=ve.transformTo("string",(0,this.encodeFileName)(this.zipComment)),Ze.CENTRAL_DIRECTORY_END+"\0\0\0\0"+x(J,2)+x(J,2)+x(Y,4)+x(ue,4)+x(X.length,2)+X);this.push({data:F,meta:{percent:100}})},Re.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},Re.prototype.registerPrevious=function(He){this._sources.push(He);var Ve=this;return He.on("data",function(De){Ve.processChunk(De)}),He.on("end",function(){Ve.closedSource(Ve.previous.streamInfo),Ve._sources.length?Ve.prepareNextSource():Ve.end()}),He.on("error",function(De){Ve.error(De)}),this},Re.prototype.resume=function(){return!!ke.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},Re.prototype.error=function(He){var Ve=this._sources;if(!ke.prototype.error.call(this,He))return!1;for(var De=0;De<Ve.length;De++)try{Ve[De].error(He)}catch{}return!0},Re.prototype.lock=function(){ke.prototype.lock.call(this);for(var He=this._sources,Ve=0;Ve<He.length;Ve++)He[Ve].lock()},Se.exports=Re},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(mt,Se,Ee){"use strict";var x=mt("../compressions"),L=mt("./ZipFileWorker");Ee.generateWorker=function(ve,ke,ot){var Ye=new L(ke.streamFiles,ot,ke.platform,ke.encodeFileName),Ze=0;try{ve.forEach(function(Re,He){Ze++;var Ve=function(Y,ue){var Q=Y||ue,me=x[Q];if(!me)throw new Error(Q+" is not a valid compression method !");return me}(He.options.compression,ke.compression),F=He.dir,J=He.date;He._compressWorker(Ve,He.options.compressionOptions||ke.compressionOptions||{}).withStreamInfo("file",{name:Re,dir:F,date:J,comment:He.comment||"",unixPermissions:He.unixPermissions,dosPermissions:He.dosPermissions}).pipe(Ye)}),Ye.entriesCount=Ze}catch(Re){Ye.error(Re)}return Ye}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(mt,Se,Ee){"use strict";function x(){if(!(this instanceof x))return new x;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var L=new x;for(var ve in this)"function"!=typeof this[ve]&&(L[ve]=this[ve]);return L}}(x.prototype=mt("./object")).loadAsync=mt("./load"),x.support=mt("./support"),x.defaults=mt("./defaults"),x.version="3.10.1",x.loadAsync=function(L,ve){return(new x).loadAsync(L,ve)},x.external=mt("./external"),Se.exports=x},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(mt,Se,Ee){"use strict";var x=mt("./utils"),L=mt("./external"),ve=mt("./utf8"),ke=mt("./zipEntries"),ot=mt("./stream/Crc32Probe"),Ye=mt("./nodejsUtils");function Ze(Re){return new L.Promise(function(He,Ve){var De=Re.decompressed.getContentWorker().pipe(new ot);De.on("error",function(F){Ve(F)}).on("end",function(){De.streamInfo.crc32!==Re.decompressed.crc32?Ve(new Error("Corrupted zip : CRC32 mismatch")):He()}).resume()})}Se.exports=function(Re,He){var Ve=this;return He=x.extend(He||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:ve.utf8decode}),Ye.isNode&&Ye.isStream(Re)?L.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):x.prepareContent("the loaded zip file",Re,!0,He.optimizedBinaryString,He.base64).then(function(De){var F=new ke(He);return F.load(De),F}).then(function(De){var F=[L.Promise.resolve(De)],J=De.files;if(He.checkCRC32)for(var Y=0;Y<J.length;Y++)F.push(Ze(J[Y]));return L.Promise.all(F)}).then(function(De){for(var F=De.shift(),J=F.files,Y=0;Y<J.length;Y++){var ue=J[Y],Q=ue.fileNameStr,me=x.resolve(ue.fileNameStr);Ve.file(me,ue.decompressed,{binary:!0,optimizedBinaryString:!0,date:ue.date,dir:ue.dir,comment:ue.fileCommentStr.length?ue.fileCommentStr:null,unixPermissions:ue.unixPermissions,dosPermissions:ue.dosPermissions,createFolders:He.createFolders}),ue.dir||(Ve.file(me).unsafeOriginalName=Q)}return F.zipComment.length&&(Ve.comment=F.zipComment),Ve})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(mt,Se,Ee){"use strict";var x=mt("../utils"),L=mt("../stream/GenericWorker");function ve(ke,ot){L.call(this,"Nodejs stream input adapter for "+ke),this._upstreamEnded=!1,this._bindStream(ot)}x.inherits(ve,L),ve.prototype._bindStream=function(ke){var ot=this;(this._stream=ke).pause(),ke.on("data",function(Ye){ot.push({data:Ye,meta:{percent:0}})}).on("error",function(Ye){ot.isPaused?this.generatedError=Ye:ot.error(Ye)}).on("end",function(){ot.isPaused?ot._upstreamEnded=!0:ot.end()})},ve.prototype.pause=function(){return!!L.prototype.pause.call(this)&&(this._stream.pause(),!0)},ve.prototype.resume=function(){return!!L.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},Se.exports=ve},{"../stream/GenericWorker":28,"../utils":32}],13:[function(mt,Se,Ee){"use strict";var x=mt("readable-stream").Readable;function L(ve,ke,ot){x.call(this,ke),this._helper=ve;var Ye=this;ve.on("data",function(Ze,Re){Ye.push(Ze)||Ye._helper.pause(),ot&&ot(Re)}).on("error",function(Ze){Ye.emit("error",Ze)}).on("end",function(){Ye.push(null)})}mt("../utils").inherits(L,x),L.prototype._read=function(){this._helper.resume()},Se.exports=L},{"../utils":32,"readable-stream":16}],14:[function(mt,Se,Ee){"use strict";Se.exports={isNode:typeof Buffer<"u",newBufferFrom:function(x,L){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(x,L);if("number"==typeof x)throw new Error('The "data" argument must not be a number');return new Buffer(x,L)},allocBuffer:function(x){if(Buffer.alloc)return Buffer.alloc(x);var L=new Buffer(x);return L.fill(0),L},isBuffer:function(x){return Buffer.isBuffer(x)},isStream:function(x){return x&&"function"==typeof x.on&&"function"==typeof x.pause&&"function"==typeof x.resume}}},{}],15:[function(mt,Se,Ee){"use strict";function x(me,X,B){var $,A=ve.getTypeOf(X),E=ve.extend(B||{},Ye);E.date=E.date||new Date,null!==E.compression&&(E.compression=E.compression.toUpperCase()),"string"==typeof E.unixPermissions&&(E.unixPermissions=parseInt(E.unixPermissions,8)),E.unixPermissions&&16384&E.unixPermissions&&(E.dir=!0),E.dosPermissions&&16&E.dosPermissions&&(E.dir=!0),E.dir&&(me=J(me)),E.createFolders&&($=F(me))&&Y.call(this,$,!0),B&&void 0!==B.binary||(E.binary=!("string"===A&&!1===E.binary&&!1===E.base64)),(X instanceof Ze&&0===X.uncompressedSize||E.dir||!X||0===X.length)&&(E.base64=!1,E.binary=!0,X="",E.compression="STORE",A="string");var v;v=X instanceof Ze||X instanceof ke?X:Ve.isNode&&Ve.isStream(X)?new De(me,X):ve.prepareContent(me,X,E.binary,E.optimizedBinaryString,E.base64);var f=new Re(me,v,E);this.files[me]=f}var L=mt("./utf8"),ve=mt("./utils"),ke=mt("./stream/GenericWorker"),ot=mt("./stream/StreamHelper"),Ye=mt("./defaults"),Ze=mt("./compressedObject"),Re=mt("./zipObject"),He=mt("./generate"),Ve=mt("./nodejsUtils"),De=mt("./nodejs/NodejsStreamInputAdapter"),F=function(me){"/"===me.slice(-1)&&(me=me.substring(0,me.length-1));var X=me.lastIndexOf("/");return 0<X?me.substring(0,X):""},J=function(me){return"/"!==me.slice(-1)&&(me+="/"),me},Y=function(me,X){return X=void 0!==X?X:Ye.createFolders,me=J(me),this.files[me]||x.call(this,me,null,{dir:!0,createFolders:X}),this.files[me]};function ue(me){return"[object RegExp]"===Object.prototype.toString.call(me)}var Q={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(me){var X,B,$;for(X in this.files)$=this.files[X],(B=X.slice(this.root.length,X.length))&&X.slice(0,this.root.length)===this.root&&me(B,$)},filter:function(me){var X=[];return this.forEach(function(B,$){me(B,$)&&X.push($)}),X},file:function(me,X,B){if(1!==arguments.length)return x.call(this,me=this.root+me,X,B),this;if(ue(me)){var $=me;return this.filter(function(E,g){return!g.dir&&$.test(E)})}var A=this.files[this.root+me];return A&&!A.dir?A:null},folder:function(me){if(!me)return this;if(ue(me))return this.filter(function(A,E){return E.dir&&me.test(A)});var B=Y.call(this,this.root+me),$=this.clone();return $.root=B.name,$},remove:function(me){var X=this.files[me=this.root+me];if(X||("/"!==me.slice(-1)&&(me+="/"),X=this.files[me]),X&&!X.dir)delete this.files[me];else for(var B=this.filter(function(A,E){return E.name.slice(0,me.length)===me}),$=0;$<B.length;$++)delete this.files[B[$].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(me){var X,B={};try{if((B=ve.extend(me||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:L.utf8encode})).type=B.type.toLowerCase(),B.compression=B.compression.toUpperCase(),"binarystring"===B.type&&(B.type="string"),!B.type)throw new Error("No output type specified.");ve.checkSupport(B.type),"darwin"!==B.platform&&"freebsd"!==B.platform&&"linux"!==B.platform&&"sunos"!==B.platform||(B.platform="UNIX"),"win32"===B.platform&&(B.platform="DOS"),X=He.generateWorker(this,B,B.comment||this.comment||"")}catch(A){(X=new ke("error")).error(A)}return new ot(X,B.type||"string",B.mimeType)},generateAsync:function(me,X){return this.generateInternalStream(me).accumulate(X)},generateNodeStream:function(me,X){return(me=me||{}).type||(me.type="nodebuffer"),this.generateInternalStream(me).toNodejsStream(X)}};Se.exports=Q},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(mt,Se,Ee){"use strict";Se.exports=mt("stream")},{stream:void 0}],17:[function(mt,Se,Ee){"use strict";var x=mt("./DataReader");function L(ve){x.call(this,ve);for(var ke=0;ke<this.data.length;ke++)ve[ke]=255&ve[ke]}mt("../utils").inherits(L,x),L.prototype.byteAt=function(ve){return this.data[this.zero+ve]},L.prototype.lastIndexOfSignature=function(ve){for(var ke=ve.charCodeAt(0),ot=ve.charCodeAt(1),Ye=ve.charCodeAt(2),Ze=ve.charCodeAt(3),Re=this.length-4;0<=Re;--Re)if(this.data[Re]===ke&&this.data[Re+1]===ot&&this.data[Re+2]===Ye&&this.data[Re+3]===Ze)return Re-this.zero;return-1},L.prototype.readAndCheckSignature=function(ve){var ke=ve.charCodeAt(0),ot=ve.charCodeAt(1),Ye=ve.charCodeAt(2),Ze=ve.charCodeAt(3),Re=this.readData(4);return ke===Re[0]&&ot===Re[1]&&Ye===Re[2]&&Ze===Re[3]},L.prototype.readData=function(ve){if(this.checkOffset(ve),0===ve)return[];var ke=this.data.slice(this.zero+this.index,this.zero+this.index+ve);return this.index+=ve,ke},Se.exports=L},{"../utils":32,"./DataReader":18}],18:[function(mt,Se,Ee){"use strict";var x=mt("../utils");function L(ve){this.data=ve,this.length=ve.length,this.index=0,this.zero=0}L.prototype={checkOffset:function(ve){this.checkIndex(this.index+ve)},checkIndex:function(ve){if(this.length<this.zero+ve||ve<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+ve+"). Corrupted zip ?")},setIndex:function(ve){this.checkIndex(ve),this.index=ve},skip:function(ve){this.setIndex(this.index+ve)},byteAt:function(){},readInt:function(ve){var ke,ot=0;for(this.checkOffset(ve),ke=this.index+ve-1;ke>=this.index;ke--)ot=(ot<<8)+this.byteAt(ke);return this.index+=ve,ot},readString:function(ve){return x.transformTo("string",this.readData(ve))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var ve=this.readInt(4);return new Date(Date.UTC(1980+(ve>>25&127),(ve>>21&15)-1,ve>>16&31,ve>>11&31,ve>>5&63,(31&ve)<<1))}},Se.exports=L},{"../utils":32}],19:[function(mt,Se,Ee){"use strict";var x=mt("./Uint8ArrayReader");function L(ve){x.call(this,ve)}mt("../utils").inherits(L,x),L.prototype.readData=function(ve){this.checkOffset(ve);var ke=this.data.slice(this.zero+this.index,this.zero+this.index+ve);return this.index+=ve,ke},Se.exports=L},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(mt,Se,Ee){"use strict";var x=mt("./DataReader");function L(ve){x.call(this,ve)}mt("../utils").inherits(L,x),L.prototype.byteAt=function(ve){return this.data.charCodeAt(this.zero+ve)},L.prototype.lastIndexOfSignature=function(ve){return this.data.lastIndexOf(ve)-this.zero},L.prototype.readAndCheckSignature=function(ve){return ve===this.readData(4)},L.prototype.readData=function(ve){this.checkOffset(ve);var ke=this.data.slice(this.zero+this.index,this.zero+this.index+ve);return this.index+=ve,ke},Se.exports=L},{"../utils":32,"./DataReader":18}],21:[function(mt,Se,Ee){"use strict";var x=mt("./ArrayReader");function L(ve){x.call(this,ve)}mt("../utils").inherits(L,x),L.prototype.readData=function(ve){if(this.checkOffset(ve),0===ve)return new Uint8Array(0);var ke=this.data.subarray(this.zero+this.index,this.zero+this.index+ve);return this.index+=ve,ke},Se.exports=L},{"../utils":32,"./ArrayReader":17}],22:[function(mt,Se,Ee){"use strict";var x=mt("../utils"),L=mt("../support"),ve=mt("./ArrayReader"),ke=mt("./StringReader"),ot=mt("./NodeBufferReader"),Ye=mt("./Uint8ArrayReader");Se.exports=function(Ze){var Re=x.getTypeOf(Ze);return x.checkSupport(Re),"string"!==Re||L.uint8array?"nodebuffer"===Re?new ot(Ze):L.uint8array?new Ye(x.transformTo("uint8array",Ze)):new ve(x.transformTo("array",Ze)):new ke(Ze)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(mt,Se,Ee){"use strict";Ee.LOCAL_FILE_HEADER="PK\x03\x04",Ee.CENTRAL_FILE_HEADER="PK\x01\x02",Ee.CENTRAL_DIRECTORY_END="PK\x05\x06",Ee.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",Ee.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",Ee.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(mt,Se,Ee){"use strict";var x=mt("./GenericWorker"),L=mt("../utils");function ve(ke){x.call(this,"ConvertWorker to "+ke),this.destType=ke}L.inherits(ve,x),ve.prototype.processChunk=function(ke){this.push({data:L.transformTo(this.destType,ke.data),meta:ke.meta})},Se.exports=ve},{"../utils":32,"./GenericWorker":28}],25:[function(mt,Se,Ee){"use strict";var x=mt("./GenericWorker"),L=mt("../crc32");function ve(){x.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}mt("../utils").inherits(ve,x),ve.prototype.processChunk=function(ke){this.streamInfo.crc32=L(ke.data,this.streamInfo.crc32||0),this.push(ke)},Se.exports=ve},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(mt,Se,Ee){"use strict";var x=mt("../utils"),L=mt("./GenericWorker");function ve(ke){L.call(this,"DataLengthProbe for "+ke),this.propName=ke,this.withStreamInfo(ke,0)}x.inherits(ve,L),ve.prototype.processChunk=function(ke){ke&&(this.streamInfo[this.propName]=(this.streamInfo[this.propName]||0)+ke.data.length),L.prototype.processChunk.call(this,ke)},Se.exports=ve},{"../utils":32,"./GenericWorker":28}],27:[function(mt,Se,Ee){"use strict";var x=mt("../utils"),L=mt("./GenericWorker");function ve(ke){L.call(this,"DataWorker");var ot=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,ke.then(function(Ye){ot.dataIsReady=!0,ot.data=Ye,ot.max=Ye&&Ye.length||0,ot.type=x.getTypeOf(Ye),ot.isPaused||ot._tickAndRepeat()},function(Ye){ot.error(Ye)})}x.inherits(ve,L),ve.prototype.cleanUp=function(){L.prototype.cleanUp.call(this),this.data=null},ve.prototype.resume=function(){return!!L.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,x.delay(this._tickAndRepeat,[],this)),!0)},ve.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(x.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},ve.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var ke=null,ot=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":ke=this.data.substring(this.index,ot);break;case"uint8array":ke=this.data.subarray(this.index,ot);break;case"array":case"nodebuffer":ke=this.data.slice(this.index,ot)}return this.index=ot,this.push({data:ke,meta:{percent:this.max?this.index/this.max*100:0}})},Se.exports=ve},{"../utils":32,"./GenericWorker":28}],28:[function(mt,Se,Ee){"use strict";function x(L){this.name=L||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}x.prototype={push:function(L){this.emit("data",L)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(L){this.emit("error",L)}return!0},error:function(L){return!this.isFinished&&(this.isPaused?this.generatedError=L:(this.isFinished=!0,this.emit("error",L),this.previous&&this.previous.error(L),this.cleanUp()),!0)},on:function(L,ve){return this._listeners[L].push(ve),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(L,ve){if(this._listeners[L])for(var ke=0;ke<this._listeners[L].length;ke++)this._listeners[L][ke].call(this,ve)},pipe:function(L){return L.registerPrevious(this)},registerPrevious:function(L){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=L.streamInfo,this.mergeStreamInfo(),this.previous=L;var ve=this;return L.on("data",function(ke){ve.processChunk(ke)}),L.on("end",function(){ve.end()}),L.on("error",function(ke){ve.error(ke)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var L=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),L=!0),this.previous&&this.previous.resume(),!L},flush:function(){},processChunk:function(L){this.push(L)},withStreamInfo:function(L,ve){return this.extraStreamInfo[L]=ve,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var L in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,L)&&(this.streamInfo[L]=this.extraStreamInfo[L])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var L="Worker "+this.name;return this.previous?this.previous+" -> "+L:L}},Se.exports=x},{}],29:[function(mt,Se,Ee){"use strict";var x=mt("../utils"),L=mt("./ConvertWorker"),ve=mt("./GenericWorker"),ke=mt("../base64"),ot=mt("../support"),Ye=mt("../external"),Ze=null;if(ot.nodestream)try{Ze=mt("../nodejs/NodejsStreamOutputAdapter")}catch{}function He(Ve,De,F){var J=De;switch(De){case"blob":case"arraybuffer":J="uint8array";break;case"base64":J="string"}try{this._internalType=J,this._outputType=De,this._mimeType=F,x.checkSupport(J),this._worker=Ve.pipe(new L(J)),Ve.lock()}catch(Y){this._worker=new ve("error"),this._worker.error(Y)}}He.prototype={accumulate:function(Ve){return function Re(Ve,De){return new Ye.Promise(function(F,J){var Y=[],ue=Ve._internalType,Q=Ve._outputType,me=Ve._mimeType;Ve.on("data",function(X,B){Y.push(X),De&&De(B)}).on("error",function(X){Y=[],J(X)}).on("end",function(){try{var X=function(B,$,A){switch(B){case"blob":return x.newBlob(x.transformTo("arraybuffer",$),A);case"base64":return ke.encode($);default:return x.transformTo(B,$)}}(Q,function(B,$){var A,E=0,g=null,v=0;for(A=0;A<$.length;A++)v+=$[A].length;switch(B){case"string":return $.join("");case"array":return Array.prototype.concat.apply([],$);case"uint8array":for(g=new Uint8Array(v),A=0;A<$.length;A++)g.set($[A],E),E+=$[A].length;return g;case"nodebuffer":return Buffer.concat($);default:throw new Error("concat : unsupported type '"+B+"'")}}(ue,Y),me);F(X)}catch(B){J(B)}Y=[]}).resume()})}(this,Ve)},on:function(Ve,De){var F=this;return this._worker.on(Ve,"data"===Ve?function(J){De.call(F,J.data,J.meta)}:function(){x.delay(De,arguments,F)}),this},resume:function(){return x.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(Ve){if(x.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new Ze(this,{objectMode:"nodebuffer"!==this._outputType},Ve)}},Se.exports=He},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(mt,Se,Ee){"use strict";if(Ee.base64=!0,Ee.array=!0,Ee.string=!0,Ee.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",Ee.nodebuffer=typeof Buffer<"u",Ee.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")Ee.blob=!1;else{var x=new ArrayBuffer(0);try{Ee.blob=0===new Blob([x],{type:"application/zip"}).size}catch{try{var L=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);L.append(x),Ee.blob=0===L.getBlob("application/zip").size}catch{Ee.blob=!1}}}try{Ee.nodestream=!!mt("readable-stream").Readable}catch{Ee.nodestream=!1}},{"readable-stream":16}],31:[function(mt,Se,Ee){"use strict";for(var x=mt("./utils"),L=mt("./support"),ve=mt("./nodejsUtils"),ke=mt("./stream/GenericWorker"),ot=new Array(256),Ye=0;Ye<256;Ye++)ot[Ye]=252<=Ye?6:248<=Ye?5:240<=Ye?4:224<=Ye?3:192<=Ye?2:1;function Ze(){ke.call(this,"utf-8 decode"),this.leftOver=null}function Re(){ke.call(this,"utf-8 encode")}ot[254]=ot[254]=1,Ee.utf8encode=function(He){return L.nodebuffer?ve.newBufferFrom(He,"utf-8"):function(Ve){var De,F,J,Y,ue,Q=Ve.length,me=0;for(Y=0;Y<Q;Y++)55296==(64512&(F=Ve.charCodeAt(Y)))&&Y+1<Q&&56320==(64512&(J=Ve.charCodeAt(Y+1)))&&(F=65536+(F-55296<<10)+(J-56320),Y++),me+=F<128?1:F<2048?2:F<65536?3:4;for(De=L.uint8array?new Uint8Array(me):new Array(me),Y=ue=0;ue<me;Y++)55296==(64512&(F=Ve.charCodeAt(Y)))&&Y+1<Q&&56320==(64512&(J=Ve.charCodeAt(Y+1)))&&(F=65536+(F-55296<<10)+(J-56320),Y++),F<128?De[ue++]=F:(F<2048?De[ue++]=192|F>>>6:(F<65536?De[ue++]=224|F>>>12:(De[ue++]=240|F>>>18,De[ue++]=128|F>>>12&63),De[ue++]=128|F>>>6&63),De[ue++]=128|63&F);return De}(He)},Ee.utf8decode=function(He){return L.nodebuffer?x.transformTo("nodebuffer",He).toString("utf-8"):function(Ve){var De,F,J,Y,ue=Ve.length,Q=new Array(2*ue);for(De=F=0;De<ue;)if((J=Ve[De++])<128)Q[F++]=J;else if(4<(Y=ot[J]))Q[F++]=65533,De+=Y-1;else{for(J&=2===Y?31:3===Y?15:7;1<Y&&De<ue;)J=J<<6|63&Ve[De++],Y--;1<Y?Q[F++]=65533:J<65536?Q[F++]=J:(Q[F++]=55296|(J-=65536)>>10&1023,Q[F++]=56320|1023&J)}return Q.length!==F&&(Q.subarray?Q=Q.subarray(0,F):Q.length=F),x.applyFromCharCode(Q)}(He=x.transformTo(L.uint8array?"uint8array":"array",He))},x.inherits(Ze,ke),Ze.prototype.processChunk=function(He){var Ve=x.transformTo(L.uint8array?"uint8array":"array",He.data);if(this.leftOver&&this.leftOver.length){if(L.uint8array){var De=Ve;(Ve=new Uint8Array(De.length+this.leftOver.length)).set(this.leftOver,0),Ve.set(De,this.leftOver.length)}else Ve=this.leftOver.concat(Ve);this.leftOver=null}var F=function(Y,ue){var Q;for((ue=ue||Y.length)>Y.length&&(ue=Y.length),Q=ue-1;0<=Q&&128==(192&Y[Q]);)Q--;return Q<0||0===Q?ue:Q+ot[Y[Q]]>ue?Q:ue}(Ve),J=Ve;F!==Ve.length&&(L.uint8array?(J=Ve.subarray(0,F),this.leftOver=Ve.subarray(F,Ve.length)):(J=Ve.slice(0,F),this.leftOver=Ve.slice(F,Ve.length))),this.push({data:Ee.utf8decode(J),meta:He.meta})},Ze.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:Ee.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},Ee.Utf8DecodeWorker=Ze,x.inherits(Re,ke),Re.prototype.processChunk=function(He){this.push({data:Ee.utf8encode(He.data),meta:He.meta})},Ee.Utf8EncodeWorker=Re},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(mt,Se,Ee){"use strict";var x=mt("./support"),L=mt("./base64"),ve=mt("./nodejsUtils"),ke=mt("./external");function ot(De){return De}function Ye(De,F){for(var J=0;J<De.length;++J)F[J]=255&De.charCodeAt(J);return F}mt("setimmediate"),Ee.newBlob=function(De,F){Ee.checkSupport("blob");try{return new Blob([De],{type:F})}catch{try{var J=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return J.append(De),J.getBlob(F)}catch{throw new Error("Bug : can't construct the Blob.")}}};var Ze={stringifyByChunk:function(De,F,J){var Y=[],ue=0,Q=De.length;if(Q<=J)return String.fromCharCode.apply(null,De);for(;ue<Q;)Y.push(String.fromCharCode.apply(null,"array"===F||"nodebuffer"===F?De.slice(ue,Math.min(ue+J,Q)):De.subarray(ue,Math.min(ue+J,Q)))),ue+=J;return Y.join("")},stringifyByChar:function(De){for(var F="",J=0;J<De.length;J++)F+=String.fromCharCode(De[J]);return F},applyCanBeUsed:{uint8array:function(){try{return x.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch{return!1}}(),nodebuffer:function(){try{return x.nodebuffer&&1===String.fromCharCode.apply(null,ve.allocBuffer(1)).length}catch{return!1}}()}};function Re(De){var F=65536,J=Ee.getTypeOf(De),Y=!0;if("uint8array"===J?Y=Ze.applyCanBeUsed.uint8array:"nodebuffer"===J&&(Y=Ze.applyCanBeUsed.nodebuffer),Y)for(;1<F;)try{return Ze.stringifyByChunk(De,J,F)}catch{F=Math.floor(F/2)}return Ze.stringifyByChar(De)}function He(De,F){for(var J=0;J<De.length;J++)F[J]=De[J];return F}Ee.applyFromCharCode=Re;var Ve={};Ve.string={string:ot,array:function(De){return Ye(De,new Array(De.length))},arraybuffer:function(De){return Ve.string.uint8array(De).buffer},uint8array:function(De){return Ye(De,new Uint8Array(De.length))},nodebuffer:function(De){return Ye(De,ve.allocBuffer(De.length))}},Ve.array={string:Re,array:ot,arraybuffer:function(De){return new Uint8Array(De).buffer},uint8array:function(De){return new Uint8Array(De)},nodebuffer:function(De){return ve.newBufferFrom(De)}},Ve.arraybuffer={string:function(De){return Re(new Uint8Array(De))},array:function(De){return He(new Uint8Array(De),new Array(De.byteLength))},arraybuffer:ot,uint8array:function(De){return new Uint8Array(De)},nodebuffer:function(De){return ve.newBufferFrom(new Uint8Array(De))}},Ve.uint8array={string:Re,array:function(De){return He(De,new Array(De.length))},arraybuffer:function(De){return De.buffer},uint8array:ot,nodebuffer:function(De){return ve.newBufferFrom(De)}},Ve.nodebuffer={string:Re,array:function(De){return He(De,new Array(De.length))},arraybuffer:function(De){return Ve.nodebuffer.uint8array(De).buffer},uint8array:function(De){return He(De,new Uint8Array(De.length))},nodebuffer:ot},Ee.transformTo=function(De,F){if(F=F||"",!De)return F;Ee.checkSupport(De);var J=Ee.getTypeOf(F);return Ve[J][De](F)},Ee.resolve=function(De){for(var F=De.split("/"),J=[],Y=0;Y<F.length;Y++){var ue=F[Y];"."===ue||""===ue&&0!==Y&&Y!==F.length-1||(".."===ue?J.pop():J.push(ue))}return J.join("/")},Ee.getTypeOf=function(De){return"string"==typeof De?"string":"[object Array]"===Object.prototype.toString.call(De)?"array":x.nodebuffer&&ve.isBuffer(De)?"nodebuffer":x.uint8array&&De instanceof Uint8Array?"uint8array":x.arraybuffer&&De instanceof ArrayBuffer?"arraybuffer":void 0},Ee.checkSupport=function(De){if(!x[De.toLowerCase()])throw new Error(De+" is not supported by this platform")},Ee.MAX_VALUE_16BITS=65535,Ee.MAX_VALUE_32BITS=-1,Ee.pretty=function(De){var F,J,Y="";for(J=0;J<(De||"").length;J++)Y+="\\x"+((F=De.charCodeAt(J))<16?"0":"")+F.toString(16).toUpperCase();return Y},Ee.delay=function(De,F,J){setImmediate(function(){De.apply(J||null,F||[])})},Ee.inherits=function(De,F){function J(){}J.prototype=F.prototype,De.prototype=new J},Ee.extend=function(){var De,F,J={};for(De=0;De<arguments.length;De++)for(F in arguments[De])Object.prototype.hasOwnProperty.call(arguments[De],F)&&void 0===J[F]&&(J[F]=arguments[De][F]);return J},Ee.prepareContent=function(De,F,J,Y,ue){return ke.Promise.resolve(F).then(function(Q){return x.blob&&(Q instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(Q)))&&typeof FileReader<"u"?new ke.Promise(function(me,X){var B=new FileReader;B.onload=function($){me($.target.result)},B.onerror=function($){X($.target.error)},B.readAsArrayBuffer(Q)}):Q}).then(function(Q){var X,me=Ee.getTypeOf(Q);return me?("arraybuffer"===me?Q=Ee.transformTo("uint8array",Q):"string"===me&&(ue?Q=L.decode(Q):J&&!0!==Y&&(Q=Ye(X=Q,x.uint8array?new Uint8Array(X.length):new Array(X.length)))),Q):ke.Promise.reject(new Error("Can't read the data of '"+De+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(mt,Se,Ee){"use strict";var x=mt("./reader/readerFor"),L=mt("./utils"),ve=mt("./signature"),ke=mt("./zipEntry"),ot=mt("./support");function Ye(Ze){this.files=[],this.loadOptions=Ze}Ye.prototype={checkSignature:function(Ze){if(!this.reader.readAndCheckSignature(Ze)){this.reader.index-=4;var Re=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+L.pretty(Re)+", expected "+L.pretty(Ze)+")")}},isSignature:function(Ze,Re){var He=this.reader.index;this.reader.setIndex(Ze);var Ve=this.reader.readString(4)===Re;return this.reader.setIndex(He),Ve},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var Ze=this.reader.readData(this.zipCommentLength),He=L.transformTo(ot.uint8array?"uint8array":"array",Ze);this.zipComment=this.loadOptions.decodeFileName(He)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var Ze,Re,He,Ve=this.zip64EndOfCentralSize-44;0<Ve;)Ze=this.reader.readInt(2),Re=this.reader.readInt(4),He=this.reader.readData(Re),this.zip64ExtensibleData[Ze]={id:Ze,length:Re,value:He}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var Ze,Re;for(Ze=0;Ze<this.files.length;Ze++)this.reader.setIndex((Re=this.files[Ze]).localHeaderOffset),this.checkSignature(ve.LOCAL_FILE_HEADER),Re.readLocalPart(this.reader),Re.handleUTF8(),Re.processAttributes()},readCentralDir:function(){var Ze;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(ve.CENTRAL_FILE_HEADER);)(Ze=new ke({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(Ze);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var Ze=this.reader.lastIndexOfSignature(ve.CENTRAL_DIRECTORY_END);if(Ze<0)throw this.isSignature(0,ve.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(Ze);var Re=Ze;if(this.checkSignature(ve.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===L.MAX_VALUE_16BITS||this.diskWithCentralDirStart===L.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===L.MAX_VALUE_16BITS||this.centralDirRecords===L.MAX_VALUE_16BITS||this.centralDirSize===L.MAX_VALUE_32BITS||this.centralDirOffset===L.MAX_VALUE_32BITS){if(this.zip64=!0,(Ze=this.reader.lastIndexOfSignature(ve.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(Ze),this.checkSignature(ve.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,ve.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(ve.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(ve.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var He=this.centralDirOffset+this.centralDirSize;this.zip64&&(He+=20,He+=12+this.zip64EndOfCentralSize);var Ve=Re-He;if(0<Ve)this.isSignature(Re,ve.CENTRAL_FILE_HEADER)||(this.reader.zero=Ve);else if(Ve<0)throw new Error("Corrupted zip: missing "+Math.abs(Ve)+" bytes.")},prepareReader:function(Ze){this.reader=x(Ze)},load:function(Ze){this.prepareReader(Ze),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},Se.exports=Ye},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(mt,Se,Ee){"use strict";var x=mt("./reader/readerFor"),L=mt("./utils"),ve=mt("./compressedObject"),ke=mt("./crc32"),ot=mt("./utf8"),Ye=mt("./compressions"),Ze=mt("./support");function Re(He,Ve){this.options=He,this.loadOptions=Ve}Re.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},readLocalPart:function(He){var Ve,De;if(He.skip(22),this.fileNameLength=He.readInt(2),De=He.readInt(2),this.fileName=He.readData(this.fileNameLength),He.skip(De),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(Ve=function(F){for(var J in Ye)if(Object.prototype.hasOwnProperty.call(Ye,J)&&Ye[J].magic===F)return Ye[J];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+L.pretty(this.compressionMethod)+" unknown (inner file : "+L.transformTo("string",this.fileName)+")");this.decompressed=new ve(this.compressedSize,this.uncompressedSize,this.crc32,Ve,He.readData(this.compressedSize))},readCentralPart:function(He){this.versionMadeBy=He.readInt(2),He.skip(2),this.bitFlag=He.readInt(2),this.compressionMethod=He.readString(2),this.date=He.readDate(),this.crc32=He.readInt(4),this.compressedSize=He.readInt(4),this.uncompressedSize=He.readInt(4);var Ve=He.readInt(2);if(this.extraFieldsLength=He.readInt(2),this.fileCommentLength=He.readInt(2),this.diskNumberStart=He.readInt(2),this.internalFileAttributes=He.readInt(2),this.externalFileAttributes=He.readInt(4),this.localHeaderOffset=He.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");He.skip(Ve),this.readExtraFields(He),this.parseZIP64ExtraField(He),this.fileComment=He.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var He=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==He&&(this.dosPermissions=63&this.externalFileAttributes),3==He&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var He=x(this.extraFields[1].value);this.uncompressedSize===L.MAX_VALUE_32BITS&&(this.uncompressedSize=He.readInt(8)),this.compressedSize===L.MAX_VALUE_32BITS&&(this.compressedSize=He.readInt(8)),this.localHeaderOffset===L.MAX_VALUE_32BITS&&(this.localHeaderOffset=He.readInt(8)),this.diskNumberStart===L.MAX_VALUE_32BITS&&(this.diskNumberStart=He.readInt(4))}},readExtraFields:function(He){var Ve,De,F,J=He.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});He.index+4<J;)Ve=He.readInt(2),De=He.readInt(2),F=He.readData(De),this.extraFields[Ve]={id:Ve,length:De,value:F};He.setIndex(J)},handleUTF8:function(){var He=Ze.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=ot.utf8decode(this.fileName),this.fileCommentStr=ot.utf8decode(this.fileComment);else{var Ve=this.findExtraFieldUnicodePath();if(null!==Ve)this.fileNameStr=Ve;else{var De=L.transformTo(He,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(De)}var F=this.findExtraFieldUnicodeComment();if(null!==F)this.fileCommentStr=F;else{var J=L.transformTo(He,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(J)}}},findExtraFieldUnicodePath:function(){var He=this.extraFields[28789];if(He){var Ve=x(He.value);return 1!==Ve.readInt(1)||ke(this.fileName)!==Ve.readInt(4)?null:ot.utf8decode(Ve.readData(He.length-5))}return null},findExtraFieldUnicodeComment:function(){var He=this.extraFields[25461];if(He){var Ve=x(He.value);return 1!==Ve.readInt(1)||ke(this.fileComment)!==Ve.readInt(4)?null:ot.utf8decode(Ve.readData(He.length-5))}return null}},Se.exports=Re},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(mt,Se,Ee){"use strict";function x(Ve,De,F){this.name=Ve,this.dir=F.dir,this.date=F.date,this.comment=F.comment,this.unixPermissions=F.unixPermissions,this.dosPermissions=F.dosPermissions,this._data=De,this._dataBinary=F.binary,this.options={compression:F.compression,compressionOptions:F.compressionOptions}}var L=mt("./stream/StreamHelper"),ve=mt("./stream/DataWorker"),ke=mt("./utf8"),ot=mt("./compressedObject"),Ye=mt("./stream/GenericWorker");x.prototype={internalStream:function(Ve){var De=null,F="string";try{if(!Ve)throw new Error("No output type specified.");var J="string"===(F=Ve.toLowerCase())||"text"===F;"binarystring"!==F&&"text"!==F||(F="string"),De=this._decompressWorker();var Y=!this._dataBinary;Y&&!J&&(De=De.pipe(new ke.Utf8EncodeWorker)),!Y&&J&&(De=De.pipe(new ke.Utf8DecodeWorker))}catch(ue){(De=new Ye("error")).error(ue)}return new L(De,F,"")},async:function(Ve,De){return this.internalStream(Ve).accumulate(De)},nodeStream:function(Ve,De){return this.internalStream(Ve||"nodebuffer").toNodejsStream(De)},_compressWorker:function(Ve,De){if(this._data instanceof ot&&this._data.compression.magic===Ve.magic)return this._data.getCompressedWorker();var F=this._decompressWorker();return this._dataBinary||(F=F.pipe(new ke.Utf8EncodeWorker)),ot.createWorkerFrom(F,Ve,De)},_decompressWorker:function(){return this._data instanceof ot?this._data.getContentWorker():this._data instanceof Ye?this._data:new ve(this._data)}};for(var Ze=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],Re=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},He=0;He<Ze.length;He++)x.prototype[Ze[He]]=Re;Se.exports=x},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(mt,Se,Ee){(function(x){"use strict";var L,ve,ke=x.MutationObserver||x.WebKitMutationObserver;if(ke){var ot=0,Ye=new ke(Ve),Ze=x.document.createTextNode("");Ye.observe(Ze,{characterData:!0}),L=function(){Ze.data=ot=++ot%2}}else if(x.setImmediate||void 0===x.MessageChannel)L="document"in x&&"onreadystatechange"in x.document.createElement("script")?function(){var De=x.document.createElement("script");De.onreadystatechange=function(){Ve(),De.onreadystatechange=null,De.parentNode.removeChild(De),De=null},x.document.documentElement.appendChild(De)}:function(){setTimeout(Ve,0)};else{var Re=new x.MessageChannel;Re.port1.onmessage=Ve,L=function(){Re.port2.postMessage(0)}}var He=[];function Ve(){var De,F;ve=!0;for(var J=He.length;J;){for(F=He,He=[],De=-1;++De<J;)F[De]();J=He.length}ve=!1}Se.exports=function(De){1!==He.push(De)||ve||L()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(mt,Se,Ee){"use strict";var x=mt("immediate");function L(){}var ve={},ke=["REJECTED"],ot=["FULFILLED"],Ye=["PENDING"];function Ze(J){if("function"!=typeof J)throw new TypeError("resolver must be a function");this.state=Ye,this.queue=[],this.outcome=void 0,J!==L&&De(this,J)}function Re(J,Y,ue){this.promise=J,"function"==typeof Y&&(this.onFulfilled=Y,this.callFulfilled=this.otherCallFulfilled),"function"==typeof ue&&(this.onRejected=ue,this.callRejected=this.otherCallRejected)}function He(J,Y,ue){x(function(){var Q;try{Q=Y(ue)}catch(me){return ve.reject(J,me)}Q===J?ve.reject(J,new TypeError("Cannot resolve promise with itself")):ve.resolve(J,Q)})}function Ve(J){var Y=J&&J.then;if(J&&("object"==typeof J||"function"==typeof J)&&"function"==typeof Y)return function(){Y.apply(J,arguments)}}function De(J,Y){var ue=!1;function Q(B){ue||(ue=!0,ve.reject(J,B))}function me(B){ue||(ue=!0,ve.resolve(J,B))}var X=F(function(){Y(me,Q)});"error"===X.status&&Q(X.value)}function F(J,Y){var ue={};try{ue.value=J(Y),ue.status="success"}catch(Q){ue.status="error",ue.value=Q}return ue}(Se.exports=Ze).prototype.finally=function(J){if("function"!=typeof J)return this;var Y=this.constructor;return this.then(function(ue){return Y.resolve(J()).then(function(){return ue})},function(ue){return Y.resolve(J()).then(function(){throw ue})})},Ze.prototype.catch=function(J){return this.then(null,J)},Ze.prototype.then=function(J,Y){if("function"!=typeof J&&this.state===ot||"function"!=typeof Y&&this.state===ke)return this;var ue=new this.constructor(L);return this.state!==Ye?He(ue,this.state===ot?J:Y,this.outcome):this.queue.push(new Re(ue,J,Y)),ue},Re.prototype.callFulfilled=function(J){ve.resolve(this.promise,J)},Re.prototype.otherCallFulfilled=function(J){He(this.promise,this.onFulfilled,J)},Re.prototype.callRejected=function(J){ve.reject(this.promise,J)},Re.prototype.otherCallRejected=function(J){He(this.promise,this.onRejected,J)},ve.resolve=function(J,Y){var ue=F(Ve,Y);if("error"===ue.status)return ve.reject(J,ue.value);var Q=ue.value;if(Q)De(J,Q);else{J.state=ot,J.outcome=Y;for(var me=-1,X=J.queue.length;++me<X;)J.queue[me].callFulfilled(Y)}return J},ve.reject=function(J,Y){J.state=ke,J.outcome=Y;for(var ue=-1,Q=J.queue.length;++ue<Q;)J.queue[ue].callRejected(Y);return J},Ze.resolve=function(J){return J instanceof this?J:ve.resolve(new this(L),J)},Ze.reject=function(J){var Y=new this(L);return ve.reject(Y,J)},Ze.all=function(J){var Y=this;if("[object Array]"!==Object.prototype.toString.call(J))return this.reject(new TypeError("must be an array"));var ue=J.length,Q=!1;if(!ue)return this.resolve([]);for(var me=new Array(ue),X=0,B=-1,$=new this(L);++B<ue;)A(J[B],B);return $;function A(E,g){Y.resolve(E).then(function(v){me[g]=v,++X!==ue||Q||(Q=!0,ve.resolve($,me))},function(v){Q||(Q=!0,ve.reject($,v))})}},Ze.race=function(J){if("[object Array]"!==Object.prototype.toString.call(J))return this.reject(new TypeError("must be an array"));var ue=J.length,Q=!1;if(!ue)return this.resolve([]);for(var me=-1,X=new this(L);++me<ue;)this.resolve(J[me]).then(function($){Q||(Q=!0,ve.resolve(X,$))},function($){Q||(Q=!0,ve.reject(X,$))});return X}},{immediate:36}],38:[function(mt,Se,Ee){"use strict";var x={};(0,mt("./lib/utils/common").assign)(x,mt("./lib/deflate"),mt("./lib/inflate"),mt("./lib/zlib/constants")),Se.exports=x},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(mt,Se,Ee){"use strict";var x=mt("./zlib/deflate"),L=mt("./utils/common"),ve=mt("./utils/strings"),ke=mt("./zlib/messages"),ot=mt("./zlib/zstream"),Ye=Object.prototype.toString,Ze=0,Re=-1,He=0,Ve=8;function De(J){if(!(this instanceof De))return new De(J);this.options=L.assign({level:Re,method:Ve,chunkSize:16384,windowBits:15,memLevel:8,strategy:He,to:""},J||{});var Y=this.options;Y.raw&&0<Y.windowBits?Y.windowBits=-Y.windowBits:Y.gzip&&0<Y.windowBits&&Y.windowBits<16&&(Y.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ot,this.strm.avail_out=0;var ue=x.deflateInit2(this.strm,Y.level,Y.method,Y.windowBits,Y.memLevel,Y.strategy);if(ue!==Ze)throw new Error(ke[ue]);if(Y.header&&x.deflateSetHeader(this.strm,Y.header),Y.dictionary){var Q;if(Q="string"==typeof Y.dictionary?ve.string2buf(Y.dictionary):"[object ArrayBuffer]"===Ye.call(Y.dictionary)?new Uint8Array(Y.dictionary):Y.dictionary,(ue=x.deflateSetDictionary(this.strm,Q))!==Ze)throw new Error(ke[ue]);this._dict_set=!0}}function F(J,Y){var ue=new De(Y);if(ue.push(J,!0),ue.err)throw ue.msg||ke[ue.err];return ue.result}De.prototype.push=function(J,Y){var ue,Q,me=this.strm,X=this.options.chunkSize;if(this.ended)return!1;Q=Y===~~Y?Y:!0===Y?4:0,me.input="string"==typeof J?ve.string2buf(J):"[object ArrayBuffer]"===Ye.call(J)?new Uint8Array(J):J,me.next_in=0,me.avail_in=me.input.length;do{if(0===me.avail_out&&(me.output=new L.Buf8(X),me.next_out=0,me.avail_out=X),1!==(ue=x.deflate(me,Q))&&ue!==Ze)return this.onEnd(ue),!(this.ended=!0);0!==me.avail_out&&(0!==me.avail_in||4!==Q&&2!==Q)||this.onData("string"===this.options.to?ve.buf2binstring(L.shrinkBuf(me.output,me.next_out)):L.shrinkBuf(me.output,me.next_out))}while((0<me.avail_in||0===me.avail_out)&&1!==ue);return 4===Q?(ue=x.deflateEnd(this.strm),this.onEnd(ue),this.ended=!0,ue===Ze):2!==Q||(this.onEnd(Ze),!(me.avail_out=0))},De.prototype.onData=function(J){this.chunks.push(J)},De.prototype.onEnd=function(J){J===Ze&&(this.result="string"===this.options.to?this.chunks.join(""):L.flattenChunks(this.chunks)),this.chunks=[],this.err=J,this.msg=this.strm.msg},Ee.Deflate=De,Ee.deflate=F,Ee.deflateRaw=function(J,Y){return(Y=Y||{}).raw=!0,F(J,Y)},Ee.gzip=function(J,Y){return(Y=Y||{}).gzip=!0,F(J,Y)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(mt,Se,Ee){"use strict";var x=mt("./zlib/inflate"),L=mt("./utils/common"),ve=mt("./utils/strings"),ke=mt("./zlib/constants"),ot=mt("./zlib/messages"),Ye=mt("./zlib/zstream"),Ze=mt("./zlib/gzheader"),Re=Object.prototype.toString;function He(De){if(!(this instanceof He))return new He(De);this.options=L.assign({chunkSize:16384,windowBits:0,to:""},De||{});var F=this.options;F.raw&&0<=F.windowBits&&F.windowBits<16&&(F.windowBits=-F.windowBits,0===F.windowBits&&(F.windowBits=-15)),!(0<=F.windowBits&&F.windowBits<16)||De&&De.windowBits||(F.windowBits+=32),15<F.windowBits&&F.windowBits<48&&!(15&F.windowBits)&&(F.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ye,this.strm.avail_out=0;var J=x.inflateInit2(this.strm,F.windowBits);if(J!==ke.Z_OK)throw new Error(ot[J]);this.header=new Ze,x.inflateGetHeader(this.strm,this.header)}function Ve(De,F){var J=new He(F);if(J.push(De,!0),J.err)throw J.msg||ot[J.err];return J.result}He.prototype.push=function(De,F){var J,Y,ue,Q,me,X,B=this.strm,$=this.options.chunkSize,A=this.options.dictionary,E=!1;if(this.ended)return!1;Y=F===~~F?F:!0===F?ke.Z_FINISH:ke.Z_NO_FLUSH,B.input="string"==typeof De?ve.binstring2buf(De):"[object ArrayBuffer]"===Re.call(De)?new Uint8Array(De):De,B.next_in=0,B.avail_in=B.input.length;do{if(0===B.avail_out&&(B.output=new L.Buf8($),B.next_out=0,B.avail_out=$),(J=x.inflate(B,ke.Z_NO_FLUSH))===ke.Z_NEED_DICT&&A&&(X="string"==typeof A?ve.string2buf(A):"[object ArrayBuffer]"===Re.call(A)?new Uint8Array(A):A,J=x.inflateSetDictionary(this.strm,X)),J===ke.Z_BUF_ERROR&&!0===E&&(J=ke.Z_OK,E=!1),J!==ke.Z_STREAM_END&&J!==ke.Z_OK)return this.onEnd(J),!(this.ended=!0);B.next_out&&(0!==B.avail_out&&J!==ke.Z_STREAM_END&&(0!==B.avail_in||Y!==ke.Z_FINISH&&Y!==ke.Z_SYNC_FLUSH)||("string"===this.options.to?(ue=ve.utf8border(B.output,B.next_out),Q=B.next_out-ue,me=ve.buf2string(B.output,ue),B.next_out=Q,B.avail_out=$-Q,Q&&L.arraySet(B.output,B.output,ue,Q,0),this.onData(me)):this.onData(L.shrinkBuf(B.output,B.next_out)))),0===B.avail_in&&0===B.avail_out&&(E=!0)}while((0<B.avail_in||0===B.avail_out)&&J!==ke.Z_STREAM_END);return J===ke.Z_STREAM_END&&(Y=ke.Z_FINISH),Y===ke.Z_FINISH?(J=x.inflateEnd(this.strm),this.onEnd(J),this.ended=!0,J===ke.Z_OK):Y!==ke.Z_SYNC_FLUSH||(this.onEnd(ke.Z_OK),!(B.avail_out=0))},He.prototype.onData=function(De){this.chunks.push(De)},He.prototype.onEnd=function(De){De===ke.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):L.flattenChunks(this.chunks)),this.chunks=[],this.err=De,this.msg=this.strm.msg},Ee.Inflate=He,Ee.inflate=Ve,Ee.inflateRaw=function(De,F){return(F=F||{}).raw=!0,Ve(De,F)},Ee.ungzip=Ve},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(mt,Se,Ee){"use strict";var x=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";Ee.assign=function(ke){for(var ot=Array.prototype.slice.call(arguments,1);ot.length;){var Ye=ot.shift();if(Ye){if("object"!=typeof Ye)throw new TypeError(Ye+"must be non-object");for(var Ze in Ye)Ye.hasOwnProperty(Ze)&&(ke[Ze]=Ye[Ze])}}return ke},Ee.shrinkBuf=function(ke,ot){return ke.length===ot?ke:ke.subarray?ke.subarray(0,ot):(ke.length=ot,ke)};var L={arraySet:function(ke,ot,Ye,Ze,Re){if(ot.subarray&&ke.subarray)ke.set(ot.subarray(Ye,Ye+Ze),Re);else for(var He=0;He<Ze;He++)ke[Re+He]=ot[Ye+He]},flattenChunks:function(ke){var ot,Ye,Ze,Re,He,Ve;for(ot=Ze=0,Ye=ke.length;ot<Ye;ot++)Ze+=ke[ot].length;for(Ve=new Uint8Array(Ze),ot=Re=0,Ye=ke.length;ot<Ye;ot++)Ve.set(He=ke[ot],Re),Re+=He.length;return Ve}},ve={arraySet:function(ke,ot,Ye,Ze,Re){for(var He=0;He<Ze;He++)ke[Re+He]=ot[Ye+He]},flattenChunks:function(ke){return[].concat.apply([],ke)}};Ee.setTyped=function(ke){ke?(Ee.Buf8=Uint8Array,Ee.Buf16=Uint16Array,Ee.Buf32=Int32Array,Ee.assign(Ee,L)):(Ee.Buf8=Array,Ee.Buf16=Array,Ee.Buf32=Array,Ee.assign(Ee,ve))},Ee.setTyped(x)},{}],42:[function(mt,Se,Ee){"use strict";var x=mt("./common"),L=!0,ve=!0;try{String.fromCharCode.apply(null,[0])}catch{L=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{ve=!1}for(var ke=new x.Buf8(256),ot=0;ot<256;ot++)ke[ot]=252<=ot?6:248<=ot?5:240<=ot?4:224<=ot?3:192<=ot?2:1;function Ye(Ze,Re){if(Re<65537&&(Ze.subarray&&ve||!Ze.subarray&&L))return String.fromCharCode.apply(null,x.shrinkBuf(Ze,Re));for(var He="",Ve=0;Ve<Re;Ve++)He+=String.fromCharCode(Ze[Ve]);return He}ke[254]=ke[254]=1,Ee.string2buf=function(Ze){var Re,He,Ve,De,F,J=Ze.length,Y=0;for(De=0;De<J;De++)55296==(64512&(He=Ze.charCodeAt(De)))&&De+1<J&&56320==(64512&(Ve=Ze.charCodeAt(De+1)))&&(He=65536+(He-55296<<10)+(Ve-56320),De++),Y+=He<128?1:He<2048?2:He<65536?3:4;for(Re=new x.Buf8(Y),De=F=0;F<Y;De++)55296==(64512&(He=Ze.charCodeAt(De)))&&De+1<J&&56320==(64512&(Ve=Ze.charCodeAt(De+1)))&&(He=65536+(He-55296<<10)+(Ve-56320),De++),He<128?Re[F++]=He:(He<2048?Re[F++]=192|He>>>6:(He<65536?Re[F++]=224|He>>>12:(Re[F++]=240|He>>>18,Re[F++]=128|He>>>12&63),Re[F++]=128|He>>>6&63),Re[F++]=128|63&He);return Re},Ee.buf2binstring=function(Ze){return Ye(Ze,Ze.length)},Ee.binstring2buf=function(Ze){for(var Re=new x.Buf8(Ze.length),He=0,Ve=Re.length;He<Ve;He++)Re[He]=Ze.charCodeAt(He);return Re},Ee.buf2string=function(Ze,Re){var He,Ve,De,F,J=Re||Ze.length,Y=new Array(2*J);for(He=Ve=0;He<J;)if((De=Ze[He++])<128)Y[Ve++]=De;else if(4<(F=ke[De]))Y[Ve++]=65533,He+=F-1;else{for(De&=2===F?31:3===F?15:7;1<F&&He<J;)De=De<<6|63&Ze[He++],F--;1<F?Y[Ve++]=65533:De<65536?Y[Ve++]=De:(Y[Ve++]=55296|(De-=65536)>>10&1023,Y[Ve++]=56320|1023&De)}return Ye(Y,Ve)},Ee.utf8border=function(Ze,Re){var He;for((Re=Re||Ze.length)>Ze.length&&(Re=Ze.length),He=Re-1;0<=He&&128==(192&Ze[He]);)He--;return He<0||0===He?Re:He+ke[Ze[He]]>Re?He:Re}},{"./common":41}],43:[function(mt,Se,Ee){"use strict";Se.exports=function(x,L,ve,ke){for(var ot=65535&x,Ye=x>>>16&65535,Ze=0;0!==ve;){for(ve-=Ze=2e3<ve?2e3:ve;Ye=Ye+(ot=ot+L[ke++]|0)|0,--Ze;);ot%=65521,Ye%=65521}return ot|Ye<<16}},{}],44:[function(mt,Se,Ee){"use strict";Se.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(mt,Se,Ee){"use strict";var x=function(){for(var L,ve=[],ke=0;ke<256;ke++){L=ke;for(var ot=0;ot<8;ot++)L=1&L?3988292384^L>>>1:L>>>1;ve[ke]=L}return ve}();Se.exports=function(L,ve,ke,ot){var Ye=x,Ze=ot+ke;L^=-1;for(var Re=ot;Re<Ze;Re++)L=L>>>8^Ye[255&(L^ve[Re])];return~L}},{}],46:[function(mt,Se,Ee){"use strict";var x,L=mt("../utils/common"),ve=mt("./trees"),ke=mt("./adler32"),ot=mt("./crc32"),Ye=mt("./messages"),Ze=0,He=0,Ve=-2,J=2,Y=8,Q=286,me=30,X=19,B=2*Q+1,$=15,A=3,E=258,g=E+A+1,v=42,f=113;function Z(te,Je){return te.msg=Ye[Je],Je}function ee(te){return(te<<1)-(4<te?9:0)}function he(te){for(var Je=te.length;0<=--Je;)te[Je]=0}function G(te){var Je=te.state,tt=Je.pending;tt>te.avail_out&&(tt=te.avail_out),0!==tt&&(L.arraySet(te.output,Je.pending_buf,Je.pending_out,tt,te.next_out),te.next_out+=tt,Je.pending_out+=tt,te.total_out+=tt,te.avail_out-=tt,Je.pending-=tt,0===Je.pending&&(Je.pending_out=0))}function b(te,Je){ve._tr_flush_block(te,0<=te.block_start?te.block_start:-1,te.strstart-te.block_start,Je),te.block_start=te.strstart,G(te.strm)}function P(te,Je){te.pending_buf[te.pending++]=Je}function T(te,Je){te.pending_buf[te.pending++]=Je>>>8&255,te.pending_buf[te.pending++]=255&Je}function z(te,Je){var tt,Fe,Ne=te.max_chain_length,rt=te.strstart,St=te.prev_length,pt=te.nice_match,st=te.strstart>te.w_size-g?te.strstart-(te.w_size-g):0,vt=te.window,Yt=te.w_mask,qt=te.prev,Ot=te.strstart+E,Bn=vt[rt+St-1],Mn=vt[rt+St];te.prev_length>=te.good_match&&(Ne>>=2),pt>te.lookahead&&(pt=te.lookahead);do{if(vt[(tt=Je)+St]===Mn&&vt[tt+St-1]===Bn&&vt[tt]===vt[rt]&&vt[++tt]===vt[rt+1]){rt+=2,tt++;do{}while(vt[++rt]===vt[++tt]&&vt[++rt]===vt[++tt]&&vt[++rt]===vt[++tt]&&vt[++rt]===vt[++tt]&&vt[++rt]===vt[++tt]&&vt[++rt]===vt[++tt]&&vt[++rt]===vt[++tt]&&vt[++rt]===vt[++tt]&&rt<Ot);if(Fe=E-(Ot-rt),rt=Ot-E,St<Fe){if(te.match_start=Je,pt<=(St=Fe))break;Bn=vt[rt+St-1],Mn=vt[rt+St]}}}while((Je=qt[Je&Yt])>st&&0!=--Ne);return St<=te.lookahead?St:te.lookahead}function W(te){var Je,tt,Fe,Ne,rt,St,pt,st,vt,Yt,qt=te.w_size;do{if(Ne=te.window_size-te.lookahead-te.strstart,te.strstart>=qt+(qt-g)){for(L.arraySet(te.window,te.window,qt,qt,0),te.match_start-=qt,te.strstart-=qt,te.block_start-=qt,Je=tt=te.hash_size;Fe=te.head[--Je],te.head[Je]=qt<=Fe?Fe-qt:0,--tt;);for(Je=tt=qt;Fe=te.prev[--Je],te.prev[Je]=qt<=Fe?Fe-qt:0,--tt;);Ne+=qt}if(0===te.strm.avail_in)break;if(pt=te.window,st=te.strstart+te.lookahead,Yt=void 0,(vt=Ne)<(Yt=(St=te.strm).avail_in)&&(Yt=vt),tt=0===Yt?0:(St.avail_in-=Yt,L.arraySet(pt,St.input,St.next_in,Yt,st),1===St.state.wrap?St.adler=ke(St.adler,pt,Yt,st):2===St.state.wrap&&(St.adler=ot(St.adler,pt,Yt,st)),St.next_in+=Yt,St.total_in+=Yt,Yt),te.lookahead+=tt,te.lookahead+te.insert>=A)for(te.ins_h=te.window[rt=te.strstart-te.insert],te.ins_h=(te.ins_h<<te.hash_shift^te.window[rt+1])&te.hash_mask;te.insert&&(te.ins_h=(te.ins_h<<te.hash_shift^te.window[rt+A-1])&te.hash_mask,te.prev[rt&te.w_mask]=te.head[te.ins_h],te.head[te.ins_h]=rt,rt++,te.insert--,!(te.lookahead+te.insert<A)););}while(te.lookahead<g&&0!==te.strm.avail_in)}function fe(te,Je){for(var tt,Fe;;){if(te.lookahead<g){if(W(te),te.lookahead<g&&Je===Ze)return 1;if(0===te.lookahead)break}if(tt=0,te.lookahead>=A&&(te.ins_h=(te.ins_h<<te.hash_shift^te.window[te.strstart+A-1])&te.hash_mask,tt=te.prev[te.strstart&te.w_mask]=te.head[te.ins_h],te.head[te.ins_h]=te.strstart),0!==tt&&te.strstart-tt<=te.w_size-g&&(te.match_length=z(te,tt)),te.match_length>=A)if(Fe=ve._tr_tally(te,te.strstart-te.match_start,te.match_length-A),te.lookahead-=te.match_length,te.match_length<=te.max_lazy_match&&te.lookahead>=A){for(te.match_length--;te.strstart++,te.ins_h=(te.ins_h<<te.hash_shift^te.window[te.strstart+A-1])&te.hash_mask,tt=te.prev[te.strstart&te.w_mask]=te.head[te.ins_h],te.head[te.ins_h]=te.strstart,0!=--te.match_length;);te.strstart++}else te.strstart+=te.match_length,te.match_length=0,te.ins_h=te.window[te.strstart],te.ins_h=(te.ins_h<<te.hash_shift^te.window[te.strstart+1])&te.hash_mask;else Fe=ve._tr_tally(te,0,te.window[te.strstart]),te.lookahead--,te.strstart++;if(Fe&&(b(te,!1),0===te.strm.avail_out))return 1}return te.insert=te.strstart<A-1?te.strstart:A-1,4===Je?(b(te,!0),0===te.strm.avail_out?3:4):te.last_lit&&(b(te,!1),0===te.strm.avail_out)?1:2}function we(te,Je){for(var tt,Fe,Ne;;){if(te.lookahead<g){if(W(te),te.lookahead<g&&Je===Ze)return 1;if(0===te.lookahead)break}if(tt=0,te.lookahead>=A&&(te.ins_h=(te.ins_h<<te.hash_shift^te.window[te.strstart+A-1])&te.hash_mask,tt=te.prev[te.strstart&te.w_mask]=te.head[te.ins_h],te.head[te.ins_h]=te.strstart),te.prev_length=te.match_length,te.prev_match=te.match_start,te.match_length=A-1,0!==tt&&te.prev_length<te.max_lazy_match&&te.strstart-tt<=te.w_size-g&&(te.match_length=z(te,tt),te.match_length<=5&&(1===te.strategy||te.match_length===A&&4096<te.strstart-te.match_start)&&(te.match_length=A-1)),te.prev_length>=A&&te.match_length<=te.prev_length){for(Ne=te.strstart+te.lookahead-A,Fe=ve._tr_tally(te,te.strstart-1-te.prev_match,te.prev_length-A),te.lookahead-=te.prev_length-1,te.prev_length-=2;++te.strstart<=Ne&&(te.ins_h=(te.ins_h<<te.hash_shift^te.window[te.strstart+A-1])&te.hash_mask,tt=te.prev[te.strstart&te.w_mask]=te.head[te.ins_h],te.head[te.ins_h]=te.strstart),0!=--te.prev_length;);if(te.match_available=0,te.match_length=A-1,te.strstart++,Fe&&(b(te,!1),0===te.strm.avail_out))return 1}else if(te.match_available){if((Fe=ve._tr_tally(te,0,te.window[te.strstart-1]))&&b(te,!1),te.strstart++,te.lookahead--,0===te.strm.avail_out)return 1}else te.match_available=1,te.strstart++,te.lookahead--}return te.match_available&&(Fe=ve._tr_tally(te,0,te.window[te.strstart-1]),te.match_available=0),te.insert=te.strstart<A-1?te.strstart:A-1,4===Je?(b(te,!0),0===te.strm.avail_out?3:4):te.last_lit&&(b(te,!1),0===te.strm.avail_out)?1:2}function Me(te,Je,tt,Fe,Ne){this.good_length=te,this.max_lazy=Je,this.nice_length=tt,this.max_chain=Fe,this.func=Ne}function je(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new L.Buf16(2*B),this.dyn_dtree=new L.Buf16(2*(2*me+1)),this.bl_tree=new L.Buf16(2*(2*X+1)),he(this.dyn_ltree),he(this.dyn_dtree),he(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new L.Buf16($+1),this.heap=new L.Buf16(2*Q+1),he(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new L.Buf16(2*Q+1),he(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Ge(te){var Je;return te&&te.state?(te.total_in=te.total_out=0,te.data_type=J,(Je=te.state).pending=0,Je.pending_out=0,Je.wrap<0&&(Je.wrap=-Je.wrap),Je.status=Je.wrap?v:f,te.adler=2===Je.wrap?0:1,Je.last_flush=Ze,ve._tr_init(Je),He):Z(te,Ve)}function lt(te){var tt,Je=Ge(te);return Je===He&&((tt=te.state).window_size=2*tt.w_size,he(tt.head),tt.max_lazy_match=x[tt.level].max_lazy,tt.good_match=x[tt.level].good_length,tt.nice_match=x[tt.level].nice_length,tt.max_chain_length=x[tt.level].max_chain,tt.strstart=0,tt.block_start=0,tt.lookahead=0,tt.insert=0,tt.match_length=tt.prev_length=A-1,tt.match_available=0,tt.ins_h=0),Je}function bt(te,Je,tt,Fe,Ne,rt){if(!te)return Ve;var St=1;if(-1===Je&&(Je=6),Fe<0?(St=0,Fe=-Fe):15<Fe&&(St=2,Fe-=16),Ne<1||9<Ne||tt!==Y||Fe<8||15<Fe||Je<0||9<Je||rt<0||4<rt)return Z(te,Ve);8===Fe&&(Fe=9);var pt=new je;return(te.state=pt).strm=te,pt.wrap=St,pt.gzhead=null,pt.w_bits=Fe,pt.w_size=1<<pt.w_bits,pt.w_mask=pt.w_size-1,pt.hash_bits=Ne+7,pt.hash_size=1<<pt.hash_bits,pt.hash_mask=pt.hash_size-1,pt.hash_shift=~~((pt.hash_bits+A-1)/A),pt.window=new L.Buf8(2*pt.w_size),pt.head=new L.Buf16(pt.hash_size),pt.prev=new L.Buf16(pt.w_size),pt.lit_bufsize=1<<Ne+6,pt.pending_buf_size=4*pt.lit_bufsize,pt.pending_buf=new L.Buf8(pt.pending_buf_size),pt.d_buf=1*pt.lit_bufsize,pt.l_buf=3*pt.lit_bufsize,pt.level=Je,pt.strategy=rt,pt.method=tt,lt(te)}x=[new Me(0,0,0,0,function(te,Je){var tt=65535;for(tt>te.pending_buf_size-5&&(tt=te.pending_buf_size-5);;){if(te.lookahead<=1){if(W(te),0===te.lookahead&&Je===Ze)return 1;if(0===te.lookahead)break}te.strstart+=te.lookahead,te.lookahead=0;var Fe=te.block_start+tt;if((0===te.strstart||te.strstart>=Fe)&&(te.lookahead=te.strstart-Fe,te.strstart=Fe,b(te,!1),0===te.strm.avail_out)||te.strstart-te.block_start>=te.w_size-g&&(b(te,!1),0===te.strm.avail_out))return 1}return te.insert=0,4===Je?(b(te,!0),0===te.strm.avail_out?3:4):(te.strstart>te.block_start&&b(te,!1),1)}),new Me(4,4,8,4,fe),new Me(4,5,16,8,fe),new Me(4,6,32,32,fe),new Me(4,4,16,16,we),new Me(8,16,32,32,we),new Me(8,16,128,128,we),new Me(8,32,128,256,we),new Me(32,128,258,1024,we),new Me(32,258,258,4096,we)],Ee.deflateInit=function(te,Je){return bt(te,Je,Y,15,8,0)},Ee.deflateInit2=bt,Ee.deflateReset=lt,Ee.deflateResetKeep=Ge,Ee.deflateSetHeader=function(te,Je){return te&&te.state?2!==te.state.wrap?Ve:(te.state.gzhead=Je,He):Ve},Ee.deflate=function(te,Je){var tt,Fe,Ne,rt;if(!te||!te.state||5<Je||Je<0)return te?Z(te,Ve):Ve;if(Fe=te.state,!te.output||!te.input&&0!==te.avail_in||666===Fe.status&&4!==Je)return Z(te,0===te.avail_out?-5:Ve);if(Fe.strm=te,tt=Fe.last_flush,Fe.last_flush=Je,Fe.status===v)if(2===Fe.wrap)te.adler=0,P(Fe,31),P(Fe,139),P(Fe,8),Fe.gzhead?(P(Fe,(Fe.gzhead.text?1:0)+(Fe.gzhead.hcrc?2:0)+(Fe.gzhead.extra?4:0)+(Fe.gzhead.name?8:0)+(Fe.gzhead.comment?16:0)),P(Fe,255&Fe.gzhead.time),P(Fe,Fe.gzhead.time>>8&255),P(Fe,Fe.gzhead.time>>16&255),P(Fe,Fe.gzhead.time>>24&255),P(Fe,9===Fe.level?2:2<=Fe.strategy||Fe.level<2?4:0),P(Fe,255&Fe.gzhead.os),Fe.gzhead.extra&&Fe.gzhead.extra.length&&(P(Fe,255&Fe.gzhead.extra.length),P(Fe,Fe.gzhead.extra.length>>8&255)),Fe.gzhead.hcrc&&(te.adler=ot(te.adler,Fe.pending_buf,Fe.pending,0)),Fe.gzindex=0,Fe.status=69):(P(Fe,0),P(Fe,0),P(Fe,0),P(Fe,0),P(Fe,0),P(Fe,9===Fe.level?2:2<=Fe.strategy||Fe.level<2?4:0),P(Fe,3),Fe.status=f);else{var St=Y+(Fe.w_bits-8<<4)<<8;St|=(2<=Fe.strategy||Fe.level<2?0:Fe.level<6?1:6===Fe.level?2:3)<<6,0!==Fe.strstart&&(St|=32),St+=31-St%31,Fe.status=f,T(Fe,St),0!==Fe.strstart&&(T(Fe,te.adler>>>16),T(Fe,65535&te.adler)),te.adler=1}if(69===Fe.status)if(Fe.gzhead.extra){for(Ne=Fe.pending;Fe.gzindex<(65535&Fe.gzhead.extra.length)&&(Fe.pending!==Fe.pending_buf_size||(Fe.gzhead.hcrc&&Fe.pending>Ne&&(te.adler=ot(te.adler,Fe.pending_buf,Fe.pending-Ne,Ne)),G(te),Ne=Fe.pending,Fe.pending!==Fe.pending_buf_size));)P(Fe,255&Fe.gzhead.extra[Fe.gzindex]),Fe.gzindex++;Fe.gzhead.hcrc&&Fe.pending>Ne&&(te.adler=ot(te.adler,Fe.pending_buf,Fe.pending-Ne,Ne)),Fe.gzindex===Fe.gzhead.extra.length&&(Fe.gzindex=0,Fe.status=73)}else Fe.status=73;if(73===Fe.status)if(Fe.gzhead.name){Ne=Fe.pending;do{if(Fe.pending===Fe.pending_buf_size&&(Fe.gzhead.hcrc&&Fe.pending>Ne&&(te.adler=ot(te.adler,Fe.pending_buf,Fe.pending-Ne,Ne)),G(te),Ne=Fe.pending,Fe.pending===Fe.pending_buf_size)){rt=1;break}rt=Fe.gzindex<Fe.gzhead.name.length?255&Fe.gzhead.name.charCodeAt(Fe.gzindex++):0,P(Fe,rt)}while(0!==rt);Fe.gzhead.hcrc&&Fe.pending>Ne&&(te.adler=ot(te.adler,Fe.pending_buf,Fe.pending-Ne,Ne)),0===rt&&(Fe.gzindex=0,Fe.status=91)}else Fe.status=91;if(91===Fe.status)if(Fe.gzhead.comment){Ne=Fe.pending;do{if(Fe.pending===Fe.pending_buf_size&&(Fe.gzhead.hcrc&&Fe.pending>Ne&&(te.adler=ot(te.adler,Fe.pending_buf,Fe.pending-Ne,Ne)),G(te),Ne=Fe.pending,Fe.pending===Fe.pending_buf_size)){rt=1;break}rt=Fe.gzindex<Fe.gzhead.comment.length?255&Fe.gzhead.comment.charCodeAt(Fe.gzindex++):0,P(Fe,rt)}while(0!==rt);Fe.gzhead.hcrc&&Fe.pending>Ne&&(te.adler=ot(te.adler,Fe.pending_buf,Fe.pending-Ne,Ne)),0===rt&&(Fe.status=103)}else Fe.status=103;if(103===Fe.status&&(Fe.gzhead.hcrc?(Fe.pending+2>Fe.pending_buf_size&&G(te),Fe.pending+2<=Fe.pending_buf_size&&(P(Fe,255&te.adler),P(Fe,te.adler>>8&255),te.adler=0,Fe.status=f)):Fe.status=f),0!==Fe.pending){if(G(te),0===te.avail_out)return Fe.last_flush=-1,He}else if(0===te.avail_in&&ee(Je)<=ee(tt)&&4!==Je)return Z(te,-5);if(666===Fe.status&&0!==te.avail_in)return Z(te,-5);if(0!==te.avail_in||0!==Fe.lookahead||Je!==Ze&&666!==Fe.status){var pt=2===Fe.strategy?function(st,vt){for(var Yt;;){if(0===st.lookahead&&(W(st),0===st.lookahead)){if(vt===Ze)return 1;break}if(st.match_length=0,Yt=ve._tr_tally(st,0,st.window[st.strstart]),st.lookahead--,st.strstart++,Yt&&(b(st,!1),0===st.strm.avail_out))return 1}return st.insert=0,4===vt?(b(st,!0),0===st.strm.avail_out?3:4):st.last_lit&&(b(st,!1),0===st.strm.avail_out)?1:2}(Fe,Je):3===Fe.strategy?function(st,vt){for(var Yt,qt,Ot,Bn,Mn=st.window;;){if(st.lookahead<=E){if(W(st),st.lookahead<=E&&vt===Ze)return 1;if(0===st.lookahead)break}if(st.match_length=0,st.lookahead>=A&&0<st.strstart&&(qt=Mn[Ot=st.strstart-1])===Mn[++Ot]&&qt===Mn[++Ot]&&qt===Mn[++Ot]){Bn=st.strstart+E;do{}while(qt===Mn[++Ot]&&qt===Mn[++Ot]&&qt===Mn[++Ot]&&qt===Mn[++Ot]&&qt===Mn[++Ot]&&qt===Mn[++Ot]&&qt===Mn[++Ot]&&qt===Mn[++Ot]&&Ot<Bn);st.match_length=E-(Bn-Ot),st.match_length>st.lookahead&&(st.match_length=st.lookahead)}if(st.match_length>=A?(Yt=ve._tr_tally(st,1,st.match_length-A),st.lookahead-=st.match_length,st.strstart+=st.match_length,st.match_length=0):(Yt=ve._tr_tally(st,0,st.window[st.strstart]),st.lookahead--,st.strstart++),Yt&&(b(st,!1),0===st.strm.avail_out))return 1}return st.insert=0,4===vt?(b(st,!0),0===st.strm.avail_out?3:4):st.last_lit&&(b(st,!1),0===st.strm.avail_out)?1:2}(Fe,Je):x[Fe.level].func(Fe,Je);if(3!==pt&&4!==pt||(Fe.status=666),1===pt||3===pt)return 0===te.avail_out&&(Fe.last_flush=-1),He;if(2===pt&&(1===Je?ve._tr_align(Fe):5!==Je&&(ve._tr_stored_block(Fe,0,0,!1),3===Je&&(he(Fe.head),0===Fe.lookahead&&(Fe.strstart=0,Fe.block_start=0,Fe.insert=0))),G(te),0===te.avail_out))return Fe.last_flush=-1,He}return 4!==Je?He:Fe.wrap<=0?1:(2===Fe.wrap?(P(Fe,255&te.adler),P(Fe,te.adler>>8&255),P(Fe,te.adler>>16&255),P(Fe,te.adler>>24&255),P(Fe,255&te.total_in),P(Fe,te.total_in>>8&255),P(Fe,te.total_in>>16&255),P(Fe,te.total_in>>24&255)):(T(Fe,te.adler>>>16),T(Fe,65535&te.adler)),G(te),0<Fe.wrap&&(Fe.wrap=-Fe.wrap),0!==Fe.pending?He:1)},Ee.deflateEnd=function(te){var Je;return te&&te.state?(Je=te.state.status)!==v&&69!==Je&&73!==Je&&91!==Je&&103!==Je&&Je!==f&&666!==Je?Z(te,Ve):(te.state=null,Je===f?Z(te,-3):He):Ve},Ee.deflateSetDictionary=function(te,Je){var tt,Fe,Ne,rt,St,pt,st,vt,Yt=Je.length;if(!te||!te.state||2===(rt=(tt=te.state).wrap)||1===rt&&tt.status!==v||tt.lookahead)return Ve;for(1===rt&&(te.adler=ke(te.adler,Je,Yt,0)),tt.wrap=0,Yt>=tt.w_size&&(0===rt&&(he(tt.head),tt.strstart=0,tt.block_start=0,tt.insert=0),vt=new L.Buf8(tt.w_size),L.arraySet(vt,Je,Yt-tt.w_size,tt.w_size,0),Je=vt,Yt=tt.w_size),St=te.avail_in,pt=te.next_in,st=te.input,te.avail_in=Yt,te.next_in=0,te.input=Je,W(tt);tt.lookahead>=A;){for(Fe=tt.strstart,Ne=tt.lookahead-(A-1);tt.ins_h=(tt.ins_h<<tt.hash_shift^tt.window[Fe+A-1])&tt.hash_mask,tt.prev[Fe&tt.w_mask]=tt.head[tt.ins_h],tt.head[tt.ins_h]=Fe,Fe++,--Ne;);tt.strstart=Fe,tt.lookahead=A-1,W(tt)}return tt.strstart+=tt.lookahead,tt.block_start=tt.strstart,tt.insert=tt.lookahead,tt.lookahead=0,tt.match_length=tt.prev_length=A-1,tt.match_available=0,te.next_in=pt,te.input=st,te.avail_in=St,tt.wrap=rt,He},Ee.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(mt,Se,Ee){"use strict";Se.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(mt,Se,Ee){"use strict";Se.exports=function(x,L){var ve,ke,ot,Ye,Ze,Re,He,Ve,De,F,J,Y,ue,Q,me,X,B,$,A,E,g,v,f,C,I;C=x.input,ot=(ke=x.next_in)+(x.avail_in-5),I=x.output,Ze=(Ye=x.next_out)-(L-x.avail_out),Re=Ye+(x.avail_out-257),He=(ve=x.state).dmax,Ve=ve.wsize,De=ve.whave,F=ve.wnext,J=ve.window,Y=ve.hold,ue=ve.bits,Q=ve.lencode,me=ve.distcode,X=(1<<ve.lenbits)-1,B=(1<<ve.distbits)-1;e:do{ue<15&&(Y+=C[ke++]<<ue,Y+=C[ke++]<<(ue+=8),ue+=8),$=Q[Y&X];t:for(;;){if(Y>>>=A=$>>>24,ue-=A,0==(A=$>>>16&255))I[Ye++]=65535&$;else{if(!(16&A)){if(!(64&A)){$=Q[(65535&$)+(Y&(1<<A)-1)];continue t}if(32&A){ve.mode=12;break e}x.msg="invalid literal/length code",ve.mode=30;break e}E=65535&$,(A&=15)&&(ue<A&&(Y+=C[ke++]<<ue,ue+=8),E+=Y&(1<<A)-1,Y>>>=A,ue-=A),ue<15&&(Y+=C[ke++]<<ue,Y+=C[ke++]<<(ue+=8),ue+=8),$=me[Y&B];n:for(;;){if(Y>>>=A=$>>>24,ue-=A,!(16&(A=$>>>16&255))){if(!(64&A)){$=me[(65535&$)+(Y&(1<<A)-1)];continue n}x.msg="invalid distance code",ve.mode=30;break e}if(g=65535&$,ue<(A&=15)&&(Y+=C[ke++]<<ue,(ue+=8)<A&&(Y+=C[ke++]<<ue,ue+=8)),He<(g+=Y&(1<<A)-1)){x.msg="invalid distance too far back",ve.mode=30;break e}if(Y>>>=A,ue-=A,(A=Ye-Ze)<g){if(De<(A=g-A)&&ve.sane){x.msg="invalid distance too far back",ve.mode=30;break e}if(f=J,(v=0)===F){if(v+=Ve-A,A<E){for(E-=A;I[Ye++]=J[v++],--A;);v=Ye-g,f=I}}else if(F<A){if(v+=Ve+F-A,(A-=F)<E){for(E-=A;I[Ye++]=J[v++],--A;);if(v=0,F<E){for(E-=A=F;I[Ye++]=J[v++],--A;);v=Ye-g,f=I}}}else if(v+=F-A,A<E){for(E-=A;I[Ye++]=J[v++],--A;);v=Ye-g,f=I}for(;2<E;)I[Ye++]=f[v++],I[Ye++]=f[v++],I[Ye++]=f[v++],E-=3;E&&(I[Ye++]=f[v++],1<E&&(I[Ye++]=f[v++]))}else{for(v=Ye-g;I[Ye++]=I[v++],I[Ye++]=I[v++],I[Ye++]=I[v++],2<(E-=3););E&&(I[Ye++]=I[v++],1<E&&(I[Ye++]=I[v++]))}break}}break}}while(ke<ot&&Ye<Re);ke-=E=ue>>3,Y&=(1<<(ue-=E<<3))-1,x.next_in=ke,x.next_out=Ye,x.avail_in=ke<ot?ot-ke+5:5-(ke-ot),x.avail_out=Ye<Re?Re-Ye+257:257-(Ye-Re),ve.hold=Y,ve.bits=ue}},{}],49:[function(mt,Se,Ee){"use strict";var x=mt("../utils/common"),L=mt("./adler32"),ve=mt("./crc32"),ke=mt("./inffast"),ot=mt("./inftrees"),Re=0,He=-2,Ve=1,De=852,F=592;function J(v){return(v>>>24&255)+(v>>>8&65280)+((65280&v)<<8)+((255&v)<<24)}function Y(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new x.Buf16(320),this.work=new x.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ue(v){var f;return v&&v.state?(v.total_in=v.total_out=(f=v.state).total=0,v.msg="",f.wrap&&(v.adler=1&f.wrap),f.mode=Ve,f.last=0,f.havedict=0,f.dmax=32768,f.head=null,f.hold=0,f.bits=0,f.lencode=f.lendyn=new x.Buf32(De),f.distcode=f.distdyn=new x.Buf32(F),f.sane=1,f.back=-1,Re):He}function Q(v){var f;return v&&v.state?((f=v.state).wsize=0,f.whave=0,f.wnext=0,ue(v)):He}function me(v,f){var C,I;return v&&v.state?(I=v.state,f<0?(C=0,f=-f):(C=1+(f>>4),f<48&&(f&=15)),f&&(f<8||15<f)?He:(null!==I.window&&I.wbits!==f&&(I.window=null),I.wrap=C,I.wbits=f,Q(v))):He}function X(v,f){var C,I;return v?(I=new Y,(v.state=I).window=null,(C=me(v,f))!==Re&&(v.state=null),C):He}var B,$,A=!0;function E(v){if(A){var f;for(B=new x.Buf32(512),$=new x.Buf32(32),f=0;f<144;)v.lens[f++]=8;for(;f<256;)v.lens[f++]=9;for(;f<280;)v.lens[f++]=7;for(;f<288;)v.lens[f++]=8;for(ot(1,v.lens,0,288,B,0,v.work,{bits:9}),f=0;f<32;)v.lens[f++]=5;ot(2,v.lens,0,32,$,0,v.work,{bits:5}),A=!1}v.lencode=B,v.lenbits=9,v.distcode=$,v.distbits=5}function g(v,f,C,I){var U,k=v.state;return null===k.window&&(k.wsize=1<<k.wbits,k.wnext=0,k.whave=0,k.window=new x.Buf8(k.wsize)),I>=k.wsize?(x.arraySet(k.window,f,C-k.wsize,k.wsize,0),k.wnext=0,k.whave=k.wsize):(I<(U=k.wsize-k.wnext)&&(U=I),x.arraySet(k.window,f,C-I,U,k.wnext),(I-=U)?(x.arraySet(k.window,f,C-I,I,0),k.wnext=I,k.whave=k.wsize):(k.wnext+=U,k.wnext===k.wsize&&(k.wnext=0),k.whave<k.wsize&&(k.whave+=U))),0}Ee.inflateReset=Q,Ee.inflateReset2=me,Ee.inflateResetKeep=ue,Ee.inflateInit=function(v){return X(v,15)},Ee.inflateInit2=X,Ee.inflate=function(v,f){var C,I,U,k,Z,ee,he,G,b,P,T,z,W,fe,we,Me,je,Ge,lt,bt,te,Je,tt,Fe,Ne=0,rt=new x.Buf8(4),St=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!v||!v.state||!v.output||!v.input&&0!==v.avail_in)return He;12===(C=v.state).mode&&(C.mode=13),Z=v.next_out,U=v.output,k=v.next_in,I=v.input,G=C.hold,b=C.bits,P=ee=v.avail_in,T=he=v.avail_out,Je=Re;e:for(;;)switch(C.mode){case Ve:if(0===C.wrap){C.mode=13;break}for(;b<16;){if(0===ee)break e;ee--,G+=I[k++]<<b,b+=8}if(2&C.wrap&&35615===G){rt[C.check=0]=255&G,rt[1]=G>>>8&255,C.check=ve(C.check,rt,2,0),b=G=0,C.mode=2;break}if(C.flags=0,C.head&&(C.head.done=!1),!(1&C.wrap)||(((255&G)<<8)+(G>>8))%31){v.msg="incorrect header check",C.mode=30;break}if(8!=(15&G)){v.msg="unknown compression method",C.mode=30;break}if(b-=4,te=8+(15&(G>>>=4)),0===C.wbits)C.wbits=te;else if(te>C.wbits){v.msg="invalid window size",C.mode=30;break}C.dmax=1<<te,v.adler=C.check=1,C.mode=512&G?10:12,b=G=0;break;case 2:for(;b<16;){if(0===ee)break e;ee--,G+=I[k++]<<b,b+=8}if(C.flags=G,8!=(255&C.flags)){v.msg="unknown compression method",C.mode=30;break}if(57344&C.flags){v.msg="unknown header flags set",C.mode=30;break}C.head&&(C.head.text=G>>8&1),512&C.flags&&(rt[0]=255&G,rt[1]=G>>>8&255,C.check=ve(C.check,rt,2,0)),b=G=0,C.mode=3;case 3:for(;b<32;){if(0===ee)break e;ee--,G+=I[k++]<<b,b+=8}C.head&&(C.head.time=G),512&C.flags&&(rt[0]=255&G,rt[1]=G>>>8&255,rt[2]=G>>>16&255,rt[3]=G>>>24&255,C.check=ve(C.check,rt,4,0)),b=G=0,C.mode=4;case 4:for(;b<16;){if(0===ee)break e;ee--,G+=I[k++]<<b,b+=8}C.head&&(C.head.xflags=255&G,C.head.os=G>>8),512&C.flags&&(rt[0]=255&G,rt[1]=G>>>8&255,C.check=ve(C.check,rt,2,0)),b=G=0,C.mode=5;case 5:if(1024&C.flags){for(;b<16;){if(0===ee)break e;ee--,G+=I[k++]<<b,b+=8}C.length=G,C.head&&(C.head.extra_len=G),512&C.flags&&(rt[0]=255&G,rt[1]=G>>>8&255,C.check=ve(C.check,rt,2,0)),b=G=0}else C.head&&(C.head.extra=null);C.mode=6;case 6:if(1024&C.flags&&(ee<(z=C.length)&&(z=ee),z&&(C.head&&(te=C.head.extra_len-C.length,C.head.extra||(C.head.extra=new Array(C.head.extra_len)),x.arraySet(C.head.extra,I,k,z,te)),512&C.flags&&(C.check=ve(C.check,I,z,k)),ee-=z,k+=z,C.length-=z),C.length))break e;C.length=0,C.mode=7;case 7:if(2048&C.flags){if(0===ee)break e;for(z=0;te=I[k+z++],C.head&&te&&C.length<65536&&(C.head.name+=String.fromCharCode(te)),te&&z<ee;);if(512&C.flags&&(C.check=ve(C.check,I,z,k)),ee-=z,k+=z,te)break e}else C.head&&(C.head.name=null);C.length=0,C.mode=8;case 8:if(4096&C.flags){if(0===ee)break e;for(z=0;te=I[k+z++],C.head&&te&&C.length<65536&&(C.head.comment+=String.fromCharCode(te)),te&&z<ee;);if(512&C.flags&&(C.check=ve(C.check,I,z,k)),ee-=z,k+=z,te)break e}else C.head&&(C.head.comment=null);C.mode=9;case 9:if(512&C.flags){for(;b<16;){if(0===ee)break e;ee--,G+=I[k++]<<b,b+=8}if(G!==(65535&C.check)){v.msg="header crc mismatch",C.mode=30;break}b=G=0}C.head&&(C.head.hcrc=C.flags>>9&1,C.head.done=!0),v.adler=C.check=0,C.mode=12;break;case 10:for(;b<32;){if(0===ee)break e;ee--,G+=I[k++]<<b,b+=8}v.adler=C.check=J(G),b=G=0,C.mode=11;case 11:if(0===C.havedict)return v.next_out=Z,v.avail_out=he,v.next_in=k,v.avail_in=ee,C.hold=G,C.bits=b,2;v.adler=C.check=1,C.mode=12;case 12:if(5===f||6===f)break e;case 13:if(C.last){G>>>=7&b,b-=7&b,C.mode=27;break}for(;b<3;){if(0===ee)break e;ee--,G+=I[k++]<<b,b+=8}switch(C.last=1&G,b-=1,3&(G>>>=1)){case 0:C.mode=14;break;case 1:if(E(C),C.mode=20,6!==f)break;G>>>=2,b-=2;break e;case 2:C.mode=17;break;case 3:v.msg="invalid block type",C.mode=30}G>>>=2,b-=2;break;case 14:for(G>>>=7&b,b-=7&b;b<32;){if(0===ee)break e;ee--,G+=I[k++]<<b,b+=8}if((65535&G)!=(G>>>16^65535)){v.msg="invalid stored block lengths",C.mode=30;break}if(C.length=65535&G,b=G=0,C.mode=15,6===f)break e;case 15:C.mode=16;case 16:if(z=C.length){if(ee<z&&(z=ee),he<z&&(z=he),0===z)break e;x.arraySet(U,I,k,z,Z),ee-=z,k+=z,he-=z,Z+=z,C.length-=z;break}C.mode=12;break;case 17:for(;b<14;){if(0===ee)break e;ee--,G+=I[k++]<<b,b+=8}if(C.nlen=257+(31&G),b-=5,C.ndist=1+(31&(G>>>=5)),b-=5,C.ncode=4+(15&(G>>>=5)),G>>>=4,b-=4,286<C.nlen||30<C.ndist){v.msg="too many length or distance symbols",C.mode=30;break}C.have=0,C.mode=18;case 18:for(;C.have<C.ncode;){for(;b<3;){if(0===ee)break e;ee--,G+=I[k++]<<b,b+=8}C.lens[St[C.have++]]=7&G,G>>>=3,b-=3}for(;C.have<19;)C.lens[St[C.have++]]=0;if(C.lencode=C.lendyn,C.lenbits=7,Je=ot(0,C.lens,0,19,C.lencode,0,C.work,tt={bits:C.lenbits}),C.lenbits=tt.bits,Je){v.msg="invalid code lengths set",C.mode=30;break}C.have=0,C.mode=19;case 19:for(;C.have<C.nlen+C.ndist;){for(;Me=(Ne=C.lencode[G&(1<<C.lenbits)-1])>>>16&255,je=65535&Ne,!((we=Ne>>>24)<=b);){if(0===ee)break e;ee--,G+=I[k++]<<b,b+=8}if(je<16)G>>>=we,b-=we,C.lens[C.have++]=je;else{if(16===je){for(Fe=we+2;b<Fe;){if(0===ee)break e;ee--,G+=I[k++]<<b,b+=8}if(G>>>=we,b-=we,0===C.have){v.msg="invalid bit length repeat",C.mode=30;break}te=C.lens[C.have-1],z=3+(3&G),G>>>=2,b-=2}else if(17===je){for(Fe=we+3;b<Fe;){if(0===ee)break e;ee--,G+=I[k++]<<b,b+=8}b-=we,te=0,z=3+(7&(G>>>=we)),G>>>=3,b-=3}else{for(Fe=we+7;b<Fe;){if(0===ee)break e;ee--,G+=I[k++]<<b,b+=8}b-=we,te=0,z=11+(127&(G>>>=we)),G>>>=7,b-=7}if(C.have+z>C.nlen+C.ndist){v.msg="invalid bit length repeat",C.mode=30;break}for(;z--;)C.lens[C.have++]=te}}if(30===C.mode)break;if(0===C.lens[256]){v.msg="invalid code -- missing end-of-block",C.mode=30;break}if(C.lenbits=9,Je=ot(1,C.lens,0,C.nlen,C.lencode,0,C.work,tt={bits:C.lenbits}),C.lenbits=tt.bits,Je){v.msg="invalid literal/lengths set",C.mode=30;break}if(C.distbits=6,C.distcode=C.distdyn,Je=ot(2,C.lens,C.nlen,C.ndist,C.distcode,0,C.work,tt={bits:C.distbits}),C.distbits=tt.bits,Je){v.msg="invalid distances set",C.mode=30;break}if(C.mode=20,6===f)break e;case 20:C.mode=21;case 21:if(6<=ee&&258<=he){v.next_out=Z,v.avail_out=he,v.next_in=k,v.avail_in=ee,C.hold=G,C.bits=b,ke(v,T),Z=v.next_out,U=v.output,he=v.avail_out,k=v.next_in,I=v.input,ee=v.avail_in,G=C.hold,b=C.bits,12===C.mode&&(C.back=-1);break}for(C.back=0;Me=(Ne=C.lencode[G&(1<<C.lenbits)-1])>>>16&255,je=65535&Ne,!((we=Ne>>>24)<=b);){if(0===ee)break e;ee--,G+=I[k++]<<b,b+=8}if(Me&&!(240&Me)){for(Ge=we,lt=Me,bt=je;Me=(Ne=C.lencode[bt+((G&(1<<Ge+lt)-1)>>Ge)])>>>16&255,je=65535&Ne,!(Ge+(we=Ne>>>24)<=b);){if(0===ee)break e;ee--,G+=I[k++]<<b,b+=8}G>>>=Ge,b-=Ge,C.back+=Ge}if(G>>>=we,b-=we,C.back+=we,C.length=je,0===Me){C.mode=26;break}if(32&Me){C.back=-1,C.mode=12;break}if(64&Me){v.msg="invalid literal/length code",C.mode=30;break}C.extra=15&Me,C.mode=22;case 22:if(C.extra){for(Fe=C.extra;b<Fe;){if(0===ee)break e;ee--,G+=I[k++]<<b,b+=8}C.length+=G&(1<<C.extra)-1,G>>>=C.extra,b-=C.extra,C.back+=C.extra}C.was=C.length,C.mode=23;case 23:for(;Me=(Ne=C.distcode[G&(1<<C.distbits)-1])>>>16&255,je=65535&Ne,!((we=Ne>>>24)<=b);){if(0===ee)break e;ee--,G+=I[k++]<<b,b+=8}if(!(240&Me)){for(Ge=we,lt=Me,bt=je;Me=(Ne=C.distcode[bt+((G&(1<<Ge+lt)-1)>>Ge)])>>>16&255,je=65535&Ne,!(Ge+(we=Ne>>>24)<=b);){if(0===ee)break e;ee--,G+=I[k++]<<b,b+=8}G>>>=Ge,b-=Ge,C.back+=Ge}if(G>>>=we,b-=we,C.back+=we,64&Me){v.msg="invalid distance code",C.mode=30;break}C.offset=je,C.extra=15&Me,C.mode=24;case 24:if(C.extra){for(Fe=C.extra;b<Fe;){if(0===ee)break e;ee--,G+=I[k++]<<b,b+=8}C.offset+=G&(1<<C.extra)-1,G>>>=C.extra,b-=C.extra,C.back+=C.extra}if(C.offset>C.dmax){v.msg="invalid distance too far back",C.mode=30;break}C.mode=25;case 25:if(0===he)break e;if(C.offset>(z=T-he)){if((z=C.offset-z)>C.whave&&C.sane){v.msg="invalid distance too far back",C.mode=30;break}W=z>C.wnext?C.wsize-(z-=C.wnext):C.wnext-z,z>C.length&&(z=C.length),fe=C.window}else fe=U,W=Z-C.offset,z=C.length;for(he<z&&(z=he),he-=z,C.length-=z;U[Z++]=fe[W++],--z;);0===C.length&&(C.mode=21);break;case 26:if(0===he)break e;U[Z++]=C.length,he--,C.mode=21;break;case 27:if(C.wrap){for(;b<32;){if(0===ee)break e;ee--,G|=I[k++]<<b,b+=8}if(v.total_out+=T-=he,C.total+=T,T&&(v.adler=C.check=C.flags?ve(C.check,U,T,Z-T):L(C.check,U,T,Z-T)),T=he,(C.flags?G:J(G))!==C.check){v.msg="incorrect data check",C.mode=30;break}b=G=0}C.mode=28;case 28:if(C.wrap&&C.flags){for(;b<32;){if(0===ee)break e;ee--,G+=I[k++]<<b,b+=8}if(G!==(4294967295&C.total)){v.msg="incorrect length check",C.mode=30;break}b=G=0}C.mode=29;case 29:Je=1;break e;case 30:Je=-3;break e;case 31:return-4;default:return He}return v.next_out=Z,v.avail_out=he,v.next_in=k,v.avail_in=ee,C.hold=G,C.bits=b,(C.wsize||T!==v.avail_out&&C.mode<30&&(C.mode<27||4!==f))&&g(v,v.output,v.next_out,T-v.avail_out)?(C.mode=31,-4):(T-=v.avail_out,v.total_in+=P-=v.avail_in,v.total_out+=T,C.total+=T,C.wrap&&T&&(v.adler=C.check=C.flags?ve(C.check,U,T,v.next_out-T):L(C.check,U,T,v.next_out-T)),v.data_type=C.bits+(C.last?64:0)+(12===C.mode?128:0)+(20===C.mode||15===C.mode?256:0),(0==P&&0===T||4===f)&&Je===Re&&(Je=-5),Je)},Ee.inflateEnd=function(v){if(!v||!v.state)return He;var f=v.state;return f.window&&(f.window=null),v.state=null,Re},Ee.inflateGetHeader=function(v,f){var C;return v&&v.state&&2&(C=v.state).wrap?((C.head=f).done=!1,Re):He},Ee.inflateSetDictionary=function(v,f){var C,I=f.length;return v&&v.state?0!==(C=v.state).wrap&&11!==C.mode?He:11===C.mode&&L(1,f,I,0)!==C.check?-3:g(v,f,I,I)?(C.mode=31,-4):(C.havedict=1,Re):He},Ee.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(mt,Se,Ee){"use strict";var x=mt("../utils/common"),L=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],ve=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],ke=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],ot=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];Se.exports=function(Ye,Ze,Re,He,Ve,De,F,J){var Y,ue,Q,me,X,B,$,A,E,g=J.bits,v=0,f=0,C=0,I=0,U=0,k=0,Z=0,ee=0,he=0,G=0,b=null,P=0,T=new x.Buf16(16),z=new x.Buf16(16),W=null,fe=0;for(v=0;v<=15;v++)T[v]=0;for(f=0;f<He;f++)T[Ze[Re+f]]++;for(U=g,I=15;1<=I&&0===T[I];I--);if(I<U&&(U=I),0===I)return Ve[De++]=20971520,Ve[De++]=20971520,J.bits=1,0;for(C=1;C<I&&0===T[C];C++);for(U<C&&(U=C),v=ee=1;v<=15;v++)if(ee<<=1,(ee-=T[v])<0)return-1;if(0<ee&&(0===Ye||1!==I))return-1;for(z[1]=0,v=1;v<15;v++)z[v+1]=z[v]+T[v];for(f=0;f<He;f++)0!==Ze[Re+f]&&(F[z[Ze[Re+f]]++]=f);if(B=0===Ye?(b=W=F,19):1===Ye?(b=L,P-=257,W=ve,fe-=257,256):(b=ke,W=ot,-1),v=C,X=De,Z=f=G=0,Q=-1,me=(he=1<<(k=U))-1,1===Ye&&852<he||2===Ye&&592<he)return 1;for(;;){for($=v-Z,E=F[f]<B?(A=0,F[f]):F[f]>B?(A=W[fe+F[f]],b[P+F[f]]):(A=96,0),Y=1<<v-Z,C=ue=1<<k;Ve[X+(G>>Z)+(ue-=Y)]=$<<24|A<<16|E,0!==ue;);for(Y=1<<v-1;G&Y;)Y>>=1;if(0!==Y?(G&=Y-1,G+=Y):G=0,f++,0==--T[v]){if(v===I)break;v=Ze[Re+F[f]]}if(U<v&&(G&me)!==Q){for(0===Z&&(Z=U),X+=C,ee=1<<(k=v-Z);k+Z<I&&!((ee-=T[k+Z])<=0);)k++,ee<<=1;if(he+=1<<k,1===Ye&&852<he||2===Ye&&592<he)return 1;Ve[Q=G&me]=U<<24|k<<16|X-De}}return 0!==G&&(Ve[X+G]=v-Z<<24|64<<16),J.bits=U,0}},{"../utils/common":41}],51:[function(mt,Se,Ee){"use strict";Se.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(mt,Se,Ee){"use strict";var x=mt("../utils/common");function ke(Ne){for(var rt=Ne.length;0<=--rt;)Ne[rt]=0}var F=15,J=16,B=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],$=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],E=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],g=new Array(576);ke(g);var v=new Array(60);ke(v);var f=new Array(512);ke(f);var C=new Array(256);ke(C);var I=new Array(29);ke(I);var U,k,Z,ee=new Array(30);function he(Ne,rt,St,pt,st){this.static_tree=Ne,this.extra_bits=rt,this.extra_base=St,this.elems=pt,this.max_length=st,this.has_stree=Ne&&Ne.length}function G(Ne,rt){this.dyn_tree=Ne,this.max_code=0,this.stat_desc=rt}function b(Ne){return Ne<256?f[Ne]:f[256+(Ne>>>7)]}function P(Ne,rt){Ne.pending_buf[Ne.pending++]=255&rt,Ne.pending_buf[Ne.pending++]=rt>>>8&255}function T(Ne,rt,St){Ne.bi_valid>J-St?(Ne.bi_buf|=rt<<Ne.bi_valid&65535,P(Ne,Ne.bi_buf),Ne.bi_buf=rt>>J-Ne.bi_valid,Ne.bi_valid+=St-J):(Ne.bi_buf|=rt<<Ne.bi_valid&65535,Ne.bi_valid+=St)}function z(Ne,rt,St){T(Ne,St[2*rt],St[2*rt+1])}function W(Ne,rt){for(var St=0;St|=1&Ne,Ne>>>=1,St<<=1,0<--rt;);return St>>>1}function fe(Ne,rt,St){var pt,st,vt=new Array(F+1),Yt=0;for(pt=1;pt<=F;pt++)vt[pt]=Yt=Yt+St[pt-1]<<1;for(st=0;st<=rt;st++){var qt=Ne[2*st+1];0!==qt&&(Ne[2*st]=W(vt[qt]++,qt))}}function we(Ne){var rt;for(rt=0;rt<286;rt++)Ne.dyn_ltree[2*rt]=0;for(rt=0;rt<30;rt++)Ne.dyn_dtree[2*rt]=0;for(rt=0;rt<19;rt++)Ne.bl_tree[2*rt]=0;Ne.dyn_ltree[512]=1,Ne.opt_len=Ne.static_len=0,Ne.last_lit=Ne.matches=0}function Me(Ne){8<Ne.bi_valid?P(Ne,Ne.bi_buf):0<Ne.bi_valid&&(Ne.pending_buf[Ne.pending++]=Ne.bi_buf),Ne.bi_buf=0,Ne.bi_valid=0}function je(Ne,rt,St,pt){var st=2*rt,vt=2*St;return Ne[st]<Ne[vt]||Ne[st]===Ne[vt]&&pt[rt]<=pt[St]}function Ge(Ne,rt,St){for(var pt=Ne.heap[St],st=St<<1;st<=Ne.heap_len&&(st<Ne.heap_len&&je(rt,Ne.heap[st+1],Ne.heap[st],Ne.depth)&&st++,!je(rt,pt,Ne.heap[st],Ne.depth));)Ne.heap[St]=Ne.heap[st],St=st,st<<=1;Ne.heap[St]=pt}function lt(Ne,rt,St){var pt,st,vt,Yt,qt=0;if(0!==Ne.last_lit)for(;pt=Ne.pending_buf[Ne.d_buf+2*qt]<<8|Ne.pending_buf[Ne.d_buf+2*qt+1],st=Ne.pending_buf[Ne.l_buf+qt],qt++,0===pt?z(Ne,st,rt):(z(Ne,(vt=C[st])+256+1,rt),0!==(Yt=B[vt])&&T(Ne,st-=I[vt],Yt),z(Ne,vt=b(--pt),St),0!==(Yt=$[vt])&&T(Ne,pt-=ee[vt],Yt)),qt<Ne.last_lit;);z(Ne,256,rt)}function bt(Ne,rt){var St,pt,st,vt=rt.dyn_tree,Yt=rt.stat_desc.static_tree,qt=rt.stat_desc.has_stree,Ot=rt.stat_desc.elems,Bn=-1;for(Ne.heap_len=0,Ne.heap_max=573,St=0;St<Ot;St++)0!==vt[2*St]?(Ne.heap[++Ne.heap_len]=Bn=St,Ne.depth[St]=0):vt[2*St+1]=0;for(;Ne.heap_len<2;)vt[2*(st=Ne.heap[++Ne.heap_len]=Bn<2?++Bn:0)]=1,Ne.depth[st]=0,Ne.opt_len--,qt&&(Ne.static_len-=Yt[2*st+1]);for(rt.max_code=Bn,St=Ne.heap_len>>1;1<=St;St--)Ge(Ne,vt,St);for(st=Ot;St=Ne.heap[1],Ne.heap[1]=Ne.heap[Ne.heap_len--],Ge(Ne,vt,1),pt=Ne.heap[1],Ne.heap[--Ne.heap_max]=St,Ne.heap[--Ne.heap_max]=pt,vt[2*st]=vt[2*St]+vt[2*pt],Ne.depth[st]=(Ne.depth[St]>=Ne.depth[pt]?Ne.depth[St]:Ne.depth[pt])+1,vt[2*St+1]=vt[2*pt+1]=st,Ne.heap[1]=st++,Ge(Ne,vt,1),2<=Ne.heap_len;);Ne.heap[--Ne.heap_max]=Ne.heap[1],function(Mn,bn){var Dn,$n,Cn,yn,Sn,ii,ai=bn.dyn_tree,Hi=bn.max_code,ti=bn.stat_desc.static_tree,Nr=bn.stat_desc.has_stree,ss=bn.stat_desc.extra_bits,Bs=bn.stat_desc.extra_base,yo=bn.stat_desc.max_length,xt=0;for(yn=0;yn<=F;yn++)Mn.bl_count[yn]=0;for(ai[2*Mn.heap[Mn.heap_max]+1]=0,Dn=Mn.heap_max+1;Dn<573;Dn++)yo<(yn=ai[2*ai[2*($n=Mn.heap[Dn])+1]+1]+1)&&(yn=yo,xt++),ai[2*$n+1]=yn,Hi<$n||(Mn.bl_count[yn]++,Sn=0,Bs<=$n&&(Sn=ss[$n-Bs]),Mn.opt_len+=(ii=ai[2*$n])*(yn+Sn),Nr&&(Mn.static_len+=ii*(ti[2*$n+1]+Sn)));if(0!==xt){do{for(yn=yo-1;0===Mn.bl_count[yn];)yn--;Mn.bl_count[yn]--,Mn.bl_count[yn+1]+=2,Mn.bl_count[yo]--,xt-=2}while(0<xt);for(yn=yo;0!==yn;yn--)for($n=Mn.bl_count[yn];0!==$n;)Hi<(Cn=Mn.heap[--Dn])||(ai[2*Cn+1]!==yn&&(Mn.opt_len+=(yn-ai[2*Cn+1])*ai[2*Cn],ai[2*Cn+1]=yn),$n--)}}(Ne,rt),fe(vt,Bn,Ne.bl_count)}function te(Ne,rt,St){var pt,st,vt=-1,Yt=rt[1],qt=0,Ot=7,Bn=4;for(0===Yt&&(Ot=138,Bn=3),rt[2*(St+1)+1]=65535,pt=0;pt<=St;pt++)st=Yt,Yt=rt[2*(pt+1)+1],++qt<Ot&&st===Yt||(qt<Bn?Ne.bl_tree[2*st]+=qt:0!==st?(st!==vt&&Ne.bl_tree[2*st]++,Ne.bl_tree[32]++):qt<=10?Ne.bl_tree[34]++:Ne.bl_tree[36]++,vt=st,Bn=(qt=0)===Yt?(Ot=138,3):st===Yt?(Ot=6,3):(Ot=7,4))}function Je(Ne,rt,St){var pt,st,vt=-1,Yt=rt[1],qt=0,Ot=7,Bn=4;for(0===Yt&&(Ot=138,Bn=3),pt=0;pt<=St;pt++)if(st=Yt,Yt=rt[2*(pt+1)+1],!(++qt<Ot&&st===Yt)){if(qt<Bn)for(;z(Ne,st,Ne.bl_tree),0!=--qt;);else 0!==st?(st!==vt&&(z(Ne,st,Ne.bl_tree),qt--),z(Ne,16,Ne.bl_tree),T(Ne,qt-3,2)):qt<=10?(z(Ne,17,Ne.bl_tree),T(Ne,qt-3,3)):(z(Ne,18,Ne.bl_tree),T(Ne,qt-11,7));vt=st,Bn=(qt=0)===Yt?(Ot=138,3):st===Yt?(Ot=6,3):(Ot=7,4)}}ke(ee);var tt=!1;function Fe(Ne,rt,St,pt){var st,vt,Yt;T(Ne,0+(pt?1:0),3),vt=rt,Yt=St,Me(st=Ne),P(st,Yt),P(st,~Yt),x.arraySet(st.pending_buf,st.window,vt,Yt,st.pending),st.pending+=Yt}Ee._tr_init=function(Ne){tt||(function(){var rt,St,pt,st,vt,Yt=new Array(F+1);for(st=pt=0;st<28;st++)for(I[st]=pt,rt=0;rt<1<<B[st];rt++)C[pt++]=st;for(C[pt-1]=st,st=vt=0;st<16;st++)for(ee[st]=vt,rt=0;rt<1<<$[st];rt++)f[vt++]=st;for(vt>>=7;st<30;st++)for(ee[st]=vt<<7,rt=0;rt<1<<$[st]-7;rt++)f[256+vt++]=st;for(St=0;St<=F;St++)Yt[St]=0;for(rt=0;rt<=143;)g[2*rt+1]=8,rt++,Yt[8]++;for(;rt<=255;)g[2*rt+1]=9,rt++,Yt[9]++;for(;rt<=279;)g[2*rt+1]=7,rt++,Yt[7]++;for(;rt<=287;)g[2*rt+1]=8,rt++,Yt[8]++;for(fe(g,287,Yt),rt=0;rt<30;rt++)v[2*rt+1]=5,v[2*rt]=W(rt,5);U=new he(g,B,257,286,F),k=new he(v,$,0,30,F),Z=new he(new Array(0),A,0,19,7)}(),tt=!0),Ne.l_desc=new G(Ne.dyn_ltree,U),Ne.d_desc=new G(Ne.dyn_dtree,k),Ne.bl_desc=new G(Ne.bl_tree,Z),Ne.bi_buf=0,Ne.bi_valid=0,we(Ne)},Ee._tr_stored_block=Fe,Ee._tr_flush_block=function(Ne,rt,St,pt){var st,vt,Yt=0;0<Ne.level?(2===Ne.strm.data_type&&(Ne.strm.data_type=function(qt){var Ot,Bn=4093624447;for(Ot=0;Ot<=31;Ot++,Bn>>>=1)if(1&Bn&&0!==qt.dyn_ltree[2*Ot])return 0;if(0!==qt.dyn_ltree[18]||0!==qt.dyn_ltree[20]||0!==qt.dyn_ltree[26])return 1;for(Ot=32;Ot<256;Ot++)if(0!==qt.dyn_ltree[2*Ot])return 1;return 0}(Ne)),bt(Ne,Ne.l_desc),bt(Ne,Ne.d_desc),Yt=function(qt){var Ot;for(te(qt,qt.dyn_ltree,qt.l_desc.max_code),te(qt,qt.dyn_dtree,qt.d_desc.max_code),bt(qt,qt.bl_desc),Ot=18;3<=Ot&&0===qt.bl_tree[2*E[Ot]+1];Ot--);return qt.opt_len+=3*(Ot+1)+5+5+4,Ot}(Ne),(vt=Ne.static_len+3+7>>>3)<=(st=Ne.opt_len+3+7>>>3)&&(st=vt)):st=vt=St+5,St+4<=st&&-1!==rt?Fe(Ne,rt,St,pt):4===Ne.strategy||vt===st?(T(Ne,2+(pt?1:0),3),lt(Ne,g,v)):(T(Ne,4+(pt?1:0),3),function(qt,Ot,Bn,Mn){var bn;for(T(qt,Ot-257,5),T(qt,Bn-1,5),T(qt,Mn-4,4),bn=0;bn<Mn;bn++)T(qt,qt.bl_tree[2*E[bn]+1],3);Je(qt,qt.dyn_ltree,Ot-1),Je(qt,qt.dyn_dtree,Bn-1)}(Ne,Ne.l_desc.max_code+1,Ne.d_desc.max_code+1,Yt+1),lt(Ne,Ne.dyn_ltree,Ne.dyn_dtree)),we(Ne),pt&&Me(Ne)},Ee._tr_tally=function(Ne,rt,St){return Ne.pending_buf[Ne.d_buf+2*Ne.last_lit]=rt>>>8&255,Ne.pending_buf[Ne.d_buf+2*Ne.last_lit+1]=255&rt,Ne.pending_buf[Ne.l_buf+Ne.last_lit]=255&St,Ne.last_lit++,0===rt?Ne.dyn_ltree[2*St]++:(Ne.matches++,rt--,Ne.dyn_ltree[2*(C[St]+256+1)]++,Ne.dyn_dtree[2*b(rt)]++),Ne.last_lit===Ne.lit_bufsize-1},Ee._tr_align=function(Ne){var rt;T(Ne,2,3),z(Ne,256,g),16===(rt=Ne).bi_valid?(P(rt,rt.bi_buf),rt.bi_buf=0,rt.bi_valid=0):8<=rt.bi_valid&&(rt.pending_buf[rt.pending++]=255&rt.bi_buf,rt.bi_buf>>=8,rt.bi_valid-=8)}},{"../utils/common":41}],53:[function(mt,Se,Ee){"use strict";Se.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(mt,Se,Ee){(function(x){!function(L,ve){"use strict";if(!L.setImmediate){var ke,ot,Ye,Ze,Re=1,He={},Ve=!1,De=L.document,F=Object.getPrototypeOf&&Object.getPrototypeOf(L);F=F&&F.setTimeout?F:L,ke="[object process]"==={}.toString.call(L.process)?function(Q){process.nextTick(function(){Y(Q)})}:function(){if(L.postMessage&&!L.importScripts){var Q=!0,me=L.onmessage;return L.onmessage=function(){Q=!1},L.postMessage("","*"),L.onmessage=me,Q}}()?(Ze="setImmediate$"+Math.random()+"$",L.addEventListener?L.addEventListener("message",ue,!1):L.attachEvent("onmessage",ue),function(Q){L.postMessage(Ze+Q,"*")}):L.MessageChannel?((Ye=new MessageChannel).port1.onmessage=function(Q){Y(Q.data)},function(Q){Ye.port2.postMessage(Q)}):De&&"onreadystatechange"in De.createElement("script")?(ot=De.documentElement,function(Q){var me=De.createElement("script");me.onreadystatechange=function(){Y(Q),me.onreadystatechange=null,ot.removeChild(me),me=null},ot.appendChild(me)}):function(Q){setTimeout(Y,0,Q)},F.setImmediate=function(Q){"function"!=typeof Q&&(Q=new Function(""+Q));for(var me=new Array(arguments.length-1),X=0;X<me.length;X++)me[X]=arguments[X+1];return He[Re]={callback:Q,args:me},ke(Re),Re++},F.clearImmediate=J}function J(Q){delete He[Q]}function Y(Q){if(Ve)setTimeout(Y,0,Q);else{var me=He[Q];if(me){Ve=!0;try{!function(X){var B=X.callback,$=X.args;switch($.length){case 0:B();break;case 1:B($[0]);break;case 2:B($[0],$[1]);break;case 3:B($[0],$[1],$[2]);break;default:B.apply(ve,$)}}(me)}finally{J(Q),Ve=!1}}}}function ue(Q){Q.source===L&&"string"==typeof Q.data&&0===Q.data.indexOf(Ze)&&Y(+Q.data.slice(Ze.length))}}(typeof self>"u"?void 0===x?this:x:self)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)},1230:(Yr,mt,Se)=>{const Ee=Se(8856),x=Se(64),L=Se(7282),ve=Se(5099);function ke(ot,Ye,Ze,Re,He){const Ve=[].slice.call(arguments,1),De=Ve.length,F="function"==typeof Ve[De-1];if(!F&&!Ee())throw new Error("Callback required as last argument");if(!F){if(De<1)throw new Error("Too few arguments provided");return 1===De?(Ze=Ye,Ye=Re=void 0):2===De&&!Ye.getContext&&(Re=Ze,Ze=Ye,Ye=void 0),new Promise(function(J,Y){try{const ue=x.create(Ze,Re);J(ot(ue,Ye,Re))}catch(ue){Y(ue)}})}if(De<2)throw new Error("Too few arguments provided");2===De?(He=Ze,Ze=Ye,Ye=Re=void 0):3===De&&(Ye.getContext&&typeof He>"u"?(He=Re,Re=void 0):(He=Re,Re=Ze,Ze=Ye,Ye=void 0));try{const J=x.create(Ze,Re);He(null,ot(J,Ye,Re))}catch(J){He(J)}}mt.create=x.create,mt.toCanvas=ke.bind(null,L.render),mt.toDataURL=ke.bind(null,L.renderToDataURL),mt.toString=ke.bind(null,function(ot,Ye,Ze){return ve.render(ot,Ze)})},8856:Yr=>{Yr.exports=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then}},1650:(Yr,mt,Se)=>{const Ee=Se(4469).getSymbolSize;mt.getRowColCoords=function(L){if(1===L)return[];const ve=Math.floor(L/7)+2,ke=Ee(L),ot=145===ke?26:2*Math.ceil((ke-13)/(2*ve-2)),Ye=[ke-7];for(let Ze=1;Ze<ve-1;Ze++)Ye[Ze]=Ye[Ze-1]-ot;return Ye.push(6),Ye.reverse()},mt.getPositions=function(L){const ve=[],ke=mt.getRowColCoords(L),ot=ke.length;for(let Ye=0;Ye<ot;Ye++)for(let Ze=0;Ze<ot;Ze++)0===Ye&&0===Ze||0===Ye&&Ze===ot-1||Ye===ot-1&&0===Ze||ve.push([ke[Ye],ke[Ze]]);return ve}},742:(Yr,mt,Se)=>{const Ee=Se(2321),x=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function L(ve){this.mode=Ee.ALPHANUMERIC,this.data=ve}L.getBitsLength=function(ke){return 11*Math.floor(ke/2)+ke%2*6},L.prototype.getLength=function(){return this.data.length},L.prototype.getBitsLength=function(){return L.getBitsLength(this.data.length)},L.prototype.write=function(ke){let ot;for(ot=0;ot+2<=this.data.length;ot+=2){let Ye=45*x.indexOf(this.data[ot]);Ye+=x.indexOf(this.data[ot+1]),ke.put(Ye,11)}this.data.length%2&&ke.put(x.indexOf(this.data[ot]),6)},Yr.exports=L},7930:Yr=>{function mt(){this.buffer=[],this.length=0}mt.prototype={get:function(Se){const Ee=Math.floor(Se/8);return 1==(this.buffer[Ee]>>>7-Se%8&1)},put:function(Se,Ee){for(let x=0;x<Ee;x++)this.putBit(1==(Se>>>Ee-x-1&1))},getLengthInBits:function(){return this.length},putBit:function(Se){const Ee=Math.floor(this.length/8);this.buffer.length<=Ee&&this.buffer.push(0),Se&&(this.buffer[Ee]|=128>>>this.length%8),this.length++}},Yr.exports=mt},6393:Yr=>{function mt(Se){if(!Se||Se<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=Se,this.data=new Uint8Array(Se*Se),this.reservedBit=new Uint8Array(Se*Se)}mt.prototype.set=function(Se,Ee,x,L){const ve=Se*this.size+Ee;this.data[ve]=x,L&&(this.reservedBit[ve]=!0)},mt.prototype.get=function(Se,Ee){return this.data[Se*this.size+Ee]},mt.prototype.xor=function(Se,Ee,x){this.data[Se*this.size+Ee]^=x},mt.prototype.isReserved=function(Se,Ee){return this.reservedBit[Se*this.size+Ee]},Yr.exports=mt},2333:(Yr,mt,Se)=>{const Ee=Se(5474),x=Se(2321);function L(ve){this.mode=x.BYTE,"string"==typeof ve&&(ve=Ee(ve)),this.data=new Uint8Array(ve)}L.getBitsLength=function(ke){return 8*ke},L.prototype.getLength=function(){return this.data.length},L.prototype.getBitsLength=function(){return L.getBitsLength(this.data.length)},L.prototype.write=function(ve){for(let ke=0,ot=this.data.length;ke<ot;ke++)ve.put(this.data[ke],8)},Yr.exports=L},505:(Yr,mt,Se)=>{const Ee=Se(6196),x=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],L=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];mt.getBlocksCount=function(ke,ot){switch(ot){case Ee.L:return x[4*(ke-1)+0];case Ee.M:return x[4*(ke-1)+1];case Ee.Q:return x[4*(ke-1)+2];case Ee.H:return x[4*(ke-1)+3];default:return}},mt.getTotalCodewordsCount=function(ke,ot){switch(ot){case Ee.L:return L[4*(ke-1)+0];case Ee.M:return L[4*(ke-1)+1];case Ee.Q:return L[4*(ke-1)+2];case Ee.H:return L[4*(ke-1)+3];default:return}}},6196:(Yr,mt)=>{mt.L={bit:1},mt.M={bit:0},mt.Q={bit:3},mt.H={bit:2},mt.isValid=function(x){return x&&typeof x.bit<"u"&&x.bit>=0&&x.bit<4},mt.from=function(x,L){if(mt.isValid(x))return x;try{return function Se(Ee){if("string"!=typeof Ee)throw new Error("Param is not a string");switch(Ee.toLowerCase()){case"l":case"low":return mt.L;case"m":case"medium":return mt.M;case"q":case"quartile":return mt.Q;case"h":case"high":return mt.H;default:throw new Error("Unknown EC Level: "+Ee)}}(x)}catch{return L}}},6745:(Yr,mt,Se)=>{const Ee=Se(4469).getSymbolSize;mt.getPositions=function(ve){const ke=Ee(ve);return[[0,0],[ke-7,0],[0,ke-7]]}},7402:(Yr,mt,Se)=>{const Ee=Se(4469),ve=Ee.getBCHDigit(1335);mt.getEncodedBits=function(ot,Ye){const Ze=ot.bit<<3|Ye;let Re=Ze<<10;for(;Ee.getBCHDigit(Re)-ve>=0;)Re^=1335<<Ee.getBCHDigit(Re)-ve;return 21522^(Ze<<10|Re)}},3010:(Yr,mt)=>{const Se=new Uint8Array(512),Ee=new Uint8Array(256);(function(){let L=1;for(let ve=0;ve<255;ve++)Se[ve]=L,Ee[L]=ve,L<<=1,256&L&&(L^=285);for(let ve=255;ve<512;ve++)Se[ve]=Se[ve-255]})(),mt.log=function(L){if(L<1)throw new Error("log("+L+")");return Ee[L]},mt.exp=function(L){return Se[L]},mt.mul=function(L,ve){return 0===L||0===ve?0:Se[Ee[L]+Ee[ve]]}},3780:(Yr,mt,Se)=>{const Ee=Se(2321),x=Se(4469);function L(ve){this.mode=Ee.KANJI,this.data=ve}L.getBitsLength=function(ke){return 13*ke},L.prototype.getLength=function(){return this.data.length},L.prototype.getBitsLength=function(){return L.getBitsLength(this.data.length)},L.prototype.write=function(ve){let ke;for(ke=0;ke<this.data.length;ke++){let ot=x.toSJIS(this.data[ke]);if(ot>=33088&&ot<=40956)ot-=33088;else{if(!(ot>=57408&&ot<=60351))throw new Error("Invalid SJIS character: "+this.data[ke]+"\nMake sure your charset is UTF-8");ot-=49472}ot=192*(ot>>>8&255)+(255&ot),ve.put(ot,13)}},Yr.exports=L},357:(Yr,mt)=>{mt.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};function Ee(x,L,ve){switch(x){case mt.Patterns.PATTERN000:return(L+ve)%2==0;case mt.Patterns.PATTERN001:return L%2==0;case mt.Patterns.PATTERN010:return ve%3==0;case mt.Patterns.PATTERN011:return(L+ve)%3==0;case mt.Patterns.PATTERN100:return(Math.floor(L/2)+Math.floor(ve/3))%2==0;case mt.Patterns.PATTERN101:return L*ve%2+L*ve%3==0;case mt.Patterns.PATTERN110:return(L*ve%2+L*ve%3)%2==0;case mt.Patterns.PATTERN111:return(L*ve%3+(L+ve)%2)%2==0;default:throw new Error("bad maskPattern:"+x)}}mt.isValid=function(L){return null!=L&&""!==L&&!isNaN(L)&&L>=0&&L<=7},mt.from=function(L){return mt.isValid(L)?parseInt(L,10):void 0},mt.getPenaltyN1=function(L){const ve=L.size;let ke=0,ot=0,Ye=0,Ze=null,Re=null;for(let He=0;He<ve;He++){ot=Ye=0,Ze=Re=null;for(let Ve=0;Ve<ve;Ve++){let De=L.get(He,Ve);De===Ze?ot++:(ot>=5&&(ke+=ot-5+3),Ze=De,ot=1),De=L.get(Ve,He),De===Re?Ye++:(Ye>=5&&(ke+=Ye-5+3),Re=De,Ye=1)}ot>=5&&(ke+=ot-5+3),Ye>=5&&(ke+=Ye-5+3)}return ke},mt.getPenaltyN2=function(L){const ve=L.size;let ke=0;for(let ot=0;ot<ve-1;ot++)for(let Ye=0;Ye<ve-1;Ye++){const Ze=L.get(ot,Ye)+L.get(ot,Ye+1)+L.get(ot+1,Ye)+L.get(ot+1,Ye+1);(4===Ze||0===Ze)&&ke++}return 3*ke},mt.getPenaltyN3=function(L){const ve=L.size;let ke=0,ot=0,Ye=0;for(let Ze=0;Ze<ve;Ze++){ot=Ye=0;for(let Re=0;Re<ve;Re++)ot=ot<<1&2047|L.get(Ze,Re),Re>=10&&(1488===ot||93===ot)&&ke++,Ye=Ye<<1&2047|L.get(Re,Ze),Re>=10&&(1488===Ye||93===Ye)&&ke++}return 40*ke},mt.getPenaltyN4=function(L){let ve=0;const ke=L.data.length;for(let Ye=0;Ye<ke;Ye++)ve+=L.data[Ye];return 10*Math.abs(Math.ceil(100*ve/ke/5)-10)},mt.applyMask=function(L,ve){const ke=ve.size;for(let ot=0;ot<ke;ot++)for(let Ye=0;Ye<ke;Ye++)ve.isReserved(Ye,ot)||ve.xor(Ye,ot,Ee(L,Ye,ot))},mt.getBestMask=function(L,ve){const ke=Object.keys(mt.Patterns).length;let ot=0,Ye=1/0;for(let Ze=0;Ze<ke;Ze++){ve(Ze),mt.applyMask(Ze,L);const Re=mt.getPenaltyN1(L)+mt.getPenaltyN2(L)+mt.getPenaltyN3(L)+mt.getPenaltyN4(L);mt.applyMask(Ze,L),Re<Ye&&(Ye=Re,ot=Ze)}return ot}},2321:(Yr,mt,Se)=>{const Ee=Se(9797),x=Se(9091);mt.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},mt.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},mt.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},mt.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},mt.MIXED={bit:-1},mt.getCharCountIndicator=function(ke,ot){if(!ke.ccBits)throw new Error("Invalid mode: "+ke);if(!Ee.isValid(ot))throw new Error("Invalid version: "+ot);return ot>=1&&ot<10?ke.ccBits[0]:ot<27?ke.ccBits[1]:ke.ccBits[2]},mt.getBestModeForData=function(ke){return x.testNumeric(ke)?mt.NUMERIC:x.testAlphanumeric(ke)?mt.ALPHANUMERIC:x.testKanji(ke)?mt.KANJI:mt.BYTE},mt.toString=function(ke){if(ke&&ke.id)return ke.id;throw new Error("Invalid mode")},mt.isValid=function(ke){return ke&&ke.bit&&ke.ccBits},mt.from=function(ke,ot){if(mt.isValid(ke))return ke;try{return function L(ve){if("string"!=typeof ve)throw new Error("Param is not a string");switch(ve.toLowerCase()){case"numeric":return mt.NUMERIC;case"alphanumeric":return mt.ALPHANUMERIC;case"kanji":return mt.KANJI;case"byte":return mt.BYTE;default:throw new Error("Unknown mode: "+ve)}}(ke)}catch{return ot}}},1200:(Yr,mt,Se)=>{const Ee=Se(2321);function x(L){this.mode=Ee.NUMERIC,this.data=L.toString()}x.getBitsLength=function(ve){return 10*Math.floor(ve/3)+(ve%3?ve%3*3+1:0)},x.prototype.getLength=function(){return this.data.length},x.prototype.getBitsLength=function(){return x.getBitsLength(this.data.length)},x.prototype.write=function(ve){let ke,ot,Ye;for(ke=0;ke+3<=this.data.length;ke+=3)ot=this.data.substr(ke,3),Ye=parseInt(ot,10),ve.put(Ye,10);const Ze=this.data.length-ke;Ze>0&&(ot=this.data.substr(ke),Ye=parseInt(ot,10),ve.put(Ye,3*Ze+1))},Yr.exports=x},8116:(Yr,mt,Se)=>{const Ee=Se(3010);mt.mul=function(L,ve){const ke=new Uint8Array(L.length+ve.length-1);for(let ot=0;ot<L.length;ot++)for(let Ye=0;Ye<ve.length;Ye++)ke[ot+Ye]^=Ee.mul(L[ot],ve[Ye]);return ke},mt.mod=function(L,ve){let ke=new Uint8Array(L);for(;ke.length-ve.length>=0;){const ot=ke[0];for(let Ze=0;Ze<ve.length;Ze++)ke[Ze]^=Ee.mul(ve[Ze],ot);let Ye=0;for(;Ye<ke.length&&0===ke[Ye];)Ye++;ke=ke.slice(Ye)}return ke},mt.generateECPolynomial=function(L){let ve=new Uint8Array([1]);for(let ke=0;ke<L;ke++)ve=mt.mul(ve,new Uint8Array([1,Ee.exp(ke)]));return ve}},64:(Yr,mt,Se)=>{const Ee=Se(4469),x=Se(6196),L=Se(7930),ve=Se(6393),ke=Se(1650),ot=Se(6745),Ye=Se(357),Ze=Se(505),Re=Se(2389),He=Se(112),Ve=Se(7402),De=Se(2321),F=Se(584);function me(E,g,v){const f=E.size,C=Ve.getEncodedBits(g,v);let I,U;for(I=0;I<15;I++)U=1==(C>>I&1),E.set(I<6?I:I<8?I+1:f-15+I,8,U,!0),E.set(8,I<8?f-I-1:I<9?15-I-1+1:15-I-1,U,!0);E.set(f-8,8,1,!0)}function A(E,g,v,f){let C;if(Array.isArray(E))C=F.fromArray(E);else{if("string"!=typeof E)throw new Error("Invalid data");{let ee=g;if(!ee){const he=F.rawSplit(E);ee=He.getBestVersionForData(he,v)}C=F.fromString(E,ee||40)}}const I=He.getBestVersionForData(C,v);if(!I)throw new Error("The amount of data is too big to be stored in a QR Code");if(g){if(g<I)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+I+".\n")}else g=I;const U=function B(E,g,v){const f=new L;v.forEach(function(Z){f.put(Z.mode.bit,4),f.put(Z.getLength(),De.getCharCountIndicator(Z.mode,E)),Z.write(f)});const U=8*(Ee.getSymbolTotalCodewords(E)-Ze.getTotalCodewordsCount(E,g));for(f.getLengthInBits()+4<=U&&f.put(0,4);f.getLengthInBits()%8!=0;)f.putBit(0);const k=(U-f.getLengthInBits())/8;for(let Z=0;Z<k;Z++)f.put(Z%2?17:236,8);return function $(E,g,v){const f=Ee.getSymbolTotalCodewords(g),I=f-Ze.getTotalCodewordsCount(g,v),U=Ze.getBlocksCount(g,v),Z=U-f%U,ee=Math.floor(f/U),he=Math.floor(I/U),G=he+1,b=ee-he,P=new Re(b);let T=0;const z=new Array(U),W=new Array(U);let fe=0;const we=new Uint8Array(E.buffer);for(let bt=0;bt<U;bt++){const te=bt<Z?he:G;z[bt]=we.slice(T,T+te),W[bt]=P.encode(z[bt]),T+=te,fe=Math.max(fe,te)}const Me=new Uint8Array(f);let Ge,lt,je=0;for(Ge=0;Ge<fe;Ge++)for(lt=0;lt<U;lt++)Ge<z[lt].length&&(Me[je++]=z[lt][Ge]);for(Ge=0;Ge<b;Ge++)for(lt=0;lt<U;lt++)Me[je++]=W[lt][Ge];return Me}(f,E,g)}(g,v,C),k=Ee.getSymbolSize(g),Z=new ve(k);return function J(E,g){const v=E.size,f=ot.getPositions(g);for(let C=0;C<f.length;C++){const I=f[C][0],U=f[C][1];for(let k=-1;k<=7;k++)if(!(I+k<=-1||v<=I+k))for(let Z=-1;Z<=7;Z++)U+Z<=-1||v<=U+Z||E.set(I+k,U+Z,k>=0&&k<=6&&(0===Z||6===Z)||Z>=0&&Z<=6&&(0===k||6===k)||k>=2&&k<=4&&Z>=2&&Z<=4,!0)}}(Z,g),function Y(E){const g=E.size;for(let v=8;v<g-8;v++){const f=v%2==0;E.set(v,6,f,!0),E.set(6,v,f,!0)}}(Z),function ue(E,g){const v=ke.getPositions(g);for(let f=0;f<v.length;f++){const C=v[f][0],I=v[f][1];for(let U=-2;U<=2;U++)for(let k=-2;k<=2;k++)E.set(C+U,I+k,-2===U||2===U||-2===k||2===k||0===U&&0===k,!0)}}(Z,g),me(Z,v,0),g>=7&&function Q(E,g){const v=E.size,f=He.getEncodedBits(g);let C,I,U;for(let k=0;k<18;k++)C=Math.floor(k/3),I=k%3+v-8-3,U=1==(f>>k&1),E.set(C,I,U,!0),E.set(I,C,U,!0)}(Z,g),function X(E,g){const v=E.size;let f=-1,C=v-1,I=7,U=0;for(let k=v-1;k>0;k-=2)for(6===k&&k--;;){for(let Z=0;Z<2;Z++)if(!E.isReserved(C,k-Z)){let ee=!1;U<g.length&&(ee=1==(g[U]>>>I&1)),E.set(C,k-Z,ee),I--,-1===I&&(U++,I=7)}if(C+=f,C<0||v<=C){C-=f,f=-f;break}}}(Z,U),isNaN(f)&&(f=Ye.getBestMask(Z,me.bind(null,Z,v))),Ye.applyMask(f,Z),me(Z,v,f),{modules:Z,version:g,errorCorrectionLevel:v,maskPattern:f,segments:C}}mt.create=function(g,v){if(typeof g>"u"||""===g)throw new Error("No input text");let C,I,f=x.M;return typeof v<"u"&&(f=x.from(v.errorCorrectionLevel,x.M),C=He.from(v.version),I=Ye.from(v.maskPattern),v.toSJISFunc&&Ee.setToSJISFunction(v.toSJISFunc)),A(g,C,f,I)}},2389:(Yr,mt,Se)=>{const Ee=Se(8116);function x(L){this.genPoly=void 0,this.degree=L,this.degree&&this.initialize(this.degree)}x.prototype.initialize=function(ve){this.degree=ve,this.genPoly=Ee.generateECPolynomial(this.degree)},x.prototype.encode=function(ve){if(!this.genPoly)throw new Error("Encoder not initialized");const ke=new Uint8Array(ve.length+this.degree);ke.set(ve);const ot=Ee.mod(ke,this.genPoly),Ye=this.degree-ot.length;if(Ye>0){const Ze=new Uint8Array(this.degree);return Ze.set(ot,Ye),Ze}return ot},Yr.exports=x},9091:(Yr,mt)=>{let x="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";x=x.replace(/u/g,"\\u");const L="(?:(?![A-Z0-9 $%*+\\-./:]|"+x+")(?:.|[\r\n]))+";mt.KANJI=new RegExp(x,"g"),mt.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),mt.BYTE=new RegExp(L,"g"),mt.NUMERIC=new RegExp("[0-9]+","g"),mt.ALPHANUMERIC=new RegExp("[A-Z $%*+\\-./:]+","g");const ve=new RegExp("^"+x+"$"),ke=new RegExp("^[0-9]+$"),ot=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");mt.testKanji=function(Ze){return ve.test(Ze)},mt.testNumeric=function(Ze){return ke.test(Ze)},mt.testAlphanumeric=function(Ze){return ot.test(Ze)}},584:(Yr,mt,Se)=>{const Ee=Se(2321),x=Se(1200),L=Se(742),ve=Se(2333),ke=Se(3780),ot=Se(9091),Ye=Se(4469),Ze=Se(2623);function Re(Q){return unescape(encodeURIComponent(Q)).length}function He(Q,me,X){const B=[];let $;for(;null!==($=Q.exec(X));)B.push({data:$[0],index:$.index,mode:me,length:$[0].length});return B}function Ve(Q){const me=He(ot.NUMERIC,Ee.NUMERIC,Q),X=He(ot.ALPHANUMERIC,Ee.ALPHANUMERIC,Q);let B,$;return Ye.isKanjiModeEnabled()?(B=He(ot.BYTE,Ee.BYTE,Q),$=He(ot.KANJI,Ee.KANJI,Q)):(B=He(ot.BYTE_KANJI,Ee.BYTE,Q),$=[]),me.concat(X,B,$).sort(function(E,g){return E.index-g.index}).map(function(E){return{data:E.data,mode:E.mode,length:E.length}})}function De(Q,me){switch(me){case Ee.NUMERIC:return x.getBitsLength(Q);case Ee.ALPHANUMERIC:return L.getBitsLength(Q);case Ee.KANJI:return ke.getBitsLength(Q);case Ee.BYTE:return ve.getBitsLength(Q)}}function ue(Q,me){let X;const B=Ee.getBestModeForData(Q);if(X=Ee.from(me,B),X!==Ee.BYTE&&X.bit<B.bit)throw new Error('"'+Q+'" cannot be encoded with mode '+Ee.toString(X)+".\n Suggested mode is: "+Ee.toString(B));switch(X===Ee.KANJI&&!Ye.isKanjiModeEnabled()&&(X=Ee.BYTE),X){case Ee.NUMERIC:return new x(Q);case Ee.ALPHANUMERIC:return new L(Q);case Ee.KANJI:return new ke(Q);case Ee.BYTE:return new ve(Q)}}mt.fromArray=function(me){return me.reduce(function(X,B){return"string"==typeof B?X.push(ue(B,null)):B.data&&X.push(ue(B.data,B.mode)),X},[])},mt.fromString=function(me,X){const $=function J(Q){const me=[];for(let X=0;X<Q.length;X++){const B=Q[X];switch(B.mode){case Ee.NUMERIC:me.push([B,{data:B.data,mode:Ee.ALPHANUMERIC,length:B.length},{data:B.data,mode:Ee.BYTE,length:B.length}]);break;case Ee.ALPHANUMERIC:me.push([B,{data:B.data,mode:Ee.BYTE,length:B.length}]);break;case Ee.KANJI:me.push([B,{data:B.data,mode:Ee.BYTE,length:Re(B.data)}]);break;case Ee.BYTE:me.push([{data:B.data,mode:Ee.BYTE,length:Re(B.data)}])}}return me}(Ve(me,Ye.isKanjiModeEnabled())),A=function Y(Q,me){const X={},B={start:{}};let $=["start"];for(let A=0;A<Q.length;A++){const E=Q[A],g=[];for(let v=0;v<E.length;v++){const f=E[v],C=""+A+v;g.push(C),X[C]={node:f,lastCount:0},B[C]={};for(let I=0;I<$.length;I++){const U=$[I];X[U]&&X[U].node.mode===f.mode?(B[U][C]=De(X[U].lastCount+f.length,f.mode)-De(X[U].lastCount,f.mode),X[U].lastCount+=f.length):(X[U]&&(X[U].lastCount=f.length),B[U][C]=De(f.length,f.mode)+4+Ee.getCharCountIndicator(f.mode,me))}}$=g}for(let A=0;A<$.length;A++)B[$[A]].end=0;return{map:B,table:X}}($,X),E=Ze.find_path(A.map,"start","end"),g=[];for(let v=1;v<E.length-1;v++)g.push(A.table[E[v]].node);return mt.fromArray(function F(Q){return Q.reduce(function(me,X){const B=me.length-1>=0?me[me.length-1]:null;return B&&B.mode===X.mode?(me[me.length-1].data+=X.data,me):(me.push(X),me)},[])}(g))},mt.rawSplit=function(me){return mt.fromArray(Ve(me,Ye.isKanjiModeEnabled()))}},4469:(Yr,mt)=>{let Se;const Ee=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];mt.getSymbolSize=function(L){if(!L)throw new Error('"version" cannot be null or undefined');if(L<1||L>40)throw new Error('"version" should be in range from 1 to 40');return 4*L+17},mt.getSymbolTotalCodewords=function(L){return Ee[L]},mt.getBCHDigit=function(x){let L=0;for(;0!==x;)L++,x>>>=1;return L},mt.setToSJISFunction=function(L){if("function"!=typeof L)throw new Error('"toSJISFunc" is not a valid function.');Se=L},mt.isKanjiModeEnabled=function(){return typeof Se<"u"},mt.toSJIS=function(L){return Se(L)}},9797:(Yr,mt)=>{mt.isValid=function(Ee){return!isNaN(Ee)&&Ee>=1&&Ee<=40}},112:(Yr,mt,Se)=>{const Ee=Se(4469),x=Se(505),L=Se(6196),ve=Se(2321),ke=Se(9797),Ye=Ee.getBCHDigit(7973);function Re(De,F){return ve.getCharCountIndicator(De,F)+4}function He(De,F){let J=0;return De.forEach(function(Y){const ue=Re(Y.mode,F);J+=ue+Y.getBitsLength()}),J}mt.from=function(F,J){return ke.isValid(F)?parseInt(F,10):J},mt.getCapacity=function(F,J,Y){if(!ke.isValid(F))throw new Error("Invalid QR Code version");typeof Y>"u"&&(Y=ve.BYTE);const me=8*(Ee.getSymbolTotalCodewords(F)-x.getTotalCodewordsCount(F,J));if(Y===ve.MIXED)return me;const X=me-Re(Y,F);switch(Y){case ve.NUMERIC:return Math.floor(X/10*3);case ve.ALPHANUMERIC:return Math.floor(X/11*2);case ve.KANJI:return Math.floor(X/13);default:return Math.floor(X/8)}},mt.getBestVersionForData=function(F,J){let Y;const ue=L.from(J,L.M);if(Array.isArray(F)){if(F.length>1)return function Ve(De,F){for(let J=1;J<=40;J++)if(He(De,J)<=mt.getCapacity(J,F,ve.MIXED))return J}(F,ue);if(0===F.length)return 1;Y=F[0]}else Y=F;return function Ze(De,F,J){for(let Y=1;Y<=40;Y++)if(F<=mt.getCapacity(Y,J,De))return Y}(Y.mode,Y.getLength(),ue)},mt.getEncodedBits=function(F){if(!ke.isValid(F)||F<7)throw new Error("Invalid QR Code version");let J=F<<12;for(;Ee.getBCHDigit(J)-Ye>=0;)J^=7973<<Ee.getBCHDigit(J)-Ye;return F<<12|J}},7282:(Yr,mt,Se)=>{const Ee=Se(7569);mt.render=function(ke,ot,Ye){let Ze=Ye,Re=ot;typeof Ze>"u"&&(!ot||!ot.getContext)&&(Ze=ot,ot=void 0),ot||(Re=function L(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}()),Ze=Ee.getOptions(Ze);const He=Ee.getImageWidth(ke.modules.size,Ze),Ve=Re.getContext("2d"),De=Ve.createImageData(He,He);return Ee.qrToImageData(De.data,ke,Ze),function x(ve,ke,ot){ve.clearRect(0,0,ke.width,ke.height),ke.style||(ke.style={}),ke.height=ot,ke.width=ot,ke.style.height=ot+"px",ke.style.width=ot+"px"}(Ve,Re,He),Ve.putImageData(De,0,0),Re},mt.renderToDataURL=function(ke,ot,Ye){let Ze=Ye;return typeof Ze>"u"&&(!ot||!ot.getContext)&&(Ze=ot,ot=void 0),Ze||(Ze={}),mt.render(ke,ot,Ze).toDataURL(Ze.type||"image/png",(Ze.rendererOpts||{}).quality)}},5099:(Yr,mt,Se)=>{const Ee=Se(7569);function x(ke,ot){const Ye=ke.a/255,Ze=ot+'="'+ke.hex+'"';return Ye<1?Ze+" "+ot+'-opacity="'+Ye.toFixed(2).slice(1)+'"':Ze}function L(ke,ot,Ye){let Ze=ke+ot;return typeof Ye<"u"&&(Ze+=" "+Ye),Ze}mt.render=function(ot,Ye,Ze){const Re=Ee.getOptions(Ye),He=ot.modules.size,Ve=ot.modules.data,De=He+2*Re.margin,F=Re.color.light.a?"<path "+x(Re.color.light,"fill")+' d="M0 0h'+De+"v"+De+'H0z"/>':"",J="<path "+x(Re.color.dark,"stroke")+' d="'+function ve(ke,ot,Ye){let Ze="",Re=0,He=!1,Ve=0;for(let De=0;De<ke.length;De++){const F=Math.floor(De%ot),J=Math.floor(De/ot);!F&&!He&&(He=!0),ke[De]?(Ve++,De>0&&F>0&&ke[De-1]||(Ze+=He?L("M",F+Ye,.5+J+Ye):L("m",Re,0),Re=0,He=!1),F+1<ot&&ke[De+1]||(Ze+=L("h",Ve),Ve=0)):Re++}return Ze}(Ve,He,Re.margin)+'"/>',Q='<svg xmlns="http://www.w3.org/2000/svg" '+(Re.width?'width="'+Re.width+'" height="'+Re.width+'" ':"")+'viewBox="0 0 '+De+" "+De+'" shape-rendering="crispEdges">'+F+J+"</svg>\n";return"function"==typeof Ze&&Ze(null,Q),Q}},7569:(Yr,mt)=>{function Se(Ee){if("number"==typeof Ee&&(Ee=Ee.toString()),"string"!=typeof Ee)throw new Error("Color should be defined as hex string");let x=Ee.slice().replace("#","").split("");if(x.length<3||5===x.length||x.length>8)throw new Error("Invalid hex color: "+Ee);(3===x.length||4===x.length)&&(x=Array.prototype.concat.apply([],x.map(function(ve){return[ve,ve]}))),6===x.length&&x.push("F","F");const L=parseInt(x.join(""),16);return{r:L>>24&255,g:L>>16&255,b:L>>8&255,a:255&L,hex:"#"+x.slice(0,6).join("")}}mt.getOptions=function(x){x||(x={}),x.color||(x.color={});const ve=x.width&&x.width>=21?x.width:void 0;return{width:ve,scale:ve?4:x.scale||4,margin:typeof x.margin>"u"||null===x.margin||x.margin<0?4:x.margin,color:{dark:Se(x.color.dark||"#000000ff"),light:Se(x.color.light||"#ffffffff")},type:x.type,rendererOpts:x.rendererOpts||{}}},mt.getScale=function(x,L){return L.width&&L.width>=x+2*L.margin?L.width/(x+2*L.margin):L.scale},mt.getImageWidth=function(x,L){const ve=mt.getScale(x,L);return Math.floor((x+2*L.margin)*ve)},mt.qrToImageData=function(x,L,ve){const ke=L.modules.size,ot=L.modules.data,Ye=mt.getScale(ke,ve),Ze=Math.floor((ke+2*ve.margin)*Ye),Re=ve.margin*Ye,He=[ve.color.light,ve.color.dark];for(let Ve=0;Ve<Ze;Ve++)for(let De=0;De<Ze;De++){let F=4*(Ve*Ze+De),J=ve.color.light;Ve>=Re&&De>=Re&&Ve<Ze-Re&&De<Ze-Re&&(J=He[ot[Math.floor((Ve-Re)/Ye)*ke+Math.floor((De-Re)/Ye)]?1:0]),x[F++]=J.r,x[F++]=J.g,x[F++]=J.b,x[F]=J.a}}},6955:function(Yr){Yr.exports=function(){"use strict";var mt=function(){var Se=0,Ee=document.createElement("div");function x(He){return Ee.appendChild(He.dom),He}function L(He){for(var Ve=0;Ve<Ee.children.length;Ve++)Ee.children[Ve].style.display=Ve===He?"block":"none";Se=He}Ee.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",Ee.addEventListener("click",function(He){He.preventDefault(),L(++Se%Ee.children.length)},!1);var ve=(performance||Date).now(),ke=ve,ot=0,Ye=x(new mt.Panel("FPS","#0ff","#002")),Ze=x(new mt.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var Re=x(new mt.Panel("MB","#f08","#201"));return L(0),{REVISION:16,dom:Ee,addPanel:x,showPanel:L,begin:function(){ve=(performance||Date).now()},end:function(){ot++;var He=(performance||Date).now();if(Ze.update(He-ve,200),ke+1e3<=He&&(Ye.update(1e3*ot/(He-ke),100),ke=He,ot=0,Re)){var Ve=performance.memory;Re.update(Ve.usedJSHeapSize/1048576,Ve.jsHeapSizeLimit/1048576)}return He},update:function(){ve=this.end()},domElement:Ee,setMode:L}};return mt.Panel=function(Se,Ee,x){var L=1/0,ve=0,ke=Math.round,ot=ke(window.devicePixelRatio||1),Ye=80*ot,Ze=48*ot,Re=3*ot,He=2*ot,Ve=3*ot,De=15*ot,F=74*ot,J=30*ot,Y=document.createElement("canvas");Y.width=Ye,Y.height=Ze,Y.style.cssText="width:80px;height:48px";var ue=Y.getContext("2d");return ue.font="bold "+9*ot+"px Helvetica,Arial,sans-serif",ue.textBaseline="top",ue.fillStyle=x,ue.fillRect(0,0,Ye,Ze),ue.fillStyle=Ee,ue.fillText(Se,Re,He),ue.fillRect(Ve,De,F,J),ue.fillStyle=x,ue.globalAlpha=.9,ue.fillRect(Ve,De,F,J),{dom:Y,update:function(Q,me){L=Math.min(L,Q),ve=Math.max(ve,Q),ue.fillStyle=x,ue.globalAlpha=1,ue.fillRect(0,0,Ye,De),ue.fillStyle=Ee,ue.fillText(ke(Q)+" "+Se+" ("+ke(L)+"-"+ke(ve)+")",Re,He),ue.drawImage(Y,Ve+ot,De,F-ot,J,Ve,De,F-ot,J),ue.fillRect(Ve+F-ot,De,ot,J),ue.fillStyle=x,ue.globalAlpha=.9,ue.fillRect(Ve+F-ot,De,ot,ke((1-Q/me)*J))}}},mt}()},4882:(Yr,mt,Se)=>{"use strict";function Ee(L,ve,ke,ot,Ye,Ze,Re){try{var He=L[Ze](Re),Ve=He.value}catch(De){return void ke(De)}He.done?ve(Ve):Promise.resolve(Ve).then(ot,Ye)}function x(L){return function(){var ve=this,ke=arguments;return new Promise(function(ot,Ye){var Ze=L.apply(ve,ke);function Re(Ve){Ee(Ze,ot,Ye,Re,He,"next",Ve)}function He(Ve){Ee(Ze,ot,Ye,Re,He,"throw",Ve)}Re(void 0)})}}Se.d(mt,{A:()=>x})},2843:(Yr,mt,Se)=>{"use strict";Se.d(mt,{Mw:()=>Ve,NM:()=>De,Ru:()=>Q,Vm:()=>B,YF:()=>He,b8:()=>F,bk:()=>ue,lf:()=>J,lg:()=>Ze,md:()=>Ye,nC:()=>Re,xh:()=>ot});var Ee=Se(4882),x=Se(8362),L=Se(8872),ve=Se(4246),ke=Se(3147);function ot(A,E){if(!A||A.empty())return{x:0,y:0,width:0,height:0};if((0,L.isNodeJs)()&&"bbox"!==E||A.property("_batch_mode"))return{x:0,y:0,width:parseInt(A.attr("width")),height:parseInt(A.attr("height"))};const g=C=>{let I=A.style(C);return I&&(0,L.isStr)(I)?(I=parseFloat(I.replace("px","")),Number.isFinite(I)?Math.round(I):0):0};let v=A.node().getBoundingClientRect();"bbox"===E&&parseFloat(v.width)>0&&(v=A.node().getBBox());const f={x:0,y:0,width:parseInt(v.width),height:parseInt(v.height)};return void 0!==v.left?(f.x=parseInt(v.left),f.y=parseInt(v.top)):void 0!==v.x&&(f.x=parseInt(v.x),f.y=parseInt(v.y)),(void 0===E||"nopadding"===E)&&(f.width-=g("padding-left")+g("padding-right"),f.height-=g("padding-top")+g("padding-bottom")),f}function Ye(A,E){if(!E)return E;for(;!A.empty()&&!A.classed("root_canvas");){const g=A.attr("class");g&&(g.indexOf("root_frame")>=0||g.indexOf("__root_pad_")>=0)&&(E.x+=A.property("draw_x")||0,E.y+=A.property("draw_y")||0),A=(0,x.Lt)(A.node().parentNode)}return E}function Ze(A,E,g){E||(E="6.4g");const v=(E=E.trim()).length;if(v<2)return g?[A.toFixed(4),"6.4f"]:A.toFixed(4);const f=E[v-1];let C,I=(E=E.slice(0,v-1)).indexOf(".");I=I<0?4:parseInt(E.slice(I+1)),(!Number.isInteger(I)||I<=0)&&(I=4);let U=!1;if("e"===f||"E"===f)C=!0;else if("Q"===f)C=!0,U=!0;else if("f"===f||"F"===f)C=!1;else if("W"===f)C=!1,U=!0;else{if("g"===f||"G"===f){const Z=Ze(A,E+"Q",!0);let ee=Ze(A,E+"W",!0);return Z[0].length<ee[0].length&&(ee=Z),g?ee:ee[0]}C=!1,I=4}if(C){U&&I--,I<0&&(I=0);const Z=A.toExponential(I);return g?[Z,`5.${I}e`]:Z}let k=A.toFixed(I);if(U){0!==A&&0===Number(k)&&I>0&&(I=20,k=A.toFixed(I));let Z=0;for(;Z<k.length&&("0"===k[Z]||"-"===k[Z]||"."===k[Z]);)Z++;let ee=k.length-Z-I;k.indexOf(".")>Z&&ee--,0!==ee&&(I-=ee,I<0?I=0:I>20&&(I=20),k=A.toFixed(I))}return g?[k,"5."+I+"f"]:k}class Re{constructor(E){this.opt=(0,L.isStr)(E)?E.toUpperCase().trim():"",this.part=""}empty(){return 0===this.opt.length||0===this.opt.replace(/[ ;_,]/g,"").length}remain(){return this.opt}check(E,g){const v=this.opt.indexOf(E);if(v<0)return!1;if(this.opt=this.opt.slice(0,v)+this.opt.slice(v+E.length),this.part="",!g)return!0;let f=v;for(;f<this.opt.length&&" "!==this.opt[f]&&","!==this.opt[f]&&";"!==this.opt[f];)f++;return f>v&&(this.part=this.opt.slice(v,f),this.opt=this.opt.slice(0,v)+this.opt.slice(f)),!0}partAsInt(E,g){let v=1;const f=this.part?this.part[this.part.length-1]:"";"K"===f?v=1e3:"M"===f?v=1e6:"G"===f&&(v=1e9);let C=this.part.replace(/^\D+/g,"");return C=C?parseInt(C,10):Number.NaN,Number.isInteger(C)?v*C+(E||0):g||0}partAsFloat(E,g){let v=this.part.replace(/^\D+/g,"");return v=v?parseFloat(v):Number.NaN,Number.isFinite(v)?v+(E||0):g||0}}class He{constructor(E){void 0!==E&&this.seed(E)}seed(E){(E=Math.abs(E))>1e8?E=Math.abs(1e8*Math.sin(E)):E<1&&(E*=1e8),this.m_w=Math.round(E),this.m_z=987654321}random(){if(void 0===this.m_z)return Math.random();this.m_z=36969*(65535&this.m_z)+(this.m_z>>16)&4294967295,this.m_w=18e3*(65535&this.m_w)+(this.m_w>>16)&4294967295;let E=(this.m_z<<16)+this.m_w&4294967295;return E/=4294967296,E+.5}}function Ve(A,E){E||(E={}),E.line?void 0===E.ndig&&(E.ndig=0):E.calc=!0;let g=A.length;if(g<3&&(E.line=!0),E.t=E.t??.2,void 0===E.ndig||E.height){E.maxy=A[0].gry,E.mindiff=100;for(let I=1;I<g;I++)E.maxy=Math.max(E.maxy,A[I].gry),E.mindiff=Math.min(E.mindiff,Math.abs(A[I].grx-A[I-1].grx),Math.abs(A[I].gry-A[I-1].gry));void 0===E.ndig&&(E.ndig=E.mindiff>20?0:E.mindiff>5?1:2)}const v=(I,U,k)=>{const Z=Math.sqrt((U.gry-I.gry)**2+(U.grx-I.grx)**2)*E.t,ee=Math.atan2(U.dgry,U.dgrx),he=Math.atan2(k*(U.gry-I.gry),k*(U.grx-I.grx));I.dgrx=Z*Math.cos(2*he-ee),I.dgry=Z*Math.sin(2*he-ee)},f=I=>{if(!E.ndig||Math.round(I)===I)return I.toFixed(0);let U=I.toFixed(E.ndig),k=U.length-1;for(;"0"===U[k];)k--;return"."===U[k]&&k--,U=U.slice(0,k+1),"-0"===U?"0":U};if(E.calc){for(let I=1;I<g-1;I++)A[I].dgrx=(A[I+1].grx-A[I-1].grx)*E.t,A[I].dgry=(A[I+1].gry-A[I-1].gry)*E.t;g>2?(v(A[0],A[1],1),v(A[g-1],A[g-2],-1)):2===A.length&&(A[0].dgrx=(A[1].grx-A[0].grx)*E.t,A[0].dgry=(A[1].gry-A[0].gry)*E.t,A[1].dgrx=-A[0].dgrx,A[1].dgry=-A[0].dgry)}let C=`${E.cmd??"M"}${f(A[0].grx)},${f(A[0].gry)}`;if(E.line)if(g<1e4){let I=0,U=0,k=Math.round(A[0].grx),Z=Math.round(A[0].gry);const ee=()=>{I&&(C+="h"+I,I=0),U&&(C+="v"+U,U=0)};for(let he=1;he<g;++he){const G=A[he],b=Math.round(G.grx)-k,P=Math.round(G.gry)-Z;b&&P?(ee(),C+=`l${b},${P}`):!b&&P?((0===U||P<0!=U<0)&&ee(),U+=P):b&&!P&&((0===I||b<0!=I<0)&&ee(),I+=b),k+=b,Z+=P}ee()}else{let I=Math.round(A[0].grx),U=Math.round(A[0].gry),k=U,Z=U,ee=U;for(let he=1;he<g;++he){const G=A[he],b=Math.round(G.grx),P=Math.round(G.gry),T=b-I;if(0===T){k=Math.min(k,P),Z=Math.max(Z,P),ee=P;continue}k!==Z&&(k!==U&&(C+="v"+(k-U)),C+="v"+(Z-k),Z!==ee&&(C+="v"+(ee-Z)),U=ee);const z=P-U;C+=z?`l${T},${z}`:`h${T}`,I=b,U=P,ee=k=Z=P}k!==Z&&(k!==U&&(C+="v"+(k-U)),C+="v"+(Z-k),Z!==ee&&(C+="v"+(ee-Z)))}else{let I=1;E.qubic&&(g--,I++,C+=`Q${f(A[1].grx-A[1].dgrx)},${f(A[1].gry-A[1].dgry)},${f(A[1].grx)},${f(A[1].gry)}`),C+=`C${f(A[I-1].grx+A[I-1].dgrx)},${f(A[I-1].gry+A[I-1].dgry)},${f(A[I].grx-A[I].dgrx)},${f(A[I].gry-A[I].dgry)},${f(A[I].grx)},${f(A[I].gry)}`;for(let U=I+1;U<g;U++)C+=`S${f(A[U].grx-A[U].dgrx)},${f(A[U].gry-A[U].dgry)},${f(A[U].grx)},${f(A[U].gry)}`;E.qubic&&(C+=`Q${f(A[g].grx-A[g].dgrx)},${f(A[g].gry-A[g].dgry)},${f(A[g].grx)},${f(A[g].gry)}`)}return E.height&&(E.close=`L${f(A[A.length-1].grx)},${f(Math.max(E.maxy,E.height))}H${f(A[0].grx)}Z`),C}function De(A){return(A=A.replace(/url\(&quot;#(\w+)&quot;\)/g,"url(#$1)").replace(/ class="\w*"/g,"").replace(/ pad="\w*"/g,"").replace(/ title=""/g,"").replace(/<g objname="\w*" objtype="\w*"/g,"<g").replace(/<g transform="translate\(\d+,\d+\)"><\/g>/g,"").replace(/<g><\/g>/g,"")).replace(/<svg x="0" y="0" overflow="hidden" width="\d+" height="\d+" viewBox="0 0 \d+ \d+"><\/svg>/g,"")}class F{constructor(E){this.divid=null,E&&this.setDom(E)}setDom(E){void 0!==E&&(this.divid=E,delete this._selected_main)}getDom(){return this.divid}selectDom(E){if(!this.divid)return(0,x.Lt)(null);let g=this._selected_main;if(!g){if((0,L.isStr)(this.divid)){let I=this.divid;"#"!==I[0]&&(I="#"+I),g=(0,x.Lt)(I),g.empty()||(this.divid=g.node())}else g=(0,x.Lt)(this.divid);this._selected_main=g}if(!g||g.empty()||"origin"===E)return g;const v=g.property("use_enlarge"),C="simple"===(g.property("layout")||"simple")?"":g.property("layout_selector");return C&&(g=g.select(C)),!E&&!g.empty()&&v&&(g=(0,x.Lt)((0,L.getDocument)().getElementById("jsroot_enlarge_div"))),g}_accessTopPainter(E){const g=this.selectDom().node()?.firstChild;return g?(!0===E?g.painter=this:!1===E&&delete g.painter,g.painter):null}setTopPainter(){this._accessTopPainter(!0)}getTopPainter(){return this._accessTopPainter()}clearTopPainter(){this._accessTopPainter(!1)}cleanup(E){this.clearTopPainter();const g=this.selectDom("origin");!g.empty()&&!E&&g.html(""),this.divid=null,delete this._selected_main,(0,L.isFunc)(this._hpainter?.removePainter)&&this._hpainter.removePainter(this),delete this._hitemname,delete this._hdrawopt,delete this._hpainter}checkResize(){}testMainResize(E,g,v){const f=this.enlargeMain("state"),C=this.selectDom("origin"),I=this.selectDom();"on"!==f&&g?.width&&g?.height&&C.style("width",g.width+"px").style("height",g.height+"px");const k=ot(C,!0),Z=C.attr("can_resize");let ee=!1;"height"===Z&&v&&Math.abs(k.width*v-k.height)>.1*k.width&&(ee=!0),(k.height<=5||k.width<=5)&&Z&&"false"!==Z&&(ee=!0),ee&&"on"!==f&&(k.width>5?(v=v||.66,C.style("height",Math.round(k.width*v)+"px")):"height"!==Z&&C.style("width","200px").style("height","100px"));const he=ot(I),G=I.property("_jsroot_height"),b=I.property("_jsroot_width");return he.changed=!1,G&&b&&G>0&&b>0?(G!==he.height||b!==he.width)&&(he.changed=E>1||he.width/b<.99||he.width/b>1.01||he.height/G<.99||he.height/G>1.01):he.changed=!0,he.changed&&I.property("_jsroot_height",he.height).property("_jsroot_width",he.width),C.property("did_enlarge")&&(he.changed=!0,C.property("did_enlarge",!1)),he}enlargeMain(E,g){const v=this.selectDom(!0),f=this.selectDom("origin"),C=(0,L.getDocument)();if(v.empty()||!L.settings.CanEnlarge||!1===f.property("can_enlarge"))return!1;if(void 0===E||"verify"===E)return!0;const I=f.property("use_enlarge")?"on":"off";if("state"===E)return I;"toggle"===E&&(E="off"===I);let U=(0,x.Lt)(C.getElementById("jsroot_enlarge_div"));if(!0===E&&"on"!==I){if(!U.empty())return!1;U=(0,x.Lt)(C.body).append("div").attr("id","jsroot_enlarge_div").attr("style","position: fixed; margin: 0px; border: 0px; padding: 0px; left: 1px; top: 1px; bottom: 1px; right: 1px; background: white; opacity: 0.95; z-index: 100; overflow: hidden;");const k=ot(v),Z=ot(U);if((Z.width<=k.width||Z.height<=k.height)&&Z.width*Z.height<k.width*k.height)return g||console.log(`Enlarged area ${Z.width} x ${Z.height} smaller then original drawing ${k.width} x ${k.height}`),U.remove(),!1;for(;v.node().childNodes.length>0;)U.node().appendChild(v.node().firstChild);return f.property("use_enlarge",!0),f.property("did_enlarge",!0),!0}if(!1===E&&"off"!==I){for(;U.node()&&U.node().childNodes.length>0;)v.node().appendChild(U.node().firstChild);return U.remove(),f.property("use_enlarge",!1),f.property("did_enlarge",!0),!0}return!1}setItemName(E,g,v){(0,L.isStr)(E)?this._hitemname=E:delete this._hitemname,(0,L.isStr)(g)&&(this._hdrawopt=g),this._hpainter=v}getItemName(){return this._hitemname??null}getItemDrawOpt(){return this._hdrawopt??""}}function J(){return Y.apply(this,arguments)}function Y(){return(Y=(0,Ee.A)(function*(){return Se.e(398).then(Se.t.bind(Se,7398,19)).then(A=>(L.internals.nodejs_window||(L.internals.nodejs_window=new A.JSDOM("<!DOCTYPE html>hello").window,L.internals.nodejs_document=L.internals.nodejs_window.document,L.internals.nodejs_body=(0,x.Lt)(L.internals.nodejs_document).select("body")),{JSDOM:A.JSDOM,doc:L.internals.nodejs_document,body:L.internals.nodejs_body}))})).apply(this,arguments)}function ue(A,E,g){(0,L.isObject)(A)||(g=E,E=A,A=null);const v=g?`translate(${E},${g})`:E?`translate(${E})`:null;return A?A.attr("transform",v):v}function Q(A,E){E?A.style("stroke","steelblue").style("fill-opacity","0.1"):A.style("stroke","#4572A7").style("fill","#4572A7").style("opacity","0")}function X(){return(X=(0,Ee.A)(function*(A,E){const g=(0,L.isNodeJs)();let v,f,C=!1;const I=g?Promise.all([Se.e(76),Se.e(360)]).then(Se.bind(Se,7360)).then(G=>(v=G,Promise.all([Se.e(76),Se.e(537)]).then(Se.bind(Se,6537)))).then(G=>{f=G.default}):(0,L.loadScript)(L.source_dir+"scripts/jspdf.umd.min.js").then(()=>(0,L.loadScript)(L.source_dir+"scripts/svg2pdf.umd.min.js")).then(()=>{v=globalThis.jspdf,f=globalThis.svg2pdf}),U=[],k=[],Z=[],ee=A.node.getAttribute("transform"),he={};return A.reset_tranform&&A.node.removeAttribute("transform"),I.then(()=>{if((0,x.Lt)(A.node).selectAll("g").each(function(){this.hasAttribute("font-family")&&"Courier New"===this.getAttribute("font-family")&&(this.setAttribute("font-family","courier"),A.can_modify||U.push(this))}),(0,x.Lt)(A.node).selectAll("text").each(function(){this.hasAttribute("dominant-baseline")?(this.setAttribute("dy",".2em"),this.removeAttribute("dominant-baseline"),A.can_modify||k.push(this)):A.can_modify&&g&&".4em"===this.getAttribute("dy")&&this.setAttribute("dy",".2em"),(0,ke.cp)(this)&&(C=!0,A.can_modify||Z.push(this))}),g){const P=L.internals.nodejs_document;P.oldFunc=P.createElementNS,globalThis.document=P,globalThis.CSSStyleSheet=L.internals.nodejs_window.CSSStyleSheet,globalThis.CSSStyleRule=L.internals.nodejs_window.CSSStyleRule,P.createElementNS=function(T,z){const W=P.oldFunc(T,z);return W.getBBox=function(){let fe=50,we=10;if("text"===this.tagName){const Me=(0,ve.dj)(this);fe=(0,ke.N7)(this.textContent,Me),we=Me.size}return{x:0,y:0,width:fe,height:we}},W}}const G=new v.jsPDF({orientation:"landscape",unit:"px",format:[A.width+10,A.height+10]});(0,x.Lt)(A.node).selectAll("style").each(function(){const P=this.$fonthandler;if(!P||he[P.name]||"ttf"!==P.format)return;const T=P.name.toLowerCase().replace(/\s/g,"")+".ttf";G.addFileToVFS(T,P.base64),G.addFont(T,P.name,"normal","normal","symbol"===P.name?"StandardEncoding":"Identity-H"),he[P.name]=!0});let b=Promise.resolve(!0);return C&&!he.symbol&&((0,ve.Zq)("symbol")||(b=g?Se.e(926).then(Se.t.bind(Se,3926,19)).then(P=>{const T=P.readFileSync("../../fonts/symbol.ttf").toString("base64");console.log("reading symbol.ttf",T.length),(0,ve.uT)(25,"symbol","ttf",T)}):(0,L.httpRequest)(L.source_dir+"fonts/symbol.ttf","bin").then(P=>{const T=(0,L.btoa_func)(P);(0,ve.uT)(25,"symbol","ttf",T)})),b=b.then(()=>{const P=(0,ve.Zq)("symbol"),T=new ve.qg(1242,10);T.name="symbol",T.base64=P.base64,T.addCustomFontToSvg((0,x.Lt)(A.node)),G.addFileToVFS("symbol.ttf",P.base64),G.addFont("symbol.ttf","symbol","normal","normal","StandardEncoding")})),b.then(()=>f.svg2pdf(A.node,G,{x:5,y:5,width:A.width,height:A.height})).then(()=>{A.reset_tranform&&!A.can_modify&&ee&&A.node.setAttribute("transform",ee),U.forEach(T=>T.setAttribute("font-family","Courier New")),k.forEach(T=>{T.setAttribute("dominant-baseline","middle"),T.removeAttribute("dy")}),Z.forEach(T=>{T.innerHTML=T.$originalHTML});const P=G.output(E?"arraybuffer":"dataurlstring");return g&&(globalThis.document=void 0,globalThis.CSSStyleSheet=void 0,globalThis.CSSStyleRule=void 0,L.internals.nodejs_document.createElementNS=L.internals.nodejs_document.oldFunc,E)?Buffer.from(P):P})})})).apply(this,arguments)}function B(A,E,g){return $.apply(this,arguments)}function $(){return $=(0,Ee.A)(function*(A,E,g){if("svg"===E)return A;if("pdf"===E)return function me(A,E){return X.apply(this,arguments)}(A,g);A=(A=encodeURIComponent('<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">'+A)).replace(/%([0-9A-F]{2})/g,(C,I)=>{const U=String.fromCharCode("0x"+I);return"%"===U?"%25":U}),A=decodeURIComponent(A);const f="data:image/svg+xml;base64,"+(0,L.btoa_func)(A);return(0,L.isNodeJs)()?Se.e(511).then(Se.t.bind(Se,1511,19)).then(function(){var C=(0,Ee.A)(function*(I){return I.default.loadImage(f).then(U=>{const k=I.default.createCanvas(U.width,U.height);return k.getContext("2d").drawImage(U,0,0,U.width,U.height),g?k.toBuffer("image/"+E):E?k.toDataURL("image/"+E):k})});return function(I){return C.apply(this,arguments)}}()):new Promise(C=>{const I=document.createElement("img");I.onload=function(){const U=document.createElement("canvas");U.width=I.width,U.height=I.height,U.getContext("2d").drawImage(I,0,0),g&&E?U.toBlob(k=>k.arrayBuffer().then(C),"image/"+E):C(E?U.toDataURL("image/"+E):U)},I.onerror=function(U){console.log(`IMAGE ERROR ${U}`),C(null)},I.src=f})}),$.apply(this,arguments)}},4246:(Yr,mt,Se)=>{"use strict";Se.d(mt,{Zq:()=>He,dj:()=>Ve,qg:()=>Ze,uT:()=>Re});const Ee="Arial",x="Times New Roman",L="Courier New",ve="Verdana",ke="Symbol",ot="Wingdings",Ye=[null,{n:x,s:"italic",aw:.5314},{n:x,w:"bold",aw:.5809},{n:x,s:"italic",w:"bold",aw:.554},{n:Ee,aw:.5778},{n:Ee,s:"oblique",aw:.5783},{n:Ee,w:"bold",aw:.6034},{n:Ee,s:"oblique",w:"bold",aw:.603},{n:L,aw:.6003},{n:L,s:"oblique",aw:.6004},{n:L,w:"bold",aw:.6003},{n:L,s:"oblique",w:"bold",aw:.6005},{n:ke,aw:.5521},{n:x,aw:.5521},{n:ot,aw:.5664},{n:ke,s:"italic",aw:.5314},{n:ve,aw:.5664},{n:ve,s:"italic",aw:.5495},{n:ve,w:"bold",aw:.5748},{n:ve,s:"italic",w:"bold",aw:.5578}];class Ze{constructor(F,J,Y){Y&&J<1&&(J*=Y,this.scaled=!0),this.size=Math.round(J||11),this.scale=Y,this.func=this.setFont.bind(this);const ue=F&&Number.isInteger(F)?Math.floor(F/10):0,Q=Ye[ue];Q?this.setNameStyleWeight(Q.n,Q.s,Q.w,Q.aw,Q.format,Q.base64):this.setNameStyleWeight(Ee)}setNameStyleWeight(F,J,Y,ue,Q,me){this.name=F,this.style=J||null,this.weight=Y||null,this.aver_width=ue||(Y?.58:.55),this.format=Q,this.base64=me,this.name===ke||this.name===ot?(this.isSymbol=this.name,this.name=x):this.isSymbol=""}setPainter(F){this.painter=F}addCustomFontToSvg(F){if(!this.base64||!this.name)return;const J="custom_font_"+this.name;let ue=F.selectChild(".canvas_defs");ue.empty()&&(ue=F.insert("svg:defs",":first-child").attr("class","canvas_defs")),ue.selectChild("."+J).empty()&&(console.log("Adding style entry for class",J),ue.append("style").attr("class",J).property("$fonthandler",this).text(`@font-face { font-family: "${this.name}"; font-weight: normal; font-style: normal; src: url(data:application/font-ttf;charset=utf-8;base64,${this.base64}); }`))}setFont(F){this.base64&&this.painter&&this.addCustomFontToSvg(this.painter.getCanvSvg()),F.attr("font-family",this.name).attr("font-size",this.size).attr("xml:space","preserve").attr("font-weight",this.weight||null).attr("font-style",this.style||null)}setSize(F){this.size=Math.round(F)}setColor(F){this.color=F}setAlign(F){this.align=F}setAngle(F){this.angle=F}roundAngle(F,J){this.angle=parseInt(this.angle||0),Number.isInteger(this.angle)||(this.angle=0),this.angle=Math.round(this.angle/F)*F+(J||0),this.angle<0?this.angle+=360:this.angle>=360&&(this.angle-=360)}clearFont(F){F.attr("font-family",null).attr("font-size",null).attr("xml:space",null).attr("font-weight",null).attr("font-style",null)}isMonospace(){const F=this.name.toLowerCase();return 0===F.indexOf("courier")||"monospace"===F||"monaco"===F}getFontHtml(){let F=Math.round(this.size)+"pt "+this.name;return this.weight&&(F+=" "+this.weight),this.style&&(F+=" "+this.style),F}getFontName(){return this.isSymbol||this.name||"none"}}function Re(De,F,J,Y){Number.isInteger(De)?Ye[De]={n:F,format:J,base64:Y}:console.error(`Wrong index ${De} for custom font`)}function He(De){return Ye.find(F=>F?.n===De&&F?.base64)}function Ve(De){const F=De.getAttribute("font-size"),J=De.getAttribute("font-family"),Y=F.indexOf("px"),ue=Y>0?Number.parseInt(F.slice(0,Y)):12;let Q=De.getAttribute("font-style"),me=De.getAttribute("font-weight"),X=null,B="";"normal"===me?me="":"bold"===me&&(B+="b"),"normal"===Q?Q="":"italic"===Q?B+="i":"oblique"===Q&&(B+="o"),"arial"===J?B+="Arial":"times"===J?B+="Times New Roman":"verdana"===J&&(B+="Verdana");for(let A=1;A<Ye.length;++A)if(B===Ye[A]){X=10*A+2;break}const $=new Ze(X,ue);return X||$.setNameStyleWeight(J,Q,me),$}},1922:(Yr,mt,Se)=>{"use strict";Se.d(mt,{rb:()=>A,JW:()=>De,tP:()=>$,as:()=>F,OZ:()=>X,m6:()=>J,Nn:()=>Y,XR:()=>B,QD:()=>me});var Ee=Se(4882),x=Se(8362),L=Se(8872),ve=Se(3147),ke=Se(2843),ot=Se(2586),Ye=Se(2985);class Ze{constructor(g){this.color="none",this.colorindx=0,this.pattern=0,this.used=!0,this.kind=g.kind||2,this.changed=!1,this.func=this.apply.bind(this),this.setArgs(g),this.changed=!1}setArgs(g){(0,L.isObject)(g.attr)&&(void 0===g.pattern&&void 0!==g.attr.fFillStyle&&(g.pattern=g.attr.fFillStyle),void 0===g.color&&void 0!==g.attr.fFillColor&&(g.color=g.attr.fFillColor));const v=this.changed;this.change(g.color,g.pattern,g.svg,g.color_as_svg,g.painter),this.changed=v}apply(g){this.used=!0,g.style("fill",this.getFillColor()),"opacity"in this&&g.style("opacity",this.opacity),"antialias"in this&&g.style("antialias",this.antialias)}getFillColor(){return this.pattern_url||this.color}getFillColorAlt(g){return this.color&&"none"!==this.color?this.color:g}empty(){const g=this.getFillColor();return!g||"none"===g}setUsed(g){this.used=g}hasColor(){return this.color&&"none"!==this.color}setSolidColor(g){delete this.pattern_url,this.color=g,this.pattern=1001}setOpacity(g){this.opacity=g}isSolid(g){return!(1001!==this.pattern||this.gradient||g&&g!==this.color)}verifyDirectChange(g){(0,L.isStr)(this.pattern)&&(this.pattern=parseInt(this.pattern)),Number.isInteger(this.pattern)||(this.pattern=0),this.change(this.color,this.pattern,g?g.getCanvSvg():null,!0,g)}change(g,v,f,C,I){if(delete this.pattern_url,delete this.gradient,this.changed=!0,void 0!==g&&Number.isInteger(parseInt(g))&&!C&&(this.colorindx=parseInt(g)),void 0!==v&&Number.isInteger(parseInt(v))&&(this.pattern=parseInt(v),delete this.opacity,delete this.antialias),1e3===this.pattern&&0===this.colorindx)return this.pattern_url="white",!0;if(1e3===this.pattern&&(this.pattern=1001),this.pattern<1001)return this.pattern_url="none",!0;if(this.isSolid()&&0===this.colorindx&&1===this.kind&&!C)return this.pattern_url="none",!0;let U=this.colorindx;if(C?(this.color=g,"none"!==g&&(U=(0,x.yW)(g).hex().slice(1))):this.color=I?I.getColor(U):(0,Ye.oU)(U),(0,L.isStr)(this.color)||((0,L.isObject)(this.color)&&(this.color?._typename===Ye.pX||this.color?._typename===Ye.ho)&&(this.gradient=this.color),this.color="none"),this.isSolid())return!0;if(!this.gradient){if(this.pattern>=4e3&&this.pattern<=4100)return this.opacity=(this.pattern-4e3)/100,!0;if(this.pattern<3e3||"none"===this.color)return!1}if(!f||f.empty())return!1;let k="",Z="",ee=null,he="",G="",b=2,P=2;if(this.gradient)k=`grad_${this.gradient.fNumber}`;else{switch(k=`pat_${this.pattern}_${U}`,this.pattern){case 3001:b=P=2,he="M0,0h1v1h-1zM1,1h1v1h-1z";break;case 3002:b=4,P=2,he="M1,0h1v1h-1zM3,1h1v1h-1z";break;case 3003:b=P=4,he="M2,1h1v1h-1zM0,3h1v1h-1z";break;case 3004:b=P=8,Z="M8,0L0,8";break;case 3005:b=P=8,Z="M0,0L8,8";break;case 3006:b=P=4,Z="M1,0v4";break;case 3007:b=P=4,Z="M0,1h4";break;case 3008:b=P=10,he="M0,3v-3h3ZM7,0h3v3ZM0,7v3h3ZM7,10h3v-3ZM5,2l3,3l-3,3l-3,-3Z",Z="M0,3l5,5M3,10l5,-5M10,7l-5,-5M7,0l-5,5";break;case 3009:b=12,P=12,Z="M0,0A6,6,0,0,0,12,0M6,6A6,6,0,0,0,12,12M6,6A6,6,0,0,1,0,12",ee="none";break;case 3010:b=P=10,Z="M0,2h10M0,7h10M2,0v2M7,2v5M2,7v3";break;case 3011:b=9,P=18,Z="M5,0v8M2,1l6,6M8,1l-6,6M9,9v8M6,10l3,3l-3,3M0,9v8M3,10l-3,3l3,3",ee="none";break;case 3012:b=10,P=20,Z="M5,1A4,4,0,0,0,5,9A4,4,0,0,0,5,1M0,11A4,4,0,0,1,0,19M10,11A4,4,0,0,0,10,19",ee="none";break;case 3013:b=P=7,Z="M0,0L7,7M7,0L0,7",ee="none";break;case 3014:b=P=16,Z="M0,0h16v16h-16v-16M0,12h16M12,0v16M4,0v8M4,4h8M0,8h8M8,4v8",ee="none";break;case 3015:b=6,P=12,Z="M2,1A2,2,0,0,0,2,5A2,2,0,0,0,2,1M0,7A2,2,0,0,1,0,11M6,7A2,2,0,0,0,6,11",ee="none";break;case 3016:b=12,P=7,Z="M0,1A3,2,0,0,1,3,3A3,2,0,0,0,9,3A3,2,0,0,1,12,1",ee="none";break;case 3017:b=P=4,Z="M3,1l-2,2";break;case 3018:b=P=4,Z="M1,1l2,2";break;case 3019:b=P=12,Z="M1,6A5,5,0,0,0,11,6A5,5,0,0,0,1,6h-1h1A5,5,0,0,1,6,11v1v-1A5,5,0,0,1,11,6h1h-1A5,5,0,0,1,6,1v-1v1A5,5,0,0,1,1,6",ee="none";break;case 3020:b=7,P=12,Z="M1,0A2,3,0,0,0,3,3A2,3,0,0,1,3,9A2,3,0,0,0,1,12",ee="none";break;case 3021:b=P=8,Z="M8,2h-2v4h-4v2M2,0v2h-2",ee="none";break;case 3022:b=P=8,Z="M0,2h2v4h4v2M6,0v2h2",ee="none";break;case 3023:b=P=8,he="M4,0h4v4zM8,4v4h-4z",G="M4,0L0,4L4,8L8,4Z";break;case 3024:b=P=16,he="M0,8v8h2v-8zM8,0v8h2v-8M4,14v2h12v-2z",G="M0,2h8v6h4v-6h4v12h-12v-6h-4z";break;case 3025:b=P=18,he="M5,13v-8h8ZM18,0v18h-18l5,-5h8v-8Z";break;default:{if(this.pattern>3025&&this.pattern<3100){b=4,P=2,he="M1,0h1v1h-1zM3,1h1v1h-1z";break}const z=this.pattern%1e3,W=z%10,fe=(z-W)%100/10,we=(z-10*fe-W)/100;if(!we)break;const Me=fe===W||0===fe||5===fe||9===fe||0===W||5===W||9===W,je=I?.getPadPainter(),Ge=je?Math.max(je.getPadWidth(),je.getPadHeight()):600,lt=Math.max(.1,L.gStyle.fHatchesSpacing*Ge*.001),bt=6*Math.max(1,Math.round(lt)),te=we*bt;k+=Me?`_hn${Math.round(100*lt)}`:`_ho${bt}`,b=P=6*te;const Fe=Me?(St,pt,st,vt)=>{if(0===st||90===st){const Cn=Math.round(P/(we*lt*3)),yn=P/Cn;let Sn=yn/2;for(;Sn<P;)Z+=0===st?`M0,${Math.round(Sn)}h${b}`:`M${Math.round(Sn)},0v${P}`,Sn+=yn;return}const Yt=st/180*Math.PI,qt=we*lt*3/Math.cos(Yt),Ot=Math.tan(Yt)*b,Mn=Ot/Math.round(Ot/qt),bn=Math.floor(P/Mn);P=Math.round(bn*Mn);let Dn=bn*Mn;for(;Math.abs(Dn-P)<.1;)Dn-=Mn;for(;Dn+Ot>0;){let $n=0,Cn=Dn,yn=b,Sn=Dn+Ot;Cn<-1e-5?($n=-Cn/Ot*b,Cn=0):Sn>P&&(yn=(P-Cn)/Ot*b,Sn=P),vt&&($n=b-$n,yn=b-yn),Z+=`M${Math.round($n)},${Math.round(Cn)}L${Math.round(yn)},${Math.round(Sn)}`,Dn-=Mn}}:(St,pt)=>{const st=[];let Ot,Bn,Mn,vt=te,Yt=0,qt=P;for(Math.abs(St)<3&&(vt=Math.round(te/12*9)),0===St?(vt=Math.round(te/12*8),Yt=vt/2):St>0?qt-=vt:Yt=vt;Yt<=qt;)Ot=Yt+St*vt,Ot<0?(Mn=Math.round(Yt/(Yt-Ot)*b),st.push(0,Yt,Mn,0),st.push(b,P-Yt,b-Mn,P)):Ot>P?(Mn=Math.round((P-Yt)/(Ot-Yt)*b),st.push(0,Yt,Mn,P),st.push(b,P-Yt,b-Mn,0)):st.push(0,Yt,b,Ot),Yt+=vt;for(let bn=0;bn<st.length;bn+=4)pt?(Bn=st[bn+1],Yt=st[bn],Mn=st[bn+3],Ot=st[bn+2]):(Bn=st[bn],Yt=st[bn+1],Mn=st[bn+2],Ot=st[bn+3]),Z+=`M${Bn},${Yt}`,Z+=Ot===Yt?"h"+(Mn-Bn):Mn===Bn?"v"+(Ot-Yt):`L${Mn},${Ot}`};let Ne=!1,rt=!1;switch(fe){case 0:Ne=!0;break;case 1:Fe(1,!1,10);break;case 2:Fe(2,!1,20);break;case 3:Fe(3,!1,30);break;case 4:Fe(6,!1,45);break;case 6:Fe(3,!0,60);break;case 7:Fe(2,!0,70);break;case 8:Fe(1,!0,80);break;case 9:rt=!0}switch(W){case 0:Ne=!0;break;case 1:Fe(-1,!1,10,!0);break;case 2:Fe(-2,!1,20,!0);break;case 3:Fe(-3,!1,30,!0);break;case 4:Fe(-6,!1,45,!0);break;case 6:Fe(-3,!0,60,!0);break;case 7:Fe(-2,!0,70,!0);break;case 8:Fe(-1,!0,80,!0);break;case 9:rt=!0}Ne&&Fe(0,!1,0),rt&&Fe(0,!0,90);break}}if(!he&&!Z)return!1}this.pattern_url=`url(#${k})`,this.antialias=!1;let T=f.selectChild(".canvas_defs");if(T.empty()&&(T=f.insert("svg:defs",":first-child").attr("class","canvas_defs")),T.selectChild("."+k).empty())if(this.gradient){const z=this.gradient._typename===Ye.pX,W=T.append(z?"svg:linearGradient":"svg:radialGradient").attr("id",k).attr("class",k),fe=we=>we===Math.round(we)?we.toFixed(0):we.toFixed(2);z?W.attr("x1",fe(this.gradient.fStart.fX)).attr("y1",fe(1-this.gradient.fStart.fY)).attr("x2",fe(this.gradient.fEnd.fX)).attr("y2",fe(1-this.gradient.fEnd.fY)):W.attr("cx",fe(this.gradient.fStart.fX)).attr("cy",fe(1-this.gradient.fStart.fY)).attr("cr",fe(this.gradient.fR1));for(let we=0;we<this.gradient.fColorPositions.length;++we){const Me=this.gradient.fColorPositions[we],je="#"+(0,Ye.nj)(this.gradient.fColors[4*we])+(0,Ye.nj)(this.gradient.fColors[4*we+1])+(0,Ye.nj)(this.gradient.fColors[4*we+2]);W.append("svg:stop").attr("offset",`${Math.round(100*Me)}%`).attr("stop-color",je).attr("stop-opacity",`${Math.round(100*this.gradient.fColors[4*we+3])}%`)}}else{const z=T.append("svg:pattern").attr("id",k).attr("class",k).attr("patternUnits","userSpaceOnUse").attr("width",b).attr("height",P);if(G){const W=(0,x.Qh)(this.color);W.r=Math.round((W.r+255)/2),W.g=Math.round((W.g+255)/2),W.b=Math.round((W.b+255)/2),z.append("svg:path").attr("d",G).style("fill",W)}he&&z.append("svg:path").attr("d",he).style("fill",this.color),Z&&z.append("svg:path").attr("d",Z).style("stroke",this.color).style("stroke-width",L.gStyle.fHatchesLineWidth||1).style("fill",ee)}return!0}createSample(g,v,f,C){C&&(g=(0,x.Lt)(g));const I=new Ze({svg:g,pattern:this.pattern,color:this.color,color_as_svg:!0});g.append("path").attr("d",`M0,0h${v}v${f}h${-v}z`).call(I.func)}saveToStyle(g,v){if(g){const f=this.colorindx??(0,Ye.vB)(this.color);f>=0&&(L.gStyle[g]=f)}v&&(L.gStyle[v]=this.pattern)}}var Re=Se(4082);class He{constructor(g){this.used=!0,g._typename&&void 0!==g.fTextFont&&(g={attr:g}),this.setArgs(g)}setArgs(g){g.attr?(g.font=g.attr.fTextFont||g.attr_alt?.fTextFont||0,g.size=g.attr.fTextSize||g.attr_alt?.fTextSize||0,this.color_index=g.attr.fTextColor||g.attr_alt?.fTextColor||0,g.color=g.painter?.getColor(this.color_index)??(0,Ye.oU)(this.color_index),g.align=g.attr.fTextAlign||g.attr_alt?.fTextAlign||0,g.angle=g.attr.fTextAngle||g.attr_alt?.fTextAngle||0):"number"==typeof g.color&&(this.color_index=g.color,g.color=g.painter?.getColor(g.color)??(0,Ye.oU)(g.color)),this.font=g.font,this.size=g.size,this.color=g.color,this.align=g.align,this.angle=g.angle,this.angle_used=!1,this.align_used=!1}empty(){return"none"===this.color}change(g,v,f,C,I){void 0!==g&&(this.font=g),void 0!==v&&(this.size=v),void 0!==f&&(this.color!==f&&delete this.color_index,this.color=f),void 0!==C&&(this.align=C),void 0!==I&&(this.angle=I),this.changed=!0}verifyDirectChange(){this.change(parseInt(this.font),parseFloat(this.size),this.color,parseInt(this.align),parseInt(this.angle))}createArg(g){return g||(g={}),this.align_used=!g.noalign&&!g.align,this.align_used&&(g.align=this.align),this.angle_used=!g.norotate,this.angle_used&&this.angle&&(g.rotate=-this.angle),g.color=this.color||"black",g}getSize(g,v,f,C){return this.size>=1?Math.round(this.size):(g||(g=1e3),v||(v=g),f||(f=1),Math.round((this.size||C||0)*Math.min(g,v)*f))}getAltSize(g,v){return g||(g=this.size),Math.round(g>=1?g:g*v)}getGedFont(){return Math.floor(this.font/10)}setGedFont(g){const v=parseInt(g);return v>0&&v<17&&this.change(10*v+this.font%10),this.font}}var Ve=Se(4246);class De extends ke.b8{constructor(g,v,f){super(g),this.pad_name=g?this.selectCurrentPad():"",this.assignObject(v),(0,L.isStr)(f)&&(this.options={original:f})}assignObject(g){(0,L.isObject)(g)?this.draw_object=g:delete this.draw_object}setPadName(g){this.pad_name=(0,L.isStr)(g)?g:this.selectCurrentPad()}getPadName(){return this.pad_name||""}isBatchMode(){return!!(0,L.isBatchMode)()||(this.getCanvPainter()?.isBatchMode()??!1)}assignSnapId(g){this.snapid=g}cleanup(){this.removeG();let g=!0;if(this.isMainPainter()){const v=this.getPadPainter();(!v||!1===v.normal_canvas)&&(g=!1)}delete this.pad_name,delete this._main_painter,this.draw_object=null,delete this.snapid,delete this.fillatt,delete this.lineatt,delete this.markeratt,delete this.bins,delete this.root_colors,delete this.options,delete this.options_store,delete this.rstyle,delete this.csstype,super.cleanup(g)}getObject(){return this.draw_object}getObjectName(){return this.getObject()?.fName??""}getClassName(){return this.getObject()?._typename??""}matchObjectType(g){const v=this.getClassName();return!(!g||!v)&&((0,L.isStr)(g)?g===v:(0,L.isStr)(g._typename)?g._typename===v:v.match(g))}setItemName(g,v,f){if(super.setItemName(g,v,f),this.no_default_title||!g)return;const C=this.getCanvSvg();C.empty()?this.selectDom().attr("title",g):C.select("title").text(g);const I=this.getCanvPainter();I&&(I===this||this.isMainPainter()&&I===this.getPadPainter())&&I.drawItemNameOnCanvas(g)}storeDrawOpt(g){if(!this.options)return;g||(g="");const v=g.indexOf(";;");v>=0&&(g=g.slice(0,v)),this.options.original=g,this.options_store=Object.assign({},this.options)}getDrawOpt(g){if(!this.options)return"";if((0,L.isFunc)(this.options.asString)){let v=!1;const f=this.getPadPainter();if(!this.options_store||f?._interactively_changed)v=!0;else for(const C in this.options)this.options[C]!==this.options_store[C]&&(v=!0);if(v&&(0,L.isFunc)(this.options.asString))return this.options.asString(this.isMainPainter(),g?null:f?.getRootPad())}return this.options.original||""}getSupportedDrawOptions(){const g=this.getPadPainter(),v=this.getClassName();return v&&(0,L.isFunc)(g?.getObjectDrawSettings)?g.getObjectDrawSettings(L.prROOT+v,"nosame")?.opts:[]}redrawObject(g,v){if(!this.updateObject(g,v))return!1;const f=(0,L.getDocument)(),C=f.body.style.cursor;document.body.style.cursor="wait";const I=this.redrawPad();return f.body.style.cursor=C,I}updateObject(g){return!!this.matchObjectType(g)&&(Object.assign(this.getObject(),g),!0)}getObjectHint(){const g=this.getItemName();return g?g.length>20?"..."+g.slice(g.length-17):g:this.getObjectName()||this.getClassName()||""}getColor(g){return this.root_colors||(this.root_colors=this.getCanvPainter()?.root_colors||(0,Ye.HG)()),this.root_colors[g]}addColor(g){this.root_colors||(this.root_colors=this.getCanvPainter()?.root_colors||(0,Ye.HG)());const v=this.root_colors.indexOf(g);return v>=0?v:(this.root_colors.push(g),this.root_colors.length-1)}isTooltipAllowed(){return(this.getCanvPainter()||this).tooltip_allowed}setTooltipAllowed(g){void 0===g&&(g=!0);const v=this.getCanvPainter()||this;v.tooltip_allowed="toggle"===g?!v.tooltip_allowed:g}checkResize(g){return this.getCanvPainter()?.checkCanvasResize(g)}removeG(){this.draw_g?.remove(),delete this.draw_g}getG(){return this.draw_g}createG(g){let v;if(g){const I=this.getFrameSvg();if(I.empty())return console.error("Not found frame to create g element inside"),I;(0,L.isStr)(g)||(g="main_layer"),v=I.selectChild("."+g)}else v=this.getLayerSvg("primitives_layer");this.draw_g&&this.draw_g.node().parentNode!==v.node()&&(console.log("g element changes its layer!!"),this.removeG()),this.draw_g?this.draw_g.selectAll("*").remove():(this.draw_g=v.append("svg:g"),g||v.selectChildren(".most_upper_primitives").raise());const f=this.getClassName(),C=this.getObjectName();return(C||f)&&this.draw_g.attr("objname",(C||"name").replace(/[^\w]/g,"_")).attr("objtype",(f||"type").replace(/[^\w]/g,"_")),this.draw_g.property("in_frame",!!g),this.draw_g}bringToFront(g){if(!this.draw_g||(this.draw_g.node().parentNode?.appendChild(this.draw_g.node()),!g||!this.snapid))return;const f=this.getPadPainter();f?.snapid&&this.getCanvPainter()?.sendWebsocket("POPOBJ:"+JSON.stringify([f.snapid.toString(),this.snapid.toString()]))}getCanvSvg(){return this.selectDom().select(".root_canvas")}getPadSvg(g){void 0===g&&(g=this.pad_name);let v=this.getCanvSvg();if(!g||v.empty())return v;const f=v.property("pad_painter");return f?.pads_cache&&f.pads_cache[g]?(0,x.Lt)(f.pads_cache[g]):(v=v.select(".primitives_layer .__root_pad_"+g),f&&(f.pads_cache||(f.pads_cache={}),f.pads_cache[g]=v.node()),v)}getUniqueId(g=!1){return!g&&void 0===this._unique_painter_id&&(this._unique_painter_id=L.internals.id_counter++),this._unique_painter_id}setSecondaryId(g,v){this._main_painter_id=g.getUniqueId(),this._secondary_id=v}isSecondary(g){return void 0!==this._main_painter_id&&(!(0,L.isObject)(g)||this._main_painter_id===g.getUniqueId(!0))}getSnapId(g){return this.snapid?this.snapid.toString()+(g?"#"+g:""):""}getLayerSvg(g,v){let f=this.getPadSvg(v);return f.empty()?f:(0===g.indexOf("prim#")&&(f=f.selectChild(".primitives_layer"),g=g.slice(5)),f.selectChild("."+g))}selectCurrentPad(g){const v=this.getCanvSvg();if(v.empty())return"";const f=v.property("current_pad");return void 0!==g&&v.property("current_pad",g),f}getPadPainter(g){const v=this.getPadSvg((0,L.isStr)(g)?g:void 0);return v.empty()?null:v.property("pad_painter")}getCanvPainter(){const g=this.getCanvSvg();return g.empty()?null:g.property("pad_painter")}getAxisToSvgFunc(g,v){const f={isndc:g,nornd:v},C=this.draw_g?.property("in_frame");if(C&&(f.main=this.getFramePainter()),f.main?.grx&&f.main?.gry)v?(f.x=function(I){return this.main.grx(I)},f.y=function(I){return this.main.gry(I)}):(f.x=function(I){return Math.round(this.main.grx(I))},f.y=function(I){return Math.round(this.main.gry(I))});else if(C)console.error(`Problem to create functor for ${this.getClassName()}`),f.x=()=>0,f.y=()=>0;else{const I=this.getPadPainter();g||(f.pad=I?.getRootPad(!0)),f.padw=I?.getPadWidth()??10,f.x=function(U){return this.pad&&(this.pad.fLogx&&(U=U>0?Math.log10(U):this.pad.fUxmin),U=(U-this.pad.fX1)/(this.pad.fX2-this.pad.fX1)),U*=this.padw,this.nornd?U:Math.round(U)},f.padh=I?.getPadHeight()??10,f.y=function(U){return this.pad&&(this.pad.fLogy&&(U=U>0?Math.log10(U):this.pad.fUymin),U=(U-this.pad.fY1)/(this.pad.fY2-this.pad.fY1)),U=(1-U)*this.padh,this.nornd?U:Math.round(U)}}return f}axisToSvg(g,v,f,C){return this.getAxisToSvgFunc(f,C)[g](v)}svgToAxis(g,v,f){if(this.draw_g?.property("in_frame"))return this.getFramePainter()?.revertAxis(g,v)??0;const I=this.getPadPainter(),U=f||!I?null:I.getRootPad(!0);let k=I?"y"===g?1-v/I.getPadHeight():v/I.getPadWidth():0;return U&&("y"===g?(k=U.fY1+k*(U.fY2-U.fY1),U.fLogy&&(k=Math.pow(10,k))):(k=U.fX1+k*(U.fX2-U.fX1),U.fLogx&&(k=Math.pow(10,k)))),k}getFrameSvg(g){const v=this.getLayerSvg("primitives_layer",g);if(v.empty())return v;let f=v.node().firstChild;for(;f;){const C=(0,x.Lt)(f);if(C.classed("root_frame"))return C;f=f.nextSibling}return(0,x.Lt)(null)}getFramePainter(){return this.getPadPainter()?.getFramePainter()}getMainPainter(g){let v=this._main_painter;if(!v){const f=this.getPadPainter();v=f?f.getMainPainter():this.getTopPainter(),v||(v=null),g||(this._main_painter=v)}return v}isMainPainter(){return this===this.getMainPainter()}setAsMainPainter(g){const v=this.getPadPainter();v?v.setMainPainter(this,g):this.setTopPainter()}addToPadPrimitives(g){void 0!==g&&this.setPadName(g);const v=this.getPadPainter(g);return!(!v||v===this||(v.painters.indexOf(this)<0&&v.painters.push(this),!this.rstyle&&v.next_rstyle&&(this.rstyle=v.next_rstyle),0))}removeFromPadPrimitives(){const g=this.getPadPainter();if(!g||g===this)return!1;const v=g.painters.indexOf(this);return v>=0&&g.painters.splice(v,1),!0}createAttMarker(g){(0,L.isObject)(g)?void 0!==g.fMarkerColor&&void 0!==g.fMarkerStyle&&void 0!==g.fMarkerSize&&(g={attr:g,std:!1}):g={std:!0},void 0===g.std&&(g.std=!0),void 0===g.painter&&(g.painter=this);let v=g.std?this.markeratt:null;return v?(!v.changed||g.force)&&v.setArgs(g):v=new ot.e(g),g.std&&(this.markeratt=v),v}createAttLine(g){(0,L.isObject)(g)?void 0!==g.fLineColor&&void 0!==g.fLineStyle&&void 0!==g.fLineWidth&&(g={attr:g,std:!1}):g={std:!0},void 0===g.std&&(g.std=!0),void 0===g.painter&&(g.painter=this);let v=g.std?this.lineatt:null;return v?(!v.changed||g.force)&&v.setArgs(g):v=new Re.gx(g),g.std&&(this.lineatt=v),v}createAttText(g){(0,L.isObject)(g)?void 0!==g.fTextFont&&void 0!==g.fTextSize&&void 0!==g.fTextColor&&(g={attr:g,std:!1}):g={std:!0},void 0===g.std&&(g.std=!0),void 0===g.painter&&(g.painter=this);let v=g.std?this.textatt:null;return v?(!v.changed||g.force)&&v.setArgs(g):v=new He(g),g.std&&(this.textatt=v),v}createAttFill(g){(0,L.isObject)(g)?g._typename&&void 0!==g.fFillColor&&void 0!==g.fFillStyle&&(g={attr:g,std:!1}):g={std:!0},void 0===g.std&&(g.std=!0);let v=g.std?this.fillatt:null;return g.svg||(g.svg=this.getCanvSvg()),void 0===g.painter&&(g.painter=this),v?(!v.changed||g.force)&&v.setArgs(g):v=new Ze(g),g.std&&(this.fillatt=v),v}forEachPainter(g,v){const f=this.getPadPainter();if(f)f.forEachPainterInPad(g,v);else{const C=this.getTopPainter();C&&"pads"!==v&&g(C)}}interactiveRedraw(g,v,f){var C=this;return(0,Ee.A)(function*(){let I,U;return(0,L.isStr)(v)&&0!==v.indexOf("exec:")&&(I=v),"pad"===g?U=C.redrawPad(I):!1!==g&&(U=C.redraw(I)),(0,L.getPromise)(U).then(()=>{const k=C.getCanvPainter();return(0,L.isFunc)(k?.producePadEvent)&&k.producePadEvent("redraw",C.getPadPainter(),C,null,f),(0,L.isFunc)(k?.processChanges)&&k.processChanges(v,C,f),C})})()}redrawPad(g){var v=this;return(0,Ee.A)(function*(){return v.getPadPainter()?.redrawPad(g)??!1})()}executeMenuCommand(g){return"Inspect"===g.fName&&this.showInspector()}submitCanvExec(g,v){if(!g||!(0,L.isStr)(g))return;const f=this.getCanvPainter();(0,L.isFunc)(f?.submitExec)&&f.submitExec(this,g,v)}deleteAttr(){delete this.lineatt,delete this.fillatt,delete this.markeratt}showInspector(){return!1}fillContextMenu(g){const v=this.getObjectName();let f=this.getClassName();const C=f.lastIndexOf("::");C>0&&(f=f.slice(C+2)),g.add(`header:${f&&v?`${f}:${v}`:f||v||"object"}`);const U=g.size();return(0,L.isFunc)(this.fillContextMenuItems)&&this.fillContextMenuItems(g),g.size()>U&&this.showInspector("check")&&g.add("Inspect",this.showInspector),g.addAttributesMenu(this),g.size()>U}showObjectStatus(g,v,f,C){let I=this.getCanvPainter();if(I&&!(0,L.isFunc)(I.showCanvasStatus)&&(I=null),!I&&!(0,L.isFunc)(L.internals.showStatus)||"on"===this.enlargeMain("state"))return!1;if(void 0===g&&void 0===v){const U=this.getObject();if(!U)return;g=this.getItemName()||U.fName,v=U.fTitle||U._typename,f=U._typename}I?I.showCanvasStatus(g,v,f,C):L.internals.showStatus(g,v,f,C)}redraw(){}startTextDrawing(g,v,f,C){if(f||(f=this.draw_g),!f||f.empty())return;const I="font"===v?g:new Ve.qg(g,v);I.setPainter(this),f.call(I.func),f.property("draw_text_completed",!1).property("all_args",[]).property("text_font",I).property("text_factor",0).property("max_text_width",0).property("max_font_size",C).property("_fast_drawing",this.getPadPainter()?._fast_drawing??!1),f.property("_fast_drawing")&&f.property("_font_too_small",C&&C<5||I.size<4)}scaleTextDrawing(g,v){v||(v=this.draw_g),v&&!v.empty()&&g&&g>v.property("text_factor")&&v.property("text_factor",g)}_checkAllTextDrawing(g,v,f){let C=g.property("all_args"),I=0;if(C||(console.log("Text drawing is finished - why calling _checkAllTextDrawing?????"),C=[]),C.forEach(P=>{P.ready||I++}),I>0)return void((0,L.isFunc)(v)&&(g.node().textResolveFunc=v,g.node().try_optimize=f));g.property("all_args",null);const U=g.property("text_factor"),k=g.property("text_font"),Z=g.property("max_font_size");let ee=k.size,he=!1,G=!0;U>0&&(U<.9||U>1)&&(k.size=Math.max(1,Math.floor(k.size/U))),Z&&k.size>Z&&(k.size=Z),k.size!==ee&&(g.call(k.func),ee=k.size),C.forEach(P=>{if(P.mj_node&&P.applyAttributesToMathJax){const T=P.mj_node.select("svg");P.applyAttributesToMathJax(this,P.mj_node,T,P,ee,U),delete P.mj_node,G=!1}else P.txt_g&&(G=!1)}),v||(v=g.node().textResolveFunc,f=g.node().try_optimize,delete g.node().textResolveFunc,delete g.node().try_optimize);const b=f&&G?[]:null;C.forEach(P=>{let T,z,W=1;if(P.txt_node)T=P.txt_node,delete P.txt_node,z=!0,null!==b&&b.push(T);else{if(!P.txt_g)return;T=P.txt_g,delete P.txt_g,z=!1}T.attr("visibility",null),he=!0,P.width&&("middle"===P.align[0]?P.x+=P.width/2:"end"===P.align[0]&&(P.x+=P.width)),P.height&&(0===P.align[1].indexOf("bottom")?P.y+=P.height:"middle"===P.align[1]&&(P.y+=P.height/2));let fe=0,we=0;if(z)(0,L.isNodeJs)()?P.scale&&U>0&&(P.box.width*=1/U,P.box.height*=1/U):!P.plain&&!P.fast&&(P.box=(0,ke.xh)(T,"bbox")),P.plain?(T.attr("text-anchor",P.align[0]),"top"===P.align[1]?T.attr("dy",".8em"):"middle"===P.align[1]&&((0,L.isNodeJs)()?T.attr("dy",".4em"):T.attr("dominant-baseline","middle"))):(T.attr("text-anchor","start"),fe=("middle"===P.align[0]?-.5:"end"===P.align[0]?-1:0)*P.box.width,we=("top"===P.align[1]?P.top_shift||1:"middle"===P.align[1]?P.mid_shift||.5:0)*P.box.height);else if(P.text_rect){const lt=P.text_rect;W=U>0&&Math.abs(1-U)>.01?1/U:1,fe=("middle"===P.align[0]?-.5:"end"===P.align[0]?-1:0)*lt.width*W,"top"===P.align[1]?we=-lt.y1*W:"bottom"===P.align[1]?we=-lt.y2*W:"middle"===P.align[1]&&(we=-.5*(lt.y1+lt.y2)*W)}else console.error("text rect not calcualted - please check code");P.rotate||(P.x+=fe,P.y+=we,fe=we=0);let Me=(0,ke.bk)(Math.round(P.x),Math.round(P.y))||"";const je=(0,ke.bk)(Math.round(fe),Math.round(we)),Ge=lt=>{Me&&(Me+=" "),Me+=lt};P.rotate&&Ge(`rotate(${Math.round(P.rotate)})`),1!==W&&Ge(`scale(${W.toFixed(3)})`),je&&Ge(je),Me&&T.attr("transform",Me)}),he||k.clearFont(g),null!==b&&b.length>1&&["fill","text-anchor"].forEach(P=>{let T=b[0].attr(P);b.forEach(z=>{const W=z.attr(P);(!W||W!==T)&&(T=void 0)}),T&&(g.attr(P,T),b.forEach(z=>{z.attr(P,null)}))}),v&&v(this)}_postprocessDrawText(g,v){return g.box=(0,L.isNodeJs)()||L.settings.ApproxTextSize||g.fast?g.text_rect||{height:1.2*g.font_size,width:g.text.length*g.font_size*g.font.aver_width}:(0,ke.xh)(v,"bbox"),v.attr("visibility","hidden"),g.box.width>g.draw_g.property("max_text_width")&&g.draw_g.property("max_text_width",g.box.width),g.scale&&this.scaleTextDrawing(Math.max(1.05*g.box.width/g.width,g.box.height/g.height),g.draw_g),g.result_width=g.box.width,g.result_height=g.box.height,(0,L.isFunc)(g.post_process)&&g.post_process(this),g.box.width}drawText(g){if(g.text||(g.text=""),g.draw_g=g.draw_g||this.draw_g,!g.draw_g||g.draw_g.empty())return;const v=g.draw_g.property("text_font");g.font=v,v&&(v.color&&!g.color&&(g.color=v.color),v.align&&!g.align&&(g.align=v.align),v.angle&&!g.rotate&&(g.rotate=v.angle));let f=["start","middle"];if((0,L.isStr)(g.align)?(f=g.align.split(";"),1===f.length&&f.push("middle")):"number"==typeof g.align?(g.align/10>=3?f[0]="end":g.align/10>=2&&(f[0]="middle"),g.align%10==0?f[1]="bottom":g.align%10==1?f[1]="bottom-base":g.align%10==3&&(f[1]="top")):(0,L.isObject)(g.align)&&2===g.align.length&&(f=g.align),void 0===g.latex&&(g.latex=1),g.align=f,g.x=g.x||0,g.y=g.y||0,!1!==g.scale&&(g.scale=g.width&&g.height&&!g.font_size),g.width=g.width||0,g.height=g.height||0,g.draw_g.property("_fast_drawing"))if(g.scale){if(g.height<4)return 0}else if(g.font_size){if(g.font_size<4)return 0}else if(g.draw_g.property("_font_too_small"))return 0;g.draw_g.property("all_args").push(g),g.ready=!1;let C=2===g.latex;const I=L.constants.Latex;return 1===g.latex&&(C=L.settings.Latex===I.AlwaysMathJax||L.settings.Latex===I.MathJax&&g.text.match(/[#{\\]/g)||g.text.match(/[\\]/g)),!C||g.nomathjax?(g.txt_node=g.draw_g.append("svg:text"),g.color&&g.txt_node.attr("fill",g.color),g.font_size?g.txt_node.attr("font-size",g.font_size):g.font_size=v.size,g.plain=!g.latex||L.settings.Latex===I.Off||L.settings.Latex===I.Symbols,g.simple_latex=g.latex&&L.settings.Latex===I.Symbols,!g.plain||g.simple_latex||g.font&&g.font.isSymbol?(g.simple_latex||(0,ve.KA)(g.text)||g.plain?(g.simple_latex=!0,(0,ve.eN)(this,g.txt_node,g)):(g.txt_node.remove(),delete g.txt_node,g.txt_g=g.draw_g.append("svg:g"),(0,ve.Bm)(this,g.txt_g,g)),g.ready=!0,this._postprocessDrawText(g,g.txt_g||g.txt_node),g.draw_g.property("draw_text_completed")&&this._checkAllTextDrawing(g.draw_g),0):(g.plain=!0,g.txt_node.text(g.text),g.ready=!0,this._postprocessDrawText(g,g.txt_node))):(g.mj_node=g.draw_g.append("svg:g").attr("visibility","hidden"),(0,ve._o)(this,g.mj_node,g).then(()=>{g.ready=!0,g.draw_g.property("draw_text_completed")&&this._checkAllTextDrawing(g.draw_g)}),0)}finishTextDrawing(g,v){var f=this;return(0,Ee.A)(function*(){return g||(g=f.draw_g),!(!g||g.empty())&&(g.property("draw_text_completed",!0),new Promise(C=>{f._checkAllTextDrawing(g,C,v)}))})()}configureUserContextMenu(g){g&&(0,L.isFunc)(g)?this._userContextMenuFunc=g:delete this._userContextMenuFunc}fillObjectExecMenu(g,v){var f=this;return(0,Ee.A)(function*(){if((0,L.isFunc)(f._userContextMenuFunc))return f._userContextMenuFunc(g,v);const C=f.getCanvPainter();if(!f.snapid||!C||C?._readonly||!C?._websocket)return g;function I(Z){const ee=g.exec_painter||this,he=ee.getCanvPainter(),G=g.exec_items[parseInt(Z)];if(G?.fName){if("Show:Editor"===G.fExec)return void((0,L.isFunc)(he?.activateGed)&&he.activateGed(ee));if((!(0,L.isFunc)(he?.executeObjectMethod)||!he.executeObjectMethod(ee,G,G.$execid))&&(G.fClassName=ee.getClassName(),(G.$execid.indexOf("#x")>0||G.$execid.indexOf("#y")>0||G.$execid.indexOf("#z")>0)&&(G.fClassName=L.clTAxis),!ee.executeMenuCommand(G)&&G.$execid)){if(!G.fArgs)return he?.v7canvas?he.submitExec(ee,G.fExec,v):ee.submitCanvExec(G.fExec,G.$execid);g.showMethodArgsDialog(G).then(b=>{if(!b||ee.executeMenuCommand(G,b))return;const P=G.fExec.slice(0,G.fExec.length-1)+b+")";he?.v7canvas?he.submitExec(ee,P,v):he?.sendWebsocket(`OBJEXEC:${G.$execid}:${P}`)})}}}const U=(Z,ee,he,G)=>{if(!g._got_menu){if(g._got_menu=!0,G&&ee!==G.fId&&console.error(`missmatch between request ${ee} and reply ${G.fId} identifiers`),g.exec_items=G?.fItems,g.exec_items?.length){let b;Z.size()>0&&Z.add("separator");for(let P=0;P<g.exec_items.length;++P){const T=g.exec_items[P];if(T.$execid=G.fId,T.$menu=g,T.fClassName&&b&&b!==T.fClassName&&(Z.add("endsub:"),b=""),b!==T.fClassName){b=T.fClassName;const z=b.lastIndexOf("::"),W=z>0?b.slice(z+2):b;Z.add("sub:"+W.replace(/[<>]/g,"_"))}void 0===T.fChecked||T.fChecked<0?Z.add(T.fName,P,I):Z.addchk(T.fChecked,T.fName,P,I)}b&&Z.add("endsub:")}he(Z)}},k=f.getSnapId(v);return g._got_menu=!1,g.painter&&(g.exec_painter=g.painter!==f?f:void 0),new Promise(Z=>{let ee=!1;function he(G){ee||(ee=!0,Z(G))}setTimeout(()=>U(g,k,he),2e3),C.submitMenuRequest(f,v,k).then(G=>U(g,k,he,G))})})()}configureUserTooltipHandler(g,v){g&&(0,L.isFunc)(g)?(this._user_tooltip_handler=g,this._user_tooltip_timeout=v||100):(delete this._user_tooltip_handler,delete this._user_tooltip_timeout)}configureUserClickHandler(g){const v=this.getFramePainter();(0,L.isFunc)(v?.configureUserClickHandler)&&v.configureUserClickHandler(g)}configureUserDblclickHandler(g){const v=this.getFramePainter();(0,L.isFunc)(v?.configureUserDblclickHandler)&&v.configureUserDblclickHandler(g)}hasUserTooltip(){return(0,L.isFunc)(this._user_tooltip_handler)}provideUserTooltip(g){if(this.hasUserTooltip()){if(this._user_tooltip_timeout<=0)return this._user_tooltip_handler(g);if(this._user_tooltip_handle&&(clearTimeout(this._user_tooltip_handle),delete this._user_tooltip_handle),!g)return this._user_tooltip_handler(g);this._user_tooltip_handle=setTimeout(()=>{delete this._user_tooltip_handle,this._user_tooltip_handler&&this._user_tooltip_handler(g)},this._user_tooltip_timeout)}}provideSpecialDrawArea(g){var v=this;return(0,Ee.A)(function*(){return g===v._special_draw_area||v.getCanvPainter().toggleProjection(g).then(()=>(v._special_draw_area=g,!0))})()}drawInSpecialArea(g,v,f){var C=this;return(0,Ee.A)(function*(){const I=C.getCanvPainter();return!(!C._special_draw_area||!(0,L.isFunc)(I?.drawProjection))&&I.drawProjection(f||C._special_draw_area,g,v)})()}getToolTip(g){if(void 0===g?.clientX||void 0===g?.clientY)return null;const v=this.getFrameSvg();if(v.empty())return null;const f=v.selectChild(".main_layer");if(f.empty())return null;const C=(0,x.Wn)(g,f.node()),I={touch:!1,x:C[0],y:C[1]};if((0,L.isFunc)(this.extractToolTip))return this.extractToolTip(I);I.disabled=!0;const U=(0,L.isFunc)(this.processTooltipEvent)?this.processTooltipEvent(I):null;return U?.user_info||U}}function F(E,g){const v=new ke.b8(E);return v.txt=g,v.redrawObject=function(f){return this.txt=f,this.drawText(),!0},v.drawText=(0,Ee.A)(function*(){let f=this.txt._typename===L.clTObjString?this.txt.fString:this.txt.value;(0,L.isStr)(f)||(f="<undefined>");const C=this.txt.mathjax||L.settings.Latex===L.constants.Latex.AlwaysMathJax;if(!C&&!("as_is"in this.txt)){const k=f.split("\n");f="";for(let Z=0;Z<k.length;++Z)f+=`<pre style='margin:0'>${k[Z]}</pre>`}const I=this.selectDom();let U=I.select("div");return U.empty()&&(U=I.append("div").attr("style","max-width:100%;max-height:100%;overflow:auto")),U.html(f),this.setTopPainter(),C&&(0,ve.s7)(I.node()),this}),v.drawText()}function J(E){return new De(E).getCanvPainter()}function Y(E){return new De(E).getMainPainter(!0)}let Q=null;function me(E){E.active?(Q?.getFramePainter()?.setFrameActive(!1),Q=E.pp,Q?.getFramePainter()?.setFrameActive(!0)):Q===E.pp&&(Q=null)}function X(){return Q}function B(E,g){!0===g?g={force:!0}:(0,L.isObject)(g)||(g=null);let v=!1;return new De(E).forEachPainter(f=>{!v&&(0,L.isFunc)(f.checkResize)&&(v=f.checkResize(g))}),v}function $(E){const g=new De(E),v=[];return g.forEachPainter(f=>{v.indexOf(f)<0&&v.push(f)}),v.forEach(f=>f.cleanup()),g.selectDom().html(""),v}const A={kDecimals:(0,L.BIT)(7),kTickPlus:(0,L.BIT)(9),kTickMinus:(0,L.BIT)(10),kAxisRange:(0,L.BIT)(11),kCenterTitle:(0,L.BIT)(12),kCenterLabels:(0,L.BIT)(14),kRotateTitle:(0,L.BIT)(15),kPalette:(0,L.BIT)(16),kNoExponent:(0,L.BIT)(17),kLabelsHori:(0,L.BIT)(18),kLabelsVert:(0,L.BIT)(19),kLabelsDown:(0,L.BIT)(20),kLabelsUp:(0,L.BIT)(21),kIsInteger:(0,L.BIT)(22),kMoreLogLabels:(0,L.BIT)(23),kOppositeTitle:(0,L.BIT)(32)}},4082:(Yr,mt,Se)=>{"use strict";Se.d(mt,{Ov:()=>ot,gx:()=>ke});var Ee=Se(8362),x=Se(8872),L=Se(2985);const ve=["","","3,3","1,2","3,4,1,4","5,3,1,3","5,3,1,3,1,3,1,3","5,5","5,3,1,3,1,3","20,5","20,10,1,10","1,3"];class ke{constructor(Ze){this.func=this.apply.bind(this),this.used=!0,Ze._typename&&void 0!==Ze.fLineStyle&&(Ze={attr:Ze}),this.setArgs(Ze)}setArgs(Ze){Ze.attr?(this.color_index=Ze.attr.fLineColor,Ze.color=Ze.color0||(Ze.painter?.getColor(this.color_index)??(0,L.oU)(this.color_index)),void 0===Ze.width&&(Ze.width=Ze.attr.fLineWidth),void 0===Ze.style&&(Ze.style=Ze.attr.fLineStyle)):(0,x.isStr)(Ze.color)?"none"!==Ze.color&&!Ze.width&&(Ze.width=1):"number"==typeof Ze.color&&(this.color_index=Ze.color,Ze.color=Ze.painter?.getColor(Ze.color)??(0,L.oU)(Ze.color)),void 0===Ze.width&&(Ze.width=Ze.color&&"none"!==Ze.color?1:0),this.color=0===Ze.width?"none":Ze.color,this.width=Ze.width,this.style=Ze.style,this.pattern=Ze.pattern||ve[this.style]||null,Ze.can_excl&&(this.excl_side=this.excl_width=0,Math.abs(this.width)>99&&(this.excl_side=this.width<0?-1:1,this.excl_width=5*Math.floor(this.width/100),this.width=Math.abs(this.width%100))),!this.color&&this.width>0&&(this.color="lightgrey")}changeExcl(Ze,Re){void 0!==Re&&(this.excl_width=Re),void 0!==Ze&&(this.excl_side=Ze,0===this.excl_width&&0!==this.excl_side&&(this.excl_width=20)),this.changed=!0}empty(){return"none"===this.color}setUsed(Ze){this.used=Ze}setBorder(Ze,Re){this.rx=Ze,this.ry=Re,this.func=this.applyBorder.bind(this)}apply(Ze){this.used=!0,this.empty()?Ze.style("stroke",null).style("stroke-width",null).style("stroke-dasharray",null):Ze.style("stroke",this.color).style("stroke-width",this.width).style("stroke-dasharray",this.pattern)}applyBorder(Ze){this.used=!0,this.empty()?Ze.style("stroke",null).style("stroke-width",null).style("stroke-dasharray",null).attr("rx",null).attr("ry",null):Ze.style("stroke",this.color).style("stroke-width",this.width).style("stroke-dasharray",this.pattern).attr("rx",this.rx||null).attr("ry",this.ry||null)}change(Ze,Re,He){void 0!==Ze&&(this.color!==Ze&&delete this.color_index,this.color=Ze),void 0!==Re&&(this.width=Re),void 0!==He&&(this.style=He,this.pattern=ve[this.style]||null),this.changed=!0}verifyDirectChange(){this.change(this.color,parseInt(this.width),parseInt(this.style))}createSample(Ze,Re,He,Ve){Ve&&(Ze=(0,Ee.Lt)(Ze)),Ze.append("path").attr("d",`M0,${He/2}h${Re}`).call(this.func)}saveToStyle(Ze,Re,He){if(Ze){const Ve=void 0!==this.color_index?this.color_index:(0,L.vB)(this.color);Ve>=0&&(x.gStyle[Ze]=Ve)}Re&&(x.gStyle[Re]=this.width),He&&(x.gStyle[He]=this.style)}}function ot(Ye){return(Ye<0||Ye>=ve.length)&&(Ye=11),ve[Ye]}},2586:(Yr,mt,Se)=>{"use strict";Se.d(mt,{e:()=>ke});var Ee=Se(8872),x=Se(8362),L=Se(2985);const ve=[0,1,2,3,4,5,106,107,104,1,1,1,1,1,1,1,1,1,1,1,104,125,126,132,4,25,26,27,28,130,30,3,32,127,128,35,36,37,38,137,40,140,42,142,44,144,46,146,148,149];class ke{constructor(Ye){this.x0=this.y0=0,this.color="black",this.style=1,this.size=8,this.scale=1,this.stroke=!0,this.fill=!0,this.marker="",this.ndig=0,this.used=!0,this.changed=!1,this.func=this.apply.bind(this),this.setArgs(Ye),this.changed=!1}setArgs(Ye){(0,Ee.isObject)(Ye)&&"number"==typeof Ye.fMarkerStyle&&(Ye={attr:Ye}),Ye.attr&&(void 0===Ye.color&&(Ye.color=Ye.painter?Ye.painter.getColor(Ye.attr.fMarkerColor):(0,L.oU)(Ye.attr.fMarkerColor)),(!Ye.style||Ye.style<0)&&(Ye.style=Ye.attr.fMarkerStyle),Ye.size||(Ye.size=Ye.attr.fMarkerSize)),this.color=Ye.color,this.style=Ye.style,this.size=Ye.size,this.refsize=Ye.refsize,this._configure()}setUsed(Ye){this.used=Ye}resetPos(){this.lastx=this.lasty=null}create(Ye,Ze){if(!this.optimized)return`M${(Ye+this.x0).toFixed(this.ndig)},${(Ze+this.y0).toFixed(this.ndig)}${this.marker}`;const Re=Math.round(Ye),He=Math.round(Ze);let Ve=`M${Re},${He}`;if(null!==this.lastx)if(Re===this.lastx&&He===this.lasty)Ve="";else{const De=`m${Re-this.lastx},${He-this.lasty}`;De.length<Ve.length&&(Ve=De)}return this.lastx=Re+1,this.lasty=He,Ve+"h1"}getFullSize(){return this.scale*this.size}getMarkerLength(){return this.marker?this.marker.length:10}change(Ye,Ze,Re){this.changed=!0,void 0!==Ye&&(this.color=Ye),void 0!==Ze&&Ze>=0&&(this.style=Ze),void 0!==Re&&(this.size=Re),this._configure()}_configure(){if(this.x0=this.y0=0,1===this.style||777===this.style)return this.fill=!1,this.marker="h1",this.size=1,this.optimized=!0,this.resetPos(),!0;this.optimized=!1;const Ye=ve[this.style]??104,Ze=Ye%100;this.fill=Ye>=100,this.scale=this.refsize||8;const Re=this.getFullSize();this.ndig=Re>7?0:Re>2?1:2,30===Ze&&this.ndig++;let He=Re.toFixed(this.ndig);const Ve=(Re/2).toFixed(this.ndig),De=(Re/3).toFixed(this.ndig),F=(Re/4).toFixed(this.ndig),J=(Re/8).toFixed(this.ndig),Y=(3*Re/8).toFixed(this.ndig);switch(Ze){case 1:this.marker="h1";break;case 2:this.y0=-Re/2,this.marker=`v${He}m-${Ve},-${Ve}h${He}`;break;case 3:this.x0=this.y0=-Re/2,this.marker=`l${He},${He}m0,-${He}l-${He},${He}m0,-${Ve}h${He}m-${Ve},-${Ve}v${He}`;break;case 4:this.x0=-parseFloat(Ve),He=(2*parseFloat(Ve)).toFixed(this.ndig),this.marker=`a${Ve},${Ve},0,1,0,${He},0a${Ve},${Ve},0,1,0,-${He},0z`;break;case 5:this.x0=this.y0=-Re/2,this.marker=`l${He},${He}m0,-${He}l-${He},${He}`;break;case 6:this.x0=-1,this.marker="a1,1,0,1,0,2,0a1,1,0,1,0,-2,0z";break;case 7:this.x0=-1.5,this.marker="a1.5,1.5,0,1,0,3,0a1.5,1.5,0,1,0,-3,0z";break;case 25:this.x0=this.y0=-Re/2,this.marker=`v${He}h${He}v-${He}z`;break;case 26:this.y0=-Re/2,this.marker=`l-${Ve},${He}h${He}z`;break;case 27:default:this.y0=-Re/2,this.marker=`l${De},${Ve}l-${De},${Ve}l-${De},-${Ve}z`;break;case 28:this.x0=this.y0=Re/6,this.marker=`h${De}v-${De}h-${De}v-${De}h-${De}v${De}h-${De}v${De}h${De}v${De}h${De}z`;break;case 30:{this.y0=-Re/2;const ue=(5*Re/6).toFixed(this.ndig),Q=(5*Re/8).toFixed(this.ndig);this.marker=`l${De},${He}l-${ue},-${Q}h${He}l-${ue},${Q}z`;break}case 32:this.y0=Re/2,this.marker=`l-${Ve},-${He}h${He}z`;break;case 35:this.x0=-Re/2,this.marker=`l${Ve},${Ve}l${Ve},-${Ve}l-${Ve},-${Ve}zh${He}m-${Ve},-${Ve}v${He}`;break;case 36:this.x0=this.y0=-Re/2,this.marker=`h${He}v${He}h-${He}zl${He},${He}m0,-${He}l-${He},${He}`;break;case 37:this.x0=-Re/2,this.marker=`h${He}l-${F},-${Ve}l-${Ve},${He}h${Ve}l-${Ve},-${He}z`;break;case 38:this.x0=-Re/4,this.y0=-Re/2,this.marker=`h${Ve}l${F},${F}v${Ve}l-${F},${F}h-${Ve}l-${F},-${F}v-${Ve}zm${F},0v${He}m-${Ve},-${Ve}h${He}`;break;case 40:this.x0=-Re/4,this.y0=-Re/2,this.marker=`l${Ve},${He}l${F},-${F}l-${He},-${Ve}zm${Ve},0l-${Ve},${He}l-${F},-${F}l${He},-${Ve}z`;break;case 42:this.y0=-Re/2,this.marker=`l${J},${Y}l${Y},${J}l-${Y},${J}l-${J},${Y}l-${J},-${Y}l-${Y},-${J}l${Y},-${J}z`;break;case 44:this.x0=-Re/4,this.y0=-Re/2,this.marker=`h${Ve}l-${J},${Y}l${Y},-${J}v${Ve}l-${Y},-${J}l${J},${Y}h-${Ve}l${J},-${Y}l-${Y},${J}v-${Ve}l${Y},${J}z`;break;case 46:this.x0=-Re/4,this.y0=-Re/2,this.marker=`l${F},${F}l${F},-${F}l${F},${F}l-${F},${F}l${F},${F}l-${F},${F}l-${F},-${F}l-${F},${F}l-${F},-${F}l${F},-${F}l-${F},-${F}z`;break;case 48:this.x0=-Re/4,this.y0=-Re/2,this.marker=`l${F},${F}l-${F},${F}l-${F},-${F}zm${Ve},0l${F},${F}l-${F},${F}l-${F},-${F}zm0,${Ve}l${F},${F}l-${F},${F}l-${F},-${F}zm-${Ve},0l${F},${F}l-${F},${F}l-${F},-${F}z`;break;case 49:this.x0=-Re/6,this.y0=-Re/2,this.marker=`h${De}v${De}h-${De}zm${De},${De}h${De}v${De}h-${De}zm-${De},${De}h${De}v${De}h-${De}zm-${De},-${De}h${De}v${De}h-${De}z`}return!0}getStrokeColor(){return this.stroke?this.color:"none"}getFillColor(){return this.fill?this.color:"none"}empty(){return"none"===this.color||!this.fill&&!this.stroke}apply(Ye){this.used=!0,Ye.style("stroke",this.stroke?this.color:"none").style("fill",this.fill?this.color:"none")}verifyDirectChange(){this.change(this.color,parseInt(this.style),parseFloat(this.size))}createSample(Ye,Ze,Re,He){He&&(Ye=(0,x.Lt)(Ye)),this.resetPos(),Ye.append("path").attr("d",this.create(Ze/2,Re/2)).call(this.func)}}},3847:(Yr,mt,Se)=>{"use strict";Se.d(mt,{Bx:()=>Ze,DH:()=>C,DJ:()=>E,Fc:()=>A,G1:()=>$,KG:()=>g,LR:()=>F,Sc:()=>B,Te:()=>Re,Yw:()=>J,_l:()=>f,ke:()=>Ve,mZ:()=>He,oE:()=>me,rv:()=>Q,yW:()=>ue});var Ee=Se(4882),x=Se(8362),L=Se(2923),ve=Se(8872),ke=Se(2843),ot=Se(2586),Ye=Se(4082);function Ze(I,U){if((!U||!(0,ve.isObject)(U))&&(U={}),(0,ve.isStr)(I)&&("#"===I[0]&&9===I.length||I.indexOf("rgba")>=0)){const k=(0,x.yW)(I);U.color=new L.Q1f(k.r,k.g,k.b),U.opacity=k.opacity??1,U.transparent=U.opacity<1}else U.color=new L.Q1f(I);return U}const Re=new L.KQV(L.c9P);function He(I,U,k){if(I){void 0!==k&&(globalThis.docuemnt=k);const P=new L.w4A;return P.setPrecision(U),P}const he={svg_attr:{},svg_style:{},path_attr:{},accPath:"",createElementNS(P,T){return"path"===T?{_wrapper:this,setAttribute(z,W){if("style"===z&&W){const fe=W.indexOf(";stroke-opacity:1;stroke-width:1;stroke-linecap:round");fe>=0&&fe===W.length-53&&(W=W.slice(0,W.length-53));const we=W.indexOf(";fill-opacity:1");we>=0&&we===W.length-15&&(W=W.slice(0,W.length-15))}this._wrapper.path_attr[z]=W}}:"svg"!==T?(console.error(`not supported element for SVGRenderer ${T}`),null):{_wrapper:this,childNodes:[],style:this.svg_style,setAttribute(z,W){this._wrapper.svg_attr[z]=W},appendChild(z){this._wrapper.accPath+=`<path style="${this._wrapper.path_attr.style}" d="${this._wrapper.path_attr.d}"/>`,this._wrapper.path_attr={}},removeChild(z){this.childNodes=[]}}}};let G;(0,ve.isNodeJs)()&&(G=globalThis.document,globalThis.document=he);const b=new L.w4A;return(0,ve.isNodeJs)()&&(globalThis.document=G),b.doc_wrapper=he,b.originalRender=b.render,b.render=function(P,T){const z=globalThis.document;(0,ve.isNodeJs)()&&(globalThis.document=this.doc_wrapper),this.originalRender(P,T),(0,ve.isNodeJs)()&&(globalThis.document=z)},b.clearHTML=function(){this.doc_wrapper.accPath=""},b.makeOuterHTML=function(){const P=this.doc_wrapper;return`<svg xmlns="http://www.w3.org/2000/svg" viewBox="${P.svg_attr.viewBox}" width="${P.svg_attr.width}" height="${P.svg_attr.height}"${P.svg_style.backgroundColor?` style="background:${P.svg_style.backgroundColor}"`:""}>${P.accPath}</svg>`},b.fillTargetSVG=function(P){if((0,ve.isNodeJs)()){const T=this.doc_wrapper;P.setAttribute("viewBox",T.svg_attr.viewBox),P.setAttribute("width",T.svg_attr.width),P.setAttribute("height",T.svg_attr.height),P.style.background=T.svg_style.backgroundColor||"",P.innerHTML=T.accPath}else{const T=this.domElement;for(P.setAttribute("viewBox",T.getAttribute("viewBox")),P.setAttribute("width",T.getAttribute("width")),P.setAttribute("height",T.getAttribute("height")),P.style.background=T.style.backgroundColor;T.firstChild;){const z=T.firstChild;T.removeChild(z),P.appendChild(z)}}},b.setPrecision(U),b}function Ve(I,U){void 0===U&&(U=(0,ve.isBatchMode)()),I||(I=U?ve.settings.Render3DBatch:ve.settings.Render3D);const k=ve.constants.Render3D;return I===k.Default&&(I=U?k.WebGLImage:k.WebGL),U&&I===k.WebGL&&(I=k.WebGLImage),I}const De={access3dKind(I){const U=this.getPadSvg();if(U.empty())return-1;const k=U.property("can3d");return void 0!==I&&U.property("can3d",I),k??-1},getSizeFor3d(I){void 0===I&&(I=(I=Ve())!==ve.constants.Render3D.WebGL?ve.constants.Embed3D.EmbedSVG:ve.settings.Embed3D!==ve.constants.Embed3D.Default?ve.settings.Embed3D:ve.browser.isFirefox||ve.browser.chromeVersion>95?ve.constants.Embed3D.Embed:ve.constants.Embed3D.Overlay);const U=this.getPadSvg(),k="draw3d_"+(this.getPadName()||"canvas");if(U.empty()){const b=(0,ke.xh)(this.selectDom());return b.height<10&&b.width>10&&(b.height=Math.round(.66*b.width),this.selectDom().style("height",b.height+"px")),b.x=0,b.y=0,b.clname=k,b.can3d=-1,b}const Z=this.getFramePainter(),ee=this.getPadPainter();let he;if(Z?.mode3d&&I>0)he=Z.getFrameRect();else{let b=I>0?U:this.getCanvSvg();he={x:0,y:0,width:b.property("draw_width"),height:b.property("draw_height")},Number.isNaN(he.width)||Number.isNaN(he.height)?(he.width=ee.getPadWidth(),he.height=ee.getPadHeight()):Z&&!Z.mode3d&&(b=this.getFrameSvg(),he.x=b.property("draw_x"),he.y=b.property("draw_y"))}he.clname=k,he.can3d=I;const G=ee?.getPadRect();if(G){const b=Math.round(.07*he.width),P=Math.round(.05*he.height);he.x=Math.max(0,he.x-b),he.y=Math.max(0,he.y-P),he.width=Math.min(he.width+2*b,G.width-he.x),he.height=Math.min(he.height+2*P,G.height-he.y)}return 1===I&&(he=(0,ke.md)(this.getPadSvg(),he)),he},clear3dCanvas(){const I=this.access3dKind(null);if(I<0){const k=this.selectDom().node();let Z=k?.firstChild;return Z&&!Z.$jsroot&&(Z=Z.nextSibling),Z?.$jsroot&&(delete Z.painter,k.removeChild(Z)),I}const U=this.getSizeFor3d(I);if(0===U.can3d)(0,x.Lt)(this.getCanvSvg().node().nextSibling).remove(),this.getCanvSvg().style("display",null);else{if(this.getPadSvg().empty())return;this.apply3dSize(U).remove(),this.getFrameSvg().style("display",null)}return I},add3dCanvas(I,U,k){if(U&&!(I.can3d<-1)){if(-1===I.can3d){const Z=this.selectDom().node();return void(null!==Z&&(Z.appendChild(U),U.painter=this,U.$jsroot=!0))}if(I.can3d>0&&!k&&(I.can3d=ve.constants.Embed3D.EmbedSVG),this.access3dKind(I.can3d),0===I.can3d)this.getCanvSvg().style("display","none"),this.getCanvSvg().node().parentNode.appendChild(U);else{if(this.getPadSvg().empty())return;this.getFrameSvg().style("display","none"),this.apply3dSize(I).attr("title","").node().appendChild(U)}}},apply3dSize(I,U){if(I.can3d<0)return(0,x.Lt)(null);let k;if(I.can3d>1){if(k=this.getLayerSvg(I.clname),U)return k;const Z=this.getPadSvg();I.can3d===ve.constants.Embed3D.EmbedSVG?(k.empty()&&(k=Z.insert("g",".primitives_layer").attr("class",I.clname)),(0,ke.bk)(k,I.x,I.y)):(k.empty()&&(k=Z.insert("foreignObject",".primitives_layer").attr("class",I.clname)),k.attr("x",I.x).attr("y",I.y).attr("width",I.width).attr("height",I.height).attr("viewBox",`0 0 ${I.width} ${I.height}`).attr("preserveAspectRatio","xMidYMid"))}else{let Z=this.getCanvSvg().node().parentNode;if(k=(0,x.Lt)(Z).select("."+I.clname),U)return k;this.getCanvSvg().property("redraw_by_resize",!0),k.empty()&&(k=(0,x.Lt)(Z).append("div").attr("class",I.clname).style("user-select","none"));const ee=Z.getBoundingClientRect(),he=(0,ve.getDocument)();for(;Z;){if(Z===he){Z=null;break}try{if("static"!==getComputedStyle(Z).position)break}catch{break}Z=Z.parentNode}const G=Z?.getBoundingClientRect()??{top:0,left:0},b=Math.round(ee.left-G.left),P=Math.round(ee.top-G.top);k.style("position","absolute").style("left",I.x+b+"px").style("top",I.y+P+"px").style("width",I.width+"px").style("height",I.height+"px")}return k}};function F(I){Object.assign(I,De)}function J(I,U,k,Z){return Y.apply(this,arguments)}function Y(){return(Y=(0,Ee.A)(function*(I,U,k,Z){const ee=ve.constants.Render3D,he=(0,ve.getDocument)();let G;if(k=Ve(k),Z||(Z={antialias:!0,alpha:!0}),k===ee.SVG){const b=He(!1,0,he);b.jsroot_dom=he.createElementNS("http://www.w3.org/2000/svg","svg"),G=Promise.resolve(b)}else if((0,ve.isNodeJs)())G=Se.e(511).then(Se.t.bind(Se,1511,19)).then(b=>(Z.canvas=b.default.createCanvas(I,U),Z.canvas.addEventListener=()=>{},Z.canvas.removeEventListener=()=>{},Z.canvas.style={},Se.e(254).then(Se.t.bind(Se,8254,19)))).then(b=>{const P=b.default(I,U,{preserveDrawingBuffer:!0});if(!P)throw Error("Fail to create headless-gl");Z.context=P,P.canvas=Z.canvas;const T=new L.JeP(Z);return T.jsroot_output=new L.nWS(I,U),T.setRenderTarget(T.jsroot_output),T.jsroot_dom=he.createElementNS("http://www.w3.org/2000/svg","image"),T});else if(k===ee.WebGL)G=Promise.resolve(new L.JeP(Z));else{const b=new L.JeP(Z);b.jsroot_dom=he.createElementNS("http://www.w3.org/2000/svg","image"),G=Promise.resolve(b)}return G.then(b=>(b.jsroot_dom?b.jsroot_custom_dom=!0:b.jsroot_dom=b.domElement,b.jsroot_render3d=k,b.jsroot_image_format="png",b.originalSetSize=b.setSize,b.setSize=function(P,T,z){this.jsroot_custom_dom&&(this.jsroot_dom.setAttribute("width",P),this.jsroot_dom.setAttribute("height",T)),this.originalSetSize(P,T,z)},b.setSize(I,U),b))})).apply(this,arguments)}function ue(I){if(I)if((0,ve.isNodeJs)()){const U=(0,ve.isFunc)(I.getContext)?I.getContext():null,k=U?.getExtension("STACKGL_destroy_context");(0,ve.isFunc)(k?.destroy)&&k.destroy()}else ve.browser.isChrome&&(0,ve.isFunc)(I.forceContextLoss)&&I.forceContextLoss(),(0,ve.isFunc)(I.dispose)&&I.dispose()}function Q(I){(0,ve.isFunc)(I.clearHTML)&&I.clearHTML()}function me(I){const U=ve.constants.Render3D;if(I.jsroot_render3d!==U.WebGL)if(I.jsroot_render3d===U.SVG)I.fillTargetSVG(I.jsroot_dom);else if((0,ve.isNodeJs)()){const k=I.domElement,Z=k.getContext("2d"),ee=new Uint8Array(4*k.width*k.height);I.readRenderTargetPixels(I.jsroot_output,0,0,k.width,k.height,ee);let b,P,he=0,G=4*(k.height-1)*k.width;for(;he<G;){for(b=0;b<4*k.width;++b)P=ee[he+b],ee[he+b]=ee[G+b],ee[G+b]=P;he+=4*k.width,G-=4*k.width}const T=Z.createImageData(k.width,k.height);T.data.set(ee),Z.putImageData(T,0,0);const W=k.toDataURL("image/"+I.jsroot_image_format);I.jsroot_dom.setAttribute("href",W)}else{const k=I.domElement.toDataURL("image/"+I.jsroot_image_format);I.jsroot_dom.setAttribute("href",k)}}class X{constructor(U,k){this.tt=null,this.cont=null,this.lastlbl="",this.parent=U||(0,ve.getDocument)().body,this.canvas=k,this.abspos=!U}checkParent(U){U&&this.parent!==U&&(this.hide(),this.parent=U)}extract_pos(U){if((0,ve.isObject)(U)&&void 0!==U.u&&void 0!==U.l)return U;const k={u:0,l:0};return this.abspos?(k.l=U.pageX,k.u=U.pageY):(k.l=U.offsetX,k.u=U.offsetY),k}pos(U){if(!this.tt)return;const k=this.extract_pos(U);if(!this.abspos){const Z=this.parent.getBoundingClientRect(),ee=this.canvas.getBoundingClientRect();void 0!==Z.left&&void 0!==ee.left&&(k.l+=ee.left-Z.left),void 0!==Z.top&&void 0!==ee.top&&(k.u+=ee.top-Z.top),k.l+this.tt.offsetWidth+3>=this.parent.offsetWidth&&(k.l=this.parent.offsetWidth-this.tt.offsetWidth-3),k.u+this.tt.offsetHeight+15>=this.parent.offsetHeight&&(k.u=this.parent.offsetHeight-this.tt.offsetHeight-15);let he=this.parent;for(;he;){const G=getComputedStyle(he);if(!G||"static"!==G.position||!he.parentNode||1!==he.parentNode.nodeType)break;he=he.parentNode}if(he&&he!==this.parent){const G=he.getBoundingClientRect();k.l+=Z.left-G.left,k.u+=Z.top-G.top}}this.tt.style.top=`${k.u+15}px`,this.tt.style.left=`${k.l+3}px`}show(U){if(!U)return this.hide();if((0,ve.isObject)(U)&&(U.lines||U.line)){if(U.only_status)return this.hide();if(U.line)U=U.line;else{let k=U.lines[0];for(let Z=1;Z<U.lines.length;++Z)k+="<br/>"+U.lines[Z];U=k}}if(null===this.tt){const k=(0,ve.getDocument)();this.tt=k.createElement("div"),this.tt.setAttribute("style","opacity: 1; filter: alpha(opacity=1); position: absolute; display: block; overflow: hidden; z-index: 101;"),this.cont=k.createElement("div"),this.cont.setAttribute("style","display: block; padding: 2px 12px 3px 7px; margin-left: 5px; font-size: 11px; background: #777; color: #fff;"),this.tt.appendChild(this.cont),this.parent.appendChild(this.tt)}this.lastlbl!==U&&(this.cont.innerHTML=U,this.lastlbl=U,this.tt.style.width="auto")}hide(){null!==this.tt&&this.parent.removeChild(this.tt),this.tt=null,this.lastlbl=""}}function B(I,U,k,Z,ee){const he=ve.settings.Zooming&&ve.settings.ZoomMouse,G=(0,ve.isFunc)(I.processMouseClick);let b=null;function P(fe){if(b){if(b.mouse_zoom_mesh)return fe.stopImmediatePropagation(),void fe.stopPropagation();if(!(void 0!==fe.button&&0!==fe.button||void 0!==fe.buttons&&1!==fe.buttons)){if(b.enable_zoom&&(b.mouse_zoom_mesh=b.detectZoomMesh(fe),b.mouse_zoom_mesh))return fe.stopImmediatePropagation(),void fe.stopPropagation();b.enable_select&&(b.mouse_select_pnt=b.getMousePos(fe,{}))}}}function T(fe){if(b){if(b.mouse_zoom_mesh&&b.mouse_zoom_mesh.point2&&b.painter.get3dZoomCoord){let we=b.mouse_zoom_mesh.object.zoom,Me=b.painter.get3dZoomCoord(b.mouse_zoom_mesh.point,we),je=b.painter.get3dZoomCoord(b.mouse_zoom_mesh.point2,we);Me>je&&([Me,je]=[je,Me]),"z"===we&&b.mouse_zoom_mesh.object.use_y_for_z&&(we="y"),Me<je&&b.painter.zoom(we,Me,je)&&(b.mouse_zoom_mesh=null)}if(b.enable_zoom&&b.removeZoomMesh(),b.enable_select&&b.mouse_select_pnt){const we=b.getMousePos(fe,{}),Me=we.x===b.mouse_select_pnt.x&&we.y===b.mouse_select_pnt.y;if(delete b.mouse_select_pnt,Me){const je=b.getMouseIntersects(we);b.painter.processMouseClick(we,je,fe)}}}}function W(fe){if(!b)return;if(function z(fe){return!(!fe||void 0===fe.renderer)&&void 0!==fe.render_tmout}(b.painter)||b.mouse_zoom_mesh)return fe.preventDefault(),fe.stopPropagation(),void fe.stopImmediatePropagation();const we=b.detectZoomMesh(fe);if(we&&(fe.preventDefault(),fe.stopPropagation(),fe.stopImmediatePropagation(),(0,ve.isFunc)(b.painter?.analyzeMouseWheelEvent))){let Me=we.object.zoom,je=we.point[Me];const Ge={name:Me,ignore:!1};switch(Me){case"x":je=(je+b.painter.size_x3d)/2/b.painter.size_x3d;break;case"y":je=(je+b.painter.size_y3d)/2/b.painter.size_y3d;break;case"z":je=je/2/b.painter.size_z3d}b.painter.analyzeMouseWheelEvent(fe,Ge,je,!1),"z"===Me&&we.object.use_y_for_z&&(Me="y"),b.painter.zoom(Me,Ge.min,Ge.max)}}return ve.settings.Zooming&&ve.settings.ZoomWheel&&Z.domElement.addEventListener("wheel",W),(he||G)&&(Z.domElement.addEventListener("pointerdown",P),Z.domElement.addEventListener("pointerup",T)),b=new L.NUf(U,Z.domElement),b.enableDamping=!1,b.dampingFactor=1,b.enableZoom=!0,b.enableKeys=ve.settings.HandleKeys,ee&&(b.target.copy(ee),b.target0.copy(ee),b.update()),b.tooltip=new X(I.selectDom().node(),Z.domElement),b.painter=I,b.camera=U,b.scene=k,b.renderer=Z,b.raycaster=new L.tBo,b.raycaster.params.Line.threshold=10,b.raycaster.params.Points.threshold=5,b.mouse_zoom_mesh=null,b.block_ctxt=!1,b.block_mousemove=!1,b.cursor_changed=!1,b.control_changed=!1,b.control_active=!1,b.mouse_ctxt={x:0,y:0,on:!1},b.enable_zoom=he,b.enable_select=G,b.cleanup=function(){ve.settings.Zooming&&ve.settings.ZoomWheel&&this.domElement.removeEventListener("wheel",W),(this.enable_zoom||this.enable_select)&&(this.domElement.removeEventListener("pointerdown",P),this.domElement.removeEventListener("pointerup",T)),this.domElement.removeEventListener("click",this.lstn_click),this.domElement.removeEventListener("dblclick",this.lstn_dblclick),this.domElement.removeEventListener("contextmenu",this.lstn_contextmenu),this.domElement.removeEventListener("mousemove",this.lstn_mousemove),this.domElement.removeEventListener("mouseleave",this.lstn_mouseleave),this.dispose(),this.tooltip.hide(),delete this.tooltip,delete this.painter,delete this.camera,delete this.scene,delete this.renderer,delete this.raycaster,delete this.mouse_zoom_mesh},b.HideTooltip=function(){this.tooltip.hide()},b.getMousePos=function(fe,we){return we.x="offsetX"in fe?fe.offsetX:fe.layerX,we.y="offsetY"in fe?fe.offsetY:fe.layerY,we.clientX=fe.clientX,we.clientY=fe.clientY,we},b.getOriginDirectionIntersects=function(fe,we){this.raycaster.set(fe,we);let Me=this.raycaster.intersectObjects(this.scene.children,!0);return(0,ve.isFunc)(this.painter.filterIntersects)&&(Me=this.painter.filterIntersects(Me)),Me},b.getMouseIntersects=function(fe){if(!this.renderer)return[];const we=this.renderer instanceof L.w4A?this.renderer.domElement:this.renderer.getSize(new L.I9Y),Me={x:fe.x/we.width*2-1,y:-fe.y/we.height*2+1};this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.raycaster.setFromCamera(Me,this.camera);let je=this.raycaster.intersectObjects(this.scene.children,!0);return(0,ve.isFunc)(this.painter.filterIntersects)&&(je=this.painter.filterIntersects(je)),je},b.detectZoomMesh=function(fe){const we=this.getMousePos(fe,{}),Me=this.getMouseIntersects(we);if(Me)for(let je=0;je<Me.length;++je)if(Me[je].object.zoom&&!Me[je].object.zoom_disabled)return Me[je];return null},b.getInfoAtMousePosition=function(fe){const we=this.getMouseIntersects(fe);let Me=null,je=null;for(let Ge=0;Ge<we.length;++Ge)if(we[Ge].object.tooltip){Me=we[Ge].object.tooltip(we[Ge]),je=we[Ge].object.painter;break}if(Me&&je)return{obj:je.getObject(),name:je.getObject().fName,bin:Me.bin,cont:Me.value,binx:Me.ix,biny:Me.iy,binz:Me.iz,grx:(Me.x1+Me.x2)/2,gry:(Me.y1+Me.y2)/2,grz:(Me.z1+Me.z2)/2}},b.processDblClick=function(fe){const we=this.detectZoomMesh(fe);if(we&&this.painter)return void this.painter.unzoom(we.object.use_y_for_z?"y":we.object.zoom);const Me=this.painter?.getFramePainter();if((0,ve.isFunc)(Me?._dblclick_handler)){const je=this.getInfoAtMousePosition(this.getMousePos(fe,{}));if(je)return void Me._dblclick_handler(je)}this.reset()},b.changeEvent=function(){this.mouse_ctxt.on=!1,this.painter.render3D(0),this.control_changed=!0},b.startEvent=function(){this.control_active=!0,this.block_ctxt=!1,this.mouse_ctxt.on=!1,this.tooltip.hide()},b.endEvent=function(){this.control_active=!1,this.mouse_ctxt.on&&(this.mouse_ctxt.on=!1,this.contextMenu(this.mouse_ctxt,this.getMouseIntersects(this.mouse_ctxt))),this.control_changed=!1},b.mainProcessContextMenu=function(fe){fe.preventDefault(),this.getMousePos(fe,this.mouse_ctxt),this.control_active?this.mouse_ctxt.on=!0:this.block_ctxt?this.block_ctxt=!1:this.contextMenu(this.mouse_ctxt,this.getMouseIntersects(this.mouse_ctxt))},b.contextMenu=function(){},b.setTooltipEnabled=function(fe){this.block_mousemove=!fe,!1===fe&&(this.tooltip.hide(),this.removeZoomMesh())},b.removeZoomMesh=function(){this.mouse_zoom_mesh?.object.showSelection()&&this.painter.render3D(),this.mouse_zoom_mesh=null},b.mainProcessMouseMove=function(fe){if(this.painter&&(this.control_active&&fe.buttons&&2&fe.buttons&&(this.block_ctxt=!0),!this.control_active&&!this.block_mousemove&&(0,ve.isFunc)(this.processMouseMove))){if(this.mouse_zoom_mesh){const we=this.detectZoomMesh(fe),Me=we?.object===this.mouse_zoom_mesh.object?we.point:this.mouse_zoom_mesh.object.globalIntersect(this.raycaster);return Me&&(this.mouse_zoom_mesh.point2=Me),Me&&this.painter.enable_highlight&&this.mouse_zoom_mesh.object.showSelection(this.mouse_zoom_mesh.point,Me)&&this.painter.render3D(0),void this.tooltip.hide()}fe.preventDefault(),this.tmout_mouse=this.getMousePos(fe,{}),this.tmout_ttpos=this.tooltip?.extract_pos(fe),this.tmout_handle&&(clearTimeout(this.tmout_handle),delete this.tmout_handle),this.mouse_tmout?this.tmout_handle=setTimeout(()=>this.delayedProcessMouseMove(),this.mouse_tmout):this.delayedProcessMouseMove()}},b.delayedProcessMouseMove=function(){if(delete this.tmout_handle,!this.painter)return;const fe=this.tmout_mouse,we=this.getMouseIntersects(fe),Me=this.processMouseMove(we);if(Me){let je="",Ge="",lt="",bt="";fe&&(lt=fe.x.toFixed(0)+","+fe.y.toFixed(0)),(0,ve.isStr)(Me)?bt=Me:(je=Me.name,Ge=Me.title,Me.line?bt=Me.line:Me.lines&&(bt=Me.lines.slice(1).join(" "),je=Me.lines[0])),this.painter.showObjectStatus(je,Ge,bt,lt)}if(this.cursor_changed=!1,Me&&this.painter?.isTooltipAllowed())this.tooltip.checkParent(this.painter.selectDom().node()),this.tooltip.show(Me,fe),this.tooltip.pos(this.tmout_ttpos);else if(this.tooltip.hide(),we)for(let je=0;je<we.length;++je)we[je].object.zoom&&!we[je].object.zoom_disabled&&(this.cursor_changed=!0);(0,ve.getDocument)().body.style.cursor=this.cursor_changed?"pointer":"auto"},b.mainProcessMouseLeave=function(){this.painter&&(this.tmout_handle&&(clearTimeout(this.tmout_handle),delete this.tmout_handle),this.tooltip.hide(),(0,ve.isFunc)(this.processMouseLeave)&&this.processMouseLeave(),this.cursor_changed&&((0,ve.getDocument)().body.style.cursor="auto",this.cursor_changed=!1))},b.mainProcessDblClick=function(fe){this.single_click_tm&&(clearTimeout(this.single_click_tm),delete this.single_click_tm),this.processDblClick(fe)},b.processClick=function(fe,we){if(delete this.single_click_tm,1===we){const Me=this.painter?.getFramePainter();if((0,ve.isFunc)(Me?._click_handler)){const je=this.getInfoAtMousePosition(fe);if(je)return void Me._click_handler(je)}}if(2===we&&(0,ve.isFunc)(this.processSingleClick)){const Me=this.getMouseIntersects(fe);this.processSingleClick(Me)}},b.lstn_click=function(fe){if(2===fe.detail)return;this.single_click_tm&&(clearTimeout(this.single_click_tm),delete this.single_click_tm);let we=0;(0,ve.isFunc)(this.painter?.getFramePainter()?._click_handler)?we=1:this.processSingleClick&&this.painter?.options?.mouse_click&&(we=2),we&&(this.single_click_tm=setTimeout(this.processClick.bind(this,this.getMousePos(fe,{}),we),300))}.bind(b),b.addEventListener("change",()=>b.changeEvent()),b.addEventListener("start",()=>b.startEvent()),b.addEventListener("end",()=>b.endEvent()),b.lstn_contextmenu=fe=>b.mainProcessContextMenu(fe),b.lstn_dblclick=fe=>b.mainProcessDblClick(fe),b.lstn_mousemove=fe=>b.mainProcessMouseMove(fe),b.lstn_mouseleave=()=>b.mainProcessMouseLeave(),Z.domElement.addEventListener("click",b.lstn_click),Z.domElement.addEventListener("dblclick",b.lstn_dblclick),Z.domElement.addEventListener("contextmenu",b.lstn_contextmenu),Z.domElement.addEventListener("mousemove",b.lstn_mousemove),Z.domElement.addEventListener("mouseleave",b.lstn_mouseleave),b}function $(I,U){if(I){if(I.children)for(let k=0;k<I.children.length;k++)$(I.children[k]);if(U)return void(I.children=[]);I.children=void 0,I.geometry&&(I.geometry.dispose(),I.geometry=void 0),I.material&&(I.material.map&&(I.material.map.dispose(),I.material.map=void 0),I.material.dispose(),I.material=void 0),delete I.painter,delete I.bins_index,delete I.tooltip,delete I.stack,delete I.drawn_highlight,I=void 0}}function A(I,U,k=void 0,Z=!1){const ee=new L.LoY;if(ee.setAttribute("position",I instanceof Float32Array?new L.THS(I,3):new L.qtW(I,3)),k&&ee.setIndex(new L.THS(k,1)),U.isLineDashedMaterial){const he=new L.Pq0,G=new L.Pq0;let b=0,P=null;if(k){P=new Float32Array(k.length);for(let T=0;T<k.length;T+=2){const z=k[T],W=k[T+1];he.set(I[z],I[z+1],I[z+2]),G.set(I[W],I[W+1],I[W+2]),P[T]=b,b+=G.distanceTo(he),P[T+1]=b}}else{P=new Float32Array(I.length/3);for(let T=0;T<I.length;T+=6)he.set(I[T],I[T+1],I[T+2]),G.set(I[T+3],I[T+4],I[T+5]),P[T/3]=b,b+=G.distanceTo(he),P[T/3+1]=b}ee.setAttribute("lineDistance",new L.THS(P,1))}return Z?ee:new L.DXC(ee,U)}const E={Vertices:[new L.Pq0(1,1,1),new L.Pq0(1,1,0),new L.Pq0(1,0,1),new L.Pq0(1,0,0),new L.Pq0(0,1,0),new L.Pq0(0,1,1),new L.Pq0(0,0,0),new L.Pq0(0,0,1)],Indexes:[0,2,1,2,3,1,4,6,5,6,7,5,4,5,1,5,0,1,7,6,2,6,3,2,5,7,0,7,2,0,1,3,4,3,6,4],Normals:[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],Segments:[0,2,2,7,7,5,5,0,1,3,3,6,6,4,4,1,1,0,3,2,6,7,4,5],MeshSegments:void 0};E.MeshSegments=function(){const I=new Int32Array(E.Segments.length);for(let U=0;U<I.length;++U)for(let k=0;k<E.Indexes.length;++k)if(E.Segments[U]===E.Indexes[k]){I[U]=k;break}return I}();class g{cleanup(){}extractIndex(){}setSelected(){}setHighlight(){}checkHighlightIndex(){}}class f{constructor(U,k=!0,Z=1){this.webgl=k,this.scale=Z||1,this.pos=new Float32Array(3*U),this.geom=new L.LoY,this.geom.setAttribute("position",new L.THS(this.pos,3)),this.indx=0}addPoint(U,k,Z){this.pos[this.indx]=U,this.pos[this.indx+1]=k,this.pos[this.indx+2]=Z,this.indx+=3}createPoints(U){(0,ve.isObject)(U)||(U={color:U}),U.color||(U.color="black");let k=1;U.style?1===U.style?k=.3:6===U.style?k=.5:7===U.style&&(k=.7):k=1.1;const Z=T=>{const z={size:3*this.scale*k};T?(z.map=T,z.transparent=!0):z.color=U.color||"black";const W=new L.ONl(this.geom,new L.BH$(z));return W.nvertex=1,W};if(1!==k){const T=Z();return this.noPromise?T:Promise.resolve(T)}const ee=new ot.e({style:U.style,color:U.color,size:7}),he=ee.fill?1:7,G=`<svg width="64" height="64" xmlns="http://www.w3.org/2000/svg"><path d="${ee.create(32,32)}" style="stroke: ${ee.getStrokeColor()}; stroke-width: ${he}; fill: ${ee.getFillColor()}"></path></svg>`,b="data:image/svg+xml;charset=utf8,"+((0,ve.isNodeJs)()?G:encodeURIComponent(G));let P;if((0,ve.isNodeJs)())P=Se.e(511).then(Se.t.bind(Se,1511,19)).then(T=>T.default.loadImage(b).then(z=>{const W=T.default.createCanvas(64,64);return W.getContext("2d").drawImage(z,0,0,64,64),new L.GOR(W)}));else{if(this.noPromise)return Z((new L.Tap).load(b));P=new Promise((T,z)=>{(new L.Tap).load(b,fe=>T(fe),void 0,()=>z())})}return P.then(Z)}}function C(I,U,k=!1){if(!I||!U)return null;let Z,ee,he;(0,ve.isStr)(U)||k?(Z=I.v7EvalColor(U+"color","black"),ee=parseInt(I.v7EvalAttr(U+"style",0)),he=parseInt(I.v7EvalAttr(U+"width",1))):(Z=I.getColor(U.fLineColor),ee=U.fLineStyle,he=U.fLineWidth);const G=ee?(0,Ye.Ov)(ee):"",b=G?G.split(","):[],P=b&&b.length>=2?new L.Fvt({color:Z,dashSize:parseInt(b[0]),gapSize:parseInt(b[1])}):new L.mrM({color:Z});return he&&he>1&&(P.linewidth=he),P}},2985:(Yr,mt,Se)=>{"use strict";Se.d(mt,{$q:()=>ke,HG:()=>ue,LQ:()=>I,TZ:()=>X,d_:()=>Q,ho:()=>ve,jh:()=>C,nM:()=>E,nj:()=>F,np:()=>B,oU:()=>$,pX:()=>L,rE:()=>g,tA:()=>ot,uw:()=>me,vB:()=>A});var Ee=Se(8872),x=Se(8362);const L="TLinearGradient",ve="TRadialGradient",ke=0,ot=1;function F(U,k=255){const Z=Math.round(U*k).toString(16);return 1===Z.length?"0"+Z:Z}let J=[];function ue(){return J}function Q(U){if(U?._typename!==Ee.clTColor)return null;let k="#"+F(U.fRed)+F(U.fGreen)+F(U.fBlue);switch(void 0!==U.fAlpha&&1!==U.fAlpha&&(k+=F(U.fAlpha)),k){case"#ffffff":return"white";case"#000000":return"black";case"#ff0000":return"red";case"#00ff00":return"green";case"#0000ff":return"blue";case"#ffff00":return"yellow";case"#ff00ff":return"magenta";case"#00ffff":return"cyan"}return k}function me(U){const k=[];U||(U=ue());for(let Z=0;Z<U.length;++Z){if(!U[Z])continue;const ee=(0,x.yW)(U[Z]);ee.r=ee.g=ee.b=.299*ee.r+.587*ee.g+.114*ee.b,k[Z]=ee.hex()}return k}function X(U,k,Z){if(!U){U=[];for(let he=0;he<J.length;++he)U[he]=J[he]}if(!k)return U;let ee=k;if(k._typename&&k.arr){ee=[];for(let he=0;he<k.arr.length;++he){const G=k.arr[he];G?._typename!==L&&G?._typename!==ve?G?._typename===Ee.clTColor&&G.fNumber>=0&&G.fNumber<=1e4&&(ee[G.fNumber]=Q(G)):(ee[G.fNumber]=G,G.toString=()=>"white")}}for(let he=0;he<ee.length;++he)ee[he]&&U[he]!==ee[he]&&(U[he]=ee[he]);return Z?me(U):U}function B(U){X(J,U)}function $(U){return J[U]}function A(U){if(!U)return-1;for(let k=0;k<J.length;++k)if(J[k]===U)return k;return-1}function E(U,k){k||(k=J);const Z=k.indexOf(U);return Z>=0?Z:(k.push(U),k.length-1)}class g{constructor(k,Z){this.palette=Z?me(k):k}calcColorIndex(k,Z){const ee=this.palette.length,he=Math.floor((k+.99)*ee/(Z-1));return he>ee-1?ee-1:he}getColor(k){return this.palette[k]}getLength(){return this.palette.length}calcColor(k,Z){return this.getColor(this.calcColorIndex(k,Z))}}function v(U){const k=(P,T,z)=>(z<0&&(z+=1),z>1&&(z-=1),z<.16666666666666666?P+6*(T-P)*z:z<.5?T:z<.6666666666666666?P+(T-P)*(.6666666666666666-z)*6:P),Z=(P,T,z)=>{const W=T<.5?T*(1+z):T+z-T*z,fe=2*T-W,we=k(fe,W,P+1/3),Me=k(fe,W,P),je=k(fe,W,P-1/3);return"#"+F(we)+F(Me)+F(je)},b=[];for(let P=0;P<50;++P)b.push(Z((280-5.6*(P+1))/360,.5,1));return new g(b,U)}function C(U,k){if((U=U||Ee.settings.Palette)>0&&U<10)return function f(){const U=[];for(let k=0;k<50;++k){const Z=F((k+2)/60);U.push("#"+Z+Z+Z)}return new g(U)}();if(U<51)return v(k);U>113&&(U=57);const Z=[0,.125,.25,.375,.5,.625,.75,.875,1];let ee;switch(U){case 51:ee=[[0,9,13,17,24,32,27,25,29],[0,0,0,2,37,74,113,160,221],[28,42,59,78,98,129,154,184,221]];break;case 52:ee=[[0,32,64,96,128,160,192,224,255],[0,32,64,96,128,160,192,224,255],[0,32,64,96,128,160,192,224,255]];break;case 53:ee=[[0,45,99,156,212,230,237,234,242],[0,0,0,45,101,168,238,238,243],[0,1,1,3,9,8,11,95,230]];break;case 54:ee=[[0,22,44,68,93,124,160,192,237],[0,16,41,67,93,125,162,194,241],[97,100,99,99,93,68,44,26,74]];break;case 55:ee=[[0,5,15,35,102,196,208,199,110],[0,48,124,192,206,226,97,16,0],[99,142,198,201,90,22,13,8,2]];break;case 56:ee=[[242,234,237,230,212,156,99,45,0],[243,238,238,168,101,45,0,0,0],[230,95,11,8,9,3,1,1,0]];break;case 57:ee=[[53.091,15.096,19.89,5.916,45.951,135.1755,208.743,253.878,248.982],[42.432,91.7745,128.5455,163.6845,183.039,191.046,186.864,200.481,250.716],[134.9715,221.442,213.8175,201.807,163.8375,118.881,89.2245,50.184,13.7445]];break;case 58:ee=[[0,24,2,54,176,236,202,194,255],[0,29,92,129,117,120,176,236,255],[0,68,80,34,57,172,252,245,255]];break;case 59:ee=[[13,23,25,63,76,104,137,161,206],[95,67,37,21,0,12,35,52,79],[4,3,2,6,11,22,49,98,208]];break;case 60:ee=[[0,61,89,122,143,160,185,204,231],[0,0,0,0,14,37,72,132,235],[0,140,224,144,4,5,6,9,13]];break;case 61:ee=[[14,7,2,0,5,11,55,131,229],[105,56,26,1,42,74,131,171,229],[2,21,35,60,92,113,160,185,229]];break;case 62:ee=[[0,0,0,70,148,231,235,237,244],[0,0,0,0,0,69,67,216,244],[0,102,228,231,177,124,137,20,244]];break;case 63:ee=[[50,56,63,68,93,121,165,192,241],[66,81,91,96,111,128,155,189,241],[97,91,75,65,77,103,143,167,217]];break;case 64:ee=[[145,166,167,156,131,114,101,112,132],[158,178,179,181,163,154,144,152,159],[190,199,201,192,176,169,160,166,190]];break;case 65:ee=[[93,91,99,108,130,125,132,155,174],[126,124,128,129,131,121,119,153,173],[103,94,87,85,80,85,107,120,146]];break;case 66:ee=[[24,40,69,90,104,114,120,132,103],[29,52,94,127,150,162,159,151,101],[29,52,96,132,162,181,184,186,131]];break;case 67:ee=[[46,38,61,92,113,121,132,150,191],[46,36,40,69,110,135,131,92,34],[46,80,74,70,81,105,165,211,225]];break;case 68:ee=[[0,4,12,30,52,101,142,190,237],[0,40,86,121,140,172,187,213,240],[0,9,14,18,21,23,27,35,101]];break;case 69:ee=[[198,206,206,211,198,181,161,171,244],[103,133,150,172,178,174,163,175,244],[49,54,55,66,91,130,184,224,244]];break;case 70:ee=[[243,243,240,240,241,239,186,151,129],[0,46,99,149,194,220,183,166,147],[6,8,36,91,169,235,246,240,233]];break;case 71:ee=[[22,19,19,25,35,53,88,139,210],[0,32,69,108,135,159,183,198,215],[77,96,110,116,110,100,90,78,70]];break;case 72:ee=[[68,116,165,182,189,180,145,111,71],[37,82,135,178,204,225,221,202,147],[16,55,105,147,196,226,232,224,178]];break;case 73:ee=[[61,99,136,181,213,225,198,136,24],[149,140,96,83,132,178,190,135,22],[214,203,168,135,110,100,111,113,22]];break;case 74:ee=[[76,120,156,183,197,180,162,154,140],[34,35,42,69,102,137,164,188,197],[64,69,78,105,142,177,205,217,198]];break;case 75:ee=[[37,102,157,188,196,214,223,235,251],[37,29,25,37,67,91,132,185,251],[37,32,33,45,66,98,137,187,251]];break;case 76:ee=[[79,100,119,137,153,172,192,205,250],[63,79,93,103,115,135,167,196,250],[51,59,66,61,62,70,110,160,250]];break;case 77:ee=[[43,44,50,66,125,172,178,155,157],[63,63,85,101,138,163,122,51,39],[121,101,58,44,47,55,57,44,43]];break;case 78:ee=[[0,41,62,79,90,87,99,140,228],[0,57,81,93,85,70,71,125,228],[95,91,91,82,60,43,44,112,228]];break;case 79:ee=[[49,59,72,88,114,141,176,205,222],[78,72,66,57,59,75,106,142,173],[78,55,46,40,39,39,40,41,47]];break;case 80:ee=[[243,222,201,185,165,158,166,187,219],[94,108,132,135,125,96,68,51,61],[7,9,12,19,45,89,118,146,118]];break;case 81:ee=[[19,44,74,105,137,166,194,206,220],[19,28,40,55,82,110,159,181,220],[19,42,68,96,129,157,188,203,220]];break;case 82:ee=[[33,44,70,99,140,165,199,211,216],[38,50,76,105,140,165,191,189,167],[55,67,97,124,140,166,163,129,52]];break;case 83:ee=[[0,33,73,124,136,152,159,171,223],[0,43,92,124,134,126,121,144,223],[0,43,68,76,73,64,72,114,223]];break;case 84:ee=[[5,18,45,124,193,223,205,128,49],[48,134,207,230,193,113,28,0,7],[6,15,41,121,193,226,208,130,49]];break;case 85:ee=[[180,106,104,135,164,188,189,165,144],[72,126,154,184,198,207,205,190,179],[41,120,158,188,194,181,145,100,62]];break;case 86:ee=[[57,72,94,117,136,154,174,192,215],[0,33,68,109,140,171,192,196,209],[116,137,173,201,200,201,203,190,187]];break;case 87:ee=[[31,71,123,160,210,222,214,199,183],[40,117,171,211,231,220,190,132,65],[234,214,228,222,210,160,105,60,34]];break;case 88:ee=[[123,108,109,126,154,172,188,196,218],[184,138,130,133,154,175,188,196,218],[208,130,109,99,110,122,150,171,218]];break;case 89:ee=[[105,106,122,143,159,172,176,181,207],[252,197,194,187,174,162,153,136,125],[146,133,144,155,163,167,166,162,174]];break;case 90:ee=[[171,141,145,152,154,159,163,158,177],[236,143,100,63,53,55,44,31,6],[59,48,46,44,42,54,82,112,179]];break;case 91:ee=[[180,190,209,223,204,228,205,152,91],[93,125,147,172,181,224,233,198,158],[236,218,160,133,114,132,162,220,218]];break;case 92:ee=[[225,183,162,135,115,111,119,145,211],[205,177,166,135,124,117,117,132,172],[186,165,155,135,126,130,150,178,226]];break;case 93:ee=[[39,43,59,63,80,116,153,177,223],[39,43,59,74,91,114,139,165,223],[39,50,59,70,85,115,151,176,223]];break;case 94:ee=[[0,38,60,76,84,89,101,128,204],[0,10,15,23,35,57,83,123,199],[0,11,22,40,63,86,97,94,85]];break;case 95:ee=[[94,112,141,165,167,140,91,49,27],[27,46,88,135,166,161,135,97,58],[42,52,81,106,139,158,155,137,116]];break;case 96:ee=[[30,49,79,117,135,151,146,138,147],[63,60,72,90,94,94,68,46,16],[18,28,41,56,62,63,50,36,21]];break;case 97:ee=[[0,30,63,101,143,152,169,187,230],[0,14,28,42,58,61,67,74,91],[39,26,21,18,15,14,14,13,13]];break;case 98:ee=[[149,140,164,179,182,181,131,87,61],[62,70,107,136,144,138,117,87,74],[40,38,45,49,49,49,38,32,34]];break;case 99:ee=[[99,112,148,165,179,182,183,183,208],[39,40,57,79,104,127,148,161,198],[15,16,18,33,51,79,103,129,177]];break;case 100:ee=[[99,116,154,174,200,196,201,201,230],[0,0,8,32,58,83,119,136,173],[5,6,7,9,9,14,17,19,24]];break;case 101:ee=[[82,106,126,141,155,163,142,107,66],[62,44,69,107,135,152,149,132,119],[39,25,31,60,73,68,49,72,188]];break;case 102:ee=[[18,29,44,72,116,158,184,208,221],[27,46,71,105,146,177,189,190,183],[39,55,80,108,130,133,124,100,76]];break;case 103:ee=[[0,48,119,173,212,224,228,228,245],[0,13,30,47,79,127,167,205,245],[0,68,75,43,16,22,55,128,245]];break;case 104:ee=[[34,70,129,187,225,226,216,193,179],[48,91,147,194,226,229,196,110,12],[234,212,216,224,206,110,53,40,29]];break;case 105:ee=[[30,55,103,147,174,203,188,151,105],[0,65,138,182,187,175,121,53,9],[191,202,212,208,171,140,97,57,30]];break;case 106:ee=[[112,97,113,125,138,159,178,188,225],[16,17,24,37,56,81,110,136,189],[38,35,46,59,78,103,130,152,201]];break;case 107:ee=[[18,72,5,23,29,201,200,98,29],[0,0,43,167,211,117,0,0,0],[51,203,177,26,10,9,8,3,0]];break;case 108:ee=[[19,42,64,88,118,147,175,187,205],[19,55,89,125,154,169,161,129,70],[19,32,47,70,100,128,145,130,75]];break;case 109:ee=[[33,31,42,68,86,111,141,172,227],[255,175,145,106,88,55,15,0,0],[255,205,202,203,208,205,203,206,231]];break;case 110:ee=[[0,25,50,79,110,145,181,201,254],[0,16,30,46,63,82,101,124,179],[0,12,21,29,39,49,61,74,103]];break;case 111:ee=[[0,13,30,44,72,120,156,200,247],[0,36,84,117,141,153,151,158,247],[0,94,100,82,56,66,76,131,247]];break;case 112:ee=[[26,51,43,33,28,35,74,144,246],[9,24,55,87,118,150,180,200,222],[30,96,112,114,112,101,72,35,0]];break;case 113:ee=[[0,5,65,97,124,156,189,224,255],[32,54,77,100,123,148,175,203,234],[77,110,107,111,120,119,111,94,70]];break;default:return v()}const G=ee[0],b=ee[1],P=ee[2],T=[];for(let z=1;z<Z.length;z++){const W=Math.round(Math.floor(255*Z[z])-Math.floor(255*Z[z-1]));for(let fe=0;fe<W;fe++){const we="#"+F(G[z-1]+fe*(G[z]-G[z-1])/W,1)+F(b[z-1]+fe*(b[z]-b[z-1])/W,1)+F(P[z-1]+fe*(P[z]-P[z-1])/W,1);T.push(we)}}return new g(T,k)}function I(U){const k=[],Z=U.split(";");for(let ee=0;ee<Z.length;++ee){const he=Z[ee];let G=he.indexOf(":");if(G>0){k[parseInt(he.slice(0,G))]=(0,x.yW)(`rgb(${he.slice(G+1)})`).formatHex();continue}if(G=he.indexOf("="),G>0){k[parseInt(he.slice(0,G))]=(0,x.yW)(`rgba(${he.slice(G+1)})`).formatHex8();continue}if(G=he.indexOf("#"),G<0)continue;const b=parseInt(he.slice(0,G)),P=JSON.parse(he.slice(G+1)),T={_typename:10===P[0]?L:ve,fNumber:b,fType:P[0]};let z=1;T.fCoordinateMode=Math.round(P[z++]);const W=Math.round(P[z++]);T.fColorPositions=P.slice(z,z+W),z+=W,T.fColors=P.slice(z,z+4*W),z+=4*W,T.fStart={fX:P[z++],fY:P[z++]},T.fEnd={fX:P[z++],fY:P[z++]},T._typename===ve&&z<P.length&&(T.fR1=P[z++],T.fR2=P[z++]),k[b]=T}return k}!function Y(){const U=["white","black","red","green","blue","yellow","magenta","cyan","#59d454","#5954d9","white"];U[110]="white",[{n:11,s:"c1b7ad4d4d4d6666668080809a9a9ab3b3b3cdcdcde6e6e6f3f3f3cdc8accdc8acc3c0a9bbb6a4b3a697b8a49cae9a8d9c8f83886657b1cfc885c3a48aa9a1839f8daebdc87b8f9a768a926983976e7b857d9ad280809caca6c0d4cf88dfbb88bd9f83c89a7dc08378cf5f61ac8f94a6787b946971d45a549300ff7b00ff6300ff4b00ff3300ff1b00ff0300ff0014ff002cff0044ff005cff0074ff008cff00a4ff00bcff00d4ff00ecff00fffd00ffe500ffcd00ffb500ff9d00ff8500ff6d00ff5500ff3d00ff2600ff0e0aff0022ff003aff0052ff006aff0082ff009aff00b1ff00c9ff00e1ff00f9ff00ffef00ffd700ffbf00ffa700ff8f00ff7700ff6000ff4800ff3000ff1800ff0000"},{n:201,s:"5c5c5c7b7b7bb8b8b8d7d7d78a0f0fb81414ec4848f176760f8a0f14b81448ec4876f1760f0f8a1414b84848ec7676f18a8a0fb8b814ecec48f1f1768a0f8ab814b8ec48ecf176f10f8a8a14b8b848ecec76f1f1"},{n:390,s:"ffffcdffff9acdcd9affff66cdcd669a9a66ffff33cdcd339a9a33666633ffff00cdcd009a9a00666600333300"},{n:406,s:"cdffcd9aff9a9acd9a66ff6666cd66669a6633ff3333cd33339a3333663300ff0000cd00009a00006600003300"},{n:422,s:"cdffff9affff9acdcd66ffff66cdcd669a9a33ffff33cdcd339a9a33666600ffff00cdcd009a9a006666003333"},{n:590,s:"cdcdff9a9aff9a9acd6666ff6666cd66669a3333ff3333cd33339a3333660000ff0000cd00009a000066000033"},{n:606,s:"ffcdffff9affcd9acdff66ffcd66cd9a669aff33ffcd33cd9a339a663366ff00ffcd00cd9a009a660066330033"},{n:622,s:"ffcdcdff9a9acd9a9aff6666cd66669a6666ff3333cd33339a3333663333ff0000cd00009a0000660000330000"},{n:791,s:"ffcd9acd9a669a66339a6600cd9a33ffcd66ff9a00ffcd33cd9a00ffcd00ff9a33cd66006633009a3300cd6633ff9a66ff6600ff6633cd3300ff33009aff3366cd00336600339a0066cd339aff6666ff0066ff3333cd0033ff00cdff9a9acd66669a33669a009acd33cdff669aff00cdff339acd00cdff009affcd66cd9a339a66009a6633cd9a66ffcd00ff6633ffcd00cd9a00ffcd33ff9a00cd66006633009a3333cd6666ff9a00ff9a33ff6600cd3300ff339acdff669acd33669a00339a3366cd669aff0066ff3366ff0033cd0033ff339aff0066cd00336600669a339acd66cdff009aff33cdff009acd00cdffcd9aff9a66cd66339a66009a9a33cdcd66ff9a00ffcd33ff9a00cdcd00ff9a33ff6600cd33006633009a6633cd9a66ff6600ff6633ff3300cd3300ffff339acd00666600339a0033cd3366ff669aff0066ff3366cd0033ff0033ff9acdcd669a9a33669a0066cd339aff66cdff009acd009aff33cdff009a"},{n:920,s:"cdcdcd9a9a9a666666333333"}].forEach(Z=>{const ee=Z.s;for(let he=0;he<ee.length;he+=6)U[Z.n+he/6]="#"+ee.slice(he,he+6)}),J=U}()},3147:(Yr,mt,Se)=>{"use strict";Se.d(mt,{Bm:()=>$,KA:()=>X,N7:()=>He,_o:()=>ee,cp:()=>ue,eN:()=>me,s7:()=>G,xV:()=>Ye});var Ee=Se(4882),x=Se(8872),L=Se(2843),ve=Se(4246);const ke={"#alpha":"\u03b1","#beta":"\u03b2","#chi":"\u03c7","#delta":"\u03b4","#varepsilon":"\u03b5","#phi":"\u03c6","#gamma":"\u03b3","#eta":"\u03b7","#iota":"\u03b9","#varphi":"\u03c6","#kappa":"\u03ba","#lambda":"\u03bb","#mu":"\u03bc","#nu":"\u03bd","#omicron":"\u03bf","#pi":"\u03c0","#theta":"\u03b8","#rho":"\u03c1","#sigma":"\u03c3","#tau":"\u03c4","#upsilon":"\u03c5","#varomega":"\u03d6","#omega":"\u03c9","#xi":"\u03be","#psi":"\u03c8","#zeta":"\u03b6","#Alpha":"\u0391","#Beta":"\u0392","#Chi":"\u03a7","#Delta":"\u0394","#Epsilon":"\u0395","#Phi":"\u03a6","#Gamma":"\u0393","#Eta":"\u0397","#Iota":"\u0399","#vartheta":"\u03d1","#Kappa":"\u039a","#Lambda":"\u039b","#Mu":"\u039c","#Nu":"\u039d","#Omicron":"\u039f","#Pi":"\u03a0","#Theta":"\u0398","#Rho":"\u03a1","#Sigma":"\u03a3","#Tau":"\u03a4","#Upsilon":"\u03a5","#varsigma":"\u03c2","#Omega":"\u03a9","#Xi":"\u039e","#Psi":"\u03a8","#Zeta":"\u0396","#varUpsilon":"\u03d2","#epsilon":"\u03b5","#leq":"\u2264","#/":"\u2044","#infty":"\u221e","#voidb":"\u0192","#club":"\u2663","#diamond":"\u2666","#heart":"\u2665","#spade":"\u2660","#leftrightarrow":"\u2194","#leftarrow":"\u2190","#uparrow":"\u2191","#rightarrow":"\u2192","#downarrow":"\u2193","#circ":"\u2e30","#pm":"\xb1","#doublequote":"\u2033","#geq":"\u2265","#times":"\xd7","#propto":"\u221d","#partial":"\u2202","#bullet":"\u2022","#divide":"\xf7","#neq":"\u2260","#equiv":"\u2261","#approx":"\u2248","#3dots":"\u2026","#cbar":"|","#topbar":"\xaf","#downleftarrow":"\u21b5","#aleph":"\u2135","#Jgothic":"\u2111","#Rgothic":"\u211c","#voidn":"\u2118","#otimes":"\u2297","#oplus":"\u2295","#oslash":"\u2205","#cap":"\u2229","#cup":"\u222a","#supset":"\u2283","#supseteq":"\u2287","#notsubset":"\u2284","#subset":"\u2282","#subseteq":"\u2286","#in":"\u2208","#notin":"\u2209","#angle":"\u2220","#nabla":"\u2207","#oright":"\xae","#ocopyright":"\xa9","#trademark":"\u2122","#prod":"\u220f","#surd":"\u221a","#upoint":"\u2027","#corner":"\xac","#wedge":"\u2227","#vee":"\u2228","#Leftrightarrow":"\u21d4","#Leftarrow":"\u21d0","#Uparrow":"\u21d1","#Rightarrow":"\u21d2","#Downarrow":"\u21d3","#void2":"","#LT":"<","#void1":"\xae","#copyright":"\xa9","#void3":"\u2122","#sum":"\u2211","#arctop":"\u239b","#lbar":"\u23a2","#arcbottom":"\u239d","#void4":"","#void8":"\u23a2","#bottombar":"\u230a","#arcbar":"\u23a7","#ltbar":"\u23a8","#AA":"\u212b","#aa":"\xe5","#void06":"","#GT":">","#int":"\u222b","#forall":"\u2200","#exists":"\u2203","#koppa":"\u03df","#sampi":"\u03e1","#stigma":"\u03db","#san":"\u03fb","#sho":"\u03f8","#varcoppa":"\u03d9","#digamma":"\u03dd","#Digamma":"\u03dc","#Koppa":"\u03de","#varKoppa":"\u03d8","#Sampi":"\u03e0","#Stigma":"\u03da","#San":"\u03fa","#Sho":"\u03f7","#vec":"","#dot":"\u22c5","#hat":"\xb7","#ddot":"","#acute":"","#grave":"","#check":"\u2713","#tilde":"\u02dc","#slash":"\u2044","#hbar":"\u0127","#box":"\u25fd","#Box":"\u2610","#parallel":"\u2225","#perp":"\u22a5","#odot":"\u2299","#left":"","#right":"","{}":"","#mp":"\u2213","#P":"\xb6","#sqrt":"\u221a","#bar":"","#overline":"","#underline":"","#strike":""},ot=new RegExp(Object.keys(ke).sort((P,T)=>P.length<T.length?1:P.length>T.length?-1:0).join("|"),"g"),Ye=P=>{for(;P.length>2&&"{"===P[0]&&"}"===P[P.length-1];)P=P.slice(1,P.length-1);return P.replace(ot,T=>ke[T]).replace(/\{\}/g,"")},Ze=[453,535,661,973,955,1448,1242,324,593,596,778,1011,431,570,468,492,947,885,947,947,947,947,947,947,947,947,511,495,980,1010,987,893,1624,1185,1147,1193,1216,1080,1028,1270,1274,531,910,1177,1004,1521,1252,1276,1111,1276,1164,1056,1073,1215,1159,1596,1150,1124,1065,540,591,540,837,874,572,929,972,879,973,901,569,967,973,453,458,903,453,1477,973,970,972,976,638,846,548,973,870,1285,884,864,835,656,430,656,1069],Re={945:1002,946:996,967:917,948:953,949:834,966:1149,947:847,951:989,953:516,954:951,955:913,956:1003,957:862,959:967,960:1070,952:954,961:973,963:1017,964:797,965:944,982:1354,969:1359,958:803,968:1232,950:825,913:1194,914:1153,935:1162,916:1178,917:1086,934:1358,915:1016,919:1275,921:539,977:995,922:1189,923:1170,924:1523,925:1253,927:1281,928:1281,920:1285,929:1102,931:1041,932:1069,933:1135,962:848,937:1279,926:1092,936:1334,918:1067,978:1154,8730:986,8804:940,8260:476,8734:1453,402:811,9827:1170,9830:931,9829:1067,9824:965,8596:1768,8592:1761,8593:895,8594:1761,8595:895,710:695,177:955,8243:680,8805:947,215:995,8733:1124,8706:916,8226:626,247:977,8800:969,8801:1031,8776:976,8230:1552,175:883,8629:1454,8501:1095,8465:1002,8476:1490,8472:1493,8855:1417,8853:1417,8709:1205,8745:1276,8746:1404,8839:1426,8835:1426,8836:1426,8838:1426,8834:1426,8747:480,8712:1426,8713:1426,8736:1608,8711:1551,174:1339,169:1339,8482:1469,8719:1364,729:522,172:1033,8743:1383,8744:1383,8660:1768,8656:1496,8657:1447,8658:1496,8659:1447,8721:1182,9115:882,9144:1e3,9117:882,8970:749,9127:1322,9128:1322,8491:1150,229:929,8704:1397,8707:1170,8901:524,183:519,10003:1477,732:692,295:984,9725:1780,9744:1581,8741:737,8869:1390,8857:1421};function He(P,T,z){const W=P.length,fe=(z||T.size)*T.aver_width;if(T.isMonospace())return W*fe;let we=0;for(let Me=0;Me<W;++Me){const je=P.charCodeAt(Me);we+=je>=32&&je<127?Ze[je-32]:Re[je]||1e3}return we/1e3*fe}const Ve=[{name:"#it{"},{name:"#bf{"},{name:"#underline{",deco:"underline"},{name:"#overline{",deco:"overline"},{name:"#strike{",deco:"line-through"},{name:"#kern[",arg:"float"},{name:"#lower[",arg:"float"},{name:"#scale[",arg:"float"},{name:"#color[",arg:"int"},{name:"#font[",arg:"int"},{name:"_{",low_up:"low"},{name:"^{",low_up:"up"},{name:"#bar{",deco:"overline"},{name:"#hat{",accent:"\u02c6",hasw:!0},{name:"#check{",accent:"\u02c7",hasw:!0},{name:"#acute{",accent:"\u02ca"},{name:"#grave{",accent:"\u02cb"},{name:"#dot{",accent:"\u02d9"},{name:"#ddot{",accent:"\u02ba",hasw:!0},{name:"#tilde{",accent:"\u02dc",hasw:!0},{name:"#slash{",accent:"\u2215"},{name:"#vec{",accent:"\u02ed",hasw:!0},{name:"#frac{",twolines:"line"},{name:"#splitline{",twolines:!0},{name:"#sqrt[",arg:"int",sqrt:!0},{name:"#sqrt{",sqrt:!0},{name:"#sum",special:"\u2211",w:.8,h:.9},{name:"#int",special:"\u222b",w:.3,h:1},{name:"#left[",right:"#right]",braces:"[]"},{name:"#left(",right:"#right)",braces:"()"},{name:"#left{",right:"#right}",braces:"{}"},{name:"#left|",right:"#right|",braces:"||"},{name:"#[]{",braces:"[]"},{name:"#(){",braces:"()"},{name:"#{}{",braces:"{}"},{name:"#||{",braces:"||"}],De=[0,8704,0,8707,0,0,8717,0,0,8727,0,0,8722,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8773,913,914,935,916,917,934,915,919,921,977,922,923,924,925,927,928,920,929,931,932,933,962,937,926,936,918,0,8756,0,8869,0,0,945,946,967,948,949,966,947,951,953,981,954,955,956,957,959,960,952,961,963,964,965,982,969,958,968,950,0,402,0,8764,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,978,8242,8804,8260,8734,0,9827,9830,9829,9824,8596,8592,8593,8594,8595,0,0,8243,8805,0,8733,8706,8729,0,8800,8801,8776,8230,0,0,8629,8501,8465,8476,8472,8855,8853,8709,8745,8746,8835,8839,8836,8834,8838,8712,8713,8736,8711,0,0,8482,8719,8730,8901,0,8743,8744,8660,8656,8657,8658,8659,9674,9001,0,0,8482,8721,0,0,0,0,0,0,0,0,0,0,8364,9002,8747,8992,0,8993],F=[128393,9986,9985,128083,128365,128366,128367,128383,9990,128386,128387,128234,128235,128236,128237,128193,128194,128196,128463,128464,128452,8987,128430,128432,128434,128435,128436,128427,128428,9991,9997,128398,9996,128076,128077,128078,9756,9758,9757,9759,128400,9786,128528,9785,128163,9760,127987,127985,9992,9788,128167,10052,128326,10014,128328,10016,10017,9770,9775,2384,9784,9800,9801,9802,9803,9804,9805,9806,9807,9808,9809,9810,9811,128624,128629,9679,128318,9632,9633,128912,10065,10066,11047,10731,9670,10070,11045,8999,11193,8984,127989,127990,128630,128631,0,9450,9312,9313,9314,9315,9316,9317,9318,9319,9320,9321,9471,10102,10103,10104,10105,10106,10107,10108,10109,10110,10111,128610,128608,128609,128611,128606,128604,128605,128607,183,8226,9642,9898,128902,128904,9673,9678,128319,9642,9723,128962,10022,9733,10038,10036,10041,10037,11216,8982,10209,8977,11217,10026,10032,128336,128337,128338,128339,128340,128341,128342,128343,128344,128345,128346,128347,11184,11185,11186,11187,11188,11189,11190,11191,128618,128619,128597,128596,128599,128598,128592,128593,128594,128595,9003,8998,11160,11162,11161,11163,11144,11146,11145,11147,129128,129130,129129,129131,129132,129133,129135,129134,129144,129146,129145,129147,129148,129149,129151,129150,8678,8680,8679,8681,11012,8691,11008,11009,11011,11010,129196,129197,128502,10004,128503,128505],J={};function Y(P){if(!J[945]){let T=0;for(const z in ke){const W=ke[z];if(1===W.length){let fe=0;if(T<54)fe=97+T,T>25&&(fe-=58),52===T&&(fe=161),53===T&&(fe=206);else{const Me=T-54;switch(fe=163+Me,Me){case 75:fe=197;break;case 76:fe=229;break;case 80:fe=34;break;case 81:fe=36}}const we=W.charCodeAt(0);we>128&&(J[we]=fe)}if(++T>136)break}}return J[P]??P}function ue(P){if(1!==P.childNodes.length)return!1;const T=P.textContent;if(!T)return!1;let z="",W=-1;for(let fe=0;fe<T.length;fe++){const we=T.charCodeAt(fe),Me=Y(we);we!==Me&&(z+=T.slice(W+1,fe)+'<tspan font-family="symbol" font-style="normal" font-weight="normal">'+String.fromCharCode(Me)+"</tspan>",W=fe)}return!(W<0||(W<T.length-1&&(z+=T.slice(W+1,T.length)),P.$originalHTML=P.innerHTML,P.innerHTML=z,0))}function Q(P,T){const z="Wingdings"===T?F:De;let W="";for(let fe=0;fe<P.length;++fe){const we=P.charCodeAt(fe);W+=String.fromCodePoint((we>32?z[we-33]:0)||we)}return W}function me(P,T,z){z.plain=!0,z.simple_latex&&(z.text=Ye(z.text)),T.text(z.font&&z.font.isSymbol?Q(z.text,z.font.isSymbol):z.text)}function X(P){return!P||P.indexOf("#")<0&&P.indexOf("{")<0}function B(P,T,z,W){let fe=0;const we=()=>(W.g||(W.g=P.append("svg:g")),W.g),Me=Fe=>{W.x+=Math.round(Fe)},je=(Fe,Ne,rt,St)=>{W.rect?(W.rect.x1=Math.min(W.rect.x1,Fe),W.rect.y1=Math.min(W.rect.y1,Ne),W.rect.x2=Math.max(W.rect.x2,rt),W.rect.y2=Math.max(W.rect.y2,St)):W.rect={x1:Fe,y1:Ne,x2:rt,y2:St},W.rect.last_y1=Ne,W.rect.width=W.rect.x2-W.rect.x1,W.rect.height=W.rect.y2-W.rect.y1,W.parent||(T.text_rect=W.rect)},Ge=Fe=>{je(W.x,W.y,W.x+Fe*W.fsize*.4,W.y),Me(Fe*W.fsize*.4)},lt=(Fe,Ne,rt,St)=>{Ne=Math.round(Ne),rt=Math.round(rt),(0,L.bk)(Fe.g,Ne,rt),Fe.rect.x1+=Ne,Fe.rect.x2+=Ne,Fe.rect.y1+=rt,Fe.rect.y2+=rt,St?je(W.x+Fe.rect.x1,W.y+Fe.rect.y1,W.x+Fe.rect.x2,W.y+Fe.rect.y2):je(Fe.rect.x1,Fe.rect.y1,Fe.rect.x2,Fe.rect.y2)},bt=()=>{const Fe=we();return 1!==fe||z||W.x||W.y?(0,L.bk)(Fe.append("svg:g"),W.x,W.y):Fe},te=(Fe,Ne,rt)=>{let St=0,pt=1,st=!1;Ne||(Ne="{"),rt||(rt="}");const vt=qt=>St+qt.length<=z.length&&z.slice(St,St+qt.length)===qt;if(Fe){if(!vt(Ne))return console.log(`not starting with ${Ne} in ${z}`),-1;z=z.slice(Ne.length)}for(;0!==pt&&St<z.length;)vt(Ne)?(pt++,St+=Ne.length):vt(rt)?(pt--,St+=rt.length,0===pt&&"string"==typeof Fe&&vt(Fe+Ne)&&(pt++,St+=Ne.length+Fe.length,Fe=!0,st=!0)):St++;if(0!==pt)return console.log(`mismatch with open ${Ne} and closing ${rt} in ${z}`),-1;let Yt=z.slice(0,St-rt.length);return st&&(Yt=Ne+Yt+rt),z=z.slice(St),Yt},Je=(Fe,Ne,rt)=>Fe.append("svg:path").style("stroke",rt?"none":W.color||T.color).style("stroke-width",rt?null:Math.max(1,Math.round(W.fsize*(W.font.weight?.1:.07)))).style("fill",rt?W.color||T.color:"none").attr("d",Ne??null),tt=Fe=>({lvl:W.lvl+1,x:0,y:0,fsize:W.fsize*(Fe||1),color:W.color,font:W.font,parent:W,painter:W.painter});for(;z;){let Fe=z.length,Ne=null;for(let pt=0;pt<Ve.length;++pt){const st=z.indexOf(Ve[pt].name);st>=0&&st<Fe&&(Fe=st,Ne=Ve[pt])}if(Fe>0){const pt=Fe===z.length&&0===fe&&!Ne;fe++;let st=Ye(z.slice(0,Fe)),vt=0,Yt=0;for(;vt<st.length&&" "===st[vt];)vt++;for(vt>0&&(Ge(vt),st=st.slice(vt));Yt<st.length&&" "===st[st.length-1-Yt];)Yt++;if(Yt>0&&(st=st.slice(0,st.length-Yt)),st||pt){const Ot=(W.g||(pt?P:we())).append("svg:text");pt&&!W.g&&(W.g=Ot),W.ufont&&(W.font.setPainter(T.painter),W.font.setFont(W.g)),void 0!==W.bold&&W.g.attr("font-weight",W.bold?"bold":"normal"),void 0!==W.italic&&W.g.attr("font-style",W.italic?"italic":"normal"),Ot.attr("fill",W.color||T.color||null),W.fisze!==W.font.size&&Ot.attr("font-size",Math.round(W.fsize)),Ot.text(W.font&&W.font.isSymbol?Q(st,W.font.isSymbol):st);const Bn=(0,x.isNodeJs)()||x.settings.ApproxTextSize||T.fast?{height:1.2*W.fsize,width:He(st,W.font,W.fsize)}:(0,L.xh)(Ot,"nopadding");W.x&&Ot.attr("x",W.x),W.y&&Ot.attr("y",W.y);const Mn=1===st.length&&!W.font.isMonospace()&&"lfij".indexOf(st)>=0?.1*W.fsize:0;je(W.x,W.y-.8*Bn.height,W.x+Bn.width,W.y+.2*Bn.height),pt?W.deco?(Ot.attr("text-decoration",W.deco),delete W.deco):W.xgap=Mn:(Me(Bn.width+Mn),Ge(Yt),W.xgap=0)}else Ge(Yt)}if(!Ne)return!0;if(z=z.slice(Fe+Ne.name.length),fe++,Ne.accent){const pt=te();if(-1===pt)return!1;const st=bt(),vt=tt(),Yt=1!==pt.length?1:pt>="a"&&pt<="z"&&"tdbfhkli".indexOf(pt)<0?.75:.9;B(st,T,pt,vt);const qt=.6*W.fsize,Ot=Math.round(vt.rect.y1*Yt),Bn=Math.round(.1*W.fsize),Mn=2*Bn,bn=`a${Bn},${Bn},0,0,1,${Mn},0a${Bn},${Bn},0,0,1,${-Mn},0z`;let Dn=0,$n=vt.rect.width;Ne.hasw&&$n<qt&&($n=qt,Dn=(qt-vt.rect.width)/2);const Cn=Math.round(.5*$n),yn=Math.round(.3*$n),Sn=Cn-yn,ii=Cn+yn;switch($n=2*Cn,lt(vt,Dn,0,!0),Ne.name){case"#check{":Je(st,`M${Sn},${Ot-Mn}L${Cn},${Ot}L${ii},${Ot-Mn}`);break;case"#acute{":Je(st,`M${Cn},${Ot}l${Mn},${-Mn}`);break;case"#grave{":Je(st,`M${Cn},${Ot}l${-Mn},${-Mn}`);break;case"#dot{":Je(st,`M${Cn-Bn},${Ot}${bn}`,!0);break;case"#ddot{":Je(st,`M${Cn-3*Bn},${Ot}${bn} M${Cn+Bn},${Ot}${bn}`,!0);break;case"#tilde{":Je(st,`M${Sn},${Ot} a${yn},${Mn},0,0,1,${yn},0 a${yn},${Mn},0,0,0,${yn},0`);break;case"#slash{":Je(st,`M${$n},${Ot}L0,${Math.round(vt.rect.y2)}`);break;case"#vec{":Je(st,`M${Sn},${Ot}H${ii}M${ii-Mn},${Ot-Mn}l${Mn},${Mn}l${-Mn},${Mn}`);break;default:Je(st,`M${Sn},${Ot}L${Cn},${Ot-Mn}L${ii},${Ot}`)}Me(vt.rect.width+(vt.xgap??0));continue}if(Ne.twolines){W.twolines=!0;const pt=te(),st=te(!0);if(-1===pt||-1===st)return!1;const vt=bt(),Yt=W.parent&&W.parent.twolines?.7:1,qt=tt(Yt);B(vt,T,pt,qt);const Ot="line"===Ne.twolines?Je(vt):null,Bn=tt(Yt);B(vt,T,st,Bn);const Mn=Math.max(qt.rect.width,Bn.rect.width),bn=qt.rect.width-Bn.rect.width,Dn=.35*-W.fsize;lt(qt,bn<0?-bn/2:0,Dn-qt.rect.y2,!0),lt(Bn,bn>0?bn/2:0,Dn-Bn.rect.y1,!0),Ot&&Ot.attr("d",`M0,${Math.round(Dn)}h${Math.round(Mn-.1*W.fsize)}`),Me(Mn),delete W.twolines;continue}const rt=pt=>{const st={};if(pt&&(z="{"+z,st[pt]=te("low"===pt?"_":"^"),-1===st[pt]))return!1;for(;z;)if("_"===z[0]){if(z=z.slice(1),st.low=st.low?-1:te("_"),-1===st.low)return console.log(`error with ${Ne.name} low limit`),!1}else{if("^"!==z[0])break;if(z=z.slice(1),st.up=st.up?-1:te("^"),-1===st.up)return console.log(`error with ${Ne.name} upper limit ${z}`),!1}return st};if(Ne.low_up){const pt=rt(Ne.low_up);if(!pt)return!1;const st=W.x,vt=.03*W.fsize,Yt=.25*W.fsize;let qt,Ot,Bn=0,Mn=0,bn=-W.fsize;pt.up&&(qt=tt(.6),B(we(),T,pt.up,qt)),pt.low&&(Ot=tt(.6),B(we(),T,pt.low,Ot)),qt&&(Ot||(bn=Math.min(bn,W.rect.last_y1)),lt(qt,st+vt,bn-qt.rect.y1-.1*W.fsize),Bn=qt.rect.width),Ot&&(lt(Ot,st+vt,Yt-Ot.rect.y2+.1*W.fsize),Mn=Ot.rect.width),Me(vt+Math.max(Bn,Mn));continue}if(Ne.special){const pt=rt()||{},st=bt(),vt=Je(st),Yt=Math.round(1.7*W.fsize),qt=Math.round(W.fsize),Ot=Math.round(.1*Yt);let Bn,Mn;if("#sum"===Ne.name?(Bn=Mn=qt/2,vt.attr("d",`M${qt},${Math.round(-.75*Yt)}h${-qt}l${Math.round(.4*qt)},${Math.round(.3*Yt)}l${Math.round(-.4*qt)},${Math.round(.7*Yt)}h${qt}`)):(Bn=3*Ot,Mn=Ot,vt.attr("d",`M0,${Math.round(.25*Yt-Ot)}a${Ot},${Ot},0,0,0,${2*Ot},0v${2*Ot-Yt}a${Ot},${Ot},0,1,1,${2*Ot},0`)),je(W.x,W.y-.6*Yt,W.x+qt,W.y+.4*Yt),pt.low){const bn=tt(.6);B(st,T,pt.low,bn),lt(bn,Mn-bn.rect.width/2,.25*Yt-bn.rect.y1,!0)}if(pt.up){const bn=tt(.6);B(st,T,pt.up,bn),lt(bn,Bn-bn.rect.width/2,-.75*Yt-bn.rect.y2,!0)}Me(qt);continue}if(Ne.braces){const pt=Ne.right,vt=te(!1,pt?Ne.name:"{",pt),Yt=bt(),qt=tt(),Ot=Je(Yt);B(Yt,T,vt,qt);const Bn=Je(Yt),Mn=Math.max(2,Math.round(.2*W.fsize)),bn=qt.rect,Dn=Math.round(bn.y2-bn.y1),$n=Math.round(bn.y1),Cn=Math.round(bn.width);switch(Ne.braces){case"||":Ot.attr("d",`M${Mn},${$n}v${Dn}`),Bn.attr("d",`M${3*Mn+Cn},${$n}v${Dn}`);break;case"[]":Ot.attr("d",`M${2*Mn},${$n}h${-Mn}v${Dn}h${Mn}`),Bn.attr("d",`M${2*Mn+Cn},${$n}h${Mn}v${Dn}h${-Mn}`);break;case"{}":Ot.attr("d",`M${2*Mn},${$n}a${Mn},${Mn},0,0,0,${-Mn},${Mn}v${Dn/2-2*Mn}a${Mn},${Mn},0,0,1,${-Mn},${Mn}a${Mn},${Mn},0,0,1,${Mn},${Mn}v${Dn/2-2*Mn}a${Mn},${Mn},0,0,0,${Mn},${Mn}`),Bn.attr("d",`M${2*Mn+Cn},${$n}a${Mn},${Mn},0,0,1,${Mn},${Mn}v${Dn/2-2*Mn}a${Mn},${Mn},0,0,0,${Mn},${Mn}a${Mn},${Mn},0,0,0,${-Mn},${Mn}v${Dn/2-2*Mn}a${Mn},${Mn},0,0,1,${-Mn},${Mn}`);break;default:Ot.attr("d",`M${Mn},${$n}a${4*Dn},${4*Dn},0,0,0,0,${Dn}`),Bn.attr("d",`M${3*Mn+Cn},${$n}a${4*Dn},${4*Dn},0,0,1,0,${Dn}`)}lt(qt,2*Mn,0,!0),je(W.x,W.y+bn.y1,W.x+4*Mn+bn.width,W.y+bn.y2),Me(4*Mn+bn.width);continue}if(Ne.deco){const pt=te(),st=bt(),vt=tt();vt.deco=Ne.deco,B(st,T,pt,vt);const Yt=vt.rect;if(vt.deco){const qt=Je(st),Ot=Math.round(Yt.width);switch(vt.deco){case"underline":qt.attr("d",`M0,${Math.round(Yt.y2)}h${Ot}`);break;case"overline":qt.attr("d",`M0,${Math.round(Yt.y1)}h${Ot}`);break;case"line-through":qt.attr("d",`M0,${Math.round(.45*Yt.y1+.55*Yt.y2)}h${Ot}`)}}lt(vt,0,0,!0),Me(Yt.width);continue}if("#bf{"===Ne.name||"#it{"===Ne.name){const pt=te();if(-1===pt)return!1;const st=tt();"#bf{"===Ne.name?st.bold=!st.bold:st.italic=!st.italic,B(we(),T,pt,st),lt(st,W.x,W.y),Me(st.rect.width);continue}let St=0;if(Ne.arg){const pt=z.indexOf("]{");if(pt<0)return console.log("missing argument for ",Ne.name),!1;if(St=z.slice(0,pt),"int"===Ne.arg){if(St=parseInt(St),!Number.isInteger(St))return console.log("wrong int argument",z.slice(0,pt)),!1}else if("float"===Ne.arg&&(St=parseFloat(St),!Number.isFinite(St)))return console.log("wrong float argument",z.slice(0,pt)),!1;z=z.slice(pt+2)}if("#kern["!==Ne.name&&"#lower["!==Ne.name)if("#color["!==Ne.name&&"#scale["!==Ne.name&&"#font["!==Ne.name){if(Ne.sqrt){const pt=te();if(-1===pt)return!1;const st=bt(),vt=tt();let Yt;Ne.arg&&(Yt=tt(.7),B(st,T,St.toString(),Yt));const qt=Je(st);B(st,T,pt,vt);const Ot=vt.rect,Bn=Math.round(Ot.height),Mn=Math.round(.1*Ot.height),bn=Math.round(Ot.width),Dn=Math.round((Ot.y1+Ot.y2)/2),$n=Math.round(.2*W.fsize),Cn=Math.round(Ot.y2);Yt&&lt(Yt,0,Dn-.3*Yt.fsize,!0),qt.attr("d",`M0,${Dn}h${Mn}l${Mn},${Cn-Dn-$n}l${Mn},${-Bn+$n}h${Math.round(.2*Bn+bn)}v${Mn}`),lt(vt,.4*Bn,0,!0),je(W.x,W.y+Ot.y1-.1*W.fsize,W.x+bn+.6*Bn,W.y+Ot.y2),Me(bn+.6*Bn)}}else{const pt=te();if(-1===pt)return!1;const st=tt();"#color["===Ne.name?st.color=W.painter.getColor(St):"#font["===Ne.name?(st.font=new ve.qg(St),st.ufont=!0):st.fsize*=St,B(we(),T,pt,st),lt(st,W.x,W.y),Me(st.rect.width)}else{const pt=te();if(-1===pt)return!1;const st=tt();B(we(),T,pt,st);let vt=0,Yt=0;"kern["===Ne.name?vt=St:Yt=St,lt(st,W.x+vt*st.rect.width,W.y+Yt*st.rect.height),Me(st.rect.width*(vt>0?1+St:1))}}return!0}function $(P,T,z){return B(T,z,z.text,{lvl:0,g:T,x:0,y:0,dx:0,dy:-.1,fsize:z.font_size,font:z.font,parent:null,painter:P})}let A;function E(){return g.apply(this,arguments)}function g(){return(g=(0,Ee.A)(function*(){const P=void 0!==A;if(!P&&typeof globalThis.MathJax<"u")return globalThis.MathJax;P||(A=[]);const T=new Promise(fe=>{A?A.push(fe):fe(globalThis.MathJax)});if(P)return T;const z={scale:1,minScale:.5,mtextInheritFont:!1,merrorInheritFont:!0,mathmlSpacing:!1,skipAttributes:{},exFactor:.5,displayAlign:"center",displayIndent:"0",fontCache:"local",localID:null,internalSpeechTitles:!0,titleID:0};if(!(0,x.isNodeJs)()){window.MathJax={options:{enableMenu:!1},loader:{load:["[tex]/color","[tex]/upgreek","[tex]/mathtools","[tex]/physics"]},tex:{packages:{"[+]":["color","upgreek","mathtools","physics"]}},svg:z,startup:{ready(){MathJax.startup.defaultReady();const we=A;A=void 0,we.forEach(Me=>Me(globalThis.MathJax))}}};let fe="../mathjax/3.2.0";return x.browser.webwindow&&x.source_dir.indexOf("https://root.cern/js")<0&&x.source_dir.indexOf("https://jsroot.gsi.de")<0&&(fe="mathjax"),(0,x.loadScript)(x.source_dir+fe+"/es5/tex-svg.js").catch(()=>(0,x.loadScript)("https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-svg.js")).then(()=>T)}let W;return(0,L.lf)().then(fe=>(W=fe.JSDOM,Se.e(598).then(Se.t.bind(Se,3598,19)))).then(fe=>(fe.init({loader:{load:["input/tex","output/svg","[tex]/color","[tex]/upgreek","[tex]/mathtools","[tex]/physics"]},tex:{packages:{"[+]":["color","upgreek","mathtools","physics"]}},svg:z,config:{JSDOM:W},startup:{typeset:!1,ready(){const we=MathJax;we.startup.registerConstructor("jsdomAdaptor",()=>new we._.adaptors.HTMLAdaptor.HTMLAdaptor((new we.config.config.JSDOM).window)),we.startup.useAdaptor("jsdomAdaptor",!0),we.startup.defaultReady();const Me=A;A=void 0,Me.forEach(je=>je(we))}}}),T))})).apply(this,arguments)}const v={"#LT":"\\langle","#GT":"\\rangle","#club":"\\clubsuit","#spade":"\\spadesuit","#heart":"\\heartsuit","#diamond":"\\diamondsuit","#voidn":"\\wp","#voidb":"f","#copyright":"(c)","#ocopyright":"(c)","#trademark":"TM","#void3":"TM","#oright":"R","#void1":"R","#3dots":"\\ldots","#lbar":"\\mid","#void8":"\\mid","#divide":"\\div","#Jgothic":"\\Im","#Rgothic":"\\Re","#doublequote":'"',"#plus":"+","#minus":"-","#/":"/","#upoint":".","#aa":"\\mathring{a}","#AA":"\\mathring{A}","#omicron":"o","#Alpha":"A","#Beta":"B","#Epsilon":"E","#Zeta":"Z","#Eta":"H","#Iota":"I","#Kappa":"K","#Mu":"M","#Nu":"N","#Omicron":"O","#Rho":"P","#Tau":"T","#Chi":"X","#varomega":"\\varpi","#corner":"?","#ltbar":"?","#bottombar":"?","#notsubset":"?","#arcbottom":"?","#cbar":"?","#arctop":"?","#topbar":"?","#arcbar":"?","#downleftarrow":"?","#splitline":"\\genfrac{}{}{0pt}{}","#it":"\\textit","#bf":"\\textbf","#frac":"\\frac","#left{":"\\lbrace","#right}":"\\rbrace","#left\\[":"\\lbrack","#right\\]":"\\rbrack","#\\[\\]{":"\\lbrack"," } ":"\\rbrack","#\\[":"\\lbrack","#\\]":"\\rbrack","#{":"\\lbrace","#}":"\\rbrace"," ":"\\;"},f={upDelta:"Updelta",upGamma:"Upgamma",upLambda:"Uplambda",upOmega:"Upomega",upPhi:"Upphi",upPi:"Uppi",upPsi:"Uppsi",upSigma:"Upsigma",upTheta:"Uptheta",upUpsilon:"Upupsilon",upXi:"Upxi",notcong:"ncong",notgeq:"ngeq",notgr:"ngtr",notless:"nless",notleq:"nleq",notsucc:"nsucc",notprec:"nprec",notsubseteq:"nsubseteq",notsupseteq:"nsupseteq",openclubsuit:"clubsuit",openspadesuit:"spadesuit",dasharrow:"dashrightarrow",comp:"circ",iiintop:"iiint",iintop:"iint",ointop:"oint"},C={Digamma:988,upDigamma:988,digamma:989,updigamma:989,Koppa:990,koppa:991,upkoppa:991,upKoppa:990,VarKoppa:984,upVarKoppa:984,varkoppa:985,upvarkoppa:985,varkappa:954,upvarkappa:954,varbeta:976,upvarbeta:976,Sampi:992,upSampi:992,sampi:993,upsampi:993,Stigma:986,upStigma:986,stigma:987,upstigma:987,San:1018,upSan:1018,san:1019,upsan:1019,Sho:1015,upSho:1015,sho:1016,upsho:1016,P:182,aa:176,bulletdashcirc:8887,circdashbullet:8886,downuparrows:8693,updownarrows:8645,dashdownarrow:8675,dashuparrow:8673,complement:8705,dbar:396,ddddot:8943,dddot:8943,ddots:8945,defineequal:8797,defineeq:8797,downdownharpoons:10597,downupharpoons:10607,updownharpoons:10606,upupharpoons:10595,hateq:8793,ldbrack:10214,rdbrack:10215,leadsfrom:8604,leftsquigarrow:8668,lightning:9735,napprox:8777,nasymp:8813,nequiv:8802,nsimeq:8772,nsubseteq:8840,nsubset:8836,notapprox:8777,notasymp:8813,notequiv:8802,notni:8716,notsimeq:8772,notsubseteq:8840,notsubset:8836,notsupseteq:8841,notsupset:8837,nsupset:8837,setdif:8726,simarrow:10610,t:8256,u:711,v:711,undercurvearrowright:10555,updbar:396,wwbar:8213,awointop:8754,awoint:8755,barintop:10780,barint:10779,cwintop:8753,cwint:8753,cwointop:8755,cwoint:8754,oiiintop:8752,oiiint:8752,oiintop:8751,oiint:8751,slashintop:10767,slashint:10767},I=['"',"'","`","=","~"];function Z(P,T,z,W,fe,we){let Me=parseInt(z.attr("width")),je=parseInt(z.attr("height"));if(Number.isInteger(je)&&Number.isInteger(Me))we>0&&(Me/=we,je/=we,z.attr("width",Math.round(Me)).attr("height",Math.round(je)));else{const Je=(0,L.xh)(T,"bbox");Me=Je.width||Me||100,je=Je.height||je||10}we>0&&W.valign&&(W.valign=W.valign/we),null===W.valign&&(W.valign=(fe-je)/2);const Ge={x:1,y:1};let lt="x",bt="y";180===W.rotate?Ge.x=Ge.y=-1:(270===W.rotate||90===W.rotate)&&(Ge.x=270===W.rotate?-1:1,Ge.y=-Ge.x,lt="y",bt="x"),"middle"===W.align[0]?W[lt]+=Ge.x*(W.width-Me)/2:"end"===W.align[0]&&(W[lt]+=Ge.x*(W.width-Me)),"middle"===W.align[1]?W[bt]+=Ge.y*(W.height-je)/2:"bottom"===W.align[1]?W[bt]+=Ge.y*(W.height-je):"bottom-base"===W.align[1]&&(W[bt]+=Ge.y*(W.height-je-W.valign));let te=(0,L.bk)(W.x,W.y)||"";W.rotate&&(te&&(te+=" "),te+=`rotate(${W.rotate})`),T.attr("transform",te||null).attr("visibility",null)}function ee(P,T,z){return he.apply(this,arguments)}function he(){return(he=(0,Ee.A)(function*(P,T,z){const W=function U(P,T,z,W){if(2!==T){for(const Me in v)P=P.replace(new RegExp(Me,"g"),v[Me]);for(const Me in ke)Me.length>2&&(P=P.replace(new RegExp(Me,"g"),"\\"+Me.slice(1)));let fe="",we=!0;for(;P;){let Me=P.indexOf("#color[");if(Me<0&&we){fe=P;break}if(we=!1,0!==Me&&(fe+=Me<0?P:P.slice(0,Me),Me<0))break;if(Me=(P=P.slice(Me+7)).indexOf("]{"),Me<=0)break;const je=parseInt(P.slice(0,Me));if(!Number.isInteger(je))break;const Ge=W.getColor(je);let lt=1;for(P=P.slice(Me+2),Me=-1;lt&&++Me<P.length;)"{"===P[Me]?lt++:"}"===P[Me]&&lt--;if(0!==lt)break;const bt=P.slice(0,Me);P=P.slice(Me+1),bt&&(fe+=`\\color{${Ge}}{${bt}}`)}P=fe}else{"\\^"===P&&(P="\\unicode{0x5E}"),"\\vec"===P&&(P="\\unicode{0x2192}"),P=P.replace(/\\\./g,"\\unicode{0x2E}").replace(/\\\^/g,"\\hat");for(const fe in C)P=P.replace(new RegExp(`\\\\\\b${fe}\\b`,"g"),`\\unicode{0x${C[fe].toString(16)}}`);I.forEach(fe=>{P=P.replace(new RegExp(`(\\\\${fe})`,"g"),`\\unicode{0x${fe.charCodeAt(0).toString(16)}}`)});for(const fe in f)P=P.replace(new RegExp(`\\\\\\b${fe}\\b`,"g"),`\\${f[fe]}`)}return(0,x.isStr)(z)?`\\color{${z}}{${P}}`:P}(z.text,z.latex,z.color,P),fe={em:z.font.size,ex:z.font.size/2,family:z.font.name,scale:1,containerWidth:-1,lineWidth:1e5};return E().then(we=>we.tex2svgPromise(W,fe)).then(we=>{const Me=we.querySelector("svg");return T.append(()=>Me),function k(P,T,z,W){const fe=Ge=>{if(!Ge||!(0,x.isStr)(Ge)||Ge.length<3)return null;const lt=Ge.indexOf("ex");return lt<0||lt!==Ge.length-2?null:(Ge=parseFloat(Ge.slice(0,lt)),Number.isFinite(Ge)?Ge*W.font.size*.5:null)};let we=fe(z.getAttribute("width")),Me=fe(z.getAttribute("height")),je=z.getAttribute("style");if(je&&je.length>18&&0===je.indexOf("vertical-align:")){const Ge=je.indexOf("ex;");je=Ge>0&&Ge===je.length-3?fe(je.slice(16,je.length-1)):null}else je=null;if(we=!we||we<=.5?1:Math.round(we),Me=!Me||Me<=.5?1:Math.round(Me),z.setAttribute("width",we),z.setAttribute("height",Me),z.removeAttribute("style"),!(0,x.isNodeJs)()){const Ge=(0,L.xh)(T,"bbox");we=1.05*Ge.width,Me=1.05*Ge.height}W.valign=je,W.scale&&P.scaleTextDrawing(Math.max(we/W.width,Me/W.height),W.draw_g)}(P,T,Me,z),z.applyAttributesToMathJax=Z,!0})})).apply(this,arguments)}function G(P){return b.apply(this,arguments)}function b(){return(b=(0,Ee.A)(function*(P){return E().then(T=>T.typesetPromise(P?[P]:void 0))})).apply(this,arguments)}},6983:(Yr,mt,Se)=>{"use strict";Se.r(mt),Se.d(mt,{Beta:()=>Sn,BetaDist:()=>Bs,BetaDistI:()=>yo,BetaIncomplete:()=>Me,BreitWigner:()=>yn,Chebyshev0:()=>In,Chebyshev1:()=>ci,Chebyshev10:()=>D,Chebyshev2:()=>Pi,Chebyshev3:()=>Si,Chebyshev4:()=>bi,Chebyshev5:()=>Jn,Chebyshev6:()=>Wi,Chebyshev7:()=>Ln,Chebyshev8:()=>Rs,Chebyshev9:()=>oe,ChebyshevN:()=>dn,FDist:()=>Mn,FDistI:()=>Dn,Gamma:()=>$,GammaDist:()=>ii,Gaus:()=>Cn,InvPi:()=>Ut,Landau:()=>U,LaplaceDist:()=>ai,LaplaceDistI:()=>Hi,LogNormal:()=>ss,Pi:()=>sn,PiOver2:()=>xn,PiOver4:()=>wn,Polynomial1eval:()=>He,Polynomialeval:()=>Re,Prob:()=>$n,Sq:()=>yt,Student:()=>ti,StudentI:()=>Nr,TwoPi:()=>tn,beta:()=>G,beta_cdf_c:()=>Ge,beta_pdf:()=>he,beta_quantile:()=>je,breitwigner_cdf:()=>tt,breitwigner_cdf_c:()=>Je,cauchy_cdf:()=>Ne,cauchy_cdf_c:()=>Fe,cauchy_pdf:()=>rt,chisquared_cdf:()=>lt,chisquared_cdf_c:()=>b,chisquared_pdf:()=>Bn,crystalball_cdf:()=>hn,crystalball_cdf_c:()=>kn,crystalball_function:()=>Vt,crystalball_pdf:()=>Nt,erf:()=>J,erfc:()=>F,expo:()=>ye,exponential_cdf:()=>Ot,exponential_cdf_c:()=>qt,fdistribution_cdf:()=>Dn,fdistribution_cdf_c:()=>bn,fdistribution_pdf:()=>Mn,gamma:()=>$,gamma_pdf:()=>pt,gamma_quantile:()=>te,gamma_quantile_c:()=>bt,gaus:()=>xt,gausn:()=>K,gaussian_cdf:()=>me,gaussian_cdf_c:()=>Q,gaussian_pdf:()=>St,gausxy:()=>ge,getTEfficiencyBoundaryFunc:()=>it,igam:()=>f,igamc:()=>v,igami:()=>C,inc_beta:()=>we,inc_gamma:()=>Z,inc_gamma_c:()=>k,incbet:()=>W,incbi:()=>fe,landau:()=>Pe,landau_pdf:()=>I,landaun:()=>At,lgam:()=>Ve,lgamma:()=>ee,lognormal_cdf:()=>ue,lognormal_cdf_c:()=>Y,lognormal_pdf:()=>X,ndtri:()=>A,normal_cdf:()=>me,normal_cdf_c:()=>Q,normal_pdf:()=>B,normal_quantile:()=>E,normal_quantile_c:()=>g,pseries:()=>z,stirf:()=>De,tdistribution_cdf:()=>vt,tdistribution_cdf_c:()=>st,tdistribution_pdf:()=>Yt,tgamma:()=>$});const Ee=11102230246251565e-32,x=-708.3964185322641,L=709.782712893384,ve=108.11685576785767,ke=4503599627370496,ot=2220446049250313e-31,Ye=1.4142135623730951,Ze=3.141592653589793;function Re(Qe,nt,at){if(!at)return nt[0];let ht=nt[0];for(let Qt=1;Qt<=at;++Qt)ht=ht*Qe+nt[Qt];return ht}function He(Qe,nt,at){if(!at)return nt[0];let ht=Qe+nt[0];for(let Qt=1;Qt<at;++Qt)ht=ht*Qe+nt[Qt];return ht}function Ve(Qe){let nt,at,ht,Qt,vn;const Gn=[-1378.2515256912086,-38801.631513463784,-331612.9927388712,-1162370.974927623,-1721737.0082083966,-853555.6642457654],qn=[-351.81570143652345,-17064.210665188115,-220528.59055385445,-1139334.4436798252,-2532523.0717758294,-2018891.4143353277];if(Qe>=Number.MAX_VALUE||Qe==Number.POSITIVE_INFINITY)return Number.POSITIVE_INFINITY;if(Qe<-34)return at=-Qe,Qt=Ve(at),nt=Math.floor(at),nt===at||(vn=at-nt,vn>.5&&(nt+=1,vn=nt-at),vn=at*Math.sin(Math.PI*vn),vn<1e-300)?Number.POSITIVE_INFINITY:(vn=Math.log(Math.PI)-Math.log(vn)-Qt,vn);if(Qe<13){for(vn=1,nt=0,ht=Qe;ht>=3;)nt-=1,ht=Qe+nt,vn*=ht;for(;ht<2;){if(ht<1e-300)return Number.POSITIVE_INFINITY;vn/=ht,nt+=1,ht=Qe+nt}return vn<0&&(vn=-vn),2===ht?Math.log(vn):(nt-=2,nt=(Qe+=nt)*Re(Qe,Gn,5)/He(Qe,qn,6),Math.log(vn)+nt)}return Qe>2556348e299?Number.POSITIVE_INFINITY:(at=(Qe-.5)*Math.log(Qe)-Qe+.9189385332046728,Qe>1e8||(nt=1/(Qe*Qe),at+=Qe>=1e3?((.0007936507936507937*nt-.002777777777777778)*nt+.08333333333333333)/Qe:Re(nt,[.0008116141674705085,-.0005950619042843014,.0007936503404577169,-.002777777777300997,.08333333333333319],4)/Qe),at)}function De(Qe){let nt,at,ht;const vn=Math.sqrt(2*Math.PI);return at=1/Qe,at=1+at*Re(at,[.0007873113957930937,-.00022954996161337813,-.0026813261780578124,.0034722222160545866,.08333333333334822],4),nt=Math.exp(Qe),Qe>ve?(ht=Math.pow(Qe,.5*Qe-.25),nt=ht*(ht/nt)):nt=Math.pow(Qe,Qe-.5)/nt,nt=vn*nt*at,nt}function F(Qe){let vn,en,jt,fn,Gn;return jt=Qe<0?-Qe:Qe,jt<1?1-J(Qe):(Gn=-Qe*Qe,Gn<-L||(Gn=Math.exp(Gn),jt<8?(vn=Re(jt,[2.461969814735305e-10,.5641895648310689,7.463210564422699,48.63719709856814,196.5208329560771,526.4451949954773,934.5285271719576,1027.5518868951572,557.5353353693994],8),en=He(jt,[13.228195115474499,86.70721408859897,354.9377788878199,975.7085017432055,1823.9091668790973,2246.3376081871097,1656.6630919416134,557.5353408177277],8)):(vn=Re(jt,[.5641895835477551,1.275366707599781,5.019050422511805,6.160210979930536,7.4097426995044895,2.9788666537210022],5),en=He(jt,[2.2605286322011726,9.396035249380015,12.048953980809666,17.08144507475659,9.608968090632859,3.369076451000815],6)),fn=Gn*vn/en,Qe<0&&(fn=2-fn),0==fn)?Qe<0?2:0:fn)}function J(Qe){if(Math.abs(Qe)>1)return 1-F(Qe);const ht=Qe*Qe;return Qe*Re(ht,[9.604973739870516,90.02601972038427,2232.005345946843,7003.325141128051,55592.30130103949],4)/He(ht,[33.56171416475031,521.3579497801527,4594.323829709801,22629.000061389095,49267.39426086359],5)}function Y(Qe,nt,at,ht){void 0===ht&&(ht=0);const Qt=(Math.log(Qe-ht)-nt)/(at*Ye);return Qt>1?.5*F(Qt):.5*(1-J(Qt))}function ue(Qe,nt,at,ht=0){const Qt=(Math.log(Qe-ht)-nt)/(at*Ye);return Qt<-1?.5*F(-Qt):.5*(1+J(Qt))}function Q(Qe,nt,at=0){const ht=(Qe-at)/(nt*Ye);return ht>1?.5*F(ht):.5*(1-J(ht))}function me(Qe,nt,at=0){const ht=(Qe-at)/(nt*Ye);return ht<-1?.5*F(-ht):.5*(1+J(ht))}function X(Qe,nt,at,ht=0){if(Qe-ht<=0)return 0;const Qt=(Math.log(Qe-ht)-nt)/at;return 1/((Qe-ht)*Math.abs(at)*Math.sqrt(2*Ze))*Math.exp(-Qt*Qt/2)}function B(Qe,nt=1,at=0){const ht=(Qe-at)/nt;return 1/(Math.sqrt(2*Ze)*Math.abs(nt))*Math.exp(-ht*ht/2)}function $(Qe){let nt,at,ht,Qt,vn=1;if(Qe>=Number.MAX_VALUE)return Qe;if(at=Math.abs(Qe),at>33){if(Qe<0){if(nt=Math.floor(at),nt==at)return Number.POSITIVE_INFINITY;if(Qt=Math.round(nt),1&Qt||(vn=-1),ht=at-nt,ht>.5&&(nt+=1,ht=at-nt),ht=at*Math.sin(Math.PI*ht),0==ht)return vn>0?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;ht=Math.abs(ht),ht=Math.PI/(ht*De(at))}else ht=De(Qe);return vn*ht}for(ht=1;Qe>=3;)ht*=Qe-=1;let en=!1;for(;Qe<0&&!en;)Qe>-1e-9?en=!0:(ht/=Qe,Qe+=1);for(;Qe<2&&!en;)Qe<1e-9?en=!0:(ht/=Qe,Qe+=1);return en?0==Qe?Number.POSITIVE_INFINITY:ht/((1+.5772156649015329*Qe)*Qe):2==Qe?ht:(nt=Re(Qe-=2,[.00016011952247675185,.0011913514700658638,.010421379756176158,.04763678004571372,.20744822764843598,.4942148268014971,1],6),at=Re(Qe,[-23158187332412014e-21,.0005396055804933034,-.004456419138517973,.011813978522206043,.035823639860549865,-.23459179571824335,.0714304917030273,1],7),ht*nt/at)}function A(Qe){if(Qe<=0)return Number.NEGATIVE_INFINITY;if(Qe>=1)return Number.POSITIVE_INFINITY;const fn=.1353352832366127;let Vi,_r,Ni,Gn=1,qn=Qe;if(qn>1-fn&&(qn=1-qn,Gn=0),qn>fn)return qn-=.5,_r=qn*qn,Vi=qn+qn*(_r*Re(_r,[-59.96335010141079,98.00107541859997,-56.67628574690703,13.931260938727968,-1.2391658386738125],4)/He(_r,[1.9544885833814176,4.676279128988815,86.36024213908905,-225.46268785411937,200.26021238006066,-82.03722561683334,15.90562251262117,-1.1833162112133],8)),Vi*=2.5066282746310007,Vi;Vi=Math.sqrt(-2*Math.log(qn));const Kr=Vi-Math.log(Vi)/Vi,os=1/Vi;return Ni=Vi<8?os*Re(os,[4.0554489230596245,31.525109459989388,57.16281922464213,44.08050738932008,14.684956192885803,2.1866330685079025,-.1402560791713545,-.03504246268278482,-.0008574567851546854],8)/He(os,[15.779988325646675,45.39076351288792,41.3172038254672,15.04253856929075,2.504649462083094,-.14218292285478779,-.03808064076915783,-.0009332594808954574],8):os*Re(os,[3.2377489177694603,6.915228890689842,3.9388102529247444,1.3330346081580755,.20148538954917908,.012371663481782003,.00030158155350823543,26580697468673755e-22,6.239745391849833e-9],8)/He(os,[6.02427039364742,3.6798356385616087,1.3770209948908132,.21623699359449663,.013420400608854318,.00032801446468212774,28924786474538068e-22,6.790194080099813e-9],8),Vi=Kr-Ni,0!=Gn&&(Vi=-Vi),Vi}function E(Qe,nt){return nt*A(Qe)}function g(Qe,nt){return-nt*A(Qe)}function v(Qe,nt){if(Qe<=0)return 0;if(nt<=0)return 1;if(nt<1||nt<Qe)return 1-f(Qe,nt);let at=Qe*Math.log(nt)-nt-Ve(Qe);if(at<-L)return 0;at=Math.exp(at);let Vi,_r,Ni,Kr,os,ht=1-Qe,Qt=nt+ht+1,vn=0,en=1,jt=nt,fn=nt+1,Gn=Qt*nt,qn=fn/Gn;do{vn+=1,ht+=1,Qt+=2,Vi=ht*vn,Kr=fn*Qt-en*Vi,os=Gn*Qt-jt*Vi,os?(_r=Kr/os,Ni=Math.abs((qn-_r)/_r),qn=_r):Ni=1,en=fn,fn=Kr,jt=Gn,Gn=os,Math.abs(Kr)>ke&&(en*=ot,fn*=ot,jt*=ot,Gn*=ot)}while(Ni>Ee);return qn*at}function f(Qe,nt){if(Qe<=0)return 1;if(nt<=0)return 0;if(nt>1&&nt>Qe)return 1-v(Qe,nt);let at=Qe*Math.log(nt)-nt-Ve(Qe);if(at<-L)return 0;at=Math.exp(at);let ht=Qe,Qt=1,vn=1;do{ht+=1,Qt*=nt/ht,vn+=Qt}while(Qt/vn>Ee);return vn*at/Qe}function C(Qe,nt){if(Qe<=0)return console.error(`igami : Wrong domain for parameter a = ${Qe} (must be > 0)`),0;if(nt<=0)return Number.POSITIVE_INFINITY;if(nt>=1)return 0;const at=Number.MAX_VALUE,ht=5*Ee;let en,Gn,qn,Vi,_r,Ni,Qt=at,vn=0,jt=0,fn=1;for(qn=1/(9*Qe),Gn=1-qn-A(nt)*Math.sqrt(qn),en=Qe*Gn*Gn*Gn,Vi=Ve(Qe),_r=0;_r<10&&!(en>Qt||en<vn||(Gn=v(Qe,en),Gn<jt||Gn>fn)||(Gn<nt?(Qt=en,jt=Gn):(vn=en,fn=Gn),qn=(Qe-1)*Math.log(en)-en-Vi,qn<-L));++_r){if(qn=-Math.exp(qn),qn=(Gn-nt)/qn,Math.abs(qn/en)<Ee)return en;en-=qn}if(qn=.0625,Qt==at)for(en<=0&&(en=1);Qt==at;){if(en*=1+qn,Gn=v(Qe,en),Gn<nt){Qt=en,jt=Gn;break}qn+=qn}for(qn=.5,Ni=0,_r=0;_r<400&&(en=vn+qn*(Qt-vn),Gn=v(Qe,en),Vi=(Qt-vn)/(vn+Qt),!(Math.abs(Vi)<ht||(Vi=(Gn-nt)/nt,Math.abs(Vi)<ht)||en<=0));++_r)Gn>=nt?(vn=en,fn=Gn,Ni<0?(Ni=0,qn=.5):qn=Ni>1?.5*qn+.5:(nt-jt)/(fn-jt),Ni+=1):(Qt=en,jt=Gn,Ni>0?(Ni=0,qn=.5):Ni<-1?qn*=.5:qn=(nt-jt)/(fn-jt),Ni-=1);return en}function I(Qe,nt,at=0){if(nt<=0)return 0;const ht=(Qe-at)/nt;let Qt,vn,en,jt;const fn=[.4259894875,-.124976255,.039842437,-.006298287635,.001511162253],Gn=[1,-.3388260629,.09594393323,-.01608042283,.003778942063],qn=[.1788541609,.1173957403,.01488850518,-.001394989411,.0001283617211],Vi=[1,.7428795082,.3153932961,.06694219548,.008790609714],_r=[.1788544503,.09359161662,.006325387654,6611667319e-14,-2031049101e-15],Ni=[1,.6097809921,.2560616665,.04746722384,.006957301675],Kr=[.9874054407,118.6723273,849.279436,-743.7792444,427.0262186],os=[1,106.8615961,337.6496214,2016.712389,1597.063511],ia=[1.003675074,167.5702434,4789.711289,21217.86767,-22324.9491],Vs=[1,156.9424537,3745.310488,9834.698876,66924.28357],un=[1.000827619,664.9143136,62972.92665,475554.6998,-5743609.109],di=[1,651.4101098,56974.73333,165917.4725,-2815759.939],Rt=[.04166666667,-.01996527778,.02709538966],ui=[-1.84556867,-4.284640743];if(ht<-5.5){if(Qt=Math.exp(ht+1),Qt<1e-10)return 0;vn=Math.exp(-1/Qt),en=Math.sqrt(Qt),jt=vn/en*.3989422803*(1+(Rt[0]+(Rt[1]+Rt[2]*Qt)*Qt)*Qt)}else ht<-1?(Qt=Math.exp(-ht-1),jt=Math.exp(-Qt)*Math.sqrt(Qt)*(fn[0]+(fn[1]+(fn[2]+(fn[3]+fn[4]*ht)*ht)*ht)*ht)/(Gn[0]+(Gn[1]+(Gn[2]+(Gn[3]+Gn[4]*ht)*ht)*ht)*ht)):ht<1?jt=(qn[0]+(qn[1]+(qn[2]+(qn[3]+qn[4]*ht)*ht)*ht)*ht)/(Vi[0]+(Vi[1]+(Vi[2]+(Vi[3]+Vi[4]*ht)*ht)*ht)*ht):ht<5?jt=(_r[0]+(_r[1]+(_r[2]+(_r[3]+_r[4]*ht)*ht)*ht)*ht)/(Ni[0]+(Ni[1]+(Ni[2]+(Ni[3]+Ni[4]*ht)*ht)*ht)*ht):ht<12?(Qt=1/ht,jt=Qt*Qt*(Kr[0]+(Kr[1]+(Kr[2]+(Kr[3]+Kr[4]*Qt)*Qt)*Qt)*Qt)/(os[0]+(os[1]+(os[2]+(os[3]+os[4]*Qt)*Qt)*Qt)*Qt)):ht<50?(Qt=1/ht,jt=Qt*Qt*(ia[0]+(ia[1]+(ia[2]+(ia[3]+ia[4]*Qt)*Qt)*Qt)*Qt)/(Vs[0]+(Vs[1]+(Vs[2]+(Vs[3]+Vs[4]*Qt)*Qt)*Qt)*Qt)):ht<300?(Qt=1/ht,jt=Qt*Qt*(un[0]+(un[1]+(un[2]+(un[3]+un[4]*Qt)*Qt)*Qt)*Qt)/(di[0]+(di[1]+(di[2]+(di[3]+di[4]*Qt)*Qt)*Qt)*Qt)):(Qt=1/(ht-ht*Math.log(ht)/(ht+1)),jt=Qt*Qt*(1+(ui[0]+ui[1]*Qt)*Qt));return jt/nt}function U(Qe,nt,at,ht){if(at<=0)return 0;const Qt=I((Qe-nt)/at,1,0);return ht?Qt/at:Qt}function k(Qe,nt){return v(Qe,nt)}function Z(Qe,nt){return f(Qe,nt)}function ee(Qe){return Ve(Qe)}function he(Qe,nt,at){if(Qe<0||Qe>1)return 0;if(0==Qe){if(nt<1)return Number.POSITIVE_INFINITY;if(nt>1)return 0;if(1==nt)return at}if(1==Qe){if(at<1)return Number.POSITIVE_INFINITY;if(at>1)return 0;if(1==at)return nt}return Math.exp(ee(nt+at)-ee(nt)-ee(at)+Math.log(Qe)*(nt-1)+Math.log1p(-Qe)*(at-1))}function G(Qe,nt){return Math.exp(ee(Qe)+ee(nt)-ee(Qe+nt))}function b(Qe,nt,at=0){return k(.5*nt,.5*(Qe-at))}function z(Qe,nt,at){let ht,Qt,vn,en,jt;const fn=1/Qe;vn=(1-nt)*at,en=vn/(Qe+1);const Gn=en;Qt=vn,jt=2,ht=0;const qn=Ee*fn;for(;Math.abs(en)>qn;)vn=(jt-nt)*at/jt,Qt*=vn,en=Qt/(Qe+jt),ht+=en,jt+=1;return ht+=Gn,ht+=fn,vn=Qe*Math.log(at),Qe+nt<ve&&Math.abs(vn)<L?(Qt=$(Qe+nt)/($(Qe)*$(nt)),ht=ht*Qt*Math.pow(at,Qe)):(Qt=Ve(Qe+nt)-Ve(Qe)-Ve(nt)+vn+Math.log(ht),ht=Qt<x?0:Math.exp(Qt)),ht}function W(Qe,nt,at){let ht,Qt,vn,en,jt,fn,Gn,qn;return Qe<=0||nt<=0||at<=0?0:at>=1?1:(qn=0,fn=1-at,at>Qe/(Qe+nt)?(qn=1,ht=nt,Qt=Qe,jt=at,en=fn):(ht=Qe,Qt=nt,jt=fn,en=at),1==qn&&Qt*en<=1&&en<=.95?vn=z(ht,Qt,en):(Gn=en*(ht+Qt-2)-(ht-1),fn=Gn<0?function P(Qe,nt,at){let ht,Qt,vn,en,jt,fn,Gn,qn,Vi,_r,Ni,Kr,os,ia,Vs,un,di,Rt,ui;const Pn=3*Ee;qn=Qe,Vi=Qe+nt,_r=Qe,Ni=Qe+1,Kr=1,os=nt-1,ia=Ni,Vs=Qe+2,en=0,Gn=1,vn=1,fn=1,Rt=1,un=1,ui=0;do{if(ht=-at*qn*Vi/(_r*Ni),Qt=vn+en*ht,jt=fn+Gn*ht,en=vn,vn=Qt,Gn=fn,fn=jt,ht=at*Kr*os/(ia*Vs),Qt=vn+en*ht,jt=fn+Gn*ht,en=vn,vn=Qt,Gn=fn,fn=jt,0!=jt&&(un=Qt/jt),0!=un?(di=Math.abs((Rt-un)/un),Rt=un):di=1,di<Pn)break;qn+=1,Vi+=1,_r+=2,Ni+=2,Kr+=1,os-=1,ia+=2,Vs+=2,Math.abs(jt)+Math.abs(Qt)>ke&&(en*=ot,vn*=ot,Gn*=ot,fn*=ot),(Math.abs(jt)<ot||Math.abs(Qt)<ot)&&(en*=ke,vn*=ke,Gn*=ke,fn*=ke)}while(++ui<300);return Rt}(ht,Qt,en):function T(Qe,nt,at){const ht=at/(1-at),Qt=3*Ee;let vn,en,jt,fn,Gn,qn,Vi,_r,Ni,Kr,os,ia,Vs,un,di,Rt,ui,Pn,Fn;_r=Qe,Ni=nt-1,Kr=Qe,os=Qe+1,ia=1,Vs=Qe+nt,un=Qe+1,di=Qe+2,fn=0,Vi=1,jt=1,qn=1,Pn=1,Rt=1,Fn=0;do{if(vn=-ht*_r*Ni/(Kr*os),en=jt+fn*vn,Gn=qn+Vi*vn,fn=jt,jt=en,Vi=qn,qn=Gn,vn=ht*ia*Vs/(un*di),en=jt+fn*vn,Gn=qn+Vi*vn,fn=jt,jt=en,Vi=qn,qn=Gn,0!=Gn&&(Rt=en/Gn),0!=Rt?(ui=Math.abs((Pn-Rt)/Rt),Pn=Rt):ui=1,ui<Qt)break;_r+=1,Ni-=1,Kr+=2,os+=2,ia+=1,Vs+=1,un+=2,di+=2,Math.abs(Gn)+Math.abs(en)>ke&&(fn*=ot,jt*=ot,Vi*=ot,qn*=ot),(Math.abs(Gn)<ot||Math.abs(en)<ot)&&(fn*=ke,jt*=ke,Vi*=ke,qn*=ke)}while(++Fn<300);return Pn}(ht,Qt,en)/jt,Gn=ht*Math.log(en),vn=Qt*Math.log(jt),ht+Qt<ve&&Math.abs(Gn)<L&&Math.abs(vn)<L?(vn=Math.pow(jt,Qt),vn*=Math.pow(en,ht),vn/=ht,vn*=fn,vn*=$(ht+Qt)/($(ht)*$(Qt))):(Gn+=vn+Ve(ht+Qt)-Ve(ht)-Ve(Qt),Gn+=Math.log(fn/ht),vn=Gn<x?0:Math.exp(Gn))),1==qn&&(vn=vn<=Ee?1-Ee:1-vn),vn)}function fe(Qe,nt,at){let ht,Qt,vn,en,jt,fn,Gn,qn,Vi,_r,Ni,Kr,os,ia,Vs,un,di,Rt,ui,Pn=!0;if(Qe<=0||nt<=0)return 0;const Fn=()=>(di&&(fn=fn<=Ee?1-Ee:1-fn),fn);if(un=0,at<=0)return 0;if(at>=1)return 1;if(Gn=0,os=0,qn=1,ia=1,ui=0,Qe<=1||nt<=1)Kr=1e-6,di=0,ht=Qe,Qt=nt,vn=at,fn=ht/(ht+Qt),jt=W(ht,Qt,fn);else{if(Kr=1e-4,_r=-A(at),at>.5?(di=1,ht=nt,Qt=Qe,vn=1-at,_r=-_r):(di=0,ht=Qe,Qt=nt,vn=at),Vi=(_r*_r-3)/6,fn=2/(1/(2*ht-1)+1/(2*Qt-1)),en=_r*Math.sqrt(fn+Vi)/fn-(1/(2*Qt-1)-1/(2*ht-1))*(Vi+5/6-2/(3*fn)),en*=2,en<x)return fn=0,Fn();fn=ht/(ht+Qt*Math.exp(en)),jt=W(ht,Qt,fn),_r=(jt-vn)/vn,Math.abs(_r)<.2&&(Pn=!1)}let _i=1e3;for(;_i-- >0;){if(Pn){for(Rt=0,Ni=.5,un=0;un<100;un++){if(0!=un){if(fn=Gn+Ni*(qn-Gn),1==fn&&(fn=1-Ee),0==fn&&(Ni=.5,fn=Gn+Ni*(qn-Gn),0==fn))return Fn();if(jt=W(ht,Qt,fn),_r=(qn-Gn)/(qn+Gn),Math.abs(_r)<Kr||(_r=(jt-vn)/vn,Math.abs(_r)<Kr))break}if(jt<vn){if(Gn=fn,os=jt,Rt<0?(Rt=0,Ni=.5):Ni=Rt>3?1-(1-Ni)*(1-Ni):Rt>1?.5*Ni+.5:(vn-jt)/(ia-os),Rt+=1,Gn>.75){1==di?(di=0,ht=Qe,Qt=nt,vn=at):(di=1,ht=nt,Qt=Qe,vn=1-at),fn=1-fn,jt=W(ht,Qt,fn),Gn=0,os=0,qn=1,ia=1;continue}}else{if(qn=fn,1==di&&qn<Ee)return fn=0,Fn();ia=jt,Rt>0?(Rt=0,Ni=.5):Rt<-3?Ni*=Ni:Rt<-1?Ni*=.5:Ni=(jt-vn)/(ia-os),Rt-=1}}if(Gn>=1)return fn=1-Ee,Fn();if(fn<=0)return fn=0,Fn();break}if(Pn=!0,ui)return Fn();for(ui=1,Vi=Ve(ht+Qt)-Ve(ht)-Ve(Qt),un=0;un<8&&(0!=un&&(jt=W(ht,Qt,fn)),jt<os?(fn=Gn,jt=os):jt>ia?(fn=qn,jt=ia):jt<vn?(Gn=fn,os=jt):(qn=fn,ia=jt),1!=fn&&0!=fn);un++){if(en=(ht-1)*Math.log(fn)+(Qt-1)*Math.log(1-fn)+Vi,en<x)return Fn();if(en>L||(en=Math.exp(en),en=(jt-vn)/en,Vs=fn-en,Vs<=Gn&&(jt=(fn-Gn)/(qn-Gn),Vs=Gn+.5*jt*(fn-Gn),Vs<=0))||Vs>=qn&&(jt=(qn-fn)/(qn-Gn),Vs=qn-.5*jt*(qn-fn),Vs>=1))break;if(fn=Vs,Math.abs(en/fn)<128*Ee)return Fn()}Kr=256*Ee}return Fn()}function we(Qe,nt,at){return W(nt,at,Qe)}const Me=we;function je(Qe,nt,at){return fe(nt,at,Qe)}function Ge(Qe,nt,at){return we(1-Qe,at,nt)}function lt(Qe,nt,at=0){return Z(.5*nt,.5*(Qe-at))}function bt(Qe,nt,at){return at*C(nt,Qe)}function te(Qe,nt,at){return at*C(nt,1-Qe)}function Je(Qe,nt,at=0){return.5-Math.atan(2*(Qe-at)/nt)/Ze}function tt(Qe,nt,at=0){return.5+Math.atan(2*(Qe-at)/nt)/Ze}function Fe(Qe,nt,at=0){return.5-Math.atan((Qe-at)/nt)/Ze}function Ne(Qe,nt,at=0){return.5+Math.atan((Qe-at)/nt)/Ze}function rt(Qe,nt=1,at=0){return nt/(Ze*((Qe-at)*(Qe-at)+nt*nt))}function St(Qe,nt=1,at=0){const ht=(Qe-at)/nt;return 1/(Math.sqrt(2*Ze)*Math.abs(nt))*Math.exp(-ht*ht/2)}function pt(Qe,nt,at,ht=0){return Qe-ht<0?0:Qe-ht==0?1==nt?1/at:0:1==nt?Math.exp(-(Qe-ht)/at)/at:Math.exp((nt-1)*Math.log((Qe-ht)/at)-(Qe-ht)/at-ee(nt))/at}function st(Qe,nt,at=0){const ht=Qe-at,Qt=ht>0?1:-1;return.5-.5*we(ht*ht/(nt+ht*ht),.5,.5*nt)*Qt}function vt(Qe,nt,at=0){const ht=Qe-at,Qt=ht>0?1:-1;return.5+.5*we(ht*ht/(nt+ht*ht),.5,.5*nt)*Qt}function Yt(Qe,nt,at=0){return Math.exp(ee((nt+1)/2)-ee(nt/2))/Math.sqrt(Ze*nt)*Math.pow(1+(Qe-at)*(Qe-at)/nt,-(nt+1)/2)}function qt(Qe,nt,at=0){return Qe-at<0?1:Math.exp(-nt*(Qe-at))}function Ot(Qe,nt,at=0){return Qe-at<0?0:-Math.expm1(-nt*(Qe-at))}function Bn(Qe,nt,at=0){return Qe-at<0?0:Qe==at&&0==nt/2-1?.5:Math.exp((nt/2-1)*Math.log((Qe-at)/2)-(Qe-at)/2-ee(nt/2))/2}function Mn(Qe,nt,at,ht=0){return nt<0||at<0?Number.NaN:Qe-ht<0?0:Math.exp(nt/2*Math.log(nt)+at/2*Math.log(at)+ee((nt+at)/2)-ee(nt/2)-ee(at/2)+(nt/2-1)*Math.log(Qe-ht)-(nt+at)/2*Math.log(at+nt*(Qe-ht)))}function bn(Qe,nt,at,ht=0){return nt<0||at<0?Number.NaN:at/(at+nt*(Qe-ht))>.9&&nt>1&&at>1?1-Dn(Qe,nt,at,ht):we(at/(at+nt*(Qe-ht)),.5*at,.5*nt)}function Dn(Qe,nt,at,ht=0){if(nt<0||at<0)return Number.NaN;const Qt=nt*(Qe-ht)/(at+nt*(Qe-ht));return Qt>.9&&nt>1&&at>1?1-bn(Qe,nt,at,ht):we(Qt,.5*nt,.5*at)}function $n(Qe,nt){return nt<=0?0:Qe<=0?Qe<0?0:1:b(Qe,nt,0)}function Cn(Qe,nt,at,ht){if(!at)return 1e30;const Qt=(Qe-nt)/at;if(Qt<-39||Qt>39)return 0;const vn=Math.exp(-.5*Qt*Qt);return ht?vn/(2.5066282746310002*at):vn}function yn(Qe,nt,at){return at/((Qe-nt)*(Qe-nt)+at*at/4)/2/Math.PI}function Sn(Qe,nt){return Math.exp(ee(Qe)+ee(nt)-ee(Qe+nt))}function ii(Qe,nt,at=0,ht=1){return Qe<at||nt<=0||ht<=0?0:pt(Qe,nt,ht,at)}function ai(Qe,nt=0,at=1){return Math.exp(-Math.abs((Qe-nt)/at))/(2*at)}function Hi(Qe,nt=0,at=1){return Qe<=nt?.5*Math.exp(-Math.abs((Qe-nt)/at)):1-.5*Math.exp(-Math.abs((Qe-nt)/at))}function ti(Qe,nt){if(nt<1)return 0;const at=nt,ht=.5*at,Qt=ht+.5,vn=Math.sqrt(at*Math.PI)*$(ht)*Math.pow(1+Qe*Qe/at,Qt);return $(Qt)/vn}function Nr(Qe,nt){const at=nt;return Qe>0?1-.5*Me(at/(at+Qe*Qe),.5*at,.5):.5*Me(at/(at+Qe*Qe),.5*at,.5)}function ss(Qe,nt,at=0,ht=1){return Qe<at||nt<=0||ht<=0?0:X(Qe,Math.log(ht),nt,at)}function Bs(Qe,nt,at){if(Qe<0||Qe>1||nt<=0||at<=0)return 0;const ht=Sn(nt,at);return Math.pow(Qe,nt-1)*Math.pow(1-Qe,at-1)/ht}function yo(Qe,nt,at){return Qe<0||Qe>1||nt<=0||at<=0?0:Me(Qe,nt,at)}function xt(Qe,nt,at){return Qe.GetParValue(at+0)*Math.exp(-.5*Math.pow((nt-Qe.GetParValue(at+1))/Qe.GetParValue(at+2),2))}function K(Qe,nt,at){return xt(Qe,nt,at)/(Math.sqrt(2*Math.PI)*Qe.GetParValue(at+2))}function ge(Qe,nt,at,ht){return Qe.GetParValue(ht+0)*Math.exp(-.5*Math.pow((nt-Qe.GetParValue(ht+1))/Qe.GetParValue(ht+2),2))*Math.exp(-.5*Math.pow((at-Qe.GetParValue(ht+3))/Qe.GetParValue(ht+4),2))}function ye(Qe,nt,at){return Math.exp(Qe.GetParValue(at+0)+Qe.GetParValue(at+1)*nt)}function Pe(Qe,nt,at){return U(nt,Qe.GetParValue(at+1),Qe.GetParValue(at+2),!1)}function At(Qe,nt,at){return U(nt,Qe.GetParValue(at+1),Qe.GetParValue(at+2),!0)}function Vt(Qe,nt,at,ht,Qt=0){if(ht<0)return 0;let vn=(Qe-Qt)/ht;nt<0&&(vn=-vn);const en=Math.abs(nt);if(vn>-en)return Math.exp(-.5*vn*vn);const jt=at/en;return Math.exp(-.5*en*en)*Math.pow(jt/(jt-en-vn),at)}function Nt(Qe,nt,at,ht,Qt=0){if(ht<0)return 0;if(at<=1)return Number.NaN;const vn=Math.abs(nt);return 1/(ht*(at/vn*1/(at-1)*Math.exp(-nt*nt/2)+Math.sqrt(Ze/2)*(1+J(vn/Math.sqrt(2)))))*Vt(Qe,nt,at,ht,Qt)}function nn(Qe,nt,at,ht,Qt=0){if(0==ht||0==nt)return 0;const vn=1==at,en=Math.abs(nt);let jt=(Qe-Qt)/ht,fn=0,Gn=0;nt<0&&(jt=-jt);const qn=Math.sqrt(Ze/2),Vi=Math.sqrt(2*Ze),_r=1/Math.sqrt(2);if(jt<=-en){const Ni=Math.pow(at/en,at)*Math.exp(-.5*nt*nt),Kr=at/en-en;Gn=vn?-Ni*Math.log(at/en)+Ni*Math.log(Kr-jt):at/en*(1/(at-1))*Math.exp(-nt*nt/2)-Ni/(at-1)*Math.pow(Kr-jt,1-at),fn=qn*(1+J(en*_r))}else fn=Q(jt,1),fn*=Vi,Gn=0;return ht*(fn+Gn)}function hn(Qe,nt,at,ht,Qt=0){if(at<=1)return Number.NaN;const vn=Math.abs(nt),fn=ht*(at/vn*1/(at-1)*Math.exp(-nt*nt/2)+Math.sqrt(Ze/2)*(1+J(vn/Math.sqrt(2)))),Gn=nn(Qe,nt,at,ht,Qt);return nt>0?1-Gn/fn:Gn/fn}function kn(Qe,nt,at,ht,Qt=0){if(at<=1)return Number.NaN;const vn=Math.abs(nt),fn=ht*(at/vn*1/(at-1)*Math.exp(-nt*nt/2)+Math.sqrt(Ze/2)*(1+J(vn/Math.sqrt(2)))),Gn=nn(Qe,nt,at,ht,Qt);return nt>0?Gn/fn:1-Gn/fn}function dn(Qe,nt,at){let ht=0,Qt=0;const vn=2*nt;for(let en=Qe;en>=1;en--){const jt=ht;ht=vn*ht-Qt+at[en],Qt=jt}return nt*ht-Qt+at[0]}function In(Qe,nt){return nt}function ci(Qe,nt,at){return nt+at*Qe}function Pi(Qe,nt,at,ht){return nt+at*Qe+ht*(2*Qe*Qe-1)}function Si(Qe,...nt){return dn(3,Qe,nt)}function bi(Qe,...nt){return dn(4,Qe,nt)}function Jn(Qe,...nt){return dn(5,Qe,nt)}function Wi(Qe,...nt){return dn(6,Qe,nt)}function Ln(Qe,...nt){return dn(7,Qe,nt)}function Rs(Qe,...nt){return dn(8,Qe,nt)}function oe(Qe,...nt){return dn(9,Qe,nt)}function D(Qe,...nt){return dn(10,Qe,nt)}function O(Qe,nt,at,ht){const Qt=(1-at)/2;return ht?nt==Qe?1:je(1-Qt,nt+1,Qe-nt):0==nt?0:je(Qt,nt,Qe-nt+1)}function ie(Qe,nt,at,ht){if(0==Qe)return ht?1:0;const vn=nt/Qe,jt=E(1-(1-at)/2,Math.sqrt(vn*(1-vn)/Qe));return ht?vn+jt>1?1:vn+jt:vn-jt<0?0:vn-jt}function _e(Qe,nt,at,ht){if(0==Qe)return ht?1:0;const vn=nt/Qe,en=E(1-(1-at)/2,1),jt=(nt+.5*en*en)/(Qe+en*en),fn=en/(Qe+en*en)*Math.sqrt(Qe*vn*(1-vn)+en*en/4);return ht?jt+fn>1?1:jt+fn:jt-fn<0?0:jt-fn}function Oe(Qe,nt,at,ht){const vn=E(1-(1-at)/2,1),en=(nt+.5*vn*vn)/(Qe+vn*vn),jt=vn*Math.sqrt(en*(1-en)/(Qe+vn*vn));return ht?en+jt>1?1:en+jt:en-jt<0?0:en-jt}function $e(Qe,nt,at,ht){const en=(1-at)/2;let fn=0,Gn=1,qn=0;if(nt>0&&nt<1){const Vi=$e(Qe,0,at,ht);return qn=($e(Qe,1,at,ht)-Vi)*nt+Vi,qn}for(;Math.abs(Gn-fn)>1e-9;){qn=(fn+Gn)/2;let Vi=.5*he(qn,nt+1,Qe-nt+1)/(Qe+1);nt-1>=0&&(Vi+=Ge(qn,nt,Qe-nt+1)),Vi>(ht?en:1-en)?fn=qn:Gn=qn}return qn}function et(Qe,nt,at,ht,Qt,vn){const en=nt+Qt,jt=Qe-nt+vn;return ht?en>0&&jt>0?je((1+at)/2,en,jt):1:en>0&&jt>0?je((1-at)/2,en,jt):0}function it(Qe,nt){if(nt)return et;switch(Qe){case 0:return O;case 1:return ie;case 2:return _e;case 3:return Oe;case 4:return console.log("Feldman-Cousins interval kFFC not supported; using kFCP"),O;case 8:return $e}return console.log(`Not recognized stat option ${Qe}, using kFCP`),O}function yt(Qe){return Qe*Qe}function sn(){return Math.PI}function tn(){return 2*Math.PI}function xn(){return Math.PI/2}function wn(){return Math.PI/4}function Ut(){return 1/Math.PI}},8872:(Yr,mt,Se)=>{"use strict";Se.r(mt),Se.d(mt,{BIT:()=>v,_ensureJSROOT:()=>ia,addMethods:()=>I,atob_func:()=>F,browser:()=>Y,btoa_func:()=>J,clTAnnotation:()=>xt,clTAttCanvas:()=>kn,clTAttFill:()=>Fe,clTAttLine:()=>tt,clTAttMarker:()=>Ne,clTAttText:()=>rt,clTAxis:()=>ci,clTBox:()=>ye,clTCanvas:()=>hn,clTClonesArray:()=>Je,clTColor:()=>K,clTCutG:()=>vt,clTDiamond:()=>ii,clTF1:()=>D,clTF2:()=>O,clTF3:()=>ie,clTFile:()=>je,clTGaxis:()=>dn,clTGeoNode:()=>it,clTGeoNodeMatrix:()=>yt,clTGeoVolume:()=>et,clTGraph:()=>pt,clTGraph2DAsymmErrors:()=>qt,clTGraph2DErrors:()=>Yt,clTGraphPolar:()=>Ot,clTGraphPolargram:()=>Bn,clTGraphTime:()=>Mn,clTH1:()=>Si,clTH1D:()=>Jn,clTH1I:()=>bi,clTH2:()=>Wi,clTH2F:()=>Rs,clTH2I:()=>Ln,clTH3:()=>oe,clTHStack:()=>St,clTHashList:()=>lt,clTImagePalette:()=>Nr,clTKey:()=>Me,clTLatex:()=>Bs,clTLegend:()=>ai,clTLegendEntry:()=>Hi,clTLine:()=>ge,clTList:()=>Ge,clTMap:()=>bt,clTMathText:()=>yo,clTMultiGraph:()=>st,clTNamed:()=>W,clTObjArray:()=>te,clTObjString:()=>we,clTObject:()=>z,clTPad:()=>nn,clTPaletteAxis:()=>ti,clTPave:()=>bn,clTPaveClass:()=>Sn,clTPaveLabel:()=>yn,clTPaveStats:()=>$n,clTPaveText:()=>Dn,clTPavesText:()=>Cn,clTPolyLine:()=>Pe,clTPolyLine3D:()=>At,clTPolyMarker3D:()=>Vt,clTProfile:()=>_e,clTProfile2D:()=>Oe,clTProfile3D:()=>$e,clTString:()=>fe,clTStyle:()=>Pi,clTText:()=>ss,clone:()=>f,constants:()=>Q,create:()=>Ut,createHistogram:()=>Qe,createHttpRequest:()=>G,createTGraph:()=>ht,createTHStack:()=>Qt,createTMultiGraph:()=>vn,createTPolyLine:()=>at,decodeUrl:()=>ee,findFunction:()=>he,gStyle:()=>X,getDocument:()=>B,getMethods:()=>jt,getPromise:()=>os,httpRequest:()=>b,injectCode:()=>$,internals:()=>ot,isArrayProto:()=>ue,isBatchMode:()=>He,isFunc:()=>Vi,isNodeJs:()=>De,isObject:()=>qn,isPromise:()=>Ni,isRootCollection:()=>Gn,isStr:()=>_r,kInspect:()=>wn,kNoStats:()=>xn,kNoZoom:()=>tn,loadScript:()=>E,nsREX:()=>sn,parse:()=>U,parseMulti:()=>k,postponePromise:()=>Kr,prROOT:()=>T,registerMethods:()=>fn,setBatchMode:()=>Ve,setHistogramTitle:()=>nt,settings:()=>me,source_dir:()=>Ze,toJSON:()=>Z,version:()=>ve,version_date:()=>L,version_id:()=>x});var Ee=Se(4882);const x="7.6.0",L="23/02/2024",ve=x+" "+L,ke=!!("object"==typeof process&&qn(process.versions)&&process.versions.node&&process.versions.v8),ot={id_counter:1},Ye="file:///C:/Users/starr136a/Documents/Projects/Web%20Projects/phoenix/node_modules/jsroot/modules/core.mjs";let Ze="";if(Ye&&_r(Ye)){const un=Ye.indexOf("modules/core.mjs");un>=0?(Ze=Ye.slice(0,un),console.log(`Set jsroot source_dir to ${Ze}, ${ve}`)):(console.log(`jsroot bundle, ${ve}`),ot.ignore_v6=!0)}let Re=ke;function He(){return Re}function Ve(un){Re=!!un}function De(){return ke}const F=De()?un=>Buffer.from(un,"base64").toString("latin1"):globalThis?.atob,J=De()?un=>Buffer.from(un,"latin1").toString("base64"):globalThis?.btoa,Y={isFirefox:!0,isSafari:!1,isChrome:!1,isWin:!1,touches:!1,screenWidth:1200};function ue(un){if(un.length<14||0!==un.indexOf("[object "))return 0;const di=un.indexOf("Array]");return di<0||di!==un.length-6?0:14===un.length?1:2}typeof document<"u"&&typeof window<"u"&&typeof navigator<"u"&&(navigator.userAgentData?.brands?.forEach(un=>{"HeadlessChrome"===un.brand?(Y.isChromeHeadless=!0,Y.chromeVersion=parseInt(un.version)):"Chromium"===un.brand&&(Y.isChrome=!0,Y.chromeVersion=parseInt(un.version))}),Y.chromeVersion?(Y.isFirefox=!1,Y.isWin="Windows"===navigator.userAgentData.platform):(Y.isFirefox=navigator.userAgent.indexOf("Firefox")>=0,Y.isSafari=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,Y.isChrome=!!window.chrome,Y.isChromeHeadless=navigator.userAgent.indexOf("HeadlessChrome")>=0,Y.chromeVersion=Y.isChrome||Y.isChromeHeadless?parseInt(navigator.userAgent.match(/Chrom(?:e|ium)\/([0-9]+)\.([0-9]+)\.([0-9]+)\.([0-9]+)/)[1]):0,Y.isWin=navigator.userAgent.indexOf("Windows")>=0),Y.touches="ontouchend"in document,Y.screenWidth=window.screen?.width??1200);const Q={Render3D:{Default:0,WebGL:1,WebGLImage:2,SVG:3,fromString(un){return"webgl"===un||"gl"===un?this.WebGL:"img"===un?this.WebGLImage:"svg"===un?this.SVG:this.Default}},Embed3D:{NoEmbed:-1,Default:0,Overlay:1,Embed:2,EmbedSVG:3,fromString(un){return"embed"===un?this.Embed:"overlay"===un?this.Overlay:this.Default}},Latex:{Off:0,Symbols:1,Normal:2,MathJax:3,AlwaysMathJax:4,fromString(un){if(!un||!_r(un))return this.Normal;switch(un){case"off":return this.Off;case"symbols":return this.Symbols;case"normal":case"latex":case"exp":case"experimental":return this.Normal;case"MathJax":case"mathjax":case"math":return this.MathJax;case"AlwaysMathJax":case"alwaysmath":case"alwaysmathjax":return this.AlwaysMathJax}const di=parseInt(un);return Number.isInteger(di)&&di>=this.Off&&di<=this.AlwaysMathJax?di:this.Normal}}},me={Render3D:Q.Render3D.Default,Render3DBatch:Q.Render3D.Default,Embed3D:Q.Embed3D.Default,Tooltip:!ke,TooltipAnimation:500,ContextMenu:!ke,Zooming:!ke,ZoomMouse:!ke,ZoomWheel:!ke,ZoomTouch:!ke,MoveResize:!Y.touches&&!ke,HandleKeys:!ke,DragAndDrop:!ke,DragGraphs:!0,ProgressBox:!ke,ToolBar:!ke&&"popup",ToolBarSide:"left",ToolBarVert:!1,CanEnlarge:!0,CanAdjustFrame:!1,ApproxTextSize:!1,OptimizeDraw:1,AutoStat:!0,FrameNDC:{},SmallPad:{width:150,height:100},Palette:57,Latex:Q.Latex.Normal,GeoGradPerSegm:6,GeoCompressComp:!0,IgnoreUrlOptions:!1,HierarchyLimit:250,DislpayKind:"simple",BrowserWidth:250,XValuesFormat:void 0,YValuesFormat:void 0,ZValuesFormat:void 0,HandleWrongHttpResponse:!1,UseStamp:!0,MaxRanges:200,WithCredentials:!1,SkipStreamerInfos:!1,OnlyLastCycle:!1,DarkMode:!1,PreferSavedPoints:!1,AxisTiltAngle:25,StripAxisLabels:!0,FuncAsCurve:!1},X={fName:"Modern",fOptLogx:0,fOptLogy:0,fOptLogz:0,fOptDate:0,fOptFile:0,fDateX:.01,fDateY:.01,fOptTitle:1,fCanvasColor:0,fPadColor:0,fPadBottomMargin:.1,fPadTopMargin:.1,fPadLeftMargin:.1,fPadRightMargin:.1,fPadGridX:!1,fPadGridY:!1,fPadTickX:0,fPadTickY:0,fPadBorderSize:2,fPadBorderMode:0,fCanvasBorderSize:2,fCanvasBorderMode:0,fStatColor:0,fStatStyle:1e3,fStatTextColor:1,fStatFontSize:0,fStatFont:42,fStatBorderSize:1,fStatFormat:"6.4g",fStatX:.98,fStatY:.935,fStatW:.2,fStatH:.16,fTitleAlign:23,fTitleColor:0,fTitleTextColor:1,fTitleBorderSize:0,fTitleFont:42,fTitleFontSize:.05,fTitleStyle:0,fTitleX:.5,fTitleY:.995,fTitleW:0,fTitleH:0,fFitFormat:"5.4g",fOptStat:1111,fOptFit:0,fNumberContours:20,fGridColor:0,fGridStyle:3,fGridWidth:1,fFrameFillColor:0,fFrameFillStyle:1001,fFrameLineColor:1,fFrameLineWidth:1,fFrameLineStyle:1,fFrameBorderSize:1,fFrameBorderMode:0,fEndErrorSize:2,fErrorX:.5,fHistMinimumZero:!1,fHistTopMargin:.05,fHistFillColor:0,fHistFillStyle:1001,fHistLineColor:602,fHistLineStyle:1,fHistLineWidth:1,fPaintTextFormat:"g",fTimeOffset:788918400,fLegendBorderSize:1,fLegendFont:42,fLegendTextSize:0,fLegendFillColor:0,fHatchesLineWidth:1,fHatchesSpacing:1,fCandleWhiskerRange:1,fCandleBoxRange:.5,fCandleScaled:!1,fViolinScaled:!0,fOrthoCamera:!1,fXAxisExpXOffset:0,fXAxisExpYOffset:0,fYAxisExpXOffset:0,fYAxisExpYOffset:0,fAxisMaxDigits:5,fStripDecimals:!0,fBarWidth:1};function B(){return ke?ot.nodejs_document:typeof document<"u"?document:"object"==typeof window?window.document:void 0}function $(un){return A.apply(this,arguments)}function A(){return(A=(0,Ee.A)(function*(un){if(ke){let di,Rt;return Se.e(36).then(Se.t.bind(Se,9036,19)).then(ui=>(di=ui.tmpNameSync()+".js",Se.e(424).then(Se.t.bind(Se,9424,19)))).then(ui=>(Rt=ui,Rt.writeFileSync(di,un),import("file://"+di))).finally(()=>Rt.unlinkSync(di))}if(typeof document<"u"){const di=document.getElementsByTagName("script");for(let ui=0;ui<di.length;++ui)if(di[ui].innerHTML===un)return!0;return(un.indexOf("JSROOT.require")>=0?ia():Promise.resolve(!0)).then(()=>{const ui=document.createElement("script");return ui.setAttribute("type","text/javascript"),ui.innerHTML=un,document.head.appendChild(ui),Kr(!0,10)})}return!1})).apply(this,arguments)}function E(un){return g.apply(this,arguments)}function g(){return(g=(0,Ee.A)(function*(un){if(!un)return!0;if(_r(un)&&un.indexOf(";")>=0&&(un=un.split(";")),!_r(un)){const Pn=un,Fn=()=>!Pn.length||E(Pn.shift()).then(Fn,Fn);return Fn()}0===un.indexOf("$$$")&&(0===(un=un.slice(3)).indexOf("style/")&&un.indexOf(".css")<0&&(un+=".css"),un=Ze+un);const di=un.indexOf(".css")>0;if(ke)return di?null:0===un.indexOf("http:")||0===un.indexOf("https:")?b(un,"text").then(Pn=>$(Pn)):0===un.indexOf("./")?Se.e(424).then(Se.t.bind(Se,9424,19)).then(Pn=>$(Pn.readFileSync(un))):import(un);const Rt=Pn=>{if(Pn===un)return!0;const Fn=Pn.indexOf(un);return Fn>0&&Fn+un.length===Pn.length&&"/"===Pn[Fn-1]};if(di){const Pn=document.getElementsByTagName("link");for(let Fn=0;Fn<Pn.length;++Fn)if(Pn[Fn].href&&"text/css"===Pn[Fn].type&&"stylesheet"===Pn[Fn].rel&&Rt(Pn[Fn].href))return!0}else{const Pn=document.getElementsByTagName("script");for(let Fn=0;Fn<Pn.length;++Fn)if(Rt(Pn[Fn].src))return!0}let ui;return di?(ui=document.createElement("link"),ui.setAttribute("rel","stylesheet"),ui.setAttribute("type","text/css"),ui.setAttribute("href",un)):(ui=document.createElement("script"),ui.setAttribute("type","text/javascript"),ui.setAttribute("src",un)),new Promise((Pn,Fn)=>{ui.onload=()=>Pn(!0),ui.onerror=()=>{ui.remove(),Fn(Error(`Fail to load ${un}`))},document.head.appendChild(ui)})})).apply(this,arguments)}function v(un){return 1<<un}function f(un,di,Rt){if(!un)return null;if(di){const Fn=di.obj.indexOf(un);if(Fn>=0)return di.clones[Fn]}else di={obj:[],clones:[],nofunc:Rt};const ui=ue(Object.prototype.toString.apply(un));if(1===ui){const Fn=[];di.obj.push(un),di.clones.push(Fn);for(let _i=0;_i<un.length;++_i)Fn.push(qn(un[_i])?f(un[_i],di):un[_i]);return Fn}if(2===ui){const Fn=[];di.obj.push(un),di.clones.push(Fn);for(let _i=0;_i<un.length;++_i)Fn.push(un[_i]);return Fn}const Pn={};di.obj.push(un),di.clones.push(Pn);for(const Fn in un)qn(un[Fn])?Pn[Fn]=f(un[Fn],di):(!di.nofunc||!Vi(un[Fn]))&&(Pn[Fn]=un[Fn]);return Pn}const C=Object.assign;function I(un,di){C(un,jt(di||un._typename,un))}function U(un){if(!un)return null;const di=_r(un)?JSON.parse(un):un,Rt=[];let ui;const Pn=Fn=>{if(null==Fn)return;if(_r(Fn)){if(ui||Fn.length<6||0!==Fn.indexOf("$ref:"))return;const Qr=parseInt(Fn.slice(5));return!Number.isInteger(Qr)||Qr<0||Qr>=Rt.length?void 0:(ui=!1,Rt[Qr])}if("object"!=typeof Fn)return;if(ue(Object.prototype.toString.apply(Fn))>0){for(let Qr=0;Qr<Fn.length;++Qr){const ro=Pn(Fn[Qr]);void 0!==ro&&(Fn[Qr]=ro)}return}const Dr=Object.keys(Fn),gs=Dr.length;if(!1!==ui&&1===gs&&"$ref"===Dr[0]){const Qr=parseInt(Fn.$ref);return!Number.isInteger(Qr)||Qr<0||Qr>=Rt.length?void 0:(ui=!0,Rt[Qr])}if(!1!==ui&&gs>1&&"$arr"===Dr[0]&&"len"===Dr[1]){let Qr;switch(Fn.$arr){case"Int8":Qr=new Int8Array(Fn.len);break;case"Uint8":Qr=new Uint8Array(Fn.len);break;case"Int16":Qr=new Int16Array(Fn.len);break;case"Uint16":Qr=new Uint16Array(Fn.len);break;case"Int32":Qr=new Int32Array(Fn.len);break;case"Uint32":Qr=new Uint32Array(Fn.len);break;case"Float32":Qr=new Float32Array(Fn.len);break;case"Int64":case"Uint64":case"Float64":Qr=new Float64Array(Fn.len);break;default:Qr=new Array(Fn.len)}if(Qr.fill("Bool"!==Fn.$arr&&0),void 0!==Fn.b){const ro=F(Fn.b);if(!Qr.buffer)throw new Error("base64 coding supported only for native arrays with binary data");{const Zs=new DataView(Qr.buffer,Fn.o||0),qi=Math.min(ro.length,Zs.byteLength);for(let Uo=0;Uo<qi;++Uo)Zs.setUint8(Uo,ro.charCodeAt(Uo))}}else{let ro=2,Zs=0;for(;ro<gs;){if("p"===Dr[ro][0]&&(Zs=Fn[Dr[ro++]]),"v"!==Dr[ro][0])throw new Error(`Unexpected member ${Dr[ro]} in array decoding`);const qi=Fn[Dr[ro++]];if("object"==typeof qi)for(let Uo=0;Uo<qi.length;++Uo)Qr[Zs++]=qi[Uo];else if(Qr[Zs++]=qi,ro<gs&&"n"===Dr[ro][0]){let Uo=Fn[Dr[ro++]];for(;--Uo;)Qr[Zs++]=qi}}}return Qr}if(!1!==ui&&3===gs&&"$pair"===Dr[0]&&"first"===Dr[1]&&"second"===Dr[2]){ui=!0;const Qr=Pn(Fn.first),ro=Pn(Fn.second);return void 0!==Qr&&(Fn.first=Qr),void 0!==ro&&(Fn.second=ro),Fn._typename=Fn.$pair,void delete Fn.$pair}if(!(Rt.indexOf(Fn)>=0)){Rt.push(Fn),Fn._typename&&I(Fn);for(let Qr=0;Qr<gs;++Qr){const ro=Dr[Qr],Zs=Pn(Fn[ro]);void 0!==Zs&&(Fn[ro]=Zs)}}};return Pn(di),di}function k(un){if(!un)return null;const di=JSON.parse(un);if(di?.length)for(let Rt=0;Rt<di.length;++Rt)di[Rt]=U(di[Rt]);return di}function Z(un,di){if(!qn(un))return"";const Rt=[],ui=Fn=>{if(Vi(Fn))return;if(null==Fn||!qn(Fn))return Fn;if(ue(Object.prototype.toString.apply(Fn))>0){const ro=new Array(Fn.length);for(let Zs=0;Zs<Fn.length;++Zs)ro[Zs]=ui(Fn[Zs]);return ro}const _i=Rt.indexOf(Fn);if(_i>=0)return{$ref:_i};const Dr=Object.keys(Fn),gs=Dr.length,Qr={};if(3===gs&&"$pair"===Dr[0]&&"first"===Dr[1]&&"second"===Dr[2])return Qr.$pair=Fn.$pair,Qr.first=ui(Fn.first),Qr.second=ui(Fn.second),Qr;Rt.push(Fn);for(let ro=0;ro<gs;++ro){const Zs=Dr[ro];Zs&&"$"!==Zs[0]&&(Qr[Zs]=ui(Fn[Zs]))}return Qr},Pn=ui(un);return JSON.stringify(Pn,null,di)}function ee(un){const di={opts:{},has(ui){return void 0!==this.opts[ui]},get(ui,Pn){const Fn=this.opts[ui];return void 0!==Fn?Fn:Pn}};if(!un||!_r(un)){if(me.IgnoreUrlOptions||typeof document>"u")return di;un=document.URL}di.url=un;const Rt=un.indexOf("?");if(Rt<0)return di;for(un=decodeURI(un.slice(Rt+1));un;){let ui=0,Pn=0,Fn=-1,_i=-1;for(;ui<un.length&&(0!==Pn||"&"!==un[ui]&&"#"!==un[ui]);){switch(un[ui]){case"'":Pn>=0&&(Pn=(Pn+1)%2),_i<0&&(_i=ui);break;case'"':Pn<=0&&(Pn=(Pn-1)%2),_i<0&&(_i=ui);break;case"=":_i<0&&Fn<0&&(Fn=ui)}ui++}if(Fn<0&&_i<0)di.opts[un.slice(0,ui)]="";else if(Fn>0){let Dr=un.slice(Fn+1,ui);("'"===Dr[0]||'"'===Dr[0])&&Dr[0]===Dr[Dr.length-1]&&(Dr=Dr.slice(1,Dr.length-1)),di.opts[un.slice(0,Fn)]=Dr}if(ui>=un.length||"#"===un[ui])break;un=un.slice(ui+1)}return di}function he(un){if(Vi(un))return un;if(!_r(un))return null;const di=un.split(".");let Rt=globalThis;for(let ui=0;Rt&&ui<di.length;++ui)Rt=Rt[di[ui]];return Vi(Rt)?Rt:null}function G(un,di,Rt,ui,Pn){function Fn(Dr){Dr.http_callback=Vi(Rt)?Rt.bind(Dr):()=>{},Dr.error_callback=Vi(ui)?ui.bind(Dr):function(Zs){console.warn(Zs.message),this.http_callback(null)}.bind(Dr),di||(di="buf");let gs="GET",Qr=!0;const ro=di.indexOf(";sync");switch(ro>0&&(di=di.slice(0,ro),Qr=!1),di){case"head":gs="HEAD";break;case"posttext":gs="POST",di="text";break;case"postbuf":gs="POST",di="buf";break;case"post":case"multi":gs="POST"}return Dr.kind=di,me.WithCredentials&&(Dr.withCredentials=!0),me.HandleWrongHttpResponse&&"GET"===gs&&Vi(Dr.addEventListener)&&Dr.addEventListener("progress",function(Zs){Zs.lengthComputable&&this.expected_size&&Zs.loaded>this.expected_size&&(this.did_abort=!0,this.abort(),this.error_callback(Error(`Server sends more bytes ${Zs.loaded} than expected ${this.expected_size}. Abort I/O operation`),598))}.bind(Dr)),Dr.onreadystatechange=function(){if(!this.did_abort){if(2===this.readyState&&this.expected_size){const Zs=parseInt(this.getResponseHeader("Content-Length"));if(Number.isInteger(Zs)&&Zs>this.expected_size&&!me.HandleWrongHttpResponse)return this.did_abort=!0,this.abort(),this.error_callback(Error(`Server response size ${Zs} larger than expected ${this.expected_size}. Abort I/O operation`),599)}if(4===this.readyState){if(200!==this.status&&206!==this.status&&!Y.qt5&&(0!==this.status||0!==un.indexOf("file://")&&0!==un.indexOf("blob:")))return this.error_callback(Error(`Fail to load url ${un}`),this.status);if(this.nodejs_checkzip&&"gzip"===this.getResponseHeader("content-encoding"))return Se.e(578).then(Se.t.bind(Se,7578,19)).then(Zs=>{const qi=Zs.unzipSync(Buffer.from(this.response)),Uo=JSON.parse(qi);return this.http_callback(U(Uo))});switch(this.kind){case"xml":return this.http_callback(this.responseXML);case"text":return this.http_callback(this.responseText);case"object":return this.http_callback(U(this.responseText));case"multi":return this.http_callback(k(this.responseText));case"head":return this.http_callback(this)}if(void 0===this.responseType)return this.http_callback(this.responseText);if("bin"===this.kind&&"byteLength"in this.response){const Zs=new Uint8Array(this.response);let qi="";for(let Uo=0;Uo<Zs.length;++Uo)qi+=String.fromCharCode(Zs[Uo]);return this.http_callback(qi)}this.http_callback(this.response)}}},Dr.open(gs,un,Qr),("bin"===di||"buf"===di)&&(Dr.responseType="arraybuffer"),ke&&"GET"===gs&&"object"===di&&un.indexOf(".json.gz")>0&&(Dr.nodejs_checkzip=!0,Dr.responseType="arraybuffer"),Dr}if(De()){if(!Pn)throw Error("Not allowed to create http requests in node.js without promise");return Se.e(149).then(Se.t.bind(Se,9149,19)).then(Dr=>Fn(new Dr.default))}const _i=Fn(new XMLHttpRequest);return Pn?Promise.resolve(_i):_i}function b(un,di,Rt){return P.apply(this,arguments)}function P(){return(P=(0,Ee.A)(function*(un,di,Rt){return new Promise((ui,Pn)=>{G(un,di,ui,Pn,!0).then(Fn=>Fn.send(Rt||null))})})).apply(this,arguments)}const T="ROOT.",z="TObject",W="TNamed",fe="TString",we="TObjString",Me="TKey",je="TFile",Ge="TList",lt="THashList",bt="TMap",te="TObjArray",Je="TClonesArray",tt="TAttLine",Fe="TAttFill",Ne="TAttMarker",rt="TAttText",St="THStack",pt="TGraph",st="TMultiGraph",vt="TCutG",Yt="TGraph2DErrors",qt="TGraph2DAsymmErrors",Ot="TGraphPolar",Bn="TGraphPolargram",Mn="TGraphTime",bn="TPave",Dn="TPaveText",$n="TPaveStats",Cn="TPavesText",yn="TPaveLabel",Sn="TPaveClass",ii="TDiamond",ai="TLegend",Hi="TLegendEntry",ti="TPaletteAxis",Nr="TImagePalette",ss="TText",Bs="TLatex",yo="TMathText",xt="TAnnotation",K="TColor",ge="TLine",ye="TBox",Pe="TPolyLine",At="TPolyLine3D",Vt="TPolyMarker3D",Nt="TAttPad",nn="TPad",hn="TCanvas",kn="TAttCanvas",dn="TGaxis",In="TAttAxis",ci="TAxis",Pi="TStyle",Si="TH1",bi="TH1I",Jn="TH1D",Wi="TH2",Ln="TH2I",Rs="TH2F",oe="TH3",D="TF1",O="TF2",ie="TF3",_e="TProfile",Oe="TProfile2D",$e="TProfile3D",et="TGeoVolume",it="TGeoNode",yt="TGeoNodeMatrix",sn="ROOT::Experimental::",tn=-1111,xn=v(9),wn="inspect";function Ut(un,di){const Rt=di||{};switch(un){case z:C(Rt,{fUniqueID:0,fBits:0});break;case W:C(Rt,{fUniqueID:0,fBits:0,fName:"",fTitle:""});break;case Ge:case lt:C(Rt,{name:un,arr:[],opt:[]});break;case In:C(Rt,{fNdivisions:510,fAxisColor:1,fLabelColor:1,fLabelFont:42,fLabelOffset:.005,fLabelSize:.035,fTickLength:.03,fTitleOffset:1,fTitleSize:.035,fTitleColor:1,fTitleFont:42});break;case ci:Ut(W,Rt),Ut(In,Rt),C(Rt,{fNbins:1,fXmin:0,fXmax:1,fXbins:[],fFirst:0,fLast:0,fBits2:0,fTimeDisplay:!1,fTimeFormat:"",fLabels:null,fModLabs:null});break;case tt:C(Rt,{fLineColor:1,fLineStyle:1,fLineWidth:1});break;case Fe:C(Rt,{fFillColor:0,fFillStyle:0});break;case Ne:C(Rt,{fMarkerColor:1,fMarkerStyle:1,fMarkerSize:1});break;case ge:Ut(z,Rt),Ut(tt,Rt),C(Rt,{fX1:0,fX2:1,fY1:0,fY2:1});break;case ye:Ut(z,Rt),Ut(tt,Rt),Ut(Fe,Rt),C(Rt,{fX1:0,fX2:1,fY1:0,fY2:1});break;case bn:Ut(ye,Rt),C(Rt,{fX1NDC:0,fY1NDC:0,fX2NDC:1,fY2NDC:1,fBorderSize:0,fInit:1,fShadowColor:1,fCornerRadius:0,fOption:"brNDC",fName:""});break;case rt:C(Rt,{fTextAngle:0,fTextSize:0,fTextAlign:22,fTextColor:1,fTextFont:42});break;case Dn:Ut(bn,Rt),Ut(rt,Rt),C(Rt,{fLabel:"",fLongest:27,fMargin:.05,fLines:Ut(Ge)});break;case $n:Ut(Dn,Rt),C(Rt,{fFillColor:X.fStatColor,fFillStyle:X.fStatStyle,fTextFont:X.fStatFont,fTextSize:X.fStatFontSize,fTextColor:X.fStatTextColor,fBorderSize:X.fStatBorderSize,fOptFit:0,fOptStat:0,fFitFormat:"",fStatFormat:"",fParent:null});break;case ai:Ut(bn,Rt),Ut(rt,Rt),C(Rt,{fColumnSeparation:0,fEntrySeparation:.1,fMargin:.25,fNColumns:1,fPrimitives:Ut(Ge),fName:bn,fBorderSize:X.fLegendBorderSize,fTextFont:X.fLegendFont,fTextSize:X.fLegendTextSize,fFillColor:X.fLegendFillColor});break;case ti:Ut(bn,Rt),C(Rt,{fAxis:Ut(dn),fH:null,fName:bn});break;case Hi:Ut(z,Rt),Ut(rt,Rt),Ut(tt,Rt),Ut(Fe,Rt),Ut(Ne,Rt),C(Rt,{fLabel:"",fObject:null,fOption:"",fTextAlign:0,fTextColor:0,fTextFont:0});break;case ss:Ut(W,Rt),Ut(rt,Rt),C(Rt,{fLimitFactorSize:3,fOriginSize:.04});break;case Bs:Ut(ss,Rt),Ut(tt,Rt),C(Rt,{fX:0,fY:0});break;case we:Ut(z,Rt),C(Rt,{fString:""});break;case Si:Ut(W,Rt),Ut(tt,Rt),Ut(Fe,Rt),Ut(Ne,Rt),C(Rt,{fBits:8,fNcells:0,fXaxis:Ut(ci),fYaxis:Ut(ci),fZaxis:Ut(ci),fFillColor:X.fHistFillColor,fFillStyle:X.fHistFillStyle,fLineColor:X.fHistLineColor,fLineStyle:X.fHistLineStyle,fLineWidth:X.fHistLineWidth,fBarOffset:0,fBarWidth:1e3,fEntries:0,fTsumw:0,fTsumw2:0,fTsumwx:0,fTsumwx2:0,fMaximum:tn,fMinimum:tn,fNormFactor:0,fContour:[],fSumw2:[],fOption:"",fFunctions:Ut(Ge),fBufferSize:0,fBuffer:[],fBinStatErrOpt:0,fStatOverflows:2});break;case bi:case Jn:case"TH1L64":case"TH1F":case"TH1S":case"TH1C":Ut(Si,Rt),Rt.fArray=[];break;case Wi:Ut(Si,Rt),C(Rt,{fScalefactor:1,fTsumwy:0,fTsumwy2:0,fTsumwxy:0});break;case Ln:case"TH2L64":case Rs:case"TH2D":case"TH2S":case"TH2C":Ut(Wi,Rt),Rt.fArray=[];break;case oe:Ut(Si,Rt),C(Rt,{fTsumwy:0,fTsumwy2:0,fTsumwz:0,fTsumwz2:0,fTsumwxy:0,fTsumwxz:0,fTsumwyz:0});break;case"TH3I":case"TH3L64":case"TH3F":case"TH3D":case"TH3S":case"TH3C":Ut(oe,Rt),Rt.fArray=[];break;case St:Ut(W,Rt),C(Rt,{fHists:Ut(Ge),fHistogram:null,fMaximum:tn,fMinimum:tn});break;case pt:Ut(W,Rt),Ut(tt,Rt),Ut(Fe,Rt),Ut(Ne,Rt),C(Rt,{fFunctions:Ut(Ge),fHistogram:null,fMaxSize:0,fMaximum:tn,fMinimum:tn,fNpoints:0,fX:[],fY:[]});break;case"TGraphAsymmErrors":Ut(pt,Rt),C(Rt,{fEXlow:[],fEXhigh:[],fEYlow:[],fEYhigh:[]});break;case st:Ut(W,Rt),C(Rt,{fFunctions:Ut(Ge),fGraphs:Ut(Ge),fHistogram:null,fMaximum:tn,fMinimum:tn});break;case Bn:Ut(W,Rt),Ut(rt,Rt),Ut(tt,Rt),C(Rt,{fRadian:!0,fDegree:!1,fGrad:!1,fPolarLabelColor:1,fRadialLabelColor:1,fAxisAngle:0,fPolarOffset:.04,fPolarTextSize:.04,fRadialOffset:.025,fRadialTextSize:.035,fRwrmin:0,fRwrmax:1,fRwtmin:0,fRwtmax:2*Math.PI,fTickpolarSize:.02,fPolarLabelFont:62,fRadialLabelFont:62,fCutRadial:0,fNdivRad:508,fNdivPol:508});break;case Pe:Ut(z,Rt),Ut(tt,Rt),Ut(Fe,Rt),C(Rt,{fLastPoint:-1,fN:0,fOption:"",fX:null,fY:null});break;case dn:Ut(ge,Rt),Ut(rt,Rt),C(Rt,{fChopt:"",fFunctionName:"",fGridLength:0,fLabelColor:1,fLabelFont:42,fLabelOffset:.005,fLabelSize:.035,fName:"",fNdiv:12,fTickSize:.02,fTimeFormat:"",fTitle:"",fTitleOffset:1,fTitleSize:.035,fWmax:100,fWmin:0});break;case Nt:C(Rt,{fLeftMargin:X.fPadLeftMargin,fRightMargin:X.fPadRightMargin,fBottomMargin:X.fPadBottomMargin,fTopMargin:X.fPadTopMargin,fXfile:2,fYfile:2,fAfile:1,fXstat:.99,fYstat:.99,fAstat:2,fFrameFillColor:X.fFrameFillColor,fFrameFillStyle:X.fFrameFillStyle,fFrameLineColor:X.fFrameLineColor,fFrameLineWidth:X.fFrameLineWidth,fFrameLineStyle:X.fFrameLineStyle,fFrameBorderSize:X.fFrameBorderSize,fFrameBorderMode:X.fFrameBorderMode});break;case nn:Ut(z,Rt),Ut(tt,Rt),Ut(Fe,Rt),Ut(Nt,Rt),C(Rt,{fFillColor:X.fPadColor,fFillStyle:1001,fX1:0,fY1:0,fX2:1,fY2:1,fXtoAbsPixelk:1,fXtoPixelk:1,fXtoPixel:1,fYtoAbsPixelk:1,fYtoPixelk:1,fYtoPixel:1,fUtoAbsPixelk:1,fUtoPixelk:1,fUtoPixel:1,fVtoAbsPixelk:1,fVtoPixelk:1,fVtoPixel:1,fAbsPixeltoXk:1,fPixeltoXk:1,fPixeltoX:1,fAbsPixeltoYk:1,fPixeltoYk:1,fPixeltoY:1,fXlowNDC:0,fYlowNDC:0,fXUpNDC:0,fYUpNDC:0,fWNDC:1,fHNDC:1,fAbsXlowNDC:0,fAbsYlowNDC:0,fAbsWNDC:1,fAbsHNDC:1,fUxmin:0,fUymin:0,fUxmax:0,fUymax:0,fTheta:30,fPhi:30,fAspectRatio:0,fNumber:0,fLogx:X.fOptLogx,fLogy:X.fOptLogy,fLogz:X.fOptLogz,fTickx:X.fPadTickX,fTicky:X.fPadTickY,fPadPaint:0,fCrosshair:0,fCrosshairPos:0,fBorderSize:X.fPadBorderSize,fBorderMode:X.fPadBorderMode,fModified:!1,fGridx:X.fPadGridX,fGridy:X.fPadGridY,fAbsCoord:!1,fEditable:!0,fFixedAspectRatio:!1,fPrimitives:Ut(Ge),fExecs:null,fName:"pad",fTitle:"canvas"});break;case kn:C(Rt,{fXBetween:2,fYBetween:2,fTitleFromTop:1.2,fXdate:.2,fYdate:.3,fAdate:1});break;case hn:Ut(nn,Rt),C(Rt,{fFillColor:X.fCanvasColor,fFillStyle:1001,fNumPaletteColor:0,fNextPaletteColor:0,fDISPLAY:"$DISPLAY",fDoubleBuffer:0,fRetained:!0,fXsizeUser:0,fYsizeUser:0,fXsizeReal:20,fYsizeReal:10,fWindowTopX:0,fWindowTopY:0,fWindowWidth:0,fWindowHeight:0,fBorderSize:X.fCanvasBorderSize,fBorderMode:X.fCanvasBorderMode,fCw:500,fCh:300,fCatt:Ut(kn),kMoveOpaque:!0,kResizeOpaque:!0,fHighLightColor:5,fBatch:!0,kShowEventStatus:!1,kAutoExec:!0,kMenuBar:!0});break;case et:Ut(W,Rt),Ut(tt,Rt),Ut(Fe,Rt),C(Rt,{fGeoAtt:0,fFinder:null,fMedium:null,fNodes:null,fNtotal:0,fNumber:0,fRefCount:0,fShape:null,fVoxels:null});break;case it:Ut(W,Rt),C(Rt,{fGeoAtt:0,fMother:null,fNovlp:0,fNumber:0,fOverlaps:null,fVolume:null});break;case yt:Ut(it,Rt),C(Rt,{fMatrix:null});break;case"TGeoTrack":Ut(z,Rt),Ut(tt,Rt),Ut(Ne,Rt),C(Rt,{fGeoAtt:0,fNpoints:0,fPoints:[]});break;case At:Ut(z,Rt),Ut(tt,Rt),C(Rt,{fLastPoint:-1,fN:0,fOption:"",fP:[]});break;case Vt:Ut(z,Rt),Ut(Ne,Rt),C(Rt,{fLastPoint:-1,fN:0,fName:"",fOption:"",fP:[]})}return Rt._typename=un,I(Rt,un),Rt}function Qe(un,di,Rt,ui){const Pn=Ut(un);if(!Pn.fXaxis||!Pn.fYaxis||!Pn.fZaxis)return null;switch(Pn.fName="hist",Pn.fTitle="title",di&&C(Pn.fXaxis,{fNbins:di,fXmin:0,fXmax:di}),Rt&&C(Pn.fYaxis,{fNbins:Rt,fXmin:0,fXmax:Rt}),ui&&C(Pn.fZaxis,{fNbins:ui,fXmin:0,fXmax:ui}),parseInt(un[2])){case 1:di&&(Pn.fNcells=di+2);break;case 2:di&&Rt&&(Pn.fNcells=(di+2)*(Rt+2));break;case 3:di&&Rt&&ui&&(Pn.fNcells=(di+2)*(Rt+2)*(ui+2))}if(Pn.fNcells>0){switch(un[3]){case"C":Pn.fArray=new Int8Array(Pn.fNcells);break;case"S":Pn.fArray=new Int16Array(Pn.fNcells);break;case"I":Pn.fArray=new Int32Array(Pn.fNcells);break;case"F":Pn.fArray=new Float32Array(Pn.fNcells);break;case"L":case"D":Pn.fArray=new Float64Array(Pn.fNcells);break;default:Pn.fArray=new Array(Pn.fNcells)}Pn.fArray.fill(0)}return Pn}function nt(un,di){if(un)if(di.indexOf(";")<0)un.fTitle=di;else{const Rt=di.split(";");un.fTitle=Rt[0],Rt.length>1&&(un.fXaxis.fTitle=Rt[1]),Rt.length>2&&(un.fYaxis.fTitle=Rt[2]),Rt.length>3&&(un.fZaxis.fTitle=Rt[3])}}function at(un,di){const Rt=Ut(Pe);return un&&(Rt.fN=un,di?(Rt.fX=new Int32Array(un),Rt.fY=new Int32Array(un)):(Rt.fX=new Float32Array(un),Rt.fY=new Float32Array(un))),Rt}function ht(un,di,Rt){const ui=C(Ut(pt),{fBits:1032,fName:"graph",fTitle:"title"});if(un>0){ui.fMaxSize=ui.fNpoints=un;const Pn=qn(di)&&di.length===un,Fn=qn(Rt)&&Rt.length===un;for(let _i=0;_i<un;++_i)ui.fX.push(Pn?di[_i]:_i/un),ui.fY.push(Fn?Rt[_i]:_i/un)}return ui}function Qt(){const un=Ut(St);for(let di=0;di<arguments.length;++di)un.fHists.Add(arguments[di],"");return un}function vn(){const un=Ut(st);for(let di=0;di<arguments.length;++di)un.fGraphs.Add(arguments[di],"");return un}const en={};function jt(un,di){let Rt=en[un];const ui=void 0!==Rt;return ui||(Rt={}),(un===z||un===W||void 0!==di?.fBits)&&typeof Rt.TestBit>"u"&&(Rt.TestBit=function(Pn){return!!(this.fBits&Pn)},Rt.InvertBit=function(Pn){this.fBits=this.fBits^16777215&Pn}),ui||((un===Ge||un===lt)&&(Rt.Clear=function(){this.arr=[],this.opt=[]},Rt.Add=function(Pn,Fn){this.arr.push(Pn),this.opt.push(_r(Fn)?Fn:"")},Rt.AddFirst=function(Pn,Fn){this.arr.unshift(Pn),this.opt.unshift(_r(Fn)?Fn:"")},Rt.RemoveAt=function(Pn){this.arr.splice(Pn,1),this.opt.splice(Pn,1)}),(un===Dn||un===$n)&&(Rt.AddText=function(Pn){const Fn=Ut(Bs);Fn.fTitle=Pn,Fn.fTextAlign=this.fTextAlign,this.fLines.Add(Fn)},Rt.Clear=function(){this.fLines.Clear()}),(0===un.indexOf(D)||un===O)&&(Rt.addFormula=function(Pn){Pn&&(void 0===this.formulas&&(this.formulas=[]),this.formulas.push(Pn))},Rt.GetParName=function(Pn){if(this.fParams?.fParNames)return this.fParams.fParNames[Pn];if(this.fFormula?.fParams)for(let Fn=0,_i=this.fFormula.fParams;Fn<_i.length;++Fn)if(_i[Fn].second===Pn)return _i[Fn].first;return this.fNames&&this.fNames[Pn]?this.fNames[Pn]:`p${Pn}`},Rt.GetParValue=function(Pn){return this.fParams?.fParameters?this.fParams.fParameters[Pn]:this.fFormula?.fClingParameters?this.fFormula.fClingParameters[Pn]:this.fParams?this.fParams[Pn]:void 0},Rt.GetParError=function(Pn){return this.fParErrors?this.fParErrors[Pn]:void 0},Rt.GetNumPars=function(){return this.fNpar}),(0===un.indexOf(pt)||un===vt)&&un!==Bn&&un!==Mn&&(Rt.IsInside=function(Pn,Fn){const _i=this.fX,Dr=this.fY;let gs=0,Qr=this.fNpoints-1,ro=!1;for(;gs<this.fNpoints;++gs)(Dr[gs]<Fn&&Dr[Qr]>=Fn||Dr[Qr]<Fn&&Dr[gs]>=Fn)&&_i[gs]+(Fn-Dr[gs])/(Dr[Qr]-Dr[gs])*(_i[Qr]-_i[gs])<Pn&&(ro=!ro),Qr=gs;return ro}),(0===un.indexOf(Si)||0===un.indexOf(Wi)||0===un.indexOf(oe))&&(Rt.getBinError=function(Pn){return Pn>=this.fNcells&&(Pn=this.fNcells-1),Pn<0&&(Pn=0),Pn<this.fSumw2.length?Math.sqrt(this.fSumw2[Pn]):Math.sqrt(Math.abs(this.fArray[Pn]))},Rt.setBinContent=function(Pn,Fn){this.fEntries++,this.fTsumw=0,Pn>=0&&Pn<this.fArray.length&&(this.fArray[Pn]=Fn)}),0===un.indexOf(Si)&&(Rt.getBin=function(Pn){return Pn},Rt.getBinContent=function(Pn){return this.fArray[Pn]},Rt.Fill=function(Pn,Fn){const _i=this.fXaxis,Dr=Math.max(0,1+Math.min(_i.fNbins,Math.floor((Pn-_i.fXmin)/(_i.fXmax-_i.fXmin)*_i.fNbins)));this.fArray[Dr]+=Fn??1,this.fEntries++}),0===un.indexOf(Wi)&&(Rt.getBin=function(Pn,Fn){return Pn+(this.fXaxis.fNbins+2)*Fn},Rt.getBinContent=function(Pn,Fn){return this.fArray[this.getBin(Pn,Fn)]},Rt.Fill=function(Pn,Fn,_i){const Dr=this.fXaxis,gs=this.fYaxis,Qr=Math.max(0,1+Math.min(Dr.fNbins,Math.floor((Pn-Dr.fXmin)/(Dr.fXmax-Dr.fXmin)*Dr.fNbins))),ro=Math.max(0,1+Math.min(gs.fNbins,Math.floor((Fn-gs.fXmin)/(gs.fXmax-gs.fXmin)*gs.fNbins)));this.fArray[Qr+(Dr.fNbins+2)*ro]+=_i??1,this.fEntries++}),0===un.indexOf(oe)&&(Rt.getBin=function(Pn,Fn,_i){return Pn+(this.fXaxis.fNbins+2)*(Fn+(this.fYaxis.fNbins+2)*_i)},Rt.getBinContent=function(Pn,Fn,_i){return this.fArray[this.getBin(Pn,Fn,_i)]},Rt.Fill=function(Pn,Fn,_i,Dr){const gs=this.fXaxis,Qr=this.fYaxis,ro=this.fZaxis,Zs=Math.max(0,1+Math.min(gs.fNbins,Math.floor((Pn-gs.fXmin)/(gs.fXmax-gs.fXmin)*gs.fNbins))),qi=Math.max(0,1+Math.min(Qr.fNbins,Math.floor((Fn-Qr.fXmin)/(Qr.fXmax-Qr.fXmin)*Qr.fNbins))),Uo=Math.max(0,1+Math.min(ro.fNbins,Math.floor((_i-ro.fXmin)/(ro.fXmax-ro.fXmin)*ro.fNbins)));this.fArray[Zs+(gs.fNbins+2)*(qi+(Qr.fNbins+2)*Uo)]+=Dr??1,this.fEntries++}),(un===nn||un===hn)&&(Rt.Divide=function(Pn,Fn,_i=.01,Dr=.01){if(!Fn){const Zs=Pn;if(Zs<2)return this;(Pn=Fn=Math.round(Math.sqrt(Zs)))*Fn<Zs&&(Pn+=1)}if(Pn*Fn<2)return 0;this.fPrimitives.Clear();const gs=1/Fn,Qr=1/Pn;let ro=0;for(let Zs=0;Zs<Fn;Zs++){const qi=1-Zs*gs-Dr;let Uo=qi-gs+2*Dr;if(Uo<0&&(Uo=0),!(Uo>qi))for(let ra=0;ra<Pn;ra++){const ic=ra*Qr+_i,jh=ic+Qr-2*_i;if(ic>jh)continue;ro++;const rc=Ut(nn);rc.fName=rc.fTitle=`${this.fName}_${ro}`,rc.fNumber=ro,this._typename!==hn?(rc.fAbsWNDC=(jh-ic)*this.fAbsWNDC,rc.fAbsHNDC=(qi-Uo)*this.fAbsHNDC,rc.fAbsXlowNDC=this.fAbsXlowNDC+ic*this.fAbsWNDC,rc.fAbsYlowNDC=this.fAbsYlowNDC+Uo*this.fAbsWNDC):(rc.fAbsWNDC=jh-ic,rc.fAbsHNDC=qi-Uo,rc.fAbsXlowNDC=ic,rc.fAbsYlowNDC=Uo),this.fPrimitives.Add(rc)}}return Pn*Fn},Rt.GetPad=function(Pn){return this.fPrimitives.arr.find(Fn=>Fn._typename===nn&&Fn.fNumber===Pn)}),0===un.indexOf(_e)&&(un===$e?(Rt.getBin=function(Pn,Fn,_i){return Pn+(this.fXaxis.fNbins+2)*(Fn+(this.fYaxis.fNbins+2)*_i)},Rt.getBinContent=function(Pn,Fn,_i){const Dr=this.getBin(Pn,Fn,_i);return Dr<0||Dr>=this.fNcells||this.fBinEntries[Dr]<1e-300?0:this.fArray?this.fArray[Dr]/this.fBinEntries[Dr]:0},Rt.getBinEntries=function(Pn,Fn,_i){const Dr=this.getBin(Pn,Fn,_i);return Dr<0||Dr>=this.fNcells?0:this.fBinEntries[Dr]}):un===Oe?(Rt.getBin=function(Pn,Fn){return Pn+(this.fXaxis.fNbins+2)*Fn},Rt.getBinContent=function(Pn,Fn){const _i=this.getBin(Pn,Fn);return _i<0||_i>=this.fNcells||this.fBinEntries[_i]<1e-300||!this.fArray?0:this.fArray[_i]/this.fBinEntries[_i]},Rt.getBinEntries=function(Pn,Fn){const _i=this.getBin(Pn,Fn);return _i<0||_i>=this.fNcells?0:this.fBinEntries[_i]}):(Rt.getBin=function(Pn){return Pn},Rt.getBinContent=function(Pn){return Pn<0||Pn>=this.fNcells||this.fBinEntries[Pn]<1e-300||!this.fArray?0:this.fArray[Pn]/this.fBinEntries[Pn]}),Rt.getBinEffectiveEntries=function(Pn){if(Pn<0||Pn>=this.fNcells)return 0;const Fn=this.fBinEntries[Pn];if(!this.fBinSumw2||this.fBinSumw2.length!==this.fNcells)return Fn;const _i=this.fBinSumw2[Pn];return _i>0?Fn*Fn/_i:0},Rt.getBinError=function(Pn){if(Pn<0||Pn>=this.fNcells)return 0;const Fn=this.fArray[Pn],_i=this.fBinEntries[Pn],Dr=this.fSumw2[Pn],gs=this.getBinEffectiveEntries(Pn);if(_i<1e-300)return 0;if(3===this.fErrorMode)return 1/Math.sqrt(_i);const Zs=Math.sqrt(Math.abs(Dr/_i-(Fn/_i)**2));return 2===this.fErrorMode?0!==Zs?Zs/Math.sqrt(gs):1/Math.sqrt(12*gs):1===this.fErrorMode?Zs:Zs/Math.sqrt(gs)}),un===ci&&(Rt.GetBinLowEdge=function(Pn){return this.fNbins<=0?0:this.fXbins.length>0&&Pn>0&&Pn<=this.fNbins?this.fXbins[Pn-1]:this.fXmin+(Pn-1)*(this.fXmax-this.fXmin)/this.fNbins},Rt.GetBinCenter=function(Pn){return this.fNbins<=0?0:this.fXbins.length>0&&Pn>0&&Pn<this.fNbins?(this.fXbins[Pn-1]+this.fXbins[Pn])/2:this.fXmin+(Pn-.5)*(this.fXmax-this.fXmin)/this.fNbins}),0===un.indexOf("ROOT::Math::LorentzVector")&&(Rt.Px=Rt.X=function(){return this.fCoordinates.Px()},Rt.Py=Rt.Y=function(){return this.fCoordinates.Py()},Rt.Pz=Rt.Z=function(){return this.fCoordinates.Pz()},Rt.E=Rt.T=function(){return this.fCoordinates.E()},Rt.M2=function(){return this.fCoordinates.M2()},Rt.M=function(){return this.fCoordinates.M()},Rt.R=Rt.P=function(){return this.fCoordinates.R()},Rt.P2=function(){return this.P()*this.P()},Rt.Pt=Rt.pt=function(){return Math.sqrt(this.P2())},Rt.Phi=Rt.phi=function(){return Math.atan2(this.fCoordinates.Py(),this.fCoordinates.Px())},Rt.Eta=Rt.eta=function(){return Math.atanh(this.Pz()/this.P())}),0===un.indexOf("ROOT::Math::PxPyPzE4D")&&(Rt.Px=Rt.X=function(){return this.fX},Rt.Py=Rt.Y=function(){return this.fY},Rt.Pz=Rt.Z=function(){return this.fZ},Rt.E=Rt.T=function(){return this.fT},Rt.P2=function(){return this.fX**2+this.fY**2+this.fZ**2},Rt.R=Rt.P=function(){return Math.sqrt(this.P2())},Rt.Mag2=Rt.M2=function(){return this.fT**2-this.fX**2-this.fY**2-this.fZ**2},Rt.Mag=Rt.M=function(){return this.M2()>=0?Math.sqrt(this.M2()):-Math.sqrt(-this.M2())},Rt.Perp2=Rt.Pt2=function(){return this.fX**2+this.fY**2},Rt.Pt=Rt.pt=function(){return Math.sqrt(this.P2())},Rt.Phi=Rt.phi=function(){return Math.atan2(this.fY,this.fX)},Rt.Eta=Rt.eta=function(){return Math.atanh(this.Pz/this.P())}),en[un]=Rt),Rt}function fn(un,di){en[un]=di}function Gn(un,di){if(qn(un)){if(un.$kind===Ge||un.$kind===te)return!0;di||(di=un._typename)}return di===Ge||di===lt||di===bt||di===te||di===Je}function qn(un){return un&&"object"==typeof un}function Vi(un){return"function"==typeof un}function _r(un){return"string"==typeof un}function Ni(un){return qn(un)&&Vi(un.then)}function Kr(un,di){return new Promise(Rt=>{setTimeout(()=>{const ui=Vi(un)?un():un;Rt(ui)},di)})}function os(un){return Ni(un)?un:Promise.resolve(un)}function ia(){return Vs.apply(this,arguments)}function Vs(){return(Vs=(0,Ee.A)(function*(){return(globalThis.JSROOT?Promise.resolve(!0):E(Ze+"scripts/JSRoot.core.js")).then(()=>{if(globalThis.JSROOT?._complete_loading)return globalThis.JSROOT._complete_loading()}).then(()=>globalThis.JSROOT)})).apply(this,arguments)}X.fXaxis=Ut(In),X.fYaxis=Ut(In),X.fZaxis=Ut(In)},8362:(Yr,mt,Se)=>{"use strict";function x(y,V,Ae){y.prototype=V.prototype=Ae,Ae.constructor=y}function L(y,V){var Ae=Object.create(y.prototype);for(var be in V)Ae[be]=V[be];return Ae}function ve(){}Se.d(mt,{$E:()=>_A,DC:()=>jg,D_:()=>wh,F6:()=>sn,JL:()=>xv,JQ:()=>hn,Lt:()=>Xh,Qh:()=>f,Wn:()=>ko,ZE:()=>sf,aL:()=>Xg,aX:()=>SA,m4:()=>Dl,w7:()=>Ph,yW:()=>A});var ot=1/.7,Ye="\\s*([+-]?\\d+)\\s*",Ze="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Re="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",He=/^#([0-9a-f]{3,8})$/,Ve=new RegExp(`^rgb\\(${Ye},${Ye},${Ye}\\)$`),De=new RegExp(`^rgb\\(${Re},${Re},${Re}\\)$`),F=new RegExp(`^rgba\\(${Ye},${Ye},${Ye},${Ze}\\)$`),J=new RegExp(`^rgba\\(${Re},${Re},${Re},${Ze}\\)$`),Y=new RegExp(`^hsl\\(${Ze},${Re},${Re}\\)$`),ue=new RegExp(`^hsla\\(${Ze},${Re},${Re},${Ze}\\)$`),Q={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function me(){return this.rgb().formatHex()}function $(){return this.rgb().formatRgb()}function A(y){var V,Ae;return y=(y+"").trim().toLowerCase(),(V=He.exec(y))?(Ae=V[1].length,V=parseInt(V[1],16),6===Ae?E(V):3===Ae?new C(V>>8&15|V>>4&240,V>>4&15|240&V,(15&V)<<4|15&V,1):8===Ae?g(V>>24&255,V>>16&255,V>>8&255,(255&V)/255):4===Ae?g(V>>12&15|V>>8&240,V>>8&15|V>>4&240,V>>4&15|240&V,((15&V)<<4|15&V)/255):null):(V=Ve.exec(y))?new C(V[1],V[2],V[3],1):(V=De.exec(y))?new C(255*V[1]/100,255*V[2]/100,255*V[3]/100,1):(V=F.exec(y))?g(V[1],V[2],V[3],V[4]):(V=J.exec(y))?g(255*V[1]/100,255*V[2]/100,255*V[3]/100,V[4]):(V=Y.exec(y))?G(V[1],V[2]/100,V[3]/100,1):(V=ue.exec(y))?G(V[1],V[2]/100,V[3]/100,V[4]):Q.hasOwnProperty(y)?E(Q[y]):"transparent"===y?new C(NaN,NaN,NaN,0):null}function E(y){return new C(y>>16&255,y>>8&255,255&y,1)}function g(y,V,Ae,be){return be<=0&&(y=V=Ae=NaN),new C(y,V,Ae,be)}function v(y){return y instanceof ve||(y=A(y)),y?new C((y=y.rgb()).r,y.g,y.b,y.opacity):new C}function f(y,V,Ae,be){return 1===arguments.length?v(y):new C(y,V,Ae,be??1)}function C(y,V,Ae,be){this.r=+y,this.g=+V,this.b=+Ae,this.opacity=+be}function I(){return`#${he(this.r)}${he(this.g)}${he(this.b)}`}function k(){const y=Z(this.opacity);return`${1===y?"rgb(":"rgba("}${ee(this.r)}, ${ee(this.g)}, ${ee(this.b)}${1===y?")":`, ${y})`}`}function Z(y){return isNaN(y)?1:Math.max(0,Math.min(1,y))}function ee(y){return Math.max(0,Math.min(255,Math.round(y)||0))}function he(y){return((y=ee(y))<16?"0":"")+y.toString(16)}function G(y,V,Ae,be){return be<=0?y=V=Ae=NaN:Ae<=0||Ae>=1?y=V=NaN:V<=0&&(y=NaN),new T(y,V,Ae,be)}function b(y){if(y instanceof T)return new T(y.h,y.s,y.l,y.opacity);if(y instanceof ve||(y=A(y)),!y)return new T;if(y instanceof T)return y;var V=(y=y.rgb()).r/255,Ae=y.g/255,be=y.b/255,Xe=Math.min(V,Ae,be),ut=Math.max(V,Ae,be),_t=NaN,Tt=ut-Xe,Gt=(ut+Xe)/2;return Tt?(_t=V===ut?(Ae-be)/Tt+6*(Ae<be):Ae===ut?(be-V)/Tt+2:(V-Ae)/Tt+4,Tt/=Gt<.5?ut+Xe:2-ut-Xe,_t*=60):Tt=Gt>0&&Gt<1?0:_t,new T(_t,Tt,Gt,y.opacity)}function T(y,V,Ae,be){this.h=+y,this.s=+V,this.l=+Ae,this.opacity=+be}function z(y){return(y=(y||0)%360)<0?y+360:y}function W(y){return Math.max(0,Math.min(1,y||0))}function fe(y,V,Ae){return 255*(y<60?V+(Ae-V)*y/60:y<180?Ae:y<240?V+(Ae-V)*(240-y)/60:V)}x(ve,A,{copy(y){return Object.assign(new this.constructor,this,y)},displayable(){return this.rgb().displayable()},hex:me,formatHex:me,formatHex8:function X(){return this.rgb().formatHex8()},formatHsl:function B(){return b(this).formatHsl()},formatRgb:$,toString:$}),x(C,f,L(ve,{brighter(y){return y=null==y?ot:Math.pow(ot,y),new C(this.r*y,this.g*y,this.b*y,this.opacity)},darker(y){return y=null==y?.7:Math.pow(.7,y),new C(this.r*y,this.g*y,this.b*y,this.opacity)},rgb(){return this},clamp(){return new C(ee(this.r),ee(this.g),ee(this.b),Z(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:I,formatHex:I,formatHex8:function U(){return`#${he(this.r)}${he(this.g)}${he(this.b)}${he(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:k,toString:k})),x(T,function P(y,V,Ae,be){return 1===arguments.length?b(y):new T(y,V,Ae,be??1)},L(ve,{brighter(y){return y=null==y?ot:Math.pow(ot,y),new T(this.h,this.s,this.l*y,this.opacity)},darker(y){return y=null==y?.7:Math.pow(.7,y),new T(this.h,this.s,this.l*y,this.opacity)},rgb(){var y=this.h%360+360*(this.h<0),V=isNaN(y)||isNaN(this.s)?0:this.s,Ae=this.l,be=Ae+(Ae<.5?Ae:1-Ae)*V,Xe=2*Ae-be;return new C(fe(y>=240?y-240:y+120,Xe,be),fe(y,Xe,be),fe(y<120?y+240:y-120,Xe,be),this.opacity)},clamp(){return new T(z(this.h),W(this.s),W(this.l),Z(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const y=Z(this.opacity);return`${1===y?"hsl(":"hsla("}${z(this.h)}, ${100*W(this.s)}%, ${100*W(this.l)}%${1===y?")":`, ${y})`}`}}));const we=Math.PI/180,Me=180/Math.PI,Ge=.96422,lt=1,bt=.82521,te=4/29,Je=6/29,tt=3*Je*Je,Fe=Je*Je*Je;function Ne(y){if(y instanceof pt)return new pt(y.l,y.a,y.b,y.opacity);if(y instanceof bn)return Dn(y);y instanceof C||(y=v(y));var ut,_t,V=qt(y.r),Ae=qt(y.g),be=qt(y.b),Xe=st((.2225045*V+.7168786*Ae+.0606169*be)/lt);return V===Ae&&Ae===be?ut=_t=Xe:(ut=st((.4360747*V+.3850649*Ae+.1430804*be)/Ge),_t=st((.0139322*V+.0971045*Ae+.7141733*be)/bt)),new pt(116*Xe-16,500*(ut-Xe),200*(Xe-_t),y.opacity)}function pt(y,V,Ae,be){this.l=+y,this.a=+V,this.b=+Ae,this.opacity=+be}function st(y){return y>Fe?Math.pow(y,1/3):y/tt+te}function vt(y){return y>Je?y*y*y:tt*(y-te)}function Yt(y){return 255*(y<=.0031308?12.92*y:1.055*Math.pow(y,1/2.4)-.055)}function qt(y){return(y/=255)<=.04045?y/12.92:Math.pow((y+.055)/1.055,2.4)}function bn(y,V,Ae,be){this.h=+y,this.c=+V,this.l=+Ae,this.opacity=+be}function Dn(y){if(isNaN(y.h))return new pt(y.l,0,0,y.opacity);var V=y.h*we;return new pt(y.l,Math.cos(V)*y.c,Math.sin(V)*y.c,y.opacity)}x(pt,function St(y,V,Ae,be){return 1===arguments.length?Ne(y):new pt(y,V,Ae,be??1)},L(ve,{brighter(y){return new pt(this.l+18*(y??1),this.a,this.b,this.opacity)},darker(y){return new pt(this.l-18*(y??1),this.a,this.b,this.opacity)},rgb(){var y=(this.l+16)/116,V=isNaN(this.a)?y:y+this.a/500,Ae=isNaN(this.b)?y:y-this.b/200;return new C(Yt(3.1338561*(V=Ge*vt(V))-1.6168667*(y=lt*vt(y))-.4906146*(Ae=bt*vt(Ae))),Yt(-.9787684*V+1.9161415*y+.033454*Ae),Yt(.0719453*V-.2289914*y+1.4052427*Ae),this.opacity)}})),x(bn,function Mn(y,V,Ae,be){return 1===arguments.length?function Ot(y){if(y instanceof bn)return new bn(y.h,y.c,y.l,y.opacity);if(y instanceof pt||(y=Ne(y)),0===y.a&&0===y.b)return new bn(NaN,0<y.l&&y.l<100?0:NaN,y.l,y.opacity);var V=Math.atan2(y.b,y.a)*Me;return new bn(V<0?V+360:V,Math.sqrt(y.a*y.a+y.b*y.b),y.l,y.opacity)}(y):new bn(y,V,Ae,be??1)},L(ve,{brighter(y){return new bn(this.h,this.c,this.l+18*(y??1),this.opacity)},darker(y){return new bn(this.h,this.c,this.l-18*(y??1),this.opacity)},rgb(){return Dn(this).rgb()}}));var Cn=1.78277,yn=-.29227,Sn=-.90649,ii=1.97294,ai=ii*Sn,Hi=ii*Cn,ti=Cn*yn- -.14861*Sn;function Bs(y,V,Ae,be){this.h=+y,this.s=+V,this.l=+Ae,this.opacity=+be}x(Bs,function ss(y,V,Ae,be){return 1===arguments.length?function Nr(y){if(y instanceof Bs)return new Bs(y.h,y.s,y.l,y.opacity);y instanceof C||(y=v(y));var Ae=y.g/255,be=y.b/255,Xe=(ti*be+ai*(y.r/255)-Hi*Ae)/(ti+ai-Hi),ut=be-Xe,_t=(ii*(Ae-Xe)-yn*ut)/Sn,Tt=Math.sqrt(_t*_t+ut*ut)/(ii*Xe*(1-Xe)),Gt=Tt?Math.atan2(_t,ut)*Me-120:NaN;return new Bs(Gt<0?Gt+360:Gt,Tt,Xe,y.opacity)}(y):new Bs(y,V,Ae,be??1)},L(ve,{brighter(y){return y=null==y?ot:Math.pow(ot,y),new Bs(this.h,this.s,this.l*y,this.opacity)},darker(y){return y=null==y?.7:Math.pow(.7,y),new Bs(this.h,this.s,this.l*y,this.opacity)},rgb(){var y=isNaN(this.h)?0:(this.h+120)*we,V=+this.l,Ae=isNaN(this.s)?0:this.s*V*(1-V),be=Math.cos(y),Xe=Math.sin(y);return new C(255*(V+Ae*(-.14861*be+Cn*Xe)),255*(V+Ae*(yn*be+Sn*Xe)),255*(V+Ae*(ii*be)),this.opacity)}}));var yo=Math.abs,xt=Math.cos,K=Math.sin,ge=Math.PI,ye=ge/2,Pe=2*ge,At=Math.max,Vt=1e-12;function Nt(y,V){return Array.from({length:V-y},(Ae,be)=>y+be)}function hn(){return function In(y,V){var Ae=0,be=null,Xe=null,ut=null;function _t(Tt){var kr,Gt=Tt.length,Wt=new Array(Gt),pn=Nt(0,Gt),Qn=new Array(Gt*Gt),Wn=new Array(Gt),Ei=0;Tt=Float64Array.from({length:Gt*Gt},V?(pr,wr)=>Tt[wr%Gt][wr/Gt|0]:(pr,wr)=>Tt[wr/Gt|0][wr%Gt]);for(let pr=0;pr<Gt;++pr){let wr=0;for(let Ts=0;Ts<Gt;++Ts)wr+=Tt[pr*Gt+Ts]+y*Tt[Ts*Gt+pr];Ei+=Wt[pr]=wr}kr=(Ei=At(0,Pe-Ae*Gt)/Ei)?Ae:Pe/Gt;{let pr=0;be&&pn.sort((wr,Ts)=>be(Wt[wr],Wt[Ts]));for(const wr of pn){const Ts=pr;if(y){const jo=Nt(1+~Gt,Gt).filter(qr=>qr<0?Tt[~qr*Gt+wr]:Tt[wr*Gt+qr]);Xe&&jo.sort((qr,nr)=>Xe(qr<0?-Tt[~qr*Gt+wr]:Tt[wr*Gt+qr],nr<0?-Tt[~nr*Gt+wr]:Tt[wr*Gt+nr]));for(const qr of jo)qr<0?(Qn[~qr*Gt+wr]||(Qn[~qr*Gt+wr]={source:null,target:null})).target={index:wr,startAngle:pr,endAngle:pr+=Tt[~qr*Gt+wr]*Ei,value:Tt[~qr*Gt+wr]}:(Qn[wr*Gt+qr]||(Qn[wr*Gt+qr]={source:null,target:null})).source={index:wr,startAngle:pr,endAngle:pr+=Tt[wr*Gt+qr]*Ei,value:Tt[wr*Gt+qr]};Wn[wr]={index:wr,startAngle:Ts,endAngle:pr,value:Wt[wr]}}else{const jo=Nt(0,Gt).filter(qr=>Tt[wr*Gt+qr]||Tt[qr*Gt+wr]);Xe&&jo.sort((qr,nr)=>Xe(Tt[wr*Gt+qr],Tt[wr*Gt+nr]));for(const qr of jo){let nr;if(wr<qr?(nr=Qn[wr*Gt+qr]||(Qn[wr*Gt+qr]={source:null,target:null}),nr.source={index:wr,startAngle:pr,endAngle:pr+=Tt[wr*Gt+qr]*Ei,value:Tt[wr*Gt+qr]}):(nr=Qn[qr*Gt+wr]||(Qn[qr*Gt+wr]={source:null,target:null}),nr.target={index:wr,startAngle:pr,endAngle:pr+=Tt[wr*Gt+qr]*Ei,value:Tt[wr*Gt+qr]},wr===qr&&(nr.source=nr.target)),nr.source&&nr.target&&nr.source.value<nr.target.value){const Xs=nr.source;nr.source=nr.target,nr.target=Xs}}Wn[wr]={index:wr,startAngle:Ts,endAngle:pr,value:Wt[wr]}}pr+=kr}}return(Qn=Object.values(Qn)).groups=Wn,ut?Qn.sort(ut):Qn}return _t.padAngle=function(Tt){return arguments.length?(Ae=At(0,Tt),_t):Ae},_t.sortGroups=function(Tt){return arguments.length?(be=Tt,_t):be},_t.sortSubgroups=function(Tt){return arguments.length?(Xe=Tt,_t):Xe},_t.sortChords=function(Tt){return arguments.length?(null==Tt?ut=null:(ut=function nn(y){return function(V,Ae){return y(V.source.value+V.target.value,Ae.source.value+Ae.target.value)}}(Tt))._=Tt,_t):ut&&ut._},_t}(!1,!1)}const ci=Math.PI,Pi=2*ci,Si=1e-6,bi=Pi-Si;function Jn(y){this._+=y[0];for(let V=1,Ae=y.length;V<Ae;++V)this._+=arguments[V]+y[V]}class Ln{constructor(V){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==V?Jn:function Wi(y){let V=Math.floor(y);if(!(V>=0))throw new Error(`invalid digits: ${y}`);if(V>15)return Jn;const Ae=10**V;return function(be){this._+=be[0];for(let Xe=1,ut=be.length;Xe<ut;++Xe)this._+=Math.round(arguments[Xe]*Ae)/Ae+be[Xe]}}(V)}moveTo(V,Ae){this._append`M${this._x0=this._x1=+V},${this._y0=this._y1=+Ae}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(V,Ae){this._append`L${this._x1=+V},${this._y1=+Ae}`}quadraticCurveTo(V,Ae,be,Xe){this._append`Q${+V},${+Ae},${this._x1=+be},${this._y1=+Xe}`}bezierCurveTo(V,Ae,be,Xe,ut,_t){this._append`C${+V},${+Ae},${+be},${+Xe},${this._x1=+ut},${this._y1=+_t}`}arcTo(V,Ae,be,Xe,ut){if(V=+V,Ae=+Ae,be=+be,Xe=+Xe,(ut=+ut)<0)throw new Error(`negative radius: ${ut}`);let _t=this._x1,Tt=this._y1,Gt=be-V,Wt=Xe-Ae,pn=_t-V,Qn=Tt-Ae,Wn=pn*pn+Qn*Qn;if(null===this._x1)this._append`M${this._x1=V},${this._y1=Ae}`;else if(Wn>Si)if(Math.abs(Qn*Gt-Wt*pn)>Si&&ut){let Ei=be-_t,kr=Xe-Tt,pr=Gt*Gt+Wt*Wt,wr=Ei*Ei+kr*kr,Ts=Math.sqrt(pr),jo=Math.sqrt(Wn),qr=ut*Math.tan((ci-Math.acos((pr+Wn-wr)/(2*Ts*jo)))/2),nr=qr/jo,Xs=qr/Ts;Math.abs(nr-1)>Si&&this._append`L${V+nr*pn},${Ae+nr*Qn}`,this._append`A${ut},${ut},0,0,${+(Qn*Ei>pn*kr)},${this._x1=V+Xs*Gt},${this._y1=Ae+Xs*Wt}`}else this._append`L${this._x1=V},${this._y1=Ae}`}arc(V,Ae,be,Xe,ut,_t){if(V=+V,Ae=+Ae,_t=!!_t,(be=+be)<0)throw new Error(`negative radius: ${be}`);let Tt=be*Math.cos(Xe),Gt=be*Math.sin(Xe),Wt=V+Tt,pn=Ae+Gt,Qn=1^_t,Wn=_t?Xe-ut:ut-Xe;null===this._x1?this._append`M${Wt},${pn}`:(Math.abs(this._x1-Wt)>Si||Math.abs(this._y1-pn)>Si)&&this._append`L${Wt},${pn}`,be&&(Wn<0&&(Wn=Wn%Pi+Pi),Wn>bi?this._append`A${be},${be},0,1,${Qn},${V-Tt},${Ae-Gt}A${be},${be},0,1,${Qn},${this._x1=Wt},${this._y1=pn}`:Wn>Si&&this._append`A${be},${be},0,${+(Wn>=ci)},${Qn},${this._x1=V+be*Math.cos(ut)},${this._y1=Ae+be*Math.sin(ut)}`)}rect(V,Ae,be,Xe){this._append`M${this._x0=this._x1=+V},${this._y0=this._y1=+Ae}h${be=+be}v${+Xe}h${-be}Z`}toString(){return this._}}function Rs(){return new Ln}Rs.prototype=Ln.prototype;var oe=Array.prototype.slice;function D(y){return function(){return y}}function O(y){return y.source}function ie(y){return y.target}function _e(y){return y.radius}function Oe(y){return y.startAngle}function $e(y){return y.endAngle}function et(){return 0}function sn(){return function yt(y){var V=O,Ae=ie,be=_e,Xe=_e,ut=Oe,_t=$e,Tt=et,Gt=null;function Wt(){var pn,Qn=V.apply(this,arguments),Wn=Ae.apply(this,arguments),Ei=Tt.apply(this,arguments)/2,kr=oe.call(arguments),pr=+be.apply(this,(kr[0]=Qn,kr)),wr=ut.apply(this,kr)-ye,Ts=_t.apply(this,kr)-ye,jo=+Xe.apply(this,(kr[0]=Wn,kr)),qr=ut.apply(this,kr)-ye,nr=_t.apply(this,kr)-ye;if(Gt||(Gt=pn=Rs()),Ei>Vt&&(yo(Ts-wr)>2*Ei+Vt?Ts>wr?(wr+=Ei,Ts-=Ei):(wr-=Ei,Ts+=Ei):wr=Ts=(wr+Ts)/2,yo(nr-qr)>2*Ei+Vt?nr>qr?(qr+=Ei,nr-=Ei):(qr-=Ei,nr+=Ei):qr=nr=(qr+nr)/2),Gt.moveTo(pr*xt(wr),pr*K(wr)),Gt.arc(0,0,pr,wr,Ts),wr!==qr||Ts!==nr)if(y){var bs=jo-+y.apply(this,arguments),Go=(qr+nr)/2;Gt.quadraticCurveTo(0,0,bs*xt(qr),bs*K(qr)),Gt.lineTo(jo*xt(Go),jo*K(Go)),Gt.lineTo(bs*xt(nr),bs*K(nr))}else Gt.quadraticCurveTo(0,0,jo*xt(qr),jo*K(qr)),Gt.arc(0,0,jo,qr,nr);if(Gt.quadraticCurveTo(0,0,pr*xt(wr),pr*K(wr)),Gt.closePath(),pn)return Gt=null,pn+""||null}return y&&(Wt.headRadius=function(pn){return arguments.length?(y="function"==typeof pn?pn:D(+pn),Wt):y}),Wt.radius=function(pn){return arguments.length?(be=Xe="function"==typeof pn?pn:D(+pn),Wt):be},Wt.sourceRadius=function(pn){return arguments.length?(be="function"==typeof pn?pn:D(+pn),Wt):be},Wt.targetRadius=function(pn){return arguments.length?(Xe="function"==typeof pn?pn:D(+pn),Wt):Xe},Wt.startAngle=function(pn){return arguments.length?(ut="function"==typeof pn?pn:D(+pn),Wt):ut},Wt.endAngle=function(pn){return arguments.length?(_t="function"==typeof pn?pn:D(+pn),Wt):_t},Wt.padAngle=function(pn){return arguments.length?(Tt="function"==typeof pn?pn:D(+pn),Wt):Tt},Wt.source=function(pn){return arguments.length?(V=pn,Wt):V},Wt.target=function(pn){return arguments.length?(Ae=pn,Wt):Ae},Wt.context=function(pn){return arguments.length?(Gt=pn??null,Wt):Gt},Wt}()}var xn={value:()=>{}};function wn(){for(var be,y=0,V=arguments.length,Ae={};y<V;++y){if(!(be=arguments[y]+"")||be in Ae||/[\s.]/.test(be))throw new Error("illegal type: "+be);Ae[be]=[]}return new Ut(Ae)}function Ut(y){this._=y}function nt(y,V){for(var Xe,Ae=0,be=y.length;Ae<be;++Ae)if((Xe=y[Ae]).name===V)return Xe.value}function at(y,V,Ae){for(var be=0,Xe=y.length;be<Xe;++be)if(y[be].name===V){y[be]=xn,y=y.slice(0,be).concat(y.slice(be+1));break}return null!=Ae&&y.push({name:V,value:Ae}),y}Ut.prototype=wn.prototype={constructor:Ut,on:function(y,V){var Xe,Ae=this._,be=function Qe(y,V){return y.trim().split(/^|\s+/).map(function(Ae){var be="",Xe=Ae.indexOf(".");if(Xe>=0&&(be=Ae.slice(Xe+1),Ae=Ae.slice(0,Xe)),Ae&&!V.hasOwnProperty(Ae))throw new Error("unknown type: "+Ae);return{type:Ae,name:be}})}(y+"",Ae),ut=-1,_t=be.length;if(!(arguments.length<2)){if(null!=V&&"function"!=typeof V)throw new Error("invalid callback: "+V);for(;++ut<_t;)if(Xe=(y=be[ut]).type)Ae[Xe]=at(Ae[Xe],y.name,V);else if(null==V)for(Xe in Ae)Ae[Xe]=at(Ae[Xe],y.name,null);return this}for(;++ut<_t;)if((Xe=(y=be[ut]).type)&&(Xe=nt(Ae[Xe],y.name)))return Xe},copy:function(){var y={},V=this._;for(var Ae in V)y[Ae]=V[Ae].slice();return new Ut(y)},call:function(y,V){if((Xe=arguments.length-2)>0)for(var Xe,ut,Ae=new Array(Xe),be=0;be<Xe;++be)Ae[be]=arguments[be+2];if(!this._.hasOwnProperty(y))throw new Error("unknown type: "+y);for(be=0,Xe=(ut=this._[y]).length;be<Xe;++be)ut[be].value.apply(V,Ae)},apply:function(y,V,Ae){if(!this._.hasOwnProperty(y))throw new Error("unknown type: "+y);for(var be=this._[y],Xe=0,ut=be.length;Xe<ut;++Xe)be[Xe].value.apply(V,Ae)}};var ht="http://www.w3.org/1999/xhtml",Qt={svg:"http://www.w3.org/2000/svg",xhtml:ht,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function vn(y){var V=y+="",Ae=V.indexOf(":");return Ae>=0&&"xmlns"!==(V=y.slice(0,Ae))&&(y=y.slice(Ae+1)),Qt.hasOwnProperty(V)?{space:Qt[V],local:y}:y}function en(y){return function(){var V=this.ownerDocument,Ae=this.namespaceURI;return Ae===ht&&V.documentElement.namespaceURI===ht?V.createElement(y):V.createElementNS(Ae,y)}}function jt(y){return function(){return this.ownerDocument.createElementNS(y.space,y.local)}}function fn(y){var V=vn(y);return(V.local?jt:en)(V)}function Gn(){}function qn(y){return null==y?Gn:function(){return this.querySelector(y)}}function Ni(){return[]}function Kr(y){return null==y?Ni:function(){return this.querySelectorAll(y)}}function Vs(y){return function(){return this.matches(y)}}function un(y){return function(V){return V.matches(y)}}var di=Array.prototype.find;function ui(){return this.firstElementChild}var Fn=Array.prototype.filter;function _i(){return Array.from(this.children)}function ro(y){return new Array(y.length)}function qi(y,V){this.ownerDocument=y.ownerDocument,this.namespaceURI=y.namespaceURI,this._next=null,this._parent=y,this.__data__=V}function ra(y,V,Ae,be,Xe,ut){for(var Tt,_t=0,Gt=V.length,Wt=ut.length;_t<Wt;++_t)(Tt=V[_t])?(Tt.__data__=ut[_t],be[_t]=Tt):Ae[_t]=new qi(y,ut[_t]);for(;_t<Gt;++_t)(Tt=V[_t])&&(Xe[_t]=Tt)}function ic(y,V,Ae,be,Xe,ut,_t){var Tt,Gt,Ei,Wt=new Map,pn=V.length,Qn=ut.length,Wn=new Array(pn);for(Tt=0;Tt<pn;++Tt)(Gt=V[Tt])&&(Wn[Tt]=Ei=_t.call(Gt,Gt.__data__,Tt,V)+"",Wt.has(Ei)?Xe[Tt]=Gt:Wt.set(Ei,Gt));for(Tt=0;Tt<Qn;++Tt)Ei=_t.call(y,ut[Tt],Tt,ut)+"",(Gt=Wt.get(Ei))?(be[Tt]=Gt,Gt.__data__=ut[Tt],Wt.delete(Ei)):Ae[Tt]=new qi(y,ut[Tt]);for(Tt=0;Tt<pn;++Tt)(Gt=V[Tt])&&Wt.get(Wn[Tt])===Gt&&(Xe[Tt]=Gt)}function jh(y){return y.__data__}function Au(y){return"object"==typeof y&&"length"in y?y:Array.from(y)}function Bi(y,V){return y<V?-1:y>V?1:y>=V?0:NaN}function $o(y){return function(){this.removeAttribute(y)}}function N0(y){return function(){this.removeAttributeNS(y.space,y.local)}}function Uf(y,V){return function(){this.setAttribute(y,V)}}function LC(y,V){return function(){this.setAttributeNS(y.space,y.local,V)}}function zf(y,V){return function(){var Ae=V.apply(this,arguments);null==Ae?this.removeAttribute(y):this.setAttribute(y,Ae)}}function vg(y,V){return function(){var Ae=V.apply(this,arguments);null==Ae?this.removeAttributeNS(y.space,y.local):this.setAttributeNS(y.space,y.local,Ae)}}function xm(y){return y.ownerDocument&&y.ownerDocument.defaultView||y.document&&y||y.defaultView}function bg(y){return function(){this.style.removeProperty(y)}}function $h(y,V,Ae){return function(){this.style.setProperty(y,V,Ae)}}function xg(y,V,Ae){return function(){var be=V.apply(this,arguments);null==be?this.style.removeProperty(y):this.style.setProperty(y,be,Ae)}}function go(y,V){return y.style.getPropertyValue(V)||xm(y).getComputedStyle(y,null).getPropertyValue(V)}function Wa(y){return function(){delete this[y]}}function NC(y,V){return function(){this[y]=V}}function Tx(y,V){return function(){var Ae=V.apply(this,arguments);null==Ae?delete this[y]:this[y]=Ae}}function Ix(y){return y.trim().split(/^|\s+/)}function wg(y){return y.classList||new Cg(y)}function Cg(y){this._node=y,this._names=Ix(y.getAttribute("class")||"")}function va(y,V){for(var Ae=wg(y),be=-1,Xe=V.length;++be<Xe;)Ae.add(V[be])}function Mg(y,V){for(var Ae=wg(y),be=-1,Xe=V.length;++be<Xe;)Ae.remove(V[be])}function d1(y){return function(){va(this,y)}}function $d(y){return function(){Mg(this,y)}}function u1(y,V){return function(){(V.apply(this,arguments)?va:Mg)(this,y)}}function U0(){this.textContent=""}function wp(y){return function(){this.textContent=y}}function h1(y){return function(){var V=y.apply(this,arguments);this.textContent=V??""}}function Px(){this.innerHTML=""}function Rx(y){return function(){this.innerHTML=y}}function kx(y){return function(){var V=y.apply(this,arguments);this.innerHTML=V??""}}function gA(){this.nextSibling&&this.parentNode.appendChild(this)}function Vf(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Dd(){return null}function xh(){var y=this.parentNode;y&&y.removeChild(this)}function Cp(){var y=this.cloneNode(!1),V=this.parentNode;return V?V.insertBefore(y,this.nextSibling):y}function Xd(){var y=this.cloneNode(!0),V=this.parentNode;return V?V.insertBefore(y,this.nextSibling):y}function V0(y){return function(){var V=this.__on;if(V){for(var ut,Ae=0,be=-1,Xe=V.length;Ae<Xe;++Ae)ut=V[Ae],y.type&&ut.type!==y.type||ut.name!==y.name?V[++be]=ut:this.removeEventListener(ut.type,ut.listener,ut.options);++be?V.length=be:delete this.__on}}}function Xl(y,V,Ae){return function(){var Xe,be=this.__on,ut=function nl(y){return function(V){y.call(this,V,this.__data__)}}(V);if(be)for(var _t=0,Tt=be.length;_t<Tt;++_t)if((Xe=be[_t]).type===y.type&&Xe.name===y.name)return this.removeEventListener(Xe.type,Xe.listener,Xe.options),this.addEventListener(Xe.type,Xe.listener=ut,Xe.options=Ae),void(Xe.value=V);this.addEventListener(y.type,ut,Ae),Xe={type:y.type,name:y.name,value:V,listener:ut,options:Ae},be?be.push(Xe):this.__on=[Xe]}}function md(y,V,Ae){var be=xm(y),Xe=be.CustomEvent;"function"==typeof Xe?Xe=new Xe(V,Ae):(Xe=be.document.createEvent("Event"),Ae?(Xe.initEvent(V,Ae.bubbles,Ae.cancelable),Xe.detail=Ae.detail):Xe.initEvent(V,!1,!1)),y.dispatchEvent(Xe)}function wm(y,V){return function(){return md(this,y,V)}}function ha(y,V){return function(){return md(this,y,V.apply(this,arguments))}}qi.prototype={constructor:qi,appendChild:function(y){return this._parent.insertBefore(y,this._next)},insertBefore:function(y,V){return this._parent.insertBefore(y,V)},querySelector:function(y){return this._parent.querySelector(y)},querySelectorAll:function(y){return this._parent.querySelectorAll(y)}},Cg.prototype={add:function(y){this._names.indexOf(y)<0&&(this._names.push(y),this._node.setAttribute("class",this._names.join(" ")))},remove:function(y){var V=this._names.indexOf(y);V>=0&&(this._names.splice(V,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(y){return this._names.indexOf(y)>=0}};var Qf=[null];function gc(y,V){this._groups=y,this._parents=V}function Fu(){return new gc([[document.documentElement]],Qf)}function Xh(y){return"string"==typeof y?new gc([[document.querySelector(y)]],[document.documentElement]):new gc([[y]],Qf)}gc.prototype=Fu.prototype={constructor:gc,select:function Vi(y){"function"!=typeof y&&(y=qn(y));for(var V=this._groups,Ae=V.length,be=new Array(Ae),Xe=0;Xe<Ae;++Xe)for(var Gt,Wt,ut=V[Xe],_t=ut.length,Tt=be[Xe]=new Array(_t),pn=0;pn<_t;++pn)(Gt=ut[pn])&&(Wt=y.call(Gt,Gt.__data__,pn,ut))&&("__data__"in Gt&&(Wt.__data__=Gt.__data__),Tt[pn]=Wt);return new gc(be,this._parents)},selectAll:function ia(y){y="function"==typeof y?function os(y){return function(){return function _r(y){return null==y?[]:Array.isArray(y)?y:Array.from(y)}(y.apply(this,arguments))}}(y):Kr(y);for(var V=this._groups,Ae=V.length,be=[],Xe=[],ut=0;ut<Ae;++ut)for(var Gt,_t=V[ut],Tt=_t.length,Wt=0;Wt<Tt;++Wt)(Gt=_t[Wt])&&(be.push(y.call(Gt,Gt.__data__,Wt,_t)),Xe.push(Gt));return new gc(be,Xe)},selectChild:function Pn(y){return this.select(null==y?ui:function Rt(y){return function(){return di.call(this.children,y)}}("function"==typeof y?y:un(y)))},selectChildren:function gs(y){return this.selectAll(null==y?_i:function Dr(y){return function(){return Fn.call(this.children,y)}}("function"==typeof y?y:un(y)))},filter:function Qr(y){"function"!=typeof y&&(y=Vs(y));for(var V=this._groups,Ae=V.length,be=new Array(Ae),Xe=0;Xe<Ae;++Xe)for(var Gt,ut=V[Xe],_t=ut.length,Tt=be[Xe]=[],Wt=0;Wt<_t;++Wt)(Gt=ut[Wt])&&y.call(Gt,Gt.__data__,Wt,ut)&&Tt.push(Gt);return new gc(be,this._parents)},data:function rc(y,V){if(!arguments.length)return Array.from(this,jh);var Ae=V?ic:ra,be=this._parents,Xe=this._groups;"function"!=typeof y&&(y=function Uo(y){return function(){return y}}(y));for(var ut=Xe.length,_t=new Array(ut),Tt=new Array(ut),Gt=new Array(ut),Wt=0;Wt<ut;++Wt){var pn=be[Wt],Qn=Xe[Wt],Wn=Qn.length,Ei=Au(y.call(pn,pn&&pn.__data__,Wt,be)),kr=Ei.length,pr=Tt[Wt]=new Array(kr),wr=_t[Wt]=new Array(kr);Ae(pn,Qn,pr,wr,Gt[Wt]=new Array(Wn),Ei,V);for(var nr,Xs,jo=0,qr=0;jo<kr;++jo)if(nr=pr[jo]){for(jo>=qr&&(qr=jo+1);!(Xs=wr[qr])&&++qr<kr;);nr._next=Xs||null}}return(_t=new gc(_t,be))._enter=Tt,_t._exit=Gt,_t},enter:function Zs(){return new gc(this._enter||this._groups.map(ro),this._parents)},exit:function Io(){return new gc(this._exit||this._groups.map(ro),this._parents)},join:function $l(y,V,Ae){var be=this.enter(),Xe=this,ut=this.exit();return"function"==typeof y?(be=y(be))&&(be=be.selection()):be=be.append(y+""),null!=V&&(Xe=V(Xe))&&(Xe=Xe.selection()),null==Ae?ut.remove():Ae(ut),be&&Xe?be.merge(Xe).order():Xe},merge:function hd(y){for(var V=y.selection?y.selection():y,Ae=this._groups,be=V._groups,Xe=Ae.length,_t=Math.min(Xe,be.length),Tt=new Array(Xe),Gt=0;Gt<_t;++Gt)for(var Ei,Wt=Ae[Gt],pn=be[Gt],Qn=Wt.length,Wn=Tt[Gt]=new Array(Qn),kr=0;kr<Qn;++kr)(Ei=Wt[kr]||pn[kr])&&(Wn[kr]=Ei);for(;Gt<Xe;++Gt)Tt[Gt]=Ae[Gt];return new gc(Tt,this._parents)},selection:function p1(){return this},order:function fd(){for(var y=this._groups,V=-1,Ae=y.length;++V<Ae;)for(var _t,be=y[V],Xe=be.length-1,ut=be[Xe];--Xe>=0;)(_t=be[Xe])&&(ut&&4^_t.compareDocumentPosition(ut)&&ut.parentNode.insertBefore(_t,ut),ut=_t);return this},sort:function Td(y){function V(Qn,Wn){return Qn&&Wn?y(Qn.__data__,Wn.__data__):!Qn-!Wn}y||(y=Bi);for(var Ae=this._groups,be=Ae.length,Xe=new Array(be),ut=0;ut<be;++ut){for(var Wt,_t=Ae[ut],Tt=_t.length,Gt=Xe[ut]=new Array(Tt),pn=0;pn<Tt;++pn)(Wt=_t[pn])&&(Gt[pn]=Wt);Gt.sort(V)}return new gc(Xe,this._parents).order()},call:function mc(){var y=arguments[0];return arguments[0]=this,y.apply(null,arguments),this},nodes:function ll(){return Array.from(this)},node:function sc(){for(var y=this._groups,V=0,Ae=y.length;V<Ae;++V)for(var be=y[V],Xe=0,ut=be.length;Xe<ut;++Xe){var _t=be[Xe];if(_t)return _t}return null},size:function Ju(){let y=0;for(const V of this)++y;return y},empty:function eh(){return!this.node()},each:function tl(y){for(var V=this._groups,Ae=0,be=V.length;Ae<be;++Ae)for(var Tt,Xe=V[Ae],ut=0,_t=Xe.length;ut<_t;++ut)(Tt=Xe[ut])&&y.call(Tt,Tt.__data__,ut,Xe);return this},attr:function c1(y,V){var Ae=vn(y);if(arguments.length<2){var be=this.node();return Ae.local?be.getAttributeNS(Ae.space,Ae.local):be.getAttribute(Ae)}return this.each((null==V?Ae.local?N0:$o:"function"==typeof V?Ae.local?vg:zf:Ae.local?LC:Uf)(Ae,V))},style:function Hf(y,V,Ae){return arguments.length>1?this.each((null==V?bg:"function"==typeof V?xg:$h)(y,V,Ae??"")):go(this.node(),y)},property:function Dx(y,V){return arguments.length>1?this.each((null==V?Wa:"function"==typeof V?Tx:NC)(y,V)):this.node()[y]},classed:function Bx(y,V){var Ae=Ix(y+"");if(arguments.length<2){for(var be=wg(this.node()),Xe=-1,ut=Ae.length;++Xe<ut;)if(!be.contains(Ae[Xe]))return!1;return!0}return this.each(("function"==typeof V?u1:V?d1:$d)(Ae,V))},text:function z0(y){return arguments.length?this.each(null==y?U0:("function"==typeof y?h1:wp)(y)):this.node().textContent},html:function lv(y){return arguments.length?this.each(null==y?Px:("function"==typeof y?kx:Rx)(y)):this.node().innerHTML},raise:function f1(){return this.each(gA)},lower:function H0(){return this.each(Vf)},append:function xi(y){var V="function"==typeof y?y:fn(y);return this.select(function(){return this.appendChild(V.apply(this,arguments))})},insert:function pi(y,V){var Ae="function"==typeof y?y:fn(y),be=null==V?Dd:"function"==typeof V?V:qn(V);return this.select(function(){return this.insertBefore(Ae.apply(this,arguments),be.apply(this,arguments)||null)})},remove:function Ac(){return this.each(xh)},clone:function pd(y){return this.select(y?Xd:Cp)},datum:function gu(y){return arguments.length?this.property("__data__",y):this.node().__data__},on:function Gf(y,V,Ae){var Xe,_t,be=function cl(y){return y.trim().split(/^|\s+/).map(function(V){var Ae="",be=V.indexOf(".");return be>=0&&(Ae=V.slice(be+1),V=V.slice(0,be)),{type:V,name:Ae}})}(y+""),ut=be.length;if(!(arguments.length<2)){for(Tt=V?Xl:V0,Xe=0;Xe<ut;++Xe)this.each(Tt(be[Xe],V,Ae));return this}var Tt=this.node().__on;if(Tt)for(var pn,Gt=0,Wt=Tt.length;Gt<Wt;++Gt)for(Xe=0,pn=Tt[Gt];Xe<ut;++Xe)if((_t=be[Xe]).type===pn.type&&_t.name===pn.name)return pn.value},dispatch:function qf(y,V){return this.each(("function"==typeof V?ha:wm)(y,V))},[Symbol.iterator]:function*Sg(){for(var y=this._groups,V=0,Ae=y.length;V<Ae;++V)for(var _t,be=y[V],Xe=0,ut=be.length;Xe<ut;++Xe)(_t=be[Xe])&&(yield _t)}};var Yl=0;function vl(){this._="@"+(++Yl).toString(36)}function Kl(y){let V;for(;V=y.sourceEvent;)y=V;return y}function ko(y,V){if(y=Kl(y),void 0===V&&(V=y.currentTarget),V){var Ae=V.ownerSVGElement||V;if(Ae.createSVGPoint){var be=Ae.createSVGPoint();return be.x=y.clientX,be.y=y.clientY,[(be=be.matrixTransform(V.getScreenCTM().inverse())).x,be.y]}if(V.getBoundingClientRect){var Xe=V.getBoundingClientRect();return[y.clientX-Xe.left-V.clientLeft,y.clientY-Xe.top-V.clientTop]}}return[y.pageX,y.pageY]}function wh(y,V){return y.target&&(y=Kl(y),void 0===V&&(V=y.currentTarget),y=y.touches||[y]),Array.from(y,Ae=>ko(Ae,V))}vl.prototype=function Yd(){return new vl}.prototype={constructor:vl,get:function(y){for(var V=this._;!(V in y);)if(!(y=y.parentNode))return;return y[V]},set:function(y,V){return y[this._]=V},remove:function(y){return this._ in y&&delete y[this._]},toString:function(){return this._}};const zi={passive:!1},zo={capture:!0,passive:!1};function th(y){y.stopImmediatePropagation()}function Wc(y){y.preventDefault(),y.stopImmediatePropagation()}var mi=y=>()=>y;function Tg(y,{sourceEvent:V,subject:Ae,target:be,identifier:Xe,active:ut,x:_t,y:Tt,dx:Gt,dy:Wt,dispatch:pn}){Object.defineProperties(this,{type:{value:y,enumerable:!0,configurable:!0},sourceEvent:{value:V,enumerable:!0,configurable:!0},subject:{value:Ae,enumerable:!0,configurable:!0},target:{value:be,enumerable:!0,configurable:!0},identifier:{value:Xe,enumerable:!0,configurable:!0},active:{value:ut,enumerable:!0,configurable:!0},x:{value:_t,enumerable:!0,configurable:!0},y:{value:Tt,enumerable:!0,configurable:!0},dx:{value:Gt,enumerable:!0,configurable:!0},dy:{value:Wt,enumerable:!0,configurable:!0},_:{value:pn}})}function Dg(y){return!y.ctrlKey&&!y.button}function Cm(){return this.parentNode}function yu(y,V){return V??{x:y.x,y:y.y}}function Mp(){return navigator.maxTouchPoints||"ontouchstart"in this}function _A(){var Tt,Gt,Wt,pn,y=Dg,V=Cm,Ae=yu,be=Mp,Xe={},ut=wn("start","drag","end"),_t=0,Qn=0;function Wn(nr){nr.on("mousedown.drag",Ei).filter(be).on("touchstart.drag",wr).on("touchmove.drag",Ts,zi).on("touchend.drag touchcancel.drag",jo).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function Ei(nr,Xs){if(!pn&&y.call(this,nr,Xs)){var bs=qr(this,V.call(this,nr,Xs),nr,Xs,"mouse");bs&&(Xh(nr.view).on("mousemove.drag",kr,zo).on("mouseup.drag",pr,zo),function Eg(y){var V=y.document.documentElement,Ae=Xh(y).on("dragstart.drag",Wc,zo);"onselectstart"in V?Ae.on("selectstart.drag",Wc,zo):(V.__noselect=V.style.MozUserSelect,V.style.MozUserSelect="none")}(nr.view),th(nr),Wt=!1,Tt=nr.clientX,Gt=nr.clientY,bs("start",nr))}}function kr(nr){if(Wc(nr),!Wt){var Xs=nr.clientX-Tt,bs=nr.clientY-Gt;Wt=Xs*Xs+bs*bs>Qn}Xe.mouse("drag",nr)}function pr(nr){Xh(nr.view).on("mousemove.drag mouseup.drag",null),function Ad(y,V){var Ae=y.document.documentElement,be=Xh(y).on("dragstart.drag",null);V&&(be.on("click.drag",Wc,zo),setTimeout(function(){be.on("click.drag",null)},0)),"onselectstart"in Ae?be.on("selectstart.drag",null):(Ae.style.MozUserSelect=Ae.__noselect,delete Ae.__noselect)}(nr.view,Wt),Wc(nr),Xe.mouse("end",nr)}function wr(nr,Xs){if(y.call(this,nr,Xs)){var zc,dc,bs=nr.changedTouches,Go=V.call(this,nr,Xs),hl=bs.length;for(zc=0;zc<hl;++zc)(dc=qr(this,Go,nr,Xs,bs[zc].identifier,bs[zc]))&&(th(nr),dc("start",nr,bs[zc]))}}function Ts(nr){var Go,hl,Xs=nr.changedTouches,bs=Xs.length;for(Go=0;Go<bs;++Go)(hl=Xe[Xs[Go].identifier])&&(Wc(nr),hl("drag",nr,Xs[Go]))}function jo(nr){var Go,hl,Xs=nr.changedTouches,bs=Xs.length;for(pn&&clearTimeout(pn),pn=setTimeout(function(){pn=null},500),Go=0;Go<bs;++Go)(hl=Xe[Xs[Go].identifier])&&(th(nr),hl("end",nr,Xs[Go]))}function qr(nr,Xs,bs,Go,hl,zc){var wl,Js,Zo,dc=ut.copy(),ao=ko(zc||bs,Xs);if(null!=(Zo=Ae.call(nr,new Tg("beforestart",{sourceEvent:bs,target:Wn,identifier:hl,active:_t,x:ao[0],y:ao[1],dx:0,dy:0,dispatch:dc}),Go)))return wl=Zo.x-ao[0]||0,Js=Zo.y-ao[1]||0,function nu(iu,td,Ld){var cp,Jl=ao;switch(iu){case"start":Xe[hl]=nu,cp=_t++;break;case"end":delete Xe[hl],--_t;case"drag":ao=ko(Ld||td,Xs),cp=_t}dc.call(iu,nr,new Tg(iu,{sourceEvent:td,subject:Zo,target:Wn,identifier:hl,active:cp,x:ao[0]+wl,y:ao[1]+Js,dx:ao[0]-Jl[0],dy:ao[1]-Jl[1],dispatch:dc}),Go)}}return Wn.filter=function(nr){return arguments.length?(y="function"==typeof nr?nr:mi(!!nr),Wn):y},Wn.container=function(nr){return arguments.length?(V="function"==typeof nr?nr:mi(nr),Wn):V},Wn.subject=function(nr){return arguments.length?(Ae="function"==typeof nr?nr:mi(nr),Wn):Ae},Wn.touchable=function(nr){return arguments.length?(be="function"==typeof nr?nr:mi(!!nr),Wn):be},Wn.on=function(){var nr=ut.on.apply(ut,arguments);return nr===ut?Wn:nr},Wn.clickDistance=function(nr){return arguments.length?(Qn=(nr=+nr)*nr,Wn):Math.sqrt(Qn)},Wn}function Yh(y,V){return null==y||null==V?NaN:y<V?-1:y>V?1:y>=V?0:NaN}function Ya(y,V){return null==y||null==V?NaN:V<y?-1:V>y?1:V>=y?0:NaN}function Ch(y){let V,Ae,be;function Xe(Tt,Gt,Wt=0,pn=Tt.length){if(Wt<pn){if(0!==V(Gt,Gt))return pn;do{const Qn=Wt+pn>>>1;Ae(Tt[Qn],Gt)<0?Wt=Qn+1:pn=Qn}while(Wt<pn)}return Wt}return 2!==y.length?(V=Yh,Ae=(Tt,Gt)=>Yh(y(Tt),Gt),be=(Tt,Gt)=>y(Tt)-Gt):(V=y===Yh||y===Ya?y:Ig,Ae=y,be=y),{left:Xe,center:function _t(Tt,Gt,Wt=0,pn=Tt.length){const Qn=Xe(Tt,Gt,Wt,pn-1);return Qn>Wt&&be(Tt[Qn-1],Gt)>-be(Tt[Qn],Gt)?Qn-1:Qn},right:function ut(Tt,Gt,Wt=0,pn=Tt.length){if(Wt<pn){if(0!==V(Gt,Gt))return pn;do{const Qn=Wt+pn>>>1;Ae(Tt[Qn],Gt)<=0?Wt=Qn+1:pn=Qn}while(Wt<pn)}return Wt}}}function Ig(){return 0}Tg.prototype.on=function(){var y=this._.on.apply(this._,arguments);return y===this._?this:y};const jf=Ch(Yh).right;Ch(function Wf(y){return null===y?NaN:+y});var $f=jf;Map;const Zr=Math.sqrt(50),Bg=Math.sqrt(10),Os=Math.sqrt(2);function vo(y,V,Ae){const be=(V-y)/Math.max(0,Ae),Xe=Math.floor(Math.log10(be)),ut=be/Math.pow(10,Xe),_t=ut>=Zr?10:ut>=Bg?5:ut>=Os?2:1;let Tt,Gt,Wt;return Xe<0?(Wt=Math.pow(10,-Xe)/_t,Tt=Math.round(y*Wt),Gt=Math.round(V*Wt),Tt/Wt<y&&++Tt,Gt/Wt>V&&--Gt,Wt=-Wt):(Wt=Math.pow(10,Xe)*_t,Tt=Math.round(y/Wt),Gt=Math.round(V/Wt),Tt*Wt<y&&++Tt,Gt*Wt>V&&--Gt),Gt<Tt&&.5<=Ae&&Ae<2?vo(y,V,2*Ae):[Tt,Gt,Wt]}function Lu(y,V,Ae){if(!((Ae=+Ae)>0))return[];if((y=+y)==(V=+V))return[y];const be=V<y,[Xe,ut,_t]=be?vo(V,y,Ae):vo(y,V,Ae);if(!(ut>=Xe))return[];const Tt=ut-Xe+1,Gt=new Array(Tt);if(be)if(_t<0)for(let Wt=0;Wt<Tt;++Wt)Gt[Wt]=(ut-Wt)/-_t;else for(let Wt=0;Wt<Tt;++Wt)Gt[Wt]=(ut-Wt)*_t;else if(_t<0)for(let Wt=0;Wt<Tt;++Wt)Gt[Wt]=(Xe+Wt)/-_t;else for(let Wt=0;Wt<Tt;++Wt)Gt[Wt]=(Xe+Wt)*_t;return Gt}function Ft(y,V,Ae){return vo(y=+y,V=+V,Ae=+Ae)[2]}function Ic(y,V,Ae){Ae=+Ae;const be=(V=+V)<(y=+y),Xe=be?Ft(V,y,Ae):Ft(y,V,Ae);return(be?-1:1)*(Xe<0?1/-Xe:Xe)}function _c(y,V){switch(arguments.length){case 0:break;case 1:this.range(y);break;default:this.range(V).domain(y)}return this}Symbol("implicit");var Uu=y=>()=>y;function Zh(y,V){var Ae=V-y;return Ae?function A1(y,V){return function(Ae){return y+Ae*V}}(y,Ae):Uu(isNaN(y)?V:y)}var Kd=function y(V){var Ae=function vA(y){return 1==(y=+y)?Zh:function(V,Ae){return Ae-V?function q0(y,V,Ae){return y=Math.pow(y,Ae),V=Math.pow(V,Ae)-y,Ae=1/Ae,function(be){return Math.pow(y+be*V,Ae)}}(V,Ae,y):Uu(isNaN(V)?Ae:V)}}(V);function be(Xe,ut){var _t=Ae((Xe=f(Xe)).r,(ut=f(ut)).r),Tt=Ae(Xe.g,ut.g),Gt=Ae(Xe.b,ut.b),Wt=Zh(Xe.opacity,ut.opacity);return function(pn){return Xe.r=_t(pn),Xe.g=Tt(pn),Xe.b=Gt(pn),Xe.opacity=Wt(pn),Xe+""}}return be.gamma=y,be}(1);function Pg(y,V){V||(V=[]);var Xe,Ae=y?Math.min(V.length,y.length):0,be=V.slice();return function(ut){for(Xe=0;Xe<Ae;++Xe)be[Xe]=y[Xe]*(1-ut)+V[Xe]*ut;return be}}function dv(y,V){var _t,Ae=V?V.length:0,be=y?Math.min(Ae,y.length):0,Xe=new Array(be),ut=new Array(Ae);for(_t=0;_t<be;++_t)Xe[_t]=Sm(y[_t],V[_t]);for(;_t<Ae;++_t)ut[_t]=V[_t];return function(Tt){for(_t=0;_t<be;++_t)ut[_t]=Xe[_t](Tt);return ut}}function ih(y,V){var Ae=new Date;return y=+y,V=+V,function(be){return Ae.setTime(y*(1-be)+V*be),Ae}}function yc(y,V){return y=+y,V=+V,function(Ae){return y*(1-Ae)+V*Ae}}function Rg(y,V){var Xe,Ae={},be={};for(Xe in(null===y||"object"!=typeof y)&&(y={}),(null===V||"object"!=typeof V)&&(V={}),V)Xe in y?Ae[Xe]=Sm(y[Xe],V[Xe]):be[Xe]=V[Xe];return function(ut){for(Xe in Ae)be[Xe]=Ae[Xe](ut);return be}}var Jh=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,bo=new RegExp(Jh.source,"g");function kg(y,V){var be,Xe,ut,Ae=Jh.lastIndex=bo.lastIndex=0,_t=-1,Tt=[],Gt=[];for(y+="",V+="";(be=Jh.exec(y))&&(Xe=bo.exec(V));)(ut=Xe.index)>Ae&&(ut=V.slice(Ae,ut),Tt[_t]?Tt[_t]+=ut:Tt[++_t]=ut),(be=be[0])===(Xe=Xe[0])?Tt[_t]?Tt[_t]+=Xe:Tt[++_t]=Xe:(Tt[++_t]=null,Gt.push({i:_t,x:yc(be,Xe)})),Ae=bo.lastIndex;return Ae<V.length&&(ut=V.slice(Ae),Tt[_t]?Tt[_t]+=ut:Tt[++_t]=ut),Tt.length<2?Gt[0]?function jc(y){return function(V){return y(V)+""}}(Gt[0].x):function Rc(y){return function(){return y}}(V):(V=Gt.length,function(Wt){for(var Qn,pn=0;pn<V;++pn)Tt[(Qn=Gt[pn]).i]=Qn.x(Wt);return Tt.join("")})}function Sm(y,V){var be,Ae=typeof V;return null==V||"boolean"===Ae?Uu(V):("number"===Ae?yc:"string"===Ae?(be=A(V))?(V=be,Kd):kg:V instanceof A?Kd:V instanceof Date?ih:function Ip(y){return ArrayBuffer.isView(y)&&!(y instanceof DataView)}(V)?Pg:Array.isArray(V)?dv:"function"!=typeof V.valueOf&&"function"!=typeof V.toString||isNaN(V)?Rg:yc)(y,V)}function rh(y,V){return y=+y,V=+V,function(Ae){return Math.round(y*(1-Ae)+V*Ae)}}var Bp,Em=180/Math.PI,vc={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function bA(y,V,Ae,be,Xe,ut){var _t,Tt,Gt;return(_t=Math.sqrt(y*y+V*V))&&(y/=_t,V/=_t),(Gt=y*Ae+V*be)&&(Ae-=y*Gt,be-=V*Gt),(Tt=Math.sqrt(Ae*Ae+be*be))&&(Ae/=Tt,be/=Tt,Gt/=Tt),y*be<V*Ae&&(y=-y,V=-V,Gt=-Gt,_t=-_t),{translateX:Xe,translateY:ut,rotate:Math.atan2(V,y)*Em,skewX:Math.atan(Gt)*Em,scaleX:_t,scaleY:Tt}}function El(y,V,Ae,be){function Xe(Wt){return Wt.length?Wt.pop()+" ":""}return function(Wt,pn){var Qn=[],Wn=[];return Wt=y(Wt),pn=y(pn),function ut(Wt,pn,Qn,Wn,Ei,kr){if(Wt!==Qn||pn!==Wn){var pr=Ei.push("translate(",null,V,null,Ae);kr.push({i:pr-4,x:yc(Wt,Qn)},{i:pr-2,x:yc(pn,Wn)})}else(Qn||Wn)&&Ei.push("translate("+Qn+V+Wn+Ae)}(Wt.translateX,Wt.translateY,pn.translateX,pn.translateY,Qn,Wn),function _t(Wt,pn,Qn,Wn){Wt!==pn?(Wt-pn>180?pn+=360:pn-Wt>180&&(Wt+=360),Wn.push({i:Qn.push(Xe(Qn)+"rotate(",null,be)-2,x:yc(Wt,pn)})):pn&&Qn.push(Xe(Qn)+"rotate("+pn+be)}(Wt.rotate,pn.rotate,Qn,Wn),function Tt(Wt,pn,Qn,Wn){Wt!==pn?Wn.push({i:Qn.push(Xe(Qn)+"skewX(",null,be)-2,x:yc(Wt,pn)}):pn&&Qn.push(Xe(Qn)+"skewX("+pn+be)}(Wt.skewX,pn.skewX,Qn,Wn),function Gt(Wt,pn,Qn,Wn,Ei,kr){if(Wt!==Qn||pn!==Wn){var pr=Ei.push(Xe(Ei)+"scale(",null,",",null,")");kr.push({i:pr-4,x:yc(Wt,Qn)},{i:pr-2,x:yc(pn,Wn)})}else(1!==Qn||1!==Wn)&&Ei.push(Xe(Ei)+"scale("+Qn+","+Wn+")")}(Wt.scaleX,Wt.scaleY,pn.scaleX,pn.scaleY,Qn,Wn),Wt=pn=null,function(Ei){for(var wr,kr=-1,pr=Wn.length;++kr<pr;)Qn[(wr=Wn[kr]).i]=wr.x(Ei);return Qn.join("")}}}var Pp=El(function ef(y){const V=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(y+"");return V.isIdentity?vc:bA(V.a,V.b,V.c,V.d,V.e,V.f)},"px, ","px)","deg)"),W0=El(function Q0(y){return null!=y&&(Bp||(Bp=document.createElementNS("http://www.w3.org/2000/svg","g")),Bp.setAttribute("transform",y),y=Bp.transform.baseVal.consolidate())?bA((y=y.matrix).a,y.b,y.c,y.d,y.e,y.f):vc},", ",")",")");function Rp(y){return+y}var sa=[0,1];function Id(y){return y}function g1(y,V){return(V-=y=+y)?function(Ae){return(Ae-y)/V}:function Nl(y){return function(){return y}}(isNaN(V)?NaN:.5)}function Fx(y,V,Ae){var be=y[0],Xe=y[1],ut=V[0],_t=V[1];return Xe<be?(be=g1(Xe,be),ut=Ae(_t,ut)):(be=g1(be,Xe),ut=Ae(ut,_t)),function(Tt){return ut(be(Tt))}}function _1(y,V,Ae){var be=Math.min(y.length,V.length)-1,Xe=new Array(be),ut=new Array(be),_t=-1;for(y[be]<y[0]&&(y=y.slice().reverse(),V=V.slice().reverse());++_t<be;)Xe[_t]=g1(y[_t],y[_t+1]),ut[_t]=Ae(V[_t],V[_t+1]);return function(Tt){var Gt=$f(y,Tt,1,be)-1;return ut[Gt](Xe[Gt](Tt))}}function Og(y,V){return V.domain(y.domain()).range(y.range()).interpolate(y.interpolate()).clamp(y.clamp()).unknown(y.unknown())}function wA(){var be,Xe,ut,Tt,Gt,Wt,y=sa,V=sa,Ae=Sm,_t=Id;function pn(){var Wn=Math.min(y.length,V.length);return _t!==Id&&(_t=function Fg(y,V){var Ae;return y>V&&(Ae=y,y=V,V=Ae),function(be){return Math.max(y,Math.min(V,be))}}(y[0],y[Wn-1])),Tt=Wn>2?_1:Fx,Gt=Wt=null,Qn}function Qn(Wn){return null==Wn||isNaN(Wn=+Wn)?ut:(Gt||(Gt=Tt(y.map(be),V,Ae)))(be(_t(Wn)))}return Qn.invert=function(Wn){return _t(Xe((Wt||(Wt=Tt(V,y.map(be),yc)))(Wn)))},Qn.domain=function(Wn){return arguments.length?(y=Array.from(Wn,Rp),pn()):y.slice()},Qn.range=function(Wn){return arguments.length?(V=Array.from(Wn),pn()):V.slice()},Qn.rangeRound=function(Wn){return V=Array.from(Wn),Ae=rh,pn()},Qn.clamp=function(Wn){return arguments.length?(_t=!!Wn||Id,pn()):_t!==Id},Qn.interpolate=function(Wn){return arguments.length?(Ae=Wn,pn()):Ae},Qn.unknown=function(Wn){return arguments.length?(ut=Wn,Qn):ut},function(Wn,Ei){return be=Wn,Xe=Ei,pn()}}function y1(){return wA()(Id,Id)}function CA(y,V){if((Ae=(y=V?y.toExponential(V-1):y.toExponential()).indexOf("e"))<0)return null;var Ae,be=y.slice(0,Ae);return[be.length>1?be[0]+be.slice(2):be,+y.slice(Ae+1)]}function sh(y){return(y=CA(Math.abs(y)))?y[1]:NaN}var Ul,so=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ml(y){if(!(V=so.exec(y)))throw new Error("invalid format: "+y);var V;return new Zd({fill:V[1],align:V[2],sign:V[3],symbol:V[4],zero:V[5],width:V[6],comma:V[7],precision:V[8]&&V[8].slice(1),trim:V[9],type:V[10]})}function Zd(y){this.fill=void 0===y.fill?" ":y.fill+"",this.align=void 0===y.align?">":y.align+"",this.sign=void 0===y.sign?"-":y.sign+"",this.symbol=void 0===y.symbol?"":y.symbol+"",this.zero=!!y.zero,this.width=void 0===y.width?void 0:+y.width,this.comma=!!y.comma,this.precision=void 0===y.precision?void 0:+y.precision,this.trim=!!y.trim,this.type=void 0===y.type?"":y.type+""}function Ka(y,V){var Ae=CA(y,V);if(!Ae)return y+"";var be=Ae[0],Xe=Ae[1];return Xe<0?"0."+new Array(-Xe).join("0")+be:be.length>Xe+1?be.slice(0,Xe+1)+"."+be.slice(Xe+1):be+new Array(Xe-be.length+2).join("0")}ml.prototype=Zd.prototype,Zd.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var $c={"%":(y,V)=>(100*y).toFixed(V),b:y=>Math.round(y).toString(2),c:y=>y+"",d:function Bo(y){return Math.abs(y=Math.round(y))>=1e21?y.toLocaleString("en").replace(/,/g,""):y.toString(10)},e:(y,V)=>y.toExponential(V),f:(y,V)=>y.toFixed(V),g:(y,V)=>y.toPrecision(V),o:y=>Math.round(y).toString(8),p:(y,V)=>Ka(100*y,V),r:Ka,s:function tf(y,V){var Ae=CA(y,V);if(!Ae)return y+"";var be=Ae[0],Xe=Ae[1],ut=Xe-(Ul=3*Math.max(-8,Math.min(8,Math.floor(Xe/3))))+1,_t=be.length;return ut===_t?be:ut>_t?be+new Array(ut-_t+1).join("0"):ut>0?be.slice(0,ut)+"."+be.slice(ut):"0."+new Array(1-ut).join("0")+CA(y,Math.max(0,V+ut-1))[0]},X:y=>Math.round(y).toString(16).toUpperCase(),x:y=>Math.round(y).toString(16)};function zu(y){return y}var nf,Yo,Rl,Mo=Array.prototype.map,kp=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function Bd(y){var V=y.domain;return y.ticks=function(Ae){var be=V();return Lu(be[0],be[be.length-1],Ae??10)},y.tickFormat=function(Ae,be){var Xe=V();return function ac(y,V,Ae,be){var ut,Xe=Ic(y,V,Ae);switch((be=ml(be??",f")).type){case"s":var _t=Math.max(Math.abs(y),Math.abs(V));return null==be.precision&&!isNaN(ut=function Fp(y,V){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(sh(V)/3)))-sh(Math.abs(y)))}(Xe,_t))&&(be.precision=ut),Rl(be,_t);case"":case"e":case"g":case"p":case"r":null==be.precision&&!isNaN(ut=function Op(y,V){return y=Math.abs(y),V=Math.abs(V)-y,Math.max(0,sh(V)-sh(y))+1}(Xe,Math.max(Math.abs(y),Math.abs(V))))&&(be.precision=ut-("e"===be.type));break;case"f":case"%":null==be.precision&&!isNaN(ut=function bc(y){return Math.max(0,-sh(Math.abs(y)))}(Xe))&&(be.precision=ut-2*("%"===be.type))}return Yo(be)}(Xe[0],Xe[Xe.length-1],Ae??10,be)},y.nice=function(Ae){null==Ae&&(Ae=10);var Gt,Wt,be=V(),Xe=0,ut=be.length-1,_t=be[Xe],Tt=be[ut],pn=10;for(Tt<_t&&(Wt=_t,_t=Tt,Tt=Wt,Wt=Xe,Xe=ut,ut=Wt);pn-- >0;){if((Wt=Ft(_t,Tt,Ae))===Gt)return be[Xe]=_t,be[ut]=Tt,V(be);if(Wt>0)_t=Math.floor(_t/Wt)*Wt,Tt=Math.ceil(Tt/Wt)*Wt;else{if(!(Wt<0))break;_t=Math.ceil(_t*Wt)/Wt,Tt=Math.floor(Tt*Wt)/Wt}Gt=Wt}return y},y}function Dl(){var y=y1();return y.copy=function(){return Og(y,Dl())},_c.apply(y,arguments),Bd(y)}function Mh(y,V){var _t,Ae=0,be=(y=y.slice()).length-1,Xe=y[Ae],ut=y[be];return ut<Xe&&(_t=Ae,Ae=be,be=_t,_t=Xe,Xe=ut,ut=_t),y[Ae]=V.floor(Xe),y[be]=V.ceil(ut),y}function rf(y){return Math.log(y)}function oh(y){return Math.exp(y)}function kc(y){return-Math.log(-y)}function cs(y){return-Math.exp(-y)}function Ia(y){return isFinite(y)?+("1e"+y):y<0?0:y}function dl(y){return(V,Ae)=>-y(-V,Ae)}function sf(){const y=function MA(y){const V=y(rf,oh),Ae=V.domain;let Xe,ut,be=10;function _t(){return Xe=function Fc(y){return y===Math.E?Math.log:10===y&&Math.log10||2===y&&Math.log2||(y=Math.log(y),V=>Math.log(V)/y)}(be),ut=function $0(y){return 10===y?Ia:y===Math.E?Math.exp:V=>Math.pow(y,V)}(be),Ae()[0]<0?(Xe=dl(Xe),ut=dl(ut),y(kc,cs)):y(rf,oh),V}return V.base=function(Tt){return arguments.length?(be=+Tt,_t()):be},V.domain=function(Tt){return arguments.length?(Ae(Tt),_t()):Ae()},V.ticks=Tt=>{const Gt=Ae();let Wt=Gt[0],pn=Gt[Gt.length-1];const Qn=pn<Wt;Qn&&([Wt,pn]=[pn,Wt]);let kr,pr,Wn=Xe(Wt),Ei=Xe(pn);const wr=null==Tt?10:+Tt;let Ts=[];if(!(be%1)&&Ei-Wn<wr){if(Wn=Math.floor(Wn),Ei=Math.ceil(Ei),Wt>0){for(;Wn<=Ei;++Wn)for(kr=1;kr<be;++kr)if(pr=Wn<0?kr/ut(-Wn):kr*ut(Wn),!(pr<Wt)){if(pr>pn)break;Ts.push(pr)}}else for(;Wn<=Ei;++Wn)for(kr=be-1;kr>=1;--kr)if(pr=Wn>0?kr/ut(-Wn):kr*ut(Wn),!(pr<Wt)){if(pr>pn)break;Ts.push(pr)}2*Ts.length<wr&&(Ts=Lu(Wt,pn,wr))}else Ts=Lu(Wn,Ei,Math.min(Ei-Wn,wr)).map(ut);return Qn?Ts.reverse():Ts},V.tickFormat=(Tt,Gt)=>{if(null==Tt&&(Tt=10),null==Gt&&(Gt=10===be?"s":","),"function"!=typeof Gt&&(!(be%1)&&null==(Gt=ml(Gt)).precision&&(Gt.trim=!0),Gt=Yo(Gt)),Tt===1/0)return Gt;const Wt=Math.max(1,be*Tt/V.ticks().length);return pn=>{let Qn=pn/ut(Math.round(Xe(pn)));return Qn*be<be-.5&&(Qn*=be),Qn<=Wt?Gt(pn):""}},V.nice=()=>Ae(Mh(Ae(),{floor:Tt=>ut(Math.floor(Xe(Tt))),ceil:Tt=>ut(Math.ceil(Xe(Tt)))})),V}(wA()).domain([1,10]);return y.copy=()=>Og(y,sf()).base(y.base()),_c.apply(y,arguments),y}function zl(y){return function(V){return Math.sign(V)*Math.log1p(Math.abs(V/y))}}function Hl(y){return function(V){return Math.sign(V)*Math.expm1(Math.abs(V))*y}}function SA(){var y=function Lp(y){var V=1,Ae=y(zl(V),Hl(V));return Ae.constant=function(be){return arguments.length?y(zl(V=+be),Hl(V)):V},Bd(Ae)}(wA());return y.copy=function(){return Og(y,SA()).constant(y.constant())},_c.apply(y,arguments)}!function Tm(y){nf=function j0(y){var V=void 0===y.grouping||void 0===y.thousands?zu:function Tl(y,V){return function(Ae,be){for(var Xe=Ae.length,ut=[],_t=0,Tt=y[0],Gt=0;Xe>0&&Tt>0&&(Gt+Tt+1>be&&(Tt=Math.max(1,be-Gt)),ut.push(Ae.substring(Xe-=Tt,Xe+Tt)),!((Gt+=Tt+1)>be));)Tt=y[_t=(_t+1)%y.length];return ut.reverse().join(V)}}(Mo.call(y.grouping,Number),y.thousands+""),Ae=void 0===y.currency?"":y.currency[0]+"",be=void 0===y.currency?"":y.currency[1]+"",Xe=void 0===y.decimal?".":y.decimal+"",ut=void 0===y.numerals?zu:function Gr(y){return function(V){return V.replace(/[0-9]/g,function(Ae){return y[+Ae]})}}(Mo.call(y.numerals,String)),_t=void 0===y.percent?"%":y.percent+"",Tt=void 0===y.minus?"\u2212":y.minus+"",Gt=void 0===y.nan?"NaN":y.nan+"";function Wt(Qn){var Wn=(Qn=ml(Qn)).fill,Ei=Qn.align,kr=Qn.sign,pr=Qn.symbol,wr=Qn.zero,Ts=Qn.width,jo=Qn.comma,qr=Qn.precision,nr=Qn.trim,Xs=Qn.type;"n"===Xs?(jo=!0,Xs="g"):$c[Xs]||(void 0===qr&&(qr=12),nr=!0,Xs="g"),(wr||"0"===Wn&&"="===Ei)&&(wr=!0,Wn="0",Ei="=");var bs="$"===pr?Ae:"#"===pr&&/[boxX]/.test(Xs)?"0"+Xs.toLowerCase():"",Go="$"===pr?be:/[%p]/.test(Xs)?_t:"",hl=$c[Xs],zc=/[defgprs%]/.test(Xs);function dc(ao){var Zo,nu,iu,wl=bs,Js=Go;if("c"===Xs)Js=hl(ao)+Js,ao="";else{var td=(ao=+ao)<0||1/ao<0;if(ao=isNaN(ao)?Gt:hl(Math.abs(ao),qr),nr&&(ao=function oc(y){e:for(var Xe,V=y.length,Ae=1,be=-1;Ae<V;++Ae)switch(y[Ae]){case".":be=Xe=Ae;break;case"0":0===be&&(be=Ae),Xe=Ae;break;default:if(!+y[Ae])break e;be>0&&(be=0)}return be>0?y.slice(0,be)+y.slice(Xe+1):y}(ao)),td&&0==+ao&&"+"!==kr&&(td=!1),wl=(td?"("===kr?kr:Tt:"-"===kr||"("===kr?"":kr)+wl,Js=("s"===Xs?kp[8+Ul/3]:"")+Js+(td&&"("===kr?")":""),zc)for(Zo=-1,nu=ao.length;++Zo<nu;)if(48>(iu=ao.charCodeAt(Zo))||iu>57){Js=(46===iu?Xe+ao.slice(Zo+1):ao.slice(Zo))+Js,ao=ao.slice(0,Zo);break}}jo&&!wr&&(ao=V(ao,1/0));var Ld=wl.length+ao.length+Js.length,Jl=Ld<Ts?new Array(Ts-Ld+1).join(Wn):"";switch(jo&&wr&&(ao=V(Jl+ao,Jl.length?Ts-Js.length:1/0),Jl=""),Ei){case"<":ao=wl+ao+Js+Jl;break;case"=":ao=wl+Jl+ao+Js;break;case"^":ao=Jl.slice(0,Ld=Jl.length>>1)+wl+ao+Js+Jl.slice(Ld);break;default:ao=Jl+wl+ao+Js}return ut(ao)}return qr=void 0===qr?6:/[gprs]/.test(Xs)?Math.max(1,Math.min(21,qr)):Math.max(0,Math.min(20,qr)),dc.toString=function(){return Qn+""},dc}return{format:Wt,formatPrefix:function pn(Qn,Wn){var Ei=Wt(((Qn=ml(Qn)).type="f",Qn)),kr=3*Math.max(-8,Math.min(8,Math.floor(sh(Wn)/3))),pr=Math.pow(10,-kr),wr=kp[8+kr/3];return function(Ts){return Ei(pr*Ts)+wr}}}}(y),Yo=nf.format,Rl=nf.formatPrefix}({thousands:",",grouping:[3],currency:["$",""]});const Ng=new Date,Ug=new Date;function xc(y,V,Ae,be){function Xe(ut){return y(ut=0===arguments.length?new Date:new Date(+ut)),ut}return Xe.floor=ut=>(y(ut=new Date(+ut)),ut),Xe.ceil=ut=>(y(ut=new Date(ut-1)),V(ut,1),y(ut),ut),Xe.round=ut=>{const _t=Xe(ut),Tt=Xe.ceil(ut);return ut-_t<Tt-ut?_t:Tt},Xe.offset=(ut,_t)=>(V(ut=new Date(+ut),null==_t?1:Math.floor(_t)),ut),Xe.range=(ut,_t,Tt)=>{const Gt=[];if(ut=Xe.ceil(ut),Tt=null==Tt?1:Math.floor(Tt),!(ut<_t&&Tt>0))return Gt;let Wt;do{Gt.push(Wt=new Date(+ut)),V(ut,Tt),y(ut)}while(Wt<ut&&ut<_t);return Gt},Xe.filter=ut=>xc(_t=>{if(_t>=_t)for(;y(_t),!ut(_t);)_t.setTime(_t-1)},(_t,Tt)=>{if(_t>=_t)if(Tt<0)for(;++Tt<=0;)for(;V(_t,-1),!ut(_t););else for(;--Tt>=0;)for(;V(_t,1),!ut(_t););}),Ae&&(Xe.count=(ut,_t)=>(Ng.setTime(+ut),Ug.setTime(+_t),y(Ng),y(Ug),Math.floor(Ae(Ng,Ug))),Xe.every=ut=>(ut=Math.floor(ut),isFinite(ut)&&ut>0?ut>1?Xe.filter(be?_t=>be(_t)%ut==0:_t=>Xe.count(0,_t)%ut==0):Xe:null)),Xe}const Dm=xc(()=>{},(y,V)=>{y.setTime(+y+V)},(y,V)=>V-y);Dm.every=y=>(y=Math.floor(y),isFinite(y)&&y>0?y>1?xc(V=>{V.setTime(Math.floor(V/y)*y)},(V,Ae)=>{V.setTime(+V+Ae*y)},(V,Ae)=>(Ae-V)/y):Dm:null);const lc=1e3,Xc=6e4,lh=60*Xc,Jd=24*lh,Im=7*Jd,v1=30*Jd,Eh=365*Jd,Hu=xc(y=>{y.setTime(y-y.getMilliseconds())},(y,V)=>{y.setTime(+y+V*lc)},(y,V)=>(V-y)/lc,y=>y.getUTCSeconds()),ch=xc(y=>{y.setTime(y-y.getMilliseconds()-y.getSeconds()*lc)},(y,V)=>{y.setTime(+y+V*Xc)},(y,V)=>(V-y)/Xc,y=>y.getMinutes()),kl=xc(y=>{y.setUTCSeconds(0,0)},(y,V)=>{y.setTime(+y+V*Xc)},(y,V)=>(V-y)/Xc,y=>y.getUTCMinutes()),Yf=xc(y=>{y.setTime(y-y.getMilliseconds()-y.getSeconds()*lc-y.getMinutes()*Xc)},(y,V)=>{y.setTime(+y+V*lh)},(y,V)=>(V-y)/lh,y=>y.getHours()),zp=xc(y=>{y.setUTCMinutes(0,0,0)},(y,V)=>{y.setTime(+y+V*lh)},(y,V)=>(V-y)/lh,y=>y.getUTCHours()),Kf=xc(y=>y.setHours(0,0,0,0),(y,V)=>y.setDate(y.getDate()+V),(y,V)=>(V-y-(V.getTimezoneOffset()-y.getTimezoneOffset())*Xc)/Jd,y=>y.getDate()-1),df=xc(y=>{y.setUTCHours(0,0,0,0)},(y,V)=>{y.setUTCDate(y.getUTCDate()+V)},(y,V)=>(V-y)/Jd,y=>y.getUTCDate()-1),Bm=xc(y=>{y.setUTCHours(0,0,0,0)},(y,V)=>{y.setUTCDate(y.getUTCDate()+V)},(y,V)=>(V-y)/Jd,y=>Math.floor(y/Jd));function Th(y){return xc(V=>{V.setDate(V.getDate()-(V.getDay()+7-y)%7),V.setHours(0,0,0,0)},(V,Ae)=>{V.setDate(V.getDate()+7*Ae)},(V,Ae)=>(Ae-V-(Ae.getTimezoneOffset()-V.getTimezoneOffset())*Xc)/Im)}const Zf=Th(0),Jf=Th(1),uf=(Th(2),Th(3),Th(4));function Pm(y){return xc(V=>{V.setUTCDate(V.getUTCDate()-(V.getUTCDay()+7-y)%7),V.setUTCHours(0,0,0,0)},(V,Ae)=>{V.setUTCDate(V.getUTCDate()+7*Ae)},(V,Ae)=>(Ae-V)/Im)}Th(5),Th(6);const oa=Pm(0),ep=Pm(1),Rm=(Pm(2),Pm(3),Pm(4)),Rd=(Pm(5),Pm(6),xc(y=>{y.setDate(1),y.setHours(0,0,0,0)},(y,V)=>{y.setMonth(y.getMonth()+V)},(y,V)=>V.getMonth()-y.getMonth()+12*(V.getFullYear()-y.getFullYear()),y=>y.getMonth())),X0=xc(y=>{y.setUTCDate(1),y.setUTCHours(0,0,0,0)},(y,V)=>{y.setUTCMonth(y.getUTCMonth()+V)},(y,V)=>V.getUTCMonth()-y.getUTCMonth()+12*(V.getUTCFullYear()-y.getUTCFullYear()),y=>y.getUTCMonth()),dh=xc(y=>{y.setMonth(0,1),y.setHours(0,0,0,0)},(y,V)=>{y.setFullYear(y.getFullYear()+V)},(y,V)=>V.getFullYear()-y.getFullYear(),y=>y.getFullYear());dh.every=y=>isFinite(y=Math.floor(y))&&y>0?xc(V=>{V.setFullYear(Math.floor(V.getFullYear()/y)*y),V.setMonth(0,1),V.setHours(0,0,0,0)},(V,Ae)=>{V.setFullYear(V.getFullYear()+Ae*y)}):null;const hf=xc(y=>{y.setUTCMonth(0,1),y.setUTCHours(0,0,0,0)},(y,V)=>{y.setUTCFullYear(y.getUTCFullYear()+V)},(y,V)=>V.getUTCFullYear()-y.getUTCFullYear(),y=>y.getUTCFullYear());function Vu(y,V,Ae,be,Xe,ut){const _t=[[Hu,1,lc],[Hu,5,5e3],[Hu,15,15e3],[Hu,30,3e4],[ut,1,Xc],[ut,5,5*Xc],[ut,15,15*Xc],[ut,30,30*Xc],[Xe,1,lh],[Xe,3,3*lh],[Xe,6,6*lh],[Xe,12,12*lh],[be,1,Jd],[be,2,2*Jd],[Ae,1,Im],[V,1,v1],[V,3,3*v1],[y,1,Eh]];function Gt(Wt,pn,Qn){const Wn=Math.abs(pn-Wt)/Qn,Ei=Ch(([,,wr])=>wr).right(_t,Wn);if(Ei===_t.length)return y.every(Ic(Wt/Eh,pn/Eh,Qn));if(0===Ei)return Dm.every(Math.max(Ic(Wt,pn,Qn),1));const[kr,pr]=_t[Wn/_t[Ei-1][2]<_t[Ei][2]/Wn?Ei-1:Ei];return kr.every(pr)}return[function Tt(Wt,pn,Qn){const Wn=pn<Wt;Wn&&([Wt,pn]=[pn,Wt]);const Ei=Qn&&"function"==typeof Qn.range?Qn:Gt(Wt,pn,Qn),kr=Ei?Ei.range(Wt,+pn+1):[];return Wn?kr.reverse():kr},Gt]}hf.every=y=>isFinite(y=Math.floor(y))&&y>0?xc(V=>{V.setUTCFullYear(Math.floor(V.getUTCFullYear()/y)*y),V.setUTCMonth(0,1),V.setUTCHours(0,0,0,0)},(V,Ae)=>{V.setUTCFullYear(V.getUTCFullYear()+Ae*y)}):null;const[b1,Y0]=Vu(hf,X0,oa,Bm,zp,kl),[K0,Oc]=Vu(dh,Rd,Zf,Kf,Yf,ch);function ff(y){if(0<=y.y&&y.y<100){var V=new Date(-1,y.m,y.d,y.H,y.M,y.S,y.L);return V.setFullYear(y.y),V}return new Date(y.y,y.m,y.d,y.H,y.M,y.S,y.L)}function Hp(y){if(0<=y.y&&y.y<100){var V=new Date(Date.UTC(-1,y.m,y.d,y.H,y.M,y.S,y.L));return V.setUTCFullYear(y.y),V}return new Date(Date.UTC(y.y,y.m,y.d,y.H,y.M,y.S,y.L))}function tp(y,V,Ae){return{y,m:V,d:Ae,H:0,M:0,S:0,L:0}}var Af,jg,Xg,Av,Dh={"-":"",_:" ",0:"0"},Gs=/^\s*\d+/,x1=/^%/,Ox=/[\\^$*+?|[\]().{}]/g;function ja(y,V,Ae){var be=y<0?"-":"",Xe=(be?-y:y)+"",ut=Xe.length;return be+(ut<Ae?new Array(Ae-ut+1).join(V)+Xe:Xe)}function fv(y){return y.replace(Ox,"\\$&")}function PA(y){return new RegExp("^(?:"+y.map(fv).join("|")+")","i")}function Fm(y){return new Map(y.map((V,Ae)=>[V.toLowerCase(),Ae]))}function Om(y,V,Ae){var be=Gs.exec(V.slice(Ae,Ae+1));return be?(y.w=+be[0],Ae+be[0].length):-1}function w1(y,V,Ae){var be=Gs.exec(V.slice(Ae,Ae+1));return be?(y.u=+be[0],Ae+be[0].length):-1}function C1(y,V,Ae){var be=Gs.exec(V.slice(Ae,Ae+2));return be?(y.U=+be[0],Ae+be[0].length):-1}function M1(y,V,Ae){var be=Gs.exec(V.slice(Ae,Ae+2));return be?(y.V=+be[0],Ae+be[0].length):-1}function S1(y,V,Ae){var be=Gs.exec(V.slice(Ae,Ae+2));return be?(y.W=+be[0],Ae+be[0].length):-1}function Hg(y,V,Ae){var be=Gs.exec(V.slice(Ae,Ae+4));return be?(y.y=+be[0],Ae+be[0].length):-1}function Zi(y,V,Ae){var be=Gs.exec(V.slice(Ae,Ae+2));return be?(y.y=+be[0]+(+be[0]>68?1900:2e3),Ae+be[0].length):-1}function wa(y,V,Ae){var be=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(V.slice(Ae,Ae+6));return be?(y.Z=be[1]?0:-(be[2]+(be[3]||"00")),Ae+be[0].length):-1}function Ci(y,V,Ae){var be=Gs.exec(V.slice(Ae,Ae+1));return be?(y.q=3*be[0]-3,Ae+be[0].length):-1}function Mi(y,V,Ae){var be=Gs.exec(V.slice(Ae,Ae+2));return be?(y.m=be[0]-1,Ae+be[0].length):-1}function Ha(y,V,Ae){var be=Gs.exec(V.slice(Ae,Ae+2));return be?(y.d=+be[0],Ae+be[0].length):-1}function RA(y,V,Ae){var be=Gs.exec(V.slice(Ae,Ae+3));return be?(y.m=0,y.d=+be[0],Ae+be[0].length):-1}function Lm(y,V,Ae){var be=Gs.exec(V.slice(Ae,Ae+2));return be?(y.H=+be[0],Ae+be[0].length):-1}function uh(y,V,Ae){var be=Gs.exec(V.slice(Ae,Ae+2));return be?(y.M=+be[0],Ae+be[0].length):-1}function kA(y,V,Ae){var be=Gs.exec(V.slice(Ae,Ae+2));return be?(y.S=+be[0],Ae+be[0].length):-1}function Vg(y,V,Ae){var be=Gs.exec(V.slice(Ae,Ae+3));return be?(y.L=+be[0],Ae+be[0].length):-1}function E1(y,V,Ae){var be=Gs.exec(V.slice(Ae,Ae+6));return be?(y.L=Math.floor(be[0]/1e3),Ae+be[0].length):-1}function pv(y,V,Ae){var be=x1.exec(V.slice(Ae,Ae+1));return be?Ae+be[0].length:-1}function T1(y,V,Ae){var be=Gs.exec(V.slice(Ae));return be?(y.Q=+be[0],Ae+be[0].length):-1}function Yc(y,V,Ae){var be=Gs.exec(V.slice(Ae));return be?(y.s=+be[0],Ae+be[0].length):-1}function hh(y,V){return ja(y.getDate(),V,2)}function Z0(y,V){return ja(y.getHours(),V,2)}function fh(y,V){return ja(y.getHours()%12||12,V,2)}function pf(y,V){return ja(1+Kf.count(dh(y),y),V,3)}function J0(y,V){return ja(y.getMilliseconds(),V,3)}function Vp(y,V){return J0(y,V)+"000"}function e_(y,V){return ja(y.getMonth()+1,V,2)}function Gg(y,V){return ja(y.getMinutes(),V,2)}function t_(y,V){return ja(y.getSeconds(),V,2)}function n_(y){var V=y.getDay();return 0===V?7:V}function i_(y,V){return ja(Zf.count(dh(y)-1,y),V,2)}function FA(y){var V=y.getDay();return V>=4||0===V?uf(y):uf.ceil(y)}function D1(y,V){return y=FA(y),ja(uf.count(dh(y),y)+(4===dh(y).getDay()),V,2)}function qg(y){return y.getDay()}function Qg(y,V){return ja(Jf.count(dh(y)-1,y),V,2)}function r_(y,V){return ja(y.getFullYear()%100,V,2)}function Wg(y,V){return ja((y=FA(y)).getFullYear()%100,V,2)}function s_(y,V){return ja(y.getFullYear()%1e4,V,4)}function o_(y,V){var Ae=y.getDay();return ja((y=Ae>=4||0===Ae?uf(y):uf.ceil(y)).getFullYear()%1e4,V,4)}function a_(y){var V=y.getTimezoneOffset();return(V>0?"-":(V*=-1,"+"))+ja(V/60|0,"0",2)+ja(V%60,"0",2)}function OA(y,V){return ja(y.getUTCDate(),V,2)}function Lc(y,V){return ja(y.getUTCHours(),V,2)}function np(y,V){return ja(y.getUTCHours()%12||12,V,2)}function gl(y,V){return ja(1+df.count(hf(y),y),V,3)}function Fl(y,V){return ja(y.getUTCMilliseconds(),V,3)}function I1(y,V){return Fl(y,V)+"000"}function Ih(y,V){return ja(y.getUTCMonth()+1,V,2)}function mv(y,V){return ja(y.getUTCMinutes(),V,2)}function B1(y,V){return ja(y.getUTCSeconds(),V,2)}function Gp(y){var V=y.getUTCDay();return 0===V?7:V}function Nm(y,V){return ja(oa.count(hf(y)-1,y),V,2)}function Za(y){var V=y.getUTCDay();return V>=4||0===V?Rm(y):Rm.ceil(y)}function qp(y,V){return y=Za(y),ja(Rm.count(hf(y),y)+(4===hf(y).getUTCDay()),V,2)}function mf(y){return y.getUTCDay()}function ph(y,V){return ja(ep.count(hf(y)-1,y),V,2)}function mh(y,V){return ja(y.getUTCFullYear()%100,V,2)}function Qp(y,V){return ja((y=Za(y)).getUTCFullYear()%100,V,2)}function Bh(y,V){return ja(y.getUTCFullYear()%1e4,V,4)}function l_(y,V){var Ae=y.getUTCDay();return ja((y=Ae>=4||0===Ae?Rm(y):Rm.ceil(y)).getUTCFullYear()%1e4,V,4)}function P1(){return"+0000"}function ip(){return"%"}function rp(y){return+y}function Um(y){return Math.floor(+y/1e3)}!function Lx(y){Af=function zg(y){var V=y.dateTime,Ae=y.date,be=y.time,Xe=y.periods,ut=y.days,_t=y.shortDays,Tt=y.months,Gt=y.shortMonths,Wt=PA(Xe),pn=Fm(Xe),Qn=PA(ut),Wn=Fm(ut),Ei=PA(_t),kr=Fm(_t),pr=PA(Tt),wr=Fm(Tt),Ts=PA(Gt),jo=Fm(Gt),qr={a:function td(Qs){return _t[Qs.getDay()]},A:function Ld(Qs){return ut[Qs.getDay()]},b:function Jl(Qs){return Gt[Qs.getMonth()]},B:function cp(Qs){return Tt[Qs.getMonth()]},c:null,d:hh,e:hh,f:Vp,g:Wg,G:o_,H:Z0,I:fh,j:pf,L:J0,m:e_,M:Gg,p:function o0(Qs){return Xe[+(Qs.getHours()>=12)]},q:function a0(Qs){return 1+~~(Qs.getMonth()/3)},Q:rp,s:Um,S:t_,u:n_,U:i_,V:D1,w:qg,W:Qg,x:null,X:null,y:r_,Y:s_,Z:a_,"%":ip},nr={a:function Xm(Qs){return _t[Qs.getUTCDay()]},A:function em(Qs){return ut[Qs.getUTCDay()]},b:function _h(Qs){return Gt[Qs.getUTCMonth()]},B:function l0(Qs){return Tt[Qs.getUTCMonth()]},c:null,d:OA,e:OA,f:I1,g:Qp,G:l_,H:Lc,I:np,j:gl,L:Fl,m:Ih,M:mv,p:function c0(Qs){return Xe[+(Qs.getUTCHours()>=12)]},q:function xf(Qs){return 1+~~(Qs.getUTCMonth()/3)},Q:rp,s:Um,S:B1,u:Gp,U:Nm,V:qp,w:mf,W:ph,x:null,X:null,y:mh,Y:Bh,Z:P1,"%":ip},Xs={a:function dc(Qs,Ma,Va){var Wr=Ei.exec(Ma.slice(Va));return Wr?(Qs.w=kr.get(Wr[0].toLowerCase()),Va+Wr[0].length):-1},A:function ao(Qs,Ma,Va){var Wr=Qn.exec(Ma.slice(Va));return Wr?(Qs.w=Wn.get(Wr[0].toLowerCase()),Va+Wr[0].length):-1},b:function wl(Qs,Ma,Va){var Wr=Ts.exec(Ma.slice(Va));return Wr?(Qs.m=jo.get(Wr[0].toLowerCase()),Va+Wr[0].length):-1},B:function Js(Qs,Ma,Va){var Wr=pr.exec(Ma.slice(Va));return Wr?(Qs.m=wr.get(Wr[0].toLowerCase()),Va+Wr[0].length):-1},c:function Zo(Qs,Ma,Va){return hl(Qs,V,Ma,Va)},d:Ha,e:Ha,f:E1,g:Zi,G:Hg,H:Lm,I:Lm,j:RA,L:Vg,m:Mi,M:uh,p:function zc(Qs,Ma,Va){var Wr=Wt.exec(Ma.slice(Va));return Wr?(Qs.p=pn.get(Wr[0].toLowerCase()),Va+Wr[0].length):-1},q:Ci,Q:T1,s:Yc,S:kA,u:w1,U:C1,V:M1,w:Om,W:S1,x:function nu(Qs,Ma,Va){return hl(Qs,Ae,Ma,Va)},X:function iu(Qs,Ma,Va){return hl(Qs,be,Ma,Va)},y:Zi,Y:Hg,Z:wa,"%":pv};function bs(Qs,Ma){return function(Va){var yh,qA,Gx,Wr=[],nd=-1,Sa=0,ec=Qs.length;for(Va instanceof Date||(Va=new Date(+Va));++nd<ec;)37===Qs.charCodeAt(nd)&&(Wr.push(Qs.slice(Sa,nd)),null!=(qA=Dh[yh=Qs.charAt(++nd)])?yh=Qs.charAt(++nd):qA="e"===yh?" ":"0",(Gx=Ma[yh])&&(yh=Gx(Va,qA)),Wr.push(yh),Sa=nd+1);return Wr.push(Qs.slice(Sa,nd)),Wr.join("")}}function Go(Qs,Ma){return function(Va){var Sa,ec,Wr=tp(1900,void 0,1);if(hl(Wr,Qs,Va+="",0)!=Va.length)return null;if("Q"in Wr)return new Date(Wr.Q);if("s"in Wr)return new Date(1e3*Wr.s+("L"in Wr?Wr.L:0));if(Ma&&!("Z"in Wr)&&(Wr.Z=0),"p"in Wr&&(Wr.H=Wr.H%12+12*Wr.p),void 0===Wr.m&&(Wr.m="q"in Wr?Wr.q:0),"V"in Wr){if(Wr.V<1||Wr.V>53)return null;"w"in Wr||(Wr.w=1),"Z"in Wr?(ec=(Sa=Hp(tp(Wr.y,0,1))).getUTCDay(),Sa=ec>4||0===ec?ep.ceil(Sa):ep(Sa),Sa=df.offset(Sa,7*(Wr.V-1)),Wr.y=Sa.getUTCFullYear(),Wr.m=Sa.getUTCMonth(),Wr.d=Sa.getUTCDate()+(Wr.w+6)%7):(ec=(Sa=ff(tp(Wr.y,0,1))).getDay(),Sa=ec>4||0===ec?Jf.ceil(Sa):Jf(Sa),Sa=Kf.offset(Sa,7*(Wr.V-1)),Wr.y=Sa.getFullYear(),Wr.m=Sa.getMonth(),Wr.d=Sa.getDate()+(Wr.w+6)%7)}else("W"in Wr||"U"in Wr)&&("w"in Wr||(Wr.w="u"in Wr?Wr.u%7:"W"in Wr?1:0),ec="Z"in Wr?Hp(tp(Wr.y,0,1)).getUTCDay():ff(tp(Wr.y,0,1)).getDay(),Wr.m=0,Wr.d="W"in Wr?(Wr.w+6)%7+7*Wr.W-(ec+5)%7:Wr.w+7*Wr.U-(ec+6)%7);return"Z"in Wr?(Wr.H+=Wr.Z/100|0,Wr.M+=Wr.Z%100,Hp(Wr)):ff(Wr)}}function hl(Qs,Ma,Va,Wr){for(var yh,qA,nd=0,Sa=Ma.length,ec=Va.length;nd<Sa;){if(Wr>=ec)return-1;if(37===(yh=Ma.charCodeAt(nd++))){if(yh=Ma.charAt(nd++),!(qA=Xs[yh in Dh?Ma.charAt(nd++):yh])||(Wr=qA(Qs,Va,Wr))<0)return-1}else if(yh!=Va.charCodeAt(Wr++))return-1}return Wr}return qr.x=bs(Ae,qr),qr.X=bs(be,qr),qr.c=bs(V,qr),nr.x=bs(Ae,nr),nr.X=bs(be,nr),nr.c=bs(V,nr),{format:function(Qs){var Ma=bs(Qs+="",qr);return Ma.toString=function(){return Qs},Ma},parse:function(Qs){var Ma=Go(Qs+="",!1);return Ma.toString=function(){return Qs},Ma},utcFormat:function(Qs){var Ma=bs(Qs+="",nr);return Ma.toString=function(){return Qs},Ma},utcParse:function(Qs){var Ma=Go(Qs+="",!0);return Ma.toString=function(){return Qs},Ma}}}(y),jg=Af.format,Xg=Af.utcFormat,Av=Af.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Yg="%Y-%m-%dT%H:%M:%S.%LZ";function gv(y){return new Date(y)}function u_(y){return y instanceof Date?+y:+new Date(+y)}function Zg(y,V,Ae,be,Xe,ut,_t,Tt,Gt,Wt){var pn=y1(),Qn=pn.invert,Wn=pn.domain,Ei=Wt(".%L"),kr=Wt(":%S"),pr=Wt("%I:%M"),wr=Wt("%I %p"),Ts=Wt("%a %d"),jo=Wt("%b %d"),qr=Wt("%B"),nr=Wt("%Y");function Xs(bs){return(Gt(bs)<bs?Ei:Tt(bs)<bs?kr:_t(bs)<bs?pr:ut(bs)<bs?wr:be(bs)<bs?Xe(bs)<bs?Ts:jo:Ae(bs)<bs?qr:nr)(bs)}return pn.invert=function(bs){return new Date(Qn(bs))},pn.domain=function(bs){return arguments.length?Wn(Array.from(bs,u_)):Wn().map(gv)},pn.ticks=function(bs){var Go=Wn();return y(Go[0],Go[Go.length-1],bs??10)},pn.tickFormat=function(bs,Go){return null==Go?Xs:Wt(Go)},pn.nice=function(bs){var Go=Wn();return(!bs||"function"!=typeof bs.range)&&(bs=V(Go[0],Go[Go.length-1],bs??10)),bs?Wn(Mh(Go,bs)):pn},pn.copy=function(){return Og(pn,Zg(y,V,Ae,be,Xe,ut,_t,Tt,Gt,Wt))},pn}function Ph(){return _c.apply(Zg(K0,Oc,dh,Rd,Zf,Kf,Yf,ch,Hu,jg).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Nc(y){return function(){return y}}Date.prototype.toISOString||Xg(Yg),+new Date("2000-01-01T00:00:00.000Z")||Av(Yg);const O1=Math.abs,Po=Math.atan2,Oa=Math.cos,cc=Math.max,L1=Math.min,Ca=Math.sin,Wp=Math.sqrt,gd=1e-12,NA=Math.PI,xu=NA/2,vv=2*NA;function e0(y){return y>=1?xu:y<=-1?-xu:Math.asin(y)}function ds(y){return y.innerRadius}function Ah(y){return y.outerRadius}function Hm(y){return y.startAngle}function N1(y){return y.endAngle}function U1(y){return y&&y.padAngle}function UA(y,V,Ae,be,Xe,ut,_t){var Tt=y-Ae,Gt=V-be,Wt=(_t?ut:-ut)/Wp(Tt*Tt+Gt*Gt),pn=Wt*Gt,Qn=-Wt*Tt,Wn=y+pn,Ei=V+Qn,kr=Ae+pn,pr=be+Qn,wr=(Wn+kr)/2,Ts=(Ei+pr)/2,jo=kr-Wn,qr=pr-Ei,nr=jo*jo+qr*qr,Xs=Xe-ut,bs=Wn*pr-kr*Ei,Go=(qr<0?-1:1)*Wp(cc(0,Xs*Xs*nr-bs*bs)),hl=(bs*qr-jo*Go)/nr,zc=(-bs*jo-qr*Go)/nr,dc=(bs*qr+jo*Go)/nr,ao=(-bs*jo+qr*Go)/nr,wl=hl-wr,Js=zc-Ts,Zo=dc-wr,nu=ao-Ts;return wl*wl+Js*Js>Zo*Zo+nu*nu&&(hl=dc,zc=ao),{cx:hl,cy:zc,x01:-pn,y01:-Qn,x11:hl*(Xe/Xs-1),y11:zc*(Xe/Xs-1)}}function xv(){var y=ds,V=Ah,Ae=Nc(0),be=null,Xe=Hm,ut=N1,_t=U1,Tt=null,Gt=function Ko(y){let V=3;return y.digits=function(Ae){if(!arguments.length)return V;if(null==Ae)V=null;else{const be=Math.floor(Ae);if(!(be>=0))throw new RangeError(`invalid digits: ${Ae}`);V=be}return y},()=>new Ln(V)}(Wt);function Wt(){var pn,Qn,Wn=+y.apply(this,arguments),Ei=+V.apply(this,arguments),kr=Xe.apply(this,arguments)-xu,pr=ut.apply(this,arguments)-xu,wr=O1(pr-kr),Ts=pr>kr;if(Tt||(Tt=pn=Gt()),Ei<Wn&&(Qn=Ei,Ei=Wn,Wn=Qn),Ei>gd)if(wr>vv-gd)Tt.moveTo(Ei*Oa(kr),Ei*Ca(kr)),Tt.arc(0,0,Ei,kr,pr,!Ts),Wn>gd&&(Tt.moveTo(Wn*Oa(pr),Wn*Ca(pr)),Tt.arc(0,0,Wn,pr,kr,Ts));else{var Js,Zo,jo=kr,qr=pr,nr=kr,Xs=pr,bs=wr,Go=wr,hl=_t.apply(this,arguments)/2,zc=hl>gd&&(be?+be.apply(this,arguments):Wp(Wn*Wn+Ei*Ei)),dc=L1(O1(Ei-Wn)/2,+Ae.apply(this,arguments)),ao=dc,wl=dc;if(zc>gd){var nu=e0(zc/Wn*Ca(hl)),iu=e0(zc/Ei*Ca(hl));(bs-=2*nu)>gd?(nr+=nu*=Ts?1:-1,Xs-=nu):(bs=0,nr=Xs=(kr+pr)/2),(Go-=2*iu)>gd?(jo+=iu*=Ts?1:-1,qr-=iu):(Go=0,jo=qr=(kr+pr)/2)}var td=Ei*Oa(jo),Ld=Ei*Ca(jo),Jl=Wn*Oa(Xs),cp=Wn*Ca(Xs);if(dc>gd){var _h,o0=Ei*Oa(qr),a0=Ei*Ca(qr),Xm=Wn*Oa(nr),em=Wn*Ca(nr);if(wr<NA)if(_h=function z1(y,V,Ae,be,Xe,ut,_t,Tt){var Gt=Ae-y,Wt=be-V,pn=_t-Xe,Qn=Tt-ut,Wn=Qn*Gt-pn*Wt;if(!(Wn*Wn<gd))return[y+(Wn=(pn*(V-ut)-Qn*(y-Xe))/Wn)*Gt,V+Wn*Wt]}(td,Ld,Xm,em,o0,a0,Jl,cp)){var l0=td-_h[0],c0=Ld-_h[1],xf=o0-_h[0],Qs=a0-_h[1],Ma=1/Ca(function bv(y){return y>1?0:y<-1?NA:Math.acos(y)}((l0*xf+c0*Qs)/(Wp(l0*l0+c0*c0)*Wp(xf*xf+Qs*Qs)))/2),Va=Wp(_h[0]*_h[0]+_h[1]*_h[1]);ao=L1(dc,(Wn-Va)/(Ma-1)),wl=L1(dc,(Ei-Va)/(Ma+1))}else ao=wl=0}Go>gd?wl>gd?(Js=UA(Xm,em,td,Ld,Ei,wl,Ts),Zo=UA(o0,a0,Jl,cp,Ei,wl,Ts),Tt.moveTo(Js.cx+Js.x01,Js.cy+Js.y01),wl<dc?Tt.arc(Js.cx,Js.cy,wl,Po(Js.y01,Js.x01),Po(Zo.y01,Zo.x01),!Ts):(Tt.arc(Js.cx,Js.cy,wl,Po(Js.y01,Js.x01),Po(Js.y11,Js.x11),!Ts),Tt.arc(0,0,Ei,Po(Js.cy+Js.y11,Js.cx+Js.x11),Po(Zo.cy+Zo.y11,Zo.cx+Zo.x11),!Ts),Tt.arc(Zo.cx,Zo.cy,wl,Po(Zo.y11,Zo.x11),Po(Zo.y01,Zo.x01),!Ts))):(Tt.moveTo(td,Ld),Tt.arc(0,0,Ei,jo,qr,!Ts)):Tt.moveTo(td,Ld),Wn>gd&&bs>gd?ao>gd?(Js=UA(Jl,cp,o0,a0,Wn,-ao,Ts),Zo=UA(td,Ld,Xm,em,Wn,-ao,Ts),Tt.lineTo(Js.cx+Js.x01,Js.cy+Js.y01),ao<dc?Tt.arc(Js.cx,Js.cy,ao,Po(Js.y01,Js.x01),Po(Zo.y01,Zo.x01),!Ts):(Tt.arc(Js.cx,Js.cy,ao,Po(Js.y01,Js.x01),Po(Js.y11,Js.x11),!Ts),Tt.arc(0,0,Wn,Po(Js.cy+Js.y11,Js.cx+Js.x11),Po(Zo.cy+Zo.y11,Zo.cx+Zo.x11),Ts),Tt.arc(Zo.cx,Zo.cy,ao,Po(Zo.y11,Zo.x11),Po(Zo.y01,Zo.x01),!Ts))):Tt.arc(0,0,Wn,Xs,nr,Ts):Tt.lineTo(Jl,cp)}else Tt.moveTo(0,0);if(Tt.closePath(),pn)return Tt=null,pn+""||null}return Wt.centroid=function(){var pn=(+y.apply(this,arguments)+ +V.apply(this,arguments))/2,Qn=(+Xe.apply(this,arguments)+ +ut.apply(this,arguments))/2-NA/2;return[Oa(Qn)*pn,Ca(Qn)*pn]},Wt.innerRadius=function(pn){return arguments.length?(y="function"==typeof pn?pn:Nc(+pn),Wt):y},Wt.outerRadius=function(pn){return arguments.length?(V="function"==typeof pn?pn:Nc(+pn),Wt):V},Wt.cornerRadius=function(pn){return arguments.length?(Ae="function"==typeof pn?pn:Nc(+pn),Wt):Ae},Wt.padRadius=function(pn){return arguments.length?(be=null==pn?null:"function"==typeof pn?pn:Nc(+pn),Wt):be},Wt.startAngle=function(pn){return arguments.length?(Xe="function"==typeof pn?pn:Nc(+pn),Wt):Xe},Wt.endAngle=function(pn){return arguments.length?(ut="function"==typeof pn?pn:Nc(+pn),Wt):ut},Wt.padAngle=function(pn){return arguments.length?(_t="function"==typeof pn?pn:Nc(+pn),Wt):_t},Wt.context=function(pn){return arguments.length?(Tt=pn??null,Wt):Tt},Wt}var Al,jp,sp=0,Vl=0,Zl=0,gf=1e3,zA=0,op=0,kd=0,xl="object"==typeof performance&&performance.now?performance:Date,t0="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(y){setTimeout(y,17)};function Uc(){return op||(t0(m_),op=xl.now()+kd)}function m_(){op=0}function HA(){this._call=this._time=this._next=null}function Vm(y,V,Ae){var be=new HA;return be.restart(y,V,Ae),be}function n0(){op=(zA=xl.now())+kd,sp=Vl=0;try{!function H1(){Uc(),++sp;for(var V,y=Al;y;)(V=op-y._time)>=0&&y._call.call(void 0,V),y=y._next;--sp}()}finally{sp=0,function VA(){for(var y,Ae,V=Al,be=1/0;V;)V._call?(be>V._time&&(be=V._time),y=V,V=V._next):(Ae=V._next,V._next=null,V=y?y._next=Ae:Al=Ae);jp=y,A_(be)}(),op=0}}function Gm(){var y=xl.now(),V=y-zA;V>gf&&(kd-=V,zA=y)}function A_(y){sp||(Vl&&(Vl=clearTimeout(Vl)),y-op>24?(y<1/0&&(Vl=setTimeout(n0,y-xl.now()-kd)),Zl&&(Zl=clearInterval(Zl))):(Zl||(zA=xl.now(),Zl=setInterval(Gm,gf)),sp=1,t0(n0)))}function g_(y,V,Ae){var be=new HA;return be.restart(Xe=>{be.stop(),y(Xe+V)},V=null==V?0:+V,Ae),be}HA.prototype=Vm.prototype={constructor:HA,restart:function(y,V,Ae){if("function"!=typeof y)throw new TypeError("callback is not a function");Ae=(null==Ae?Uc():+Ae)+(null==V?0:+V),!this._next&&jp!==this&&(jp?jp._next=this:Al=this,jp=this),this._call=y,this._time=Ae,A_()},stop:function(){this._call&&(this._call=null,this._time=1/0,A_())}};var qm=wn("start","end","cancel","interrupt"),oo=[],Qm=0,Ls=3;function s0(y,V,Ae,be,Xe,ut){var _t=y.__transition;if(_t){if(Ae in _t)return}else y.__transition={};!function ae(y,V,Ae){var Xe,be=y.__transition;function _t(Wt){var pn,Qn,Wn,Ei;if(1!==Ae.state)return Gt();for(pn in be)if((Ei=be[pn]).name===Ae.name){if(Ei.state===Ls)return g_(_t);4===Ei.state?(Ei.state=6,Ei.timer.stop(),Ei.on.call("interrupt",y,y.__data__,Ei.index,Ei.group),delete be[pn]):+pn<V&&(Ei.state=6,Ei.timer.stop(),Ei.on.call("cancel",y,y.__data__,Ei.index,Ei.group),delete be[pn])}if(g_(function(){Ae.state===Ls&&(Ae.state=4,Ae.timer.restart(Tt,Ae.delay,Ae.time),Tt(Wt))}),Ae.state=2,Ae.on.call("start",y,y.__data__,Ae.index,Ae.group),2===Ae.state){for(Ae.state=Ls,Xe=new Array(Wn=Ae.tween.length),pn=0,Qn=-1;pn<Wn;++pn)(Ei=Ae.tween[pn].value.call(y,y.__data__,Ae.index,Ae.group))&&(Xe[++Qn]=Ei);Xe.length=Qn+1}}function Tt(Wt){for(var pn=Wt<Ae.duration?Ae.ease.call(null,Wt/Ae.duration):(Ae.timer.restart(Gt),Ae.state=5,1),Qn=-1,Wn=Xe.length;++Qn<Wn;)Xe[Qn].call(y,pn);5===Ae.state&&(Ae.on.call("end",y,y.__data__,Ae.index,Ae.group),Gt())}function Gt(){for(var Wt in Ae.state=6,Ae.timer.stop(),delete be[V],be)return;delete y.__transition}be[V]=Ae,Ae.timer=Vm(function ut(Wt){Ae.state=1,Ae.timer.restart(_t,Ae.delay,Ae.time),Ae.delay<=Wt&&_t(Wt-Ae.delay)},0,Ae.time)}(y,Ae,{name:V,index:be,group:Xe,on:qm,tween:oo,time:ut.time,delay:ut.delay,duration:ut.duration,ease:ut.ease,timer:null,state:Qm})}function ne(y,V){var Ae=le(y,V);if(Ae.state>Qm)throw new Error("too late; already scheduled");return Ae}function j(y,V){var Ae=le(y,V);if(Ae.state>Ls)throw new Error("too late; already running");return Ae}function le(y,V){var Ae=y.__transition;if(!Ae||!(Ae=Ae[V]))throw new Error("transition not found");return Ae}function Bt(y,V){var Ae,be;return function(){var Xe=j(this,y),ut=Xe.tween;if(ut!==Ae)for(var _t=0,Tt=(be=Ae=ut).length;_t<Tt;++_t)if(be[_t].name===V){(be=be.slice()).splice(_t,1);break}Xe.tween=be}}function ln(y,V,Ae){var be,Xe;if("function"!=typeof Ae)throw new Error;return function(){var ut=j(this,y),_t=ut.tween;if(_t!==be){Xe=(be=_t).slice();for(var Tt={name:V,value:Ae},Gt=0,Wt=Xe.length;Gt<Wt;++Gt)if(Xe[Gt].name===V){Xe[Gt]=Tt;break}Gt===Wt&&Xe.push(Tt)}ut.tween=Xe}}function jn(y,V,Ae){var be=y._id;return y.each(function(){var Xe=j(this,be);(Xe.value||(Xe.value={}))[V]=Ae.apply(this,arguments)}),function(Xe){return le(Xe,be).value[V]}}function Zn(y,V){var Ae;return("number"==typeof V?yc:V instanceof A?Kd:(Ae=A(V))?(V=Ae,Kd):kg)(y,V)}function ri(y){return function(){this.removeAttribute(y)}}function Xi(y){return function(){this.removeAttributeNS(y.space,y.local)}}function Ss(y,V,Ae){var be,ut,Xe=Ae+"";return function(){var _t=this.getAttribute(y);return _t===Xe?null:_t===be?ut:ut=V(be=_t,Ae)}}function zr(y,V,Ae){var be,ut,Xe=Ae+"";return function(){var _t=this.getAttributeNS(y.space,y.local);return _t===Xe?null:_t===be?ut:ut=V(be=_t,Ae)}}function Hr(y,V,Ae){var be,Xe,ut;return function(){var _t,Gt,Tt=Ae(this);return null==Tt?void this.removeAttribute(y):(_t=this.getAttribute(y))===(Gt=Tt+"")?null:_t===be&&Gt===Xe?ut:(Xe=Gt,ut=V(be=_t,Tt))}}function Ho(y,V,Ae){var be,Xe,ut;return function(){var _t,Gt,Tt=Ae(this);return null==Tt?void this.removeAttributeNS(y.space,y.local):(_t=this.getAttributeNS(y.space,y.local))===(Gt=Tt+"")?null:_t===be&&Gt===Xe?ut:(Xe=Gt,ut=V(be=_t,Tt))}}function Xo(y,V){var Ae,be;function Xe(){var ut=V.apply(this,arguments);return ut!==be&&(Ae=(be=ut)&&function So(y,V){return function(Ae){this.setAttributeNS(y.space,y.local,V.call(this,Ae))}}(y,ut)),Ae}return Xe._value=V,Xe}function Fo(y,V){var Ae,be;function Xe(){var ut=V.apply(this,arguments);return ut!==be&&(Ae=(be=ut)&&function Jr(y,V){return function(Ae){this.setAttribute(y,V.call(this,Ae))}}(y,ut)),Ae}return Xe._value=V,Xe}function La(y,V){return function(){ne(this,y).delay=+V.apply(this,arguments)}}function Ba(y,V){return V=+V,function(){ne(this,y).delay=V}}function wc(y,V){return function(){j(this,y).duration=+V.apply(this,arguments)}}function tu(y,V){return V=+V,function(){j(this,y).duration=V}}var GA=Fu.prototype.constructor;function zx(y){return function(){this.style.removeProperty(y)}}var lT=0;function Zp(y,V,Ae,be){this._groups=y,this._parents=V,this._name=Ae,this._id=be}function G1(){return++lT}var Fh=Fu.prototype;Zp.prototype=function V1(y){return Fu().transition(y)}.prototype={constructor:Zp,select:function Yp(y){var V=this._name,Ae=this._id;"function"!=typeof y&&(y=qn(y));for(var be=this._groups,Xe=be.length,ut=new Array(Xe),_t=0;_t<Xe;++_t)for(var pn,Qn,Tt=be[_t],Gt=Tt.length,Wt=ut[_t]=new Array(Gt),Wn=0;Wn<Gt;++Wn)(pn=Tt[Wn])&&(Qn=y.call(pn,pn.__data__,Wn,Tt))&&("__data__"in pn&&(Qn.__data__=pn.__data__),Wt[Wn]=Qn,s0(Wt[Wn],V,Ae,Wn,Wt,le(pn,Ae)));return new Zp(ut,this._parents,V,Ae)},selectAll:function kh(y){var V=this._name,Ae=this._id;"function"!=typeof y&&(y=Kr(y));for(var be=this._groups,Xe=be.length,ut=[],_t=[],Tt=0;Tt<Xe;++Tt)for(var pn,Gt=be[Tt],Wt=Gt.length,Qn=0;Qn<Wt;++Qn)if(pn=Gt[Qn]){for(var Ei,Wn=y.call(pn,pn.__data__,Qn,Gt),kr=le(pn,Ae),pr=0,wr=Wn.length;pr<wr;++pr)(Ei=Wn[pr])&&s0(Ei,V,Ae,pr,Wn,kr);ut.push(Wn),_t.push(pn)}return new Zp(ut,_t,V,Ae)},selectChild:Fh.selectChild,selectChildren:Fh.selectChildren,filter:function Fd(y){"function"!=typeof y&&(y=Vs(y));for(var V=this._groups,Ae=V.length,be=new Array(Ae),Xe=0;Xe<Ae;++Xe)for(var Gt,ut=V[Xe],_t=ut.length,Tt=be[Xe]=[],Wt=0;Wt<_t;++Wt)(Gt=ut[Wt])&&y.call(Gt,Gt.__data__,Wt,ut)&&Tt.push(Gt);return new Zp(be,this._parents,this._name,this._id)},merge:function lp(y){if(y._id!==this._id)throw new Error;for(var V=this._groups,Ae=y._groups,be=V.length,ut=Math.min(be,Ae.length),_t=new Array(be),Tt=0;Tt<ut;++Tt)for(var Wn,Gt=V[Tt],Wt=Ae[Tt],pn=Gt.length,Qn=_t[Tt]=new Array(pn),Ei=0;Ei<pn;++Ei)(Wn=Gt[Ei]||Wt[Ei])&&(Qn[Ei]=Wn);for(;Tt<be;++Tt)_t[Tt]=V[Tt];return new Zp(_t,this._parents,this._name,this._id)},selection:function jm(){return new GA(this._groups,this._parents)},transition:function qC(){for(var y=this._name,V=this._id,Ae=G1(),be=this._groups,Xe=be.length,ut=0;ut<Xe;++ut)for(var Gt,_t=be[ut],Tt=_t.length,Wt=0;Wt<Tt;++Wt)if(Gt=_t[Wt]){var pn=le(Gt,V);s0(Gt,y,Ae,Wt,_t,{time:pn.time+pn.delay+pn.duration,delay:0,duration:pn.duration,ease:pn.ease})}return new Zp(be,this._parents,y,Ae)},call:Fh.call,nodes:Fh.nodes,node:Fh.node,size:Fh.size,empty:Fh.empty,each:Fh.each,on:function $p(y,V){var Ae=this._id;return arguments.length<2?le(this.node(),Ae).on.on(y):this.each(function vf(y,V,Ae){var be,Xe,ut=function gh(y){return(y+"").trim().split(/^|\s+/).every(function(V){var Ae=V.indexOf(".");return Ae>=0&&(V=V.slice(0,Ae)),!V||"start"===V})}(V)?ne:j;return function(){var _t=ut(this,y),Tt=_t.on;Tt!==be&&(Xe=(be=Tt).copy()).on(V,Ae),_t.on=Xe}}(Ae,y,V))},attr:function Ns(y,V){var Ae=vn(y),be="transform"===Ae?W0:Zn;return this.attrTween(y,"function"==typeof V?(Ae.local?Ho:Hr)(Ae,be,jn(this,"attr."+y,V)):null==V?(Ae.local?Xi:ri)(Ae):(Ae.local?zr:Ss)(Ae,be,V))},attrTween:function Es(y,V){var Ae="attr."+y;if(arguments.length<2)return(Ae=this.tween(Ae))&&Ae._value;if(null==V)return this.tween(Ae,null);if("function"!=typeof V)throw new Error;var be=vn(y);return this.tween(Ae,(be.local?Xo:Fo)(be,V))},style:function wv(y,V,Ae){var be="transform"==(y+="")?Pp:Zn;return null==V?this.styleTween(y,function zC(y,V){var Ae,be,Xe;return function(){var ut=go(this,y),_t=(this.style.removeProperty(y),go(this,y));return ut===_t?null:ut===Ae&&_t===be?Xe:Xe=V(Ae=ut,be=_t)}}(y,be)).on("end.style."+y,zx(y)):"function"==typeof V?this.styleTween(y,function HC(y,V,Ae){var be,Xe,ut;return function(){var _t=go(this,y),Tt=Ae(this),Gt=Tt+"";return null==Tt&&(this.style.removeProperty(y),Gt=Tt=go(this,y)),_t===Gt?null:_t===be&&Gt===Xe?ut:(Xe=Gt,ut=V(be=_t,Tt))}}(y,be,jn(this,"style."+y,V))).each(function Hx(y,V){var Ae,be,Xe,Tt,ut="style."+V,_t="end."+ut;return function(){var Gt=j(this,y),Wt=Gt.on,pn=null==Gt.value[ut]?Tt||(Tt=zx(V)):void 0;(Wt!==Ae||Xe!==pn)&&(be=(Ae=Wt).copy()).on(_t,Xe=pn),Gt.on=be}}(this._id,y)):this.styleTween(y,function oT(y,V,Ae){var be,ut,Xe=Ae+"";return function(){var _t=go(this,y);return _t===Xe?null:_t===be?ut:ut=V(be=_t,Ae)}}(y,be,V),Ae).on("end.style."+y,null)},styleTween:function y_(y,V,Ae){var be="style."+(y+="");if(arguments.length<2)return(be=this.tween(be))&&be._value;if(null==V)return this.tween(be,null);if("function"!=typeof V)throw new Error;return this.tween(be,function $m(y,V,Ae){var be,Xe;function ut(){var _t=V.apply(this,arguments);return _t!==Xe&&(be=(Xe=_t)&&function VC(y,V,Ae){return function(be){this.style.setProperty(y,V.call(this,be),Ae)}}(y,_t,Ae)),be}return ut._value=V,ut}(y,V,Ae??""))},text:function Kp(y){return this.tween("text","function"==typeof y?function Vx(y){return function(){var V=y(this);this.textContent=V??""}}(jn(this,"text",y)):function GC(y){return function(){this.textContent=y}}(null==y?"":y+""))},textTween:function Cv(y){var V="text";if(arguments.length<1)return(V=this.tween(V))&&V._value;if(null==y)return this.tween(V,null);if("function"!=typeof y)throw new Error;return this.tween(V,function Od(y){var V,Ae;function be(){var Xe=y.apply(this,arguments);return Xe!==Ae&&(V=(Ae=Xe)&&function aT(y){return function(V){this.textContent=y.call(this,V)}}(Xe)),V}return be._value=y,be}(y))},remove:function bf(){return this.on("end.remove",function Xp(y){return function(){var V=this.parentNode;for(var Ae in this.__transition)if(+Ae!==y)return;V&&V.removeChild(this)}}(this._id))},tween:function on(y,V){var Ae=this._id;if(y+="",arguments.length<2){for(var _t,be=le(this.node(),Ae).tween,Xe=0,ut=be.length;Xe<ut;++Xe)if((_t=be[Xe]).name===y)return _t.value;return null}return this.each((null==V?Bt:ln)(Ae,y,V))},delay:function Vo(y){var V=this._id;return arguments.length?this.each(("function"==typeof y?La:Ba)(V,y)):le(this.node(),V).delay},duration:function wu(y){var V=this._id;return arguments.length?this.each(("function"==typeof y?wc:tu)(V,y)):le(this.node(),V).duration},ease:function Kc(y){var V=this._id;return arguments.length?this.each(function ul(y,V){if("function"!=typeof V)throw new Error;return function(){j(this,y).ease=V}}(V,y)):le(this.node(),V).ease},easeVarying:function ed(y){if("function"!=typeof y)throw new Error;return this.each(function yf(y,V){return function(){var Ae=V.apply(this,arguments);if("function"!=typeof Ae)throw new Error;j(this,y).ease=Ae}}(this._id,y))},end:function QC(){var y,V,Ae=this,be=Ae._id,Xe=Ae.size();return new Promise(function(ut,_t){var Tt={value:_t},Gt={value:function(){0==--Xe&&ut()}};Ae.each(function(){var Wt=j(this,be),pn=Wt.on;pn!==y&&((V=(y=pn).copy())._.cancel.push(Tt),V._.interrupt.push(Tt),V._.end.push(Gt)),Wt.on=V}),0===Xe&&ut()})},[Symbol.iterator]:Fh[Symbol.iterator]};var Jp={time:null,delay:0,duration:250,ease:function Mv(y){return((y*=2)<=1?y*y*y:(y-=2)*y*y+2)/2}};function q1(y,V){for(var Ae;!(Ae=y.__transition)||!(Ae=Ae[V]);)if(!(y=y.parentNode))throw new Error(`transition ${V} not found`);return Ae}Fu.prototype.interrupt=function dt(y){return this.each(function(){!function Ue(y,V){var be,Xe,_t,Ae=y.__transition,ut=!0;if(Ae){for(_t in V=null==V?null:V+"",Ae)(be=Ae[_t]).name===V?(Xe=be.state>2&&be.state<5,be.state=6,be.timer.stop(),be.on.call(Xe?"interrupt":"cancel",y,y.__data__,be.index,be.group),delete Ae[_t]):ut=!1;ut&&delete y.__transition}}(this,y)})},Fu.prototype.transition=function Sv(y){var V,Ae;y instanceof Zp?(V=y._id,y=y._name):(V=G1(),(Ae=Jp).time=Uc(),y=null==y?null:y+"");for(var be=this._groups,Xe=be.length,ut=0;ut<Xe;++ut)for(var Gt,_t=be[ut],Tt=_t.length,Wt=0;Wt<Tt;++Wt)(Gt=_t[Wt])&&s0(Gt,y,V,Wt,_t,Ae||q1(Gt,V));return new Zp(be,this._parents,y,V)}},6923:(Yr,mt,Se)=>{"use strict";Se.d(mt,{$2:()=>he,AI:()=>b,Xv:()=>k,hd:()=>U,iO:()=>Z,uA:()=>I});var Ee=Se(4882),L=(Se(8362),Se(8872)),ve=Se(4369),ke=Se(1949),ot=Se(2843),Ye=Se(1922),Ze=Se(5102);function Re(){return He.apply(this,arguments)}function He(){return(He=(0,Ee.A)(function*(){return Se.e(653).then(Se.bind(Se,7653))})).apply(this,arguments)}function Ve(){return De.apply(this,arguments)}function De(){return(De=(0,Ee.A)(function*(){return Promise.resolve().then(Se.bind(Se,4483))})).apply(this,arguments)}function F(){return J.apply(this,arguments)}function J(){return(J=(0,Ee.A)(function*(){return Promise.all([Se.e(679),Se.e(76),Se.e(122)]).then(Se.bind(Se,1122))})).apply(this,arguments)}function Y(){return ue.apply(this,arguments)}function ue(){return(ue=(0,Ee.A)(function*(){return Promise.resolve().then(Se.bind(Se,6043))})).apply(this,arguments)}function Q(){return me.apply(this,arguments)}function me(){return(me=(0,Ee.A)(function*(){return Promise.resolve().then(Se.bind(Se,2454)).then(te=>{const Je=U(L.prROOT+"TGeoVolumeAssembly");return Je&&(Je.icon="img_geoassembly"),te})})).apply(this,arguments)}const X="TGraph2D",B="TH2Poly",$="TEllipse",A="TSpline3",E="TTree",g="TCanvasWebSnapshot",v="fPrimitives",f="fFunctions",C={lst:[{name:L.clTCanvas,icon:"img_canvas",class:()=>Ve().then(te=>te.TCanvasPainter),opt:";grid;gridx;gridy;tick;tickx;ticky;log;logx;logy;logz",expand_item:v,noappend:!0},{name:L.clTPad,icon:"img_canvas",func:Ze.jg.draw,opt:";grid;gridx;gridy;tick;tickx;ticky;log;logx;logy;logz",expand_item:v,noappend:!0},{name:"TSlider",icon:"img_canvas",func:Ze.jg.draw},{name:Ze.cw,icon:"img_canvas",func:Ze.jg.draw},{name:"TFrame",icon:"img_frame",draw:()=>Ve().then(te=>te.drawTFrame)},{name:L.clTPave,icon:"img_pavetext",class:()=>Promise.resolve().then(Se.bind(Se,5891)).then(te=>te.TPavePainter)},{name:L.clTPaveText,sameas:L.clTPave},{name:L.clTPavesText,sameas:L.clTPave},{name:L.clTPaveStats,sameas:L.clTPave},{name:L.clTPaveLabel,sameas:L.clTPave},{name:L.clTPaveClass,sameas:L.clTPave},{name:L.clTDiamond,sameas:L.clTPave},{name:L.clTLegend,icon:"img_pavelabel",sameas:L.clTPave},{name:L.clTPaletteAxis,icon:"img_colz",sameas:L.clTPave},{name:L.clTLatex,icon:"img_text",draw:()=>Re().then(te=>te.drawText),direct:!0},{name:L.clTMathText,sameas:L.clTLatex},{name:L.clTText,sameas:L.clTLatex},{name:L.clTAnnotation,sameas:L.clTLatex},{name:/^TH1/,icon:"img_histo1d",class:()=>Promise.resolve().then(Se.bind(Se,8142)).then(te=>te.TH1Painter),opt:";hist;P;P0;E;E1;E2;E3;E4;E1X0;L;LF2;C;B;B1;A;TEXT;LEGO;same",ctrl:"l",expand_item:f,for_derived:!0},{name:L.clTProfile,icon:"img_profile",class:()=>Promise.resolve().then(Se.bind(Se,8142)).then(te=>te.TH1Painter),opt:";E0;E1;E2;p;AH;hist",expand_item:f},{name:B,icon:"img_histo2d",class:()=>Promise.resolve().then(Se.bind(Se,4355)).then(te=>te.TH2Painter),opt:";COL;COL0;COLZ;LCOL;LCOL0;LCOLZ;LEGO;TEXT;same",expand_item:"fBins",theonly:!0},{name:"TProfile2Poly",sameas:B},{name:"TH2PolyBin",icon:"img_histo2d",draw_field:"fPoly",draw_field_opt:"L"},{name:/^TH2/,icon:"img_histo2d",class:()=>Promise.resolve().then(Se.bind(Se,4355)).then(te=>te.TH2Painter),dflt:"col",opt:";COL;COLZ;COL0;COL1;COL0Z;COL1Z;COLA;BOX;BOX1;PROJ;PROJX1;PROJX2;PROJX3;PROJY1;PROJY2;PROJY3;SCAT;TEXT;TEXTE;TEXTE0;CANDLE;CANDLE1;CANDLE2;CANDLE3;CANDLE4;CANDLE5;CANDLE6;CANDLEY1;CANDLEY2;CANDLEY3;CANDLEY4;CANDLEY5;CANDLEY6;VIOLIN;VIOLIN1;VIOLIN2;VIOLINY1;VIOLINY2;CONT;CONT1;CONT2;CONT3;CONT4;ARR;SURF;SURF1;SURF2;SURF4;SURF6;E;A;LEGO;LEGO0;LEGO1;LEGO2;LEGO3;LEGO4;same",ctrl:"lego",expand_item:f,for_derived:!0},{name:L.clTProfile2D,sameas:L.clTH2},{name:/^TH3/,icon:"img_histo3d",class:()=>Promise.resolve().then(Se.bind(Se,1828)).then(te=>te.TH3Painter),opt:";SCAT;BOX;BOX2;BOX3;GLBOX1;GLBOX2;GLCOL",expand_item:f,for_derived:!0},{name:L.clTProfile3D,sameas:L.clTH3},{name:L.clTHStack,icon:"img_histo1d",class:()=>Se.e(217).then(Se.bind(Se,217)).then(te=>te.THStackPainter),expand_item:"fHists",opt:"NOSTACK;HIST;E;PFC;PLC"},{name:L.clTPolyMarker3D,icon:"img_histo3d",draw:()=>Promise.all([Se.e(76),Se.e(289)]).then(Se.bind(Se,4289)).then(te=>te.drawPolyMarker3D),direct:!0,frame:"3d"},{name:L.clTPolyLine3D,icon:"img_graph",draw:()=>Promise.all([Se.e(76),Se.e(289)]).then(Se.bind(Se,4289)).then(te=>te.drawPolyLine3D),direct:!0,frame:"3d"},{name:"TGraphStruct"},{name:"TGraphNode"},{name:"TGraphEdge"},{name:L.clTGraphTime,icon:"img_graph",class:()=>Se.e(280).then(Se.bind(Se,7280)).then(te=>te.TGraphTimePainter),opt:"once;repeat;first",theonly:!0},{name:X,icon:"img_graph",class:()=>Se.e(763).then(Se.bind(Se,5763)).then(te=>te.TGraph2DPainter),opt:";P;PCOL",theonly:!0},{name:L.clTGraph2DErrors,sameas:X,opt:";P;PCOL;ERR",theonly:!0},{name:L.clTGraph2DAsymmErrors,sameas:X,opt:";P;PCOL;ERR",theonly:!0},{name:L.clTGraphPolargram,icon:"img_graph",class:()=>Se.e(675).then(Se.bind(Se,6675)).then(te=>te.TGraphPolargramPainter),theonly:!0},{name:L.clTGraphPolar,icon:"img_graph",class:()=>Se.e(675).then(Se.bind(Se,6675)).then(te=>te.TGraphPolarPainter),opt:";F;L;P;PE",theonly:!0},{name:/^TGraph/,icon:"img_graph",class:()=>Se.e(679).then(Se.bind(Se,2679)).then(te=>te.TGraphPainter),opt:";L;P"},{name:"TEfficiency",icon:"img_graph",class:()=>Promise.all([Se.e(679),Se.e(508)]).then(Se.bind(Se,1508)).then(te=>te.TEfficiencyPainter),opt:";AP"},{name:L.clTCutG,sameas:L.clTGraph},{name:/^RooHist/,sameas:L.clTGraph},{name:/^RooCurve/,sameas:L.clTGraph},{name:"TScatter",icon:"img_graph",class:()=>Promise.all([Se.e(679),Se.e(165)]).then(Se.bind(Se,1165)).then(te=>te.TScatterPainter),opt:";A"},{name:"RooPlot",icon:"img_canvas",func:function lt(te,Je){return bt.apply(this,arguments)}},{name:"TRatioPlot",icon:"img_mgraph",class:()=>Promise.all([Se.e(76),Se.e(103)]).then(Se.bind(Se,6103)).then(te=>te.TRatioPlotPainter),opt:""},{name:L.clTMultiGraph,icon:"img_mgraph",class:()=>Promise.all([Se.e(679),Se.e(76),Se.e(642)]).then(Se.bind(Se,6642)).then(te=>te.TMultiGraphPainter),opt:";l;p;3d",expand_item:"fGraphs"},{name:ve.R0,icon:"img_question",draw:()=>Y().then(te=>te.drawStreamerInfo)},{name:"TWebPainting",icon:"img_graph",class:()=>Se.e(445).then(Se.bind(Se,9445)).then(te=>te.TWebPaintingPainter)},{name:g,icon:"img_canvas",draw:()=>Ve().then(te=>te.drawTPadSnapshot)},{name:"TPadWebSnapshot",sameas:g},{name:"kind:Text",icon:"img_text",func:Ye.as},{name:L.clTObjString,icon:"img_text",func:Ye.as},{name:L.clTF1,icon:"img_tf1",class:()=>Promise.resolve().then(Se.bind(Se,8868)).then(te=>te.TF1Painter),opt:";L;C;FC;FL"},{name:L.clTF2,icon:"img_tf2",class:()=>Se.e(781).then(Se.bind(Se,2781)).then(te=>te.TF2Painter),opt:";BOX;ARR;SURF;SURF1;SURF2;SURF4;SURF6;LEGO;LEGO0;LEGO1;LEGO2;LEGO3;LEGO4;same"},{name:L.clTF3,icon:"img_histo3d",class:()=>Se.e(734).then(Se.bind(Se,4734)).then(te=>te.TF3Painter),opt:";SURF"},{name:A,icon:"img_tf1",class:()=>Se.e(246).then(Se.bind(Se,5246)).then(te=>te.TSplinePainter)},{name:"TSpline5",sameas:A},{name:$,icon:"img_graph",draw:()=>Re().then(te=>te.drawEllipse),direct:!0},{name:"TArc",sameas:$},{name:"TCrown",sameas:$},{name:"TPie",icon:"img_graph",draw:()=>Re().then(te=>te.drawPie),direct:!0},{name:"TPieSlice",icon:"img_graph",dummy:!0},{name:"TExec",icon:"img_graph",dummy:!0},{name:L.clTLine,icon:"img_graph",class:()=>Se.e(76).then(Se.bind(Se,801)).then(te=>te.TLinePainter)},{name:"TArrow",icon:"img_graph",class:()=>Promise.all([Se.e(76),Se.e(302)]).then(Se.bind(Se,3302)).then(te=>te.TArrowPainter)},{name:L.clTPolyLine,icon:"img_graph",draw:()=>Re().then(te=>te.drawPolyLine),direct:!0},{name:"TCurlyLine",sameas:L.clTPolyLine},{name:"TCurlyArc",sameas:L.clTPolyLine},{name:"TParallelCoord",icon:"img_graph",dummy:!0},{name:L.clTGaxis,icon:"img_graph",class:()=>Se.e(15).then(Se.bind(Se,4015)).then(te=>te.TGaxisPainter)},{name:L.clTBox,icon:"img_graph",draw:()=>Re().then(te=>te.drawBox),direct:!0},{name:"TWbox",sameas:L.clTBox},{name:"TSliderBox",sameas:L.clTBox},{name:"TMarker",icon:"img_graph",draw:()=>Re().then(te=>te.drawMarker),direct:!0},{name:"TPolyMarker",icon:"img_graph",draw:()=>Re().then(te=>te.drawPolyMarker),direct:!0},{name:"TASImage",icon:"img_mgraph",class:()=>Se.e(666).then(Se.bind(Se,6666)).then(te=>te.TASImagePainter),opt:";z"},{name:"TJSImage",icon:"img_mgraph",draw:()=>Re().then(te=>te.drawJSImage),opt:";scale;center"},{name:L.clTGeoVolume,icon:"img_histo3d",class:()=>Q().then(te=>te.TGeoPainter),get_expand:()=>Q().then(te=>te.expandGeoObject),opt:";more;all;count;projx;projz;wire;no_screen;dflt",ctrl:"dflt"},{name:"TEveGeoShapeExtract",sameas:L.clTGeoVolume,opt:";more;all;count;projx;projz;wire;dflt"},{name:L.nsREX+"REveGeoShapeExtract",sameas:L.clTGeoVolume,opt:";more;all;count;projx;projz;wire;dflt"},{name:"TGeoOverlap",sameas:L.clTGeoVolume,opt:";more;all;count;projx;projz;wire;dflt",dflt:"dflt",ctrl:"expand"},{name:"TGeoManager",sameas:L.clTGeoVolume,opt:";more;all;count;projx;projz;wire;tracks;no_screen;dflt",dflt:"expand",ctrl:"dflt",noappend:!0,exapnd_after_draw:!0},{name:"TGeoVolumeAssembly",sameas:L.clTGeoVolume,opt:";more;all;count"},{name:/^TGeo/,class:()=>Q().then(te=>te.TGeoPainter),get_expand:()=>Q().then(te=>te.expandGeoObject),opt:";more;all;axis;compa;count;projx;projz;wire;no_screen;dflt",dflt:"dflt",ctrl:"expand"},{name:"TAxis3D",icon:"img_graph",draw:()=>Q().then(te=>te.drawAxis3D),direct:!0},{name:"kind:Command",icon:"img_execute",execute:!0},{name:"TFolder",icon:"img_folder",icon2:"img_folderopen",noinspect:!0,get_expand:()=>Y().then(te=>te.folderHierarchy)},{name:"TTask",icon:"img_task",get_expand:()=>Y().then(te=>te.taskHierarchy),for_derived:!0},{name:E,icon:"img_tree",get_expand:()=>Promise.resolve().then(Se.bind(Se,1949)).then(te=>te.treeHierarchy),draw:()=>F().then(te=>te.drawTree),dflt:"expand",opt:"player;testio",shift:L.kInspect},{name:"TNtuple",sameas:E},{name:"TNtupleD",sameas:E},{name:ke.clTBranchFunc,icon:"img_leaf_method",draw:()=>F().then(te=>te.drawTree),opt:";dump",noinspect:!0},{name:/^TBranch/,icon:"img_branch",draw:()=>F().then(te=>te.drawTree),dflt:"expand",opt:";dump",ctrl:"dump",shift:L.kInspect,ignore_online:!0,always_draw:!0},{name:/^TLeaf/,icon:"img_leaf",noexpand:!0,draw:()=>F().then(te=>te.drawTree),opt:";dump",ctrl:"dump",ignore_online:!0,always_draw:!0},{name:L.clTList,icon:"img_list",draw:()=>Y().then(te=>te.drawList),get_expand:()=>Y().then(te=>te.listHierarchy),dflt:"expand"},{name:L.clTHashList,sameas:L.clTList},{name:L.clTObjArray,sameas:L.clTList},{name:L.clTClonesArray,sameas:L.clTList},{name:L.clTMap,sameas:L.clTList},{name:L.clTColor,icon:"img_color"},{name:L.clTFile,icon:"img_file",noinspect:!0},{name:"TMemFile",icon:"img_file",noinspect:!0},{name:L.clTStyle,icon:"img_question",noexpand:!0},{name:"Session",icon:"img_globe"},{name:"kind:TopFolder",icon:"img_base"},{name:"kind:Folder",icon:"img_folder",icon2:"img_folderopen",noinspect:!0},{name:L.nsREX+"RCanvas",icon:"img_canvas",class:()=>je().then(te=>te.RCanvasPainter),opt:"",expand_item:v},{name:L.nsREX+"RCanvasDisplayItem",icon:"img_canvas",draw:()=>je().then(te=>te.drawRPadSnapshot),opt:"",expand_item:v},{name:L.nsREX+"RHist1Drawable",icon:"img_histo1d",class:()=>je("rh1").then(te=>te.RH1Painter),opt:""},{name:L.nsREX+"RHist2Drawable",icon:"img_histo2d",class:()=>je("rh2").then(te=>te.RH2Painter),opt:""},{name:L.nsREX+"RHist3Drawable",icon:"img_histo3d",class:()=>je("rh3").then(te=>te.RH3Painter),opt:""},{name:L.nsREX+"RHistDisplayItem",icon:"img_histo1d",draw:()=>je("rh3").then(te=>te.drawHistDisplayItem),opt:""},{name:L.nsREX+"RText",icon:"img_text",draw:()=>je("more").then(te=>te.drawText),opt:"",direct:"v7",csstype:"text"},{name:L.nsREX+"RFrameTitle",icon:"img_text",draw:()=>je().then(te=>te.drawRFrameTitle),opt:"",direct:"v7",csstype:"title"},{name:L.nsREX+"RPaletteDrawable",icon:"img_text",class:()=>je("more").then(te=>te.RPalettePainter),opt:""},{name:L.nsREX+"RDisplayHistStat",icon:"img_pavetext",class:()=>je("pave").then(te=>te.RHistStatsPainter),opt:""},{name:L.nsREX+"RLine",icon:"img_graph",draw:()=>je("more").then(te=>te.drawLine),opt:"",direct:"v7",csstype:"line"},{name:L.nsREX+"RBox",icon:"img_graph",draw:()=>je("more").then(te=>te.drawBox),opt:"",direct:"v7",csstype:"box"},{name:L.nsREX+"RMarker",icon:"img_graph",draw:()=>je("more").then(te=>te.drawMarker),opt:"",direct:"v7",csstype:"marker"},{name:L.nsREX+"RPave",icon:"img_pavetext",class:()=>je("pave").then(te=>te.RPavePainter),opt:""},{name:L.nsREX+"RLegend",icon:"img_graph",class:()=>je("pave").then(te=>te.RLegendPainter),opt:""},{name:L.nsREX+"RPaveText",icon:"img_pavetext",class:()=>je("pave").then(te=>te.RPaveTextPainter),opt:""},{name:L.nsREX+"RFrame",icon:"img_frame",draw:()=>je().then(te=>te.drawRFrame),opt:""},{name:L.nsREX+"RFont",icon:"img_text",draw:()=>je().then(te=>te.drawRFont),opt:"",direct:"v7",csstype:"font"},{name:L.nsREX+"RAxisDrawable",icon:"img_frame",draw:()=>je().then(te=>te.drawRAxis),opt:""}],cache:{}};function I(te){return C.lst.push(te),te}function U(te,Je){if(!(0,L.isStr)(te))return null;""===Je&&(Je=null);let tt=null;if(null===Je&&te in C.cache)return C.cache[te];const Fe=0===te.indexOf(L.prROOT)?te.slice(5):`kind:${te}`;let Ne=0;for(let rt=0;rt<C.lst.length;++rt){const St=C.lst[rt];if((0,L.isStr)(St.name)){if(St.name!==Fe)continue}else if(!Fe.match(St.name))continue;if(St.sameas){const pt=U(L.prROOT+St.sameas,Je);if(pt){for(const st in pt)void 0===St[st]&&(St[st]=pt[st]);delete St.sameas}return St}if(null==Je)return te in C.cache||(C.cache[te]=St),St;if((0,L.isStr)(Je)){if(tt||(tt=St),"::expand"===Je){if("expand"in St||"expand_item"in St)return St}else if("opt"in St){const pt=St.opt.split(";");for(let st=0;st<pt.length;++st)pt[st]=pt[st].toLowerCase();if(pt.indexOf(Je.toLowerCase())>=0)return St}}else if(Je===Ne)return St;++Ne}return tt}function k(te){return(0,L.isStr)(te)&&(te=U(te)),!!(0,L.isObject)(te)&&(te.func||te.class||te.draw||te.draw_field)}function Z(te,Je){const tt={opts:null,inspect:!1,expand:!1,draw:!1,handle:null};if(!(0,L.isStr)(te))return tt;let Fe=!1,Ne=!1,rt=!1;(0,L.isStr)(Je)||(Je="");for(let St=0;St<1e3;++St){const pt=U(te,St);if(!(pt&&(tt.handle||(tt.handle=pt),pt.noinspect&&(Ne=!0),pt.noappend&&(tt.noappend=!0),(pt.expand||pt.get_expand||pt.expand_item||pt.can_expand)&&(rt=!0),pt.func||pt.class||pt.draw)))break;if(Fe=!0,!("opt"in pt))continue;const st=pt.opt.split(";");for(let vt=0;vt<st.length;++vt)st[vt]=st[vt].toLowerCase(),!(0===st[vt].indexOf("same")&&(tt.has_same=!0,Je.indexOf("nosame")>=0))&&(null===tt.opts&&(tt.opts=[]),tt.opts.indexOf(st[vt])<0&&tt.opts.push(st[vt]));if(pt.theonly)break}return Je.indexOf("noinspect")>=0&&(Ne=!0),Fe&&null===tt.opts&&(tt.opts=[""]),!Fe&&0===te.indexOf(L.prROOT)&&!Ne&&(tt.opts=[]),!Ne&&tt.opts&&tt.opts.push(L.kInspect),tt.inspect=!Ne,tt.expand=rt,tt.draw=!!tt.opts,tt}function he(te,Je,tt){return G.apply(this,arguments)}function G(){return(G=(0,Ee.A)(function*(te,Je,tt){if(!(0,L.isObject)(Je))return Promise.reject(Error("not an object in draw call"));if((0,L.isStr)(tt)&&0===tt.indexOf(L.kInspect))return Y().then(pt=>pt.drawInspector(te,Je,tt));let Fe,Ne,St;if("_typename"in Je)Ne="type "+Je._typename,Fe=U(L.prROOT+Je._typename,tt);else{if(!("_kind"in Je))return Y().then(pt=>pt.drawInspector(te,Je,tt));Ne="kind "+Je._kind,Fe=U(Je._kind,tt)}if(!Fe)return Promise.reject(Error(`Object of ${Ne} cannot be shown with draw`));if(Fe.dummy)return null;if(Fe.draw_field&&Je[Fe.draw_field])return he(te,Je[Fe.draw_field],tt||Fe.draw_field_opt);if(!k(Fe)){if(tt&&tt.indexOf("same")>=0){const pt=(0,Ye.Nn)(te);if((0,L.isFunc)(pt?.performDrop))return pt.performDrop(Je,"",null,tt)}return Promise.reject(Error(`Function not specified to draw object ${Ne}`))}function rt(){let pt,st;return"v7"===Fe.direct?pt=Se.e(990).then(Se.bind(Se,1990)).then(vt=>(st=new vt.RObjectPainter(te,Je,tt,Fe.csstype),st.redraw=Fe.func,vt.ensureRCanvas(st,Fe.frame||!1))).then(()=>st.redraw()):Fe.direct?(st=new Ye.JW(te,Je,tt),st.redraw=Fe.func,pt=Ve().then(vt=>vt.ensureTCanvas(st,Fe.frame||!1)).then(()=>st.redraw())):pt=(0,L.getPromise)(Fe.func(te,Je,tt)),pt.then(vt=>{if(st||(st=vt),!1===st)return null;if(!st)throw Error(`Fail to draw object ${Ne}`);return(0,L.isObject)(st)&&!st.options&&(st.options={original:tt||""}),st})}if((0,L.isFunc)(Fe.func))return rt();if((0,L.isFunc)(Fe.class))St=Fe.class().then(pt=>{Fe.func=pt.draw});else if((0,L.isFunc)(Fe.draw))St=Fe.draw().then(pt=>{Fe.func=pt});else{if(!Fe.func||!(0,L.isStr)(Fe.func))return Promise.reject(Error(`Draw function or class not specified to draw ${Ne}`));if(!Fe.prereq&&!Fe.script)return Promise.reject(Error(`Prerequicities to load ${Fe.func} are not specified`));St=(L.internals.ignore_v6?Promise.resolve(!0):(0,L._ensureJSROOT)().then(st=>(Fe.prereq?st.require(Fe.prereq):Promise.resolve(!0)).then(()=>{if(Fe.script)return(0,L.loadScript)(Fe.script)}).then(()=>st._complete_loading()))).then(()=>{const st=(0,L.findFunction)(Fe.func);if(!(0,L.isFunc)(st))return Promise.reject(Error(`Fail to find function ${Fe.func} after loading ${Fe.prereq||Fe.script}`));Fe.func=st})}return St.then(()=>rt())})).apply(this,arguments)}function b(te,Je,tt){return P.apply(this,arguments)}function P(){return(P=(0,Ee.A)(function*(te,Je,tt){if(!(0,L.isObject)(Je))return Promise.reject(Error("not an object in redraw"));const Fe=(0,Ye.m6)(te);let Ne,St,rt=null;if(Je._typename&&(Ne=U(L.prROOT+Je._typename)),Ne?.draw_field&&Je[Ne.draw_field]&&(Je=Je[Ne.draw_field]),Fe)if(Fe.matchObjectType(Je._typename))St=Fe.redrawObject(Je,tt),St&&(rt=Fe);else for(let pt=0;pt<Fe.painters.length;++pt){const st=Fe.painters[pt];if(st.matchObjectType(Je._typename)&&(St=st.redrawObject(Je,tt),St)){rt=st;break}}else{const pt=new ot.b8(te).getTopPainter();(0,L.isFunc)(pt?.redrawObject)&&(St=pt.redrawObject(Je,tt),St&&(rt=pt))}return rt?(0,L.getPromise)(St).then(()=>rt):((0,Ye.tP)(te),he(te,Je,tt))})).apply(this,arguments)}function Me(te){te.prototype.drawObject=(...Je)=>he(...Je).catch(tt=>(console.log(`Error ${tt?.message??tt}  at ${tt?.stack??"uncknown place"}`),null)),te.prototype.getObjectDrawSettings=Z}function je(te){return Ge.apply(this,arguments)}function Ge(){return(Ge=(0,Ee.A)(function*(te){return Se.e(990).then(Se.bind(Se,1990)).then(Je=>{switch(Me(Je.RPadPainter),te){case"more":return Promise.all([Se.e(990),Se.e(696)]).then(Se.bind(Se,8696));case"pave":return Promise.all([Se.e(990),Se.e(409)]).then(Se.bind(Se,4409));case"rh1":return Promise.all([Se.e(990),Se.e(521),Se.e(908)]).then(Se.bind(Se,7908));case"rh2":return Promise.all([Se.e(990),Se.e(521),Se.e(125)]).then(Se.bind(Se,2125));case"rh3":return Promise.all([Se.e(990),Se.e(521),Se.e(125),Se.e(908),Se.e(746)]).then(Se.bind(Se,8746))}return Je})})).apply(this,arguments)}function bt(){return bt=(0,Ee.A)(function*(te,Je){return he(te,Je._hist,"hist").then(function(){var tt=(0,Ee.A)(function*(Fe){const Ne=[];for(let rt=0;rt<Je._items.arr.length;++rt)Ne.push(he(te,Je._items.arr[rt],Je._items.opt[rt]));return Promise.all(Ne).then(()=>Fe)});return function(Fe){return tt.apply(this,arguments)}}())}),bt.apply(this,arguments)}L.internals.addDrawFunc=I,Me(Ze.jg),L.internals.addStreamerInfosForPainter=function T(te){if(!te)return;const Je=[L.clTObject,L.clTNamed,L.clTString,"TCollection",L.clTAttLine,L.clTAttFill,L.clTAttMarker,L.clTAttText];function tt(Fe,Ne){const rt=Fe.fElements?.arr[0];if("BASE"!==rt?.fTypeName||Ne>4||Je.indexOf(rt.fName)>=0)return null;let St=U(L.prROOT+rt.fName);if(St&&!St.for_derived&&(St=null),null===St)for(let pt=0;pt<te.arr.length;++pt)if(te.arr[pt].fName===rt.fName){St=tt(te.arr[pt],Ne+1);break}return St?.for_derived?St:null}te.arr.forEach(Fe=>{if(null!==U(L.prROOT+Fe.fName))return;const Ne=tt(Fe,0);if(Ne){const rt=Object.assign({},Ne);delete rt.for_derived,rt.name=Fe.fName,I(rt)}})}},2454:(Yr,mt,Se)=>{"use strict";Se.r(mt),Se.d(mt,{ClonedNodes:()=>Z.De,GeoDrawingControl:()=>rt,TGeoPainter:()=>$n,build:()=>yo,createGeoPainter:()=>Sn,drawAxis3D:()=>Bs,drawDummy3DGeom:()=>Nr,expandGeoObject:()=>bt,produceRenderOrder:()=>Z.Pz});var Ee=Se(4882),x=Se(8872),L=Se(2923),ve=Se(5992);class ke{constructor(K,ge,ye,Pe,At="div"){this.parent=K,this.object=ge,this.property=ye,this._disabled=!1,this._hidden=!1,this.initialValue=this.getValue(),this.domElement=document.createElement("div"),this.domElement.classList.add("controller"),this.domElement.classList.add(Pe),this.$name=document.createElement("div"),this.$name.classList.add("name"),ke.nextNameID=ke.nextNameID||0,this.$name.id="lil-gui-name-"+ ++ke.nextNameID,this.$widget=document.createElement(At),this.$widget.classList.add("widget"),this.$disable=this.$widget,this.domElement.appendChild(this.$name),this.domElement.appendChild(this.$widget),this.domElement.addEventListener("keydown",Vt=>Vt.stopPropagation()),this.domElement.addEventListener("keyup",Vt=>Vt.stopPropagation()),this.parent.children.push(this),this.parent.controllers.push(this),this.parent.$children.appendChild(this.domElement),this._listenCallback=this._listenCallback.bind(this),this.name(ye)}name(K){return this._name=K,this.$name.innerHTML=K,this}onChange(K){return this._onChange=K,this}_callOnChange(){this.parent._callOnChange(this),void 0!==this._onChange&&this._onChange.call(this,this.getValue()),this._changed=!0}onFinishChange(K){return this._onFinishChange=K,this}_callOnFinishChange(){this._changed&&(this.parent._callOnFinishChange(this),void 0!==this._onFinishChange&&this._onFinishChange.call(this,this.getValue())),this._changed=!1}reset(){return this.setValue(this.initialValue),this._callOnFinishChange(),this}enable(K=!0){return this.disable(!K)}disable(K=!0){return K===this._disabled||(this._disabled=K,this.domElement.classList.toggle("disabled",K),this.$disable.toggleAttribute("disabled",K)),this}show(K=!0){return this._hidden=!K,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}options(K){const ge=this.parent.add(this.object,this.property,K);return ge.name(this._name),this.destroy(),ge}min(K){return this}max(K){return this}step(K){return this}decimals(K){return this}listen(K=!0){return this._listening=K,void 0!==this._listenCallbackID&&(cancelAnimationFrame(this._listenCallbackID),this._listenCallbackID=void 0),this._listening&&this._listenCallback(),this}_listenCallback(){this._listenCallbackID=requestAnimationFrame(this._listenCallback);const K=this.save();K!==this._listenPrevValue&&this.updateDisplay(),this._listenPrevValue=K}getValue(){return this.object[this.property]}setValue(K){return this.object[this.property]=K,this._callOnChange(),this.updateDisplay(),this}updateDisplay(){return this}load(K){return this.setValue(K),this._callOnFinishChange(),this}save(){return this.getValue()}destroy(){this.listen(!1),this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.controllers.splice(this.parent.controllers.indexOf(this),1),this.parent.$children.removeChild(this.domElement)}}class ot extends ke{constructor(K,ge,ye){super(K,ge,ye,"boolean","label"),this.$input=document.createElement("input"),this.$input.setAttribute("type","checkbox"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$input.addEventListener("change",()=>{this.setValue(this.$input.checked),this._callOnFinishChange()}),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.checked=this.getValue(),this}}function Ye(xt){let K,ge;return(K=xt.match(/(#|0x)?([a-f0-9]{6})/i))?ge=K[2]:(K=xt.match(/rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\)/))?ge=parseInt(K[1]).toString(16).padStart(2,0)+parseInt(K[2]).toString(16).padStart(2,0)+parseInt(K[3]).toString(16).padStart(2,0):(K=xt.match(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i))&&(ge=K[1]+K[1]+K[2]+K[2]+K[3]+K[3]),!!ge&&"#"+ge}const Re={isPrimitive:!0,match:xt=>"number"==typeof xt,fromHexString:xt=>parseInt(xt.substring(1),16),toHexString:xt=>"#"+xt.toString(16).padStart(6,0)},De=[{isPrimitive:!0,match:xt=>"string"==typeof xt,fromHexString:Ye,toHexString:Ye},Re,{isPrimitive:!1,match:xt=>Array.isArray(xt),fromHexString(xt,K,ge=1){const ye=Re.fromHexString(xt);K[0]=(ye>>16&255)/255*ge,K[1]=(ye>>8&255)/255*ge,K[2]=(255&ye)/255*ge},toHexString:([xt,K,ge],ye=1)=>Re.toHexString(xt*(ye=255/ye)<<16^K*ye<<8^ge*ye)},{isPrimitive:!1,match:xt=>Object(xt)===xt,fromHexString(xt,K,ge=1){const ye=Re.fromHexString(xt);K.r=(ye>>16&255)/255*ge,K.g=(ye>>8&255)/255*ge,K.b=(255&ye)/255*ge},toHexString:({r:xt,g:K,b:ge},ye=1)=>Re.toHexString(xt*(ye=255/ye)<<16^K*ye<<8^ge*ye)}];class J extends ke{constructor(K,ge,ye,Pe){super(K,ge,ye,"color"),this.$input=document.createElement("input"),this.$input.setAttribute("type","color"),this.$input.setAttribute("tabindex",-1),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$text=document.createElement("input"),this.$text.setAttribute("type","text"),this.$text.setAttribute("spellcheck","false"),this.$text.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$display.appendChild(this.$input),this.$widget.appendChild(this.$display),this.$widget.appendChild(this.$text),this._format=function F(xt){return De.find(K=>K.match(xt))}(this.initialValue),this._rgbScale=Pe,this._initialValueHexString=this.save(),this._textFocused=!1,this.$input.addEventListener("input",()=>{this._setValueFromHexString(this.$input.value)}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$text.addEventListener("input",()=>{const At=Ye(this.$text.value);At&&this._setValueFromHexString(At)}),this.$text.addEventListener("focus",()=>{this._textFocused=!0,this.$text.select()}),this.$text.addEventListener("blur",()=>{this._textFocused=!1,this.updateDisplay(),this._callOnFinishChange()}),this.$disable=this.$text,this.updateDisplay()}reset(){return this._setValueFromHexString(this._initialValueHexString),this}_setValueFromHexString(K){if(this._format.isPrimitive){const ge=this._format.fromHexString(K);this.setValue(ge)}else this._format.fromHexString(K,this.getValue(),this._rgbScale),this._callOnChange(),this.updateDisplay()}save(){return this._format.toHexString(this.getValue(),this._rgbScale)}load(K){return this._setValueFromHexString(K),this._callOnFinishChange(),this}updateDisplay(){return this.$input.value=this._format.toHexString(this.getValue(),this._rgbScale),this._textFocused||(this.$text.value=this.$input.value.substring(1)),this.$display.style.backgroundColor=this.$input.value,this}}class Y extends ke{constructor(K,ge,ye){super(K,ge,ye,"function"),this.$button=document.createElement("button"),this.$button.appendChild(this.$name),this.$widget.appendChild(this.$button),this.$button.addEventListener("click",Pe=>{Pe.preventDefault(),this.getValue().call(this.object),this._callOnChange()}),this.$button.addEventListener("touchstart",()=>{},{passive:!0}),this.$disable=this.$button}}class ue extends ke{constructor(K,ge,ye,Pe,At,Vt){super(K,ge,ye,"number"),this._initInput(),this.min(Pe),this.max(At);const Nt=void 0!==Vt;this.step(Nt?Vt:this._getImplicitStep(),Nt),this.updateDisplay()}decimals(K){return this._decimals=K,this.updateDisplay(),this}min(K){return this._min=K,this._onUpdateMinMax(),this}max(K){return this._max=K,this._onUpdateMinMax(),this}step(K,ge=!0){return this._step=K,this._stepExplicit=ge,this}updateDisplay(){const K=this.getValue();if(this._hasSlider){let ge=(K-this._min)/(this._max-this._min);ge=Math.max(0,Math.min(ge,1)),this.$fill.style.width=100*ge+"%"}return this._inputFocused||(this.$input.value=void 0===this._decimals?K:K.toFixed(this._decimals)),this}_initInput(){this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),window.matchMedia("(pointer: coarse)").matches&&(this.$input.setAttribute("type","number"),this.$input.setAttribute("step","any")),this.$widget.appendChild(this.$input),this.$disable=this.$input;const ye=Wi=>{const Ln=parseFloat(this.$input.value);isNaN(Ln)||(this._snapClampSetValue(Ln+Wi),this.$input.value=this.getValue())};let Nt,nn,hn,kn,dn,Vt=!1;const Pi=Wi=>{if(Vt){const Ln=Wi.clientX-Nt;Math.abs(Wi.clientY-nn)>5?(Wi.preventDefault(),this.$input.blur(),Vt=!1,this._setDraggingStyle(!0,"vertical")):Math.abs(Ln)>5&&Si()}Vt||(dn-=(Wi.clientY-hn)*this._step*this._arrowKeyMultiplier(Wi),kn+dn>this._max?dn=this._max-kn:kn+dn<this._min&&(dn=this._min-kn),this._snapClampSetValue(kn+dn)),hn=Wi.clientY},Si=()=>{this._setDraggingStyle(!1,"vertical"),this._callOnFinishChange(),window.removeEventListener("mousemove",Pi),window.removeEventListener("mouseup",Si)};this.$input.addEventListener("input",()=>{let Wi=parseFloat(this.$input.value);isNaN(Wi)||(this._stepExplicit&&(Wi=this._snap(Wi)),this.setValue(this._clamp(Wi)))}),this.$input.addEventListener("keydown",Wi=>{"Enter"===Wi.key&&this.$input.blur(),"ArrowUp"===Wi.code&&(Wi.preventDefault(),ye(this._step*this._arrowKeyMultiplier(Wi))),"ArrowDown"===Wi.code&&(Wi.preventDefault(),ye(this._step*this._arrowKeyMultiplier(Wi)*-1))}),this.$input.addEventListener("wheel",Wi=>{this._inputFocused&&(Wi.preventDefault(),ye(this._step*this._normalizeMouseWheel(Wi)))},{passive:!1}),this.$input.addEventListener("mousedown",Wi=>{Nt=Wi.clientX,nn=hn=Wi.clientY,Vt=!0,kn=this.getValue(),dn=0,window.addEventListener("mousemove",Pi),window.addEventListener("mouseup",Si)}),this.$input.addEventListener("focus",()=>{this._inputFocused=!0}),this.$input.addEventListener("blur",()=>{this._inputFocused=!1,this.updateDisplay(),this._callOnFinishChange()})}_initSlider(){this._hasSlider=!0,this.$slider=document.createElement("div"),this.$slider.classList.add("slider"),this.$fill=document.createElement("div"),this.$fill.classList.add("fill"),this.$slider.appendChild(this.$fill),this.$widget.insertBefore(this.$slider,this.$input),this.domElement.classList.add("hasSlider");const ge=Jn=>{const Wi=this.$slider.getBoundingClientRect();let Ln=((Jn,Wi,Ln,Rs,oe)=>(Jn-Wi)/(Ln-Wi)*(this._max-Rs)+Rs)(Jn,Wi.left,Wi.right,this._min);this._snapClampSetValue(Ln)},Pe=Jn=>{ge(Jn.clientX)},At=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("mousemove",Pe),window.removeEventListener("mouseup",At)};let Nt,nn,Vt=!1;const hn=Jn=>{Jn.preventDefault(),this._setDraggingStyle(!0),ge(Jn.touches[0].clientX),Vt=!1},dn=Jn=>{if(Vt){const Ln=Jn.touches[0].clientY-nn;Math.abs(Jn.touches[0].clientX-Nt)>Math.abs(Ln)?hn(Jn):(window.removeEventListener("touchmove",dn),window.removeEventListener("touchend",In))}else Jn.preventDefault(),ge(Jn.touches[0].clientX)},In=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("touchmove",dn),window.removeEventListener("touchend",In)},ci=this._callOnFinishChange.bind(this);let Si;this.$slider.addEventListener("mousedown",Jn=>{this._setDraggingStyle(!0),ge(Jn.clientX),window.addEventListener("mousemove",Pe),window.addEventListener("mouseup",At)}),this.$slider.addEventListener("touchstart",Jn=>{Jn.touches.length>1||(this._hasScrollBar?(Nt=Jn.touches[0].clientX,nn=Jn.touches[0].clientY,Vt=!0):hn(Jn),window.addEventListener("touchmove",dn,{passive:!1}),window.addEventListener("touchend",In))},{passive:!1}),this.$slider.addEventListener("wheel",Jn=>{if(Math.abs(Jn.deltaX)<Math.abs(Jn.deltaY)&&this._hasScrollBar)return;Jn.preventDefault();const Ln=this._normalizeMouseWheel(Jn)*this._step;this._snapClampSetValue(this.getValue()+Ln),this.$input.value=this.getValue(),clearTimeout(Si),Si=setTimeout(ci,400)},{passive:!1})}_setDraggingStyle(K,ge="horizontal"){this.$slider&&this.$slider.classList.toggle("active",K),document.body.classList.toggle("lil-gui-dragging",K),document.body.classList.toggle(`lil-gui-${ge}`,K)}_getImplicitStep(){return this._hasMin&&this._hasMax?(this._max-this._min)/1e3:.1}_onUpdateMinMax(){!this._hasSlider&&this._hasMin&&this._hasMax&&(this._stepExplicit||this.step(this._getImplicitStep(),!1),this._initSlider(),this.updateDisplay())}_normalizeMouseWheel(K){let{deltaX:ge,deltaY:ye}=K;return Math.floor(K.deltaY)!==K.deltaY&&K.wheelDelta&&(ge=0,ye=-K.wheelDelta/120,ye*=this._stepExplicit?1:10),ge+-ye}_arrowKeyMultiplier(K){let ge=this._stepExplicit?1:10;return K.shiftKey?ge*=10:K.altKey&&(ge/=10),ge}_snap(K){const ge=Math.round(K/this._step)*this._step;return parseFloat(ge.toPrecision(15))}_clamp(K){return K<this._min&&(K=this._min),K>this._max&&(K=this._max),K}_snapClampSetValue(K){this.setValue(this._clamp(this._snap(K)))}get _hasScrollBar(){const K=this.parent.root.$children;return K.scrollHeight>K.clientHeight}get _hasMin(){return void 0!==this._min}get _hasMax(){return void 0!==this._max}}class Q extends ke{constructor(K,ge,ye,Pe){super(K,ge,ye,"option"),this.$select=document.createElement("select"),this.$select.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this._values=Array.isArray(Pe)?Pe:Object.values(Pe),this._names=Array.isArray(Pe)?Pe:Object.keys(Pe),this._names.forEach(At=>{const Vt=document.createElement("option");Vt.innerHTML=At,this.$select.appendChild(Vt)}),this.$select.addEventListener("change",()=>{this.setValue(this._values[this.$select.selectedIndex]),this._callOnFinishChange()}),this.$select.addEventListener("focus",()=>{this.$display.classList.add("focus")}),this.$select.addEventListener("blur",()=>{this.$display.classList.remove("focus")}),this.$widget.appendChild(this.$select),this.$widget.appendChild(this.$display),this.$disable=this.$select,this.updateDisplay()}updateDisplay(){const K=this.getValue(),ge=this._values.indexOf(K);return this.$select.selectedIndex=ge,this.$display.innerHTML=-1===ge?K:this._names[ge],this}}class me extends ke{constructor(K,ge,ye){super(K,ge,ye,"string"),this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$input.addEventListener("input",()=>{this.setValue(this.$input.value)}),this.$input.addEventListener("keydown",Pe=>{"Enter"===Pe.code&&this.$input.blur()}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$widget.appendChild(this.$input),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.value=this.getValue(),this}}let $=!1;class A{constructor({parent:K,autoPlace:ge=void 0===K,container:ye,width:Pe,title:At="Controls",closeFolders:Vt=!1,injectStyles:Nt=!0,touchStyles:nn=!0}={}){if(this.parent=K,this.root=K?K.root:this,this.children=[],this.controllers=[],this.folders=[],this._closed=!1,this._hidden=!1,this.domElement=document.createElement("div"),this.domElement.classList.add("lil-gui"),this.$title=document.createElement("div"),this.$title.classList.add("title"),this.$title.setAttribute("role","button"),this.$title.setAttribute("aria-expanded",!0),this.$title.setAttribute("tabindex",0),this.$title.addEventListener("click",()=>this.openAnimated(this._closed)),this.$title.addEventListener("keydown",hn=>{("Enter"===hn.code||"Space"===hn.code)&&(hn.preventDefault(),this.$title.click())}),this.$title.addEventListener("touchstart",()=>{},{passive:!0}),this.$children=document.createElement("div"),this.$children.classList.add("children"),this.domElement.appendChild(this.$title),this.domElement.appendChild(this.$children),this.title(At),this.parent)return this.parent.children.push(this),this.parent.folders.push(this),void this.parent.$children.appendChild(this.domElement);this.domElement.classList.add("root"),nn&&this.domElement.classList.add("allow-touch-styles"),!$&&Nt&&(function B(xt){const K=document.createElement("style");K.innerHTML=xt;const ge=document.querySelector("head link[rel=stylesheet], head style");ge?document.head.insertBefore(K,ge):document.head.appendChild(K)}('.lil-gui {\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n  line-height: 1;\n  font-weight: normal;\n  font-style: normal;\n  text-align: left;\n  background-color: var(--background-color);\n  color: var(--text-color);\n  user-select: none;\n  -webkit-user-select: none;\n  touch-action: manipulation;\n  --background-color: #1f1f1f;\n  --text-color: #ebebeb;\n  --title-background-color: #111111;\n  --title-text-color: #ebebeb;\n  --widget-color: #424242;\n  --hover-color: #4f4f4f;\n  --focus-color: #595959;\n  --number-color: #2cc9ff;\n  --string-color: #a2db3c;\n  --font-size: 11px;\n  --input-font-size: 11px;\n  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;\n  --font-family-mono: Menlo, Monaco, Consolas, "Droid Sans Mono", monospace;\n  --padding: 4px;\n  --spacing: 4px;\n  --widget-height: 20px;\n  --title-height: calc(var(--widget-height) + var(--spacing) * 1.25);\n  --name-width: 45%;\n  --slider-knob-width: 2px;\n  --slider-input-width: 27%;\n  --color-input-width: 27%;\n  --slider-input-min-width: 45px;\n  --color-input-min-width: 45px;\n  --folder-indent: 7px;\n  --widget-padding: 0 0 0 3px;\n  --widget-border-radius: 2px;\n  --checkbox-size: calc(0.75 * var(--widget-height));\n  --scrollbar-width: 5px;\n}\n.lil-gui, .lil-gui * {\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n.lil-gui.root {\n  width: var(--width, 245px);\n  display: flex;\n  flex-direction: column;\n}\n.lil-gui.root > .title {\n  background: var(--title-background-color);\n  color: var(--title-text-color);\n}\n.lil-gui.root > .children {\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n.lil-gui.root > .children::-webkit-scrollbar {\n  width: var(--scrollbar-width);\n  height: var(--scrollbar-width);\n  background: var(--background-color);\n}\n.lil-gui.root > .children::-webkit-scrollbar-thumb {\n  border-radius: var(--scrollbar-width);\n  background: var(--focus-color);\n}\n@media (pointer: coarse) {\n  .lil-gui.allow-touch-styles, .lil-gui.allow-touch-styles .lil-gui {\n    --widget-height: 28px;\n    --padding: 6px;\n    --spacing: 6px;\n    --font-size: 13px;\n    --input-font-size: 16px;\n    --folder-indent: 10px;\n    --scrollbar-width: 7px;\n    --slider-input-min-width: 50px;\n    --color-input-min-width: 65px;\n  }\n}\n.lil-gui.force-touch-styles, .lil-gui.force-touch-styles .lil-gui {\n  --widget-height: 28px;\n  --padding: 6px;\n  --spacing: 6px;\n  --font-size: 13px;\n  --input-font-size: 16px;\n  --folder-indent: 10px;\n  --scrollbar-width: 7px;\n  --slider-input-min-width: 50px;\n  --color-input-min-width: 65px;\n}\n.lil-gui.autoPlace {\n  max-height: 100%;\n  position: fixed;\n  top: 0;\n  right: 15px;\n  z-index: 1001;\n}\n\n.lil-gui .controller {\n  display: flex;\n  align-items: center;\n  padding: 0 var(--padding);\n  margin: var(--spacing) 0;\n}\n.lil-gui .controller.disabled {\n  opacity: 0.5;\n}\n.lil-gui .controller.disabled, .lil-gui .controller.disabled * {\n  pointer-events: none !important;\n}\n.lil-gui .controller > .name {\n  min-width: var(--name-width);\n  flex-shrink: 0;\n  white-space: pre;\n  padding-right: var(--spacing);\n  line-height: var(--widget-height);\n}\n.lil-gui .controller .widget {\n  position: relative;\n  display: flex;\n  align-items: center;\n  width: 100%;\n  min-height: var(--widget-height);\n}\n.lil-gui .controller.string input {\n  color: var(--string-color);\n}\n.lil-gui .controller.boolean .widget {\n  cursor: pointer;\n}\n.lil-gui .controller.color .display {\n  width: 100%;\n  height: var(--widget-height);\n  border-radius: var(--widget-border-radius);\n  position: relative;\n}\n@media (hover: hover) {\n  .lil-gui .controller.color .display:hover:before {\n    content: " ";\n    display: block;\n    position: absolute;\n    border-radius: var(--widget-border-radius);\n    border: 1px solid #fff9;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n  }\n}\n.lil-gui .controller.color input[type=color] {\n  opacity: 0;\n  width: 100%;\n  height: 100%;\n  cursor: pointer;\n}\n.lil-gui .controller.color input[type=text] {\n  margin-left: var(--spacing);\n  font-family: var(--font-family-mono);\n  min-width: var(--color-input-min-width);\n  width: var(--color-input-width);\n  flex-shrink: 0;\n}\n.lil-gui .controller.option select {\n  opacity: 0;\n  position: absolute;\n  width: 100%;\n  max-width: 100%;\n}\n.lil-gui .controller.option .display {\n  position: relative;\n  pointer-events: none;\n  border-radius: var(--widget-border-radius);\n  height: var(--widget-height);\n  line-height: var(--widget-height);\n  max-width: 100%;\n  overflow: hidden;\n  word-break: break-all;\n  padding-left: 0.55em;\n  padding-right: 1.75em;\n  background: var(--widget-color);\n}\n@media (hover: hover) {\n  .lil-gui .controller.option .display.focus {\n    background: var(--focus-color);\n  }\n}\n.lil-gui .controller.option .display.active {\n  background: var(--focus-color);\n}\n.lil-gui .controller.option .display:after {\n  font-family: "lil-gui";\n  content: "\u2195";\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  padding-right: 0.375em;\n}\n.lil-gui .controller.option .widget,\n.lil-gui .controller.option select {\n  cursor: pointer;\n}\n@media (hover: hover) {\n  .lil-gui .controller.option .widget:hover .display {\n    background: var(--hover-color);\n  }\n}\n.lil-gui .controller.number input {\n  color: var(--number-color);\n}\n.lil-gui .controller.number.hasSlider input {\n  margin-left: var(--spacing);\n  width: var(--slider-input-width);\n  min-width: var(--slider-input-min-width);\n  flex-shrink: 0;\n}\n.lil-gui .controller.number .slider {\n  width: 100%;\n  height: var(--widget-height);\n  background-color: var(--widget-color);\n  border-radius: var(--widget-border-radius);\n  padding-right: var(--slider-knob-width);\n  overflow: hidden;\n  cursor: ew-resize;\n  touch-action: pan-y;\n}\n@media (hover: hover) {\n  .lil-gui .controller.number .slider:hover {\n    background-color: var(--hover-color);\n  }\n}\n.lil-gui .controller.number .slider.active {\n  background-color: var(--focus-color);\n}\n.lil-gui .controller.number .slider.active .fill {\n  opacity: 0.95;\n}\n.lil-gui .controller.number .fill {\n  height: 100%;\n  border-right: var(--slider-knob-width) solid var(--number-color);\n  box-sizing: content-box;\n}\n\n.lil-gui-dragging .lil-gui {\n  --hover-color: var(--widget-color);\n}\n.lil-gui-dragging * {\n  cursor: ew-resize !important;\n}\n\n.lil-gui-dragging.lil-gui-vertical * {\n  cursor: ns-resize !important;\n}\n\n.lil-gui .title {\n  height: var(--title-height);\n  line-height: calc(var(--title-height) - 4px);\n  font-weight: 600;\n  padding: 0 var(--padding);\n  -webkit-tap-highlight-color: transparent;\n  cursor: pointer;\n  outline: none;\n  text-decoration-skip: objects;\n}\n.lil-gui .title:before {\n  font-family: "lil-gui";\n  content: "\u25be";\n  padding-right: 2px;\n  display: inline-block;\n}\n.lil-gui .title:active {\n  background: var(--title-background-color);\n  opacity: 0.75;\n}\n@media (hover: hover) {\n  body:not(.lil-gui-dragging) .lil-gui .title:hover {\n    background: var(--title-background-color);\n    opacity: 0.85;\n  }\n  .lil-gui .title:focus {\n    text-decoration: underline var(--focus-color);\n  }\n}\n.lil-gui.root > .title:focus {\n  text-decoration: none !important;\n}\n.lil-gui.closed > .title:before {\n  content: "\u25b8";\n}\n.lil-gui.closed > .children {\n  transform: translateY(-7px);\n  opacity: 0;\n}\n.lil-gui.closed:not(.transition) > .children {\n  display: none;\n}\n.lil-gui.transition > .children {\n  transition-duration: 300ms;\n  transition-property: height, opacity, transform;\n  transition-timing-function: cubic-bezier(0.2, 0.6, 0.35, 1);\n  overflow: hidden;\n  pointer-events: none;\n}\n.lil-gui .children:empty:before {\n  content: "Empty";\n  padding: 0 var(--padding);\n  margin: var(--spacing) 0;\n  display: block;\n  height: var(--widget-height);\n  font-style: italic;\n  line-height: var(--widget-height);\n  opacity: 0.5;\n}\n.lil-gui.root > .children > .lil-gui > .title {\n  border: 0 solid var(--widget-color);\n  border-width: 1px 0;\n  transition: border-color 300ms;\n}\n.lil-gui.root > .children > .lil-gui.closed > .title {\n  border-bottom-color: transparent;\n}\n.lil-gui + .controller {\n  border-top: 1px solid var(--widget-color);\n  margin-top: 0;\n  padding-top: var(--spacing);\n}\n.lil-gui .lil-gui .lil-gui > .title {\n  border: none;\n}\n.lil-gui .lil-gui .lil-gui > .children {\n  border: none;\n  margin-left: var(--folder-indent);\n  border-left: 2px solid var(--widget-color);\n}\n.lil-gui .lil-gui .controller {\n  border: none;\n}\n\n.lil-gui input {\n  -webkit-tap-highlight-color: transparent;\n  border: 0;\n  outline: none;\n  font-family: var(--font-family);\n  font-size: var(--input-font-size);\n  border-radius: var(--widget-border-radius);\n  height: var(--widget-height);\n  background: var(--widget-color);\n  color: var(--text-color);\n  width: 100%;\n}\n@media (hover: hover) {\n  .lil-gui input:hover {\n    background: var(--hover-color);\n  }\n  .lil-gui input:active {\n    background: var(--focus-color);\n  }\n}\n.lil-gui input:disabled {\n  opacity: 1;\n}\n.lil-gui input[type=text],\n.lil-gui input[type=number] {\n  padding: var(--widget-padding);\n}\n.lil-gui input[type=text]:focus,\n.lil-gui input[type=number]:focus {\n  background: var(--focus-color);\n}\n.lil-gui input::-webkit-outer-spin-button,\n.lil-gui input::-webkit-inner-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n.lil-gui input[type=number] {\n  -moz-appearance: textfield;\n}\n.lil-gui input[type=checkbox] {\n  appearance: none;\n  -webkit-appearance: none;\n  height: var(--checkbox-size);\n  width: var(--checkbox-size);\n  border-radius: var(--widget-border-radius);\n  text-align: center;\n  cursor: pointer;\n}\n.lil-gui input[type=checkbox]:checked:before {\n  font-family: "lil-gui";\n  content: "\u2713";\n  font-size: var(--checkbox-size);\n  line-height: var(--checkbox-size);\n}\n@media (hover: hover) {\n  .lil-gui input[type=checkbox]:focus {\n    box-shadow: inset 0 0 0 1px var(--focus-color);\n  }\n}\n.lil-gui button {\n  -webkit-tap-highlight-color: transparent;\n  outline: none;\n  cursor: pointer;\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n  color: var(--text-color);\n  width: 100%;\n  height: var(--widget-height);\n  text-transform: none;\n  background: var(--widget-color);\n  border-radius: var(--widget-border-radius);\n  border: 1px solid var(--widget-color);\n  text-align: center;\n  line-height: calc(var(--widget-height) - 4px);\n}\n@media (hover: hover) {\n  .lil-gui button:hover {\n    background: var(--hover-color);\n    border-color: var(--hover-color);\n  }\n  .lil-gui button:focus {\n    border-color: var(--focus-color);\n  }\n}\n.lil-gui button:active {\n  background: var(--focus-color);\n}\n\n@font-face {\n  font-family: "lil-gui";\n  src: url("data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUsAAsAAAAACJwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAAH4AAADAImwmYE9TLzIAAAGIAAAAPwAAAGBKqH5SY21hcAAAAcgAAAD0AAACrukyyJBnbHlmAAACvAAAAF8AAACEIZpWH2hlYWQAAAMcAAAAJwAAADZfcj2zaGhlYQAAA0QAAAAYAAAAJAC5AHhobXR4AAADXAAAABAAAABMAZAAAGxvY2EAAANsAAAAFAAAACgCEgIybWF4cAAAA4AAAAAeAAAAIAEfABJuYW1lAAADoAAAASIAAAIK9SUU/XBvc3QAAATEAAAAZgAAAJCTcMc2eJxVjbEOgjAURU+hFRBK1dGRL+ALnAiToyMLEzFpnPz/eAshwSa97517c/MwwJmeB9kwPl+0cf5+uGPZXsqPu4nvZabcSZldZ6kfyWnomFY/eScKqZNWupKJO6kXN3K9uCVoL7iInPr1X5baXs3tjuMqCtzEuagm/AAlzQgPAAB4nGNgYRBlnMDAysDAYM/gBiT5oLQBAwuDJAMDEwMrMwNWEJDmmsJwgCFeXZghBcjlZMgFCzOiKOIFAB71Bb8AeJy1kjFuwkAQRZ+DwRAwBtNQRUGKQ8OdKCAWUhAgKLhIuAsVSpWz5Bbkj3dEgYiUIszqWdpZe+Z7/wB1oCYmIoboiwiLT2WjKl/jscrHfGg/pKdMkyklC5Zs2LEfHYpjcRoPzme9MWWmk3dWbK9ObkWkikOetJ554fWyoEsmdSlt+uR0pCJR34b6t/TVg1SY3sYvdf8vuiKrpyaDXDISiegp17p7579Gp3p++y7HPAiY9pmTibljrr85qSidtlg4+l25GLCaS8e6rRxNBmsnERunKbaOObRz7N72ju5vdAjYpBXHgJylOAVsMseDAPEP8LYoUHicY2BiAAEfhiAGJgZWBgZ7RnFRdnVJELCQlBSRlATJMoLV2DK4glSYs6ubq5vbKrJLSbGrgEmovDuDJVhe3VzcXFwNLCOILB/C4IuQ1xTn5FPilBTj5FPmBAB4WwoqAHicY2BkYGAA4sk1sR/j+W2+MnAzpDBgAyEMQUCSg4EJxAEAwUgFHgB4nGNgZGBgSGFggJMhDIwMqEAYAByHATJ4nGNgAIIUNEwmAABl3AGReJxjYAACIQYlBiMGJ3wQAEcQBEV4nGNgZGBgEGZgY2BiAAEQyQWEDAz/wXwGAAsPATIAAHicXdBNSsNAHAXwl35iA0UQXYnMShfS9GPZA7T7LgIu03SSpkwzYTIt1BN4Ak/gKTyAeCxfw39jZkjymzcvAwmAW/wgwHUEGDb36+jQQ3GXGot79L24jxCP4gHzF/EIr4jEIe7wxhOC3g2TMYy4Q7+Lu/SHuEd/ivt4wJd4wPxbPEKMX3GI5+DJFGaSn4qNzk8mcbKSR6xdXdhSzaOZJGtdapd4vVPbi6rP+cL7TGXOHtXKll4bY1Xl7EGnPtp7Xy2n00zyKLVHfkHBa4IcJ2oD3cgggWvt/V/FbDrUlEUJhTn/0azVWbNTNr0Ens8de1tceK9xZmfB1CPjOmPH4kitmvOubcNpmVTN3oFJyjzCvnmrwhJTzqzVj9jiSX911FjeAAB4nG3HMRKCMBBA0f0giiKi4DU8k0V2GWbIZDOh4PoWWvq6J5V8If9NVNQcaDhyouXMhY4rPTcG7jwYmXhKq8Wz+p762aNaeYXom2n3m2dLTVgsrCgFJ7OTmIkYbwIbC6vIB7WmFfAAAA==") format("woff");\n}'),$=!0),ye?ye.appendChild(this.domElement):ge&&(this.domElement.classList.add("autoPlace"),document.body.appendChild(this.domElement)),Pe&&this.domElement.style.setProperty("--width",Pe+"px"),this._closeFolders=Vt}add(K,ge,ye,Pe,At){if(Object(ye)===ye)return new Q(this,K,ge,ye);const Vt=K[ge];switch(typeof Vt){case"number":return new ue(this,K,ge,ye,Pe,At);case"boolean":return new ot(this,K,ge);case"string":return new me(this,K,ge);case"function":return new Y(this,K,ge)}console.error("gui.add failed\n\tproperty:",ge,"\n\tobject:",K,"\n\tvalue:",Vt)}addColor(K,ge,ye=1){return new J(this,K,ge,ye)}addFolder(K){const ge=new A({parent:this,title:K});return this.root._closeFolders&&ge.close(),ge}load(K,ge=!0){return K.controllers&&this.controllers.forEach(ye=>{ye instanceof Y||ye._name in K.controllers&&ye.load(K.controllers[ye._name])}),ge&&K.folders&&this.folders.forEach(ye=>{ye._title in K.folders&&ye.load(K.folders[ye._title])}),this}save(K=!0){const ge={controllers:{},folders:{}};return this.controllers.forEach(ye=>{if(!(ye instanceof Y)){if(ye._name in ge.controllers)throw new Error(`Cannot save GUI with duplicate property "${ye._name}"`);ge.controllers[ye._name]=ye.save()}}),K&&this.folders.forEach(ye=>{if(ye._title in ge.folders)throw new Error(`Cannot save GUI with duplicate folder "${ye._title}"`);ge.folders[ye._title]=ye.save()}),ge}open(K=!0){return this._setClosed(!K),this.$title.setAttribute("aria-expanded",!this._closed),this.domElement.classList.toggle("closed",this._closed),this}close(){return this.open(!1)}_setClosed(K){this._closed!==K&&(this._closed=K,this._callOnOpenClose(this))}show(K=!0){return this._hidden=!K,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}openAnimated(K=!0){return this._setClosed(!K),this.$title.setAttribute("aria-expanded",!this._closed),requestAnimationFrame(()=>{this.$children.style.height=this.$children.clientHeight+"px",this.domElement.classList.add("transition");const ye=At=>{At.target===this.$children&&(this.$children.style.height="",this.domElement.classList.remove("transition"),this.$children.removeEventListener("transitionend",ye))};this.$children.addEventListener("transitionend",ye);const Pe=K?this.$children.scrollHeight:0;this.domElement.classList.toggle("closed",!K),requestAnimationFrame(()=>{this.$children.style.height=Pe+"px"})}),this}title(K){return this._title=K,this.$title.innerHTML=K,this}reset(K=!0){return(K?this.controllersRecursive():this.controllers).forEach(ye=>ye.reset()),this}onChange(K){return this._onChange=K,this}_callOnChange(K){this.parent&&this.parent._callOnChange(K),void 0!==this._onChange&&this._onChange.call(this,{object:K.object,property:K.property,value:K.getValue(),controller:K})}onFinishChange(K){return this._onFinishChange=K,this}_callOnFinishChange(K){this.parent&&this.parent._callOnFinishChange(K),void 0!==this._onFinishChange&&this._onFinishChange.call(this,{object:K.object,property:K.property,value:K.getValue(),controller:K})}onOpenClose(K){return this._onOpenClose=K,this}_callOnOpenClose(K){this.parent&&this.parent._callOnOpenClose(K),void 0!==this._onOpenClose&&this._onOpenClose.call(this,K)}destroy(){this.parent&&(this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.folders.splice(this.parent.folders.indexOf(this),1)),this.domElement.parentElement&&this.domElement.parentElement.removeChild(this.domElement),Array.from(this.children).forEach(K=>K.destroy())}controllersRecursive(){let K=Array.from(this.controllers);return this.folders.forEach(ge=>{K=K.concat(ge.controllersRecursive())}),K}foldersRecursive(){let K=Array.from(this.folders);return this.folders.forEach(ge=>{K=K.concat(ge.foldersRecursive())}),K}}var g=Se(3847),v=Se(2985),f=Se(2843),C=Se(1922),I=Se(7900),U=Se(2866),k=Se(4483),Z=Se(578);const G="TGeoManager",b="TEveGeoShapeExtract",P="TGeoOverlap",T="TGeoVolumeAssembly",z="TEveTrack",W="TEvePointSet",fe=`${x.nsREX}REveGeoShapeExtract`;let Me=0;function je(xt,K,ge){void 0===K&&(K=1),ge||(Me=0,ge="");const ye=(0,x.create)(x.clTGeoVolume);if((0,Z.bg)(ye,Z.Wv.kVisThis,!0),(0,Z.bg)(ye,Z.Wv.kVisDaughters,!0),ge&&xt._typename!==Z.HO||K<=0)return ye.fName=ge,ye.fLineColor=Me++%8+2,ye.fShape=xt,ye;ge&&(ge+="/"),ye.$geoh=!0,ye.fName="";const Pe=(0,x.create)(x.clTGeoNodeMatrix);(0,Z.bg)(Pe,Z.Wv.kVisThis,!0),(0,Z.bg)(Pe,Z.Wv.kVisDaughters,!0),Pe.fName="Left",Pe.fMatrix=xt.fNode.fLeftMat,Pe.fVolume=je(xt.fNode.fLeft,K-1,ge+"Left");const At=(0,x.create)(x.clTGeoNodeMatrix);return(0,Z.bg)(At,Z.Wv.kVisThis,!0),(0,Z.bg)(At,Z.Wv.kVisDaughters,!0),At.fName="Right",At.fMatrix=xt.fNode.fRightMat,At.fVolume=je(xt.fNode.fRight,K-1,ge+"Right"),ye.fNodes=(0,x.create)(x.clTList),ye.fNodes.Add(Pe),ye.fNodes.Add(At),ge||(Me=0),ye}function Ge(xt){const K=xt?.getFramePainter();if(xt?.mode3d&&(0,x.isFunc)(K?.create3DScene)&&K?.renderer){let ge=1,ye=1,Pe=1,At=0,Vt=0,Nt=0;return K.scale_xmax>K.scale_xmin&&(ge=2*K.size_x3d/(K.scale_xmax-K.scale_xmin),At=(K.scale_xmax+K.scale_xmin)/2*ge),K.scale_ymax>K.scale_ymin&&(ye=2*K.size_y3d/(K.scale_ymax-K.scale_ymin),Vt=(K.scale_ymax+K.scale_ymin)/2*ye),K.scale_zmax>K.scale_zmin&&(Pe=2*K.size_z3d/(K.scale_zmax-K.scale_zmin),Nt=(K.scale_zmax+K.scale_zmin)/2*Pe-K.size_z3d),{webgl:K.webgl,scene:K.scene,scene_width:K.scene_width,scene_height:K.scene_height,toplevel:K.toplevel,renderer:K.renderer,camera:K.camera,scale_x:ge,scale_y:ye,scale_z:Pe,offset_x:At,offset_y:Vt,offset_z:Nt}}}function lt(xt,K,ge,ye){if(!K?.arr?.length)return;const Pe={_name:ge,_kind:x.prROOT+x.clTList,_title:ye,_more:!0,_geoobj:K,_parent:xt,_get:At=>Promise.resolve(At._geoobj||null),_expand(At,Vt){if(Vt.fVolume&&(Vt=Vt.fVolume.fNodes),!Vt.arr)return!1;At._childs=[],(0,Z.$T)(null,Vt.arr);for(const Nt in Vt.arr)ti(At,Vt.arr[Nt]);return!0}};xt._childs||(xt._childs=[]),xt._childs.push(Pe)}function bt(xt,K){if(yn(),!xt||!K)return!1;const ge=0===K._typename.indexOf(x.clTGeoNode),ye=0===K._typename.indexOf(x.clTGeoVolume),Pe=K._typename===G,At=K._typename===b||K._typename===fe,Vt=K._typename===P;if(!(ge||ye||Pe||At||Vt))return!1;if(xt._childs)return!0;if(Pe)return lt(xt,K.fMaterials,"Materials","list of materials"),lt(xt,K.fMedia,"Media","list of media"),lt(xt,K.fTracks,"Tracks","list of tracks"),lt(xt,K.fOverlaps,"Overlaps","list of detected overlaps"),ti(xt,K.fMasterVolume),!0;if(Vt)return ti(xt,K.fVolume1),ti(xt,K.fVolume2),ti(xt,K.fMarker,"Marker"),!0;let Nt,nn,hn;if(At?(nn=K.fElements?.arr,hn=K.fShape):(Nt=ge?K.fVolume:K,nn=Nt?.fNodes?.arr,hn=Nt?.fShape),!nn&&hn?._typename===Z.HO&&hn?.fNode)return xt._childs||(ti(xt,hn.fNode.fLeft,"Left"),ti(xt,hn.fNode.fRight,"Right")),!0;if(!nn)return!1;(0,Z.$T)(K,nn);for(let kn=0;kn<nn.length;++kn)ti(xt,nn[kn]);return!0}function te(xt,K){for(;xt;){if(xt._painter?._camera)return K&&(0,x.isFunc)(xt._painter[K])&&xt._painter[K](),xt;xt=xt._parent}return null}function Je(xt){if(xt._typename===b||xt._typename===fe)return xt.fRnrSelf?" geovis_this":"";const K=!(0,Z.zL)(xt,Z.Wv.kVisNone)&&(0,Z.zL)(xt,Z.Wv.kVisThis);let ge=(0,Z.zL)(xt,Z.Wv.kVisDaughters);return ge&&!xt.fNodes?.arr?.length&&(ge=!1),K&&ge?" geovis_all":K?" geovis_this":ge?" geovis_daughters":""}function tt(xt,K){!xt||!K||K.forEachItem(ge=>{(xt===ge._volume||xt===ge._geoobj)&&(ge._icon=ge._icon.split(" ")[0]+Je(xt),K.updateTreeNode(ge))})}function Fe(xt){const K=xt?.object;return K?K.stack?K.stack:K.stacks&&void 0!==xt.instanceId&&xt.instanceId<K.stacks.length?K.stacks[xt.instanceId]:void 0:null}class Ne{constructor(K,ge,ye){this.bright=ge,this.buttons=ye,this.element=K.append("div").attr("style","float: left; box-sizing: border-box; position: relative; bottom: 23px; vertical-align: middle; padding-left: 5px")}createButtons(){const K=[];this.buttons.forEach(ge=>{const ye=ge.name;if(!ye)throw new Error("must provide button name in button config");if(-1!==K.indexOf(ye))throw new Error(`button name ${ye} is taken`);K.push(ye);const Pe=ge.title||ge.name;if(!(0,x.isFunc)(ge.click))throw new Error("must provide button click() function in button config");ve.IK.createSVG(this.element,ve.IK[ge.icon],16,Pe,this.bright).on("click",ge.click).style("position","relative").style("padding","3px 1px")})}changeBrightness(K){this.bright!==K&&(this.element.selectAll("*").remove(),this.bright=K,this.createButtons())}cleanup(){this.element?.remove(),delete this.element}}class rt extends g.KG{constructor(K,ge){super(),this.mesh=K?.material?K:null,this.bloom=ge}setHighlight(K,ge){return this.drawSpecial(K,ge)}drawSpecial(K,ge){const ye=this.mesh;if(ye?.material){if(ye.isInstancedMesh){if(ye._highlight_mesh&&(ye.remove(ye._highlight_mesh),delete ye._highlight_mesh),K&&void 0!==ge){const Pe=new L.eaF(ye.geometry,ye.material.clone());this.bloom?(Pe.layers.enable(1),Pe.material.emissive=new L.Q1f(65280)):(Pe.material.color=new L.Q1f(K),Pe.material.opacity=1);const At=new L.kn4;ye.getMatrixAt(ge,At),Pe.applyMatrix4(At),ye.add(Pe),Pe.jsroot_special=!0,ye._highlight_mesh=Pe}return!0}if(K)return ye.origin||(ye.origin={color:ye.material.color,emissive:ye.material.emissive,opacity:ye.material.opacity,width:ye.material.linewidth,size:ye.material.size}),this.bloom?(ye.layers.enable(1),ye.material.emissive=new L.Q1f(65280)):(ye.material.color=new L.Q1f(K),ye.material.opacity=1),ye.hightlightWidthScale&&!x.browser.isWin&&(ye.material.linewidth=ye.origin.width*ye.hightlightWidthScale),ye.highlightScale&&(ye.material.size=ye.origin.size*ye.highlightScale),!0;if(ye.origin)return this.bloom?(ye.material.emissive=ye.origin.emissive,ye.layers.enable(0)):(ye.material.color=ye.origin.color,ye.material.opacity=ye.origin.opacity),ye.hightlightWidthScale&&(ye.material.linewidth=ye.origin.width),ye.highlightScale&&(ye.material.size=ye.origin.size),!0}}}class $n extends C.JW{constructor(K,ge){let ye;ge?._typename===G&&(ye=ge,ge=ge.fMasterVolume),ge?._typename&&0===ge._typename.indexOf(x.clTGeoVolume)&&(ge={_typename:x.clTGeoNode,fVolume:ge,fName:ge.fName,$geoh:ge.$geoh,_proxy:!0}),super(K,ge),Ge(this.getMainPainter())&&(this.superimpose=!0),ye&&(this.geo_manager=ye),this.no_default_title=!0,this.mode3d=!0,this.drawing_stage=0,this.drawing_log="Init",this.ctrl={clipIntersect:!0,clipVisualize:!1,clip:[{name:"x",enabled:!1,value:0,min:-100,max:100,step:1},{name:"y",enabled:!1,value:0,min:-100,max:100,step:1},{name:"z",enabled:!1,value:0,min:-100,max:100,step:1}],_highlight:0,highlight:0,highlight_bloom:0,highlight_scene:0,highlight_color:"#00ff00",bloom_strength:1.5,more:1,maxfaces:0,vislevel:void 0,maxnodes:void 0,dflt_colors:!1,info:{num_meshes:0,num_faces:0,num_shapes:0},depthTest:!0,depthMethod:"dflt",select_in_view:!1,update_browser:!0,use_fog:!1,light:{kind:"points",top:!1,bottom:!1,left:!1,right:!1,front:!1,specular:!0,power:1},lightKindItems:[{name:"AmbientLight",value:"ambient"},{name:"DirectionalLight",value:"points"},{name:"HemisphereLight",value:"hemisphere"},{name:"Ambient + Point",value:"mix"}],trans_radial:0,trans_z:0,scale:new L.Pq0(1,1,1),zoom:1,rotatey:0,rotatez:0,depthMethodItems:[{name:"Default",value:"dflt"},{name:"Raytraicing",value:"ray"},{name:"Boundary box",value:"box"},{name:"Mesh size",value:"size"},{name:"Central point",value:"pnt"}],cameraKindItems:[{name:"Perspective",value:"perspective"},{name:"Perspective (Floor XOZ)",value:"perspXOZ"},{name:"Perspective (Floor YOZ)",value:"perspYOZ"},{name:"Perspective (Floor XOY)",value:"perspXOY"},{name:"Orthographic (XOY)",value:"orthoXOY"},{name:"Orthographic (XOZ)",value:"orthoXOZ"},{name:"Orthographic (ZOY)",value:"orthoZOY"},{name:"Orthographic (ZOX)",value:"orthoZOX"},{name:"Orthographic (XnOY)",value:"orthoXNOY"},{name:"Orthographic (XnOZ)",value:"orthoXNOZ"},{name:"Orthographic (ZnOY)",value:"orthoZNOY"},{name:"Orthographic (ZnOX)",value:"orthoZNOX"}],cameraOverlayItems:[{name:"None",value:"none"},{name:"Bar",value:"bar"},{name:"Axis",value:"axis"},{name:"Grid",value:"grid"},{name:"Grid background",value:"gridb"},{name:"Grid foreground",value:"gridf"}],camera_kind:"perspective",camera_overlay:"gridb",rotate:!1,background:x.settings.DarkMode?"#000000":"#ffffff",can_rotate:!0,_axis:0,instancing:0,_count:!1,wireframe:!1,transparency:0,flatShading:!1,roughness:.5,metalness:.5,shininess:0,reflectivity:.5,material_kind:"lambert",materialKinds:[{name:"MeshLambertMaterial",value:"lambert",emissive:!0,props:[{name:"flatShading"}]},{name:"MeshBasicMaterial",value:"basic"},{name:"MeshStandardMaterial",value:"standard",emissive:!0,props:[{name:"flatShading"},{name:"roughness",min:0,max:1,step:.001},{name:"metalness",min:0,max:1,step:.001}]},{name:"MeshPhysicalMaterial",value:"physical",emissive:!0,props:[{name:"flatShading"},{name:"roughness",min:0,max:1,step:.001},{name:"metalness",min:0,max:1,step:.001},{name:"reflectivity",min:0,max:1,step:.001}]},{name:"MeshPhongMaterial",value:"phong",emissive:!0,props:[{name:"flatShading"},{name:"shininess",min:0,max:100,step:.1}]},{name:"MeshNormalMaterial",value:"normal",props:[{name:"flatShading"}]},{name:"MeshDepthMaterial",value:"depth"},{name:"MeshMatcapMaterial",value:"matcap"},{name:"MeshToonMaterial",value:"toon"}],getMaterialCfg:function(){let Pe;return this.materialKinds.forEach(At=>{At.value===this.material_kind&&(Pe=At)}),Pe}},this.cleanup(!0)}changeDarkMode(K){("#000000"===this.ctrl.background||"#ffffff"===this.ctrl.background)&&this.changedBackground(K??x.settings.DarkMode?"#000000":"#ffffff")}changeStage(K,ge){if(this.drawing_stage=K,!ge)switch(K){case 0:ge="Building done";break;case 1:ge="collect visibles";break;case 2:ge="worker collect visibles";break;case 3:ge="Analyse visibles";break;case 4:ge="collect shapes for building";break;case 5:ge="Start build shapes";break;case 6:ge="Worker build shapes";break;case 7:ge="Build shapes";break;case 8:ge="Build ready";break;case 9:ge="Wait for main painter";break;case 10:ge="Build projection";break;default:ge=`stage ${K}`}this.drawing_log=ge}isStage(K){return K===this.drawing_stage}isBatchMode(){return(0,x.isBatchMode)()||this.batch_mode}createToolbar(){if(this._toolbar||!this._webgl||this.ctrl.notoolbar||this.isBatchMode())return;const K=[{name:"toImage",title:"Save as PNG",icon:"camera",click:()=>this.createSnapshot()},{name:"control",title:"Toggle control UI",icon:"rect",click:()=>this.showControlGui("toggle")},{name:"enlarge",title:"Enlarge geometry drawing",icon:"circle",click:()=>this.toggleEnlarge()}];navigator.getVRDisplays&&(K.push({name:"entervr",title:"Enter VR (It requires a VR Headset connected)",icon:"vrgoggles",click:()=>this.toggleVRMode()}),this.initVRMode()),x.settings.ContextMenu&&K.push({name:"menu",title:"Show context menu",icon:"question",click:ye=>{ye.preventDefault(),ye.stopPropagation(),!(0,I.IV)()&&(0,I.ES)(ye,this).then(Pe=>{Pe.painter.fillContextMenu(Pe),Pe.show()})}});const ge=new L.Q1f(this.ctrl.background);this._toolbar=new Ne(this.selectDom(),ge.r+ge.g+ge.b<1,K),this._toolbar.createButtons()}initVRMode(){this._dolly=new L.YJl,this._scene.add(this._dolly),this._standingMatrix=new L.kn4,this._raycasterEnd=new L.Pq0,this._raycasterOrigin=new L.Pq0,navigator.getVRDisplays().then(K=>{const ge=K[0];ge&&(this._renderer.vr.setDevice(ge),this._vrDisplay=ge,ge.stageParameters&&this._standingMatrix.fromArray(ge.stageParameters.sittingToStandingTransform),this.initVRControllersGeometry())})}initVRControllersGeometry(){const K=new L.Gu$(.025,18,36),ge=new L.V9B({color:"grey",vertexColors:!1}),ye=new L.V9B({color:"fuchsia",vertexColors:!1}),Pe=new L.iNn(.001,.001,2),At=new L.eaF(Pe,ye),Vt=new L.eaF(Pe,ye),Nt=new L.eaF(K,ge),nn=new L.eaF(K,ge);this._controllersMeshes=[],this._controllersMeshes.push(Nt),this._controllersMeshes.push(nn),At.position.z-=1,Vt.position.z-=1,Nt.add(At),nn.add(Vt),this._dolly.add(Nt),this._dolly.add(nn),Nt.visible=!1,nn.visible=!1}updateVRControllersList(){const K=navigator.getGamepads&&navigator.getGamepads();if(!this.vrControllers||K.length!==this.vrControllers.length){this._controllersMeshes.forEach(ge=>{ge.visible=!1}),this._vrControllers=[];for(let ge=0;ge<K.length;++ge)!K[ge]||!K[ge].pose||(this._vrControllers.push({gamepad:K[ge],mesh:this._controllersMeshes[ge]}),this._controllersMeshes[ge].visible=!0)}}processVRControllerIntersections(){let K=[];for(let ge=0;ge<this._vrControllers.length;++ge){const ye=this._vrControllers[ge].mesh,Pe=ye.localToWorld(this._raycasterEnd.set(0,0,-1)),At=ye.localToWorld(this._raycasterOrigin.set(0,0,0));Pe.sub(At).normalize(),K=K.concat(this._controls.getOriginDirectionIntersects(At,Pe))}K=K.filter((ge,ye)=>K.indexOf(ge)===ye),this._controls.processMouseMove(K)}updateVRControllers(){this.updateVRControllersList();for(let K=0;K<this._vrControllers.length;++K){const ge=this._vrControllers[K],ye=ge.gamepad.pose.orientation,Pe=ge.gamepad.pose.position,At=ge.mesh;ye&&At.quaternion.fromArray(ye),Pe&&At.position.fromArray(Pe),At.updateMatrix(),At.applyMatrix4(this._standingMatrix),At.matrixWorldNeedsUpdate=!0}this.processVRControllerIntersections()}toggleVRMode(){if(this._vrDisplay){if(this._vrDisplay.isPresenting)return void this.exitVRMode();this._previousCameraPosition=this._camera.position.clone(),this._previousCameraRotation=this._camera.rotation.clone(),this._vrDisplay.requestPresent([{source:this._renderer.domElement}]).then(()=>{this._previousCameraNear=this._camera.near,this._dolly.position.set(this._camera.position.x/4,-this._camera.position.y/8,-this._camera.position.z/4),this._camera.position.set(0,0,0),this._dolly.add(this._camera),this._camera.near=.1,this._camera.updateProjectionMatrix(),this._renderer.vr.enabled=!0,this._renderer.setAnimationLoop(()=>{this.updateVRControllers(),this.render3D(0)})}),this._renderer.vr.enabled=!0,window.addEventListener("keydown",K=>{"Escape"===K.code&&this.exitVRMode()})}}exitVRMode(){this._vrDisplay.isPresenting&&(this._renderer.vr.enabled=!1,this._dolly.remove(this._camera),this._scene.add(this._camera),this._camera.position.copy(this._previousCameraPosition),this._previousCameraPosition=void 0,this._camera.rotation.copy(this._previousCameraRotation),this._previousCameraRotation=void 0,this._camera.near=this._previousCameraNear,this._camera.updateProjectionMatrix(),this._vrDisplay.exitPresent())}getGeometry(){return this.getObject()}modifyVisisbility(K,ge){if(0!==(0,Z.Dh)(this.getGeometry()))return;if(!K)return(0,Z.bg)(this.getGeometry().fVolume,Z.Wv.kVisThis,"+"===ge);let ye,Pe=!1;K.indexOf("*")<0?(ye=new RegExp("^"+K+"$"),Pe=!0):(ye=new RegExp("^"+K.split("*").join(".*")+"$"),Pe=!1),this.findNodeWithVolume(ye,At=>((0,Z.N_)(At.node.fVolume,"+"!==ge),Pe?At:null))}decodeOptions(K){(0,x.isStr)(K)||(K=""),this.superimpose&&0===K.indexOf("same")&&(K=K.slice(4));const ge=this.ctrl,ye=K.indexOf("macro:");if(ye>=0){let Vt=K.indexOf(";",ye+6);Vt<0&&(Vt=K.length),ge.script_name=K.slice(ye+6,Vt),K=K.slice(0,ye)+K.slice(Vt+1),console.log(`script ${ge.script_name} rest ${K}`)}for(;;){const Vt=K.indexOf("+"),Nt=K.indexOf("-");if(Vt<0&&Nt<0)break;let nn=Vt,hn="+";(nn<0||Nt>=0&&Nt<Vt)&&(nn=Nt,hn="-");let kn=nn+1;const dn=/[,; .]/;for(;kn<K.length&&!dn.test(K[kn])&&"+"!==K[kn]&&"-"!==K[kn];)kn++;const In=K.substring(nn+1,kn);K=K.slice(0,nn)+K.slice(kn),this.modifyVisisbility(In,hn)}const Pe=new f.nC(K);Pe.check("MAIN")&&(ge.is_main=!0),Pe.check("TRACKS")&&(ge.tracks=!0),Pe.check("SHOWTOP")&&(ge.showtop=!0),Pe.check("NO_SCREEN")&&(ge.no_screen=!0),Pe.check("NOINSTANCING")&&(ge.instancing=-1),Pe.check("INSTANCING")&&(ge.instancing=1),Pe.check("ORTHO_CAMERA")&&(ge.camera_kind="orthoXOY",ge.can_rotate=0),Pe.check("ORTHO",!0)&&(ge.camera_kind="ortho"+Pe.part,ge.can_rotate=0),Pe.check("OVERLAY",!0)&&(ge.camera_overlay=Pe.part.toLowerCase()),Pe.check("CAN_ROTATE")&&(ge.can_rotate=!0),Pe.check("PERSPECTIVE")&&(ge.camera_kind="perspective",ge.can_rotate=!0),Pe.check("PERSP",!0)&&(ge.camera_kind="persp"+Pe.part,ge.can_rotate=!0),Pe.check("MOUSE_CLICK")&&(ge.mouse_click=!0),(Pe.check("DEPTHRAY")||Pe.check("DRAY"))&&(ge.depthMethod="ray"),(Pe.check("DEPTHBOX")||Pe.check("DBOX"))&&(ge.depthMethod="box"),(Pe.check("DEPTHPNT")||Pe.check("DPNT"))&&(ge.depthMethod="pnt"),(Pe.check("DEPTHSIZE")||Pe.check("DSIZE"))&&(ge.depthMethod="size"),(Pe.check("DEPTHDFLT")||Pe.check("DDFLT"))&&(ge.depthMethod="dflt"),Pe.check("ZOOM",!0)&&(ge.zoom=Pe.partAsFloat(0,100)/100),Pe.check("ROTY",!0)&&(ge.rotatey=Pe.partAsFloat()),Pe.check("ROTZ",!0)&&(ge.rotatez=Pe.partAsFloat()),Pe.check("PHONG")&&(ge.material_kind="phong"),Pe.check("LAMBERT")&&(ge.material_kind="lambert"),Pe.check("MATCAP")&&(ge.material_kind="matcap"),Pe.check("TOON")&&(ge.material_kind="toon"),Pe.check("AMBIENT")&&(ge.light.kind="ambient");const At=()=>{let Vt=1;return"N"===Pe.part[0]&&(Vt=-1,Pe.part=Pe.part.slice(1)),Vt*Pe.partAsFloat()};if(Pe.check("CAMX",!0)&&(ge.camx=At()),Pe.check("CAMY",!0)&&(ge.camy=At()),Pe.check("CAMZ",!0)&&(ge.camz=At()),Pe.check("CAMLX",!0)&&(ge.camlx=At()),Pe.check("CAMLY",!0)&&(ge.camly=At()),Pe.check("CAMLZ",!0)&&(ge.camlz=At()),Pe.check("BLACK")&&(ge.background="#000000"),Pe.check("WHITE")&&(ge.background="#FFFFFF"),Pe.check("BKGR_",!0)){let Vt=null;if(Pe.partAsInt(1)>0)Vt=(0,v.oU)(Pe.partAsInt());else for(let Nt=0;Nt<8;++Nt)(0,v.oU)(Nt).toUpperCase()===Pe.part&&(Vt=(0,v.oU)(Nt));Vt&&(ge.background="#"+new L.Q1f(Vt).getHexString())}Pe.check("R3D_",!0)&&(ge.Render3D=x.constants.Render3D.fromString(Pe.part.toLowerCase())),Pe.check("MORE",!0)&&(ge.more=Pe.partAsInt(0,2)??2),Pe.check("ALL")&&(ge.more=100,ge.vislevel=99),Pe.check("VISLVL",!0)&&(ge.vislevel=Pe.partAsInt()),Pe.check("MAXNODES",!0)&&(ge.maxnodes=Pe.partAsInt()),Pe.check("MAXFACES",!0)&&(ge.maxfaces=Pe.partAsInt()),(Pe.check("CONTROLS")||Pe.check("CTRL"))&&(ge.show_controls=!0),Pe.check("CLIPXYZ")&&(ge.clip[0].enabled=ge.clip[1].enabled=ge.clip[2].enabled=!0),Pe.check("CLIPX")&&(ge.clip[0].enabled=!0),Pe.check("CLIPY")&&(ge.clip[1].enabled=!0),Pe.check("CLIPZ")&&(ge.clip[2].enabled=!0),Pe.check("CLIP")&&(ge.clip[0].enabled=ge.clip[1].enabled=ge.clip[2].enabled=!0),Pe.check("PROJX",!0)&&(ge.project="x",Pe.partAsInt(1)>0&&(ge.projectPos=Pe.partAsInt()),ge.can_rotate=0),Pe.check("PROJY",!0)&&(ge.project="y",Pe.partAsInt(1)>0&&(ge.projectPos=Pe.partAsInt()),ge.can_rotate=0),Pe.check("PROJZ",!0)&&(ge.project="z",Pe.partAsInt(1)>0&&(ge.projectPos=Pe.partAsInt()),ge.can_rotate=0),(Pe.check("DFLT_COLORS")||Pe.check("DFLT"))&&(ge.dflt_colors=!0),Pe.check("SSAO"),Pe.check("NOBLOOM")&&(ge.highlight_bloom=!1),Pe.check("BLOOM")&&(ge.highlight_bloom=!0),Pe.check("OUTLINE")&&(ge.outline=!0),Pe.check("NOWORKER")&&(ge.use_worker=-1),Pe.check("WORKER")&&(ge.use_worker=1),Pe.check("NOFOG")&&(ge.use_fog=!1),Pe.check("FOG")&&(ge.use_fog=!0),(Pe.check("NOHIGHLIGHT")||Pe.check("NOHIGH"))&&(ge.highlight_scene=ge.highlight=!1),Pe.check("HIGHLIGHT")&&(ge.highlight_scene=ge.highlight=!0),Pe.check("HSCENEONLY")&&(ge.highlight_scene=!0,ge.highlight=!1),Pe.check("NOHSCENE")&&(ge.highlight_scene=!1),Pe.check("HSCENE")&&(ge.highlight_scene=!0),(Pe.check("WIREFRAME")||Pe.check("WIRE"))&&(ge.wireframe=!0),Pe.check("ROTATE")&&(ge.rotate=!0),(Pe.check("INVX")||Pe.check("INVERTX"))&&(ge.scale.x=-1),(Pe.check("INVY")||Pe.check("INVERTY"))&&(ge.scale.y=-1),(Pe.check("INVZ")||Pe.check("INVERTZ"))&&(ge.scale.z=-1),Pe.check("COUNT")&&(ge._count=!0),Pe.check("TRANSP",!0)&&(ge.transparency=Pe.partAsInt(0,100)/100),Pe.check("OPACITY",!0)&&(ge.transparency=1-Pe.partAsInt(0,100)/100),(Pe.check("AXISCENTER")||Pe.check("AXISC")||Pe.check("AC"))&&(ge._axis=2),(Pe.check("AXIS")||Pe.check("A"))&&(ge._axis=1),Pe.check("TRR",!0)&&(ge.trans_radial=Pe.partAsInt()/100),Pe.check("TRZ",!0)&&(ge.trans_z=Pe.partAsInt()/100),Pe.check("W")&&(ge.wireframe=!0),Pe.check("Y")&&(ge._yup=!0),Pe.check("Z")&&(ge._yup=!1),void 0===ge._yup&&(ge._yup=this.getCanvSvg().empty()),this.options=ge}activateInBrowser(K,ge){(0,x.isStr)(K)&&(K=[K]),this._hpainter&&(this._hpainter.activateItems(K,ge),this.ctrl.update_browser||setTimeout(()=>this._hpainter.activateItems([]),2e3))}testMatrixes(){let K=0,ge=0,ye=0;const Pe={domatrix:!0,func:()=>{let Nt=this.getmatrix();const nn=this.copyStack(),hn=this._clones.createObject3D(nn.stack,this._toplevel,"mesh");if(!hn)return!0;ge++;const kn=hn.matrixWorld;if(kn.equals(Nt))return!0;if(kn.determinant()>0&&Nt.determinant()<-.9){const In=new L.Pq0(1,1,-1);if(Nt=Nt.clone().scale(In),kn.equals(Nt))return!0}let dn=0;for(let In=0;In<16;++In)dn=Math.max(dn,Math.abs(kn.elements[In]-Nt.elements[In]));return ye=Math.max(dn,ye),dn<1e-4||(console.log(`${this._clones.resolveStack(nn.stack).name} maxdiff ${dn} determ ${kn.determinant()} ${Nt.determinant()}`),K++,!1)}},At=(new Date).getTime();this._clones.scanVisible(Pe);const Vt=(new Date).getTime();console.log(`Compare matrixes total ${ge} errors ${K} takes ${Vt-At} maxdiff ${ye}`)}fillContextMenu(K){K.add("header: Draw options"),K.addchk(this.ctrl.update_browser,"Browser update",()=>{this.ctrl.update_browser=!this.ctrl.update_browser,this.ctrl.update_browser||this.activateInBrowser([])}),K.addchk(this.ctrl.show_controls,"Show Controls",()=>this.showControlGui("toggle")),K.add("sub:Show axes",()=>this.setAxesDraw("toggle")),K.addchk(0===this.ctrl._axis,"off",0,ge=>this.setAxesDraw(parseInt(ge))),K.addchk(1===this.ctrl._axis,"side",1,ge=>this.setAxesDraw(parseInt(ge))),K.addchk(2===this.ctrl._axis,"center",2,ge=>this.setAxesDraw(parseInt(ge))),K.add("endsub:"),this.geo_manager&&K.addchk(this.ctrl.showtop,"Show top volume",()=>this.setShowTop(!this.ctrl.showtop)),K.addchk(this.ctrl.wireframe,"Wire frame",()=>this.toggleWireFrame()),this.getCanvPainter()||K.addchk(this.isTooltipAllowed(),"Show tooltips",()=>this.setTooltipAllowed("toggle")),K.add("sub:Highlight"),K.addchk(!this.ctrl.highlight,"Off",()=>{this.ctrl.highlight=!1,this.changedHighlight()}),K.addchk(this.ctrl.highlight&&!this.ctrl.highlight_bloom,"Normal",()=>{this.ctrl.highlight=!0,this.ctrl.highlight_bloom=!1,this.changedHighlight()}),K.addchk(this.ctrl.highlight&&this.ctrl.highlight_bloom,"Bloom",()=>{this.ctrl.highlight=!0,this.ctrl.highlight_bloom=!0,this.changedHighlight()}),K.add("separator"),K.addchk(this.ctrl.highlight_scene,"Scene",ge=>{this.ctrl.highlight_scene=ge,this.changedHighlight()}),K.add("endsub:"),K.add("sub:Camera"),K.add("Reset position",()=>this.focusCamera()),this.ctrl.project||K.addchk(this.ctrl.rotate,"Autorotate",()=>this.setAutoRotate(!this.ctrl.rotate)),this._geom_viewer||(K.addchk(this.canRotateCamera(),"Can rotate",()=>this.changeCanRotate(!this.ctrl.can_rotate)),K.add("Get position",()=>K.info("Position (as url)","&opt="+this.produceCameraUrl())),this.isOrthoCamera()||K.add("Absolute position",()=>{const ge=this.produceCameraUrl(!0),ye=ge.indexOf("camlx");K.info("Position (as url)","&opt="+(ye<0?ge:ge.slice(0,ye)+"\n"+ge.slice(ye)))}),K.add("sub:Kind"),this.ctrl.cameraKindItems.forEach(ge=>K.addchk(this.ctrl.camera_kind===ge.value,ge.name,ge.value,ye=>{this.ctrl.camera_kind=ye,this.changeCamera()})),K.add("endsub:"),this.isOrthoCamera()&&(K.add("sub:Overlay"),this.ctrl.cameraOverlayItems.forEach(ge=>K.addchk(this.ctrl.camera_overlay===ge.value,ge.name,ge.value,ye=>{this.ctrl.camera_overlay=ye,this.changeCamera()})),K.add("endsub:"))),K.add("endsub:"),K.addchk(this.ctrl.select_in_view,"Select in view",()=>{this.ctrl.select_in_view=!this.ctrl.select_in_view,this.ctrl.select_in_view&&this.startDrawGeometry()})}changedGlobalTransparency(K){const ge=(0,x.isFunc)(K)?K:null;(ge||void 0===K)&&(K=this.ctrl.transparency),this._toplevel?.traverse(ye=>{if(void 0===ye?.material?.inherentOpacity)return;const Pe=ge?ge(ye):void 0;ye.material.opacity=void 0!==Pe?1-Pe:Math.min(1-(K||0),ye.material.inherentOpacity),ye.material.depthWrite=1===ye.material.opacity,ye.material.transparent=ye.material.opacity<1}),this.render3D()}changedMaterial(){this._toplevel?.traverse(K=>{void 0!==K.material?.inherentArgs&&(K.material=(0,Z.Cc)(this.ctrl,K.material.inherentArgs))}),this.render3D(-1)}changeMaterialProperty(K){const ge=this.ctrl[K];if(void 0===ge)return console.error("No property ",K);this._toplevel?.traverse(ye=>{void 0!==ye.material?.inherentArgs&&void 0!==ye.material[K]&&(ye.material[K]=ge,ye.material.needsUpdate=!0)}),this.render3D()}resetTransformation(){this.changedTransformation("reset")}changedTransformation(K){if(!this._toplevel)return;const ge=this.ctrl,ye=new L.kn4,Pe=new L.Pq0;"reset"===K&&(ge.trans_z=ge.trans_radial=0),this._toplevel.traverse(At=>{if(void 0!==At.stack){const Vt=At.parent;if("reset"===K)return Vt.matrix0&&(Vt.matrix.copy(Vt.matrix0),Vt.matrix.decompose(Vt.position,Vt.quaternion,Vt.scale),Vt.matrixWorldNeedsUpdate=!0),delete Vt.matrix0,delete Vt.vect0,delete Vt.vect1,void delete Vt.minvert;if(void 0===Vt.vect0){Vt.matrix0=Vt.matrix.clone(),Vt.minvert=(new L.kn4).copy(Vt.matrixWorld).invert();const Nt=(0,Z.UX)(At,null,!0);Vt.vect0=new L.Pq0((Nt.max.x+Nt.min.x)/2,(Nt.max.y+Nt.min.y)/2,(At._flippedMesh?-1:1)*(Nt.max.z+Nt.min.z)/2).applyMatrix4(Vt.matrixWorld),Vt.vect1=new L.Pq0(0,0,0).applyMatrix4(Vt.minvert)}Pe.set(ge.trans_radial*Vt.vect0.x,ge.trans_radial*Vt.vect0.y,ge.trans_z*Vt.vect0.z).applyMatrix4(Vt.minvert).sub(Vt.vect1),Vt.matrix.multiplyMatrices(Vt.matrix0,ye.makeTranslation(Pe.x,Pe.y,Pe.z)),Vt.matrix.decompose(Vt.position,Vt.quaternion,Vt.scale),Vt.matrixWorldNeedsUpdate=!0}else if(void 0!==At.stacks){if(At.instanceMatrix.needsUpdate=!0,"reset"===K)return At.trans?.forEach((Nt,nn)=>{At.setMatrixAt(nn,Nt.matrix0)}),void delete At.trans;if(void 0===At.trans){At.trans=new Array(At.count),At.geometry.computeBoundingBox();for(let Nt=0;Nt<At.count;Nt++){const nn={matrix0:new L.kn4,minvert:new L.kn4};At.trans[Nt]=nn,At.getMatrixAt(Nt,nn.matrix0),nn.minvert.copy(nn.matrix0).invert();const hn=(new L.NRn).copy(At.geometry.boundingBox).applyMatrix4(nn.matrix0);nn.vect0=new L.Pq0((hn.max.x+hn.min.x)/2,(hn.max.y+hn.min.y)/2,(hn.max.z+hn.min.z)/2),nn.vect1=new L.Pq0(0,0,0).applyMatrix4(nn.minvert)}}const Vt=new L.kn4;At.trans?.forEach((Nt,nn)=>{Pe.set(ge.trans_radial*Nt.vect0.x,ge.trans_radial*Nt.vect0.y,ge.trans_z*Nt.vect0.z).applyMatrix4(Nt.minvert).sub(Nt.vect1),Vt.multiplyMatrices(Nt.matrix0,ye.makeTranslation(Pe.x,Pe.y,Pe.z)),At.setMatrixAt(nn,Vt)})}}),this._toplevel.updateMatrixWorld(),"norender"!==K&&this.drawAxesAndOverlay()}changedAutoRotate(){this.autorotate(2.5)}changedAxes(){(0,x.isStr)(this.ctrl._axis)&&(this.ctrl._axis=parseInt(this.ctrl._axis)),this.drawAxesAndOverlay()}changedBackground(K){if(void 0!==K&&(this.ctrl.background=K),this._scene.background=new L.Q1f(this.ctrl.background),this._renderer.setClearColor(this._scene.background,1),this.render3D(0),this._toolbar){const ge=new L.Q1f(this.ctrl.background);this._toolbar.changeBrightness(ge.r+ge.g+ge.b<1)}}showControlGui(K){if(!this.ctrl)return;if("toggle"===K?K=!this._gui:void 0===K&&(K=this.ctrl.show_controls),this.ctrl.show_controls=K,this._gui)return void(K||(this._gui.destroy(),delete this._gui));if(!K||!this._renderer)return;const ge=this.selectDom();"static"===ge.style("position")&&ge.style("position","relative"),this._gui=new A({container:ge.node(),closeFolders:!0,width:Math.min(300,this._scene_width/2),title:"Settings"});const ye=this._gui.domElement;ye.style.position="absolute",ye.style.top=0,ye.style.right=0,this._gui.painter=this;const Pe=Si=>{const bi={};return Si.forEach(Jn=>{bi[Jn.name]=Jn.value}),bi};if(!this.ctrl.project){const Si=this._gui.addFolder("Selection");this.ctrl.maxnodes||(this.ctrl.maxnodes=this._clones?.getMaxVisNodes()??1e4),this.ctrl.vislevel||(this.ctrl.vislevel=this._clones?.getVisLevel()??3),this.ctrl.maxfaces||(this.ctrl.maxfaces=2e5*this.ctrl.more),this.ctrl.more=1,Si.add(this.ctrl,"vislevel",1,99,1).name("Visibility level").listen().onChange(()=>this.startRedraw(500)),Si.add(this.ctrl,"maxnodes",0,5e5,1e3).name("Visible nodes").listen().onChange(()=>this.startRedraw(500)),Si.add(this.ctrl,"maxfaces",0,5e6,1e5).name("Max faces").listen().onChange(()=>this.startRedraw(500))}if(this.ctrl.project){const Si=this.getGeomBoundingBox(this.getProjectionSource(),.01),bi=this.ctrl.project;void 0===this.ctrl.projectPos&&(this.ctrl.projectPos=(Si.min[bi]+Si.max[bi])/2),this._gui.add(this.ctrl,"projectPos",Si.min[bi],Si.max[bi]).name(bi.toUpperCase()+" projection").onChange(()=>this.startDrawGeometry())}else{const Si=this._gui.addFolder("Clipping");for(let bi=0;bi<3;++bi){const Jn=this.ctrl.clip[bi],Wi=Jn.name.toUpperCase();Si.add(Jn,"enabled").name("Enable "+Wi).listen().onChange(()=>this.changedClipping(-1)),Si.add(Jn,"value",Jn.min,Jn.max,Jn.step).name(Wi+" position").listen().onChange(()=>this.changedClipping(bi))}Si.add(this.ctrl,"clipIntersect").name("Clip intersection").onChange(()=>this.changedClipping(-1)),Si.add(this.ctrl,"clipVisualize").name("Visualize").onChange(()=>this.changedClipping(-1))}const At=this._gui.addFolder("Scene");At.add(this.ctrl.light,"kind",Pe(this.ctrl.lightKindItems)).name("Light").listen().onChange(()=>{Vt.show("mix"===this.ctrl.light.kind||"points"===this.ctrl.light.kind),this.changedLight()}),this.ctrl.light._pnts=this.ctrl.light.specular?0:this.ctrl.light.front?1:2;const Vt=At.add(this.ctrl.light,"_pnts",{specular:0,front:1,box:2}).name("Positions").show("mix"===this.ctrl.light.kind||"points"===this.ctrl.light.kind).onChange(Si=>{this.ctrl.light.specular=0===Si,this.ctrl.light.front=1===Si,this.ctrl.light.top=this.ctrl.light.bottom=this.ctrl.light.left=this.ctrl.light.right=2===Si,this.changedLight()});At.add(this.ctrl.light,"power",0,10,.01).name("Power").listen().onChange(()=>this.changedLight()),At.add(this.ctrl,"use_fog").name("Fog").listen().onChange(()=>this.changedUseFog());const Nt=this._gui.addFolder("Appearance");this.ctrl._highlight=this.ctrl.highlight?this.ctrl.highlight_bloom?2:1:0,Nt.add(this.ctrl,"_highlight",{none:0,normal:1,bloom:2}).name("Highlight Selection").listen().onChange(()=>{this.changedHighlight(this.ctrl._highlight),hn.show(2===this.ctrl._highlight),nn.show(1===this.ctrl._highlight)});const nn=Nt.addColor(this.ctrl,"highlight_color").name("Hightlight color").show(1===this.ctrl._highlight),hn=Nt.add(this.ctrl,"bloom_strength",0,3).name("Bloom strength").listen().onChange(()=>this.changedHighlight()).show(2===this.ctrl._highlight);Nt.addColor(this.ctrl,"background").name("Background").onChange(Si=>this.changedBackground(Si)),Nt.add(this.ctrl,"_axis",{none:0,side:1,center:2}).name("Axes").onChange(()=>this.changedAxes()),this.ctrl.project||Nt.add(this.ctrl,"rotate").name("Autorotate").listen().onChange(()=>this.changedAutoRotate());const kn=this._gui.addFolder("Material");let dn=[];const In=()=>{dn.forEach(bi=>bi.destroy()),dn=[];const Si=this.ctrl.getMaterialCfg()?.props;Si&&Si.forEach(bi=>{const Jn=kn.add(this.ctrl,bi.name,bi.min,bi.max,bi.step).onChange(()=>{this.changeMaterialProperty(bi.name)});dn.push(Jn)})};kn.add(this.ctrl,"material_kind",Pe(this.ctrl.materialKinds)).name("Kind").listen().onChange(()=>{In(),this.ensureBloom(!1),this.changedMaterial(),this.changedHighlight()}),kn.add(this.ctrl,"transparency",0,1,.001).name("Transparency").listen().onChange(Si=>this.changedGlobalTransparency(Si)),kn.add(this.ctrl,"wireframe").name("Wireframe").listen().onChange(()=>this.changedWireFrame()),kn.add(this,"showMaterialDocu").name("Docu from threejs.org"),In();const ci=this._gui.addFolder("Camera");ci.add(this.ctrl,"camera_kind",Pe(this.ctrl.cameraKindItems)).name("Kind").listen().onChange(()=>{Pi.show(0===this.ctrl.camera_kind.indexOf("ortho")),this.changeCamera()}),ci.add(this.ctrl,"can_rotate").name("Can rotate").listen().onChange(()=>this.changeCanRotate()),ci.add(this,"focusCamera").name("Reset position");const Pi=ci.add(this.ctrl,"camera_overlay",Pe(this.ctrl.cameraOverlayItems)).name("Overlay").listen().onChange(()=>this.changeCamera()).show(0===this.ctrl.camera_kind.indexOf("ortho"));if(this._webgl){const Si=this._gui.addFolder("Advanced");Si.add(this.ctrl,"depthTest").name("Depth test").listen().onChange(()=>this.changedDepthTest()),Si.add(this.ctrl,"depthMethod",Pe(this.ctrl.depthMethodItems)).name("Rendering order").onChange(bi=>this.changedDepthMethod(bi)),Si.add(this,"resetAdvanced").name("Reset")}if(!this.ctrl.project){const Si=this._gui.addFolder("Transform");Si.add(this.ctrl,"trans_z",0,3,.01).name("Z axis").listen().onChange(()=>this.changedTransformation()),Si.add(this.ctrl,"trans_radial",0,3,.01).name("Radial").listen().onChange(()=>this.changedTransformation()),Si.add(this,"resetTransformation").name("Reset"),(this.ctrl.trans_z||this.ctrl.trans_radial)&&Si.open()}}showMaterialDocu(){const K=this.ctrl.getMaterialCfg();K?.name&&typeof window<"u"&&window.open("https://threejs.org/docs/index.html#api/en/materials/"+K.name,"_blank")}changedHighlight(K){void 0!==K&&(this.ctrl.highlight=0!==K,this.ctrl.highlight&&(this.ctrl.highlight_bloom=2===K)),this.ensureBloom(),this.ctrl.highlight||this.highlightMesh(null),this._slave_painters?.forEach(ge=>{ge.ctrl.highlight=this.ctrl.highlight,ge.ctrl.highlight_bloom=this.ctrl.highlight_bloom,ge.ctrl.bloom_strength=this.ctrl.bloom_strength,ge.changedHighlight()})}changeCanRotate(K){void 0!==K&&(this.ctrl.can_rotate=K),this._controls&&(this._controls.enableRotate=this.ctrl.can_rotate)}changedUseFog(){this._scene.fog=this.ctrl.use_fog?this._fog:null,this.render3D()}changeCamera(){this._controls&&(this._controls.cleanup(),delete this._controls),this.ensureBloom(!1),this.createCamera(),this.createSpecialEffects(),this.adjustCameraPosition(!0),this.addOrbitControls(),this.render3D()}ensureBloom(K){if(void 0===K&&(0===this.ctrl.highlight_bloom&&(this.ctrl.highlight_bloom=this._webgl),K=this.ctrl.highlight_bloom&&this.ctrl.getMaterialCfg()?.emissive),K&&!this._bloomComposer){this._camera.layers.enable(1),this._bloomComposer=new L.s0G(this._renderer),this._bloomComposer.addPass(new L.AHc(this._scene,this._camera));const ge=new L.Cgj(new L.I9Y(this._scene_width,this._scene_height),1.5,.4,.85);ge.threshold=0,ge.radius=0,ge.renderToScreen=!0,this._bloomComposer.addPass(ge),this._renderer.autoClear=!1}else!K&&this._bloomComposer&&(this._bloomComposer.dispose(),delete this._bloomComposer,this._renderer&&(this._renderer.autoClear=!0),this._camera?.layers.disable(1),this._camera?.layers.set(0));this._bloomComposer?.passes&&(this._bloomComposer.passes[1].strength=this.ctrl.bloom_strength)}orbitContext(K,ge){(0,I.ES)(K,this).then(ye=>{let Pe=0,At=0,Vt=0;if(ge)for(let Nt=0;Nt<ge.length;++Nt)Fe(ge[Nt])&&At++,ge[Nt].geo_name&&Pe++;if(At+Pe===0)this.fillContextMenu(ye);else{const Nt=At+Pe>1;Nt&&ye.add("header:"+(Pe>0?"Items":"Nodes"));for(let nn=0;nn<ge.length;++nn){const hn=ge[nn].object,kn=Fe(ge[nn]);let dn,In,ci;if(hn.geo_name)In=hn.geo_name,0===In.indexOf("<prnt>")&&(In=(this.getItemName()||"top")+In.slice(6)),dn=In.slice(In.lastIndexOf("/")+1),dn||(dn=In),ci=dn;else{if(!kn)continue;dn=this._clones.getStackName(kn),In=this.getStackFullName(kn),ci=this.getItemName(),0===dn.indexOf("Nodes/")?ci=dn.slice(6):dn?ci=dn:ci||(ci="header")}if(Vt++,ye.add((Nt?"sub:":"header:")+ci,In,Si=>this.activateInBrowser([Si],!0)),ye.add("Browse",In,Si=>this.activateInBrowser([Si],!0)),this._hpainter&&ye.add("Inspect",In,Si=>this._hpainter.display(Si,x.kInspect)),(0,x.isFunc)(this.hidePhysicalNode))ye.add("Hide",In,Si=>this.hidePhysicalNode([Si])),Vt>1&&ye.add("Hide all before",nn,Si=>{const bi=[];for(let Jn=0;Jn<Si;++Jn){const Wi=Fe(ge[Jn]);Wi&&bi.push(this.getStackFullName(Wi))}this.hidePhysicalNode(bi)});else if(hn.geo_name){ye.add("Hide",nn,Si=>{const bi=ge[Si].object;bi.visible=!1,bi.geo_object&&(bi.geo_object.$hidden_via_menu=!0),ye.painter.render3D()},"Hide this physical node"),Nt&&ye.add("endsub:");continue}const Pi=this.accessObjectWireFrame(hn);void 0!==Pi&&ye.addchk(Pi,"Wireframe",nn,Si=>{const bi=ge[Si].object.material;bi.wireframe=!bi.wireframe,this.render3D()},"Toggle wireframe mode for the node"),Vt>1&&ye.add("Manifest",nn,Si=>{this._last_manifest&&(this._last_manifest.wireframe=!this._last_manifest.wireframe),this._last_hidden&&this._last_hidden.forEach(bi=>{bi.visible=!0}),this._last_hidden=[];for(let bi=0;bi<Si;++bi)this._last_hidden.push(ge[bi].object);this._last_hidden.forEach(bi=>{bi.visible=!1}),this._last_manifest=ge[Si].object.material,this._last_manifest.wireframe=!this._last_manifest.wireframe,this.render3D()},"Manifest selected node"),ye.add("Focus",nn,Si=>{this.focusCamera(ge[Si].object)}),this._geom_viewer||(ye.add("Hide",nn,Si=>{const bi=this._clones.resolveStack(ge[Si].object.stack);bi.obj&&bi.node.kind===Z.k$&&bi.obj.fVolume?((0,Z.bg)(bi.obj.fVolume,Z.Wv.kVisThis,!1),tt(bi.obj.fVolume,this._hpainter)):bi.obj&&bi.node.kind===Z.NN&&(bi.obj.fRnrSelf=!1,tt(bi.obj,this._hpainter)),this.testGeomChanges()},"Hide all logical nodes of that kind"),ye.add("Hide only this",nn,Si=>{this._clones.setPhysNodeVisibility(Fe(ge[Si]),!1),this.testGeomChanges()},"Hide only this physical node"),nn>1&&ye.add("Hide all before",nn,Si=>{for(let bi=0;bi<Si;++bi)this._clones.setPhysNodeVisibility(Fe(ge[bi]),!1);this.testGeomChanges()},"Hide all physical nodes before that")),Nt&&ye.add("endsub:")}}ye.show()})}filterIntersects(K){if(!K?.length)return K;for(let ye=0;ye<K.length;++ye)K[ye].object.geo_highlight&&(K[ye].object=K[ye].object.geo_highlight);for(let ye=K.length-1;ye>=0;--ye){const Pe=K[ye].object;let At=Pe.visible&&(Fe(K[ye])||void 0!==Pe.geo_name);At&&Pe.material&&void 0!==Pe.material.opacity&&(At=Pe.material.opacity>=.1),Pe.jsroot_special&&(At=!1);for(let Vt=0;Vt<ye&&At;++Vt)K[Vt].object===Pe&&(At=!1);At||K.splice(ye,1)}const ge=this.ctrl.clip;if(ge[0].enabled||ge[1].enabled||ge[2].enabled){const ye=[];for(let Pe=0;Pe<K.length;++Pe){const At=K[Pe].point,Vt="Points"===K[Pe].object.type;let Nt=!0;ge[0].enabled&&this._clipPlanes[0].normal.dot(At)>this._clipPlanes[0].constant^Vt&&(Nt=!1),ge[1].enabled&&this._clipPlanes[1].normal.dot(At)>this._clipPlanes[1].constant^Vt&&(Nt=!1),ge[2].enabled&&this._clipPlanes[2].normal.dot(At)>this._clipPlanes[2].constant&&(Nt=!1),Nt||ye.push(K[Pe])}K=ye}return K}testCameraPositionChange(){if(!this.ctrl.select_in_view||this._draw_all_nodes)return;const K=(0,Z.d4)(this._camera);(0,Z.P1)(K).CheckBox(this.getGeomBoundingBox())||this.startDrawGeometry()}resolveStack(K){return this._clones&&K?this._clones.resolveStack(K):null}getStackFullName(K){const ge=this.getItemName(),ye=this.resolveStack(K);return ye&&ye.name?ge?ge+"/"+ye.name:ye.name:ge}addHighlightHandler(K){(0,x.isFunc)(K?.highlightMesh)&&(this._highlight_handlers||(this._highlight_handlers=[]),this._highlight_handlers.push(K))}highlightMesh(K,ge,ye,Pe,At,Vt){if(ye){K=K?[K]:[];const kn=this.getExtrasContainer();kn&&kn.traverse(dn=>{dn.geo_object===ye&&K.indexOf(dn)<0&&K.push(dn)})}else At&&this._toplevel?(K=[],this._toplevel.traverse(kn=>{kn instanceof L.eaF&&(0,Z.xq)(kn.stack,At)&&K.push(kn)})):K=K?[K]:[];if(K.length||(K=null),K&&(K[0].geo_object?this.ctrl.highlight_scene||(K=null):this.ctrl.highlight||(K=null)),!Vt){K&&(ye||(ye=K[0].geo_object),At||(At=K[0].stack));const kn=this._highlight_handlers||(this._main_painter?this._main_painter._slave_painters.concat([this._main_painter]):this._slave_painters);for(let dn=0;dn<kn?.length;++dn)kn[dn]!==this&&kn[dn].highlightMesh(null,ge,ye,Pe,At,!0)}const Nt=this._selected_mesh;if(!Nt&&!K)return!1;const nn=kn=>kn.get_ctrl?kn.get_ctrl():new rt(kn,this.ctrl.highlight_bloom&&this._bloomComposer);let hn=!1;if(Nt&&K&&Nt.length===K.length){hn=!0;for(let kn=0;kn<Nt.length&&hn;++kn)(Nt[kn]!==K[kn]||nn(Nt[kn]).checkHighlightIndex(Pe))&&(hn=!1)}if(hn)return!!Nt;if(Nt)for(let kn=0;kn<Nt.length;++kn)nn(Nt[kn]).setHighlight();if(this._selected_mesh=K,K)for(let kn=0;kn<K.length;++kn)nn(K[kn]).setHighlight(ge||new L.Q1f(this.ctrl.highlight_color),Pe);return this.render3D(0),!!K}processMouseClick(K,ge,ye){if(!ge.length)return;const Pe=ge[0].object;if(!Pe.get_ctrl)return;const At=Pe.get_ctrl(),Vt=At.extractIndex(ge[0]);At.evnt=ye,At.setSelected("blue",Vt)&&this.render3D(),At.evnt=null}setMouseTmout(K){this.ctrl&&(this.ctrl.mouse_tmout=K),this._controls&&(this._controls.mouse_tmout=K)}setDepthMethod(K){this.ctrl&&(this.ctrl.depthMethod=K)}canRotateCamera(){return!(!1===this.ctrl.can_rotate||!this.ctrl.can_rotate&&(this.isOrthoCamera()||this.ctrl.project))}addOrbitControls(){this._controls||!this._webgl||this.isBatchMode()||this.superimpose||(this.getCanvPainter()||this.setTooltipAllowed(x.settings.Tooltip),this._controls=(0,g.Sc)(this,this._camera,this._scene,this._renderer,this._lookat),this._controls.mouse_tmout=this.ctrl.mouse_tmout,this.canRotateCamera()||(this._controls.enableRotate=!1),this._controls.contextMenu=this.orbitContext.bind(this),this._controls.processMouseMove=K=>{if(!this.ctrl||!this._controls)return;let Vt,Nt,nn,ge=null,ye=null,Pe=null,At=[];for(let kn=0;kn<K.length;++kn){const dn=K[kn].object,In=Fe(K[kn]);if(!dn||!dn.visible)continue;let ci=null;dn.geo_object?ci=dn.geo_name:In&&(ci=this.getStackFullName(In)),ci&&(0===ci.indexOf("<prnt>")&&(ci=this.getItemName()+ci.slice(6)),At.push(ci),ge||(ge=dn,ye=ci,Vt=dn.geo_object,dn.get_ctrl&&(Nt=dn.get_ctrl().extractIndex(K[kn]),void 0!==Nt&&(0,x.isStr)(ye)&&(ye+=" indx:"+JSON.stringify(Nt))),nn=In,nn&&(Pe=this.resolveStack(nn),dn.stacks&&(Nt=K[kn].instanceId))))}if(this.highlightMesh(ge,void 0,Vt,Nt),this.ctrl.update_browser&&(this.ctrl.highlight&&ye&&(At=[ye]),this.activateInBrowser(At)),!Pe?.obj)return ye;const hn=(0,Z.V)(Pe.obj);return hn.unshift(ye),{name:Pe.obj.fName,title:Pe.obj.fTitle||Pe.obj._typename,lines:hn}},this._controls.processMouseLeave=function(){this.processMouseMove([])},this._controls.processDblClick=()=>{!this.ctrl||!this._controls||(this._last_manifest?(this._last_manifest.wireframe=!this._last_manifest.wireframe,this._last_hidden&&this._last_hidden.forEach(K=>{K.visible=!0}),delete this._last_hidden,delete this._last_manifest):this.adjustCameraPosition(!0),this.render3D())})}nextDrawAction(){if(!this._clones||this.isStage(0))return!1;if(this.isStage(1)){if(this._geom_viewer)return this._draw_all_nodes=!1,this.changeStage(3),!0;if(this.ctrl.use_worker>0){if(!this._worker)return this.startWorker(),1;if(!this._worker_ready)return 1}let K=this._first_drawing?this._clones.countVisibles():0,ge=null,ye=null;K||(K=this._clones.markVisibles(!1,!1,!!this.geo_manager&&!this.ctrl.showtop)),this.ctrl.select_in_view&&!this._first_drawing&&(ge=(0,Z.d4)(this._camera),ye=(0,Z.P1)(ge),ye.CheckBox(this.getGeomBoundingBox())&&(ge=null,ye=null)),this._current_face_limit=this.ctrl.maxfaces,ge&&(this._current_face_limit*=1.25);let Pe=!this.isBatchMode()&&x.browser.isChrome&&(K>1e4||ge&&this._clones.scanVisible()>1e5);if(Pe&&0===x.source_dir.indexOf("file://")&&(console.log("disable worker for jsroot from file system"),Pe=!1),Pe&&!this._worker&&this.ctrl.use_worker>=0&&this.startWorker(),!Pe||!this._worker_ready){const Vt=this._clones.collectVisibles(this._current_face_limit,ye);return this._new_draw_nodes=Vt.lst,this._draw_all_nodes=Vt.complete,this.changeStage(3),!0}const At={collect:this._current_face_limit,flags:this._clones.getVisibleFlags(),matrix:ge?ge.elements:null,vislevel:this._clones.getVisLevel(),maxvisnodes:this._clones.getMaxVisNodes()};return this.submitToWorker(At),this.changeStage(2),2}if(this.isStage(2))return 2;if(this.isStage(3)){if(this._new_append_nodes)this._new_draw_nodes=this._draw_nodes.concat(this._new_append_nodes),delete this._new_append_nodes;else if(this._draw_nodes){let K;K=this._geom_viewer?this._draw_nodes:this._clones.mergeVisibles(this._new_draw_nodes,this._draw_nodes);for(let ge=0;ge<K.length;++ge)this._clones.createObject3D(K[ge].stack,this._toplevel,"delete_mesh");K.length>0&&(this.drawing_log=`Delete ${K.length} nodes`)}return this._draw_nodes=this._new_draw_nodes,delete this._new_draw_nodes,this.changeStage(4),!0}if(this.isStage(4)){const K=this._clones.collectShapes(this._draw_nodes);return this._build_shapes=this._clones.mergeShapesLists(this._build_shapes,K),this.changeStage(5),!0}if(this.isStage(5)){if(this.canSubmitToWorker()){const K={limit:this._current_face_limit,shapes:[]};let ge=0;for(let ye=0;ye<this._build_shapes.length;++ye){let Pe=null;const At=this._build_shapes[ye];At.ready||At.geom?Pe={id:At.id,ready:!0,nfaces:(0,Z.Wz)(At.geom),refcnt:At.refcnt}:(Pe=(0,x.clone)(At,null,!0),ge++),K.shapes.push(Pe)}if(ge>0)return this.submitToWorker(K),this.changeStage(6),2}this.changeStage(7)}if(this.isStage(6))return 2;if(this.isStage(7)||this.isStage(8)){if(this.isStage(7)){const At=this._clones.buildShapes(this._build_shapes,this._current_face_limit,500);if(!At.done)return this.ctrl.info.num_shapes=At.shapes,this.drawing_log=`Creating: ${At.shapes} / ${this._build_shapes.length} shapes,  ${At.faces} faces`,!0;this.ctrl.info.num_shapes=this._build_shapes.length,this.changeStage(8)}const K=(new Date).getTime(),ge=this.ctrl.project?this._full_geom:this._toplevel;let ye=!1,Pe=!0;if(this.ctrl.project||(ye=this._clones.createInstancedMeshes(this.ctrl,ge,this._draw_nodes,this._build_shapes,(0,v.HG)())),!ye)for(let At=0;At<this._draw_nodes.length;++At){const Vt=this._draw_nodes[At];if(!Vt.done&&(this.createEntryMesh(Vt,Vt.server_shape||this._build_shapes[Vt.shapeid],ge),(new Date).getTime()-K>500)){Pe=!1;break}}return Pe?this.ctrl.project?(this.changeStage(10),!0):(this.changeStage(0),!1):(this.isStage(7)||(this.drawing_log=`Building meshes ${this.ctrl.info.num_meshes} / ${this.ctrl.info.num_faces}`),!0)}if(this.isStage(9)){if(!this._main_painter)return this.changeStage(0,"Lost main painter"),!1;if(!this._main_painter._drawing_ready)return 1;this.changeStage(10)}return this.isStage(10)?(this.doProjection(),this.changeStage(0),!1):(console.error(`never come here, stage ${this.drawing_stage}`),!1)}createEntryMesh(K,ge,ye){return this._splitColors&&K.stack&&(0===K.stack[0]?K.custom_color="green":1===K.stack[0]&&(K.custom_color="blue")),this._clones.createEntryMesh(this.ctrl,ye,K,ge,(0,v.HG)()),!0}appendMoreNodes(K,ge){if(!this.isStage(0)&&!ge)return void(this._provided_more_nodes=K);if(this._more_nodes)for(let Pe=0;Pe<this._more_nodes.length;++Pe){const At=this._more_nodes[Pe],Vt=this._clones.createObject3D(At.stack,this._toplevel,"delete_mesh");(0,g.G1)(Vt),(0,Z.qU)(At.server_shape),delete At.server_shape}if(delete this._more_nodes,!K)return;const ye=[];for(let Pe=0;Pe<K.length;++Pe){const At=K[Pe],Vt=At.server_shape;Vt?.ready&&this.createEntryMesh(At,Vt,this._toplevel)&&ye.push(At)}ye.length>0&&(this._more_nodes=ye),ge||this.render3D()}getProjectionSource(){return this._clones_owner?this._full_geom:this._main_painter?this._main_painter._drawing_ready?this._main_painter._toplevel:(console.warn("MAIN PAINTER NOT READY WHEN DO PROJECTION"),null):(console.warn("MAIN PAINTER DISAPPER"),null)}extendCustomBoundingBox(K){if(!K)return;this._customBoundingBox||(this._customBoundingBox=(new L.NRn).makeEmpty());const ge=this._customBoundingBox.clone();this._customBoundingBox.union(K),this._customBoundingBox.equals(ge)||(this._adjust_camera_with_render=!0)}getGeomBoundingBox(K,ge){const ye=new L.NRn,Pe=!this._clones;return void 0===K&&(K=this._toplevel),ye.makeEmpty(),this._customBoundingBox&&K===this._toplevel?(ye.union(this._customBoundingBox),ye):K?(K.traverse(At=>{(Pe||At.stack&&At instanceof L.eaF||At.main_track&&At instanceof L.DXC||At.stacks&&At instanceof L.ZLX)&&(0,Z.UX)(At,ye)}),"original"===ge?(ye.translate(new L.Pq0(-K.position.x,-K.position.y,-K.position.z)),ye.min.multiply(new L.Pq0(1/K.scale.x,1/K.scale.y,1/K.scale.z)),ye.max.multiply(new L.Pq0(1/K.scale.x,1/K.scale.y,1/K.scale.z))):void 0!==ge&&ye.expandByVector(ye.getSize(new L.Pq0).multiplyScalar(ge)),ye):(ye.min.x=ye.min.y=ye.min.z=-1,ye.max.x=ye.max.y=ye.max.z=1,ye)}doProjection(){const K=this.getProjectionSource();if(!K)return!1;if((0,g.G1)(this._toplevel,!0),void 0===this.ctrl.projectPos){const ge=this.getGeomBoundingBox(K),ye=ge.min[this.ctrl.project],Pe=ge.max[this.ctrl.project];let At=(ye+Pe)/2;ye<0&&Pe>0&&Math.abs(At)<.2*Math.max(-ye,Pe)&&(At=0),this.ctrl.projectPos=At}return K.traverse(ge=>{if(!(ge instanceof L.eaF&&ge.stack))return;const ye=(0,Z.qr)(ge.geometry,ge.parent.absMatrix||ge.parent.matrixWorld,this.ctrl.project,this.ctrl.projectPos,ge._flippedMesh);if(!ye)return;const Pe=new L.eaF(ye,ge.material.clone());this._toplevel.add(Pe),Pe.stack=ge.stack}),!0}changedLight(K){if(!this._camera)return;const ge=!K;K||(K=this.getGeomBoundingBox());const ye=K.max.x-K.min.x,Pe=K.max.y-K.min.y,At=K.max.z-K.min.z,Vt=[],Nt=.5*(this.ctrl.light.power??1);if(this._camera._lights!==this.ctrl.light.kind)switch((0,g.G1)(this._camera,!0),this._camera._lights=this.ctrl.light.kind,this._camera._lights){case"ambient":this._camera.add(new L.$p8(15724527,Nt));break;case"hemisphere":this._camera.add(new L.dth(16777147,526368,Nt));break;case"mix":this._camera.add(new L.$p8(15724527,Nt));default:for(let nn=0;nn<6;++nn){const hn=new L.ZyN(15724527,Nt);this._camera.add(hn),hn._id=nn}}for(let nn=0;nn<this._camera.children.length;++nn){const hn=this._camera.children[nn];let kn=!1;if(hn.isAmbientLight||hn.isHemisphereLight)hn.intensity=Nt;else if(hn.isDirectionalLight){switch(hn._id){case 0:hn.position.set(ye/5,Pe/5,At/5),kn=this.ctrl.light.specular;break;case 1:hn.position.set(0,0,At/2),kn=this.ctrl.light.front;break;case 2:hn.position.set(0,2*Pe,0),kn=this.ctrl.light.top;break;case 3:hn.position.set(0,-2*Pe,0),kn=this.ctrl.light.bottom;break;case 4:hn.position.set(-2*ye,0,0),kn=this.ctrl.light.left;break;case 5:hn.position.set(2*ye,0,0),kn=this.ctrl.light.right}hn.power=kn?Nt*Math.PI*4:0,kn&&Vt.push(hn)}}Vt.forEach(nn=>{nn.power=4*Nt*Math.PI/Vt.length}),ge&&this.render3D()}isOrthoCamera(){return 0===this.ctrl.camera_kind.indexOf("ortho")}createCamera(){this._camera&&(this._scene.remove(this._camera),(0,g.G1)(this._camera),delete this._camera),this.isOrthoCamera()?this._camera=new L.qUd(-this._scene_width/2,this._scene_width/2,this._scene_height/2,-this._scene_height/2,1,1e4):(this._camera=new L.ubm(25,this._scene_width/this._scene_height,1,1e4),this._camera.up=this.ctrl._yup?new L.Pq0(0,1,0):new L.Pq0(0,0,1));const K=new L.ZyN(15724527,.1);K.position.set(10,10,10),this._camera.add(K),this._scene.add(this._camera)}createSpecialEffects(){this._webgl&&this.ctrl.outline&&(0,x.isFunc)(this.createOutline)&&(this._effectComposer=new L.s0G(this._renderer),this._effectComposer.addPass(new L.AHc(this._scene,this._camera)),this.createOutline(this._scene_width,this._scene_height)),this.ensureBloom()}createScene(K,ge,ye){var Pe=this;return(0,Ee.A)(function*(){if(Pe.superimpose){const At=Ge(Pe.getMainPainter());return At?.renderer&&(Pe._scene=At.scene,Pe._scene_width=At.scene_width,Pe._scene_height=At.scene_height,Pe._renderer=At.renderer,Pe._webgl=Pe._renderer.jsroot_render3d===x.constants.Render3D.WebGL,Pe._toplevel=new L.B69,Pe._scene.add(Pe._toplevel),(At.scale_x||At.scale_y||At.scale_z)&&Pe._toplevel.scale.set(At.scale_x,At.scale_y,At.scale_z),(At.offset_x||At.offset_y||At.offset_z)&&Pe._toplevel.position.set(At.offset_x,At.offset_y,At.offset_z),Pe._toplevel.updateMatrix(),Pe._toplevel.updateMatrixWorld(),Pe._camera=At.camera),Pe._renderer?.jsroot_dom}return Pe._scene=new L.Z58,Pe._fog=new L.jUj(16777215,1,1e4),Pe._scene.fog=Pe.ctrl.use_fog?Pe._fog:null,Pe._scene.overrideMaterial=new L.G_z({color:7340287,vertexColors:!1,transparent:!0,opacity:.2,depthTest:!1}),Pe._scene_width=K,Pe._scene_height=ge,Pe.createCamera(),Pe._selected_mesh=null,Pe._overall_size=10,Pe._toplevel=new L.B69,Pe._scene.add(Pe._toplevel),Pe._scene.background=new L.Q1f(Pe.ctrl.background),(0,g.Yw)(K,ge,ye,{antialias:!0,logarithmicDepthBuffer:!1,preserveDrawingBuffer:!0}).then(At=>{if(Pe._renderer=At,Pe.batch_format&&(At.jsroot_image_format=Pe.batch_format),Pe._webgl=Pe._renderer.jsroot_render3d===x.constants.Render3D.WebGL,Pe._renderer.setPixelRatio&&!(0,x.isNodeJs)()&&Pe._renderer.setPixelRatio(window.devicePixelRatio),Pe._renderer.setSize(K,ge,!Pe._fit_main_area),Pe._renderer.localClippingEnabled=!0,Pe._renderer.setClearColor(Pe._scene.background,1),Pe._fit_main_area&&Pe._webgl){Pe._renderer.domElement.style.width="100%",Pe._renderer.domElement.style.height="100%";const Vt=Pe.selectDom();"static"===Vt.style("position")&&Vt.style("position","relative")}if(Pe._animating=!1,Pe.ctrl.doubleside=!1,Pe.createSpecialEffects(),Pe._fit_main_area&&!Pe._webgl){const Nt=(0,x.getDocument)().createElementNS("http://www.w3.org/2000/svg","svg");return Nt.setAttribute("width",K),Nt.setAttribute("height",ge),Nt.appendChild(Pe._renderer.jsroot_dom),Nt}return Pe._renderer.jsroot_dom})})()}startDrawGeometry(K){K||this.isStage(0)?(this._clones_owner&&this._clones&&this._clones.setDefaultColors(this.ctrl.dflt_colors),this._startm=(new Date).getTime(),this._last_render_tm=this._startm,this._last_render_meshes=0,this.changeStage(1),this._drawing_ready=!1,this.ctrl.info.num_meshes=0,this.ctrl.info.num_faces=0,this.ctrl.info.num_shapes=0,this._selected_mesh=null,this.ctrl.project&&(this._clones_owner?this._full_geom?this.changeStage(10):this._full_geom=new L.B69:this.changeStage(9)),delete this._last_manifest,delete this._last_hidden,delete this._draw_nodes_again,this.continueDraw()):this._draw_nodes_again=!0}resetAdvanced(){this.ctrl.depthTest=!0,this.ctrl.clipIntersect=!0,this.ctrl.depthMethod="ray",this.changedDepthMethod("norender"),this.changedDepthTest()}getOverallSize(K){if(!this._overall_size||K||this._customBoundingBox){const ge=this.getGeomBoundingBox();if(!Number.isFinite(ge.min.x))return 1e3;this._overall_size=2*Math.max(ge.max.x-ge.min.x,ge.max.y-ge.min.y,ge.max.z-ge.min.z)}return this._overall_size}createSnapshot(K){if(!this._renderer)return;this.render3D(0);const ge=this._renderer.domElement.toDataURL("image/png");if("asis"===K)return ge;ge.replace("image/png","image/octet-stream");const ye=(0,x.getDocument)(),Pe=ye.createElement("a");(0,x.isStr)(Pe.download)&&(ye.body.appendChild(Pe),Pe.download=K||"geometry.png",Pe.href=ge,Pe.click(),ye.body.removeChild(Pe))}produceCameraUrl(K){if(!this._camera)return"";if(this._camera.isOrthographicCamera){const kn=Math.round(100*this._camera.zoom);return this.ctrl.camera_kind+(100===kn?"":`,zoom=${kn}`)}let ge="";if("perspective"!==this.ctrl.camera_kind&&(ge=this.ctrl.camera_kind+","),!0===K){const kn=this._camera?.position,dn=this._controls?.target;if(!kn||!dn)return"";const In=Pi=>{let Si="";return Pi<0&&(Si="n",Pi=-Pi),Si+Pi.toFixed(0)};let ci=`${ge}camx${In(kn.x)},camy${In(kn.y)},camz${In(kn.z)}`;return(dn.x||dn.y||dn.z)&&(ci+=`,camlx${In(dn.x)},camly${In(dn.y)},camlz${In(dn.z)}`),ci}if(!this._lookat||!this._camera0pos)return"";const ye=(new L.Pq0).add(this._camera0pos).sub(this._lookat),Pe=(new L.Pq0).add(this._camera.position).sub(this._lookat),At=Math.min(1e4,Math.max(1,this.ctrl.zoom*Pe.length()/ye.length()*100));ye.normalize(),Pe.normalize();const Vt=new L.PTz,Nt=new L.O9p;Vt.setFromUnitVectors(ye,Pe),Nt.setFromQuaternion(Vt,"YZX");let nn=Nt.y/Math.PI*180,hn=Nt.z/Math.PI*180;return nn<0&&(nn+=360),hn<0&&(hn+=360),`${ge}roty${nn.toFixed(0)},rotz${hn.toFixed(0)},zoom${At.toFixed(0)}`}calculateZoom(){if(this._camera0pos&&this._camera&&this._lookat){const K=(new L.Pq0).add(this._camera0pos).sub(this._lookat);return(new L.Pq0).add(this._camera.position).sub(this._lookat).length()/K.length()}return 0}adjustCameraPosition(K,ge){if(!this._toplevel||this.superimpose)return;const ye=!0===K,Pe="first"===K||ye,At="only_set"===K,Vt=this.getGeomBoundingBox();if(!Number.isFinite(Vt.min.x))return void console.log("FAILS to get geometry bounding box");const Nt=Vt.max.x-Vt.min.x,nn=Vt.max.y-Vt.min.y,hn=Vt.max.z-Vt.min.z,kn=(Vt.max.x+Vt.min.x)/2,dn=(Vt.max.y+Vt.min.y)/2,In=(Vt.max.z+Vt.min.z)/2,ci=this.ctrl._axis||"bar"===this.ctrl.camera_overlay?.2:.1;if(this._scene_size&&!ye){const Jn=this._scene_size,Wi=(Rs,oe,D)=>(D||(D=Math.abs((Rs+oe)/2)),D<=1e-20||Math.abs(oe-Rs)/D>.01);if(!(Wi(Nt,Jn.sizex)||Wi(nn,Jn.sizey)||Wi(hn,Jn.sizez)||Wi(kn,Jn.midx,Jn.sizex)||Wi(dn,Jn.midy,Jn.sizey)||Wi(In,Jn.midz,Jn.sizez)))return void(this.ctrl.select_in_view&&this.startDrawGeometry())}if(this._scene_size={sizex:Nt,sizey:nn,sizez:hn,midx:kn,midy:dn,midz:In},this._overall_size=2*Math.max(Nt,nn,hn),this._camera.near=this._overall_size/350,this._camera.far=100*this._overall_size,this._fog.near=.5*this._overall_size,this._fog.far=5*this._overall_size,Pe)for(let Jn=0;Jn<3;++Jn){const Wi=this.ctrl.clip[Jn];Wi.min=Vt.min[Wi.name],Wi.max=Vt.max[Wi.name];const Ln=Wi.max-Wi.min;Wi.max+=.01*Ln,Wi.min-=.01*Ln,Wi.step=Ln>100?.1:Ln>1?.001:void 0,Wi.value?Wi.value<Wi.min?Wi.value=Wi.min:Wi.value>Wi.max&&(Wi.value=Wi.max):Wi.value=(Wi.min+Wi.max)/2}let Pi=2*this.ctrl.zoom;const Si=Math.max(Nt,nn,hn),bi=this.ctrl.camera_kind.indexOf("N")>0?-1:1;if(this._lookat=new L.Pq0(kn,dn,In),this._camera0pos=new L.Pq0(-2*Si,0,0),this._camera.updateMatrixWorld(),this._camera.updateProjectionMatrix(),(this.ctrl.rotatey||this.ctrl.rotatez)&&this.ctrl.can_rotate){const Jn=this.calculateZoom();ge&&Jn&&(Pi=2*Jn);const Wi=new L.O9p(0,this.ctrl.rotatey/180*Math.PI,this.ctrl.rotatez/180*Math.PI,"YZX");this._camera.position.set(-Pi*Si,0,0),this._camera.position.applyEuler(Wi),this._camera.position.add(new L.Pq0(kn,dn,In)),ge&&Jn&&(Pi*=Jn/this.calculateZoom(),this._camera.position.set(-Pi*Si,0,0),this._camera.position.applyEuler(Wi),this._camera.position.add(new L.Pq0(kn,dn,In)))}else if(void 0!==this.ctrl.camx&&void 0!==this.ctrl.camy&&void 0!==this.ctrl.camz)this._camera.position.set(this.ctrl.camx,this.ctrl.camy,this.ctrl.camz),this._lookat.set(this.ctrl.camlx||0,this.ctrl.camly||0,this.ctrl.camlz||0),this.ctrl.camx=this.ctrl.camy=this.ctrl.camz=this.ctrl.camlx=this.ctrl.camly=this.ctrl.camlz=void 0;else if("orthoXOY"===this.ctrl.camera_kind||"orthoXNOY"===this.ctrl.camera_kind)this._camera.up.set(0,1,0),this._camera.position.set(bi<0?2*kn:0,0,In+bi*hn*2),this._lookat.set(bi<0?2*kn:0,0,In),this._camera.left=Vt.min.x-ci*Nt,this._camera.right=Vt.max.x+ci*Nt,this._camera.top=Vt.max.y+ci*nn,this._camera.bottom=Vt.min.y-ci*nn,ge||(this._camera.zoom=this.ctrl.zoom||1),this._camera.orthoSign=bi,this._camera.orthoZ=[In,hn/2];else if("orthoXOZ"===this.ctrl.camera_kind||"orthoXNOZ"===this.ctrl.camera_kind)this._camera.up.set(0,0,1),this._camera.position.set(bi<0?2*kn:0,dn-bi*nn*2,0),this._lookat.set(bi<0?2*kn:0,dn,0),this._camera.left=Vt.min.x-ci*Nt,this._camera.right=Vt.max.x+ci*Nt,this._camera.top=Vt.max.z+ci*hn,this._camera.bottom=Vt.min.z-ci*hn,ge||(this._camera.zoom=this.ctrl.zoom||1),this._camera.orthoIndicies=[0,2,1],this._camera.orthoRotation=Jn=>Jn.rotateX(Math.PI/2),this._camera.orthoSign=bi,this._camera.orthoZ=[dn,-nn/2];else if("orthoZOY"===this.ctrl.camera_kind||"orthoZNOY"===this.ctrl.camera_kind)this._camera.up.set(0,1,0),this._camera.position.set(kn-bi*Nt*2,0,bi<0?2*In:0),this._lookat.set(kn,0,bi<0?2*In:0),this._camera.left=Vt.min.z-ci*hn,this._camera.right=Vt.max.z+ci*hn,this._camera.top=Vt.max.y+ci*nn,this._camera.bottom=Vt.min.y-ci*nn,ge||(this._camera.zoom=this.ctrl.zoom||1),this._camera.orthoIndicies=[2,1,0],this._camera.orthoRotation=Jn=>Jn.rotateY(-Math.PI/2),this._camera.orthoSign=bi,this._camera.orthoZ=[kn,-Nt/2];else if("orthoZOX"===this.ctrl.camera_kind||"orthoZNOX"===this.ctrl.camera_kind)this._camera.up.set(1,0,0),this._camera.position.set(0,dn-bi*nn*2,bi>0?2*In:0),this._lookat.set(0,dn,bi>0?2*In:0),this._camera.left=Vt.min.z-ci*hn,this._camera.right=Vt.max.z+ci*hn,this._camera.top=Vt.max.x+ci*Nt,this._camera.bottom=Vt.min.x-ci*Nt,ge||(this._camera.zoom=this.ctrl.zoom||1),this._camera.orthoIndicies=[2,0,1],this._camera.orthoRotation=Jn=>Jn.rotateX(Math.PI/2).rotateY(Math.PI/2),this._camera.orthoSign=bi,this._camera.orthoZ=[dn,-nn/2];else if(this.ctrl.project)switch(this.ctrl.project){case"x":this._camera.position.set(1.5*Pi*Math.max(nn,hn),0,0);break;case"y":this._camera.position.set(0,1.5*Pi*Math.max(Nt,hn),0);break;case"z":this._camera.position.set(0,0,1.5*Pi*Math.max(Nt,nn))}else"perspXOZ"===this.ctrl.camera_kind?(this._camera.up.set(0,1,0),this._camera.position.set(kn-3*Si,dn,In)):"perspYOZ"===this.ctrl.camera_kind?(this._camera.up.set(1,0,0),this._camera.position.set(kn,dn-3*Si,In)):"perspXOY"===this.ctrl.camera_kind?(this._camera.up.set(0,0,1),this._camera.position.set(kn-3*Si,dn,In)):this.ctrl._yup?(this._camera.up.set(0,1,0),this._camera.position.set(kn-Pi*Math.max(Nt,hn),dn+Pi*nn,In-Pi*Math.max(Nt,hn))):(this._camera.up.set(0,0,1),this._camera.position.set(kn-Pi*Math.max(Nt,nn),dn-Pi*Math.max(Nt,nn),In+Pi*hn));if(this._camera.isOrthographicCamera&&this.isOrthoCamera()&&this._scene_width&&this._scene_height){const Jn=this._scene_width/this._scene_height,Wi=this._camera.right-this._camera.left,Ln=this._camera.top-this._camera.bottom;if(Jn>Wi/Ln){const Rs=(this._camera.right+this._camera.left)/2;this._camera.left=Rs-Ln*Jn/2,this._camera.right=Rs+Ln*Jn/2}else{const Rs=(this._camera.top+this._camera.bottom)/2;this._camera.top=Rs+Wi/Jn/2,this._camera.bottom=Rs-Wi/Jn/2}}this._camera.lookAt(this._lookat),this._camera.updateProjectionMatrix(),this.changedLight(Vt),this._controls&&(this._controls.target.copy(this._lookat),At||this._controls.update()),this.ctrl.select_in_view&&!At&&this.startDrawGeometry()}setCameraPosition(K,ge,ye){if(!this.ctrl)return;this.ctrl.rotatey=K||0,this.ctrl.rotatez=ge||0;let Pe=!1;ye&&Number.isFinite(ye)?this.ctrl.zoom=ye:Pe=!0,this.adjustCameraPosition(!1,Pe)}setCameraPositionAndLook(K,ge,ye,Pe,At,Vt){this.ctrl&&(this.ctrl.camx=K,this.ctrl.camy=ge,this.ctrl.camz=ye,this.ctrl.camlx=Pe,this.ctrl.camly=At,this.ctrl.camlz=Vt,this.adjustCameraPosition(!1))}focusOnItem(K){if(!K||!this._clones)return;const ge=this._clones.findStackByName(K);ge&&this.focusCamera(this._clones.resolveStack(ge,!0),!1)}focusCamera(K,ge){if(this.ctrl.project||this.isOrthoCamera())return this.adjustCameraPosition(!0),this.render3D();let ye=new L.NRn;if(void 0===K)ye=this.getGeomBoundingBox();else if(K instanceof L.eaF)ye.setFromObject(K);else{const Wi=(new L.Pq0).setFromMatrixPosition(K.matrix),Ln=K.node,Rs=new L.Pq0(Ln.fDX,Ln.fDY,Ln.fDZ).multiplyScalar(.5);ye.min=Wi.clone().sub(Rs),ye.max=Wi.clone().add(Rs)}const Pe=ye.max.x-ye.min.x,At=ye.max.y-ye.min.y,Vt=ye.max.z-ye.min.z,Nt=(ye.max.x+ye.min.x)/2,nn=(ye.max.y+ye.min.y)/2,hn=(ye.max.z+ye.min.z)/2;let kn,dn=50,In=0;kn=this.ctrl._yup?new L.Pq0(Nt-2*Math.max(Pe,Vt),nn+2*At,hn-2*Math.max(Pe,Vt)):new L.Pq0(Nt-2*Math.max(Pe,At),nn-2*Math.max(Pe,At),hn+2*Vt);const ci=new L.Pq0(Nt,nn,hn),Pi=this._controls.target,Si=kn.sub(this._camera.position).divideScalar(dn),bi=ci.sub(Pi).divideScalar(dn);if(ge=ge&&this._webgl){for(let Wi=0;Wi<3;++Wi){const Ln=this.ctrl.clip[Wi];Ln.enabled||(Ln.value=Ln.min,Ln.enabled=!0),Ln.inc=((Ln.min+Ln.max)/2-Ln.value)/dn}this.updateClipping()}this._animating=!0;const Jn=()=>{if(void 0===this._animating)return;this._animating?requestAnimationFrame(Jn):this._geom_viewer||this.startDrawGeometry();const Wi=1-Math.cos(2*Math.PI*In/dn);this._camera.position.add(Si.clone().multiplyScalar(Wi)),Pi.add(bi.clone().multiplyScalar(Wi)),this._lookat=Pi,this._camera.lookAt(this._lookat),this._camera.updateProjectionMatrix();const Ln=(new Date).getTime();if(ge){for(let oe=0;oe<3;++oe)this.ctrl.clip[oe].value+=this.ctrl.clip[oe].inc*Wi;this.updateClipping()}else this.render3D(0);const Rs=(new Date).getTime();0===In&&Rs-Ln>200&&(dn=20),In++,this._animating=In<dn};Jn()}autorotate(K){const ge=void 0===K?2:K;let ye=new Date;const Pe=()=>{if(!this._renderer||!this.ctrl)return;const At=new Date;this.ctrl.rotate&&requestAnimationFrame(Pe),this._controls&&(this._controls.autoRotate=this.ctrl.rotate,this._controls.autoRotateSpeed=ge*(At.getTime()-ye.getTime())/16.6666,this._controls.update()),ye=new Date,this.render3D(0)};this._webgl&&Pe()}completeScene(){}drawCount(K,ge){var ye=this;return(0,Ee.A)(function*(){const Pe=In=>(ye.isBatchMode()?"anytime":In.toString())+" ms",At=["Unique nodes: "+ye._clones.nodes.length,"Unique visible: "+K,"Time to clone: "+Pe(ge)];ye._clones.scanVisible();let Vt=0;const Nt={clones:ye._clones,cnt:[],func(In){return void 0===this.cnt[this.last]?this.cnt[this.last]=1:this.cnt[this.last]++,Vt+=(0,Z._b)(this.clones.getNodeShape(In.id)),!0}};let nn=(new Date).getTime(),hn=ye._clones.scanVisible(Nt),kn=(new Date).getTime();At.push(`Total visible nodes: ${hn}`,`Total shapes: ${Vt}`);for(let In=0;In<Nt.cnt.length;++In)void 0!==Nt.cnt[In]&&At.push(`  lvl${In}: ${Nt.cnt[In]}`);At.push(`Time to scan: ${Pe(kn-nn)}`,"","Check timing for matrix calculations ...");const dn=ye.selectDom().style("overflow","auto");return ye.isBatchMode()?dn.property("_json_object_",At):At.forEach(In=>dn.append("p").text(In)),(0,x.postponePromise)(()=>{Nt.domatrix=!0,nn=(new Date).getTime(),hn=ye._clones.scanVisible(Nt),kn=(new Date).getTime();const In=`Time to scan with matrix: ${Pe(kn-nn)}`;return ye.isBatchMode()?At.push(In):dn.append("p").text(In),ye},100)})()}performDrop(K,ge,ye,Pe){var At=this;return(0,Ee.A)(function*(){if("TTree"===K?.$kind){let Vt="extract_geo_tracks";Pe&&Pe.indexOf("$")>0&&(Vt=Pe.slice(0,Pe.indexOf("$")),Pe=Pe.slice(Pe.indexOf("$")+1));const Nt=(0,x.findFunction)(Vt);return Nt?Nt(K,Pe).then(nn=>nn?At.drawExtras(nn,"",!1).then(()=>(At.updateClipping(!0),At.render3D(100))):At):Promise.reject(Error(`Function ${Vt} not found`))}return At.drawExtras(K,ge).then(Vt=>Vt?(ye&&(ye._painter=At),At.render3D(100)):At)})()}mouseOverHierarchy(K,ge,ye){if(!this.ctrl)return;const Pe=ye._obj;!Pe||Pe._typename!==z&&Pe._typename!==W&&Pe._typename!==x.clTPolyMarker3D||this.highlightMesh(null,65280,K?Pe:null)}clearExtras(){this.getExtrasContainer("delete"),delete this._extraObjects,this.render3D()}addExtra(K,ge){return void 0===this._extraObjects&&(this._extraObjects=(0,x.create)(x.clTList)),!(this._extraObjects.arr.indexOf(K)>=0||(this._extraObjects.Add(K,ge),delete K.$hidden_via_menu,0))}extraObjectVisible(K,ge,ye){if(!this._extraObjects)return;const Pe=K.itemFullName(ge);let At=this._extraObjects.opt.indexOf(Pe);if(At<0&&ge._obj&&(At=this._extraObjects.arr.indexOf(ge._obj),At>=0&&(this._extraObjects.opt[At]=Pe)),At<0)return;const Vt=this._extraObjects.arr[At];let Nt=!!Vt.$hidden_via_menu;if(ye){Vt.$hidden_via_menu=Nt,Nt=!Nt;let nn=null;this._toplevel.traverse(hn=>{hn.geo_object===Vt&&(nn=hn)}),nn?(nn.visible=Nt,this.render3D()):Nt&&this.drawExtras(Vt,"",!1).then(()=>{this.updateClipping(!0),this.render3D()})}return Nt}drawExtras(K,ge,ye,Pe){var At=this;return(0,Ee.A)(function*(){if(!K?._typename||!ye&&K.$hidden_via_menu)return!1;let Vt=!1;void 0===ye?(ye=!0,Vt=!0):Pe&&(Vt=!0);let Nt=!1;if(K._typename===x.clTList||K._typename===x.clTObjArray){if(!K.arr)return!1;const nn=[];for(let hn=0;hn<K.arr.length;++hn){let dn=K.opt?K.opt[hn]:"";dn||(dn=(ge||"<prnt>")+`/[${hn}]`),nn.push(At.drawExtras(K.arr[hn],dn,ye))}Nt=Promise.all(nn).then(hn=>hn.indexOf(!0)>=0)}else"Mesh"===K._typename?(At.addToExtrasContainer(K),Nt=Promise.resolve(!0)):"TGeoTrack"===K._typename?(!ye||At.addExtra(K,ge))&&(Nt=At.drawGeoTrack(K,ge)):K._typename===x.clTPolyLine3D?(!ye||At.addExtra(K,ge))&&(Nt=At.drawPolyLine(K,ge)):K._typename===z||K._typename===`${x.nsREX}REveTrack`?(!ye||At.addExtra(K,ge))&&(Nt=At.drawEveTrack(K,ge)):K._typename===W||K._typename===`${x.nsREX}REvePointSet`||K._typename===x.clTPolyMarker3D?(!ye||At.addExtra(K,ge))&&(Nt=At.drawHit(K,ge)):(K._typename===b||K._typename===fe)&&(!ye||At.addExtra(K,ge))&&(Nt=At.drawExtraShape(K,ge));return(0,x.getPromise)(Nt).then(nn=>{if(!nn||!Vt)return nn;At.updateClipping(!0);const hn=At.render3D(100,!!Pe&&"nopromise");return Pe?At:hn})})()}getExtrasContainer(K,ge){if(!this._toplevel)return null;ge||(ge="tracks");let ye=null;const Pe=[];for(let At=0;At<this._toplevel.children.length;++At){const Vt=this._toplevel.children[At];if(Vt._extras){if("collect"===K){Pe.push(Vt);continue}if(Vt._extras===ge){ye=Vt;break}}}if("collect"===K){for(let At=0;At<Pe.length;++At)this._toplevel.remove(Pe[At]);return Pe}return"delete"===K?(ye&&this._toplevel.remove(ye),(0,g.G1)(ye),null):("get"!==K&&!ye&&(ye=new L.B69,ye._extras=ge,this._toplevel.add(ye)),ye)}addToExtrasContainer(K,ge){const ye=this.getExtrasContainer("",ge);ye?ye.add(K):(console.warn("Fail to add object to extras"),(0,g.G1)(K))}drawGeoTrack(K,ge){if(!K?.fNpoints)return!1;const ye=x.browser.isWin?1:K.fLineWidth||1,Pe=(0,v.oU)(K.fLineColor)||"#ff00ff",At=Math.round(K.fNpoints/4),Vt=new Float32Array(6*(At-1)),Nt=this.ctrl.projectPos,nn="x"===this.ctrl.project,hn="y"===this.ctrl.project,kn="z"===this.ctrl.project;for(let ci=0,Pi=0;ci<At-1;++ci,Pi+=6)Vt[Pi]=nn?Nt:K.fPoints[4*ci],Vt[Pi+1]=hn?Nt:K.fPoints[4*ci+1],Vt[Pi+2]=kn?Nt:K.fPoints[4*ci+2],Vt[Pi+3]=nn?Nt:K.fPoints[4*ci+4],Vt[Pi+4]=hn?Nt:K.fPoints[4*ci+5],Vt[Pi+5]=kn?Nt:K.fPoints[4*ci+6];const dn=new L.mrM({color:Pe,linewidth:ye}),In=(0,g.Fc)(Vt,dn);return In.defaultOrder=In.renderOrder=1e6,In.geo_name=ge,In.geo_object=K,In.hightlightWidthScale=2,0===ge?.indexOf("<prnt>/Tracks")&&(In.main_track=!0),this.addToExtrasContainer(In),!0}drawPolyLine(K,ge){if(!K)return!1;const ye=x.browser.isWin?1:K.fLineWidth||1,Pe=(0,v.oU)(K.fLineColor)||"#ff00ff",At=K.fN,Vt=K.fP,Nt=new Float32Array(6*(At-1)),nn=this.ctrl.projectPos,hn="x"===this.ctrl.project,kn="y"===this.ctrl.project,dn="z"===this.ctrl.project;for(let Pi=0,Si=0;Pi<At-1;++Pi,Si+=6)Nt[Si]=hn?nn:Vt[3*Pi],Nt[Si+1]=kn?nn:Vt[3*Pi+1],Nt[Si+2]=dn?nn:Vt[3*Pi+2],Nt[Si+3]=hn?nn:Vt[3*Pi+3],Nt[Si+4]=kn?nn:Vt[3*Pi+4],Nt[Si+5]=dn?nn:Vt[3*Pi+5];const In=new L.mrM({color:Pe,linewidth:ye}),ci=(0,g.Fc)(Nt,In);return ci.defaultOrder=ci.renderOrder=1e6,ci.geo_name=ge,ci.geo_object=K,ci.hightlightWidthScale=2,this.addToExtrasContainer(ci),!0}drawEveTrack(K,ge){if(!K||K.fN<=0)return!1;const ye=x.browser.isWin?1:K.fLineWidth||1,Pe=(0,v.oU)(K.fLineColor)||"#ff00ff",At=new Float32Array(6*(K.fN-1)),Vt=this.ctrl.projectPos,Nt="x"===this.ctrl.project,nn="y"===this.ctrl.project,hn="z"===this.ctrl.project;for(let In=0,ci=0;In<K.fN-1;++In,ci+=6)At[ci]=Nt?Vt:K.fP[3*In],At[ci+1]=nn?Vt:K.fP[3*In+1],At[ci+2]=hn?Vt:K.fP[3*In+2],At[ci+3]=Nt?Vt:K.fP[3*In+3],At[ci+4]=nn?Vt:K.fP[3*In+4],At[ci+5]=hn?Vt:K.fP[3*In+5];const kn=new L.mrM({color:Pe,linewidth:ye}),dn=(0,g.Fc)(At,kn);return dn.defaultOrder=dn.renderOrder=1e6,dn.geo_name=ge,dn.geo_object=K,dn.hightlightWidthScale=2,this.addToExtrasContainer(dn),!0}drawHit(K,ge){var ye=this;return(0,Ee.A)(function*(){if(!K||!K.fN||K.fN<0)return!1;const Pe=K.fN,At=ye.ctrl.projectPos,Vt="x"===ye.ctrl.project,Nt="y"===ye.ctrl.project,nn="z"===ye.ctrl.project,hn=Math.max(K.fMarkerSize*ye.getOverallSize()*(ye._dummy?.015:.005),.2),kn=new g._l(Pe,ye._webgl,hn);for(let dn=0;dn<Pe;dn++)kn.addPoint(Vt?At:K.fP[3*dn],Nt?At:K.fP[3*dn+1],nn?At:K.fP[3*dn+2]);return kn.createPoints({color:(0,v.oU)(K.fMarkerColor)||"#0000ff",style:K.fMarkerStyle}).then(dn=>(dn.defaultOrder=dn.renderOrder=1e6,dn.highlightScale=2,dn.geo_name=ge,dn.geo_object=K,ye.addToExtrasContainer(dn),!0))})()}drawExtraShape(K,ge){const ye=yo(K);return!!ye&&(ye.geo_name=ge,ye.geo_object=K,this.addToExtrasContainer(ye),!0)}findNodeWithVolume(K,ge,ye,Pe,At){let Vt=!1,Nt=null;if(ye)Pe&&(Pe+="/"),Pe+=ye.fName;else{if(!(ye=this.getGeometry())&&0!==(0,Z.Dh)(ye))return null;Pe=this.geo_manager?ye.fName:"",Vt=!0,At=[]}if(!ye.fVolume||ye.fVolume._searched)return null;if(K.test(ye.fVolume.fName)&&(Nt=ge({node:ye,item:Pe}),Nt))return Nt;if(ye.fVolume._searched=!0,At.push(ye.fVolume),ye.fVolume.fNodes)for(let nn=0,hn=ye.fVolume.fNodes.arr.length;nn<hn&&(Nt=this.findNodeWithVolume(K,ge,ye.fVolume.fNodes.arr[nn],Pe,At),!Nt);++nn);if(Vt)for(let nn=0,hn=At.length;nn<hn;++nn)delete At[nn]._searched;return Nt}loadMacro(K){var ge=this;return(0,Ee.A)(function*(){const ye={obj:ge.getGeometry(),prefix:""};if(ge.geo_manager&&(ye.prefix=ye.obj.fName),!K||K.length<3||0!==(0,Z.Dh)(ye.obj))return ye;const Pe={GetVolume:At=>{const Vt=new RegExp("^"+At+"$"),Nt=ge.findNodeWithVolume(Vt,nn=>nn);return Nt||console.log(`Did not found ${At} volume`),{found:Nt,fVolume:Nt?.node?.fVolume,InvisibleAll(nn){(0,Z.N_)(this.fVolume,nn)},Draw(){!this.found||!this.fVolume||(ye.obj=this.found.node,ye.prefix=this.found.item,console.log(`Select volume for drawing ${this.fVolume.fName} ${ye.prefix}`))},SetTransparency(nn){this.fVolume?.fMedium?.fMaterial&&(this.fVolume.fMedium.fMaterial.fFillStyle=3e3+nn)},SetLineColor(nn){this.fVolume&&(this.fVolume.fLineColor=nn)}}},DefaultColors:()=>{ge.ctrl.dflt_colors=!0},SetMaxVisNodes:At=>{ge.ctrl.maxnodes||(ge.ctrl.maxnodes=parseInt(At)||0)},SetVisLevel:At=>{ge.ctrl.vislevel||(ge.ctrl.vislevel=parseInt(At)||0)}};return(0,ve.Rh)(`Loading macro ${K}`),(0,x.httpRequest)(K,"text").then(At=>{const Vt=At.split("\n");let Nt=0;for(;Nt<Vt.length;){let nn=Vt[Nt++].trim();if(!(0===nn.indexOf("//")||nn.indexOf("gGeoManager")<0||(nn=nn.replace("->GetVolume",".GetVolume"),nn=nn.replace("->InvisibleAll",".InvisibleAll"),nn=nn.replace("->SetMaxVisNodes",".SetMaxVisNodes"),nn=nn.replace("->DefaultColors",".DefaultColors"),nn=nn.replace("->Draw",".Draw"),nn=nn.replace("->SetTransparency",".SetTransparency"),nn=nn.replace("->SetLineColor",".SetLineColor"),nn=nn.replace("->SetVisLevel",".SetVisLevel"),nn.indexOf("->")>=0)))try{new Function("gGeoManager",nn)(Pe)}catch{console.error(`Problem by processing ${nn}`)}}return ye}).catch(()=>(console.error(`Fail to load ${K}`),ye))})()}assignClones(K){this._clones_owner=!0,this._clones=K}extractRawShapes(K,ge){let ye=null,Pe=0;ge&&(ye=K.numnodes>1e6?{length:K.numnodes}:new Array(K.numnodes)),K.nodes.forEach(Vt=>{Vt=Z.De.formatServerElement(Vt),ye?ye[Vt.id]=Vt:this._clones.updateNode(Vt)}),ge&&(this._clones_owner=!0,this._clones=new Z.De(null,ye),this._clones.name_prefix=this._clones.getNodeName(0),this._clones.setConfig(this.ctrl),this._clones.maxdepth=20);let At=0;K.cfg&&(At=K.cfg.nsegm),At&&(Pe=(0,Z.QL)("GradPerSegm"),(0,Z.QL)("GradPerSegm",360/Math.max(At,6)));for(let Vt=0;Vt<K.visibles.length;++Vt){const Nt=K.visibles[Vt],nn=Nt.ri;nn&&(Nt.server_shape=nn.server_shape=(0,Z.uz)(nn,At))}return Pe&&(0,Z.QL)("GradPerSegm",Pe),!0}prepareObjectDraw(K,ge){var ye=this;return(0,Ee.A)(function*(){if(ye.did_cleanup)return null;if("__geom_viewer_append__"===ge)ye._new_append_nodes=K,ye.ctrl.use_worker=0,ye._geom_viewer=!0;else if("__geom_viewer_selection__"===ge&&ye._clones)ye._new_draw_nodes=K,ye.ctrl.use_worker=0,ye._geom_viewer=!0;else if(ye._main_painter)ye._clones_owner=!1,ye._clones=ye._main_painter._clones,console.log(`Reuse clones ${ye._clones.nodes.length} from main painter`);else if(K){ye._start_drawing_time=(new Date).getTime(),ye._clones_owner=!0,ye._clones=new Z.De(K);let At=ye.ctrl.vislevel,Vt=ye.ctrl.maxnodes;ye.geo_manager&&(!At&&ye.geo_manager.fVisLevel&&(At=ye.geo_manager.fVisLevel),Vt||(Vt=ye.geo_manager.fMaxVisNodes)),ye._clones.setVisLevel(At),ye._clones.setMaxVisNodes(Vt,ye.ctrl.more),ye._clones.setConfig(ye.ctrl),ye._clones.name_prefix=ge;const Nt=!!ye.geo_manager&&!ye.ctrl.showtop;let nn=ye.ctrl.no_screen?0:ye._clones.markVisibles(!0,!1,Nt);nn=nn<=0?ye._clones.markVisibles(!1,!1,Nt):ye._clones.markVisibles(!0,!0,Nt),ye._clones.produceIdShifts();const hn=(new Date).getTime()-ye._start_drawing_time;if(ye._scene||console.log(`Creating clones ${ye._clones.nodes.length} takes ${hn} ms uniquevis ${nn}`),ye.ctrl._count)return ye.drawCount(nn,hn)}else ye._clones_owner=!1,ye._clones=null;let Pe=Promise.resolve(!0);if(!ye._scene){ye._first_drawing=!0;const At=ye.getPadPainter();if(ye._on_pad=!!At,ye._on_pad){let Vt,Nt,nn;Pe=(0,k.ensureTCanvas)(ye,"3d").then(()=>(At.fillatt?.color&&(ye.ctrl.background=At.fillatt.color),nn=ye.getFramePainter(),ye.batch_mode=At.isBatchMode(),Nt=(0,g.ke)(void 0,ye.batch_mode),(0,g.LR)(nn),nn.mode3d=!0,Vt=nn.getSizeFor3d(void 0,Nt),ye._fit_main_area=-1===Vt.can3d,ye.createScene(Vt.width,Vt.height,Nt).then(hn=>nn.add3dCanvas(Vt,hn,Nt===x.constants.Render3D.WebGL))))}else{const Vt=ye.selectDom("origin");ye.batch_mode=(0,x.isBatchMode)()||!Vt.empty()&&Vt.property("_batch_mode"),ye.batch_format=Vt.property("_batch_format");const Nt=(0,g.ke)(ye.options.Render3D,ye.batch_mode);ye.ctrl.use_worker>0&&!ye.batch_mode&&ye.startWorker(),(0,g.LR)(ye);const nn=ye.getSizeFor3d(void 0,Nt);ye._fit_main_area=-1===nn.can3d,Pe=ye.createScene(nn.width,nn.height,Nt).then(hn=>ye.add3dCanvas(nn,hn,ye._webgl))}}return Pe.then(()=>(ye._first_drawing&&!ye.ctrl.maxfaces&&(ye.ctrl.maxfaces=2e5*ye.ctrl.more),ye.setAsMainPainter(),ye.createToolbar(),ye._clones?new Promise(At=>{ye._resolveFunc=At,ye.showDrawInfo("Drawing geometry"),ye.startDrawGeometry(!0)}):ye.completeDraw()))})()}showDrawInfo(K){if(this.isBatchMode()||!this._first_drawing||!this._start_drawing_time)return;const ge=this._renderer.domElement.parentNode;if(!ge)return;let ye=ge.querySelector(".geo_info");if(K){const Pe=.001*((new Date).getTime()-this._start_drawing_time);ye||(ye=(0,x.getDocument)().createElement("p"),ye.setAttribute("class","geo_info"),ye.setAttribute("style","position: absolute; text-align: center; vertical-align: middle; top: 45%; left: 40%; color: red; font-size: 150%;"),ge.append(ye)),ye.innerHTML=`${K}, ${Pe.toFixed(1)}s`}else ye?.remove()}continueDraw(){if(this.isStage(0))return;const K=(new Date).getTime(),ge=this._first_drawing?1e3:200;let ye=K;for(;;){const At=this.nextDrawAction();if(!At)break;if(ye=(new Date).getTime(),ye-this._startm>1e5){this.changeStage(0,"Abort build after 100s");break}if(!(!0===At&&ye-K<ge)&&(ye-K>ge||1===At||2===At))return(0,ve.Rh)(this.drawing_log),this.showDrawInfo(this.drawing_log),this._first_drawing&&this._webgl&&this._num_meshes-this._last_render_meshes>100&&ye-this._last_render_tm>2.5*ge&&(this.adjustCameraPosition(),this.render3D(-1),this._last_render_meshes=this.ctrl.info.num_meshes),void(2!==At&&setTimeout(()=>this.continueDraw(),1===At?100:1))}const Pe=ye-this._startm;if((this._first_drawing||this._full_redrawing)&&console.log(`Create tm = ${Pe} meshes ${this.ctrl.info.num_meshes} faces ${this.ctrl.info.num_faces}`),Pe>300)return(0,ve.Rh)("Rendering geometry"),this.showDrawInfo("Rendering"),setTimeout(()=>this.completeDraw(!0),10);this.completeDraw(!0)}testCameraPosition(K){this._camera.updateMatrixWorld(),this.drawOverlay();const ge=this._camera.position.clone();if(!(!K&&this._last_camera_position&&this._last_camera_position.distanceTo(ge)<1e-4*(this._overall_size||1e3))){if(this._last_camera_position=ge,this.ctrl._axis){const ye=(this._controls?.target||this._lookat).clone().sub(this._camera.position).normalize();this.getExtrasContainer("get","axis")?.traverse(Pe=>{(0,x.isFunc)(Pe._axis_flip)&&Pe._axis_flip(ye)})}this.ctrl.project||(0,Z.Pz)(this._toplevel,ge,this.ctrl.depthMethod,this._clones)}}render3D(K,ge){if(!this._renderer)return this.did_cleanup?console.warn("try to render after cleanup"):console.warn("renderer object not exists - check code"),this;const ye=void 0!==K&&K>0&&"nopromise"!==ge;if(void 0===K&&(K=5),K>0&&this._webgl)return this.isBatchMode()&&(K=1),ye?new Promise(Vt=>{this._render_resolveFuncs||(this._render_resolveFuncs=[]),this._render_resolveFuncs.push(Vt),this.render_tmout||(this.render_tmout=setTimeout(()=>this.render3D(0),K))}):(this.render_tmout||(this.render_tmout=setTimeout(()=>this.render3D(0),K)),this);this.render_tmout&&(clearTimeout(this.render_tmout),delete this.render_tmout),(0,g.rv)(this._renderer);const Pe=new Date;this._adjust_camera_with_render&&(this.adjustCameraPosition("only_set"),delete this._adjust_camera_with_render),this.testCameraPosition(-1===K),this._webgl&&this._effectComposer&&this._effectComposer.passes.length>0?this._effectComposer.render():this._webgl&&this._bloomComposer&&this._bloomComposer.passes.length>0?(this._renderer.clear(),this._camera.layers.set(1),this._bloomComposer.render(),this._renderer.clearDepth(),this._camera.layers.set(0),this._renderer.render(this._scene,this._camera)):this._renderer.render(this._scene,this._camera);const At=new Date;if(this.last_render_tm=At.getTime(),0===this.first_render_tm&&!0===ge&&(this.first_render_tm=At.getTime()-Pe.getTime(),this.first_render_tm>500&&console.log(`three.js r${L.sPf}, first render tm = ${this.first_render_tm}`)),(0,g.oE)(this._renderer),this._render_resolveFuncs){const Vt=this._render_resolveFuncs;delete this._render_resolveFuncs,Vt.forEach(Nt=>Nt(this))}}startWorker(){this._worker||(this._worker_ready=!1,this._worker_jobs=0,this._worker=new Worker(x.source_dir+"scripts/geoworker.js"),this._worker.onmessage=K=>{if((0,x.isObject)(K.data)){if("log"in K.data)return console.log(`geo: ${K.data.log}`);if("progress"in K.data)return(0,ve.Rh)(K.data.progress);K.data.tm3=(new Date).getTime(),"init"in K.data?(this._worker_ready=!0,console.log("Worker ready: "+(K.data.tm3-K.data.tm0))):this.processWorkerReply(K.data)}},this._worker.postMessage({init:!0,browser:x.browser,tm0:(new Date).getTime(),vislevel:this._clones.getVisLevel(),maxvisnodes:this._clones.getMaxVisNodes(),clones:this._clones.nodes,sortmap:this._clones.sortmap}))}canSubmitToWorker(K){return!!this._worker&&this._worker_ready&&(0===this._worker_jobs||K)}submitToWorker(K){if(!this._worker)return!1;this._worker_jobs++,K.tm0=(new Date).getTime(),this._worker.postMessage(K)}processWorkerReply(K){if(this._worker_jobs--,"collect"in K)return this._new_draw_nodes=K.new_nodes,this._draw_all_nodes=K.complete,this.changeStage(3),this.continueDraw();if("shapes"in K){for(let ge=0;ge<K.shapes.length;++ge){const ye=K.shapes[ge],Pe=this._build_shapes[ge];ye.buf_pos&&ye.buf_norm&&(0===ye.buf_pos.length?Pe.geom=null:ye.buf_pos.length!==ye.buf_norm.length?(console.error(`item.buf_pos.length ${ye.buf_pos.length} !== item.buf_norm.length ${ye.buf_norm.length}`),Pe.geom=null):(Pe.geom=new L.LoY,Pe.geom.setAttribute("position",new L.THS(ye.buf_pos,3)),Pe.geom.setAttribute("normal",new L.THS(ye.buf_norm,3))),Pe.ready=!0,Pe.nfaces=ye.nfaces)}return K.tm4=(new Date).getTime(),this.changeStage(7),this.continueDraw()}}testGeomChanges(){if(this._main_painter)return console.warn("Get testGeomChanges call for slave painter"),this._main_painter.testGeomChanges();this.startDrawGeometry();for(let K=0;K<this._slave_painters.length;++K)this._slave_painters[K].startDrawGeometry()}drawAxesAndOverlay(K){const ge=this.drawAxes(),ye=this.drawOverlay();return ge||ye?this.changedDepthMethod(K?"norender":void 0):K?null:this.render3D()}drawOverlay(){if(this.getExtrasContainer("delete","overlay"),!this.isOrthoCamera()||"none"===this.ctrl.camera_overlay)return!1;const K=.5/this._camera.zoom,ge=(this._camera.left+this._camera.right)/2,ye=(this._camera.bottom+this._camera.top)/2,Pe=ge-(this._camera.right-this._camera.left)*K,At=ge+(this._camera.right-this._camera.left)*K,Vt=ye-(this._camera.top-this._camera.bottom)*K,Nt=ye+(this._camera.top-this._camera.bottom)*K,nn=.02*(Nt-Vt),hn=.015*(Nt-Vt),kn=.001*(Nt-Vt),dn=Pe+5*hn,In=At-5*hn,ci=Vt+3*hn,Pi=Nt-3*hn,Si=new U.TB(null,(0,x.create)(x.clTAxis));Si.configureAxis("xaxis",dn,In,dn,In,!1,[dn,In],{log:0,reverse:!1});const bi=new U.TB(null,(0,x.create)(x.clTAxis));bi.configureAxis("yaxis",ci,Pi,ci,Pi,!1,[ci,Pi],{log:0,reverse:!1});const Jn=this._camera.orthoIndicies??[0,1,2];let Wi,Ln,Rs=0,oe=0;this._camera.orthoZ&&(oe=Rs=this._camera.orthoZ[0]);const D=(Oe,$e,et)=>{Wi[Ln+Jn[0]]=Oe,Wi[Ln+Jn[1]]=$e,Wi[Ln+Jn[2]]=et??oe,Ln+=3},O=(Oe,$e)=>{const et=new L._l5(Oe,{font:g.Te,size:$e,height:0,curveSegments:5});return et.computeBoundingBox(),et._width=et.boundingBox.max.x-et.boundingBox.min.x,et._height=et.boundingBox.max.y-et.boundingBox.min.y,et.translate(-et._width/2,-et._height/2,0),this._camera.orthoSign<0&&et.rotateY(Math.PI),(0,x.isFunc)(this._camera.orthoRotation)&&this._camera.orthoRotation(et),et},ie=(Oe,$e,et,it,yt)=>{const sn=[0,0,0];sn[Jn[0]]=et,sn[Jn[1]]=it,sn[Jn[2]]=yt??oe;const tn=new L.eaF(Oe,$e);return tn.translateX(sn[0]).translateY(sn[1]).translateZ(sn[2]),tn};if("bar"===this.ctrl.camera_overlay){const Oe=this.getExtrasContainer("create","overlay");let $e=.15*Pe+.85*At,et=.05*Pe+.95*At;const it=.9*Nt+.1*Vt,yt=.86*Nt+.14*Vt,sn=Si.createTicks();sn.major?.length>1&&($e=sn.major[sn.major.length-2],et=sn.major[sn.major.length-1]),Wi=new Float32Array(18),Ln=0,D($e,it,Rs),D($e,yt,Rs),D($e,(it+yt)/2,Rs),D(et,(it+yt)/2,Rs),D(et,it,Rs),D(et,yt,Rs);const tn=new L.mrM({color:"green"}),xn=new L.V9B({color:"green",vertexColors:!1});Oe.add((0,g.Fc)(Wi,tn));const wn=O(Si.format(et-$e,!0),Math.abs(yt-it));return Oe.add(ie(wn,xn,(et+$e)/2,(it+yt)/2+.8*wn._height,Rs)),!0}const _e=0===this.ctrl.camera_overlay.indexOf("grid");if(_e&&this._camera.orthoZ&&("gridf"===this.ctrl.camera_overlay?oe+=this._camera.orthoSign*this._camera.orthoZ[1]:"gridb"===this.ctrl.camera_overlay&&(oe-=this._camera.orthoSign*this._camera.orthoZ[1])),"axis"===this.ctrl.camera_overlay||_e){const Oe=this.getExtrasContainer("create","overlay"),$e=new L.mrM({color:new L.Q1f("black")}),et=_e?new L.mrM({color:new L.Q1f(12303291)}):null,it=_e?new L.Fvt({color:new L.Q1f(14540253),dashSize:kn,gapSize:kn}):null,yt=new L.V9B({color:"black",vertexColors:!1}),sn=Si.createTicks();for(;sn.next();){const xn=sn.tick,wn=1===sn.kind?1:.6;if(_e&&(Wi=new Float32Array(6),Ln=0,D(xn,Nt-wn*nn-kn),D(xn,Vt+wn*nn+kn),Oe.add((0,g.Fc)(Wi,1===sn.kind?et:it))),Wi=new Float32Array(12),Ln=0,D(xn,Nt),D(xn,Nt-wn*nn),D(xn,Vt),D(xn,Vt+wn*nn),Oe.add((0,g.Fc)(Wi,$e)),1!==sn.kind)continue;const Ut=O(Si.format(xn,!0),hn);Oe.add(ie(Ut,yt,xn,Nt-nn-hn/2-Ut._height/2)),Oe.add(ie(Ut,yt,xn,Vt+nn+hn/2+Ut._height/2))}const tn=bi.createTicks();for(;tn.next();){const xn=tn.tick,wn=1===tn.kind?1:.6;if(_e&&(Wi=new Float32Array(6),Ln=0,D(Pe+wn*nn+kn,xn),D(At-wn*nn-kn,xn),Oe.add((0,g.Fc)(Wi,1===tn.kind?et:it))),Wi=new Float32Array(12),Ln=0,D(Pe,xn),D(Pe+wn*nn,xn),D(At,xn),D(At-wn*nn,xn),Oe.add((0,g.Fc)(Wi,$e)),1!==tn.kind)continue;const Ut=O(bi.format(xn,!0),hn);Oe.add(ie(Ut,yt,Pe+nn+hn/2+Ut._width/2,xn)),Oe.add(ie(Ut,yt,At-nn-hn/2-Ut._width/2,xn))}return!0}return!1}drawAxes(){if(this.getExtrasContainer("delete","axis"),!this.ctrl._axis)return!1;const K=this.getGeomBoundingBox(this._toplevel,this.superimpose?"original":void 0),ge=this.getExtrasContainer("create","axis"),ye=.02*Math.max(K.max.x-K.min.x,K.max.y-K.min.y,K.max.z-K.min.z),Pe=[0,0,0],At=["x","y","z"],Vt=["X","Y","Z"],Nt=["red","green","blue"],nn=this.isOrthoCamera(),hn=this.ctrl.camera_kind??"perspective";if(2===this.ctrl._axis)for(let kn=0;kn<3;++kn){const dn=At[kn];K.min[dn]<=0&&K.max[dn]>=0||(Pe[kn]=(K.min[dn]+K.max[dn])/2)}for(let kn=0;kn<3;++kn){let Rs=function(O,ie){O._other_side=!1,O._axis_norm=ie??new L.Pq0(1,0,0),O._axis_flip=function(_e){const Oe=_e.dot(this._axis_norm)<0;this._other_side!==Oe&&(this._other_side=Oe,this.rotateY(Math.PI))}},oe=function(O,ie=-1){O._last_angle=ie,O._axis_flip=function(_e){let Oe=0;switch(this._axis_name){case"x":Oe=-Math.atan2(_e.y,_e.z);break;case"y":Oe=-Math.atan2(_e.z,_e.x);break;default:Oe=Math.atan2(_e.y,_e.x)}Oe=Math.round(Oe/Math.PI*2+2)%4,this._last_angle!==Oe&&(this.rotateX((Oe-this._last_angle)*Math.PI/2),this._last_angle=Oe)}};if(nn&&hn.indexOf(Vt[kn])<0)continue;const dn=new Float32Array(6),In=Nt[kn],ci=At[kn],Pi=O=>{if(!O)return"0";const ie=Math.log10(Math.abs(O));if(ie<0){if(ie>-1)return O.toFixed(2);if(ie>-2)return O.toFixed(3)}else{if(ie<2)return O.toFixed(1);if(ie<4)return O.toFixed(0)}return O.toExponential(2)},Si=Pi(K.max[ci])+" "+Vt[kn];switch(dn[0]=K.min.x,dn[1]=K.min.y,dn[2]=K.min.z,dn[3]=K.min.x,dn[4]=K.min.y,dn[5]=K.min.z,kn){case 0:dn[3]=K.max.x;break;case 1:dn[4]=K.max.y;break;case 2:dn[5]=K.max.z}if(2===this.ctrl._axis)for(let O=0;O<6;++O)O%3!==kn&&(dn[O]=Pe[O%3]);const bi=new L.mrM({color:In});let Jn=(0,g.Fc)(dn,bi);Jn._no_clip=!0,ge.add(Jn);const Wi=new L.V9B({color:In,vertexColors:!1});if(0===Pe[kn]&&Pe[kn]>=K.min[ci]&&Pe[kn]<=K.max[ci]&&(2!==this.ctrl._axis||0===kn)){const O=nn?new L.tcD(.25*ye):new L.Gu$(.25*ye);Jn=new L.eaF(O,Wi),Jn.translateX(0===kn?Pe[0]:dn[0]),Jn.translateY(1===kn?Pe[1]:dn[1]),Jn.translateZ(2===kn?Pe[2]:dn[2]),Jn._no_clip=!0,ge.add(Jn)}let Ln=new L._l5(Si,{font:g.Te,size:ye,height:0,curveSegments:5});Jn=new L.eaF(Ln,Wi),Jn._no_clip=!0;let D=(new L.NRn).setFromObject(Jn);if(Ln.translate(.5*-D.max.x,-D.max.y/2,0),Jn.translateX(dn[3]),Jn.translateY(dn[4]),Jn.translateZ(dn[5]),Jn._axis_name=ci,0===kn)nn&&hn.indexOf("OX")>0?oe(Jn,0):(nn?hn.indexOf("OY")>0:this.ctrl._yup)?Rs(Jn,new L.Pq0(0,0,-1)):(Rs(Jn,new L.Pq0(0,1,0)),Jn.rotateX(Math.PI/2)),Jn.translateX(.5*ye+.5*D.max.x);else if(1===kn)(nn?hn.indexOf("OY")>0:this.ctrl._yup)?(oe(Jn,2),Jn.rotateX(-Math.PI/2),Jn.rotateY(-Math.PI/2),Jn.translateX(.5*ye+.5*D.max.x)):(Rs(Jn),Jn.rotateX(Math.PI/2),Jn.rotateY(-Math.PI/2),Jn.translateX(.5*-D.max.x-.5*ye));else if(2===kn){if(nn?hn.indexOf("OZ")<0:this.ctrl._yup){const O=nn&&(hn.indexOf("ZOX")>0||hn.indexOf("ZNOX")>0);Rs(Jn,O?new L.Pq0(0,-1,0):void 0),Jn.rotateY(-Math.PI/2),O&&Jn.rotateX(-Math.PI/2)}else oe(Jn),Jn.rotateX(Math.PI/2),Jn.rotateZ(Math.PI/2);Jn.translateX(.5*ye+.5*D.max.x)}if(ge.add(Jn),Ln=new L._l5(Pi(K.min[ci]),{font:g.Te,size:ye,height:0,curveSegments:5}),Jn=new L.eaF(Ln,Wi),Jn._no_clip=!0,D=(new L.NRn).setFromObject(Jn),Ln.translate(.5*-D.max.x,-D.max.y/2,0),Jn._axis_name=ci,Jn.translateX(dn[0]),Jn.translateY(dn[1]),Jn.translateZ(dn[2]),0===kn)nn&&hn.indexOf("OX")>0?oe(Jn,0):(nn?hn.indexOf("OY")>0:this.ctrl._yup)?Rs(Jn,new L.Pq0(0,0,-1)):(Rs(Jn,new L.Pq0(0,1,0)),Jn.rotateX(Math.PI/2)),Jn.translateX(.5*-ye-.5*D.max.x);else if(1===kn)(nn?hn.indexOf("OY")>0:this.ctrl._yup)?(oe(Jn,2),Jn.rotateX(-Math.PI/2),Jn.rotateY(-Math.PI/2),Jn.translateX(.5*-D.max.x-.5*ye)):(Rs(Jn),Jn.rotateX(Math.PI/2),Jn.rotateY(-Math.PI/2),Jn.translateX(.5*D.max.x+.5*ye));else if(2===kn){if(nn?hn.indexOf("OZ")<0:this.ctrl._yup){const O=nn&&(hn.indexOf("ZOX")>0||hn.indexOf("ZNOX")>0);Rs(Jn,O?new L.Pq0(0,-1,0):void 0),Jn.rotateY(-Math.PI/2),O&&Jn.rotateX(-Math.PI/2)}else oe(Jn),Jn.rotateX(Math.PI/2),Jn.rotateZ(Math.PI/2);Jn.translateX(.5*-D.max.x-.5*ye)}ge.add(Jn)}return!0}setAxesDraw(K){return this.ctrl._axis="toggle"===K?this.ctrl._axis?0:1:"number"==typeof K?K:K?1:0,this.drawAxesAndOverlay()}setAutoRotate(K){this.ctrl.project||(void 0!==K&&(this.ctrl.rotate=K),this.autorotate(2.5))}toggleWireFrame(){this.ctrl.wireframe=!this.ctrl.wireframe,this.changedWireFrame()}setWireFrame(K){this.ctrl.wireframe=!!K,this.changedWireFrame()}setShowTop(K){this.ctrl.showtop=!!K,this.redrawObject("same")}changedClipping(K=-1){(K<0||this.ctrl.clip[K]?.enabled)&&this.updateClipping(!1,!0)}changedDepthTest(){if(!this._toplevel)return;const K=this.ctrl.depthTest;this._toplevel.traverse(ge=>{ge instanceof L.eaF&&(ge.material.depthTest=K)}),this.render3D(0)}changedDepthMethod(K){if(delete this._last_camera_position,"norender"!==K)return this.render3D()}updateClipping(K,ge){if(this._renderer?.jsroot_render3d===x.constants.Render3D.SVG)return;this._clipPlanes||(this._clipPlanes=[new L.Zcv(new L.Pq0(1,0,0),0),new L.Zcv(new L.Pq0(0,this.ctrl._yup?-1:1,0),0),new L.Zcv(new L.Pq0(0,0,this.ctrl._yup?1:-1),0)]);const ye=this.ctrl.clip,Pe=[-1*ye[0].value,ye[1].value,(this.ctrl._yup?-1:1)*ye[2].value],At=this.getExtrasContainer(this.ctrl.clipVisualize?"":"delete","clipping");let Vt=[],Nt=!1,nn=this.ctrl.clipIntersect?16:0;for(let In=0;In<3;++In)if(ye[In].enabled&&(nn+=2<<In),this._clipPlanes[In].constant!==Pe[In]&&(ye[In].enabled&&(Nt=!0),this._clipPlanes[In].constant=Pe[In]),ye[In].enabled&&Vt.push(this._clipPlanes[In]),At&&ye[In].enabled){const ci=new L.ZM4(this._clipPlanes[In],ye[In].max-ye[In].min);ci._no_clip=!0,At.add(ci)}0===Vt.length&&(Vt=null),this._clipCfg!==nn&&(Nt=!0),this._clipCfg=nn;const hn=!!Vt,kn=this.ctrl.clipIntersect,dn=hn?L.$EB:L.hB5;return(ge||Nt)&&this._scene.traverse(In=>{!In._no_clip&&void 0!==In.material?.clippingPlanes&&(In.material.clippingPlanes!==Vt&&(In.material.clipIntersection=kn,In.material.clippingPlanes=Vt,In.material.needsUpdate=!0),void 0!==In.material.emissive&&In.material.side!==dn&&(In.material.side=dn,In.material.needsUpdate=!0))}),this.ctrl.doubleside=hn,K||this.render3D(0),Nt}setCompleteHandler(K){this._complete_handler=K}completeDraw(K){var ge=this;return(0,Ee.A)(function*(){let ye=!1,Pe=!1,At=!0;if(!ge.ctrl)return console.warn("ctrl object does not exist in completeDraw - something went wrong"),ge;let Vt=Promise.resolve(!0);return ge._clones?(ge._first_drawing||ge._full_redrawing)&&ge.ctrl.tracks&&ge.geo_manager&&(Vt=ge.drawExtras(ge.geo_manager.fTracks,"<prnt>/Tracks")):(At=!1,ge.getExtrasContainer("delete"),Vt=ge.drawExtras((ge._main_painter?ge._main_painter._extraObjects:null)||ge._extraObjects,"",!1)),Vt.then(()=>{if(ge._full_redrawing&&(ge.adjustCameraPosition("first"),ge._full_redrawing=!1,Pe=!0,ge.changedDepthMethod("norender")),ge._first_drawing&&(ge.adjustCameraPosition("first"),ge.showDrawInfo(),ge._first_drawing=!1,ye=!0,Pe=!0),ye&&ge.completeScene(),Pe&&(ge.ctrl.trans_radial||ge.ctrl.trans_z)&&ge.changedTransformation("norender"),Pe)return ge.drawAxesAndOverlay(!0)}).then(()=>{if(ge._scene.overrideMaterial=null,void 0!==ge._provided_more_nodes&&(ge.appendMoreNodes(ge._provided_more_nodes,!0),delete ge._provided_more_nodes),At)return ge.getExtrasContainer("delete"),ge.drawExtras(ge._main_painter?._extraObjects||ge._extraObjects,"",!1)}).then(()=>(ge.updateClipping(!0),ge.render3D(0,!0),K&&(0,ve.Rh)(),ge.addOrbitControls(),ye&&!ge.isBatchMode()&&(0===ge.ctrl.highlight&&(ge.ctrl.highlight=ge.first_render_tm<1e3),0===ge.ctrl.highlight_scene&&(ge.ctrl.highlight_scene=ge.ctrl.highlight),ge._webgl&&ge.ctrl.rotate&&!ge.ctrl.project&&ge.autorotate(2.5),ge._webgl&&ge.ctrl.show_controls&&ge.showControlGui(!0)),ge.setAsMainPainter(),(0,x.isFunc)(ge._resolveFunc)&&(ge._resolveFunc(ge),delete ge._resolveFunc),(0,x.isFunc)(ge._complete_handler)&&ge._complete_handler(ge),ge._draw_nodes_again?ge.startDrawGeometry():ge._drawing_ready=!0,ge))})()}isDrawingReady(){return this._drawing_ready||!1}removeDrawnNode(K){if(!this._draw_nodes)return;const ge=[];for(let ye=0;ye<this._draw_nodes.length;++ye){const Pe=this._draw_nodes[ye];Pe.nodeid===K||this._clones.isIdInStack(K,Pe.stack)?this._clones.createObject3D(Pe.stack,this._toplevel,"delete_mesh"):ge.push(Pe)}ge.length<this._draw_nodes.length&&(this._draw_nodes=ge,this.render3D())}cleanup(K){if(!K){let ge=0;if(!this.superimpose){if(this.clearTopPainter(),this._on_pad){const Pe=this.getFramePainter();Pe?.mode3d&&(Pe.clear3dCanvas(),Pe.mode3d=!1)}else ge=this.clear3dCanvas();(0,g.G1)(this._scene)}this._toolbar?.cleanup(),(0,g.G1)(this._full_geom),this._controls?.cleanup(),this._context_menu&&this._renderer.domElement.removeEventListener("contextmenu",this._context_menu,!1),this._gui?.destroy(),this._worker?.terminate(),delete this._animating;const ye=this.getGeometry();if(ye&&this.ctrl.is_main&&(ye.$geo_painter===this?delete ye.$geo_painter:ye.fVolume?.$geo_painter===this&&delete ye.fVolume.$geo_painter),this._main_painter?._slave_painters){const Pe=this._main_painter._slave_painters.indexOf(this);Pe>=0&&this._main_painter._slave_painters.splice(Pe,1)}for(let Pe=0;Pe<this._slave_painters?.length;++Pe){const At=this._slave_painters[Pe];At?._main_painter===this&&(At._main_painter=null)}delete this.geo_manager,delete this._highlight_handlers,super.cleanup(),delete this.ctrl,delete this.options,this.did_cleanup=!0,ge<0&&this.selectDom().html("")}if(this._slave_painters)for(const ge in this._slave_painters){const ye=this._slave_painters[ge];ye._main_painter=null,ye._clones===this._clones&&(ye._clones=null)}this._main_painter=null,this._slave_painters=[],this._render_resolveFuncs&&(this._render_resolveFuncs.forEach(ge=>ge(this)),delete this._render_resolveFuncs),this.superimpose||(0,g.yW)(this._renderer),this.ensureBloom(!1),delete this._effectComposer,delete this._scene,delete this._scene_size,this._scene_width=0,this._scene_height=0,this._renderer=null,this._toplevel=null,delete this._full_geom,delete this._fog,delete this._camera,delete this._camera0pos,delete this._lookat,delete this._selected_mesh,this._clones&&this._clones_owner&&this._clones.cleanup(this._draw_nodes,this._build_shapes),delete this._clones,delete this._clones_owner,delete this._draw_nodes,delete this._drawing_ready,delete this._build_shapes,delete this._new_draw_nodes,delete this._new_append_nodes,delete this._last_camera_position,this.first_render_tm=0,this.last_render_tm=0,this.changeStage(0,"cleanup"),delete this.drawing_log,delete this._gui,delete this._controls,delete this._context_menu,delete this._toolbar,delete this._worker}performResize(K,ge){return!(this._scene_width===K&&this._scene_height===ge||K<10||ge<10||(this._scene_width=K,this._scene_height=ge,this._camera&&this._renderer&&(this._camera.isPerspectiveCamera?this._camera.aspect=this._scene_width/this._scene_height:this._camera.isOrthographicCamera&&this.adjustCameraPosition(!0,!0),this._camera.updateProjectionMatrix(),this._renderer.setSize(this._scene_width,this._scene_height,!this._fit_main_area),this._effectComposer?.setSize(this._scene_width,this._scene_height),this._bloomComposer?.setSize(this._scene_width,this._scene_height),this.isStage(0)&&this.render3D()),0))}checkResize(K){const ge=this.getCanvPainter();if(ge&&!ge.checkCanvasResize(K))return!1;const ye=this.getSizeFor3d();return this.performResize(ye.width,ye.height)}toggleEnlarge(){this.enlargeMain("toggle")&&this.checkResize()}accessObjectWireFrame(K,ge){if(K?.material)return void 0!==ge&&K.stack&&(K.material.wireframe=ge),K.material.wireframe}changedWireFrame(){this._scene?.traverse(K=>this.accessObjectWireFrame(K,this.ctrl.wireframe)),this.render3D()}updateObject(K){if("same"===K||!K?._typename)return!1;if(K===this.getObject())return!0;let ge;return K._typename===G&&(ge=K,K=K.fMasterVolume),0===K._typename.indexOf(x.clTGeoVolume)&&(K={_typename:x.clTGeoNode,fVolume:K,fName:K.fName,$geoh:K.$geoh,_proxy:!0}),this.geo_manager&&ge?(this.geo_manager=ge,this.assignObject(K),this._did_update=!0,!0):!!this.matchObjectType(K._typename)&&(this.assignObject(K),this._did_update=!0,!0)}clearDrawings(){this._clones&&this._clones_owner&&this._clones.cleanup(this._draw_nodes,this._build_shapes),delete this._clones,delete this._clones_owner,delete this._draw_nodes,delete this._drawing_ready,delete this._build_shapes,delete this._extraObjects,delete this._clipCfg,(0,g.G1)(this._toplevel,!0),this._full_redrawing=!0}redraw(){if(this.superimpose){const ye=Ge(this.getMainPainter());ye&&(this._toplevel.scale.set(ye.scale_x??1,ye.scale_y??1,ye.scale_z??1),this._toplevel.position.set(ye.offset_x??0,ye.offset_y??0,ye.offset_z??0),this._toplevel.updateMatrix(),this._toplevel.updateMatrixWorld())}if(this._did_update)return this.startRedraw();const K=this._on_pad?this.getFramePainter():null;if(!K)return Promise.resolve(!1);const ge=K.getSizeFor3d(K.access3dKind());return K.apply3dSize(ge),this.performResize(ge.width,ge.height)}redrawObject(K,ge){return!!this.updateObject(K,ge)&&this.startRedraw()}startRedraw(K){if(K)return this._redraw_timer&&clearTimeout(this._redraw_timer),void(this._redraw_timer=setTimeout(()=>this.startRedraw(),K));delete this._redraw_timer,delete this._did_update,this.clearDrawings();const ge=this.getGeometry();return this.prepareObjectDraw(ge,this.geo_manager?ge.fName:"")}static draw(K,ge,ye){return(0,Ee.A)(function*(){if(!ge)return null;let Pe=null,At=null,Vt="",Nt=!1;if("fShapeBits"in ge&&"fShapeId"in ge?(Pe=ge,ge=null):ge._typename===T||ge._typename===x.clTGeoVolume?Pe=ge.fShape:ge._typename===b||ge._typename===fe?(Pe=ge.fShape,Nt=!0):ge._typename===G?Pe=ge.fMasterVolume.fShape:ge._typename===P?(At=ge.fMarker,Vt="<prnt>/Marker",ge=function we(xt){const K=(0,x.create)(x.clTGeoVolume);(0,Z.bg)(K,Z.Wv.kVisDaughters,!0),K.$geoh=!0,K.fName="";const ge=(0,x.create)(x.clTGeoNodeMatrix);ge.fName=xt.fVolume1.fName||"Overlap1",ge.fMatrix=xt.fMatrix1,ge.fVolume=xt.fVolume1;const ye=(0,x.create)(x.clTGeoNodeMatrix);return ye.fName=xt.fVolume2.fName||"Overlap2",ye.fMatrix=xt.fMatrix2,ye.fVolume=xt.fVolume2,K.fNodes=(0,x.create)(x.clTList),K.fNodes.Add(ge),K.fNodes.Add(ye),K}(ge),ye||(ye="wire")):"fVolume"in ge?ge.fVolume&&(Pe=ge.fVolume.fShape):ge=null,(0,x.isStr)(ye)&&0===ye.indexOf("comp")&&Pe&&Pe._typename===Z.HO&&Pe.fNode){let hn=1;"x"===(ye=ye.slice(4))[0]&&(hn=999,ye=ye.slice(1)+"_vislvl999"),ge=je(Pe,hn)}if(!ge&&Pe&&(ge=Object.assign((0,x.create)(x.clTNamed),{_typename:b,fTrans:null,fShape:Pe,fRGBA:[0,1,0,1],fElements:null,fRnrSelf:!0})),!ge)return null;const nn=Sn(K,ge,ye);return nn.ctrl.is_main&&!ge.$geo_painter&&(ge.$geo_painter=nn),!nn.ctrl.is_main&&nn.ctrl.project&&ge.$geo_painter&&(nn._main_painter=ge.$geo_painter,nn._main_painter._slave_painters.push(nn)),Nt&&(!nn.ctrl.vislevel||nn.ctrl.vislevel<9)&&(nn.ctrl.vislevel=9),At&&(nn._splitColors=!0,nn.addExtra(At,Vt)),nn.loadMacro(nn.ctrl.script_name).then(hn=>nn.prepareObjectDraw(hn.obj,hn.prefix))})()}}let Cn=!1;function yn(){function xt(K,ge){return`.jsroot .img_${K} { display: inline-block; height: 16px; width: 16px; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQ${ge}'); }`}!Cn&&(0,x.isFunc)(x.internals.addDrawFunc)&&(Cn=!0,x.internals.addDrawFunc({name:W,icon_get:Hi,icon_click:ai}),x.internals.addDrawFunc({name:z,icon_get:Hi,icon_click:ai})),(0,ve.fz)(`\n${xt("geoarb8","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAB1SURBVBjTdY6rEYAwEETTy6lzK8/Fo+Jj18dTAjUgaQGfGiggtRDE8RtY93Zu514If2nzk2ux9c5TZkwXbiWTUavzws69oBfpYBrMT4r0Jhsw+QfRgQSw+CaKRsKsnV+SaF8MN49RBSgPUxO85PMl5n4tfGUH2gghs2uPAeQAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTItMDJUMTQ6MjY6MjkrMDE6MDDARtd2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjE5KzAxOjAwO3ydwwAAAABJRU5ErkJggg==")}\n${xt("geocombi","CAQAAAC1+jfqAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAABIAAAASABGyWs+AAAAlUlEQVQoz5VQMQ4CMQyzEUNnBqT7Bo+4nZUH8gj+welWJsQDkHoCEYakTXMHSFiq2jqu4xRAEl2A7w4myWzpzCSZRZ658ldKu1hPnFsequBIc/hcLli3l52MAIANtpWrDsv8waGTW6BPuFtsdZArXyFuj33TQpazGEQF38phipnLgItxRcAoOeNpzv4PTXnC42fb//AGI5YqfQAU8dkAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTItMDJUMTQ6MjY6MjkrMDE6MDDARtd2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjE5KzAxOjAwO3ydwwAAAABJRU5ErkJggg==")}\n${xt("geocone","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACRSURBVBjTdY+xDcNACEVvEm/ggo6Olva37IB0C3iEzJABvAHFTXBDeJRwthMnUvylk44vPjxK+afeokX0flQhJO7L4pafSOMxzaxIKc/Tc7SIjNLyieyZSjBzc4DqMZI0HTMonWPBNlogOLeuewbg9c0hOiIqH7DKmTCuFykjHe4XOzQ58XVMGxzt575tKzd6AX9yMkcWyPlsAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${xt("geogtra","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACCSURBVBjTVc+hDQMxDAVQD1FyqCQk0MwsCwQEG3+eCW6B0FvheDboFMGepTlVitPP/Cz5y0S/mNkw8pySU9INJDDH4vM4Usm5OrQXasXtkA+tQF+zxfcDY8EVwgNeiwmA37TEccK5oLOwQtuCj7BM2Fq7iGrxVqJbSsH+GzXs+798AThwKMh3/6jDAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${xt("geomedium","BAMAAADt3eJSAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAABVQTFRFAAAAAAAAMDAww8PDWKj/////gICAG0/C4AAAAAF0Uk5TAEDm2GYAAAABYktHRAX4b+nHAAAACXBIWXMAAABIAAAASABGyWs+AAAAXElEQVQI102MwRGAMAgEuQ6IDwvQCjQdhAl/H7ED038JHhkd3dcOLAgESFARaAqnEB3yrj6QSEym1RbbOKinN+8q2Esui1GaX7VXSi4RUbxHRbER8X6O5Pg/fLgBBzMN8HfXD3AAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTItMDJUMTQ6MjY6MjkrMDE6MDDARtd2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjE5KzAxOjAwO3ydwwAAAABJRU5ErkJggg==")}\n${xt("geopara","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAABtSURBVBjTY2DADq5MT7+CzD9kaKjp+QhJYIWqublhMbKAgpOnZxWSQJdsVJTndCSBKoWoAM/VSALpqlEBAYeQBKJAAsi2BGgCBZDdEWUYFZCOLFBlGOWJ7AyGFeaotjIccopageK3R12PGHABACTYHWd0tGw6AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${xt("georotation","CAQAAAC1+jfqAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAABIAAAASABGyWs+AAAAiklEQVQoz2NgYGBgYGDg+A/BmIAFIvyDEbs0AwMTAwHACLPiB5QVBTdpGSOSCZjScDcgc4z+32BgYGBgEGIQw3QDLkdCTZD8/xJFeBfDVxQT/j9n/MeIrMCNIRBJwX8GRuzGM/yHKMAljeILNFOuMTyEisEUMKIqucrwB2oyIhyQpH8y/MZrLWkAAHFzIHIc0Q5yAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${xt("geotranslation","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAABESURBVBjTY2DgYGAAYzjgAAIQgSLAgSwAAcrWUUCAJBAVhSpgBAQumALGCJPAAsriHIS0IAQ4UAU4cGphQBWwZSAOAADGJBKdZk/rHQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMi0wMlQxNDoyNjoyOSswMTowMMBG13YAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MTkrMDE6MDA7fJ3DAAAAAElFTkSuQmCC")}\n${xt("geotrd2","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAABsSURBVBjTbY+xDcAwCARZx6UraiaAmpoRvIIb75PWI2QITxIiRQKk0CCO/xcA/NZ9LRs7RkJEYg3QxczUwoGsXiMAoe8lAelqRWFNKpiNXZLAalRDd0f3TMgeMckABKsCDmu+442RddeHz9cf9jUkW8smGn8AAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTItMDJUMTQ6MjY6MjkrMDE6MDDARtd2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjE5KzAxOjAwO3ydwwAAAABJRU5ErkJggg==")}\n${xt("geovolume","BAMAAADt3eJSAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAB5QTFRFAAAAMDAw///Ay8uc/7+Q/4BgmJh4gIDgAAD/////CZb2ugAAAAF0Uk5TAEDm2GYAAAABYktHRAnx2aXsAAAACXBIWXMAAABIAAAASABGyWs+AAAAR0lEQVQI12NggAEBIBAEQgYGQUYQAyIGIhgwAZMSGCgwMJuEKimFOhswsKWAGG4JDGxJIBk1EEO9o6NIDVkEpgauC24ODAAASQ8Pkj/retYAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTItMDJUMTQ6MjY6MjkrMDE6MDDARtd2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjE5KzAxOjAwO3ydwwAAAABJRU5ErkJggg==")}\n${xt("geoassembly","BAMAAADt3eJSAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAA9QTFRFAAAAMDAw/wAAAAD/////jEo0BQAAAAF0Uk5TAEDm2GYAAAABYktHRASPaNlRAAAACXBIWXMAAABIAAAASABGyWs+AAAAOklEQVQI12NggAFGRgEgEBRgEBSAMhgYGQQEgAR+oARGDIwCIAYjUL0A2DQQg9nY2ABVBKoGrgsDAADxzgNboMz8zQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMi0wMlQxNDoyNjoyOSswMTowMMBG13YAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MTkrMDE6MDA7fJ3DAAAAAElFTkSuQmCC")}\n${xt("geocomposite","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAABuSURBVBjTY2AgF2hqgQCCr+0V4O7hFmgCF7CJyKysKkmxhfGNLaw9SppqAi2gfMuY5Agrl+ZaC6iAUXRJZX6Ic0klTMA5urapPFY5NRcmYKFqWl8S5RobBRNg0PbNT3a1dDGH8RlM3LysTRjIBwAG6xrzJt11BAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMi0wMlQxNDoyNjoyOSswMTowMMBG13YAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MTkrMDE6MDA7fJ3DAAAAAElFTkSuQmCC")}\n${xt("geoctub","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACESURBVBjTdc+xDcMwDARA7cKKHTuWX37LHaw+vQbQAJomA7j2DB7FhCMFCZB8pxPwJEv5kQcZW+3HencRBekak4aaMQIi8YJdAQ1CMeE0UBkuaLMETklQ9Alhka0JzzXWqLVBuQYPpWcVuBbZjZafNRYcDk9o/b07bvhINz+/zxu1/M0FSRcmAk/HaIcAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTItMDJUMTQ6MjY6MjkrMDE6MDDARtd2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjE5KzAxOjAwO3ydwwAAAABJRU5ErkJggg==")}\n${xt("geohype","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACKSURBVBjTbU+rFQQhDKQSDDISEYuMREfHx6eHKMpYuf5qoIQt5bgDblfcuJk3nySEhSvceDV3c/ejT66lspopE9pXyIlkCrHMBACpu1DClekQAREi/loviCnF/NhRwJLaQ6hVhPjB8bOCsjlnNnNl0FWJVWxAqGzHONRHpu5Ml+nQ+8GzNW9n+Is3eg80Nk0iiwoAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTItMDJUMTQ6MjY6MjkrMDE6MDDARtd2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjE5KzAxOjAwO3ydwwAAAABJRU5ErkJggg==")}\n${xt("geomixture","BAMAAADt3eJSAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAACFQTFRFAAAAAAAAKysrVVUA//8B//8AgICAqqpV398gv79A////VYJtlwAAAAF0Uk5TAEDm2GYAAAABYktHRApo0PRWAAAACXBIWXMAAABIAAAASABGyWs+AAAAXklEQVQI12NgwASCQsJCgoZAhoADq1tKIJAhEpDGxpYIZKgxsLElgBhibAkOCY4gKTaGkPRGIEPUIYEBrEaAIY0tDawmgYWNgREkkjCVjRWkWCUhLY0FJCIIBljsBgCZTAykgaRiRwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMi0wMlQxNDoyNjoyOSswMTowMMBG13YAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MTkrMDE6MDA7fJ3DAAAAAElFTkSuQmCC")}\n${xt("geopcon","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACJSURBVBjTdc+hGcQwCIZhhjl/rkgWiECj8XgGyAbZoD5LdIRMkEnKkV575n75Pp8AgLU54dmh6mauelyAL2Qzxfe2sklioq6FacFAcRFXYhwJHdU5rDD2hEYB/CmoJVRMiIJqgtENuoqA8ltAlYAqRH4d1tGkwzTqN2gA7Nv+fUwkgZ/3mg34txM+szzATJS1HQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMi0wMlQxNDoyNjoyOSswMTowMMBG13YAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MTkrMDE6MDA7fJ3DAAAAAElFTkSuQmCC")}\n${xt("geosphere","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACFSURBVBjTdY+xEcQwCAQp5QNFjpQ5vZACFBFTADFFfKYCXINzlUAJruXll2ekxDAEt9zcANFbXb2mqm56dxsymAH0yccAJaeNi0h5QGyfxGJmivMPjj0nmLsbRmyFCss3rlbpcUjfS8wLUNRcJyCF6uqg2IvYCnoKC7f1kSbA6riTz7evfwj3Ml+H3KBqAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${xt("geotrap","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAB5SURBVBjTbY+hFYAwDETZB1OJi4yNPp0JqjtAZ2AELL5DdABmIS2PtLxHXH7u7l2W5W+uHMHpGiCHLYR1yw4SCZMIXBOJWVSjK7QDDAu4g8OBmAKK4sAEDdR3rw8YmcUcrEijKKhl7lN1IQPn9ExlgU6/WEyc75+5AYK0KY5oHBDfAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${xt("geotubeseg","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACBSURBVBjTdc+hEcQwDARA12P6QFBQ9LDwcXEVkA7SQTr4BlJBakgpsWdsh/wfux3NSCrlV86Mlrxmz1pBWq3bAHwETohxABVmDZADQp1BE+wDNnGywzHgmHDOreJNTDH3Xn3CVX0dpu2MHcIFBkYp/gKsQ8SCQ72V+36/+2aWf3kAQfgshnpXF0wAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTItMDJUMTQ6MjY6MjkrMDE6MDDARtd2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjE5KzAxOjAwO3ydwwAAAABJRU5ErkJggg==")}\n${xt("geoxtru","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAABcSURBVBjTY2AgEmhpeZV56vmWwQW00QUYwAJlSAI6XmVqukh8PT1bT03PchhXX09Pr9wQIQDiJ+ZowgWAXD3bck+QQDlCQTkDQgCoxA/ERBKwhbDglgA1lDMQDwCc/Rvq8nYsWgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMi0wMlQxNDoyNjoyOSswMTowMMBG13YAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MTkrMDE6MDA7fJ3DAAAAAElFTkSuQmCC")}\n${xt("geobbox","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAB/SURBVBjTVc+hEYAwDAXQLlNRF1tVGxn9NRswQiSSCdgDyQBM0FlIIb2WuL77uf6E8E0N02wKYRwDciTKREVvB04GuZSyOMCABRB1WGzF3uDNQTvs/RcDtJXT4fSEXA5XoiQt0ttVSm8Co2psIOvoimjAOqBmFtH5wEP2373TPIvTK1nrpULXAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${xt("geoconeseg","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAB4SURBVBjTdc6hEcAgDAXQbFNZXHQkFlkd/30myAIMwAws0gmYpVzvoFyv/S5P/B+izzQ387ZA2pkDnvsU1SQLVIFrOM4JFmEaYp2gCQbmPEGODhJ8jt7Am47hwgrzInGAifa/elUZnQLY00iU30BZAV+BWi2VfnIBv1osbHH8jX0AAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTItMDJUMTQ6MjY6MjkrMDE6MDDARtd2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjE5KzAxOjAwO3ydwwAAAABJRU5ErkJggg==")}\n${xt("geoeltu","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACGSURBVBjTdY+hFYUwDEU7xq9CIXC4uNjY6KczQXeoYgVMR2ABRmCGjvIp/6dgiEruueedvBDuOR57LQnKyc8CJmKO+N8bieIUPtmBWjIIx8XDBHYCipsnql1g2D0UP2OoDqwBncf+RdZmzFMHizRjog7KZYzawd4Ay93lEAPWR7WAvNbwMl/XwSxBV8qCjgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMi0wMlQxNDoyNjoyOSswMTowMMBG13YAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MTkrMDE6MDA7fJ3DAAAAAElFTkSuQmCC")}\n${xt("geomaterial","CAQAAAC1+jfqAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAABIAAAASABGyWs+AAAAbElEQVQoz62QMRbAIAhDP319Xon7j54qHSyCtaMZFCUkRjgDIdRU9yZUCfg8ut5aAHdcxtoNurmgA3ABNKIR9KimhSukPe2qxcCYC0pfFXx/aFWo7i42KKItOpopqvvnLzJmtlZTS7EfGAfwAM4EQbLIGV0sAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${xt("geoparab","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAB/SURBVBjTbY+xDYAwDAQ9UAp3X7p0m9o9dUZgA9oMwAjpMwMzMAnYBAQSX9mn9+tN9KOtzsWsLOvYCziUGNX3nnCLJRzKPgeYrhPW7FJNLUB3YJazYKQKTnBaxgXRzNmJcrt7XCHQp9kEB1wfELEir/KGj4Foh8A+/zW1nf51AFabKZuWK+mNAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${xt("geopgon","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAABwSURBVBjTY2AgDlwAAzh3sX1sPRDEeuwDc+8V2dsHgQQ8LCzq74HkLSzs7Yva2tLt7S3sN4MNiDUGKQmysCi6BzWkzcI+PdY+aDPCljZlj1iFOUjW1tvHLjYuQhJIt5/DcAFZYLH9YnSn7iPST9gAACbsJth21haFAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${xt("geotorus","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACGSURBVBjTjY+hFcMwDEQ9SkFggXGIoejhw+LiGkBDlHoAr+AhgjNL5byChuXeE7gvPelUyjOds/f5Zw0ggfj5KVCPMBWeyx+SbQ1XUriAC2XfpWWxjQQEZasRtRHiCUAj3qN4JaolUJppzh4q7dUTdHFXW/tH9OuswWm3nI7tc08+/eGLl758ey9KpKrNOQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMi0wMlQxNDoyNjoyOSswMTowMMBG13YAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MTkrMDE6MDA7fJ3DAAAAAElFTkSuQmCC")}\n${xt("geotrd1","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAB/SURBVBjTbc6xDQMhDAVQ9qH6lUtal65/zQ5IDMAMmYAZrmKGm4FJzlEQQUo+bvwkG4fwm9lbodV7w40Y4WGfSxQiXiJlQfZOjWRb8Ioi3tKuBQMCo7+9N72BzPsfAuoTdUP9QN8wgOQwvsfWmHzpeT5BKydMNW0nhJGvGf7mAc5WKO9e5N2dAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE1LTEyLTAyVDE0OjI2OjI5KzAxOjAwwEbXdgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOSswMTowMDt8ncMAAAAASUVORK5CYII=")}\n${xt("geotube","CAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAACGSURBVBjTRc+tEcAwCAXgLFNbWeSzSDQazw5doWNUZIOM0BEyS/NHy10E30HyklKvWnJ+0le3sJoKn3X2z7GRuvG++YRyMMDt0IIKUXMzxbnugJi5m9K1gNnGBOUFElAWGMaKIKI4xoQggl00gT+A9hXWgDwnfqgsHRAx2m+8bfjfdyrx5AtsSjpwu+M2RgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMi0wMlQxNDoyNjoyOSswMTowMMBG13YAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MTkrMDE6MDA7fJ3DAAAAAElFTkSuQmCC")}\n${xt("evepoints","BAMAAADt3eJSAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAABJQTFRF////n4mJcEdKRDMzcEdH////lLE/CwAAAAF0Uk5TAEDm2GYAAAABYktHRACIBR1IAAAACXBIWXMAAABIAAAASABGyWs+AAAAI0lEQVQI12NgIAowIpgKEJIZLiAgAKWZGQzQ9UGlWIizBQgAN4IAvGtVrTcAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTYtMDktMDJUMTU6MDQ6MzgrMDI6MDDPyc7hAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE2LTA5LTAyVDE1OjA0OjM4KzAyOjAwvpR2XQAAAABJRU5ErkJggg==")}\n${xt("evetrack","CAQAAAC1+jfqAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAABIAAAASABGyWs+AAAAqElEQVQoz32RMQrCQBBFf4IgSMB0IpGkMpVHCFh7BbHIGTyVhU0K8QYewEKsbVJZaCUiPAsXV8Puzhaz7H8zs5+JUDjikLilQr5zpCRl5xMXZNScQE5gSMGaz70jjUAJcw5c3UBMTsUe+9Kzf065SbropeLXimWfDIgoab/tOyPGzOhz53+oSWcSGh7UdB2ZNKXBZdgAuUdEKJYmrEILyVgG6pE2tEHgDfe42rbjYzSHAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE2LTA5LTAyVDE1OjA0OjQ3KzAyOjAwM0S3EQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNi0wOS0wMlQxNTowNDo0NyswMjowMEIZD60AAAAASUVORK5CYII=")}\n.jsroot .geovis_this { background-color: lightgreen; }\n.jsroot .geovis_daughters { background-color: lightblue; }\n.jsroot .geovis_all { background-color: yellow; }`)}function Sn(xt,K,ge){yn(),(0,Z.QL)("GradPerSegm",x.settings.GeoGradPerSegm),(0,Z.QL)("CompressComp",x.settings.GeoCompressComp);const ye=new $n(xt,K);return ye.decodeOptions(ge),ye}function ii(xt,K,ge){if(!K._geoobj)return!1;const ye=K._geoobj,Pe=K._volume,At=ye._typename===b||ye._typename===fe;if(!Pe&&!At)return!1;xt.add("separator");const Vt=(dn,In,ci)=>{if(In||(In={visible:0,hidden:0}),ci||(void 0!==In.assign?dn.fRnrSelf=In.assign:dn.fRnrSelf?In.vis++:In.hidden++),dn.fElements)for(let Pi=0;Pi<dn.fElements.arr.length;++Pi)Vt(dn.fElements.arr[Pi],In,!1);return In},Nt=dn=>{"self"===dn?(ye.fRnrSelf=!ye.fRnrSelf,K._icon=K._icon.split(" ")[0]+Je(ye),ge.updateTreeNode(K)):(Vt(ye,{assign:"true"===dn},!0),ge.forEachItem(In=>{In._geoobj&&In._icon&&(In._icon=K._icon.split(" ")[0]+Je(In._geoobj),ge.updateTreeNode(In))},K)),te(K,"testGeomChanges")},nn=dn=>{(0,Z.ZE)(Pe,dn);const In=K._icon.split(" ")[0]+Je(Pe);ge.forEachItem(ci=>{K._volume===ci._volume&&(ci._icon=In,ge.updateTreeNode(ci))}),ge.updateTreeNode(K),te(K,"testGeomChanges")},hn=te(K),kn=hn?ge.itemFullName(K,hn):"";if(0===K._geoobj._typename.indexOf(x.clTGeoNode)&&hn&&xt.add("Focus",()=>{hn&&(0,x.isFunc)(hn._painter?.focusOnItem)&&hn._painter.focusOnItem(kn)}),At){xt.addchk(ye.fRnrSelf,"Visible","self",Nt);const dn=Vt(ye,void 0,!0);dn.hidden+dn.visible>0&&xt.addchk(0===dn.hidden,"Daughters",0!==dn.hidden?"true":"false",Nt)}else{const dn=hn?._painter?._clones?.findStackByName(kn),In=dn?hn._painter._clones.getPhysNodeVisibility(dn):null,ci=(0,Z.zL)(Pe,Z.Wv.kVisThis);if(xt.addchk((0,Z.zL)(Pe,Z.Wv.kVisNone),"Invisible",Z.Wv.kVisNone,nn),dn){const Pi=Si=>{hn._painter._clones.setPhysNodeVisibility(dn,"off"!==Si&&Si),te(K,"testGeomChanges")};xt.add("sub:Physical vis","Physical node visibility - only for this instance"),xt.addchk(In?.visible,"on","on",Pi,"Enable visibility of phys node"),xt.addchk(In&&!In.visible,"off","off",Pi,"Disable visibility of physical node"),xt.add("reset","clear",Pi,"Reset custom visibility of physical node"),xt.add("reset all","clearall",Pi,"Reset all custom settings for all nodes"),xt.add("endsub:")}xt.addchk(ci,"Logical vis",Z.Wv.kVisThis,nn,"Logical node visibility - all instances"),xt.addchk((0,Z.zL)(Pe,Z.Wv.kVisDaughters),"Daughters",Z.Wv.kVisDaughters,nn,"Logical node daugthers visibility")}return!0}function ai(xt,K){return xt._volume?((0,Z.ZE)(xt._volume,xt._more&&xt._volume.fNodes?.arr?.length?Z.Wv.kVisDaughters:Z.Wv.kVisThis),tt(xt._volume,K),te(xt,"testGeomChanges"),!1):!xt._geoobj||xt._geoobj._typename!==b&&xt._geoobj._typename!==fe?void 0!==te(xt)?._painter?.extraObjectVisible(K,xt,!0):(xt._geoobj.fRnrSelf=!xt._geoobj.fRnrSelf,tt(xt._geoobj,K),te(xt,"testGeomChanges"),!1)}function Hi(xt,K){let ge="";switch(xt._kind){case x.prROOT+z:ge="img_evetrack";break;case x.prROOT+W:case x.prROOT+x.clTPolyMarker3D:ge="img_evepoints"}return ge&&te(xt)?._painter?.extraObjectVisible(K,xt)&&(ge+=" geovis_this"),ge}function ti(xt,K,ge){const ye={_kind:x.prROOT+K._typename,_name:ge||(0,Z.Hs)(K),_title:K.fTitle,_parent:xt,_geoobj:K,_get:nn=>(nn._geoobj&&(nn._geoobj.$geoh=!0),Promise.resolve(nn._geoobj))};let Pe,At,Vt,Nt=!1;return"TGeoMaterial"===K._typename?ye._icon="img_geomaterial":"TGeoMedium"===K._typename?ye._icon="img_geomedium":"TGeoMixture"===K._typename?ye._icon="img_geomixture":0===K._typename.indexOf(x.clTGeoNode)&&K.fVolume?(ye._title="node:"+K._typename,K.fTitle&&(ye._title+=" "+K.fTitle),Pe=K.fVolume):0===K._typename.indexOf(x.clTGeoVolume)?Pe=K:K._typename===b||K._typename===fe?(Nt=!0,At=K.fShape,Vt=K.fElements?K.fElements.arr:null):void 0!==K.fShapeBits&&void 0!==K.fShapeId&&(At=K),Pe&&(At=Pe.fShape,Vt=Pe.fNodes?Pe.fNodes.arr:null),(Pe||At||Vt)&&(Pe&&(ye._volume=Pe),Vt?(ye._more=!0,ye._expand=bt):At&&At._typename===Z.HO&&At.fNode&&(ye._more=!0,ye._shape=At,ye._expand=function(nn){return ti(nn,nn._shape.fNode.fLeft,"Left"),ti(nn,nn._shape.fNode.fRight,"Right"),!0}),!ye._title&&K._typename!==x.clTGeoVolume&&(ye._title=K._typename),At?(""===ye._title&&(ye._title=At._typename),ye._icon=(0,Z.fD)(At)):ye._icon=ye._more?"img_geocombi":"img_geobbox",Pe?ye._icon+=Je(Pe):Nt&&(ye._icon+=Je(K)),ye._menu=ii,ye._icon_click=ai),xt._childs||(xt._childs=[]),ye._name||((0,x.isStr)(xt._name)?(ye._name=xt._name,ye._name.lastIndexOf("s")===ye._name.length-1&&(ye._name=ye._name.slice(0,ye._name.length-1)),ye._name+="_"+xt._childs.length):ye._name="item_"+xt._childs.length),xt._childs.push(ye),ye}function Nr(xt){return ss.apply(this,arguments)}function ss(){return(ss=(0,Ee.A)(function*(xt){const K=(0,x.create)(x.clTNamed);K._typename=Z.Ce,K.fDX=1e-10,K.fDY=1e-10,K.fDZ=1e-10,K.fShapeId=1,K.fShapeBits=0,K.fOrigin=[0,0,0];const ge=Object.assign((0,x.create)(x.clTNamed),{_typename:b,fTrans:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],fShape:K,fRGBA:[0,0,0,0],fElements:null,fRnrSelf:!1}),ye=xt.getPadPainter(),Pe=ye?.pad?.fFillColor&&ye?.pad?.fFillStyle>1e3?"bkgr_"+ye.pad.fFillColor:"";return $n.draw(xt.getDom(),ge,Pe).then(At=>(At._dummy=!0,At))})).apply(this,arguments)}function Bs(){const xt=this.getMainPainter();if((0,x.isFunc)(xt?.setAxesDraw))return xt.setAxesDraw(!0);console.error("no geometry painter found to toggle TAxis3D drawing")}function yo(xt,K){if(!xt)return null;K||(K={}),K.numfaces||(K.numfaces=1e5),K.numnodes||(K.numnodes=1e3),K.frustum||(K.frustum=null),K.res_mesh=K.res_faces=0,void 0===K.instancing&&(K.instancing=-1),K.info={num_meshes:0,num_faces:0};let ge=null,ye=null;if(xt.visibles&&xt.nodes&&xt.numnodes){const Nt=xt.numnodes>1e6?{length:xt.numnodes}:new Array(xt.numnodes);xt.nodes.forEach(hn=>{Nt[hn.id]=Z.De.formatServerElement(hn)}),ge=new Z.De(null,Nt),ge.name_prefix=ge.getNodeName(0),ge.maxdepth=20;const nn=xt.cfg?.nsegm||30;for(let hn=0;hn<xt.visibles.length;++hn){const kn=xt.visibles[hn],dn=kn.ri;dn&&(kn.server_shape=dn.server_shape=(0,Z.uz)(dn,nn))}ye=xt.visibles}else{let Nt=null,nn=!1;if("fShapeBits"in xt&&"fShapeId"in xt?(Nt=xt,xt=null):xt._typename===T||xt._typename===x.clTGeoVolume||xt._typename===b||xt._typename===fe?Nt=xt.fShape:xt._typename===G?(nn=!K.showtop,Nt=(xt=xt.fMasterVolume).fShape):xt.fVolume?Nt=xt.fVolume.fShape:xt=null,K.composite&&Nt&&Nt._typename===Z.HO&&Nt.fNode&&(xt=je(Nt)),!xt&&Nt&&(xt=Object.assign((0,x.create)(x.clTNamed),{_typename:b,fTrans:null,fShape:Nt,fRGBA:[0,1,0,1],fElements:null,fRnrSelf:!0})),!xt)return null;0===xt._typename.indexOf(x.clTGeoVolume)&&(xt={_typename:x.clTGeoNode,fVolume:xt,fName:xt.fName,$geoh:xt.$geoh,_proxy:!0}),ge=new Z.De(xt),ge.setVisLevel(K.vislevel),ge.setMaxVisNodes(K.numnodes),K.dflt_colors&&ge.setDefaultColors(!0),(K.no_screen?0:ge.markVisibles(!0))<=0?ge.markVisibles(!1,!1,nn):ge.markVisibles(!0,!0,nn),ge.produceIdShifts(),ye=ge.collectVisibles(K.numfaces,K.frustum).lst}K.material_kind||(K.material_kind="lambert"),ge.setConfig(K);const Pe=ge.collectShapes(ye);ge.buildShapes(Pe,K.numfaces);const At=new L.B69;At.clones=ge;const Vt=(0,v.HG)();if(ge.createInstancedMeshes(K,At,ye,Pe,Vt))return At;for(let Nt=0;Nt<ye.length;++Nt){const nn=ye[Nt];if(nn.done)continue;const hn=nn.server_shape||Pe[nn.shapeid];if(!hn.ready){console.warn("shape marked as not ready when should");break}const kn=ge.createEntryMesh(K,At,nn,hn,Vt);kn&&(kn.name=ge.getNodeName(nn.nodeid))}return At}},578:(Yr,mt,Se)=>{"use strict";Se.d(mt,{De:()=>Pi,$T:()=>St,Ce:()=>B,HO:()=>we,qU:()=>Wi,Wz:()=>K,_b:()=>Ne,P1:()=>kn,Cc:()=>dn,d4:()=>hn,uz:()=>Nt,Wv:()=>X,QL:()=>Y,UX:()=>Jn,Dh:()=>Fe,Hs:()=>rt,fD:()=>Rs,xq:()=>ci,NN:()=>Q,k$:()=>ue,Pz:()=>Ln,qr:()=>ye,V:()=>nn,bg:()=>lt,N_:()=>te,zL:()=>Ge,ZE:()=>bt});var Ee=Se(2923),x=Se(8872);const L=1e-5;class Ze{constructor(D,O,ie,_e,Oe,$e){this.x=D,this.y=O,this.z=ie,this.nx=_e,this.ny=Oe,this.nz=$e}setnormal(D,O,ie){this.nx=D,this.ny=O,this.nz=ie}clone(){return new Ze(this.x,this.y,this.z,this.nx,this.ny,this.nz)}add(D){return this.x+=D.x,this.y+=D.y,this.z+=D.z,this}subtract(D){return this.x-=D.x,this.y-=D.y,this.z-=D.z,this}cross3(D,O,ie){const _e=this.x,Oe=this.y,$e=this.z;return this.x=Oe*ie-$e*O,this.y=$e*D-_e*ie,this.z=_e*O-Oe*D,this}normalize(){const D=Math.sqrt(this.x**2+this.y**2+this.z**2);return this.x/=D,this.y/=D,this.z/=D,this}dot(D){return this.x*D.x+this.y*D.y+this.z*D.z}diff(D){const Oe=this.x**2+this.y**2+this.z**2;return((this.x-D.x)**2+(this.y-D.y)**2+(this.z-D.z)**2)/(Oe>0?Oe:1e-10)}interpolate(D,O){const ie=1-O;return new Ze(this.x*ie+D.x*O,this.y*ie+D.y*O,this.z*ie+D.z*O,this.nx*ie+D.nx*O,this.ny*ie+D.ny*O,this.nz*ie+D.nz*O)}applyMatrix4(D){let O=this.x,ie=this.y,_e=this.z;const Oe=D.elements;return this.x=Oe[0]*O+Oe[4]*ie+Oe[8]*_e+Oe[12],this.y=Oe[1]*O+Oe[5]*ie+Oe[9]*_e+Oe[13],this.z=Oe[2]*O+Oe[6]*ie+Oe[10]*_e+Oe[14],O=this.nx,ie=this.ny,_e=this.nz,this.nx=Oe[0]*O+Oe[4]*ie+Oe[8]*_e,this.ny=Oe[1]*O+Oe[5]*ie+Oe[9]*_e,this.nz=Oe[2]*O+Oe[6]*ie+Oe[10]*_e,this}}class Re{constructor(D,O,ie){this.vertices=D||[],this.nsign=1,O?this.copyProperties(O,ie):this.vertices.length>0&&this.calculateProperties()}copyProperties(D,O){return this.normal=D.normal,this.w=D.w,this.nsign=D.nsign,O&&void 0!==D.id&&(this.id=D.id,this.parent=D),this}calculateProperties(D){if(this.normal&&!D)return;const O=this.vertices[0],ie=this.vertices[1],_e=this.vertices[2];return this.nsign=1,this.normal=new Ze(ie.x-O.x,ie.y-O.y,ie.z-O.z,0,0,0).cross3(_e.x-O.x,_e.y-O.y,_e.z-O.z).normalize(),this.w=this.normal.dot(O),this}clone(){const D=this.vertices.length,O=[];for(let ie=0;ie<D;++ie)O.push(this.vertices[ie].clone());return new Re(O,this)}flip(){return this.nsign*=-1,this.vertices.reverse(),this}classifyVertex(D){const O=this.nsign*(this.normal.dot(D)-this.w);return O<-L?2:O>L?1:0}classifySide(D){let O=0,ie=0;const _e=D.vertices.length;for(let Oe=0;Oe<_e;++Oe){const $e=this.classifyVertex(D.vertices[Oe]);1===$e?++O:2===$e&&++ie}return O>0&&0===ie?1:0===O&&ie>0?2:0===O&&0===ie?0:3}splitPolygon(D,O,ie,_e,Oe){const $e=this.classifySide(D);if(0===$e)(this.nsign*D.nsign*this.normal.dot(D.normal)>0?O:ie).push(D);else if(1===$e)_e.push(D);else if(2===$e)Oe.push(D);else{const et=D.vertices.length,it=this.normal.x,yt=this.normal.y,sn=this.normal.z,tn=[],xn=[];let wn,Ut,Qe,nt,at,ht,Qt,vn;for(wn=0;wn<et;++wn)Ut=(wn+1)%et,at=D.vertices[wn],ht=D.vertices[Ut],Qe=this.classifyVertex(at),nt=this.classifyVertex(ht),2!==Qe&&tn.push(at),1!==Qe&&xn.push(at),3==(Qe|nt)&&(Qt=(this.w-(it*at.x+yt*at.y+sn*at.z))/(it*(ht.x-at.x)+yt*(ht.y-at.y)+sn*(ht.z-at.z)),vn=at.interpolate(ht,Qt),tn.push(vn),xn.push(vn));tn.length>=3&&_e.push(new Re(tn,D,!0)),xn.length>=3&&Oe.push(new Re(xn,D,!0))}}}class He{constructor(D,O){if(this.polygons=[],this.front=this.back=void 0,!D)return;this.divider=D[0].clone();const ie=D.length,_e=[],Oe=[];for(let $e=0;$e<ie;++$e)void 0!==O&&(D[$e].id=O++,delete D[$e].parent),0===$e?this.polygons.push(D[0]):this.divider.splitPolygon(D[$e],this.polygons,this.polygons,_e,Oe);void 0!==O&&(this.maxnodeid=O),_e.length>0&&(this.front=new He(_e)),Oe.length>0&&(this.back=new He(Oe))}build(D){const O=D.length,ie=[],_e=[];let Oe=0;this.divider||(this.divider=D[0].clone(),this.polygons.push(D[0]),Oe=1);for(let $e=Oe;$e<O;++$e)this.divider.splitPolygon(D[$e],this.polygons,this.polygons,ie,_e);ie.length>0&&(this.front||(this.front=new He),this.front.build(ie)),_e.length>0&&(this.back||(this.back=new He),this.back.build(_e))}collectPolygons(D){void 0===D&&(D=[]);const O=this.polygons.length;for(let ie=0;ie<O;++ie)D.push(this.polygons[ie]);return this.front?.collectPolygons(D),this.back?.collectPolygons(D),D}numPolygons(){return this.polygons.length+(this.front?.numPolygons()||0)+(this.back?.numPolygons()||0)}clone(){const D=new He;return D.divider=this.divider?.clone(),D.polygons=this.polygons.map(O=>O.clone()),D.front=this.front?.clone(),D.back=this.back?.clone(),D}invert(){const D=this.polygons.length;for(let ie=0;ie<D;++ie)this.polygons[ie].flip();this.divider.flip(),this.front&&this.front.invert(),this.back&&this.back.invert();const O=this.front;return this.front=this.back,this.back=O,this}clipPolygons(D){if(!this.divider)return D.slice();const O=D.length;let ie=[],_e=[];for(let Oe=0;Oe<O;++Oe)this.divider.splitPolygon(D[Oe],ie,_e,ie,_e);return this.front&&(ie=this.front.clipPolygons(ie)),_e=this.back?this.back.clipPolygons(_e):[],ie.concat(_e)}clipTo(D){this.polygons=D.clipPolygons(this.polygons),this.front&&this.front.clipTo(D),this.back&&this.back.clipTo(D)}}function Ve(oe){const D=oe.length;let O,ie,_e=0;for(O=0;O<D;++O)_e+=9*(oe[O].vertices.length-2);const Oe=new Float32Array(_e),$e=new Float32Array(_e);let it,et=0;function yt(tn){Oe[et]=tn.x,Oe[et+1]=tn.y,Oe[et+2]=tn.z,$e[et]=it.nsign*tn.nx,$e[et+1]=it.nsign*tn.ny,$e[et+2]=it.nsign*tn.nz,et+=3}for(O=0;O<D;++O)for(it=oe[O],ie=2;ie<it.vertices.length;++ie)yt(it.vertices[0]),yt(it.vertices[ie-1]),yt(it.vertices[ie]);const sn=new Ee.LoY;return sn.setAttribute("position",new Ee.THS(Oe,3)),sn.setAttribute("normal",new Ee.THS($e,3)),sn}class De{constructor(D,O,ie,_e){if(!(D instanceof Ee.eaF)){if(D instanceof He)return this.tree=D,this.matrix=null,this;if(D instanceof Ee.LoY){const xn=D.getAttribute("position").array,wn=D.getAttribute("normal").array,Ut=[];let Qe,nt,at,ht;for(let Qt=0;Qt<xn.length;Qt+=9)Qe=new Re,nt=new Ze(xn[Qt],xn[Qt+1],xn[Qt+2],wn[Qt],wn[Qt+1],wn[Qt+2]),O&&nt.applyMatrix4(O),at=new Ze(xn[Qt+3],xn[Qt+4],xn[Qt+5],wn[Qt+3],wn[Qt+4],wn[Qt+5]),O&&at.applyMatrix4(O),ht=new Ze(xn[Qt+6],xn[Qt+7],xn[Qt+8],wn[Qt+6],wn[Qt+7],wn[Qt+8]),O&&ht.applyMatrix4(O),_e?Qe.vertices.push(nt,ht,at):Qe.vertices.push(nt,at,ht),Qe.calculateProperties(!0),Ut.push(Qe);return this.tree=new He(Ut,ie),void 0!==ie&&(this.maxid=this.tree.maxnodeid),this}if(D.polygons&&D.polygons[0]instanceof Re){const xn=D.polygons;for(let wn=0;wn<xn.length;++wn){const Ut=xn[wn];if(O){const Qe=[];for(let nt=0;nt<Ut.vertices.length;++nt)Qe.push(Ut.vertices[nt].clone().applyMatrix4(O));Ut.vertices=Qe}Ut.calculateProperties(O)}return this.tree=new He(xn,ie),void 0!==ie&&(this.maxid=this.tree.maxnodeid),this}throw Error("ThreeBSP: Given geometry is unsupported")}D.updateMatrix(),O=this.matrix=D.matrix.clone();const Oe=[],$e=(D=D.geometry).faces.length;let et,it,yt,sn,tn;for(let xn=0;xn<$e;++xn)et=D.faces[xn],sn=et.normal,it=new Re,tn=et.vertexNormals&&3===et.vertexNormals.length,yt=D.vertices[et.a],tn&&(sn=et.vertexNormals[0]),yt=new Ze(yt.x,yt.y,yt.z,sn.x,sn.y,sn.z),O&&yt.applyMatrix4(O),it.vertices.push(yt),yt=D.vertices[et.b],tn&&(sn=et.vertexNormals[1]),yt=new Ze(yt.x,yt.y,yt.z,sn.x,sn.y,sn.z),O&&yt.applyMatrix4(O),it.vertices.push(yt),yt=D.vertices[et.c],tn&&(sn=et.vertexNormals[2]),yt=new Ze(yt.x,yt.y,yt.z,sn.x,sn.y,sn.z),O&&yt.applyMatrix4(O),it.vertices.push(yt),it.calculateProperties(!0),Oe.push(it);this.tree=new He(Oe,ie),void 0!==ie&&(this.maxid=this.tree.maxnodeid)}subtract(D){let O=this.tree.clone();const ie=D.tree.clone();return O.invert(),O.clipTo(ie),ie.clipTo(O),ie.invert(),ie.clipTo(O),ie.invert(),O.build(ie.collectPolygons()),O.invert(),O=new De(O),O.matrix=this.matrix,O}union(D){let O=this.tree.clone();const ie=D.tree.clone();return O.clipTo(ie),ie.clipTo(O),ie.invert(),ie.clipTo(O),ie.invert(),O.build(ie.collectPolygons()),O=new De(O),O.matrix=this.matrix,O}intersect(D){let O=this.tree.clone();const ie=D.tree.clone();return O.invert(),ie.clipTo(O),ie.invert(),O.clipTo(ie),ie.clipTo(O),O.build(ie.collectPolygons()),O.invert(),O=new De(O),O.matrix=this.matrix,O}tryToCompress(D){if(void 0===this.maxid)return;const O=[];let ie,_e,$e,it,yt,sn,tn,xn,Oe=0,et=D.length;for($e=0;$e<et;++$e)it=D[$e],void 0!==it.id&&(void 0===O[it.id]&&(O[it.id]=[]),O[it.id].push(it));for($e=0;$e<O.length;++$e)if(ie=O[$e],void 0!==ie)for(et=ie.length,_e=et>1;_e;)for(_e=!1,tn=0;tn<et-1;++tn)if(yt=ie[tn],yt?.parent)for(xn=tn+1;xn<et;++xn)if(sn=ie[xn],sn&&yt.parent===sn.parent&&yt.nsign===sn.nsign){yt.nsign!==yt.parent.nsign&&yt.parent.flip(),Oe++,ie[tn]=yt.parent,ie[xn]=null,yt.parent.vertices.length<3&&console.log("something wrong with parent"),_e=!0;break}if(Oe>0)for(D.splice(0,D.length),$e=0;$e<O.length;++$e)if(ie=O[$e],void 0!==ie)for(tn=0,et=ie.length;tn<et;++tn)ie[tn]&&D.push(ie[tn])}direct_subtract(D){const O=this.tree,ie=D.tree;return O.invert(),O.clipTo(ie),ie.clipTo(O),ie.invert(),ie.clipTo(O),ie.invert(),O.build(ie.collectPolygons()),O.invert(),this}direct_union(D){const O=this.tree,ie=D.tree;return O.clipTo(ie),ie.clipTo(O),ie.invert(),ie.clipTo(O),ie.invert(),O.build(ie.collectPolygons()),this}direct_intersect(D){const O=this.tree,ie=D.tree;return O.invert(),ie.clipTo(O),ie.invert(),O.clipTo(ie),ie.clipTo(O),O.build(ie.collectPolygons()),O.invert(),this}cut_from_plane(D){const O=this.tree,ie=D.tree;return O.invert(),ie.clipTo(O),this}scale(D,O,ie){const _e=this.tree.collectPolygons();for(let Oe=0;Oe<_e.length;++Oe){const $e=_e[Oe];for(let et=0;et<$e.vertices.length;++et){const it=$e.vertices[et];it.x*=D,it.y*=O,it.z*=ie}$e.calculateProperties(!0)}}toPolygons(){const D=this.tree.collectPolygons();this.tryToCompress(D);for(let O=0;O<D.length;++O)delete D[O].id,delete D[O].parent;return D}toBufferGeometry(){return Ve(this.toPolygons())}toMesh(D){const O=this.toBufferGeometry(),ie=new Ee.eaF(O,D);return this.matrix&&(ie.position.setFromMatrixPosition(this.matrix),ie.rotation.setFromRotationMatrix(this.matrix)),ie}}const J={GradPerSegm:6,CompressComp:!0};function Y(oe,D){if(void 0===D)return J[oe];J[oe]=D}const ue=0,Q=1,X={kVisOverride:(0,x.BIT)(0),kVisNone:(0,x.BIT)(1),kVisThis:(0,x.BIT)(2),kVisDaughters:(0,x.BIT)(3),kVisOneLevel:(0,x.BIT)(4),kVisStreamed:(0,x.BIT)(5),kVisTouched:(0,x.BIT)(6),kVisOnScreen:(0,x.BIT)(7),kVisContainers:(0,x.BIT)(12),kVisOnly:(0,x.BIT)(13),kVisBranch:(0,x.BIT)(14),kVisRaytrace:(0,x.BIT)(15)},B="TGeoBBox",$="TGeoArb8",A="TGeoCone",E="TGeoConeSeg",g="TGeoTube",v="TGeoTubeSeg",f="TGeoCtub",C="TGeoTrd1",I="TGeoTrd2",U="TGeoPara",k="TGeoParaboloid",Z="TGeoPcon",ee="TGeoPgon",he="TGeoShapeAssembly",G="TGeoSphere",b="TGeoTorus",P="TGeoXtru",T="TGeoTrap",z="TGeoGtra",W="TGeoEltu",fe="TGeoHype",we="TGeoCompositeShape",Me="TGeoHalfSpace",je="TGeoScaledShape";function Ge(oe,D){const O=oe.fGeoAtt;return void 0!==O&&!!(O&D)}function lt(oe,D,O){void 0!==oe.fGeoAtt&&(oe.fGeoAtt=O?oe.fGeoAtt|D:oe.fGeoAtt&~D)}function bt(oe,D){void 0!==oe.fGeoAtt&&(oe.fGeoAtt=oe.fGeoAtt^16777215&D)}function te(oe,D){if(void 0===D&&(D=!0),lt(oe,X.kVisThis,!D),oe.fNodes)for(let O=0;O<oe.fNodes.arr.length;++O)lt(oe.fNodes.arr[O].fVolume,X.kVisThis,!D)}const Je={};function tt(oe){void 0===Je[oe]&&(Je[oe]=!0,console.warn(oe))}function Fe(oe){return(0,x.isObject)(oe)?"fShape"in oe&&"fTrans"in oe?Q:ue:-1}function Ne(oe){return oe?oe._typename!==we?1:Ne(oe.fNode.fLeft)+Ne(oe.fNode.fRight):0}function rt(oe){return oe?.fName?oe.fName+(oe.$geo_suffix||""):""}function St(oe,D){if(oe){if(oe.$geo_checked)return;oe.$geo_checked=!0}const O=[],ie=[];for(let _e=0;_e<D.length;++_e){const Oe=D[_e];if(Oe?.fName){if(!Oe.$geo_suffix){const $e=O.indexOf(Oe.fName);if($e>=0){let et=ie[$e]||1;for(;O.indexOf(Oe.fName+"#"+et)>=0;)++et;Oe.$geo_suffix="#"+et,ie[$e]=et+1}}O.push(rt(Oe))}}}function pt(oe,D,O,ie,_e,Oe,$e,et,it){const yt=new Ee.Pq0(oe,D,O),sn=new Ee.Pq0(ie,_e,Oe),tn=new Ee.Pq0($e,et,it),xn=new Ee.Pq0,wn=new Ee.Pq0;return xn.subVectors(tn,sn),wn.subVectors(yt,sn),xn.cross(wn),xn}class st{constructor(D){this.nfaces=D,this.indx=0,this.pos=new Float32Array(9*D),this.norm=new Float32Array(9*D)}addFace3(D,O,ie,_e,Oe,$e,et,it,yt){const sn=this.indx,tn=this.pos;tn[sn]=D,tn[sn+1]=O,tn[sn+2]=ie,tn[sn+3]=_e,tn[sn+4]=Oe,tn[sn+5]=$e,tn[sn+6]=et,tn[sn+7]=it,tn[sn+8]=yt,this.last4=!1,this.indx=sn+9}startPolygon(){}stopPolygon(){}addFace4(D,O,ie,_e,Oe,$e,et,it,yt,sn,tn,xn,wn){let Ut=this.indx;const Qe=this.pos;1!==wn&&(Qe[Ut]=D,Qe[Ut+1]=O,Qe[Ut+2]=ie,Qe[Ut+3]=_e,Qe[Ut+4]=Oe,Qe[Ut+5]=$e,Qe[Ut+6]=et,Qe[Ut+7]=it,Qe[Ut+8]=yt,Ut+=9),2!==wn&&(Qe[Ut]=D,Qe[Ut+1]=O,Qe[Ut+2]=ie,Qe[Ut+3]=et,Qe[Ut+4]=it,Qe[Ut+5]=yt,Qe[Ut+6]=sn,Qe[Ut+7]=tn,Qe[Ut+8]=xn,Ut+=9),this.last4=Ut!==this.indx+9,this.indx=Ut}setNormal4(D,O,ie,_e,Oe,$e,et,it,yt,sn,tn,xn,wn){if(this.last4&&wn)return console.error("missmatch between addFace4 and setNormal4 calls");let Ut=this.indx-(this.last4?18:9);const Qe=this.norm;1!==wn&&(Qe[Ut]=D,Qe[Ut+1]=O,Qe[Ut+2]=ie,Qe[Ut+3]=_e,Qe[Ut+4]=Oe,Qe[Ut+5]=$e,Qe[Ut+6]=et,Qe[Ut+7]=it,Qe[Ut+8]=yt,Ut+=9),2!==wn&&(Qe[Ut]=D,Qe[Ut+1]=O,Qe[Ut+2]=ie,Qe[Ut+3]=et,Qe[Ut+4]=it,Qe[Ut+5]=yt,Qe[Ut+6]=sn,Qe[Ut+7]=tn,Qe[Ut+8]=xn)}recalcZ(D){const O=this.pos,ie=this.indx;let _e=ie-(this.last4?18:9);for(;_e<ie;)O[_e+2]=D(O[_e],O[_e+1],O[_e+2]),_e+=3}calcNormal(){this.cb||(this.pA=new Ee.Pq0,this.pB=new Ee.Pq0,this.pC=new Ee.Pq0,this.cb=new Ee.Pq0,this.ab=new Ee.Pq0),this.pA.fromArray(this.pos,this.indx-9),this.pB.fromArray(this.pos,this.indx-6),this.pC.fromArray(this.pos,this.indx-3),this.cb.subVectors(this.pC,this.pB),this.ab.subVectors(this.pA,this.pB),this.cb.cross(this.ab),this.setNormal(this.cb.x,this.cb.y,this.cb.z)}setNormal(D,O,ie){let _e=this.indx-9;const Oe=this.norm;Oe[_e]=Oe[_e+3]=Oe[_e+6]=D,Oe[_e+1]=Oe[_e+4]=Oe[_e+7]=O,Oe[_e+2]=Oe[_e+5]=Oe[_e+8]=ie,this.last4&&(_e-=9,Oe[_e]=Oe[_e+3]=Oe[_e+6]=D,Oe[_e+1]=Oe[_e+4]=Oe[_e+7]=O,Oe[_e+2]=Oe[_e+5]=Oe[_e+8]=ie)}setNormal_12_34(D,O,ie,_e,Oe,$e,et){void 0===et&&(et=0);let it=this.indx-(et>0?9:18);const yt=this.norm;1!==et&&(yt[it]=D,yt[it+1]=O,yt[it+2]=ie,yt[it+3]=D,yt[it+4]=O,yt[it+5]=ie,yt[it+6]=_e,yt[it+7]=Oe,yt[it+8]=$e,it+=9),2!==et&&(yt[it]=D,yt[it+1]=O,yt[it+2]=ie,yt[it+3]=_e,yt[it+4]=Oe,yt[it+5]=$e,yt[it+6]=_e,yt[it+7]=Oe,yt[it+8]=$e)}create(){this.nfaces!==this.indx/9&&console.error(`Mismatch with created ${this.nfaces} and filled ${this.indx/9} number of faces`);const D=new Ee.LoY;return D.setAttribute("position",new Ee.THS(this.pos,3)),D.setAttribute("normal",new Ee.THS(this.norm,3)),D}}class vt{constructor(){this.polygons=[]}startPolygon(D){this.multi=1,this.mnormal=D}stopPolygon(){this.multi&&(this.multi=0,console.error("Polygon should be already closed at this moment"))}addFace3(D,O,ie,_e,Oe,$e,et,it,yt){this.addFace4(D,O,ie,_e,Oe,$e,et,it,yt,et,it,yt,2)}addFace4(D,O,ie,_e,Oe,$e,et,it,yt,sn,tn,xn,wn){if(void 0===wn&&(wn=0),this.v1=new Ze(D,O,ie,0,0,0),this.v2=1===wn?null:new Ze(_e,Oe,$e,0,0,0),this.v3=new Ze(et,it,yt,0,0,0),this.v4=2===wn?null:new Ze(sn,tn,xn,0,0,0),this.reduce=wn,this.multi){let Qe;return 2!==wn&&console.error("polygon not supported for not-reduced faces"),1==this.multi++?(Qe=new Re,Qe.vertices.push(this.mnormal?this.v2:this.v3),this.polygons.push(Qe)):(Qe=this.polygons[this.polygons.length-1],(this.mnormal?this.v2:this.v3).diff(this.mnormal?Qe.vertices[Qe.vertices.length-1]:Qe.vertices[0])>1e-12&&console.error("vertex missmatch when building polygon")),void((this.mnormal?this.v3:this.v2).diff(this.mnormal?Qe.vertices[0]:Qe.vertices[Qe.vertices.length-1])<1e-12?this.multi=0:this.mnormal?Qe.vertices.push(this.v3):Qe.vertices.unshift(this.v2))}const Ut=new Re;switch(wn){case 0:Ut.vertices.push(this.v1,this.v2,this.v3,this.v4);break;case 1:Ut.vertices.push(this.v1,this.v3,this.v4);break;case 2:Ut.vertices.push(this.v1,this.v2,this.v3)}this.polygons.push(Ut)}setNormal4(D,O,ie,_e,Oe,$e,et,it,yt,sn,tn,xn){this.v1.setnormal(D,O,ie),this.v2&&this.v2.setnormal(_e,Oe,$e),this.v3.setnormal(et,it,yt),this.v4&&this.v4.setnormal(sn,tn,xn)}setNormal_12_34(D,O,ie,_e,Oe,$e){this.v1.setnormal(D,O,ie),this.v2&&this.v2.setnormal(D,O,ie),this.v3.setnormal(_e,Oe,$e),this.v4&&this.v4.setnormal(_e,Oe,$e)}calcNormal(){this.cb||(this.pA=new Ee.Pq0,this.pB=new Ee.Pq0,this.pC=new Ee.Pq0,this.cb=new Ee.Pq0,this.ab=new Ee.Pq0),this.pA.set(this.v1.x,this.v1.y,this.v1.z),1!==this.reduce?(this.pB.set(this.v2.x,this.v2.y,this.v2.z),this.pC.set(this.v3.x,this.v3.y,this.v3.z)):(this.pB.set(this.v3.x,this.v3.y,this.v3.z),this.pC.set(this.v4.x,this.v4.y,this.v4.z)),this.cb.subVectors(this.pC,this.pB),this.ab.subVectors(this.pA,this.pB),this.cb.cross(this.ab),this.setNormal(this.cb.x,this.cb.y,this.cb.z)}setNormal(D,O,ie){this.v1.setnormal(D,O,ie),this.v2&&this.v2.setnormal(D,O,ie),this.v3.setnormal(D,O,ie),this.v4&&this.v4.setnormal(D,O,ie)}recalcZ(D){this.v1.z=D(this.v1.x,this.v1.y,this.v1.z),this.v2&&(this.v2.z=D(this.v2.x,this.v2.y,this.v2.z)),this.v3.z=D(this.v3.x,this.v3.y,this.v3.z),this.v4&&(this.v4.z=D(this.v4.x,this.v4.y,this.v4.z))}create(){return{polygons:this.polygons}}}function qt(oe,D){const O=[4,7,6,5,0,3,7,4,4,5,1,0,6,2,1,5,7,3,2,6,1,2,3,0],ie=D>0?new vt:new st(12);for(let _e=0;_e<O.length;_e+=4){const Oe=3*O[_e],$e=3*O[_e+1],et=3*O[_e+2],it=3*O[_e+3];ie.addFace4(oe[Oe],oe[Oe+1],oe[Oe+2],oe[$e],oe[$e+1],oe[$e+2],oe[et],oe[et+1],oe[et+2],oe[it],oe[it+1],oe[it+2]),0===_e?ie.setNormal(0,0,1):20===_e?ie.setNormal(0,0,-1):ie.calcNormal()}return ie.create()}function Dn(oe,D){let O,ie;oe._typename===A||oe._typename===E?(O=[oe.fRmax2,oe.fRmax1],ie=[oe.fRmin2,oe.fRmin1]):(O=[oe.fRmax,oe.fRmax],ie=[oe.fRmin,oe.fRmin]);const _e=ie[0]>0||ie[1]>0;let Oe=0,$e=360;(oe._typename===E||oe._typename===v||oe._typename===f)&&(Oe=oe.fPhi1,$e=oe.fPhi2-oe.fPhi1);const et=Math.max(4,Math.round($e/J.GradPerSegm));let it=et*(O[0]<=0||O[1]<=0?1:2);if(_e&&(it+=et*(ie[0]<=0||ie[1]<=0?1:2)),O[0]>0&&(it+=et*(ie[0]>0?2:1)),O[1]>0&&(it+=et*(ie[1]>0?2:1)),$e<360&&(it+=(O[0]>ie[0]?2:0)+(O[1]>ie[1]?2:0)),D<0)return it;const yt=Oe*Math.PI/180,sn=$e/et*Math.PI/180,tn=new Float32Array(et+1),xn=new Float32Array(et+1);for(let Qe=0;Qe<=et;++Qe)xn[Qe]=Math.cos(yt+Qe*sn),tn[Qe]=Math.sin(yt+Qe*sn);const wn=D?new vt:new st(it),Ut=oe._typename!==f?null:(Qe,nt,at)=>{const ht=at<0?oe.fNlow:oe.fNhigh;return(at<0?-oe.fDz:oe.fDz)-(Qe*ht[0]+nt*ht[1])/ht[2]};for(let Qe=0;Qe<2&&(1!==Qe||_e);++Qe){const nt=0===Qe?O:ie,at=Qe,ht=1-Qe;let Qt=1,vn=0;if(nt[0]!==nt[1]){const jt=Math.atan2(nt[1]-nt[0],2*oe.fDZ);Qt=Math.cos(jt),vn=Math.sin(jt)}1===Qe&&(Qt*=-1,vn*=-1);const en=nt[0]<=0?2:nt[1]<=0?1:0;for(let jt=0;jt<et;++jt)wn.addFace4(nt[0]*xn[jt+at],nt[0]*tn[jt+at],oe.fDZ,nt[1]*xn[jt+at],nt[1]*tn[jt+at],-oe.fDZ,nt[1]*xn[jt+ht],nt[1]*tn[jt+ht],-oe.fDZ,nt[0]*xn[jt+ht],nt[0]*tn[jt+ht],oe.fDZ,en),Ut&&wn.recalcZ(Ut),wn.setNormal_12_34(Qt*xn[jt+at],Qt*tn[jt+at],vn,Qt*xn[jt+ht],Qt*tn[jt+ht],vn,en)}for(let Qe=0;Qe<2;++Qe){if(O[Qe]<=0)continue;const nt=Qe,at=1-Qe,ht=0===Qe?1:-1,Qt=ie[Qe]<=0?2:0;2===Qt&&360===$e&&!Ut&&wn.startPolygon(0===Qe);for(let vn=0;vn<et;++vn)wn.addFace4(ie[Qe]*xn[vn+nt],ie[Qe]*tn[vn+nt],ht*oe.fDZ,O[Qe]*xn[vn+nt],O[Qe]*tn[vn+nt],ht*oe.fDZ,O[Qe]*xn[vn+at],O[Qe]*tn[vn+at],ht*oe.fDZ,ie[Qe]*xn[vn+at],ie[Qe]*tn[vn+at],ht*oe.fDZ,Qt),Ut?(wn.recalcZ(Ut),wn.calcNormal()):wn.setNormal(0,0,ht);wn.stopPolygon()}return $e<360&&(wn.addFace4(ie[1]*xn[0],ie[1]*tn[0],-oe.fDZ,O[1]*xn[0],O[1]*tn[0],-oe.fDZ,O[0]*xn[0],O[0]*tn[0],oe.fDZ,ie[0]*xn[0],ie[0]*tn[0],oe.fDZ,O[0]===ie[0]?2:ie[1]===O[1]?1:0),Ut&&wn.recalcZ(Ut),wn.calcNormal(),wn.addFace4(ie[0]*xn[et],ie[0]*tn[et],oe.fDZ,O[0]*xn[et],O[0]*tn[et],oe.fDZ,O[1]*xn[et],O[1]*tn[et],-oe.fDZ,ie[1]*xn[et],ie[1]*tn[et],-oe.fDZ,O[0]===ie[0]?1:ie[1]===O[1]?2:0),Ut&&wn.recalcZ(Ut),wn.calcNormal()),wn.create()}function ti(oe){if(!oe)return null;let D,O,ie;switch(oe._typename){case"TGeoTranslation":D=oe.fTranslation;break;case"TGeoRotation":O=oe.fRotationMatrix;break;case"TGeoScale":ie=oe.fScale;break;case"TGeoGenTrans":ie=oe.fScale;case"TGeoCombiTrans":D=oe.fTranslation,oe.fRotation&&(O=oe.fRotation.fRotationMatrix);break;case"TGeoHMatrix":D=oe.fTranslation,O=oe.fRotationMatrix,ie=oe.fScale;break;case"TGeoIdentity":break;default:console.warn(`unsupported matrix ${oe._typename}`)}if(!D&&!O&&!ie)return null;const _e=new Ee.kn4;return O&&_e.set(O[0],O[1],O[2],0,O[3],O[4],O[5],0,O[6],O[7],O[8],0,0,0,0,1),D&&_e.setPosition(D[0],D[1],D[2]),ie&&_e.scale(new Ee.Pq0(ie[0],ie[1],ie[2])),_e}function Nr(oe,D){let O=null;if(oe===Q)O=new Ee.kn4,D.fTrans&&(O.set(D.fTrans[0],D.fTrans[4],D.fTrans[8],0,D.fTrans[1],D.fTrans[5],D.fTrans[9],0,D.fTrans[2],D.fTrans[6],D.fTrans[10],0,0,0,0,1),O.setPosition(D.fTrans[12],D.fTrans[13],D.fTrans[14]));else if(D.fMatrix)O=ti(D.fMatrix);else if("TGeoNodeOffset"===D._typename&&D.fFinder){const ie=(0,x.BIT)(14);switch(D.fFinder.fBits&ie&&tt("Unsupported reflected pattern "+D.fFinder._typename),D.fFinder._typename){case"TGeoPatternX":case"TGeoPatternY":case"TGeoPatternZ":case"TGeoPatternParaX":case"TGeoPatternParaY":case"TGeoPatternParaZ":{const _e=D.fFinder.fStart+(D.fIndex+.5)*D.fFinder.fStep;switch(O=new Ee.kn4,D.fFinder._typename[D.fFinder._typename.length-1]){case"X":O.setPosition(_e,0,0);break;case"Y":O.setPosition(0,_e,0);break;case"Z":O.setPosition(0,0,_e)}break}case"TGeoPatternCylPhi":{const _e=Math.PI/180*(D.fFinder.fStart+(D.fIndex+.5)*D.fFinder.fStep),Oe=Math.cos(_e),$e=Math.sin(_e);O=new Ee.kn4,O.set(Oe,-$e,0,0,$e,Oe,0,0,0,0,1,0,0,0,0,1);break}case"TGeoPatternCylR":O=new Ee.kn4;break;case"TGeoPatternTrapZ":{const _e=D.fFinder.fStart+(D.fIndex+.5)*D.fFinder.fStep;O=new Ee.kn4,O.setPosition(D.fFinder.fTxz*_e,D.fFinder.fTyz*_e,_e);break}default:tt(`Unsupported pattern type ${D.fFinder._typename}`)}}return O}function ss(oe){if(!oe)return 0;if(oe instanceof De)return oe.tree.numPolygons();if(oe.polygons)return oe.polygons.length;const D=oe.getAttribute("position");return D?.count?Math.round(D.count/3):0}function xt(oe,D){if(!oe?.fN||!oe?.fP)return null;const O=new Ee.Pq0(oe.fP[0],oe.fP[1],oe.fP[2]),ie=new Ee.Pq0(oe.fN[0],oe.fN[1],oe.fN[2]);ie.normalize();let _e=1e10;if(D){const tn=function yo(oe){if(!oe)return null;let D=null;if(oe instanceof De?D=oe.tree.collectPolygons():oe.polygons&&(D=oe.polygons),null!==D){const O=new Ee.NRn;for(let ie=0;ie<D.length;++ie){const _e=D[ie],Oe=_e.vertices.length;for(let $e=0;$e<Oe;++$e)O.expandByPoint(_e.vertices[$e])}return O}return oe.boundingBox||oe.computeBoundingBox(),oe.boundingBox.clone()}(D);tn&&(_e=1e3*tn.getSize(new Ee.Pq0).length())}const Oe=new Ee.Pq0(-_e,-_e/2,0),$e=new Ee.Pq0(0,_e,0),et=new Ee.Pq0(_e,-_e/2,0),it=new Ee.Pq0(0,0,-_e),yt=new Ee.LoY,sn=new Float32Array([Oe.x,Oe.y,Oe.z,et.x,et.y,et.z,$e.x,$e.y,$e.z,Oe.x,Oe.y,Oe.z,$e.x,$e.y,$e.z,it.x,it.y,it.z,$e.x,$e.y,$e.z,et.x,et.y,et.z,it.x,it.y,it.z,et.x,et.y,et.z,Oe.x,Oe.y,Oe.z,it.x,it.y,it.z]);yt.setAttribute("position",new Ee.THS(sn,3)),yt.computeVertexNormals(),yt.lookAt(ie),yt.computeVertexNormals();for(let tn=0;tn<sn.length;tn+=3)sn[tn]=sn[tn]+O.x,sn[tn+1]=sn[tn+1]+O.y,sn[tn+2]=sn[tn+2]+O.z;return yt}function K(oe){if(!oe)return 0;if(oe instanceof De)return oe.tree.numPolygons();if(oe.polygons)return oe.polygons.length;const D=oe.getAttribute("position");return D?.count?Math.round(D.count/3):0}function ye(oe,D,O,ie,_e){oe.boundingBox||oe.computeBoundingBox();const Oe=oe.boundingBox.clone();if(Oe.applyMatrix4(D),ie||(ie=0),Oe.min[O]>=ie&&Oe.max[O]>=ie||Oe.min[O]<=ie&&Oe.max[O]<=ie)return null;const $e=new De(oe,D,0,_e),et=2*Math.max(Math.abs(Oe.min.x),Math.abs(Oe.max.x)),it=2*Math.max(Math.abs(Oe.min.y),Math.abs(Oe.max.y)),yt=2*Math.max(Math.abs(Oe.min.z),Math.abs(Oe.max.z));let sn=1e4;switch(O){case"x":sn=Math.max(it,yt);break;case"y":sn=Math.max(et,yt);break;case"z":sn=Math.max(et,it)}const tn=function F(oe,D,O){let ie;switch((!O||O<1e4)&&(O=1e4),oe){case"x":ie=[new Ze(D,-3*O,O,1,0,0),new Ze(D,O,-3*O,1,0,0),new Ze(D,O,O,1,0,0)];break;case"y":ie=[new Ze(-3*O,D,O,0,1,0),new Ze(O,D,O,0,1,0),new Ze(O,D,-3*O,0,1,0)];break;default:ie=[new Ze(-3*O,O,D,0,0,1),new Ze(O,-3*O,D,0,0,1),new Ze(O,O,D,0,0,1)]}const _e=new He([new Re(ie)]);return new De(_e)}(O,ie,sn);return $e.cut_from_plane(tn),tn.toBufferGeometry()}function Pe(oe,D){void 0===D&&(D=0);try{switch(oe._typename){case B:return function Yt(oe,D){if(D<0)return 12;const O=oe.fDX,ie=oe.fDY,_e=oe.fDZ,Oe=D?new vt:new st(12);return Oe.addFace4(O,ie,_e,O,-ie,_e,O,-ie,-_e,O,ie,-_e),Oe.setNormal(1,0,0),Oe.addFace4(-O,ie,-_e,-O,-ie,-_e,-O,-ie,_e,-O,ie,_e),Oe.setNormal(-1,0,0),Oe.addFace4(-O,ie,-_e,-O,ie,_e,O,ie,_e,O,ie,-_e),Oe.setNormal(0,1,0),Oe.addFace4(-O,-ie,_e,-O,-ie,-_e,O,-ie,-_e,O,-ie,_e),Oe.setNormal(0,-1,0),Oe.addFace4(-O,ie,_e,-O,-ie,_e,O,-ie,_e,O,ie,_e),Oe.setNormal(0,0,1),Oe.addFace4(O,ie,-_e,O,-ie,-_e,-O,-ie,-_e,-O,ie,-_e),Oe.setNormal(0,0,-1),Oe.create()}(oe,D);case U:return function Ot(oe,D){if(D<0)return 12;const O=oe.fTxy,ie=oe.fTxz,_e=oe.fTyz;return qt([-oe.fZ*ie-O*oe.fY-oe.fX,-oe.fY-oe.fZ*_e,-oe.fZ,-oe.fZ*ie+O*oe.fY-oe.fX,oe.fY-oe.fZ*_e,-oe.fZ,-oe.fZ*ie+O*oe.fY+oe.fX,oe.fY-oe.fZ*_e,-oe.fZ,-oe.fZ*ie-O*oe.fY+oe.fX,-oe.fY-oe.fZ*_e,-oe.fZ,oe.fZ*ie-O*oe.fY-oe.fX,oe.fZ*_e-oe.fY,oe.fZ,oe.fZ*ie+O*oe.fY-oe.fX,oe.fY+oe.fZ*_e,oe.fZ,oe.fZ*ie+O*oe.fY+oe.fX,oe.fY+oe.fZ*_e,oe.fZ,oe.fZ*ie-O*oe.fY+oe.fX,oe.fZ*_e-oe.fY,oe.fZ],D)}(oe,D);case C:case I:return function Bn(oe,D){if(D<0)return 12;let O,ie;return oe._typename===C?O=ie=oe.fDY:(O=oe.fDy1,ie=oe.fDy2),qt([-oe.fDx1,O,-oe.fDZ,oe.fDx1,O,-oe.fDZ,oe.fDx1,-O,-oe.fDZ,-oe.fDx1,-O,-oe.fDZ,-oe.fDx2,ie,oe.fDZ,oe.fDx2,ie,oe.fDZ,oe.fDx2,-ie,oe.fDZ,-oe.fDx2,-ie,oe.fDZ],D)}(oe,D);case $:case T:case z:return function Mn(oe,D){if(D<0)return 12;const O=[oe.fXY[0][0],oe.fXY[0][1],-oe.fDZ,oe.fXY[1][0],oe.fXY[1][1],-oe.fDZ,oe.fXY[2][0],oe.fXY[2][1],-oe.fDZ,oe.fXY[3][0],oe.fXY[3][1],-oe.fDZ,oe.fXY[4][0],oe.fXY[4][1],oe.fDZ,oe.fXY[5][0],oe.fXY[5][1],oe.fDZ,oe.fXY[6][0],oe.fXY[6][1],oe.fDZ,oe.fXY[7][0],oe.fXY[7][1],oe.fDZ],ie=[4,7,6,6,5,4,3,7,4,4,0,3,5,1,0,0,4,5,6,2,1,1,5,6,7,3,2,2,6,7,1,2,3,3,0,1];for(let et=0;et<O.length;et+=O.length/2)for(let it=et;it<et+O.length/2-3;it+=3)for(let yt=it+3;yt<et+O.length/2;yt+=3)if(O[it]===O[yt]&&O[it+1]===O[yt+1]&&O[it+2]===O[yt+2])for(let sn=0;sn<ie.length;++sn)ie[sn]===yt/3&&(ie[sn]=it/3);const _e=[];let Oe=0;for(let et=0;et<ie.length;et+=3){const it=100*ie[et]+10*ie[et+1]+ie[et+2],yt=100*ie[et+1]+10*ie[et+2]+ie[et],sn=100*ie[et+2]+10*ie[et]+ie[et+1];ie[et]===ie[et+1]||ie[et]===ie[et+2]||ie[et+1]===ie[et+2]||_e.indexOf(it)>=0||_e.indexOf(yt)>=0||_e.indexOf(sn)>=0?ie[et]=ie[et+1]=ie[et+2]=-1:(_e.push(it,yt,sn),Oe++)}const $e=D?new vt:new st(Oe);for(let et=0;et<ie.length;et+=6){const it=3*ie[et],yt=3*ie[et+1],sn=3*ie[et+2],tn=3*ie[et+3],xn=3*ie[et+4],wn=3*ie[et+5];let Ut=null;if(it>=0&&tn>=0&&D)if(0===et)Ut=new Ee.Pq0(0,0,1);else if(30===et)Ut=new Ee.Pq0(0,0,-1);else{const Qe=pt(O[it],O[it+1],O[it+2],O[yt],O[yt+1],O[yt+2],O[sn],O[sn+1],O[sn+2]);Qe.normalize();const nt=pt(O[tn],O[tn+1],O[tn+2],O[xn],O[xn+1],O[xn+2],O[wn],O[wn+1],O[wn+2]);nt.normalize(),Qe.distanceToSquared(nt)<1e-12&&(Ut=Qe)}null!==Ut?($e.addFace4(O[it],O[it+1],O[it+2],O[yt],O[yt+1],O[yt+2],O[sn],O[sn+1],O[sn+2],O[xn],O[xn+1],O[xn+2]),$e.setNormal(Ut.x,Ut.y,Ut.z)):(it>=0&&($e.addFace3(O[it],O[it+1],O[it+2],O[yt],O[yt+1],O[yt+2],O[sn],O[sn+1],O[sn+2]),$e.calcNormal()),tn>=0&&($e.addFace3(O[tn],O[tn+1],O[tn+2],O[xn],O[xn+1],O[xn+2],O[wn],O[wn+1],O[wn+2]),$e.calcNormal()))}return $e.create()}(oe,D);case G:return function bn(oe,D){const O=[oe.fRmax,oe.fRmin],ie=oe.fPhi1,_e=oe.fPhi2-oe.fPhi1,Oe=oe.fTheta1,$e=oe.fTheta2-oe.fTheta1,et=O[1]<=0;let it=oe.fNseg,yt=oe.fNz;if(D>0){const en=(et?2:4)*it*yt/D;en>1&&(it=Math.max(4,Math.floor(it/Math.sqrt(en))),yt=Math.max(4,Math.floor(yt/Math.sqrt(en))))}let sn=it*yt*2,tn=it*(et?1:2),xn=it*(et?1:2);const wn=360===_e?0:yt*(et?2:4),Ut=1e-10;if(D<0)return sn*(et?1:2)+tn+xn+wn;const Qe=new Float32Array(it+1),nt=new Float32Array(it+1),at=new Float32Array(yt+1),ht=new Float32Array(yt+1);for(let en=0;en<=yt;++en){const jt=(Oe+$e/yt*en)*Math.PI/180;at[en]=Math.sin(jt),ht[en]=Math.cos(jt)}for(let en=0;en<=it;++en){const jt=(ie+_e/it*en)*Math.PI/180;Qe[en]=Math.sin(jt),nt[en]=Math.cos(jt)}Math.abs(at[0])<=Ut&&(sn-=it,tn=0),Math.abs(at[yt])<=Ut&&(sn-=it,xn=0);const Qt=sn*(et?1:2)+tn+xn+wn,vn=D?new vt:new st(Qt);for(let en=0;en<2&&(1!==en||!et);++en){const jt=O[en],fn=0===en?1:-1,Gn=1-en,qn=1-Gn;for(let Vi=0;Vi<yt;++Vi){const _r=Vi+Gn,Ni=Vi+qn;let Kr=0;Math.abs(at[_r])<=Ut?Kr=1:Math.abs(at[Ni])<=Ut&&(Kr=2);for(let os=0;os<it;++os)vn.addFace4(jt*at[_r]*nt[os],jt*at[_r]*Qe[os],jt*ht[_r],jt*at[_r]*nt[os+1],jt*at[_r]*Qe[os+1],jt*ht[_r],jt*at[Ni]*nt[os+1],jt*at[Ni]*Qe[os+1],jt*ht[Ni],jt*at[Ni]*nt[os],jt*at[Ni]*Qe[os],jt*ht[Ni],Kr),vn.setNormal4(fn*at[_r]*nt[os],fn*at[_r]*Qe[os],fn*ht[_r],fn*at[_r]*nt[os+1],fn*at[_r]*Qe[os+1],fn*ht[_r],fn*at[Ni]*nt[os+1],fn*at[Ni]*Qe[os+1],fn*ht[Ni],fn*at[Ni]*nt[os],fn*at[Ni]*Qe[os],fn*ht[Ni],Kr)}}for(let en=0;en<=yt;en+=yt)if(Math.abs(at[en])>=Ut){const jt=at[en],fn=ht[en],Gn=0===en?0:1,qn=1-Gn;for(let Vi=0;Vi<it;++Vi)vn.addFace4(O[1]*jt*nt[Vi+Gn],O[1]*jt*Qe[Vi+Gn],O[1]*fn,O[0]*jt*nt[Vi+Gn],O[0]*jt*Qe[Vi+Gn],O[0]*fn,O[0]*jt*nt[Vi+qn],O[0]*jt*Qe[Vi+qn],O[0]*fn,O[1]*jt*nt[Vi+qn],O[1]*jt*Qe[Vi+qn],O[1]*fn,et?2:0),vn.calcNormal()}if(_e<360)for(let en=0;en<=it;en+=it){const jt=Qe[en],fn=nt[en],Gn=0===en?1:0,qn=1-Gn;for(let Vi=0;Vi<yt;++Vi)vn.addFace4(O[1]*at[Vi+Gn]*fn,O[1]*at[Vi+Gn]*jt,O[1]*ht[Vi+Gn],O[0]*at[Vi+Gn]*fn,O[0]*at[Vi+Gn]*jt,O[0]*ht[Vi+Gn],O[0]*at[Vi+qn]*fn,O[0]*at[Vi+qn]*jt,O[0]*ht[Vi+qn],O[1]*at[Vi+qn]*fn,O[1]*at[Vi+qn]*jt,O[1]*ht[Vi+qn],et?2:0),vn.calcNormal()}return vn.create()}(oe,D);case A:case E:case g:case v:case f:return Dn(oe,D);case W:return function $n(oe,D){const O=Math.max(4,Math.round(360/J.GradPerSegm));if(D<0)return 4*O;const ie=new Float32Array(O+1),_e=new Float32Array(O+1);for(let sn=0;sn<=O;++sn){const tn=sn/O*2*Math.PI;ie[sn]=oe.fRmin*Math.cos(tn),_e[sn]=oe.fRmax*Math.sin(tn)}const Oe=D?new vt:new st(4*O);let $e,et,it=1,yt=0;for(let sn=0;sn<O;++sn){Oe.addFace4(ie[sn],_e[sn],+oe.fDZ,ie[sn],_e[sn],-oe.fDZ,ie[sn+1],_e[sn+1],-oe.fDZ,ie[sn+1],_e[sn+1],oe.fDZ),$e=it,et=yt,it=ie[sn+1]*oe.fRmax/oe.fRmin,yt=_e[sn+1]*oe.fRmin/oe.fRmax;const tn=Math.sqrt(it**2+yt**2);it/=tn,yt/=tn,Oe.setNormal_12_34($e,et,0,it,yt,0)}for(let sn=0;sn<2;++sn){const tn=0===sn?1:-1,xn=sn,wn=1-sn;for(let Ut=0;Ut<O;++Ut)Oe.addFace3(0,0,tn*oe.fDZ,ie[Ut+xn],_e[Ut+xn],tn*oe.fDZ,ie[Ut+wn],_e[Ut+wn],tn*oe.fDZ),Oe.setNormal(0,0,tn)}return Oe.create()}(oe,D);case b:return function Cn(oe,D){const O=oe.fR;let ie=Math.max(6,Math.round(360/J.GradPerSegm)),_e=Math.max(8,Math.round(oe.fDphi/J.GradPerSegm)),Oe=(oe.fRmin>0?4:2)*ie*(_e+(360!==oe.fDphi?1:0));if(D<0)return Oe;D>0&&Oe>D&&(ie=Math.floor(ie/Math.sqrt(Oe/D)),_e=Math.floor(_e/Math.sqrt(Oe/D)),Oe=(oe.fRmin>0?4:2)*ie*(_e+(360!==oe.fDphi?1:0)));const $e=new Float32Array(ie+1),et=new Float32Array(ie+1),it=new Float32Array(_e+1),yt=new Float32Array(_e+1);for(let en=0;en<=ie;++en)$e[en]=Math.sin(en/ie*2*Math.PI),et[en]=Math.cos(en/ie*2*Math.PI);for(let en=0;en<=_e;++en){const jt=(oe.fPhi1+oe.fDphi*en/_e)/180*Math.PI;it[en]=Math.sin(jt),yt[en]=Math.cos(jt)}const sn=D?new vt:new st(Oe),tn=new Ee.Pq0,xn=new Ee.Pq0,wn=new Ee.Pq0,Ut=new Ee.Pq0,Qe=new Ee.Pq0,nt=new Ee.Pq0,at=new Ee.Pq0,ht=new Ee.Pq0,Qt=new Ee.Pq0,vn=new Ee.Pq0;for(let en=0;en<2&&!(en>0&&oe.fRmin<=0);++en){const jt=en>0?oe.fRmin:oe.fRmax,fn=1-en,Gn=1-fn,qn=en>0?-1:1;for(let Vi=0;Vi<_e;++Vi){const _r=Vi+fn,Ni=Vi+Gn;Qt.x=O*yt[_r],Qt.y=O*it[_r],vn.x=O*yt[Ni],vn.y=O*it[Ni];for(let Kr=0;Kr<ie;++Kr)tn.x=(O+jt*et[Kr])*yt[_r],tn.y=(O+jt*et[Kr])*it[_r],tn.z=jt*$e[Kr],xn.x=(O+jt*et[Kr+1])*yt[_r],xn.y=(O+jt*et[Kr+1])*it[_r],xn.z=jt*$e[Kr+1],wn.x=(O+jt*et[Kr+1])*yt[Ni],wn.y=(O+jt*et[Kr+1])*it[Ni],wn.z=jt*$e[Kr+1],Ut.x=(O+jt*et[Kr])*yt[Ni],Ut.y=(O+jt*et[Kr])*it[Ni],Ut.z=jt*$e[Kr],sn.addFace4(tn.x,tn.y,tn.z,xn.x,xn.y,xn.z,wn.x,wn.y,wn.z,Ut.x,Ut.y,Ut.z),Qe.subVectors(tn,Qt).normalize(),nt.subVectors(xn,Qt).normalize(),at.subVectors(wn,vn).normalize(),ht.subVectors(Ut,vn).normalize(),sn.setNormal4(qn*Qe.x,qn*Qe.y,qn*Qe.z,qn*nt.x,qn*nt.y,qn*nt.z,qn*at.x,qn*at.y,qn*at.z,qn*ht.x,qn*ht.y,qn*ht.z)}}if(360!==oe.fDphi)for(let en=0;en<=_e;en+=_e){const jt=oe.fRmax,fn=oe.fRmin,Gn=en>0?0:1,qn=1-Gn,Vi=oe.fRmin>0?0:1,_r=en>0?1:-1;for(let Ni=0;Ni<ie;++Ni)sn.addFace4((O+jt*et[Ni+Gn])*yt[en],(O+jt*et[Ni+Gn])*it[en],jt*$e[Ni+Gn],(O+fn*et[Ni+Gn])*yt[en],(O+fn*et[Ni+Gn])*it[en],fn*$e[Ni+Gn],(O+fn*et[Ni+qn])*yt[en],(O+fn*et[Ni+qn])*it[en],fn*$e[Ni+qn],(O+jt*et[Ni+qn])*yt[en],(O+jt*et[Ni+qn])*it[en],jt*$e[Ni+qn],Vi),sn.setNormal(-_r*it[en],_r*yt[en],0)}return sn.create()}(oe,D);case Z:case ee:return function yn(oe,D){const O=oe.fPhi1,ie=oe.fDphi;let _e,Oe;oe._typename===ee?(_e=oe.fNedges,Oe=1/Math.cos(Math.PI/180*ie/_e/2)):(_e=Math.max(5,Math.round(ie/J.GradPerSegm)),Oe=1);const $e=new Int16Array(2*oe.fNz);let et=0,it=!1;for(let at=0;at<oe.fNz;++at)oe.fRmin[at]>0&&(it=!0);if(D<0)return(it?4:2)*_e*(oe.fNz-1);const yt=360===ie?null:[];for(let at=0;at<2;++at){const ht=0===at?"fRmax":"fRmin";for(let Qt=0;Qt<oe.fNz;++Qt){const vn=oe.fZ[Qt],en=oe[ht][Qt];$e[2*Qt+at]=0,!(Qt>0&&Qt<oe.fNz-1&&(oe.fZ[Qt-1]===vn&&oe[ht][Qt-1]===en||oe[ht][Qt+1]===en&&oe[ht][Qt-1]===en))&&(Qt>0&&(0===at||it)&&($e[2*Qt+at]=1,et++),null!==yt&&(0===at?yt.push(new Ee.I9Y(Oe*en,vn)):en<oe.fRmax[Qt]&&yt.unshift(new Ee.I9Y(Oe*en,vn))))}}let sn=et*_e*2;oe.fRmin[0]!==oe.fRmax[0]&&(sn+=_e*(it?2:1)),oe.fRmin[oe.fNz-1]!==oe.fRmax[oe.fNz-1]&&(sn+=_e*(it?2:1));let tn=null;if(null!==yt){if(yt.length===2*oe.fNz){tn=[];for(let at=oe.fNz-1;at>0;--at){if(oe.fZ[at]===oe.fZ[at-1])continue;const ht=2*oe.fNz-1-at;tn.push([ht,at-1,at]),tn.push([ht,ht+1,at-1])}}else tn=Ee.xJ6.triangulateShape(yt,[]);sn+=2*tn.length}const xn=O*Math.PI/180,wn=ie/_e*Math.PI/180,Ut=new Float32Array(_e+1),Qe=new Float32Array(_e+1);for(let at=0;at<=_e;++at)Qe[at]=Math.cos(xn+at*wn),Ut[at]=Math.sin(xn+at*wn);const nt=D?new vt:new st(sn);for(let at=0;at<2;++at){const ht=0===at?"fRmax":"fRmin",Qt=1-at,vn=at;let en=oe.fZ[0],jt=Oe*oe[ht][0];for(let fn=0;fn<oe.fNz;++fn){if(0===$e[2*fn+at])continue;const Gn=oe.fZ[fn],qn=Oe*oe[ht][fn];let Vi=1,_r=0;if(qn!==jt){const Ni=Math.atan2(qn-jt,Gn-en);Vi=Math.cos(Ni),_r=Math.sin(Ni)}at>0&&(Vi*=-1,_r*=-1);for(let Ni=0;Ni<_e;++Ni)nt.addFace4(jt*Qe[Ni+Qt],jt*Ut[Ni+Qt],en,qn*Qe[Ni+Qt],qn*Ut[Ni+Qt],Gn,qn*Qe[Ni+vn],qn*Ut[Ni+vn],Gn,jt*Qe[Ni+vn],jt*Ut[Ni+vn],en),nt.setNormal_12_34(Vi*Qe[Ni+Qt],Vi*Ut[Ni+Qt],_r,Vi*Qe[Ni+vn],Vi*Ut[Ni+vn],_r);en=Gn,jt=qn}}for(let at=0;at<oe.fNz;at+=oe.fNz-1){const ht=Oe*oe.fRmin[at],Qt=Oe*oe.fRmax[at];if(ht===Qt)continue;const vn=oe.fZ[at],en=0===at?1:0,jt=1-en,fn=0===at?-1:1;!it&&!tn&&nt.startPolygon(at>0);for(let Gn=0;Gn<_e;++Gn)nt.addFace4(ht*Qe[Gn+en],ht*Ut[Gn+en],vn,Qt*Qe[Gn+en],Qt*Ut[Gn+en],vn,Qt*Qe[Gn+jt],Qt*Ut[Gn+jt],vn,ht*Qe[Gn+jt],ht*Ut[Gn+jt],vn,it?0:2),nt.setNormal(0,0,fn);nt.stopPolygon()}if(tn)for(let at=0;at<=_e;at+=_e){const ht=0===at?1:2,Qt=3-ht;for(let vn=0;vn<tn.length;++vn){const en=yt[tn[vn][0]],jt=yt[tn[vn][ht]],fn=yt[tn[vn][Qt]];nt.addFace3(en.x*Qe[at],en.x*Ut[at],en.y,jt.x*Qe[at],jt.x*Ut[at],jt.y,fn.x*Qe[at],fn.x*Ut[at],fn.y),nt.calcNormal()}}return nt.create()}(oe,D);case P:return function Sn(oe,D){let O=(oe.fNz-1)*oe.fNvert*2;if(D<0)return O+3*oe.fNvert;const ie=[];for(let $e=0;$e<oe.fNvert;++$e)ie.push(new Ee.I9Y(oe.fX[$e],oe.fY[$e]));let _e=Ee.xJ6.triangulateShape(ie,[]);_e.length<ie.length-2?(tt(`Problem with XTRU shape ${oe.fName} with ${ie.length} vertices`),_e=[]):O+=2*_e.length;const Oe=D?new vt:new st(O);for(let $e=0;$e<oe.fNz-1;++$e){const et=oe.fZ[$e],it=oe.fScale[$e],yt=oe.fZ[$e+1],sn=oe.fScale[$e+1],tn=oe.fX0[$e],xn=oe.fX0[$e+1],wn=oe.fY0[$e],Ut=oe.fY0[$e+1];for(let Qe=0;Qe<oe.fNvert;++Qe){const nt=(Qe+1)%oe.fNvert;Oe.addFace4(it*oe.fX[Qe]+tn,it*oe.fY[Qe]+wn,et,sn*oe.fX[Qe]+xn,sn*oe.fY[Qe]+Ut,yt,sn*oe.fX[nt]+xn,sn*oe.fY[nt]+Ut,yt,it*oe.fX[nt]+tn,it*oe.fY[nt]+wn,et),Oe.calcNormal()}}for(let $e=0;$e<=oe.fNz-1;$e+=oe.fNz-1){const et=oe.fZ[$e],it=oe.fScale[$e],yt=oe.fX0[$e],sn=oe.fY0[$e];for(let tn=0;tn<_e.length;++tn){const xn=_e[tn],wn=ie[xn[0]],Ut=ie[xn[0===$e?2:1]],Qe=ie[xn[0===$e?1:2]];Oe.addFace3(it*wn.x+yt,it*wn.y+sn,et,it*Ut.x+yt,it*Ut.y+sn,et,it*Qe.x+yt,it*Qe.y+sn,et),Oe.setNormal(0,0,0===$e?-1:1)}}return Oe.create()}(oe,D);case k:return function ii(oe,D){let O=Math.max(4,Math.round(360/J.GradPerSegm)),ie=30;if(D>0){const ht=2*O*(ie+1)/D;ht>1&&(O=Math.max(5,Math.floor(O/Math.sqrt(ht))),ie=Math.max(5,Math.floor(ie/Math.sqrt(ht))))}const _e=oe.fRlo,Oe=oe.fRhi;let $e=(ie+1)*O*2;if(0===_e&&($e-=2*O),0===Oe&&($e-=2*O),D<0)return $e;let et=-oe.fDZ,it=oe.fDZ;oe.fA>=0?oe.fB>et&&(et=oe.fB):oe.fB<it&&(it=oe.fB);const yt=Math.atan2(et,_e),sn=Math.atan2(it,Oe),tn=new Float32Array(O+1),xn=new Float32Array(O+1);for(let ht=0;ht<=O;++ht)xn[ht]=Math.cos(ht/O*2*Math.PI),tn[ht]=Math.sin(ht/O*2*Math.PI);const wn=D?new vt:new st($e);let Ut=et,Qe=0,nt=0,at=-1;for(let ht=0;ht<=ie+1;++ht){let Qt=0,vn=0,en=0,jt=-1;if(0===ht&&0===_e)continue;if(ht===ie+1&&0===Qe)break;switch(ht){case 0:Qt=et,vn=_e;break;case ie:Qt=it,vn=Oe;break;case ie+1:Qt=it,vn=0;break;default:{const Gn=Math.tan(yt+(sn-yt)*ht/ie);vn=.5*(Gn+Math.sqrt(Gn**2-4*oe.fA*oe.fB))/oe.fA,vn<1e-6&&(vn=0),Qt=vn*Gn}}en=oe.fA*vn,jt=oe.fA>0?-1:1;const fn=0===Qe?1:0===vn?2:0;for(let Gn=0;Gn<O;++Gn)wn.addFace4(vn*xn[Gn],vn*tn[Gn],Qt,Qe*xn[Gn],Qe*tn[Gn],Ut,Qe*xn[Gn+1],Qe*tn[Gn+1],Ut,vn*xn[Gn+1],vn*tn[Gn+1],Qt,fn),0===fn||1===ht&&0===_e||ht===ie+1&&0===Oe?wn.setNormal4(en*xn[Gn],en*tn[Gn],jt,nt*xn[Gn],nt*tn[Gn],at,nt*xn[Gn+1],nt*tn[Gn+1],at,en*xn[Gn+1],en*tn[Gn+1],jt,fn):wn.setNormal(0,0,ht<ie?-1:1);Ut=Qt,Qe=vn,nt=en,at=jt}return wn.create()}(oe,D);case fe:return function ai(oe,D){if(0===oe.fTin&&0===oe.fTout)return Dn(oe,D);let O=Math.max(4,Math.round(360/J.GradPerSegm)),ie=30,_e=O*(ie+1)*(oe.fRmin>0?4:2);if(D<0)return _e;D>0&&D>_e&&(O=Math.max(4,Math.floor(O/Math.sqrt(_e/D))),ie=Math.max(4,Math.floor(ie/Math.sqrt(_e/D))),_e=O*(ie+1)*(oe.fRmin>0?4:2));const Oe=new Float32Array(O+1),$e=new Float32Array(O+1);for(let it=0;it<=O;++it)$e[it]=Math.cos(it/O*2*Math.PI),Oe[it]=Math.sin(it/O*2*Math.PI);const et=D?new vt:new st(_e);for(let it=0;it<2&&!(it>0&&oe.fRmin<=0);++it){const yt=it>0?oe.fRmin:oe.fRmax,sn=it>0?oe.fTinsq:oe.fToutsq,tn=1-it,xn=1-tn;for(let wn=0;wn<ie;++wn){const Ut=wn/ie*2*oe.fDz-oe.fDz,Qe=(wn+1)/ie*2*oe.fDz-oe.fDz,nt=Math.sqrt(yt**2+sn*Ut**2),at=Math.sqrt(yt**2+sn*Qe**2);for(let ht=0;ht<O;++ht)et.addFace4(nt*$e[ht+tn],nt*Oe[ht+tn],Ut,at*$e[ht+tn],at*Oe[ht+tn],Qe,at*$e[ht+xn],at*Oe[ht+xn],Qe,nt*$e[ht+xn],nt*Oe[ht+xn],Ut),et.calcNormal()}}for(let it=0;it<2;++it){const yt=0===it?oe.fDz:-oe.fDz,sn=Math.sqrt(oe.fRmax**2+oe.fToutsq*yt**2),tn=oe.fRmin>0?Math.sqrt(oe.fRmin**2+oe.fTinsq*yt**2):0,xn=oe.fRmin>0?0:1,wn=1-it,Ut=1-wn;for(let Qe=0;Qe<O;++Qe)et.addFace4(sn*$e[Qe+wn],sn*Oe[Qe+wn],yt,tn*$e[Qe+wn],tn*Oe[Qe+wn],yt,tn*$e[Qe+Ut],tn*Oe[Qe+Ut],yt,sn*$e[Qe+Ut],sn*Oe[Qe+Ut],yt,xn),et.setNormal(0,0,0===it?1:-1)}return et.create()}(oe,D);case"TGeoTessellated":return function Hi(oe,D){let O=0;for(let _e=0;_e<oe.fFacets.length;++_e)O+=4===oe.fFacets[_e].fNvert?2:1;if(D<0)return O;const ie=D?new vt:new st(O);for(let _e=0;_e<oe.fFacets.length;++_e){const Oe=oe.fFacets[_e],$e=oe.fVertices[Oe.fIvert[0]].fVec,et=oe.fVertices[Oe.fIvert[1]].fVec,it=oe.fVertices[Oe.fIvert[2]].fVec;if(4===Oe.fNvert){const yt=oe.fVertices[Oe.fIvert[3]].fVec;ie.addFace4($e[0],$e[1],$e[2],et[0],et[1],et[2],it[0],it[1],it[2],yt[0],yt[1],yt[2]),ie.calcNormal()}else ie.addFace3($e[0],$e[1],$e[2],et[0],et[1],et[2],it[0],it[1],it[2]),ie.calcNormal()}return ie.create()}(oe,D);case we:return function ge(oe,D){if(D<0)return Pe(oe.fNode.fLeft,-1)+Pe(oe.fNode.fRight,-1);let O,ie,_e=!1;const Oe=ti(oe.fNode.fLeftMat),$e=ti(oe.fNode.fRightMat);if(0===D?D=4e3:_e=!0,Oe&&Oe.determinant()<-.9&&tt("Axis reflection in left composite shape - not supported"),$e&&$e.determinant()<-.9&&tt("Axis reflections in right composite shape - not supported"),O=oe.fNode.fLeft._typename===Me?xt(oe.fNode.fLeft):Pe(oe.fNode.fLeft,D),!O)return null;let et=K(O),it=0;if(O._exceed_limit&&(et+=D),et<D&&(ie=oe.fNode.fRight._typename===Me?xt(oe.fNode.fRight,O):Pe(oe.fNode.fRight,D),it=K(ie)),et+it>=D||!ie)return O.polygons&&(O=Ve(O.polygons)),Oe&&O.applyMatrix4(Oe),O._exceed_limit=!0,O;let yt=new De(O,Oe,J.CompressComp?0:void 0);const sn=new De(ie,$e,yt.maxid);switch(yt.maxid=sn.maxid,oe.fNode._typename){case"TGeoIntersection":yt.direct_intersect(sn);break;case"TGeoUnion":yt.direct_union(sn);break;case"TGeoSubtraction":yt.direct_subtract(sn);break;default:tt("unsupported bool operation "+oe.fNode._typename+", use first geom")}return 0===K(yt)&&(tt(`Zero faces in comp shape left: ${oe.fNode.fLeft._typename} ${K(O)} faces right: ${oe.fNode.fRight._typename} ${K(ie)} faces  use first`),yt=new De(O,Oe)),_e?{polygons:yt.toPolygons()}:yt.toBufferGeometry()}(oe,D);case he:break;case je:{const O=Pe(oe.fShape,D);return oe.fScale&&D>=0&&(0,x.isFunc)(O?.scale)&&O.scale(oe.fScale.fScale[0],oe.fScale.fScale[1],oe.fScale.fScale[2]),O}case Me:if(D<0)return 1;default:tt(`unsupported shape type ${oe._typename}`)}}catch(O){let ie="";void 0!==O.stack&&(ie=O.stack.split("\n")[0],ie=ie.indexOf(O.message)>=0?O.stack.split("\n")[1]:"at: "+ie),tt(`${oe._typename} err: ${O.message} ${ie}`)}return D<0?0:null}function Nt(oe,D){if(oe.server_shape&&(oe.nsegm===D||!oe.shape))return oe.server_shape;oe.nsegm=D;let O=null;if(oe.shape)O=Pe(oe.shape);else{if(!oe.raw?.buffer)return console.error("No raw data at all"),null;O=oe.sz?function At(oe){let D=0;if(oe.sz[0]&&(oe.vtxBuff=new Float32Array(oe.raw.buffer,D,oe.sz[0]),D+=4*oe.sz[0]),oe.sz[1]&&(D+=4*oe.sz[1]),oe.sz[2]&&(oe.prefixBuf=new Uint32Array(oe.raw.buffer,D,2),D+=8,oe.idxBuff=new Uint32Array(oe.raw.buffer,D,oe.sz[2]-2)),4!==oe.prefixBuf[0])throw Error("Expect triangles first.");if(oe.idxBuff.length!==3*oe.prefixBuf[1])throw Error("Expect single list of triangles in index buffer.");const _e=new Ee.LoY;return _e.setAttribute("position",new Ee.THS(oe.vtxBuff,3)),_e.setIndex(new Ee.THS(oe.idxBuff,1)),_e.computeVertexNormals(),_e}(oe):function Vt(oe){const D=new Float32Array(oe.raw.buffer,0,oe.raw.buffer.byteLength/4),O=new Ee.LoY;return O.setAttribute("position",new Ee.THS(D,3)),O.setIndex(new Ee.THS(new Uint32Array(oe.idx),1)),O.computeVertexNormals(),O}(oe)}return{_typename:"$$Shape$$",ready:!0,geom:O,nfaces:ss(O)}}function nn(oe){let D=[],O=null;if(void 0!==oe.fVolume?O=oe.fVolume.fShape:void 0!==oe.fShape?O=oe.fShape:void 0!==oe.fShapeBits&&void 0!==oe.fShapeId&&(O=oe),!O)return D.push(oe._typename),D;const ie=Math.max(O.fDX,O.fDY,O.fDZ),_e=ie>1e7||ie<1e-7,Oe=$e=>void 0===$e?"???":$e===Math.round($e)&&$e<1e7?Math.round($e):_e?$e.toExponential(4):$e.toPrecision(7);switch(D.push(O._typename),D.push(`DX=${Oe(O.fDX)} DY=${Oe(O.fDY)} DZ=${Oe(O.fDZ)}`),O._typename){case B:break;case U:D.push(`Alpha=${O.fAlpha} Phi=${O.fPhi} Theta=${O.fTheta}`);break;case I:D.push(`Dy1=${Oe(O.fDy1)} Dy2=${Oe(O.fDy1)}`);case C:D.push(`Dx1=${Oe(O.fDx1)} Dx2=${Oe(O.fDx1)}`);break;case $:case T:case z:break;case G:D.push(`Rmin=${Oe(O.fRmin)} Rmax=${Oe(O.fRmax)}`,`Phi1=${O.fPhi1} Phi2=${O.fPhi2}`,`Theta1=${O.fTheta1} Theta2=${O.fTheta2}`);break;case E:D.push(`Phi1=${O.fPhi1} Phi2=${O.fPhi2}`);case A:D.push(`Rmin1=${Oe(O.fRmin1)} Rmax1=${Oe(O.fRmax1)}`,`Rmin2=${Oe(O.fRmin2)} Rmax2=${Oe(O.fRmax2)}`);break;case f:case v:D.push(`Phi1=${O.fPhi1} Phi2=${O.fPhi2}`);case W:case g:D.push(`Rmin=${Oe(O.fRmin)} Rmax=${Oe(O.fRmax)}`);break;case b:D.push(`Rmin=${Oe(O.fRmin)} Rmax=${Oe(O.fRmax)}`,`Phi1=${O.fPhi1} Dphi=${O.fDphi}`);break;case Z:case ee:case P:break;case k:D.push(`Rlo=${Oe(O.fRlo)} Rhi=${Oe(O.fRhi)}`,`A=${Oe(O.fA)} B=${Oe(O.fB)}`);break;case fe:D.push(`Rmin=${Oe(O.fRmin)} Rmax=${Oe(O.fRmax)}`,`StIn=${Oe(O.fStIn)} StOut=${Oe(O.fStOut)}`);break;case we:case he:break;case je:D=nn(O.fShape),O.fScale&&D.unshift(`Scale X=${O.fScale.fScale[0]} Y=${O.fScale.fScale[1]} Z=${O.fScale.fScale[2]}`)}return D}function hn(oe){const D=new Ee.kn4;return oe.updateMatrixWorld(),oe.matrixWorldInverse.copy(oe.matrixWorld).invert(),D.multiplyMatrices(oe.projectionMatrix,oe.matrixWorldInverse),D}function kn(oe){if(!oe)return null;oe instanceof Ee.ubm&&(oe=hn(oe));const D=new Ee.PPD;return D.setFromProjectionMatrix(oe),D.corners=new Float32Array([1,1,1,1,1,-1,1,-1,1,1,-1,-1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,-1,0,0,0]),D.test=new Ee.Pq0(0,0,0),D.CheckShape=function(O,ie){const _e=this.test,Oe=this.corners.length,$e=this.corners;for(let et=0;et<Oe;et+=3)if(_e.x=$e[et]*ie.fDX,_e.y=$e[et+1]*ie.fDY,_e.z=$e[et+2]*ie.fDZ,this.containsPoint(_e.applyMatrix4(O)))return!0;return!1},D.CheckBox=function(O){const ie=this.test;let _e=0;return ie.set(O.min.x,O.min.y,O.min.z),this.containsPoint(ie)&&_e++,ie.set(O.min.x,O.min.y,O.max.z),this.containsPoint(ie)&&_e++,ie.set(O.min.x,O.max.y,O.min.z),this.containsPoint(ie)&&_e++,ie.set(O.min.x,O.max.y,O.max.z),this.containsPoint(ie)&&_e++,ie.set(O.max.x,O.max.y,O.max.z),this.containsPoint(ie)&&_e++,ie.set(O.max.x,O.min.y,O.max.z),this.containsPoint(ie)&&_e++,ie.set(O.max.x,O.max.y,O.min.z),this.containsPoint(ie)&&_e++,ie.set(O.max.x,O.max.y,O.max.z),this.containsPoint(ie)&&_e++,_e>5},D}function dn(oe,D){oe||(oe={material_kind:"lambert"});const O=Object.assign({},D);let ie;return void 0===O.opacity&&(O.opacity=1),oe.transparency&&(O.opacity=Math.min(1-oe.transparency,O.opacity)),O.wireframe=oe.wireframe??!1,O.color||(O.color="red"),O.side=Ee.hB5,O.transparent=O.opacity<1,O.depthWrite=1===O.opactity,"basic"===oe.material_kind?ie=new Ee.V9B(O):"depth"===oe.material_kind?(delete O.color,ie=new Ee.CSG(O)):"toon"===oe.material_kind?ie=new Ee.Df(O):"matcap"===oe.material_kind?(delete O.wireframe,ie=new Ee.FNr(O)):"standard"===oe.material_kind?(O.metalness=oe.metalness??.5,O.roughness=oe.roughness??.1,ie=new Ee._4j(O)):"normal"===oe.material_kind?(delete O.color,ie=new Ee.qBx(O)):"physical"===oe.material_kind?(O.metalness=oe.metalness??.5,O.roughness=oe.roughness??.1,O.reflectivity=oe.reflectivity??.5,O.emissive=O.color,ie=new Ee.uSd(O)):"phong"===oe.material_kind?(O.shininess=oe.shininess??.9,ie=new Ee.tXL(O)):(O.vertexColors=!1,ie=new Ee.G_z(O)),void 0!==ie.flatShading&&void 0!==oe.flatShading&&(ie.flatShading=oe.flatShading),ie.inherentOpacity=D.opacity??1,ie.inherentArgs=D,ie}function In(oe,D){if(oe===D)return 0;const O=oe?.length??0,ie=D?.length??0,_e=O<ie?O:ie;let Oe=0;for(;Oe<_e;){if(oe[Oe]<D[Oe])return-1;if(oe[Oe]>D[Oe])return 1;++Oe}return O<ie?-1:O>ie?1:0}function ci(oe,D){if(!oe||!D)return!1;if(oe===D)return!0;if(oe.length!==D.length)return!1;for(let O=0;O<oe.length;++O)if(oe[O]!==D[O])return!1;return!0}class Pi{constructor(D,O){this.toplevel=!0,this.name_prefix="",this.maxdepth=1,this.vislevel=4,this.maxnodes=1e4,D?(D.$geoh&&(this.toplevel=!1),this.createClones(D)):O&&(this.nodes=O)}setVisLevel(D){this.vislevel=D&&Number.isInteger(D)?D:4}getVisLevel(){return this.vislevel}setMaxVisNodes(D,O){this.maxnodes=Number.isFinite(D)?D:1e4,O&&Number.isFinite(O)&&(this.maxnodes*=O)}getMaxVisNodes(){return this.maxnodes}setConfig(D){this._cfg=D}updateNode(D){D&&Number.isInteger(D.id)&&D.id<this.nodes.length&&(this.nodes[D.id]=D)}getNodeShape(D){if(!this.origin||!this.nodes)return null;const O=this.origin[D],ie=this.nodes[D];return O&&ie?ie.kind!==ue?O.fShape:O.fVolume?O.fVolume.fShape:null:null}cleanup(D,O){if(D)for(let ie=0;ie<D.length;++ie)delete D[ie].stack,D[ie]=void 0;if(O)for(let ie=0;ie<O.length;++ie)delete O[ie].geom,O[ie]=void 0;if(this.nodes)for(let ie=0;ie<this.nodes.length;++ie)this.nodes[ie]&&delete this.nodes[ie].chlds;delete this.nodes,delete this.origin,delete this.sortmap}createClones(D,O,ie){if(!O){if("$$Shape$$"===D?._typename)return this.createClonesForShape(D);this.origin=[],O=1,ie=Fe(D)}if(ie<0||!D||"_refid"in D)return;D._refid=this.origin.length,this.origin.push(D),O>this.maxdepth&&(this.maxdepth=O);let _e=null;if(_e=ie===ue?D.fVolume?.fNodes?.arr||null:D.fElements?.arr||null,null!==_e){St(D,_e);for(let $e=0;$e<_e.length;++$e)this.createClones(_e[$e],O+1,ie)}if(O>1)return;this.nodes=[];const Oe=[];for(let $e=0;$e<this.origin.length;++$e){const et={id:$e,kind:ie,vol:0,nfaces:0};this.nodes.push(et),Oe.push(et)}for(let $e=0;$e<this.origin.length;++$e){const et=this.origin[$e],it=this.nodes[$e];let yt=null,sn=null;ie===Q?(sn=et.fShape,et.fElements&&(yt=et.fElements.arr)):et.fVolume&&(sn=et.fVolume.fShape,et.fVolume.fNodes&&(yt=et.fVolume.fNodes.arr));const tn=Nr(ie,et);if(tn){if(it.matrix=tn.elements,1===it.matrix[0]){let xn=!0;for(let wn=1;wn<it.matrix.length&&xn;++wn)xn=it.matrix[wn]===(5===wn||10===wn||15===wn?1:0);xn&&delete it.matrix}it.matrix&&ie===Q&&(it.abs_matrix=!0)}if(sn&&(it.fDX=sn.fDX,it.fDY=sn.fDY,it.fDZ=sn.fDZ,it.vol=Math.sqrt(sn.fDX**2+sn.fDY**2+sn.fDZ**2),void 0===sn.$nfaces&&(sn.$nfaces=Pe(sn,-1)),it.nfaces=sn.$nfaces,it.nfaces<=0&&(it.vol=0)),yt){it.chlds=new Array(yt.length);for(let xn=0;xn<yt.length;++xn)it.chlds[xn]=yt[xn]._refid}}for(let $e=0;$e<this.origin.length;++$e)delete this.origin[$e]._refid;Oe.sort(($e,et)=>et.vol-$e.vol),this.sortmap=new Array(this.nodes.length);for(let $e=0;$e<this.nodes.length;++$e)this.sortmap[$e]=Oe[$e].id,Oe[$e].sortid=$e}createClonesForShape(D){this.origin=[],this.plain_shape=D,this.nodes=[{id:0,sortid:0,kind:2,name:"Shape",nfaces:D.nfaces,fDX:1,fDY:1,fDZ:1,vol:1,vis:!0}]}countVisibles(){const D=this.nodes?.length||0;let O=0;for(let ie=0;ie<D;++ie)this.nodes[ie].vis&&O++;return O}markVisibles(D,O,ie){if(this.plain_shape)return 1;if(!this.origin||!this.nodes)return 0;let _e=0;for(let Oe=0;Oe<this.nodes.length;++Oe){const $e=this.nodes[Oe],et=this.origin[Oe];$e.vis=0,delete $e.nochlds,$e.kind===ue?et.fVolume&&(D?($e.vis=Ge(et.fVolume,X.kVisOnScreen)?99:0,0===Oe&&$e.vis&&ie&&($e.vis=0),O&&(lt(et.fVolume,X.kVisNone,!1),lt(et.fVolume,X.kVisThis,$e.vis>0),lt(et.fVolume,X.kVisDaughters,!0),lt(et,X.kVisDaughters,!0))):($e.vis=!Ge(et.fVolume,X.kVisNone)&&Ge(et.fVolume,X.kVisThis)?99:0,(!Ge(et,X.kVisDaughters)||!Ge(et.fVolume,X.kVisDaughters))&&($e.nochlds=!0),$e.vis>0&&$e.chlds&&!$e.nochlds&&($e.vis=1),0===Oe&&(ie&&($e.vis=0),delete $e.nochlds))):($e.vis=et.fRnrSelf?99:0,0===Oe&&1===this.nodes.length&&($e.vis=99),this.vislevel=9999),($e.vol<=0||$e.nfaces<=0)&&($e.vis=0),$e.vis&&_e++}return _e}produceIdShifts(){for(let O=0;O<this.nodes.length;++O)this.nodes[O].idshift=-1;!function D(O,ie){if(ie.idshift<0&&(ie.idshift=0,ie.chlds))for(let _e=0;_e<ie.chlds.length;++_e)ie.idshift+=D(O,O[ie.chlds[_e]]);return ie.idshift+1}(this.nodes,this.nodes[0])}getVisibleFlags(){const D=new Array(this.nodes.length);for(let O=0;O<this.nodes.length;++O)D[O]={vis:this.nodes[O].vis,nochlds:this.nodes[O].nochlds};return D}setVisibleFlags(D){if(!this.nodes||!D||!D.length!==this.nodes.length)return 0;let O=0;for(let ie=0;ie<this.nodes.length;++ie){const _e=this.nodes[ie];_e.vis=D[ie].vis,_e.nochlds=D[ie].nochlds,_e.vis&&O++}return O}setPhysNodeVisibility(D,O){let ie=!1;if("clearall"!==O){if("clear"===O){if(ie=!0,!this.fVisibility)return}else O=!!O;if(D){this.fVisibility||(this.fVisibility=[]);for(let _e=0;_e<this.fVisibility.length;++_e){const Oe=this.fVisibility[_e],$e=In(Oe.stack,D);if(0===$e)return void(ie?(this.fVisibility.splice(_e,1),0===this.fVisibility.length&&delete this.fVisibility):Oe.visible=O);if($e>0)return void(ie||this.fVisibility.splice(_e,0,{visible:O,stack:D}))}ie||this.fVisibility.push({visible:O,stack:D})}}else delete this.fVisibility}getPhysNodeVisibility(D){if(!D||!this.fVisibility)return null;for(let O=0;O<this.fVisibility.length;++O){const ie=this.fVisibility[O],_e=In(ie.stack,D);if(0===_e)return ie;if(_e>0)return null}return null}scanVisible(D,O){if(!this.nodes)return 0;void 0===O&&(D||(D={}),(O=D.vislvl||this.vislevel||4)>88&&(O=88),D.stack=new Array(100),D.nodeid=0,D.counter=0,D.last=0,D.copyStack=function(et){const it={nodeid:this.nodeid,seqid:this.counter,stack:new Array(this.last)};et&&(it.factor=et);for(let yt=0;yt<this.last;++yt)it.stack[yt]=this.stack[yt+1];return it},D.domatrix&&(D.matrices=[],D.mpool=[new Ee.kn4],D.getmatrix=function(){return this.matrices[this.last]}),this.fVisibility?.length&&(D.vindx=0,D.varray=this.fVisibility,D.vstack=D.varray[D.vindx].stack,D.testPhysVis=function(){if(!this.vstack||this.vstack?.length!==this.last)return;for(let it=0;it<this.last;++it)if(this.vstack[it]!==this.stack[it+1])return;const et=this.varray[this.vindx++].visible;return this.vstack=this.vindx<this.varray.length?this.varray[this.vindx].stack:null,et}));const ie=this.nodes[D.nodeid];let _e=0;if(D.domatrix){D.mpool[D.last+1]||(D.mpool[D.last+1]=new Ee.kn4);const et=D.last>0?D.matrices[D.last-1]:new Ee.kn4;ie.matrix?(D.matrices[D.last]=D.mpool[D.last].fromArray(et.elements),D.matrices[D.last].multiply(D.mpool[D.last+1].fromArray(ie.matrix))):D.matrices[D.last]=et}let Oe=ie.vis,$e=ie.nochlds;if(D.testPhysVis){const et=D.testPhysVis();void 0!==et&&(Oe=et&&!ie.chlds?O+1:0,$e=!et)}if($e&&(O=0),Oe>O&&(!D.func||D.func(ie))&&_e++,D.counter++,O>0&&ie.chlds){D.last++;for(let et=0;et<ie.chlds.length;++et)D.nodeid=ie.chlds[et],D.stack[D.last]=et,_e+=this.scanVisible(D,O-1);D.last--}else D.counter+=ie.idshift||0;return 0===D.last&&(delete D.last,delete D.stack,delete D.copyStack,delete D.counter,delete D.matrices,delete D.mpool,delete D.getmatrix,delete D.vindx,delete D.varray,delete D.vstack,delete D.testPhysVis),_e}getNodeName(D){if(this.origin){const ie=this.origin[D];return ie?rt(ie):""}const O=this.nodes[D];return O?O.name:""}resolveStack(D,O){const ie={id:0,obj:null,node:this.nodes[0],name:this.name_prefix||""};if(O&&(ie.matrix=new Ee.kn4,ie.node.matrix&&ie.matrix.fromArray(ie.node.matrix)),this.origin&&(ie.obj=this.origin[0]),D)for(let _e=0;_e<D.length;++_e){ie.id=ie.node.chlds[D[_e]],ie.node=this.nodes[ie.id],this.origin&&(ie.obj=this.origin[ie.id]);const Oe=this.getNodeName(ie.id);Oe&&(ie.name&&(ie.name+="/"),ie.name+=Oe),O&&ie.node.matrix&&ie.matrix.multiply((new Ee.kn4).fromArray(ie.node.matrix))}return ie}getStackName(D){return this.resolveStack(D).name}buildStackByIds(D){if(!D)return null;if(0!==D[0])return console.error("wrong ids - first should be 0"),null;let O=this.nodes[0];const ie=[];for(let _e=1;_e<D.length;++_e){const Oe=D[_e];if(!O)return null;const $e=O.chlds.indexOf(Oe);if($e<0)return console.error(`wrong nodes ids ${D[_e]} is not child of ${D[_e-1]}`),null;ie.push($e),O=this.nodes[Oe]}return ie}buildIdsByStack(D){if(!D)return null;let O=this.nodes[0];const ie=[0];for(let _e=0;_e<D.length;++_e){const Oe=O.chlds[D[_e]];ie.push(Oe),O=this.nodes[Oe]}return ie}getNodeIdByStack(D){if(!D||!this.nodes)return-1;let O=this.nodes[0],ie=0;for(let _e=0;_e<D.length;++_e)ie=O.chlds[D[_e]],O=this.nodes[ie];return ie}isIdInStack(D,O){if(!D)return!0;let ie=this.nodes[0],_e=0;for(let Oe=0;Oe<O.length;++Oe){if(_e=ie.chlds[O[Oe]],_e===D)return!0;ie=this.nodes[_e]}return!1}findStackByName(D){const O=D.split("/"),ie=[];let _e=0;if(this.getNodeName(_e)!==O[0])return null;for(let Oe=1;Oe<O.length;++Oe){const $e=this.nodes[_e];if(!$e.chlds)return null;for(let et=0;et<$e.chlds.length;++et){const it=$e.chlds[et];if(this.getNodeName(it)===O[Oe]){ie.push(et),_e=it;break}}if(ie.length===Oe-1)return null}return ie}setDefaultColors(D){if(this.use_dflt_colors=D,this.use_dflt_colors&&!this.dflt_table){const O={kWhite:0,kBlack:1,kGray:920,kRed:632,kGreen:416,kBlue:600,kYellow:400,kMagenta:616,kCyan:432,kOrange:800,kSpring:820,kTeal:840,kAzure:860,kViolet:880,kPink:900},ie=110,_e=[];for(let Oe=0;Oe<ie;Oe++)_e.push(O.kGray);_e[3]=O.kYellow-10,_e[4]=_e[5]=O.kGreen-10,_e[6]=_e[7]=O.kBlue-7,_e[8]=_e[9]=O.kMagenta-3,_e[10]=_e[11]=O.kRed-10,_e[12]=O.kGray+1,_e[13]=O.kBlue-10,_e[14]=O.kOrange+7,_e[16]=O.kYellow+1,_e[20]=O.kYellow-10,_e[24]=_e[25]=_e[26]=O.kBlue-8,_e[29]=O.kOrange+9,_e[79]=O.kOrange-2,this.dflt_table=_e}}getDrawEntryProperties(D,O){const ie=this.nodes[D.nodeid];if(2===ie.kind){const it={name:ie.name,nname:ie.name,shape:null,material:null,chlds:null},yt=D.opacity||1,sn=D.color||"#0000FF";return it.fillcolor=new Ee.Q1f("#"===sn[0]?sn:`rgb(${sn})`),it.material=dn(this._cfg,{opacity:yt,color:it.fillcolor}),it}if(!this.origin)return console.error("origin not there - kind",ie.kind,D.nodeid,ie),null;const Oe=this.origin[D.nodeid];if(ie.kind===Q){const it={name:rt(Oe),nname:rt(Oe),shape:Oe.fShape,material:null,chlds:null};null!==Oe.fElements&&(it.chlds=Oe.fElements.arr);{const yt=Math.min(1,Oe.fRGBA[3]);it.fillcolor=new Ee.Q1f(Oe.fRGBA[0],Oe.fRGBA[1],Oe.fRGBA[2]),it.material=dn(this._cfg,{opacity:yt,color:it.fillcolor})}return it}const $e=Oe.fVolume,et={name:rt($e),nname:rt(Oe),volume:$e,shape:$e.fShape,material:null,chlds:$e.fNodes?.arr,linewidth:$e.fLineWidth};{let it=1;O||(O=["white","black","red","green","blue","yellow","magenta","cyan"]),D.custom_color?et.fillcolor=D.custom_color:$e.fFillColor>1&&1===$e.fLineColor?et.fillcolor=O[$e.fFillColor]:$e.fLineColor>=0&&(et.fillcolor=O[$e.fLineColor]);const yt=$e.fMedium?.fMaterial;if(yt){const sn=yt.fFillStyle;let tn=sn>=3e3&&sn<=3100?sn-3e3:0;if(this.use_dflt_colors){const xn=Math.round(yt.fZ);et.fillcolor=O[this.dflt_table[xn]],yt.fDensity<.1&&(tn=60)}tn>0&&(it=(100-tn)/100),void 0===et.fillcolor&&(et.fillcolor=O[yt.fFillColor])}void 0===et.fillcolor&&(et.fillcolor="lightgrey"),et.material=dn(this._cfg,{opacity:it,color:et.fillcolor})}return et}createObject3D(D,O,ie){let _e=this.nodes[0],Oe=O,$e=0;const et=(0,x.isObject)(ie)||"force"===ie;for(let it=0;it<=D.length;++it){const yt=it>0?D[it-1]:0,sn=it>0?this.nodes[_e.chlds[yt]]:_e;if(!sn)return console.error(`Wrong stack ${JSON.stringify(D)} for nodes at level ${it}, node.id ${_e.id}, numnodes ${this.nodes.length}, nchld ${yt}, numchilds ${_e.chlds.length}, chldid ${_e.chlds[yt]}`),null;let tn;if(_e=sn,Oe.children)for(let xn=0;xn<Oe.children.length;++xn)if(Oe.children[xn].nchld===yt){tn=Oe.children[xn];break}if(tn)Oe=tn,tn.$jsroot_drawable&&$e++;else{if(!et)return null;tn=new Ee.B69,_e.abs_matrix?(tn.absMatrix=new Ee.kn4,tn.absMatrix.fromArray(_e.matrix)):_e.matrix&&(tn.matrix.fromArray(_e.matrix),tn.matrix.decompose(tn.position,tn.quaternion,tn.scale)),tn.nchld=yt,Oe.add(tn),0===it&&(0,x.isObject)(ie)&&ie.scale&&(ie.scale.x<0||ie.scale.y<0||ie.scale.z<0)&&(tn.scale.copy(ie.scale),tn.updateMatrix()),tn.updateMatrixWorld(),Oe=tn}}if("mesh"===ie||"delete_mesh"===ie){let it=null;if(Oe)for(let sn=0;sn<Oe.children.length&&!it;++sn){const tn=Oe.children[sn];"Mesh"===tn.type&&void 0===tn.nchld&&(it=tn)}if("mesh"===ie||!it)return it;const yt=Oe;for(;it&&it!==O;)Oe=it.parent,Oe.remove(it),it=0===Oe.children.length?Oe:null;return yt}return Oe&&(Oe.$jsroot_drawable=!0,Oe.$jsroot_depth=$e),Oe}createEntryMesh(D,O,ie,_e,Oe){if(!_e||!_e.ready)return null;if(ie.done=!0,_e.used=!0,!_e.geom||!_e.nfaces)return this.createObject3D(ie.stack,O,"delete_mesh"),null;const $e=this.getDrawEntryProperties(ie,Oe),et=this.createObject3D(ie.stack,O,D),it=et.absMatrix||et.matrixWorld;let yt;return $e.material.wireframe=D.wireframe,$e.material.side=D.doubleside?Ee.$EB:Ee.hB5,yt=it.determinant()>-.9?new Ee.eaF(_e.geom,$e.material):function bi(oe,D){void 0===oe.geomZ&&(oe.geomZ=Si(oe.geom));const O=new Ee.eaF(oe.geomZ,D);return O.scale.copy(new Ee.Pq0(1,1,-1)),O.updateMatrix(),O._flippedMesh=!0,O}(_e,$e.material),et.add(yt),et.absMatrix&&(yt.matrix.copy(et.absMatrix),yt.matrix.decompose(yt.position,yt.quaternion,yt.scale),yt.updateMatrixWorld()),yt.stack=ie.stack,yt.renderOrder=this.maxdepth-ie.stack.length,yt.$jsroot_order=et.$jsroot_depth,void 0!==D.info?.num_meshes&&(D.info.num_meshes++,D.info.num_faces+=_e.nfaces),yt}createInstancedMeshes(D,O,ie,_e,Oe){if(D.instancing<0)return!1;const $e=[];let et=1;for(let yt=0;yt<ie.length;++yt){const sn=ie[yt];if(sn.done)continue;const tn=sn.server_shape||_e[sn.shapeid];if(!tn||!tn.ready)return console.warn(`Problem with shape id ${sn.shapeid} when building`),!1;if(!tn.geom||!tn.nfaces)continue;void 0===tn.instances&&(tn.instances=[],$e.push(tn));const xn=tn.instances.find(wn=>wn.nodeid===sn.nodeid);xn?(xn.entries.push(sn),et=Math.max(et,xn.entries.length)):tn.instances.push({nodeid:sn.nodeid,entries:[sn]})}return(D.instancing>0?et>2:ie.length>1e4&&et>10)?($e.forEach(yt=>{yt.used=!0,yt.instances.forEach(sn=>{const tn=sn.entries[0],xn=this.getDrawEntryProperties(tn,Oe);if(xn.material.wireframe=D.wireframe,xn.material.side=D.doubleside?Ee.$EB:Ee.hB5,1===sn.entries.length)this.createEntryMesh(D,O,tn,yt,Oe);else{const wn=[],Ut=[],Qe=[],nt=[];if(sn.entries.forEach(at=>{const ht=this.resolveStack(at.stack,!0);ht.matrix.determinant()>-.9?(wn.push(ht.matrix),Qe.push(at.stack)):(Ut.push(ht.matrix),nt.push(at.stack)),at.done=!0}),wn.length>0){const at=new Ee.ZLX(yt.geom,xn.material,wn.length);at.stacks=Qe,wn.forEach((ht,Qt)=>at.setMatrixAt(Qt,ht)),O.add(at),at.renderOrder=1,at.$jsroot_order=1,D.info.num_meshes++,D.info.num_faces+=yt.nfaces*wn.length}if(Ut.length>0){void 0===yt.geomZ&&(yt.geomZ=Si(yt.geom));const at=new Ee.ZLX(yt.geomZ,xn.material,Ut.length);at.stacks=nt;const ht=(new Ee.kn4).makeScale(1,1,-1);Ut.forEach((Qt,vn)=>{at.setMatrixAt(vn,Qt.multiply(ht))}),at._flippedMesh=!0,O.add(at),at.renderOrder=1,at.$jsroot_order=1,D.info.num_meshes++,D.info.num_faces+=yt.nfaces*Ut.length}}}),delete yt.instances}),!0):($e.forEach(yt=>{delete yt.instances}),!1)}getVolumeBoundary(D,O,ie){const _e={min:0,max:1,sortidcut:0};if(!this.sortmap)return console.error("sorting map do not exist"),_e;let Oe,$e,et=0,it=0;for(let yt=0;yt<this.sortmap.length&&et<ie&&it<O;++yt){const sn=this.sortmap[yt];0!==D[sn]&&($e=this.nodes[sn],Oe||(Oe=$e),et+=D[sn],it+=D[sn]*$e.nfaces)}return $e?(_e.max=Oe.vol,_e.min=$e.vol,_e.sortidcut=$e.sortid,_e):(console.error("no volumes selected"),_e)}collectVisibles(D,O){if(this.plain_shape)return{lst:[{nodeid:0,seqid:0,stack:[],factor:1,shapeid:0,server_shape:this.plain_shape}],complete:!0};const ie={facecnt:0,viscnt:new Array(this.nodes.length),vislvl:this.getVisLevel(),reset(){this.total=0,this.facecnt=0,this.viscnt.fill(0)},func(tn){return this.total++,this.facecnt+=tn.nfaces,this.viscnt[tn.id]++,!0}};ie.reset();let _e=this.scanVisible(ie);const Oe=this.getMaxVisNodes();if(Oe>0)for(;_e>Oe&&ie.vislvl>1;)ie.vislvl--,ie.reset(),_e=this.scanVisible(ie);this.actual_level=ie.vislvl;let $e=0,et=0,it=-1,yt=10,sn=this.nodes.length+1;if(console.log(`Total visible nodes ${_e} numfaces ${ie.facecnt}`),ie.facecnt>D){const wn=this.getVolumeBoundary(ie.viscnt,D*(O?.8:1),Oe*(O?.8:1));if($e=wn.min,et=wn.max,sn=wn.sortidcut,O){ie.domatrix=!0,ie.frustum=O,ie.totalcam=0,ie.func=function(Ut){return Ut.vol<=$e&&this.frustum.CheckShape(this.getmatrix(),Ut)&&(this.viscnt[Ut.id]++,this.totalcam+=Ut.nfaces),!0};for(let Ut=0;Ut<ie.viscnt.length;++Ut)ie.viscnt[Ut]=0;this.scanVisible(ie),it=ie.totalcam>.2*D?this.getVolumeBoundary(ie.viscnt,.2*D,.2*Oe).min:0,yt=et/(it>0?it>0:$e)}}return ie.items=[],ie.func=function(tn){return tn.sortid<sn?this.items.push(this.copyStack()):it>=0&&tn.vol>it&&this.frustum.CheckShape(this.getmatrix(),tn)&&this.items.push(this.copyStack(yt)),!0},this.scanVisible(ie),{lst:ie.items,complete:0===$e}}mergeVisibles(D,O){let ie=0;const _e=[];for(let Oe=0;Oe<D.length&&ie<O.length;++Oe){for(;ie<O.length&&O[ie].seqid<D[Oe].seqid;)_e.push(O[ie++]);ie<O.length&&O[ie].seqid===D[Oe].seqid&&(O[ie].done&&(D[Oe].done=!0),ie++)}for(;ie<O.length;)_e.push(O[ie++]);return _e}collectShapes(D){if(this.plain_shape)return[this.plain_shape];const O=[];for(let ie=0;ie<D.length;++ie){const _e=D[ie],Oe=this.getNodeShape(_e.nodeid);Oe&&(void 0===Oe._id?(Oe._id=O.length,O.push({id:Oe._id,shape:Oe,vol:this.nodes[_e.nodeid].vol,refcnt:1,factor:1,ready:!1})):O[Oe._id].refcnt++,_e.shape=O[Oe._id],_e.factor&&_e.factor>_e.shape.factor&&(_e.shape.factor=_e.factor))}O.sort((ie,_e)=>_e.vol*_e.factor-ie.vol*ie.factor);for(let ie=0;ie<O.length;++ie){const _e=O[ie];_e.id=ie,delete _e.shape._id}for(let ie=0;ie<D.length;++ie){const _e=D[ie];_e.shape&&(_e.shapeid=_e.shape.id,delete _e.shape)}return O}mergeShapesLists(D,O){if(!D)return O;for(let ie=0;ie<D.length;++ie){const _e=D[ie];_e.shape._geom=_e.geom,delete _e.geom,void 0!==_e.geomZ&&(_e.shape._geomZ=_e.geomZ,delete _e.geomZ)}for(let ie=0;ie<O.length;++ie){const _e=O[ie];void 0!==_e.shape._geom&&(_e.geom=_e.shape._geom,delete _e.shape._geom),void 0!==_e.shape._geomZ&&(_e.geomZ=_e.shape._geomZ,delete _e.shape._geomZ)}for(let ie=0;ie<D.length;++ie){const _e=D[ie];delete _e.shape._geom,delete _e.shape._geomZ}return O}buildShapes(D,O,ie){let _e=0;const Oe=(new Date).getTime(),$e={done:!1,shapes:0,faces:0,notusedshapes:0};for(let et=0;et<D.length;++et){const it=D[et];if($e.done)it.ready=!0;else if(it.ready||(it._typename="$$Shape$$",it.ready=!0,void 0===it.geom&&(it.geom=Pe(it.shape),it.geom&&_e++),it.nfaces=K(it.geom)),$e.shapes++,it.used||$e.notusedshapes++,$e.faces+=it.nfaces*it.refcnt,$e.faces>=O)$e.done=!0;else if(_e>.01*D.length&&void 0!==ie&&(new Date).getTime()-Oe>ie)return $e}return $e.done=!0,$e}static formatServerElement(D){D.kind=2,D.vis=2;const O=D.matr;if(delete D.matr,!O?.length)return D;if(16===O.length)D.matrix=O;else{const ie=D.matrix=new Array(16);ie.fill(0),ie[0]=ie[5]=ie[10]=ie[15]=1,3===O.length?(ie[12]=O[0],ie[13]=O[1],ie[14]=O[2]):4===O.length?(ie[0]=O[0],ie[5]=O[1],ie[10]=O[2],ie[15]=O[3]):9===O.length?(ie[0]=O[0],ie[4]=O[1],ie[8]=O[2],ie[1]=O[3],ie[5]=O[4],ie[9]=O[5],ie[2]=O[6],ie[6]=O[7],ie[10]=O[8]):console.error(`wrong number of elements ${O.length} in the matrix`)}return D}}function Si(oe){let D=oe.getAttribute("position").array,O=oe.getAttribute("normal").array;const ie=oe.getIndex();if(ie){const it=ie.array,yt=oe.drawRange.start;let sn=oe.drawRange.count;yt+sn>it.length&&(sn=it.length-yt);const tn=new Float32Array(3*sn),xn=new Float32Array(3*sn);for(let wn=0;wn<sn;++wn){const Ut=it[yt+wn];(Ut<0||3*Ut>=D.length)&&console.log(`strange index ${3*Ut} totallen = ${D.length}`),tn[3*wn]=D[3*Ut],tn[3*wn+1]=D[3*Ut+1],tn[3*wn+2]=D[3*Ut+2],xn[3*wn]=O[3*Ut],xn[3*wn+1]=O[3*Ut+1],xn[3*wn+2]=O[3*Ut+2]}D=tn,O=xn}const _e=D.length,Oe=new Float32Array(_e),$e=new Float32Array(_e);for(let it=0,yt=0;it<_e;it+=3)Oe[it]=D[it+yt],Oe[it+1]=D[it+1+yt],Oe[it+2]=-D[it+2+yt],$e[it]=O[it+yt],$e[it+1]=O[it+1+yt],$e[it+2]=-O[it+2+yt],yt+=3,6===yt&&(yt=-3);const et=new Ee.LoY;return et.setAttribute("position",new Ee.THS(Oe,3)),et.setAttribute("normal",new Ee.THS($e,3)),et}function Jn(oe,D,O){if(!oe?.geometry)return D;if(D||(D=(new Ee.NRn).makeEmpty()),oe.isInstancedMesh){const Oe=new Ee.kn4,$e=(new Ee.NRn).makeEmpty();oe.geometry.computeBoundingBox();for(let et=0;et<oe.count;et++)oe.getMatrixAt(et,Oe),$e.copy(oe.geometry.boundingBox).applyMatrix4(Oe),D.union($e);return D}O||oe.updateWorldMatrix(!1,!1);const ie=new Ee.Pq0,_e=oe.geometry.attributes?.position;if(void 0!==_e)for(let Oe=0,$e=_e.count;Oe<$e;Oe++)ie.fromBufferAttribute(_e,Oe),O||ie.applyMatrix4(oe.matrixWorld),D.expandByPoint(ie);return D}function Wi(oe){oe&&((0,x.isFunc)(oe.geom?.dispose)&&oe.geom.dispose(),(0,x.isFunc)(oe.geomZ?.dispose)&&oe.geomZ.dispose(),delete oe.geom,delete oe.geomZ)}function Ln(oe,D,O,ie){const _e=new Ee.tBo;function Oe(yt){yt&&yt.traverse(sn=>{sn.renderOrder=sn.defaultOrder||0,sn.material&&(sn.material.depthWrite=!0)})}function $e(yt,sn,tn){if(yt.children)for(let xn=0;xn<yt.children.length;++xn){const wn=yt.children[xn];wn.$jsroot_order===sn?wn.material&&(wn.material.transparent?(wn.material.depthWrite=!1,tn.push(wn)):Oe(wn)):(void 0===yt.$jsroot_depth||yt.$jsroot_depth<sn)&&$e(wn,sn,tn)}}O&&"dflt"!==O?function it(yt,sn,tn,xn){const wn=[];let Ut=!1;if($e(yt,sn,wn),wn.length){if(tn===xn)for(let Qe=0;Qe<wn.length;++Qe)wn[Qe].renderOrder=tn;else Ut=function et(yt,sn,tn){if(yt.length>1e3){for(let Ut=0;Ut<yt.length;++Ut)yt[Ut].renderOrder=(sn+tn)/2;return!1}const xn=new Ee.Pq0;for(let Ut=0;Ut<yt.length;++Ut){const Qe=yt[Ut];let nt=Qe.$jsroot_box3;if(nt||(Qe.$jsroot_box3=nt=Jn(Qe)),"size"===O){const Qt=nt.getSize(new Ee.Pq0);Qe.$jsroot_distance=Qt.x*Qt.y*Qt.z;continue}if("pnt"===O){Qe.$jsroot_distance=D.distanceTo(nt.getCenter(xn));continue}let at=Math.min(D.distanceTo(nt.min),D.distanceTo(nt.max));const ht=new Ee.Pq0(nt.min.x,nt.min.y,nt.max.z);at=Math.min(at,D.distanceTo(ht)),ht.set(nt.min.x,nt.max.y,nt.min.z),at=Math.min(at,D.distanceTo(ht)),ht.set(nt.max.x,nt.min.y,nt.min.z),at=Math.min(at,D.distanceTo(ht)),ht.set(nt.max.x,nt.max.y,nt.min.z),at=Math.min(at,D.distanceTo(ht)),ht.set(nt.max.x,nt.min.y,nt.max.z),at=Math.min(at,D.distanceTo(ht)),ht.set(nt.min.x,nt.max.y,nt.max.z),at=Math.min(at,D.distanceTo(ht)),Qe.$jsroot_distance=at}yt.sort((Ut,Qe)=>Ut.$jsroot_distance-Qe.$jsroot_distance);const wn=new Array(yt.length);for(let Ut=0;Ut<yt.length;++Ut)yt[Ut].$jsroot_index=Ut,wn[Ut]=yt[Ut];if("ray"===O)for(let Ut=yt.length-1;Ut>=0;--Ut){const Qe=yt[Ut];let at,ht=Qe.$jsroot_box3.getCenter(xn);for(let Qt=0;Qt<2;++Qt){ht.sub(D).normalize(),_e.set(D,ht),at=_e.intersectObjects(yt,!1)||[];const vn=[];for(let jt=0;jt<at.length;++jt)vn.indexOf(at[jt].object)<0&&vn.push(at[jt].object);if(at=vn,at.indexOf(Qe)<0&&Qt>0&&console.log(`MISS ${ie?.resolveStack(Qe.stack)?.name}`),at.indexOf(Qe)>=0||Qt>0)break;const en=Qe.geometry.attributes.position.array;ht=new Ee.Pq0((en[0]+en[3]+en[6])/3,(en[1]+en[4]+en[7])/3,(en[2]+en[5]+en[8])/3),ht.applyMatrix4(Qe.matrixWorld)}for(let Qt=0;Qt<at.length-1;++Qt){const en=at[Qt+1],jt=at[Qt].$jsroot_index,fn=en.$jsroot_index;if(!(jt<fn)){for(let Gn=fn;Gn<jt;++Gn)wn[Gn]=wn[Gn+1],wn[Gn].$jsroot_index=Gn;wn[jt]=en,en.$jsroot_index=jt}}}for(let Ut=0;Ut<wn.length;++Ut)wn[Ut].renderOrder=Math.round(tn-(Ut+1)/(wn.length+1)*(tn-sn)),delete wn[Ut].$jsroot_index,delete wn[Ut].$jsroot_distance;return!0}(wn,tn,xn),Ut||(tn=xn=(tn+xn)/2);for(let Qe=0;Qe<wn.length;++Qe){let at=tn,ht=xn;Ut&&(ht=wn[Qe].renderOrder,at=ht-(xn-tn)/(wn.length+2)),it(wn[Qe].parent,sn+1,at,ht)}}}(oe,0,1,1e6):Oe(oe)}function Rs(oe){switch(oe._typename){case $:return"img_geoarb8";case A:return"img_geocone";case E:return"img_geoconeseg";case we:return"img_geocomposite";case g:return"img_geotube";case v:return"img_geotubeseg";case U:return"img_geopara";case k:return"img_geoparab";case Z:return"img_geopcon";case ee:return"img_geopgon";case he:return"img_geoassembly";case G:return"img_geosphere";case b:return"img_geotorus";case C:return"img_geotrd1";case I:return"img_geotrd2";case P:return"img_geoxtru";case T:return"img_geotrap";case z:return"img_geogtra";case W:return"img_geoeltu";case fe:return"img_geohype";case f:return"img_geoctub"}return"img_geotube"}},2866:(Yr,mt,Se)=>{"use strict";Se.d(mt,{TB:()=>Ve,fm:()=>He,iF:()=>Re,rb:()=>ke.rb});var Ee=Se(4882),x=Se(8872),L=Se(8362),ve=Se(2843),ke=Se(1922),ot=Se(4246);function Re(De,F){return De<.5?F?"%S.%L":"%H:%M:%S.%L":De<30?F?"%Mm%S":"%H:%M:%S":(De/=60)<30?F?"%Hh%M":"%d/%m %H:%M":(De/=60)<12?F?"%d-%Hh":"%d/%m/%y %Hh":(De/=24)<15.218425?F?"%d/%m":"%d/%m/%y":(De/=30.43685)<6?"%d/%m/%y":(De/=12)<2?F?"%m/%y":"%d/%m/%y":"%Y"}const He={initAxisPainter(){this.name="yaxis",this.kind="normal",this.func=null,this.order=0,this.full_min=0,this.full_max=1,this.scale_min=0,this.scale_max=1,this.ticks=[]},cleanupAxisPainter(){this.ticks=[],delete this.format,delete this.func,delete this.tfunc1,delete this.tfunc2,delete this.gr},assignFrameMembers(De,F){De[`gr${F}`]=this.gr,De[`log${F}`]=this.log,De[`scale_${F}min`]=this.scale_min,De[`scale_${F}max`]=this.scale_max},convertDate(De){return new Date(this.timeoffset+1e3*De)},revertPoint(De){const F=this.func.invert(De);return"time"===this.kind?(F-this.timeoffset)/1e3:F},formatTime(De,F){return F?this.tfunc1(De):this.tfunc2(De)},formatLog(De,F,J){const Y=parseFloat(De),ue=Math.round(Y);if(!F)return ue===Y&&Math.abs(ue)<1e9?ue.toString():(0,ve.lg)(Y,J||x.gStyle.fStatFormat);if(Y<=0)return null;let Q=Math.log10(Y);const me=this.logbase;return 10!==me&&(Q/=Math.log10(me)),this.moreloglabels||Math.abs(Q-Math.round(Q))<.001?this.noexp||2===F?Math.abs(me-Math.E)<.001?(0,ve.lg)(Y,J||x.gStyle.fStatFormat):Y.toFixed(Q<0?Math.round(.5-Q):0):this.formatExp(me,Math.floor(Q+.01),Y):null},formatNormal(De,F,J){let Y=parseFloat(De);if(F&&this.order&&(Y/=Math.pow(10,this.order)),x.gStyle.fStripDecimals&&Y===Math.round(Y))return Math.abs(Y)<1e9?Y.toFixed(0):Y.toExponential(4);if(F){if(this.ndig>10)return Y.toExponential(this.ndig-11);let ue=Y.toFixed(this.ndig);const Q=ue.indexOf(".");if(Q>0&&x.settings.StripAxisLabels)for(;ue.length>=Q&&("0"===ue[ue.length-1]||"."===ue[ue.length-1]);)ue=ue.slice(0,ue.length-1);return ue}return(0,ve.lg)(Y,J||x.gStyle.fStatFormat)},formatExp(De,F,J){let Y="";if(J&&0!==(J=Math.round(J/Math.pow(De,F)))&&1!==J&&(Y=J.toString()+(x.settings.Latex?"#times":"x")),Math.abs(De-Math.E)<.001?Y+="e":Y+=De.toString(),x.settings.StripAxisLabels){if(0===F)return"1";if(1===F)return Y}if(x.settings.Latex>x.constants.Latex.Symbols)return Y+`^{${F}}`;const ue={0:"\u2070",1:"\xb9",2:"\xb2",3:"\xb3",4:"\u2074",5:"\u2075",6:"\u2076",7:"\u2077",8:"\u2078",9:"\u2079","-":"\u207b"},Q=F.toString();for(let me=0;me<Q.length;++me)Y+=ue[Q[me]];return Y},axisAsText(De,F){return"time"===this.kind&&(De=this.convertDate(De)),this.format?this.format(De,!1,F):De.toPrecision(4)},poduceLogTicks(De,F){const J=ue=>{let Q=0,me=0;for(let $=1;$<ue.length;++$){const A=ue[$]-ue[$-1];Q+=A,me+=A**2}const X=Q/(ue.length-1),B=me/(ue.length-1)-X**2;return B<=0||!(Math.abs(X)<1e-100)&&Math.sqrt(B)/X<1e-6};let Y=De.ticks(F);for(;F>4&&J(Y);)F=Math.round(.8*F),Y=De.ticks(F);if(F<5&&J(Y)&&this.logbase&&10!==this.logbase){const ue=[];Y.forEach(Q=>{const me=Math.log10(Q)/Math.log10(this.logbase);Math.abs(Math.round(me)-me)<.01&&ue.push(Q)}),ue.length>0&&(Y=ue)}return Y},produceTicks(De,F){if(!this.noticksopt){const ue=De*(F||1);if(this.log)return this.poduceLogTicks(this.func,ue);const Q=this.func.domain(),me=$=>$.length<=ue||!($.length>ue+1)&&($[0]===Q[0]||$[ue]===Q[1]),X=this.func.ticks(ue);if(F||me(X))return X;const B=this.func.ticks(Math.round(.7*ue));return B.length>2&&me(B)?B:X}const J=this.func.domain(),Y=[];F&&(De=(De-1)*F);for(let ue=0;ue<=De;++ue)Y.push((J[0]*(De-ue)+J[1]*ue)/De);return Y},analyzeWheelEvent(De,F,J,Y){J||(J={});let ue=0,Q=1,me=1;if("dleft"in J&&(Q=J.dleft,ue=1),"dright"in J&&(me=J.dright,ue=1),J.delta?ue=J.delta:De&&(ue=De.wheelDelta?-De.wheelDelta:De.deltaY||De.detail),!ue||Y&&J.ignore)return;ue=ue<0?-.2:.2,Q*=ue,me*=ue;const X=J.min=this.scale_min,B=J.max=this.scale_max,$=this.full_min,A=this.full_max;if(J.min===J.max&&ue<0&&(J.min=$,J.max=A),!(J.min>=J.max)){if(J.reverse&&(F=1-F),F>0&&F<1){if(this.log){let E=J.min>0?Math.log10(J.max/J.min):2;E>10?E=10:E<.01&&(E=.01),J.min=J.min/Math.pow(10,E*Q*F),J.max=J.max*Math.pow(10,E*me*(1-F))}else if(Q!==-me||J.reverse){let E=J.max-J.min,g=E;Q>0&&(E=1.001*E/(1-Q)),J.min+=-Q*F*E,me>0&&(g=1.001*g/(1-me)),J.max-=-me*(1-F)*g}else{let E=(J.max-J.min)*me*F;Math.round(J.max)===J.max&&Math.round(J.min)===J.min&&Math.abs(E)>1&&(E=Math.round(E)),J.min+E<$?E=$-J.min:J.max+E>A&&(E=A-J.max),0!==E?(J.min+=E,J.max+=E):(delete J.min,delete J.max)}J.min>=J.max?J.min=J.max=void 0:Q!==me?(J.min<$&&X===$||J.max>A&&B===A)&&(J.min=J.max=void 0):(J.min<$&&(J.min=$),J.max>A&&(J.max=A))}else J.min=J.max=void 0;return J.changed=void 0!==J.min&&void 0!==J.max,J}}};class Ve extends ke.JW{constructor(F,J,Y){super(F,J),this.is_gaxis=J?._typename===x.clTGaxis,Object.assign(this,He),this.initAxisPainter(),this.embedded=Y,this.invert_side=!1,this.lbls_both_sides=!1}cleanup(){this.cleanupAxisPainter(),super.cleanup()}getAxisType(){return x.clTAxis}configureAxis(F,J,Y,ue,Q,me,X,B){this.name=F,this.full_min=J,this.full_max=Y,this.kind="normal",this.vertical=me,this.log=B.log||0,this.noexp_changed=B.noexp_changed,this.symlog=B.symlog||!1,this.reverse=B.reverse||!1,this.swap_side=B.swap_side||!1,this.fixed_ticks=B.fixed_ticks||null,this.maxTickSize=B.maxTickSize||0;const $=this.getObject();if(B.time_scale||$.fTimeDisplay?(this.kind="time",this.timeoffset=function Ye(De){if(!De)return 7889184e5;const J=De.fTimeFormat.indexOf("%F");if(J<0)return 1e3*x.gStyle.fTimeOffset;let Y=De.fTimeFormat.slice(J+2);if(0===Y.indexOf("1995-01-01 00:00:00s0"))return 7889184e5;if("0"===Y||""===Y)return 0;const ue=(f,C,I)=>{const U=Y.indexOf(f);if(U<0)return C;const k=parseInt(Y.slice(0,U));return Y=Y.slice(U+1),!Number.isInteger(k)||k<C||k>I?C:k},Q=ue("-",1900,2900),me=ue("-",1,12)-1,X=ue(" ",1,31),B=ue(":",0,23),$=ue(":",0,59),A=ue("s",0,59),E=ue(" ",0,999);let v=new Date(Date.UTC(Q,me,X,B,$,A,E)).getTime();if(Y=Y.toUpperCase(),0===Y.indexOf("GMT")&&(Y=Y.slice(4).trim(),Y.length>3)){let f=0,C=1e3;"-"===Y[0]&&(f=1,C=-1e3),v-=C*(3600*parseInt(Y.slice(f,f+2))+60*parseInt(Y.slice(f+2,f+4)))}return v}($),this.timegmt=function Ze(De){const F=De?.fTimeFormat??"";return F.indexOf("gmt")>0||F.indexOf("GMT")>0}($)):this.kind=B.axis_func?"func":$.fLabels?"labels":"normal","time"===this.kind)this.func=(0,L.w7)().domain([this.convertDate(ue),this.convertDate(Q)]);else if(this.log){if(this.logbase=1===this.log||10===this.log?10:3===this.log?Math.E:Math.round(this.log),Q<=0&&(Q=1),ue<=0&&$&&!B.logcheckmin)for(let g=0;g<$.fNbins&&!((ue=Math.max(ue,$.GetBinLowEdge(g+1)))>0);++g);ue<=0&&B.log_min_nz&&(ue=this.log_min_nz=B.log_min_nz),(ue<=0||ue>=Q)&&(ue=Q*(B.logminfactor||1e-4)),this.func="func"===this.kind?this.createFuncHandle(B.axis_func,this.logbase,ue,Q):(0,L.ZE)().base(this.logbase).domain([ue,Q])}else if(this.symlog){let g=Math.max(Math.abs(ue),Math.abs(Q));Number.isInteger(this.symlog)&&this.symlog>0?g*=Math.pow(10,-1*this.symlog):g*=.01,this.func=(0,L.aX)().constant(g).domain([ue,Q])}else this.func="func"===this.kind?this.createFuncHandle(B.axis_func,0,ue,Q):(0,L.m4)().domain([ue,Q]);if(this.vertical^this.reverse){const g=X[0];X[0]=X[1],X[1]=g}this.func.range(X),this.scale_min=ue,this.scale_max=Q,this.gr="time"===this.kind?g=>this.func(this.convertDate(g)):this.log?g=>g<this.scale_min?this.vertical?this.func.range()[0]+5:-5:this.func(g):this.func,delete this.format;let A=508;this.is_gaxis?A=$.fNdiv:$&&(A=$.fNdivisions?Math.max($.fNdivisions,4):0),this.nticks=A%100,this.nticks2=(A%1e4-this.nticks)/100,this.nticks3=Math.floor(A/1e4),$&&!this.is_gaxis&&this.nticks>20&&(this.nticks=20);let E=Math.abs(this.func.range()[1]-this.func.range()[0]);if(E<=0&&(E=100),"time"===this.kind){this.nticks>8&&(this.nticks=8);const g=this.scale_max-this.scale_min,v=$.fTimeFormat.indexOf("%F"),f=Re(g/E,!1);let C=v>=0?$.fTimeFormat.slice(0,v):$.fTimeFormat;(!C||g<.1*(this.full_max-this.full_min))&&(C=Re(g/this.nticks,!0)),this.tfunc1=this.tfunc2=this.timegmt?(0,L.aL)(C):(0,L.DC)(C),f!==C&&(this.tfunc2=this.timegmt?(0,L.aL)(f):(0,L.DC)(f)),this.format=this.formatTime}else if(this.log)this.nticks2>1&&(this.nticks*=this.nticks2,this.nticks2=1),this.noexp=$?.TestBit(ke.rb.kNoExponent),this.scale_max<300&&this.scale_min>.3&&!this.noexp_changed&&(this.noexp=!0),this.moreloglabels=$?.TestBit(ke.rb.kMoreLogLabels),this.format=this.formatLog;else if("labels"===this.kind){this.nticks=50;const g=this.scale_max-this.scale_min;this.nticks>g&&(this.nticks=Math.round(g)),this.regular_labels=!0,$&&$.fNbins&&$.fLabels&&($.fNbins!==Math.round($.fXmax-$.fXmin)||0!==$.fXmin||$.fXmax!==$.fNbins)&&(this.regular_labels=!1),this.nticks2=1,this.format=this.formatLabels}else this.order=0,this.ndig=0,this.format=this.formatNormal}getScaleMin(){return this.func?.domain()[0]??0}getScaleMax(){return this.func?.domain()[1]??0}formatLabels(F){const J=this.getObject();let Y=parseFloat(F);if(Y=this.regular_labels?Math.floor(Y):Math.round((Y-J.fXmin)/(J.fXmax-J.fXmin)*J.fNbins),Y<0||Y>=J.fNbins)return null;for(let ue=0;ue<J.fLabels.arr.length;++ue){const Q=J.fLabels.arr[ue];if(Q.fUniqueID===Y+1)return Q.fString}return null}createTicks(F,J,Y,ue){Y&&this.nticks&&"normal"===this.kind&&(this.noticksopt=!0);const Q={painter:this,nminor:0,nmiddle:0,nmajor:0,func:this.func,minor:[],middle:[],major:[]};let me;if(this.fixed_ticks)me=[],this.fixed_ticks.forEach(X=>{X>=this.scale_min&&X<=this.scale_max&&me.push(X)});else if("labels"!==this.kind||this.regular_labels)me=this.produceTicks(this.nticks);else{me=[],Q.lbl_pos=[];const X=this.getObject();for(let B=0;B<X.fNbins;++B){const $=X.fXmin+B/X.fNbins*(X.fXmax-X.fXmin);$>=this.scale_min&&$<this.scale_max&&(Q.lbl_pos.push($),$>this.scale_min&&me.push($))}}if(Q.minor=Q.middle=Q.major=me,F){const X=Q.major,B=1e-5*(this.scale_max-this.scale_min);return X[0]>this.scale_min+B&&X.unshift(this.scale_min),X[X.length-1]<this.scale_max-B&&X.push(this.scale_max),X}if(this.nticks2>1&&(!this.log||10===this.logbase)&&!this.fixed_ticks){Q.minor=Q.middle=this.produceTicks(Q.major.length,this.nticks2);const X=Math.abs(this.func.range()[1]-this.func.range()[0]);Q.middle.length<=Q.major.length||Q.middle.length>X/3.5?Q.minor=Q.middle=Q.major:this.nticks3>1&&!this.log&&(Q.minor=this.produceTicks(Q.middle.length,this.nticks3),(Q.minor.length<=Q.middle.length||Q.minor.length>X/1.7)&&(Q.minor=Q.middle))}if(Q.reset=function(){this.nminor=this.nmiddle=this.nmajor=0},Q.next=function(X){return!(this.nminor>=this.minor.length||(this.tick=this.minor[this.nminor++],this.grpos=this.func(this.tick),X&&(this.grpos=Math.round(this.grpos)),this.kind=3,this.nmiddle<this.middle.length&&Math.abs(this.grpos-this.func(this.middle[this.nmiddle]))<1&&(this.nmiddle++,this.kind=2),this.nmajor<this.major.length&&Math.abs(this.grpos-this.func(this.major[this.nmajor]))<1&&(this.nmajor++,this.kind=1),0))},Q.last_major=function(){return 1===this.kind&&this.nmajor===this.major.length},Q.next_major_grpos=function(){return this.nmajor>=this.major.length?null:this.func(this.major[this.nmajor])},Q.get_modifier=function(){return this.painter.findLabelModifier(this.painter.getObject(),this.nmajor-1,this.major)},this.order=0,this.ndig=0,("normal"===this.kind||"func"===this.kind)&&!this.log&&Q.major.length>0){let X=0,B=0,$=!1;if(!J){const v=Math.max(Math.abs(Q.major[0]),Math.abs(Q.major[Q.major.length-1])),f=Math.min(Math.abs(Q.major[0]),Math.abs(Q.major[Q.major.length-1])),C=v>0?3*Math.round(Math.log10(v)/3):0,I=f>0?3*Math.round(Math.log10(f)/3):0;$=v<2e4,(v||f)&&(X=Math.max(C,I)+3,B=Math.min(C,I)-3)}let A=0,E=this.ndig,g=1e10;for(let v=B;v<=X;v+=3){if($&&3===v)continue;this.order=v,this.ndig=0;let f=[],C=0,I=0;for(;C<Q.major.length;){const U=this.format(Q.major[C],!0);if(f.indexOf(U)<0){f.push(U);const k=U.indexOf(".");!v&&!J&&(k>x.gStyle.fAxisMaxDigits||k<0&&U.length>x.gStyle.fAxisMaxDigits)&&(I+=1e10,$=!1),I+=U.length,C++}else{if(++this.ndig>15)break;f=[],C=0,I=0}}!v&&this.ndig<4&&(I-=2*Q.major.length+3),I<g&&(g=I,A=this.order,E=this.ndig)}this.order=A,this.ndig=E,ue&&(this.order&&console.warn(`Axis painter - integer labels are configured, but axis order ${this.order} is preferable`),this.ndig&&console.warn(`Axis painter - integer labels are configured, but ${this.ndig} decimal digits are required`),this.ndig=0,this.order=0)}return Q}isCenteredLabels(){return"labels"===this.kind||!this.log&&this.getObject()?.TestBit(ke.rb.kCenterLabels)}addTitleDrag(F,J,Y,ue,Q){if(!x.settings.MoveResize||this.isBatchMode())return;let X,B,$,A,E,g,v,me=null;const f=(0,L.$E)().subject(Object);f.on("start",C=>{C.sourceEvent.preventDefault(),C.sourceEvent.stopPropagation();const I=F.node().getBBox(),U=J?I.height:I.width;$=X=F.property("shift_x"),A=B=F.property("shift_y"),E=J?X>0:B>0,g=J?[Q,Q/2,0]:[0,Q/2,Q];const k=J?-U/2:U/2;"middle"===this.title_align?(g[0]+=k,g[2]-=k):"begin"===this.title_align?(g[1]-=k,g[2]-=2*k):(g[0]+=2*k,g[1]+=k),v=this.titleCenter?1:ue^this.titleOpposite?0:2,g[v]=J?B:X,me=F.append("rect").attr("x",I.x).attr("y",I.y).attr("width",I.width).attr("height",I.height).style("cursor","move").call(ve.Ru,!0)}).on("drag",C=>{if(!me)return;C.sourceEvent.preventDefault(),C.sourceEvent.stopPropagation(),X+=C.dx,B+=C.dy;let I,U,k=0;const Z=J?B:X;for(let ee=1;ee<3;++ee)Math.abs(Z-g[ee])<Math.abs(Z-g[k])&&(k=ee);J?(I=X,U=g[k]):(U=B,I=g[k]),E===(J?I>0:U>0)&&($=I,A=U,v=k,(0,ve.bk)(F,$,A))}).on("end",C=>{if(!me)return;C.sourceEvent.preventDefault(),C.sourceEvent.stopPropagation(),F.property("shift_x",$).property("shift_y",A);const I=this.getObject(),U=this.source_axis,k=(ee,he)=>{I&&I.TestBit(ee)!==he&&I.InvertBit(ee),U&&U.TestBit(ee)!==he&&U.InvertBit(ee)};this.titleOffset=(J?$:A)/Y;const Z=this.titleOffset/this.offsetScaling/this.titleSize;I&&(I.fTitleOffset=Z),U&&(U.fTitleOffset=Z),1===v?(k(ke.rb.kCenterTitle,!0),this.titleCenter=!0,k(ke.rb.kOppositeTitle,!1),this.titleOpposite=!1):0===v?(k(ke.rb.kCenterTitle,!1),this.titleCenter=!1,k(ke.rb.kOppositeTitle,!0),this.titleOpposite=!0):(k(ke.rb.kCenterTitle,!1),this.titleCenter=!1,k(ke.rb.kOppositeTitle,!1),this.titleOpposite=!1),this.submitAxisExec(`SetTitleOffset(${Z});;SetBit(${ke.rb.kCenterTitle},${this.titleCenter?1:0})`),me.remove(),me=null}),F.style("cursor","move").call(f)}setHistPainter(F,J){this.hist_painter=F,this.hist_axis=J}submitAxisExec(F,J){const Y=this.hist_painter?.snapid;Y&&this.hist_axis&&!J?this.submitCanvExec(F,`${Y}#${this.hist_axis}`):this.is_gaxis&&this.submitCanvExec(F)}produceTicksPath(F,J,Y,ue,Q,me){let X="",B="";for(this.ticks=[];F.next(!0);){let $=Math.round(Y/4),A=0;F.kind<3&&($=Math.round(Y/2)),1===F.kind&&(null!==this.format(F.tick,!0)&&($=Y),this.ticks.push(F.grpos)),ue>0?A=-$:J<0&&(A=-$,$=0),X+=this.vertical?`M${$},${F.grpos}H${A}`:`M${F.grpos},${-$}V${-A}`,Q&&(B+=this.vertical?`M${Q-$},${F.grpos}H${Q-A}`:`M${F.grpos},${Q+$}V${Q+A}`)}return me?X+B:""}findLabelModifier(F,J,Y){if(!F.fModLabs)return null;for(let ue=0;ue<F.fModLabs.arr.length;++ue){const Q=F.fModLabs.arr[ue];if(void 0!==Q.fLabValue&&0===Q.fLabNum){const me=this.log?1e-6*Y[J]:1e-6*(this.scale_max-this.scale_min);if(Math.abs(Q.fLabValue-Y[J])<me)return Q}if(Q.fLabNum===J+1||Q.fLabNum<0&&J===Y.length+Q.fLabNum)return Q}return null}drawLabels(F,J,Y,ue,Q,me,X,B,$,A,E,g){var v=this;return(0,Ee.A)(function*(){const f=v.isCenteredLabels(),C=J.TestBit(ke.rb.kLabelsVert),I=[F.append("svg:g").attr("class","axis_labels")],U=Q.lbl_pos||Q.major,k=x.gStyle.AxisTiltAngle??25;let Z=1,ee=0,he=0,G=!1,b=!1,P=0,T=0;function z(W){const fe=this.result_width;if(P=Math.max(P,fe),fe&&(!W.vertical&&!C||W.vertical&&C)&&!W.log){let Me=.45*this.gap_before+.45*this.gap_after;this.gap_before?this.gap_after||(Me=.9*this.gap_before):Me=.9*this.gap_after,Z=Math.min(Z,Me/fe)}else W.vertical&&E&&this.normal_side&&E-B>20&&fe>E-B&&(Z=Math.min(Z,(E-B)/fe));Z>1e-4&&Z<.7&&!b&&!W.vertical&&!C&&ee>5&&1===I.length&&!1===G&&(G=!0);let we=Z;G&&(T&&P?(we=Math.min(1,.8*T/P),we<Z&&(G=0,we=Z)):we*=3),(we>1e-4&&we<1||!1!==G)&&(he=1/we,W.scaleTextDrawing(he,I[0]))}v.lbls_both_sides&&I.push(F.append("svg:g").attr("class","axis_labels").attr("transform",v.vertical?`translate(${Y})`:`translate(0,${-ue})`)),g>0&&(T=g/Math.sin(k/180*Math.PI)-Math.tan(k/180*Math.PI));for(let W=0;W<I.length;++W){W>0&&(me=-me);let fe=0;const we=v.vertical?-B*me:B*me+A*$;v.startTextDrawing(X,"font",I[W]);for(let Me=0;Me<U.length;++Me){let je=v.format(U[Me],!0);if(null===je)continue;const Ge=v.findLabelModifier(J,Me,U);if(0===Ge?.fTextSize)continue;Ge&&(b=!0),Ge?.fLabText&&(je=Ge.fLabText);const lt={text:je,color:X.color,latex:1,draw_g:I[W],normal_side:0===W};let bt=Math.round(v.func(U[Me]));if(Ge?.fTextColor>0&&(lt.color=v.getColor(Ge.fTextColor)),lt.gap_before=Me>0?Math.abs(Math.round(bt-v.func(U[Me-1]))):0,lt.gap_after=Me<U.length-1?Math.abs(Math.round(v.func(U[Me+1])-bt)):0,f){const te=lt.gap_after||lt.gap_before;if(bt=Math.round(bt-(v.vertical!==v.reverse?.5*te:-.5*te)),bt<-5||bt>(v.vertical?ue:Y)+5)continue}if(ee=Math.max(ee,je.length),v.vertical?(lt.x=we,lt.y=bt,lt.align=C?me<0?23:20:me<0?12:32):(lt.x=bt,lt.y=we,lt.align=C?me<0?12:32:me<0?20:23,!v.log||v.noexp||v.vertical||23!==lt.align?lt.align%10==3&&(lt.y-=.1*X.size):(lt.align=21,lt.y+=X.size)),C?lt.rotate=270:Ge&&-1!==Ge.fTextAngle&&(lt.rotate=-Ge.fTextAngle),0===W&&(lt.post_process=z),v.drawText(lt),fe&&bt!==fe&&(v.vertical&&!C||!v.vertical&&C)){const te=Math.abs(bt-fe);Z=Math.min(Z,.9*te/X.size)}fe=bt}if(v.order){let Me=0,je=0;"xaxis"===v.name?(Me=x.gStyle.fXAxisExpXOffset||0,je=x.gStyle.fXAxisExpYOffset||0):"yaxis"===v.name&&(Me=x.gStyle.fYAxisExpXOffset||0,je=x.gStyle.fYAxisExpYOffset||0),Me&&(Me=Math.round(Me*(v.getPadPainter()?.getPadWidth()??0))),je&&(je=Math.round(je*(v.getPadPainter()?.getPadHeight()??0))),v.drawText({color:X.color,x:Me+(v.vertical?5*me:Y+5),y:je+(v.has_obstacle?we:v.vertical?-3:-3*me),align:v.vertical?me<0?30:10:v.has_obstacle^me<0?13:10,latex:1,text:"#times"+v.formatExp(10,v.order),draw_g:I[W]})}}return v.finishTextDrawing(I[0],!0).then(()=>{if(I.length>1)return he&&v.scaleTextDrawing(he,I[1]),v.finishTextDrawing(I[1],!0)}).then(()=>(G&&I[0].selectAll("text").each(function(){const W=(0,L.Lt)(this),fe=W.attr("transform");W.attr("transform",`${fe} rotate(${k})`).style("text-anchor","start")}),P))})()}extractDrawAttributes(F,J,Y){const ue=this.getObject(),Q=this.getPadPainter(),me=Q?.getPadWidth()||F||J/.8,X=Q?.getPadHeight()||F||Y/.8;let A,E,g,B=0,$=0;if(this.scalingSize=F||Math.max(Math.min(me,X),10),this.is_gaxis){const f=ue.fChopt.indexOf("S")>=0;this.optionUnlab=ue.fChopt.indexOf("U")>=0,this.optionMinus=ue.fChopt.indexOf("-")>=0||ue.TestBit(ke.rb.kTickMinus),this.optionPlus=ue.fChopt.indexOf("+")>=0||ue.TestBit(ke.rb.kTickPlus),this.optionNoopt=ue.fChopt.indexOf("N")>=0,this.optionInt=ue.fChopt.indexOf("I")>=0,this.optionText=ue.fChopt.indexOf("T")>=0,this.createAttLine({attr:ue}),$=F||(this.vertical?1.7*Y:.6*J),B=f?ue.fTickSize:.03,A=this.getColor(ue.fTextColor),E=ue.fTextFont,g=ue.fLabelOffset,(this.vertical&&ue.fY1>ue.fY2&&!this.optionMinus||!this.vertical&&ue.fX1>ue.fX2)&&(g=-g)}else this.optionUnlab=!1,this.optionMinus=this.vertical^this.invert_side,this.optionPlus=!this.optionMinus,this.optionNoopt=!1,this.optionInt=!1,this.optionText=!1,this.createAttLine({color:ue.fAxisColor,width:1,style:1}),$=F||(this.vertical?me:X),B=ue.fTickLength,A=this.getColor(ue.fTitleColor),E=ue.fTitleFont,g=ue.fLabelOffset;g+=this.vertical?.002:.005,"labels"===this.kind&&(this.optionText=!0),this.optionNoexp=ue.TestBit(ke.rb.kNoExponent),this.ticksSize=Math.round(B*$),F&&this.ticksSize<0&&(this.ticksSize=-this.ticksSize),this.maxTickSize&&this.ticksSize>this.maxTickSize&&(this.ticksSize=this.maxTickSize),this.ticksColor=this.lineatt.color,this.ticksWidth=this.lineatt.width;const v=this.optionText?.66666:1;this.labelSize=Math.round(ue.fLabelSize<1?v*ue.fLabelSize*this.scalingSize:v*ue.fLabelSize),this.labelsOffset=Math.round(g*this.scalingSize),this.labelsFont=new ot.qg(ue.fLabelFont,this.labelSize,F),(this.labelSize<=0||Math.abs(ue.fLabelOffset)>1.1)&&(this.optionUnlab=!0),this.labelsFont.setColor(this.getColor(ue.fLabelColor)),this.fTitle=ue.fTitle,this.fTitle?(this.titleSize=ue.fTitleSize>=1?ue.fTitleSize:Math.round(ue.fTitleSize*this.scalingSize),this.titleFont=new ot.qg(E,this.titleSize,F),this.titleFont.setColor(A),this.offsetScaling=ue.fTitleSize>=1?1:(this.vertical?me:X)/this.scalingSize,this.titleOffset=ue.fTitleOffset,!this.titleOffset&&"x"===this.name[0]&&(this.titleOffset=x.gStyle.fXaxis.fTitleOffset),this.titleOffset*=this.titleSize*this.offsetScaling,this.titleCenter=ue.TestBit(ke.rb.kCenterTitle),this.titleOpposite=ue.TestBit(ke.rb.kOppositeTitle)):(delete this.titleSize,delete this.titleFont,delete this.offsetScaling,delete this.titleOffset,delete this.titleCenter,delete this.titleOpposite)}drawAxis(F,J,Y,ue,Q,me,X,B,$){var A=this;return(0,Ee.A)(function*(){const E=A.getObject(),g=A.swap_side||!1;let v=F,f=!0;Q?A.invert_side&&(Q=-Q):Q=0,A.extractDrawAttributes(void 0,J,Y),A.is_gaxis&&(f=0!==E.fLineColor),A.lineatt.not_standard=!0,(!A.is_gaxis||"zaxis"===A.name)&&(v=F.selectChild(`.${A.name}_container`),v.empty()?v=F.append("svg:g").attr("class",`${A.name}_container`):v.selectAll("*").remove());let C="";f&&(C="M0,0"+(A.vertical?`v${Y}`:`h${J}`),Q&&(C+=A.vertical?`M${Q},0v${Y}`:`M0,${Q}h${J}`)),v.attr("transform",ue);let I=1,U=0;A.optionPlus&&A.optionMinus?(I=1,U=1):A.optionMinus?I=g^A.vertical?1:-1:A.optionPlus&&(I=g^A.vertical?-1:1);const k=A.createTicks(!1,A.optionNoexp,A.optionNoopt,A.optionInt);C+=A.produceTicksPath(k,I,A.ticksSize,U,Q,f&&!me&&!A.disable_ticks),!me&&C&&!A.lineatt.empty()&&v.append("svg:path").attr("d",C).call(A.lineatt.func);let Z=0,ee=0,he=null,G=0;return(me||A.optionUnlab?Promise.resolve(0):A.drawLabels(v,E,J,Y,k,I,A.labelsFont,A.labelsOffset,A.ticksSize,U,X,$)).then(P=>{if(G=P,x.settings.Zooming&&!A.disable_zooming&&!A.isBatchMode()){const we=Math.max(A.labelsFont.size,5),Me=v.append("svg:rect").attr("class","axis_zoom").style("opacity","0").style("cursor","crosshair");if(A.vertical){const je=(G||2*we)+3;Me.attr("x",I>0?-je:0).attr("y",0).attr("width",je).attr("height",Y)}else Me.attr("x",0).attr("y",I>0?0:-we-3).attr("width",J).attr("height",we+3)}if(A.position=0,B){const we=v.node(),Me=A.getPadSvg().node();if(we&&Me&&we.getBoundingClientRect&&Me.getBoundingClientRect){const je=we.getBoundingClientRect(),Ge=Me.getBoundingClientRect();A.position=je.left-Ge.left}we&&!Me&&console.warn("Why PAD element missing when search for position")}if(!A.fTitle||me)return!0;he=v.append("svg:g").attr("class","axis_title");let T=I;const z=E.TestBit(ke.rb.kRotateTitle)?-1:1;A.startTextDrawing(A.titleFont,"font",he);const W=g^A.titleOpposite;return A.title_align=A.titleCenter?"middle":z<0^W?"begin":"end",A.vertical?(T*=-1.6,Z=Math.round(T*A.titleOffset),ee=Math.round(A.titleCenter?Y/2:W?Y:0),A.drawText({align:A.title_align+";middle",rotate:z<0?90:270,text:A.fTitle,color:A.titleFont.color,draw_g:he})):(T*=1.6,Z=Math.round(A.titleCenter?J/2:W?0:J),ee=Math.round(T*A.titleOffset),A.drawText({align:A.title_align+";middle",rotate:z<0?180:0,text:A.fTitle,color:A.titleFont.color,draw_g:he})),A.addTitleDrag(he,A.vertical,T,g,A.vertical?Y:J),A.finishTextDrawing(he)}).then(()=>(he&&(!A.titleOffset&&A.vertical&&G&&(Z=Math.round(-I*(G+.7*A.offsetScaling*A.titleSize))),(0,ve.bk)(he,Z,ee),he.property("shift_x",Z).property("shift_y",ee)),A))})()}}},4483:(Yr,mt,Se)=>{"use strict";Se.r(mt),Se.d(mt,{TCanvasPainter:()=>Y,TPadPainter:()=>Ze.jg,drawTFrame:()=>B,drawTPadSnapshot:()=>me,ensureTCanvas:()=>ue});var Ee=Se(4882),x=Se(8872),L=Se(8362),ve=Se(5992),ke=Se(6157),ot=Se(1922),Ye=Se(5638),Ze=Se(5102);const Re=(0,x.BIT)(15),He=(0,x.BIT)(17),Ve=(0,x.BIT)(18),De=(0,x.BIT)(19),F=(0,x.BIT)(23);function J(A,E,g){const v=new Ye.nc(A,E);return v.addToPadPrimitives(),"3d"===g&&(v.mode3d=!0),v.redraw()}class Y extends Ze.jg{constructor(E,g){super(E,g,!0),this._websocket=null,this.tooltip_allowed=x.settings.Tooltip,null===E&&null===g&&(x.settings.SmallPad.width=20,x.settings.SmallPad.height=10)}cleanup(){this._changed_layout&&this.setLayoutKind("simple"),delete this._changed_layout,super.cleanup()}getLayoutKind(){const E=this.selectDom("origin");return(E.empty()?"":E.property("layout"))||"simple"}setLayoutKind(E,g){const v=this.selectDom("origin");v.empty()||(E||(E="simple"),v.property("layout",E),v.property("layout_selector","simple"!==E&&g?g:null),this._changed_layout="simple"!==E)}changeLayout(E,g){var v=this;return(0,Ee.A)(function*(){if(v.getLayoutKind()===E)return!0;const C=v.selectDom("origin"),I=C.select(".side_panel2"),U=[];let ee,k=C.select(".side_panel"),Z=v.selectDom();for(;Z.node().firstChild;)U.push(Z.node().removeChild(Z.node().firstChild));if(k.empty()||(0,ot.tP)(k.node()),I.empty()||(0,ot.tP)(I.node()),v.setLayoutKind("simple"),C.html(""),"simple"===E){Z=C;for(let he=0;he<U.length;++he)Z.node().appendChild(U[he]);v.setLayoutKind(E),ee=!0}else{const he=new ke.ho(C.node(),E);void 0===g&&(g=0===E.indexOf("vert")?0:1),Z=(0,L.Lt)(he.getGridFrame(g)),Z.classed("central_panel",!0).style("position","relative"),2===g?(k=(0,L.Lt)(he.getGridFrame(0)),k.classed("side_panel2",!0).style("position","relative"),k=(0,L.Lt)(he.getGridFrame(3)),k.classed("side_panel",!0).style("position","relative")):(k=(0,L.Lt)(he.getGridFrame(1-g)),k.classed("side_panel",!0).style("position","relative"));for(let G=0;G<U.length;++G)Z.node().appendChild(U[G]);v.setLayoutKind(E,".central_panel"),C.property("mdi",null)}return(0,ot.XR)(Z.node(),ee),!0})()}toggleProjection(E){var g=this;return(0,Ee.A)(function*(){if(delete g.proj_painter,E&&(g.proj_painter={X:!1,Y:!1}),(0,x.isFunc)(g.showUI5ProjectionArea))return g.showUI5ProjectionArea(E);let f,v="simple";switch(E){case"XY":v="projxy",f=2;break;case"X":case"bottom":v="vert2_31",f=0;break;case"Y":case"left":v="horiz2_13",f=1;break;case"top":v="vert2_13",f=1;break;case"right":v="horiz2_31",f=0}return g.changeLayout(v,f)})()}drawProjection(E,g,v){var f=this;return(0,Ee.A)(function*(){if(!f.proj_painter)return!1;if(void 0===v&&(v="hist"),E||(E="X"),!f.proj_painter[E]){f.proj_painter[E]="init";const C=(0,x.create)(x.clTCanvas),I=f.pad,U=f.getFramePainter();let k;return"X"===E?(C.fLeftMargin=I.fLeftMargin,C.fRightMargin=I.fRightMargin,C.fLogx=U.logx,C.fUxmin=U.logx?Math.log10(U.scale_xmin):U.scale_xmin,C.fUxmax=U.logx?Math.log10(U.scale_xmax):U.scale_xmax,k="fixframe"):"Y"===E&&(C.fBottomMargin=I.fBottomMargin,C.fTopMargin=I.fTopMargin,C.fLogx=U.logy,C.fUxmin=U.logy?Math.log10(U.scale_ymin):U.scale_ymin,C.fUxmax=U.logy?Math.log10(U.scale_ymax):U.scale_ymax,k="rotate"),C.fPrimitives.Add(g,v),((0,x.isFunc)(f.drawInUI5ProjectionArea)?f.drawInUI5ProjectionArea(C,k,E):f.drawInSidePanel(C,k,E)).then(ee=>(f.proj_painter[E]=ee,ee))}return(0,x.isStr)(f.proj_painter[E])?(console.log("Not ready with first painting",E),!0):(f.proj_painter[E].getMainPainter()?.updateObject(g,v),f.proj_painter[E].redrawPad())})()}testUI5(){return!!this.use_openui&&(console.warn("full ui5 should be used - not loaded yet? Please check!!"),!0)}drawInSidePanel(E,g,v){var f=this;return(0,Ee.A)(function*(){const C="projxy"===f.getLayoutKind()&&"Y"===v?".side_panel2":".side_panel",I=f.selectDom("origin").select(C);return I.empty()?null:f.drawObject(I.node(),E,g)})()}showMessage(E){this.testUI5()||(0,ve.Rh)(E,7e3)}saveCanvasAsFile(E){const g=E.indexOf(".");this.createImage(E.slice(g+1)).then(v=>this.sendWebsocket(`SAVE:${E}:${v}`))}sendSaveCommand(E){this.sendWebsocket("PRODUCE:"+E)}submitMenuRequest(E,g,v){var f=this;return(0,Ee.A)(function*(){return new Promise(C=>{f._getmenu_callback=C,f.sendWebsocket("GETMENU:"+v)})})()}submitExec(E,g,v){if(!this._readonly&&E&&(v||(v=E.snapid),v&&(0,x.isStr)(v)&&g))return this.sendWebsocket(`OBJEXEC:${v}:${g}`)}sendWebsocket(E){return this._websocket?.canSend()?(this._websocket.send(E),!0):(console.warn(`DROP SEND: ${E}`),!1)}closeWebsocket(E){this._websocket&&(this._websocket.close(E),this._websocket.cleanup(),delete this._websocket)}useWebsocket(E){this.closeWebsocket(),this._websocket=E,this._websocket.setReceiver(this),this._websocket.connect()}websocketTimeout(E,g){if(!this._websocket)return;this._websocket._tmouts||(this._websocket._tmouts={});const v=this._websocket._tmouts[E];if(void 0===g)return void 0!==v;"reset"===g?v&&(clearTimeout(v),delete this._websocket._tmouts[E]):!v&&Number.isInteger(g)&&(this._websocket._tmouts[E]=setTimeout(()=>{delete this._websocket._tmouts[E]},g))}onWebsocketOpened(){}onWebsocketClosed(){this.embed_canvas||(0,ve.W4)()}onWebsocketMsg(E,g){if("CLOSE"===g)this.onWebsocketClosed(),this.closeWebsocket(!0);else if("SNAP6:"===g.slice(0,6)){const v=g.indexOf(":",6),f=g.slice(6,v),C=(0,x.parse)(g.slice(v+1));this.syncDraw(!0).then(()=>{this.snapid||this.resizeBrowser(C.fSnapshot.fWindowWidth,C.fSnapshot.fWindowHeight),!this.snapid&&(0,x.isFunc)(this.setFixedCanvasSize)&&(this._online_fixed_size=this.setFixedCanvasSize(C.fSnapshot.fCw,C.fSnapshot.fCh,C.fFixedSize))}).then(()=>this.redrawPadSnap(C)).then(()=>{this.completeCanvasSnapDrawing();let I=this.getWebPadOptions();I&&(I=":"+I),E.send(`READY6:${f}${I}`),this.confirmDraw()})}else if("MENU:"===g.slice(0,5)){const v=(0,x.parse)(g.slice(5));(0,x.isFunc)(this._getmenu_callback)&&(this._getmenu_callback(v),delete this._getmenu_callback)}else if("CMD:"===g.slice(0,4)){const v=(g=g.slice(4)).indexOf(":"),f=g.slice(0,v),C=g.slice(v+1),I=`REPLY:${f}:`;"SVG"===C||"PNG"===C||"JPEG"===C?this.createImage(C.toLowerCase()).then(U=>E.send(I+U)):(console.log(`Unrecognized command ${C}`),E.send(I))}else if("DXPROJ:"===g.slice(0,7)||"DYPROJ:"===g.slice(0,7)){const v=g[1],f=(0,x.parse)(g.slice(7));this.websocketTimeout(`proj${v}`,"reset"),this.drawProjection(v,f)}else if("CTRL:"===g.slice(0,5)){const v=(0,x.parse)(g.slice(5))||{};let f=!1;if(void 0!==v.title&&typeof document<"u"&&(document.title=v.title),v.x&&v.y&&typeof window<"u"&&(window.moveTo(v.x,v.y),f=!0),v.w&&v.h&&(this.resizeBrowser(Number.parseInt(v.w),Number.parseInt(v.h)),f=!0),v.cw&&v.ch&&(0,x.isFunc)(this.setFixedCanvasSize)&&(this._online_fixed_size=this.setFixedCanvasSize(Number.parseInt(v.cw),Number.parseInt(v.ch),!0),f=!0),["Menu","StatusBar","Editor","ToolBar","ToolTips"].forEach(I=>{void 0!==v[I]&&this.showSection(I,"1"===v[I])}),v.edit){const I=this.findSnap(v.edit);I&&this.showSection("Editor",!0).then(()=>this.producePadEvent("select",I.getPadPainter(),I))}v.winstate&&typeof window<"u"&&("iconify"===v.winstate?window.blur():window.focus()),f&&this.sendResized(!0)}else console.log(`unrecognized msg ${g}`)}sendResized(E){if(!this.pad||typeof window>"u")return;const g=this.getPadWidth(),v=this.getPadHeight(),f=window.screenLeft,C=window.screenTop,I=window.outerWidth,U=window.outerHeight,k=this._online_fixed_size?1:0;E||(E=g>0&&v>0&&(this.pad.fCw!==g||this.pad.fCh!==v))&&(this.pad.fCw=g,this.pad.fCh=v),E&&this.sendWebsocket(`RESIZED:${JSON.stringify([f,C,I,U,g,v,k])}`)}clickPadButton(E,g){return"ToggleGed"===E?this.activateGed(this,null,"toggle"):"ToggleStatus"===E?this.activateStatusBar("toggle"):super.clickPadButton(E,g)}hasEventStatus(){return!this.testUI5()&&(this.brlayout?this.brlayout.hasStatus():(0,ke.gZ)()?.hasStatusLine()??!1)}canStatusBar(){return this.testUI5()||this.brlayout||(0,ke.gZ)()}activateStatusBar(E){this.testUI5()||(this.brlayout?this.brlayout.createStatusLine(23,E):(0,ke.gZ)()?.createStatusLine(23,E),this.processChanges("sbits",this))}showCanvasStatus(...E){this.testUI5()||(this.brlayout||(0,ke.gZ)()?.brlayout)?.showStatus(...E)}hasGed(){return!this.testUI5()&&(this.brlayout?.hasContent()??!1)}removeGed(){this.testUI5()||(this.registerForPadEvents(null),this.ged_view&&(this.ged_view.getController().cleanupGed(),this.ged_view.destroy(),delete this.ged_view),this.brlayout?.deleteContent(!0),this.processChanges("sbits",this))}getUi5PanelData(){return{jsroot:{settings:x.settings,create:x.create,parse:x.parse,toJSON:x.toJSON,loadScript:x.loadScript,EAxisBits:ot.rb,getColorExec:ve.pp}}}activateGed(E,g,v){var f=this;return(0,Ee.A)(function*(){if(f.testUI5()||!f.brlayout)return!1;if(f.brlayout.hasContent())return"toggle"===v||!1===v?f.removeGed():E?.getPadPainter()?.selectObjectPainter(E),!0;if(!1===v)return!1;const C=f.brlayout.createBrowserBtns();return ve.IK.createSVG(C,ve.IK.diamand,15,"toggle fix-pos mode","browser").style("margin","3px").on("click",()=>f.brlayout.toggleKind("fix")),ve.IK.createSVG(C,ve.IK.circle,15,"toggle float mode","browser").style("margin","3px").on("click",()=>f.brlayout.toggleKind("float")),ve.IK.createSVG(C,ve.IK.cross,15,"delete GED","browser").style("margin","3px").on("click",()=>f.removeGed()),f.brlayout.setBrowserContent("<div class='jsroot_browser_hierarchy' id='ged_placeholder'>Loading GED ...</div>"),f.brlayout.setBrowserTitle("GED"),f.brlayout.toggleBrowserKind(g||"float"),new Promise(I=>{(0,ve.cA)().then(U=>{(0,L.Lt)("#ged_placeholder").text(""),U.ui.require(["sap/ui/model/json/JSONModel","sap/ui/core/mvc/XMLView"],(k,Z)=>{const ee=new k({handle:null});Z.create({viewName:"rootui5.canv.view.Ged",viewData:f.getUi5PanelData("Ged")}).then(he=>{he.setModel(ee),he.placeAt("ged_placeholder"),f.ged_view=he,f.registerForPadEvents(he.getController().padEventsReceiver.bind(he.getController())),E?.getPadPainter()?.selectObjectPainter(E),console.log("activate GED"),f.processChanges("sbits",f),I(!0)})})})})})()}showSection(E,g){var v=this;return(0,Ee.A)(function*(){if(v.testUI5())return!1;switch(E){case"Menu":case"ToolBar":break;case"StatusBar":v.activateStatusBar(g);break;case"Editor":return v.activateGed(v,null,!!g);case"ToolTips":v.setTooltipAllowed(g)}return!0})()}completeCanvasSnapDrawing(){this.pad&&(typeof document<"u"&&!this.embed_canvas&&this._websocket&&(document.title=this.pad.fTitle),!this._all_sections_showed&&(this._all_sections_showed=!0,this.showSection("Menu",this.pad.TestBit(He)),this.showSection("StatusBar",this.pad.TestBit(Re)),this.showSection("ToolBar",this.pad.TestBit(Ve)),this.showSection("Editor",this.pad.TestBit(De)),this.showSection("ToolTips",this.pad.TestBit(F)||this._highlight_connect)))}processHighlightConnect(E){if(!E||0===E.length||!this._highlight_connect||!this._websocket||this.doingDraw()||!this._websocket.canSend(2))return;const g=E[0]||E[1];if(!(g&&g.painter&&g.painter.snapid&&g.user_info))return;const v=g.painter.getPadPainter()||this;if(!v.snapid)return;const f=[v.snapid,g.painter.snapid,"0","0"];void 0!==g.user_info.binx&&void 0!==g.user_info.biny?(f[2]=g.user_info.binx.toString(),f[3]=g.user_info.biny.toString()):void 0!==g.user_info.bin&&(f[2]=g.user_info.bin.toString());const C=JSON.stringify(f);this._last_highlight_msg!==C&&(this._last_highlight_msg=C,this.sendWebsocket(`HIGHLIGHT:${C}`))}processChanges(E,g,v){if(!this._websocket||this._readonly||!this._websocket.canSend(2)||!(0,x.isStr)(E))return;let f="";switch(g||(g=this),E){case"sbits":f="STATUSBITS:"+this.getStatusBits();break;case"frame":case"zoom":(0,x.isFunc)(g.getWebPadOptions)||(g=g.getPadPainter()),(0,x.isFunc)(g.getWebPadOptions)&&(f="OPTIONS6:"+g.getWebPadOptions("only_this"));break;case"padpos":f="OPTIONS6:"+g.getWebPadOptions("with_subpads");break;case"drawopt":g.snapid&&(f="DRAWOPT:"+JSON.stringify([g.snapid.toString(),g.getDrawOpt()||""]));break;case"pave_moved":{const C=(0,Ze.O4)(g);C&&(f="PRIMIT6:"+(0,x.toJSON)(C));break}case"logx":case"logy":case"logz":{const C=g.getPadPainter();C?.snapid&&C?.pad&&(g=C,E=`exec:${"SetLog"+E[3]}(${C.pad["fLog"+E[3]]})`);break}}if(!f&&(0,x.isFunc)(g?.getSnapId)&&"exec:"===E.slice(0,5)){const C=g.getSnapId(v);C&&(f="PRIMIT6:"+(0,x.toJSON)({_typename:"TWebObjectOptions",snapid:C,opt:E.slice(5),fcust:"exec",fopt:[]}))}f?this._websocket.send(f):console.log(`Unprocessed changes ${E} for painter of ${g?.getObject()?._typename} subelem ${v}`)}selectActivePad(E,g,v){if(!this.snapid||!E)return;let f=null,C=!1;const I=E.matchObjectType(Ze.cw);E.snapid&&this._websocket&&(f={_typename:"TWebPadClick",padid:E.snapid.toString(),objid:"",x:-1,y:-1,dbl:!1}),!E.is_active_pad&&!I&&(C=!0,this.forEachPainterInPad(U=>U.drawActiveBorder(null,U===E),"pads")),void 0!==g?.snapid&&f&&(C=!0,f.objid=g.snapid.toString()),v&&f&&(C=!0,f.x=Math.round(v.x||0),f.y=Math.round(v.y||0),v.dbl&&(f.dbl=!0)),f&&(C||I)&&this.sendWebsocket("PADCLICKED:"+(0,x.toJSON)(f))}getStatusBits(){let E=0;return this.hasEventStatus()&&(E|=Re),this.hasGed()&&(E|=De),this.isTooltipAllowed()&&(E|=F),this.use_openui&&(E|=He),E}produceJSON(){const E=this.getObject(),g=0===E.fFillStyle;g&&(E.fFillStyle=1001),this.normal_canvas||this.forEachPainterInPad(f=>{if(f.isSecondary())return;const C=f.getObject();C?._typename&&E.fPrimitives.Add(C,f.getDrawOpt())},"objects");const v=(0,x.toJSON)(E);return g&&(E.fFillStyle=0),this.normal_canvas||E.fPrimitives.Clear(),v}resizeBrowser(E,g){!E||!g||this.isBatchMode()||this.embed_canvas||this.batch_mode||this._websocket?.resizeWindow(E,g)}static draw(E,g,v){return(0,Ee.A)(function*(){const f=!g;f&&(g=(0,x.create)(x.clTCanvas));const C=new Y(E,g);if(C.checkSpecialsInPrimitives(g),!f&&g.fCw&&g.fCh&&!C.isBatchMode()){const I=C.selectDom().node().getBoundingClientRect();!I.height&&I.width>.1*g.fCw&&(C.selectDom().style("width",g.fCw+"px").style("height",g.fCh+"px"),C._fixed_size=!0)}return C.decodeOptions(v),C.normal_canvas=!f,C.createCanvasSvg(0),C.addPadButtons(),f&&v.indexOf("noframe")<0&&J(E,null),(0,ot.QD)({pp:C,active:!0}),C.drawPrimitives().then(()=>(C.showPadButtons(),C))})()}}function ue(A,E){return Q.apply(this,arguments)}function Q(){return(Q=(0,Ee.A)(function*(A,E){if(!A)return Promise.reject(Error("Painter not provided in ensureTCanvas"));const g=!1===E||"3d"===E?"noframe":"";return(A.getCanvSvg().empty()?Y.draw(A.getDom(),null,g):Promise.resolve(!0)).then(()=>(!1!==E&&A.getFrameSvg().selectChild(".main_layer").empty()&&!A.getFramePainter()&&J(A.getDom(),null,E),A.addToPadPrimitives(),A))})).apply(this,arguments)}function me(A,E){return X.apply(this,arguments)}function X(){return(X=(0,Ee.A)(function*(A,E){const g=(0,x.create)(x.clTCanvas),v=new Y(A,g);return v.normal_canvas=!1,v.addPadButtons(),v.syncDraw(!0).then(()=>v.redrawPadSnap(E)).then(()=>(v.confirmDraw(),v.showPadButtons(),v))})).apply(this,arguments)}function B(A,E,g){return $.apply(this,arguments)}function $(){return($=(0,Ee.A)(function*(A,E,g){const v=new Ye.nc(A,E);return v.mode3d="3d"===g,ue(v,!1).then(()=>v.redraw())})).apply(this,arguments)}},5638:(Yr,mt,Se)=>{"use strict";Se.d(mt,{G_:()=>A,WJ:()=>$,nc:()=>g,qP:()=>Y,wM:()=>E});var Ee=Se(4882),x=Se(8872),L=Se(8362),ve=Se(2843),ke=Se(1922),ot=Se(4082),Ye=Se(2866),Ze=Se(4246),Re=Se(7900),He=Se(5992);const De=3e-4;function F(v,f){if(!v)return;const C=v.getFramePainter();(0,x.isFunc)(C?.setTooltipEnabled)&&(C.setTooltipEnabled(f),C.processFrameTooltipEvent(null)),(0,x.isFunc)(v.control?.setTooltipEnabled)&&v.control.setTooltipEnabled(f)}function J(v,f){return v.$touch_arr??(0,L.D_)(v,f)}function Y(v){switch(v){case 1:return(f,C)=>{const I=Math.PI/180,U=f/2*I,k=C*I,Z=Math.sqrt(2),ee=2*Z/Math.PI,he=Math.cos(k),G=Math.sqrt(1+he*Math.cos(U));return{x:he*Math.sin(U)*2*Z/G/ee/I,y:Math.sin(k)*Z/G/ee/I}};case 2:return(f,C)=>({x:f,y:Math.log(Math.tan((Math.PI/2+C/180*Math.PI)/2))});case 3:return(f,C)=>({x:f*Math.cos(C/180*Math.PI),y:C});case 4:return(f,C)=>({x:f*(2*Math.cos(2*C/180*Math.PI/3)-1),y:180*Math.sin(C/180*Math.PI/3)});case 5:return(f,C)=>{const I=C*Math.PI/180;let k,Z,U=I;for(let ee=0;ee<100;ee++){if(k=2*U+Math.sin(2*U)-Math.PI*Math.sin(I),Z=4*Math.cos(U)**2,Z<1e-20){U=I;break}if(U-=k/Z,Math.abs(k/Z)<1e-4)break}return{x:f*Math.cos(U),y:90*Math.sin(U)}}}}function ue(v){if(!(0,x.isFunc)(v?.getDimension)||1!==v.getDimension())return;const f=v.draw_content?v.hmin:v.ymin,C=v.draw_content?v.hmax:v.ymax;v.zoom_ymin!==v.zoom_ymax&&f!==C&&f<=v.zoom_ymin&&v.zoom_ymax<=C&&(v.zoom_ymin=v.zoom_ymax=0)}let Q=null,me="",X=null;function B(v,f){return Q&&X===v&&me===f}function $(v,f){if(!x.settings.MoveResize)return;const C=v,I=C.getPadPainter();if(I?._fast_drawing||I?.isBatchMode())return;function U(G,b){function P(T,z){const W="js_"+T.replace(/[-]/g,"_");let fe=G.selectChild("."+W);if(f.cleanup)return fe.remove();fe.empty()&&(fe=G.append("path").classed(W,!0)),fe.style("opacity",0).style("cursor",T).attr("d",z),b&&fe.call(b)}P("nw-resize","M2,2h15v-5h-20v20h5Z"),P("ne-resize",`M${f.width-2},2h-15v-5h20v20h-5 Z`),P("sw-resize",`M2,${f.height-2}h15v5h-20v-20h5Z`),P("se-resize",`M${f.width-2},${f.height-2}h-15v5h20v-20h-5Z`),f.no_change_x||(P("w-resize",`M-3,18h5v${Math.max(0,f.height-36)}h-5Z`),P("e-resize",`M${f.width+3},18h-5v${Math.max(0,f.height-36)}h5Z`)),f.no_change_y||(P("n-resize",`M18,-3v5h${Math.max(0,f.width-36)}v-5Z`),P("s-resize",`M18,${f.height+3}v-5h${Math.max(0,f.width-36)}v5Z`))}!1===I?.isEditable()&&(f.cleanup=!0),(0,x.isFunc)(f.getDrawG)||(f.getDrawG=()=>C?.draw_g);const k=(G,b,P,T)=>{X=null,me="",Q&&(Q.remove(),Q=null);const z=f.getDrawG();if(!z)return!1;const W=f.x,fe=f.y;f.minwidth&&P<f.minwidth&&(P=f.minwidth),f.minheight&&T<f.minheight&&(T=f.minheight);const we=P!==f.width||T!==f.height,Me=G!==W||b!==fe;if(f.x=G,f.y=b,f.width=P,f.height=T,f.no_transform||(0,ve.bk)(z,G,b),F(C,!0),U(z),(we||Me)&&(we&&(0,x.isFunc)(f.resize)&&f.resize(P,T),Me&&(0,x.isFunc)(f.move)&&f.move(G,b,G-W,b-fe),we||Me)){if(f.obj){const je=f.pad_rect??I.getPadRect();f.obj.fX1NDC=G/je.width,f.obj.fX2NDC=(G+P)/je.width,f.obj.fY1NDC=1-(b+T)/je.height,f.obj.fY2NDC=1-b/je.height,f.obj.modified_NDC=!0}else(0,x.isFunc)(f.move_resize)&&f.move_resize(G,b,P,T);(0,x.isFunc)(f.redraw)&&f.redraw(f)}return we||Me},Z=(0,L.$E)().subject(Object),ee=(0,L.$E)().subject(Object);ee.on("start",null).on("drag",null).on("end",null),Z.on("start",function(G){if((0,He.iE)(G.sourceEvent)||me||(0,x.isFunc)(f.is_disabled)&&f.is_disabled("move"))return;(0,Re.IV)(),F(C,!1),G.sourceEvent.preventDefault(),G.sourceEvent.stopPropagation();const b=f.pad_rect??I.getPadRect(),P={x:f.x,y:f.y,width:f.width,height:f.height,acc_x1:f.x,acc_y1:f.y,pad_w:b.width-f.width,pad_h:b.height-f.height,drag_tm:new Date,path:`v${f.height}h${f.width}v${-f.height}z`,evnt_x:G.x,evnt_y:G.y};X=C,me="move",Q=(0,L.Lt)(f.getDrawG().node().parentNode).append("path").attr("d",`M${P.acc_x1},${P.acc_y1}${P.path}`).style("cursor","move").style("pointer-events","none").property("drag_handle",P).call(ve.Ru,!0)}).on("drag",function(G){if(!B(C,"move"))return;G.sourceEvent.preventDefault(),G.sourceEvent.stopPropagation();const b=Q.property("drag_handle");f.no_change_x||(b.acc_x1+=G.dx),f.no_change_y||(b.acc_y1+=G.dy),b.x=Math.min(Math.max(b.acc_x1,0),b.pad_w),b.y=Math.min(Math.max(b.acc_y1,0),b.pad_h),Q.attr("d",`M${b.x},${b.y}${b.path}`)}).on("end",function(G){if(!B(C,"move"))return;G.sourceEvent.stopPropagation(),G.sourceEvent.preventDefault();const b=Q.property("drag_handle");if(!1===k(b.x,b.y,f.width,f.height)){const P=(new Date).getTime()-b.drag_tm.getTime();f.ctxmenu&&P>600?(0,Re.sj)({clientX:b.evnt_x,clientY:b.evnt_y,skip_close:1},C):f.canselect&&P<=600&&C.getPadPainter()?.selectObjectPainter(C)}});const he=(0,L.$E)().subject(Object);he.on("start",function(G){if((0,He.iE)(G.sourceEvent)||me||(0,x.isFunc)(f.is_disabled)&&f.is_disabled("resize"))return;(0,Re.IV)(),F(C,!1),G.sourceEvent.stopPropagation(),G.sourceEvent.preventDefault();const b=f.pad_rect??I.getPadRect(),P={x:f.x,y:f.y,width:f.width,height:f.height,acc_x1:f.x,acc_y1:f.y,acc_x2:f.x+f.width,acc_y2:f.y+f.height,pad_w:b.width,pad_h:b.height};X=C,me="resize",Q=(0,L.Lt)(f.getDrawG().node().parentNode).append("rect").style("cursor",(0,L.Lt)(this).style("cursor")).attr("x",P.acc_x1).attr("y",P.acc_y1).attr("width",P.acc_x2-P.acc_x1).attr("height",P.acc_y2-P.acc_y1).property("drag_handle",P).call(ve.Ru,!0)}).on("drag",function(G){if(!B(C,"resize"))return;G.sourceEvent.preventDefault(),G.sourceEvent.stopPropagation();const b=Q.property("drag_handle"),P=(0,L.Lt)(this);let T=G.dx,z=G.dy;f.no_change_x&&(T=0),f.no_change_y&&(z=0),P.classed("js_nw_resize")?(b.acc_x1+=T,b.acc_y1+=z):P.classed("js_ne_resize")?(b.acc_x2+=T,b.acc_y1+=z):P.classed("js_sw_resize")?(b.acc_x1+=T,b.acc_y2+=z):P.classed("js_se_resize")?(b.acc_x2+=T,b.acc_y2+=z):P.classed("js_w_resize")?b.acc_x1+=T:P.classed("js_n_resize")?b.acc_y1+=z:P.classed("js_e_resize")?b.acc_x2+=T:P.classed("js_s_resize")&&(b.acc_y2+=z);const W=Math.max(0,b.acc_x1),fe=Math.min(b.acc_x2,b.pad_w),we=Math.max(0,b.acc_y1),Me=Math.min(b.acc_y2,b.pad_h);b.x=Math.min(W,fe),b.y=Math.min(we,Me),b.width=Math.abs(fe-W),b.height=Math.abs(Me-we),Q.attr("x",b.x).attr("y",b.y).attr("width",b.width).attr("height",b.height)}).on("end",function(G){if(!B(C,"resize"))return;G.sourceEvent.preventDefault();const b=Q.property("drag_handle");k(b.x,b.y,b.width,b.height)}),f.only_resize||f.getDrawG().style("cursor",f.cleanup?null:"move").call(f.cleanup?ee:Z),f.only_move||U(f.getDrawG(),he)}const A={hints_layer(){return this.getCanvPainter()?.getLayerSvg("info_layer")??(0,L.Lt)(null)},isTooltipShown(){if(!this.tooltip_enabled||!this.isTooltipAllowed())return!1;const v=this.hints_layer().selectChild(".objects_hints");return!v.empty()&&v.property("hints_pad")===this.getPadName()},setTooltipEnabled(v){void 0!==v&&(this.tooltip_enabled=v)},processFrameTooltipEvent(v,f){if(v?.handler){const Sn=this.draw_g?.selectChild(".main_layer");if(!Sn||Sn.empty())v=null;else if(v.touch&&f){const ii=J(f,Sn.node());v=ii&&1===ii.length?{touch:!0,x:ii[0][0],y:ii[0][1]}:null}else if(f){const ii=(0,L.Wn)(f,Sn.node());v={touch:!1,x:ii[0],y:ii[1]}}}let C=0,I=0,U=0,k=0,Z=!1,ee=11;const P=this.getFrameRect(),T=this.getPadPainter(),z=T?.getPadWidth(),W=new Ze.qg(160,ee),fe=!this.isTooltipAllowed()||!this.tooltip_enabled;v&&(v.disabled=fe,v.painters=!0);const we=T?.processPadTooltipEvent(v)??[];T?._deliver_webcanvas_events&&T?.is_active_pad&&v&&(0,x.isFunc)(T?.deliverWebCanvasEvent)&&T.deliverWebCanvasEvent("move",P.x+v.x,P.y+v.y,we),v?.touch&&(ee=15);for(let Sn=0;Sn<we.length;++Sn){const ii=we[Sn];if(ii){if(void 0!==ii.user_info&&ii.painter?.provideUserTooltip(ii.user_info),!ii.lines||0===ii.lines.length){we[Sn]=null;continue}for(let ai=0;ai<Sn;++ai){const Hi=we[ai];let ti=!1;if(Hi&&Hi.lines.length===ii.lines.length){for(let Nr=0;Nr<ii.lines.length&&!ti;++Nr)Hi.lines[Nr]!==ii.lines[Nr]&&(ti=!0);if(!ti){we[Sn]=null;break}}}we[Sn]&&(C++,ii.exact&&I++,ii.lines.forEach(ai=>{U=Math.max(U,ai.length)}),ii.height=Math.round(ii.lines.length*ee*1.2+6-ee*(1.2-1)),void 0!==ii.color1&&"none"!==ii.color1&&(0!==k&&k!==ii.color1&&(Z=!0),k=ii.color1))}}let Me=null,je=we.length>1;for(let Sn=0;Sn<we.length;++Sn){const ii=we[Sn],ai=ii?.lines?ii.lines[0]?.lastIndexOf("/"):-1;if(ai>0){const Hi=ii.lines[0].slice(0,ai+1);null===Me?Me=Hi:Me!==Hi&&(je=!1)}else je=!1}const Ge=this.hints_layer(),lt=C>15,bt=v?Math.round(v.x)+","+Math.round(v.y):"";let te=Ge.selectChild(".objects_hints"),Je="",tt="",Fe="",Ne=null,rt=1e10,St=null;for(let Sn=0;Sn<we.length;++Sn){if(!we[Sn])continue;if(Ne||(Ne=we[Sn]),we[Sn].exact&&I<2&&(!Ne||!Ne.exact)){Ne=we[Sn];break}if(!v||void 0===we[Sn].x||void 0===we[Sn].y)continue;const ii=(v.x-we[Sn].x)**2+(v.y-we[Sn].y)**2;ii<rt&&(rt=ii,St=we[Sn])}if((!Ne||!Ne.exact)&&rt<400&&(Ne=St),Ne&&(tt=Ne.lines&&Ne.lines.length>1?Ne.lines[0]:Ne.name,Je=Ne.title||"",Fe=Ne.line,!Fe&&Ne.lines&&(Fe=Ne.lines.slice(1).join(" "))),this.showObjectStatus(tt,Je,Fe,bt),!v||fe||0===we.length||0===U||lt&&!St)return void te.remove();te.empty()&&(te=Ge.append("svg:g").attr("class","objects_hints").style("pointer-events","none"));let pt={x:0,y:0},st=P.transform||"";T.iscan||(pt=(0,ve.md)(this.getPadSvg(),pt),st=`translate(${pt.x},${pt.y}) ${st}`),te.attr("transform",st).property("last_point",v).property("hints_pad",this.getPadName());let vt=te.property("viewmode")||"",Yt=0,qt=v.x+P.hint_delta_x;if(lt||1===C)vt="single",qt+=15;else{let Sn=.5,ii=.5;"left"===vt?ii=.7:"right"===vt&&(Sn=.3),qt<=Sn*P.width?(vt="left",qt=20):qt>=ii*P.width?(vt="right",qt=P.width-60):qt=te.property("startx")}vt!==te.property("viewmode")&&(te.property("viewmode",vt),te.selectAll("*").remove());let Ot=10,Bn=10,Mn=-1111,bn=-1111;const Dn=-pt.y,$n=this.getCanvPainter(),Cn=$n.getPadHeight()-P.y-pt.y;for(let Sn=0;Sn<we.length;++Sn){let Nr=function(){return function(){return function(ss){return ss<.8?"0":5*(ss-.8)}}},ii=we[Sn],ai=te.selectChild(`.painter_hint_${Sn}`);if(lt&&ii!==St&&(ii=null),null===ii){ai.remove();continue}const Hi=ai.empty();if(Hi&&(ai=te.append("svg:svg").attr("class",`painter_hint_${Sn}`).attr("opacity",0).style("overflow","hidden").style("pointer-events","none")),"single"===vt)Ot=v.touch?v.y-ii.height-5:Math.min(v.y+15,Cn-ii.height-3)+P.hint_delta_y;else{for(let ss=0;ss<we.length&&Bn<Cn;++ss){const Bs=we[ss];Bs&&Bs.y>=Bn-5&&Bs.y<=Bn+Bs.height+5&&(Bn=Bs.y+10,ss=-1)}-1111===Mn&&-1111===bn&&(Mn=bn=ii.x),Mn=Math.min(Mn,ii.x),bn=Math.min(bn,ii.x)}ai.attr("x",qt).attr("y",Ot).property("curry",Ot).property("gapy",Bn),Ot+=ii.height+5,Bn+=ii.height+5,Hi||ai.selectAll("*").remove(),ai.attr("width",60).attr("height",ii.height);const ti=ai.append("rect").attr("x",0).attr("y",0).attr("width",60).attr("height",ii.height).style("fill","lightgrey").style("pointer-events","none");if(C>1){const ss=Z?ii.color1:ii.color2;ss&&"none"!==ss&&ti.style("stroke",ss)}ti.attr("stroke-width",ii.exact?3:1);for(let ss=0;ss<(ii.lines?.length??0);ss++){let Bs=ii.lines[ss];if(0===ss&&Me&&je&&(Bs=Bs.slice(Me.length)),Bs){const yo=ai.append("svg:text").attr("text-anchor","start").attr("x",3).attr("y",3+ss*ee*1.2).attr("dy",".8em").style("fill","black").style("pointer-events","none").call(W.func).text(Bs),xt=(0,ve.xh)(yo,"bbox");Yt=Math.max(Yt,xt.width)}}Hi&&(x.settings.TooltipAnimation>0?ai.transition().duration(x.settings.TooltipAnimation).attrTween("opacity",Nr()):ai.attr("opacity",1))}Yt+=6;const yn=te.selectAll("svg");if("right"===vt&&qt+Yt>P.width-20&&(qt=P.width-Yt-20,yn.attr("x",qt)),"single"===vt&&qt+Yt>z-P.x&&qt>Yt+20&&(qt-=Yt+20,yn.attr("x",qt)),"single"!==vt&&Bn<Cn&&Bn!==Ot)Mn<=qt+Yt+5&&bn>=qt-5&&yn.attr("y",function(){return(0,L.Lt)(this).property("gapy")});else if("single"!==vt&&Ot>Cn){const Sn=Math.max(Cn-Ot-10,Dn);Sn<0&&yn.attr("y",function(){return(0,L.Lt)(this).property("curry")+Sn})}Yt>10&&yn.attr("width",Yt).select("rect").attr("width",Yt),te.property("startx",qt),$n._highlight_connect&&(0,x.isFunc)($n.processHighlightConnect)&&$n.processHighlightConnect(we)},assign(v){Object.assign(v,this,{tooltip_enabled:!0})}},E={addBasicInteractivity(){A.assign(this),!this._frame_rotate&&!this._frame_fixpos&&$(this,{obj:this,x:this._frame_x,y:this._frame_y,width:this.getFrameWidth(),height:this.getFrameHeight(),is_disabled:k=>"move"===k&&this.mode3d,only_resize:!0,minwidth:20,minheight:20,redraw:()=>this.sizeChanged()});const v=this.draw_g.selectChild("path"),f=this.draw_g.selectChild(".main_layer");v.style("pointer-events","visibleFill").style("cursor","default"),f.style("pointer-events","visibleFill").style("cursor","default").property("handlers_set",0);const C=this.getPadPainter(),I=C?._fast_drawing?0:1;if(f.property("handlers_set")!==I){const k=I?this.processFrameTooltipEvent.bind(this,null):null,Z=I?this.processFrameTooltipEvent.bind(this,{handler:!0,touch:!1}):null;if(f.property("handlers_set",I).on("mouseenter",Z).on("mousemove",Z).on("mouseleave",k),x.browser.touches){const ee=I?this.processFrameTooltipEvent.bind(this,{handler:!0,touch:!0}):null;f.on("touchstart",ee).on("touchmove",ee).on("touchend",k).on("touchcancel",k)}}f.attr("x",0).attr("y",0).attr("width",this.getFrameWidth()).attr("height",this.getFrameHeight());const U=this.hints_layer().selectChild(".objects_hints");!U.empty()&&this.isTooltipAllowed()&&U.property("hints_pad")===this.getPadName()&&setTimeout(this.processFrameTooltipEvent.bind(this,U.property("last_point"),null),10)},addFrameInteractivity(v){var f=this;return(0,Ee.A)(function*(){const C=f.getPadPainter(),I=f.getFrameSvg();if(C?._fast_drawing||I.empty())return f;if(v){const Z=I.selectAll(".x2axis_container"),ee=I.selectAll(".y2axis_container");return x.settings.ContextMenu&&(Z.on("contextmenu",he=>f.showContextMenu("x2",he)),ee.on("contextmenu",he=>f.showContextMenu("y2",he))),Z.on("mousemove",he=>f.showAxisStatus("x2",he)),ee.on("mousemove",he=>f.showAxisStatus("y2",he)),f}const U=I.selectAll(".xaxis_container"),k=I.selectAll(".yaxis_container");return f.can_zoom_x=f.can_zoom_y=x.settings.Zooming,C?.options&&(C.options.NoZoomX&&(f.can_zoom_x=!1),C.options.NoZoomY&&(f.can_zoom_y=!1)),I.property("interactive_set")||(f.addFrameKeysHandler(),f.zoom_kind=0,f.zoom_rect=null,f.zoom_origin=null,f.zoom_curr=null),x.settings.Zooming&&(x.settings.ZoomMouse&&(I.on("mousedown",Z=>f.startRectSel(Z)),I.on("dblclick",Z=>f.mouseDoubleClick(Z))),x.settings.ZoomWheel&&I.on("wheel",Z=>f.mouseWheel(Z))),x.browser.touches&&(x.settings.Zooming&&x.settings.ZoomTouch||x.settings.ContextMenu)&&I.on("touchstart",Z=>f.startTouchZoom(Z)),x.settings.ContextMenu&&(x.browser.touches&&(U.on("touchstart",Z=>f.startSingleTouchHandling("x",Z)),k.on("touchstart",Z=>f.startSingleTouchHandling("y",Z))),I.on("contextmenu",Z=>f.showContextMenu("",Z)),U.on("contextmenu",Z=>f.showContextMenu("x",Z)),k.on("contextmenu",Z=>f.showContextMenu("y",Z))),U.on("mousemove",Z=>f.showAxisStatus("x",Z)),k.on("mousemove",Z=>f.showAxisStatus("y",Z)),I.property("interactive_set",!0),f})()},addFrameKeysHandler(){this.keys_handler||typeof window>"u"||(this.keys_handler=v=>this.processKeyPress(v),window.addEventListener("keydown",this.keys_handler,!1))},processKeyPress(v){const C=this.selectDom(),I=this.getPadPainter();let U=v.key;if(!x.settings.HandleKeys||C.empty()||!1===this.enabledKeys||(0,ke.OZ)()!==I||["PageUp","PageDown","ArrowLeft","ArrowUp","ArrowRight","ArrowDown","PrintScreen","Escape","*"].indexOf(U)<0)return!1;v.shiftKey&&(U=`Shift ${U}`),v.altKey&&(U=`Alt ${U}`),v.ctrlKey&&(U=`Ctrl ${U}`);const k={name:"x",dleft:0,dright:0};switch(U){case"ArrowLeft":k.dleft=-1,k.dright=1;break;case"ArrowRight":k.dleft=1,k.dright=-1;break;case"Ctrl ArrowLeft":k.dleft=k.dright=-1;break;case"Ctrl ArrowRight":k.dleft=k.dright=1;break;case"ArrowUp":k.name="y",k.dleft=1,k.dright=-1;break;case"ArrowDown":k.name="y",k.dleft=-1,k.dright=1;break;case"Ctrl ArrowUp":k.name="y",k.dleft=k.dright=1;break;case"Ctrl ArrowDown":k.name="y",k.dleft=k.dright=-1;break;case"Escape":return I?.enlargePad(null,!1,!0),!0}if(k.dleft||k.dright){if(!x.settings.Zooming||this.mode3d&&0!==U.indexOf("Ctrl"))return!1;this.analyzeMouseWheelEvent(null,k,.5),k.changed&&(this.zoom(k.name,k.min,k.max),this.zoomChangedInteractive(k.name,!0)),v.stopPropagation(),v.preventDefault()}else{const Z=I?.findPadButton(U);Z&&(I.clickPadButton(Z),v.stopPropagation(),v.preventDefault())}return!0},processFrameClick(v,f){const C=this.getPadPainter();if(!C)return;v.painters=!0,v.disabled=!0;const I=C.processPadTooltipEvent(v);let k,U=null;for(let Z=0;Z<I.length&&!U;++Z)I[Z]&&I[Z].exact&&(U=I[Z]);if(U){const Z=f?this._dblclick_handler:this._click_handler;Z&&(k=Z(U.user_info,v))}return f||C.selectObjectPainter(U?U.painter:this,{x:v.x+(this._frame_x||0),y:v.y+(this._frame_y||0)}),k},shiftMoveHanlder(v,f){if(v.buttons===this._shifting_buttons){const C=this.getFrameSvg(),I=(0,L.Wn)(v,C.node()),U=this.draw_g.selectChild(".main_layer"),k=f[0]-I[0],Z=1===this.scales_ndim?0:f[1]-I[1],ee=this.getFrameWidth(),he=this.getFrameHeight();this._shifting_dx=k,this._shifting_dy=Z,U.attr("viewBox",`${k} ${Z} ${ee} ${he}`),v.preventDefault(),v.stopPropagation()}},shiftUpHanlder(v){v.preventDefault(),(0,L.Lt)(window).on("mousemove.shiftHandler",null).on("mouseup.shiftHandler",null),void 0!==this._shifting_dx&&void 0!==this._shifting_dy&&this.performScalesShift()},performScalesShift(){const v=this.getFrameWidth(),f=this.getFrameHeight(),C=this.draw_g.selectChild(".main_layer"),I=this.getGrFuncs(),U=I.revertAxis("x",this._shifting_dx),k=I.revertAxis("x",this._shifting_dx+v),Z=I.revertAxis("y",this._shifting_dy+f),ee=I.revertAxis("y",this._shifting_dy);C.attr("viewBox",`0 0 ${v} ${f}`),delete this._shifting_dx,delete this._shifting_dy,F(this,!0),1===this.scales_ndim?this.zoomSingle("x",U,k):this.zoom(U,k,Z,ee)},startRectSel(v){if(this.zoom_kind>100)return;const f=this.getFrameSvg(),C=(0,L.Wn)(v,f.node());if(3===v.buttons||1===v.button)return this.clearInteractiveElements(),this._shifting_buttons=v.buttons,v.$emul||(0,L.Lt)(window).on("mousemove.shiftHandler",k=>this.shiftMoveHanlder(k,C)).on("mouseup.shiftHandler",k=>this.shiftUpHanlder(k),!0),F(this,!1),v.preventDefault(),void v.stopPropagation();if(0!==v.button)return;v.preventDefault(),this.clearInteractiveElements();const I=this.getFrameWidth(),U=this.getFrameHeight();return this.zoom_lastpos=C,this.zoom_curr=[Math.max(0,Math.min(I,C[0])),Math.max(0,Math.min(U,C[1]))],this.zoom_origin=[0,0],this.zoom_second=!1,C[0]<0||C[0]>I?(this.zoom_second=C[0]>I&&this.y2_handle,this.zoom_kind=3,this.zoom_origin[1]=this.zoom_curr[1],this.zoom_curr[0]=I,this.zoom_curr[1]+=1):C[1]<0||C[1]>U?(this.zoom_second=C[1]<0&&this.x2_handle,this.zoom_kind=2,this.zoom_origin[0]=this.zoom_curr[0],this.zoom_curr[0]+=1,this.zoom_curr[1]=U):(this.zoom_kind=1,this.zoom_origin[0]=this.zoom_curr[0],this.zoom_origin[1]=this.zoom_curr[1]),v.$emul||(0,L.Lt)(window).on("mousemove.zoomRect",k=>this.moveRectSel(k)).on("mouseup.zoomRect",k=>this.endRectSel(k),!0),this.zoom_rect=null,F(this,!1),v.stopPropagation(),1!==this.zoom_kind?(0,x.postponePromise)(()=>this.startLabelsMove(),500):void 0},startLabelsMove(){if(this.zoom_rect)return;const v=2===this.zoom_kind?this.x_handle:this.y_handle;!(0,x.isFunc)(v?.processLabelsMove)||!this.zoom_lastpos||v.processLabelsMove("start",this.zoom_lastpos)&&(this.zoom_labels=v)},moveRectSel(v){if(0===this.zoom_kind||this.zoom_kind>100)return;v.preventDefault();const f=(0,L.Wn)(v,this.getFrameSvg().node());if(this.zoom_labels)return this.zoom_labels.processLabelsMove("move",f);switch(this.zoom_lastpos[0]=f[0],this.zoom_lastpos[1]=f[1],f[0]=Math.max(0,Math.min(this.getFrameWidth(),f[0])),f[1]=Math.max(0,Math.min(this.getFrameHeight(),f[1])),this.zoom_kind){case 1:this.zoom_curr[0]=f[0],this.zoom_curr[1]=f[1];break;case 2:this.zoom_curr[0]=f[0];break;case 3:this.zoom_curr[1]=f[1]}const C=Math.min(this.zoom_origin[0],this.zoom_curr[0]),I=Math.min(this.zoom_origin[1],this.zoom_curr[1]),U=Math.abs(this.zoom_curr[0]-this.zoom_origin[0]),k=Math.abs(this.zoom_curr[1]-this.zoom_origin[1]);if(!this.zoom_rect){if(1!==this.zoom_kind&&(U<2||k<2))return;this.zoom_rect=this.getFrameSvg().append("rect").style("pointer-events","none").call(ve.Ru,!0)}this.zoom_rect.attr("x",C).attr("y",I).attr("width",U).attr("height",k)},endRectSel(v){if(0===this.zoom_kind||this.zoom_kind>100)return;v.preventDefault(),v.$emul||(0,L.Lt)(window).on("mousemove.zoomRect",null).on("mouseup.zoomRect",null);const f=(0,L.Wn)(v,this.getFrameSvg().node());let I,C=this.zoom_kind;if(this.zoom_labels)this.zoom_labels.processLabelsMove("stop",f);else{const k=[this.can_zoom_x,this.can_zoom_y];switch(f[0]=Math.max(0,Math.min(this.getFrameWidth(),f[0])),f[1]=Math.max(0,Math.min(this.getFrameHeight(),f[1])),this.zoom_kind){case 1:this.zoom_curr[0]=f[0],this.zoom_curr[1]=f[1];break;case 2:this.zoom_curr[0]=f[0],k[1]=!1;break;case 3:this.zoom_curr[1]=f[1],k[0]=!1}const Z=this.swap_xy?1:0,ee=1-Z;let he,G,b,P,T=!1,z="x",W="y";k[Z]&&Math.abs(this.zoom_curr[Z]-this.zoom_origin[Z])>10&&(this.zoom_second&&2===this.zoom_kind&&(z="x2"),he=Math.min(this.revertAxis(z,this.zoom_origin[Z]),this.revertAxis(z,this.zoom_curr[Z])),G=Math.max(this.revertAxis(z,this.zoom_origin[Z]),this.revertAxis(z,this.zoom_curr[Z])),T=!0),k[ee]&&Math.abs(this.zoom_curr[ee]-this.zoom_origin[ee])>10&&(this.zoom_second&&3===this.zoom_kind&&(W="y2"),b=Math.min(this.revertAxis(W,this.zoom_origin[ee]),this.revertAxis(W,this.zoom_curr[ee])),P=Math.max(this.revertAxis(W,this.zoom_origin[ee]),this.revertAxis(W,this.zoom_curr[ee])),T=!0),"x2"===z?(this.zoomChangedInteractive(z,!0),I=this.zoomSingle(z,he,G),C=0):"y2"===W?(this.zoomChangedInteractive(W,!0),I=this.zoomSingle(W,b,P),C=0):T&&(this.zoomChangedInteractive("x",!0),this.zoomChangedInteractive("y",!0),I=this.zoom(he,G,b,P),C=0)}const U=1===C?{x:this.zoom_origin[0],y:this.zoom_origin[1]}:null;switch(this.clearInteractiveElements(),C){case 1:this.processFrameClick(U);break;case 2:this.getPadPainter()?.selectObjectPainter(this,null,"xaxis");break;case 3:this.getPadPainter()?.selectObjectPainter(this,null,"yaxis")}return I},mouseDoubleClick(v){v.preventDefault();const f=(0,L.Wn)(v,this.getFrameSvg().node()),C=this.getFrameWidth(),I=this.getFrameHeight();this.clearInteractiveElements();const U=f[0]>=0&&f[0]<=C,k=f[1]>=0&&f[1]<=I;if(U&&k&&this._dblclick_handler&&this.processFrameClick({x:f[0],y:f[1]},!0))return;let Z=(this.can_zoom_x?"x":"")+(this.can_zoom_y?"y":"")+"z";if(U){if(!k){if(!this.can_zoom_x)return;Z=this.swap_xy?"y":"x",f[1]<0&&this[Z+"2_handle"]&&(Z+="2")}}else{if(!this.can_zoom_y)return;Z=this.swap_xy?"x":"y",f[0]>C&&this[Z+"2_handle"]&&(Z+="2")}return this.unzoom(Z).then(ee=>{if(ee)return;const he=this.getPadPainter(),G=this.getFrameRect();return he?.selectObjectPainter(he,{x:f[0]+G.x,y:f[1]+G.y,dbl:!0})})},startTouchZoom(v){if(v.preventDefault(),v.stopPropagation(),0!==this.zoom_kind||me)return;const f=J(v,this.getFrameSvg().node());if(1===f.length){const Z=(new Date).getTime();let ee=1e10,he=100,G=100;this.last_touch_time&&this.last_touch_pos&&(ee=Z-this.last_touch_time,he=Math.abs(f[0][0]-this.last_touch_pos[0]),G=Math.abs(f[0][1]-this.last_touch_pos[1])),this.last_touch_time=Z,this.last_touch_pos=f[0],ee<500&&he<20&&G<20?(this.clearInteractiveElements(),this.unzoom("xyz"),delete this.last_touch_time):x.settings.ContextMenu&&this.startSingleTouchHandling("",v)}if(2!==f.length||!x.settings.Zooming||!x.settings.ZoomTouch)return;this.clearInteractiveElements(),this.endSingleTouchHandling(null);const C=f[0],I=f[1],U=this.getFrameWidth(),k=this.getFrameHeight();this.zoom_curr=[Math.min(C[0],I[0]),Math.min(C[1],I[1])],this.zoom_origin=[Math.max(C[0],I[0]),Math.max(C[1],I[1])],this.zoom_second=!1,this.zoom_curr[0]<0||this.zoom_curr[0]>U?(this.zoom_second=this.zoom_curr[0]>U&&this.y2_handle,this.zoom_kind=103,this.zoom_curr[0]=0,this.zoom_origin[0]=U):this.zoom_origin[1]>k||this.zoom_origin[1]<0?(this.zoom_second=this.zoom_origin[1]<0&&this.x2_handle,this.zoom_kind=102,this.zoom_curr[1]=0,this.zoom_origin[1]=k):this.zoom_kind=101,me="zoom",F(this,!1),this.zoom_rect=this.getFrameSvg().append("rect").attr("id","zoomRect").attr("x",this.zoom_curr[0]).attr("y",this.zoom_curr[1]).attr("width",this.zoom_origin[0]-this.zoom_curr[0]).attr("height",this.zoom_origin[1]-this.zoom_curr[1]).call(ve.Ru,!0),v.$emul||(0,L.Lt)(window).on("touchmove.zoomRect",Z=>this.moveTouchZoom(Z)).on("touchcancel.zoomRect",Z=>this.endTouchZoom(Z)).on("touchend.zoomRect",Z=>this.endTouchZoom(Z))},moveTouchZoom(v){if(this.zoom_kind<100)return;v.preventDefault();const f=J(v,this.getFrameSvg().node());if(2!==f.length)return this.clearInteractiveElements();const C=f[0],I=f[1];103!==this.zoom_kind&&(this.zoom_curr[0]=Math.min(C[0],I[0]),this.zoom_origin[0]=Math.max(C[0],I[0])),102!==this.zoom_kind&&(this.zoom_curr[1]=Math.min(C[1],I[1]),this.zoom_origin[1]=Math.max(C[1],I[1])),this.zoom_rect.attr("x",this.zoom_curr[0]).attr("y",this.zoom_curr[1]).attr("width",this.zoom_origin[0]-this.zoom_curr[0]).attr("height",this.zoom_origin[1]-this.zoom_curr[1]),(this.zoom_origin[0]-this.zoom_curr[0]>10||this.zoom_origin[1]-this.zoom_curr[1]>10)&&F(this,!1),v.stopPropagation()},endTouchZoom(v){if(this.zoom_kind<100)return;me="",v.preventDefault(),v.$emul||(0,L.Lt)(window).on("touchmove.zoomRect",null).on("touchend.zoomRect",null).on("touchcancel.zoomRect",null);let f,C,I,U,k=!1,Z="x",ee="y";const he=this.swap_xy?1:0,G=1-he,b=[!0,!0];102===this.zoom_kind&&(b[1]=!1),103===this.zoom_kind&&(b[0]=!1),b[he]&&Math.abs(this.zoom_curr[he]-this.zoom_origin[he])>10&&(this.zoom_second&&102===this.zoom_kind&&(Z="x2"),f=Math.min(this.revertAxis(Z,this.zoom_origin[he]),this.revertAxis(Z,this.zoom_curr[he])),C=Math.max(this.revertAxis(Z,this.zoom_origin[he]),this.revertAxis(Z,this.zoom_curr[he])),k=!0),b[G]&&Math.abs(this.zoom_curr[G]-this.zoom_origin[G])>10&&(this.zoom_second&&103===this.zoom_kind&&(ee="y2"),I=Math.min(this.revertAxis(ee,this.zoom_origin[G]),this.revertAxis(ee,this.zoom_curr[G])),U=Math.max(this.revertAxis(ee,this.zoom_origin[G]),this.revertAxis(ee,this.zoom_curr[G])),k=!0),this.clearInteractiveElements(),delete this.last_touch_time,"x2"===Z?(this.zoomChangedInteractive(Z,!0),this.zoomSingle(Z,f,C)):"y2"===ee?(this.zoomChangedInteractive(ee,!0),this.zoomSingle(ee,I,U)):k&&(this.zoomChangedInteractive("x",!0),this.zoomChangedInteractive("y",!0),this.zoom(f,C,I,U)),v.stopPropagation()},analyzeMouseWheelEvent(v,f,C,I,U){const k=U?this[f.name+"2_handle"]:null;return k?(f.second=Object.assign({},f),k.analyzeWheelEvent(v,C,f.second,I)):this[f.name+"_handle"]?.analyzeWheelEvent(v,C,f,I)},isAllowedDefaultYZooming(){if(this.self_drawaxes)return!0;const v=this.getPadPainter();if(v?.painters)for(let f=0;f<v.painters.length;++f){const C=v.painters[f];if(void 0!==C?.wheel_zoomy)return C.wheel_zoomy}return!1},mouseWheel(v){v.stopPropagation(),v.preventDefault(),this.clearInteractiveElements();const f={name:"x",reverse:this.reverse_x},C={name:"y",reverse:this.reverse_y,ignore:!this.isAllowedDefaultYZooming()},I=(0,L.Wn)(v,this.getFrameSvg().node()),U=this.getFrameWidth(),k=this.getFrameHeight();this.can_zoom_x&&this.analyzeMouseWheelEvent(v,this.swap_xy?C:f,I[0]/U,I[1]>=0&&I[1]<=k,I[1]<0),this.can_zoom_y&&this.analyzeMouseWheelEvent(v,this.swap_xy?f:C,1-I[1]/k,I[0]>=0&&I[0]<=U,I[0]>U);let Z=this.zoom(f.min,f.max,C.min,C.max);return f.changed&&this.zoomChangedInteractive("x",!0),C.changed&&this.zoomChangedInteractive("y",!0),f.second&&(Z=Z.then(()=>this.zoomSingle("x2",f.second.min,f.second.max)),f.second.changed&&this.zoomChangedInteractive("x2",!0)),C.second&&(Z=Z.then(()=>this.zoomSingle("y2",C.second.min,C.second.max)),C.second.changed&&this.zoomChangedInteractive("y2",!0)),Z},showContextMenu(v,f,C){if(3===f?.buttons)return f.preventDefault();if("zoom_kind"in this&&this.zoom_kind>100)return;let I,U=this,k=null,Z=!1,ee=null;const he=this.getFrameSvg().node();if((0,x.isFunc)(f?.stopPropagation)){f.preventDefault(),f.stopPropagation();const G=(0,L.Wn)(f,he),b=J(f,he);1===b.length?I={x:b[0][0],y:b[0][1],touch:!0}:2===G.length&&(I={x:G[0],y:G[1],touch:!1})}else if(void 0!==f?.x&&void 0!==f?.y&&void 0===f?.clientX){I=f;const G=he.getBoundingClientRect();f={clientX:G.left+I.x,clientY:G.top+I.y}}if("painter"===v&&C)U=C,v="";else if("main"===v)U=this.getMainPainter(!0),v="";else if(v)("x"===v||"y"===v||"z"===v||"pal"===v)&&(k=this.getMainPainter(!0),this.v7_frame&&(0,x.isFunc)(k?.v7EvalAttr)&&(k=null));else{const G=this.getPadPainter();let b=null;if(ee=this,I&&G){I.painters=!0;const P=G.processPadTooltipEvent(I);let T=1e3;for(let z=0;z<P.length;++z)if(P[z]?.menu){const W=P[z].menu_dist??7;W<T&&(b=P[z].painter,T=W)}}b?U=b:v="frame",I&&(Z=I.x>0&&I.x<20&&I.y>0&&I.y<20),ee.setLastEventPos(I)}return k||(k=U),(0,x.isFunc)(U?.fillContextMenu)?(this.clearInteractiveElements(),(0,Re.ES)(f,U).then(G=>{let b=G.painter.fillContextMenu(G,v,C);if(ee&&(!b||Z&&"frame"!==v)&&(b=ee.fillContextMenu(G)),b)return k.fillObjectExecMenu(G,v).then(P=>(F(P.painter,!1),P.show().then(()=>F(P.painter,!0))))})):void 0},startSingleTouchHandling(v,f){const C=J(f,this.getFrameSvg().node());if(1!==C.length)return;f.preventDefault(),f.stopPropagation(),(0,Re.IV)();const I=(new Date).getTime();this._shifting_dx=0,this._shifting_dy=0,F(this,!1),(0,L.Lt)(window).on("touchmove.singleTouch",v?null:U=>this.moveTouchHandling(U,v,C[0])).on("touchcancel.singleTouch",U=>this.endSingleTouchHandling(U,v,C[0],I)).on("touchend.singleTouch",U=>this.endSingleTouchHandling(U,v,C[0],I))},moveTouchHandling(v,f,C){const I=this.getFrameSvg(),U=this.draw_g.selectChild(".main_layer");let k;try{k=J(v,I.node())[0]}catch{k=[0,0],v?.changedTouches&&(k=[v.changedTouches[0].clientX,v.changedTouches[0].clientY])}const Z=C[0]-k[0],ee=1===this.scales_ndim?0:C[1]-k[1],he=this.getFrameWidth(),G=this.getFrameHeight();this._shifting_dx=Z,this._shifting_dy=ee,U.attr("viewBox",`${Z} ${ee} ${he} ${G}`)},endSingleTouchHandling(v,f,C,I){v?.preventDefault(),v?.stopPropagation(),F(this,!0),(0,L.Lt)(window).on("touchmove.singleTouch",null).on("touchcancel.singleTouch",null).on("touchend.singleTouch",null),null!==v&&(Math.abs(this._shifting_dx)>2||Math.abs(this._shifting_dy)>2?this.performScalesShift():(new Date).getTime()-I>700&&this.showContextMenu(f,{x:C[0],y:C[1]}))},clearInteractiveElements(){(0,Re.IV)(),this.zoom_kind=0,this.zoom_rect?.remove(),delete this.zoom_rect,delete this.zoom_curr,delete this.zoom_origin,delete this.zoom_lastpos,delete this.zoom_labels,F(this,!0)},assign(v){Object.assign(v,this)}};class g extends ke.JW{constructor(f,C){super(f,C&&C.$dummy?null:C),this.zoom_kind=0,this.mode3d=!1,this.shrink_frame_left=0,this.xmin=this.xmax=0,this.ymin=this.ymax=0,this.ranges_set=!1,this.axes_drawn=!1,this.keys_handler=null,this.projection=0}getFramePainter(){return this}is_root6(){return!0}getObject(f){return"xaxis"===f?this.xaxis:"yaxis"===f?this.yaxis:super.getObject()}setFrameActive(f){this.enabledKeys=f&&x.settings.HandleKeys,this.control&&(this.control.enableKeys=this.enabledKeys)}shrinkFrame(f,C){this.fX1NDC+=f,this.fX2NDC-=C}setLastEventPos(f){this.fLastEventPnt=f}getLastEventPos(){return this.fLastEventPnt}getProjectionFunc(){return Y(this.projection)}recalculateRange(f,C,I){this.projection=f||0,2===this.projection&&(this.scale_ymin<=-90||this.scale_ymax>=90)&&(console.warn(`Mercator Projection: Latitude out of range ${this.scale_ymin} ${this.scale_ymax}`),this.projection=0);const U=this.getProjectionFunc();if(!U)return;const k=[U(this.scale_xmin,this.scale_ymin),U(this.scale_xmin,this.scale_ymax),U(this.scale_xmax,this.scale_ymax),U(this.scale_xmax,this.scale_ymin)];this.scale_xmin<0&&this.scale_xmax>0&&(k.push(U(0,this.scale_ymin)),k.push(U(0,this.scale_ymax))),this.scale_ymin<0&&this.scale_ymax>0&&(k.push(U(this.scale_xmin,0)),k.push(U(this.scale_xmax,0))),this.original_xmin=this.scale_xmin,this.original_xmax=this.scale_xmax,this.original_ymin=this.scale_ymin,this.original_ymax=this.scale_ymax,C&&(this.scale_xmin=this.scale_xmax=k[0].x),I&&(this.scale_ymin=this.scale_ymax=k[0].y);for(let Z=1;Z<k.length;++Z)C&&(this.scale_xmin=Math.min(this.scale_xmin,k[Z].x),this.scale_xmax=Math.max(this.scale_xmax,k[Z].x)),I&&(this.scale_ymin=Math.min(this.scale_ymin,k[Z].y),this.scale_ymax=Math.max(this.scale_ymax,k[Z].y))}setAxesRanges(f,C,I,U,k,Z,ee,he,G,b){if(this.ranges_set=!0,this.xaxis=f,this.xmin=C,this.xmax=I,this.yaxis=U,this.ymin=k,this.ymax=Z,this.zaxis=ee,this.zmin=he,this.zmax=G,b?.check_pad_range){delete b.check_pad_range;const P=b.getDimension();this.applyAxisZoom("x"),P>1&&this.applyAxisZoom("y"),P>2&&this.applyAxisZoom("z")}b&&!b._checked_zooming&&(b._checked_zooming=!0,b.options.minimum!==x.kNoZoom&&(this.zoom_zmin=b.options.minimum,this.zoom_zmax=this.zmax),b.options.maximum!==x.kNoZoom&&(this.zoom_zmax=b.options.maximum,void 0===this.zoom_zmin&&(this.zoom_zmin=this.zmin)))}setAxes2Ranges(f,C,I,U,k,Z,ee,he){f&&(this.x2axis=C,this.x2min=I,this.x2max=U),k&&(this.y2axis=Z,this.y2min=ee,this.y2max=he)}getAxis(f){switch(f){case"x":return this.xaxis;case"y":return this.yaxis;case"z":return this.zaxis;case"x2":return this.x2axis;case"y2":return this.y2axis}return null}applyPadUserRange(f,C){if(!f)return;let I=f[`fU${C}min`],U=f[`fU${C}max`],k=1e-7;if("x"===C){if(Math.abs(f.fX1)>k||Math.abs(f.fX2-1)>k){const G=f.fX2-f.fX1;I=f.fX1+G*f.fLeftMargin,U=f.fX2-G*f.fRightMargin}}else if(Math.abs(f.fY1)>k||Math.abs(f.fY2-1)>k){const G=f.fY2-f.fY1;I=f.fY1+G*f.fBottomMargin,U=f.fY2-G*f.fTopMargin}if(I>=U||Math.abs(I)<k&&Math.abs(U-1)<k)return;f[`fLog${C}`]>0&&(I=Math.exp(I*Math.log(10)),U=Math.exp(U*Math.log(10)));let Z=C;this.swap_xy&&(Z="x"===C?"y":"x");const ee=this[`scale_${Z}min`],he=this[`scale_${Z}max`];k=1e-7*(he-ee),(Math.abs(I-ee)>k||Math.abs(U-he)>k)&&(this[`zoom_${Z}min`]=I,this[`zoom_${Z}max`]=U)}applyAxisZoom(f){if(this.zoomChangedInteractive(f))return;this[`zoom_${f}min`]=this[`zoom_${f}max`]=0;const C=this.getAxis(f);C?.TestBit(ke.rb.kAxisRange)&&C.fFirst!==C.fLast&&(C.fFirst>1||C.fLast<C.fNbins)&&(this[`zoom_${f}min`]=C.fFirst>1?C.GetBinLowEdge(C.fFirst):C.fXmin,this[`zoom_${f}max`]=C.fLast<C.fNbins?C.GetBinLowEdge(C.fLast+1):C.fXmax,C.InvertBit(ke.rb.kAxisRange),C.fFirst=1,C.fLast=C.fNbins)}createXY(f){this.cleanXY(),f||(f={ndim:1}),this.swap_xy=f.swap_xy||!1,this.reverse_x=f.reverse_x||!1,this.reverse_y=f.reverse_y||!1,this.logx=this.logy=0;const C=this.getFrameWidth(),I=this.getFrameHeight(),k=this.getPadPainter().getRootPad(),Z=k.fLogx,ee=(1===f.ndim?k.fLogv:void 0)??k.fLogy;if(this.scales_ndim=f.ndim,this.scale_xmin=this.xmin,this.scale_xmax=this.xmax,this.scale_ymin=this.ymin,this.scale_ymax=this.ymax,f.extra_y_space&&((this.swap_xy?Z:ee)&&this.scale_ymax>0?this.scale_ymax=Math.exp(1.1*Math.log(this.scale_ymax)):this.scale_ymax+=.1*(this.scale_ymax-this.scale_ymin)),f.check_pad_range&&(this.applyAxisZoom("x"),f.ndim>1&&this.applyAxisZoom("y"),f.ndim>2&&this.applyAxisZoom("z"),"pad_range"===f.check_pad_range)){const b=this.getCanvPainter();(!b||!b.online_canvas)&&(this.applyPadUserRange(k,"x"),this.applyPadUserRange(k,"y"))}f.zoom_ymin!==f.zoom_ymax&&(this.zoom_ymin===this.zoom_ymax||!this.zoomChangedInteractive("y"))&&(this.zoom_ymin=f.zoom_ymin,this.zoom_ymax=f.zoom_ymax);let he=!0,G=!0;this.zoom_xmin!==this.zoom_xmax&&(this.scale_xmin=this.zoom_xmin,this.scale_xmax=this.zoom_xmax,he=!1),this.zoom_ymin!==this.zoom_ymax&&(this.scale_ymin=this.zoom_ymin,this.scale_ymax=this.zoom_ymax,G=!1),this.recalculateRange(f.Proj,he,G),this.x_handle=new Ye.TB(this.getDom(),this.xaxis,!0),this.x_handle.setPadName(this.getPadName()),this.x_handle.setHistPainter(f.hist_painter,"x"),this.x_handle.configureAxis("xaxis",this.xmin,this.xmax,this.scale_xmin,this.scale_xmax,this.swap_xy,this.swap_xy?[0,I]:[0,C],{reverse:this.reverse_x,log:this.swap_xy?ee:Z,noexp_changed:this.x_noexp_changed,symlog:this.swap_xy?f.symlog_y:f.symlog_x,logcheckmin:this.swap_xy,logminfactor:1e-4}),this.x_handle.assignFrameMembers(this,"x"),this.y_handle=new Ye.TB(this.getDom(),this.yaxis,!0),this.y_handle.setPadName(this.getPadName()),this.y_handle.setHistPainter(f.hist_painter,"y"),this.y_handle.configureAxis("yaxis",this.ymin,this.ymax,this.scale_ymin,this.scale_ymax,!this.swap_xy,this.swap_xy?[0,C]:[0,I],{reverse:this.reverse_y,log:this.swap_xy?Z:ee,noexp_changed:this.y_noexp_changed,symlog:this.swap_xy?f.symlog_x:f.symlog_y,logcheckmin:f.ndim<2||this.swap_xy,log_min_nz:f.ymin_nz&&f.ymin_nz<=this.ymax?.5*f.ymin_nz:0,logminfactor:De}),this.y_handle.assignFrameMembers(this,"y"),this.setRootPadRange(k)}createXY2(f){f||(f={ndim:this.scales_ndim??1}),this.reverse_x2=f.reverse_x||!1,this.reverse_y2=f.reverse_y||!1,this.logx2=this.logy2=0;const C=this.getFrameWidth(),I=this.getFrameHeight(),k=this.getPadPainter().getRootPad();f.second_x&&(this.scale_x2min=this.x2min,this.scale_x2max=this.x2max),f.second_y&&(this.scale_y2min=this.y2min,this.scale_y2max=this.y2max),f.extra_y_space&&f.second_y&&((this.swap_xy?k.fLogx:k.fLogy)&&this.scale_y2max>0?this.scale_y2max=Math.exp(1.1*Math.log(this.scale_y2max)):this.scale_y2max+=.1*(this.scale_y2max-this.scale_y2min)),this.zoom_x2min!==this.zoom_x2max&&f.second_x&&(this.scale_x2min=this.zoom_x2min,this.scale_x2max=this.zoom_x2max),this.zoom_y2min!==this.zoom_y2max&&f.second_y&&(this.scale_y2min=this.zoom_y2min,this.scale_y2max=this.zoom_y2max),f.second_x&&(this.x2_handle=new Ye.TB(this.getDom(),this.x2axis,!0),this.x2_handle.setPadName(this.getPadName()),this.x2_handle.setHistPainter(f.hist_painter,"x"),this.x2_handle.configureAxis("x2axis",this.x2min,this.x2max,this.scale_x2min,this.scale_x2max,this.swap_xy,this.swap_xy?[0,I]:[0,C],{reverse:this.reverse_x2,log:this.swap_xy?k.fLogy:k.fLogx,noexp_changed:this.x2_noexp_changed,logcheckmin:this.swap_xy,logminfactor:1e-4}),this.x2_handle.assignFrameMembers(this,"x2")),f.second_y&&(this.y2_handle=new Ye.TB(this.getDom(),this.y2axis,!0),this.y2_handle.setPadName(this.getPadName()),this.y2_handle.setHistPainter(f.hist_painter,"y"),this.y2_handle.configureAxis("y2axis",this.y2min,this.y2max,this.scale_y2min,this.scale_y2max,!this.swap_xy,this.swap_xy?[0,C]:[0,I],{reverse:this.reverse_y2,log:this.swap_xy?k.fLogx:k.fLogy,noexp_changed:this.y2_noexp_changed,logcheckmin:f.ndim<2||this.swap_xy,log_min_nz:f.ymin_nz&&f.ymin_nz<this.y2max?.5*f.ymin_nz:0,logminfactor:De}),this.y2_handle.assignFrameMembers(this,"y2"))}getGrFuncs(f,C){const I=f&&this.grx2,U=C&&this.gry2;return I||U?{use_x2:I,grx:I?this.grx2:this.grx,logx:this.logx,x_handle:I?this.x2_handle:this.x_handle,scale_xmin:I?this.scale_x2min:this.scale_xmin,scale_xmax:I?this.scale_x2max:this.scale_xmax,use_y2:U,gry:U?this.gry2:this.gry,logy:this.logy,y_handle:U?this.y2_handle:this.y_handle,scale_ymin:U?this.scale_y2min:this.scale_ymin,scale_ymax:U?this.scale_y2max:this.scale_ymax,swap_xy:this.swap_xy,fp:this,revertAxis(k,Z){return"x"===k&&this.use_x2&&(k="x2"),"y"===k&&this.use_y2&&(k="y2"),this.fp.revertAxis(k,Z)},axisAsText(k,Z){return"x"===k&&this.use_x2&&(k="x2"),"y"===k&&this.use_y2&&(k="y2"),this.fp.axisAsText(k,Z)}}:this}setRootPadRange(f,C){if(!f||!this.ranges_set)return;C?(f.fUxmin=f.fUymin=-.9,f.fUxmax=f.fUymax=.9):(f.fLogx=this.swap_xy?this.logy:this.logx,f.fUxmin=f.fLogx?Math.log10(this.scale_xmin):this.scale_xmin,f.fUxmax=f.fLogx?Math.log10(this.scale_xmax):this.scale_xmax,f.fLogy=this.swap_xy?this.logx:this.logy,f.fUymin=f.fLogy?Math.log10(this.scale_ymin):this.scale_ymin,f.fUymax=f.fLogy?Math.log10(this.scale_ymax):this.scale_ymax);const I=f.fUxmax-f.fUxmin,U=f.fUymax-f.fUymin;let k=1-f.fLeftMargin-f.fRightMargin,Z=1-f.fBottomMargin-f.fTopMargin;k<=0&&(k=.01),Z<=0&&(Z=.01),f.fX1=f.fUxmin-I/k*f.fLeftMargin,f.fX2=f.fUxmax+I/k*f.fRightMargin,f.fY1=f.fUymin-U/Z*f.fBottomMargin,f.fY2=f.fUymax+U/Z*f.fTopMargin}drawGrids(){const f=this.getFrameSvg().selectChild(".axis_layer");f.selectAll(".xgrid").remove(),f.selectAll(".ygrid").remove();const C=this.getPadPainter(),I=C?.getRootPad(!0),U=this.getFrameHeight(),k=this.getFrameWidth(),Z=x.gStyle.fGridStyle;if(I?.fGridx&&this.x_handle?.ticks){const ee=x.gStyle.fGridColor>0?x.gStyle.fGridColor:this.getAxis("x")?.fAxisColor??1;let he="";this.x_handle.ticks.forEach(G=>{he+=this.swap_xy?`M0,${G}h${k}`:`M${G},0v${U}`}),f.append("svg:path").attr("class","xgrid").attr("d",he).style("stroke",this.getColor(ee)||"black").style("stroke-width",x.gStyle.fGridWidth).style("stroke-dasharray",(0,ot.Ov)(Z))}if(I?.fGridy&&this.y_handle?.ticks){const ee=x.gStyle.fGridColor>0?x.gStyle.fGridColor:this.getAxis("y")?.fAxisColor??1;let he="";this.y_handle.ticks.forEach(G=>{he+=this.swap_xy?`M${G},0v${U}`:`M0,${G}h${k}`}),f.append("svg:path").attr("class","ygrid").attr("d",he).style("stroke",this.getColor(ee)||"black").style("stroke-width",x.gStyle.fGridWidth).style("stroke-dasharray",(0,ot.Ov)(Z))}}axisAsText(f,C){const I=this[`${f}_handle`];return I?I.axisAsText(C,x.settings[f.toUpperCase()+"ValuesFormat"]):C.toPrecision(4)}hasDrawnAxes(f,C){return!f&&!C&&this.axes_drawn}drawAxes(f,C,I,U,k,Z){var ee=this;return(0,Ee.A)(function*(){if(ee.cleanAxesDrawings(),ee.xmin===ee.xmax||ee.ymin===ee.ymax)return!1;void 0===U&&(U=0);const he=ee.getFrameSvg().selectChild(".axis_layer"),G=ee.getFrameWidth(),b=ee.getFrameHeight(),P=ee.getPadPainter(),T=P.getRootPad(!0);ee.x_handle.invert_side=U>=10,ee.x_handle.lbls_both_sides=!ee.x_handle.invert_side&&T?.fTickx>1,ee.x_handle.has_obstacle=k,ee.y_handle.invert_side=U%10==1,ee.y_handle.lbls_both_sides=!ee.y_handle.invert_side&&T?.fTicky>1,ee.y_handle.has_obstacle=Z;const z=ee.swap_xy?ee.y_handle:ee.x_handle,W=ee.swap_xy?ee.x_handle:ee.y_handle;(!C||!I)&&P._fast_drawing&&(C=I=!0);let fe=Promise.resolve(!0);if(!C||!I){const we=!f&&x.settings.CanAdjustFrame,Me=z.drawAxis(he,G,b,z.invert_side?null:`translate(0,${b})`,T?.fTickx?-b:0,C,void 0,!1,P.getPadHeight()-b-ee.getFrameY()),je=W.drawAxis(he,G,b,W.invert_side?`translate(${G})`:null,T?.fTicky?G:0,I,W.invert_side?0:ee._frame_x,we);fe=Promise.all([Me,je]).then(()=>{if(ee.drawGrids(),!we)return;let Ge=0;const lt=W.position;return-.2*G<lt&&lt<0?(Ge=-lt/G+.001,ee.shrink_frame_left+=Ge):lt>0&&lt<.3*G&&ee.shrink_frame_left>0&&lt/G>ee.shrink_frame_left&&(Ge=-ee.shrink_frame_left,ee.shrink_frame_left=0),Ge?(ee.shrinkFrame(Ge,0),ee.redraw().then(()=>ee.drawAxes(!0))):void 0})}return fe.then(()=>(f||(ee.axes_drawn=!0),!0))})()}drawAxes2(f,C){const I=this.getFrameSvg().selectChild(".axis_layer"),U=this.getFrameWidth(),k=this.getFrameHeight(),Z=this.getPadPainter(),ee=Z.getRootPad(!0);f&&(this.x2_handle.invert_side=!0,this.x2_handle.lbls_both_sides=!1,this.x2_handle.has_obstacle=!1),C&&(this.y2_handle.invert_side=!0,this.y2_handle.lbls_both_sides=!1);let b,P,he=this.swap_xy?this.y2_handle:this.x2_handle,G=this.swap_xy?this.x2_handle:this.y2_handle;return(he||G)&&Z._fast_drawing&&(he=G=null),he&&(b=he.drawAxis(I,U,k,he.invert_side?null:`translate(0,${k})`,ee?.fTickx?-k:0,!1,void 0,!1)),G&&(P=G.drawAxis(I,U,k,G.invert_side?`translate(${U})`:null,ee?.fTicky?U:0,!1,G.invert_side?0:this._frame_x,!1)),Promise.all([b,P])}updateAttributes(f){const C=this.getPadPainter(),I=C?.getRootPad(!0),U=this.getObject();(void 0===this.fX1NDC||f&&!this.modified_NDC)&&(I?(this.fX1NDC=I.fLeftMargin,this.fX2NDC=1-I.fRightMargin,this.fY1NDC=I.fBottomMargin,this.fY2NDC=1-I.fTopMargin):(this.fX1NDC=x.gStyle.fPadLeftMargin,this.fX2NDC=1-x.gStyle.fPadRightMargin,this.fY1NDC=x.gStyle.fPadBottomMargin,this.fY2NDC=1-x.gStyle.fPadTopMargin)),void 0===this.fillatt&&(this.createAttFill(U?{attr:U}:I?.fFrameFillColor?{pattern:I.fFrameFillStyle,color:I.fFrameFillColor}:I?{attr:I}:{pattern:1001,color:0}),!U&&this.fillatt.empty()&&C?.iscan?this.fillatt.setSolidColor("white"):4e3===I?.fFillStyle&&!this.fillatt.empty()&&this.fillatt.setOpacity(0)),this.createAttLine(U||void 0===I?.fFrameLineColor?{attr:U,color:"black"}:{color:I.fFrameLineColor,width:I.fFrameLineWidth,style:I.fFrameLineStyle})}sizeChanged(){const f=this.getPadPainter()?.getRootPad(!0);f&&(f.fLeftMargin=this.fX1NDC,f.fRightMargin=1-this.fX2NDC,f.fBottomMargin=this.fY1NDC,f.fTopMargin=1-this.fY2NDC,this.setRootPadRange(f)),this.interactiveRedraw("pad","frame")}cleanXY(){delete this.grx,delete this.gry,delete this.grz,delete this.grx2,delete this.gry2,this.x_handle?.cleanup(),this.y_handle?.cleanup(),this.z_handle?.cleanup(),this.x2_handle?.cleanup(),this.y2_handle?.cleanup(),delete this.x_handle,delete this.y_handle,delete this.z_handle,delete this.x2_handle,delete this.y2_handle}cleanAxesDrawings(){this.x_handle?.removeG(),this.y_handle?.removeG(),this.z_handle?.removeG(),this.x2_handle?.removeG(),this.y2_handle?.removeG(),this.draw_g?.selectChild(".axis_layer").selectAll("*").remove(),this.axes_drawn=!1}cleanFrameDrawings(){(0,x.isFunc)(this.create3DScene)&&this.create3DScene(-1),this.cleanAxesDrawings(),this.cleanXY(),this.ranges_set=!1,this.xmin=this.xmax=0,this.ymin=this.ymax=0,this.zmin=this.zmax=0,this.zoom_xmin=this.zoom_xmax=0,this.zoom_ymin=this.zoom_ymax=0,this.zoom_zmin=this.zoom_zmax=0,this.scale_xmin=this.scale_xmax=0,this.scale_ymin=this.scale_ymax=0,this.scale_zmin=this.scale_zmax=0,this.draw_g?.selectChild(".main_layer").selectAll("*").remove(),this.draw_g?.selectChild(".upper_layer").selectAll("*").remove(),this.xaxis=null,this.yaxis=null,this.zaxis=null,this.draw_g&&(this.draw_g.selectAll("*").remove(),this.draw_g.on("mousedown",null).on("dblclick",null).on("wheel",null).on("contextmenu",null).property("interactive_set",null),this.draw_g.remove()),delete this.draw_g,this.keys_handler&&(window.removeEventListener("keydown",this.keys_handler,!1),this.keys_handler=null)}cleanup(){this.cleanFrameDrawings(),delete this._click_handler,delete this._dblclick_handler,delete this.enabledKeys;const f=this.getPadPainter();f?.frame_painter_ref===this&&delete f.frame_painter_ref,super.cleanup()}redraw(){const f=this.getPadPainter();f&&(f.frame_painter_ref=this),this.updateAttributes();const C=f?.getPadRect()??{width:10,height:10},I=Math.round(C.width*this.fX1NDC),U=Math.round(C.height*(1-this.fY2NDC));let G,b,P,k=Math.round(C.width*(this.fX2NDC-this.fX1NDC)),Z=Math.round(C.height*(this.fY2NDC-this.fY1NDC)),ee=!1,he=!1;return f?.options&&(f.options.RotateFrame&&(ee=!0),f.options.FixFrame&&(he=!0)),ee?(G=`rotate(-90,${I},${U}) translate(${I-Z},${U})`,[k,Z]=[Z,k]):G=(0,ve.bk)(I,U),this._frame_x=I,this._frame_y=U,this._frame_width=k,this._frame_height=Z,this._frame_rotate=ee,this._frame_fixpos=he,this.mode3d||(this.draw_g=this.getFrameSvg(),this.draw_g.empty()?(this.draw_g=this.getLayerSvg("primitives_layer").append("svg:g").attr("class","root_frame"),this.isBatchMode()||this.draw_g.append("svg:title").text(""),b=this.draw_g.append("svg:path"),P=this.draw_g.append("svg:svg").attr("class","main_layer").attr("x",0).attr("y",0).attr("overflow","hidden"),this.draw_g.append("svg:g").attr("class","axis_layer"),this.draw_g.append("svg:g").attr("class","upper_layer")):(b=this.draw_g.selectChild("path"),P=this.draw_g.selectChild(".main_layer")),this.axes_drawn=!1,this.draw_g.attr("transform",G),b.attr("d",`M0,0H${k}V${Z}H0Z`).call(this.fillatt.func).call(this.lineatt.func),P.attr("width",k).attr("height",Z).attr("viewBox",`0 0 ${k} ${Z}`)),this}changeAxisLog(f,C){const I=this.getPadPainter(),U=I?.getRootPad(!0);if(!U)return;I._interactively_changed=!0;const k=`fLog${f}`;return U[k]||(this.swap_xy&&"x"===f?f="y":this.swap_xy&&"y"===f&&(f="x"),"labels"!==this[`${f}_handle`]?.kind)?(("toggle"===C||void 0===C)&&(C=U[k]?0:1),U[k]=C,this.interactiveRedraw("pad",`log${f}`)):void 0}toggleAxisLog(f){return this.changeAxisLog(f,"toggle")}fillContextMenu(f,C,I){const U=this.getMainPainter(!0),k=this.getPadPainter(),Z=k?.getRootPad(!0),ee="pal"===C;if(ee&&(C="z"),"x"===C||"y"===C||"z"===C||"x2"===C||"y2"===C){const G=I||this[C+"axis"],b=this[`${C}_handle`];if(!(0,x.isFunc)(G?.TestBit))return!1;if(f.add(`header: ${C.toUpperCase()} axis`),f.add("Unzoom",()=>this.unzoom(C)),Z){const P="fLog"+C[0];f.add("sub:SetLog "+C[0],()=>{f.input("Enter log kind: 0 - off, 1 - log10, 2 - log2, 3 - ln, ...",Z[P],"int",0,1e4).then(T=>{this.changeAxisLog(C[0],T)})}),f.addchk(0===Z[P],"linear",()=>this.changeAxisLog(C[0],0)),f.addchk(1===Z[P],"log10",()=>this.changeAxisLog(C[0],1)),f.addchk(2===Z[P],"log2",()=>this.changeAxisLog(C[0],2)),f.addchk(3===Z[P],"ln",()=>this.changeAxisLog(C[0],3)),f.addchk(4===Z[P],"log4",()=>this.changeAxisLog(C[0],4)),f.addchk(8===Z[P],"log8",()=>this.changeAxisLog(C[0],8)),f.add("endsub:")}return f.addchk(G.TestBit(ke.rb.kMoreLogLabels),"More log",P=>{G.InvertBit(ke.rb.kMoreLogLabels),U?.snapid&&1===C.length?U.interactiveRedraw("pad",`exec:SetMoreLogLabels(${P})`,C):this.interactiveRedraw("pad")}),f.addchk(b?.noexp??G.TestBit(ke.rb.kNoExponent),"No exponent",P=>{P!==G.TestBit(ke.rb.kNoExponent)&&G.InvertBit(ke.rb.kNoExponent),b&&(b.noexp_changed=!0),this[`${C}_noexp_changed`]=!0,U?.snapid&&1===C.length?U.interactiveRedraw("pad",`exec:SetNoExponent(${P})`,C):this.interactiveRedraw("pad")}),"z"===C&&(0,x.isFunc)(U?.fillPaletteMenu)&&U.fillPaletteMenu(f,!ee),"labels"===b?.kind&&G.fNbins>20&&f.add("Find label",()=>f.input("Label id").then(P=>{if(P)for(let T=0;T<G.fNbins;++T)if(b.formatLabels(T)===P)return this.zoom(C,Math.max(0,T-4),Math.min(G.fNbins,T+5))})),f.addTAxisMenu(ke.rb,U||this,G,C),!0}const he=0===f.size();return f.add(he?"header:Frame":"separator"),this.zoom_xmin!==this.zoom_xmax&&f.add("Unzoom X",()=>this.unzoom("x")),this.zoom_ymin!==this.zoom_ymax&&f.add("Unzoom Y",()=>this.unzoom("y")),this.zoom_zmin!==this.zoom_zmax&&f.add("Unzoom Z",()=>this.unzoom("z")),this.zoom_x2min!==this.zoom_x2max&&f.add("Unzoom X2",()=>this.unzoom("x2")),this.zoom_y2min!==this.zoom_y2max&&f.add("Unzoom Y2",()=>this.unzoom("y2")),f.add("Unzoom all",()=>this.unzoom("all")),Z&&(f.addchk(Z.fLogx,"SetLogx",()=>this.toggleAxisLog("x")),f.addchk(Z.fLogy,"SetLogy",()=>this.toggleAxisLog("y")),(0,x.isFunc)(U?.getDimension)&&U.getDimension()>1&&f.addchk(Z.fLogz,"SetLogz",()=>this.toggleAxisLog("z")),f.add("separator")),f.addchk(this.isTooltipAllowed(),"Show tooltips",()=>this.setTooltipAllowed("toggle")),f.addAttributesMenu(this,he?"":"Frame "),f.add("Save to gStyle",()=>{x.gStyle.fPadBottomMargin=this.fY1NDC,x.gStyle.fPadTopMargin=1-this.fY2NDC,x.gStyle.fPadLeftMargin=this.fX1NDC,x.gStyle.fPadRightMargin=1-this.fX2NDC,this.fillatt?.saveToStyle("fFrameFillColor","fFrameFillStyle"),this.lineatt?.saveToStyle("fFrameLineColor","fFrameLineWidth","fFrameLineStyle")},"Store frame position and graphical attributes to gStyle"),f.add("separator"),f.add("sub:Save as"),["svg","png","jpeg","pdf","webp"].forEach(G=>f.add(`frame.${G}`,()=>k.saveAs(G,"frame",`frame.${G}`))),f.add("endsub:"),!0}fillWebObjectOptions(f){f.fcust="frame",f.fopt=[this.scale_xmin||0,this.scale_ymin||0,this.scale_xmax||0,this.scale_ymax||0]}getFrameX(){return this._frame_x||0}getFrameY(){return this._frame_y||0}getFrameWidth(){return this._frame_width||0}getFrameHeight(){return this._frame_height||0}getFrameRect(){return{x:this._frame_x||0,y:this._frame_y||0,width:this.getFrameWidth(),height:this.getFrameHeight(),transform:this.draw_g?.attr("transform")||"",hint_delta_x:0,hint_delta_y:0}}configureUserClickHandler(f){this._click_handler=(0,x.isFunc)(f)?f:null}configureUserDblclickHandler(f){this._dblclick_handler=(0,x.isFunc)(f)?f:null}zoom(f,C,I,U,k,Z){var ee=this;return(0,Ee.A)(function*(){"x"===f?(f=C,C=I,I=void 0):"y"===f?(U=I,I=C,f=C=void 0):"z"===f&&(k=C,Z=I,f=C=I=void 0);let he=f!==C,G=I!==U,b=k!==Z,P=!1,T=!1,z=!1;if(he){let fe=0;f<=ee.xmin&&(f=ee.xmin,fe++),C>=ee.xmax&&(C=ee.xmax,fe++),2===fe&&(he=!1,P=!0)}else P=f===C&&0===f;if(G){let fe=0;(I<=ee.ymin||!ee.ymin&&ee.logy&&(!ee.y_handle?.log_min_nz&&I<De*ee.ymax||I<ee.y_handle?.log_min_nz))&&(I=ee.ymin,fe++),U>=ee.ymax&&(U=ee.ymax,fe++),2===fe&&1!==ee.scales_ndim&&(G=!1,T=!0)}else T=I===U&&0===I;if(b){let fe=0;k<=ee.zmin&&(k=ee.zmin,fe++),Z>=ee.zmax&&(Z=ee.zmax,fe++),2===fe&&ee.scales_ndim>2&&(b=!1,z=!0)}else z=k===Z&&0===k;let W=!1;return(he||G||b)&&ee.forEachPainter(fe=>{(0,x.isFunc)(fe.canZoomInside)&&(he&&fe.canZoomInside("x",f,C)&&(ee.zoom_xmin=f,ee.zoom_xmax=C,W=!0,he=!1),G&&fe.canZoomInside("y",I,U)&&(ee.zoom_ymin=I,ee.zoom_ymax=U,W=!0,G=!1),b&&fe.canZoomInside("z",k,Z)&&(ee.zoom_zmin=k,ee.zoom_zmax=Z,W=!0,b=!1))}),(P||T||z)&&(P&&(ee.zoom_xmin!==ee.zoom_xmax&&(W=!0),ee.zoom_xmin=ee.zoom_xmax=0),T&&(ee.zoom_ymin!==ee.zoom_ymax&&(W=!0,ue(ee.getMainPainter())),ee.zoom_ymin=ee.zoom_ymax=0),z&&(ee.zoom_zmin!==ee.zoom_zmax&&(W=!0),ee.zoom_zmin=ee.zoom_zmax=0),W||ee.getPadPainter()?.painters?.forEach(fe=>{(0,x.isFunc)(fe?.unzoomUserRange)&&fe.unzoomUserRange(P,T,z)&&(W=!0)})),!!W&&ee.interactiveRedraw("pad","zoom").then(()=>!0)})()}zoomSingle(f,C,I){var U=this;return(0,Ee.A)(function*(){if(!U[f+"_handle"])return!1;let k=C!==I,Z=!1;if(k){let he=0;C<=U[f+"min"]&&(C=U[f+"min"],he++),I>=U[f+"max"]&&(I=U[f+"max"],he++),2===he&&(k=!1,Z=!0)}else Z=C===I&&0===C;let ee=!1;return k&&U.forEachPainter(he=>{(0,x.isFunc)(he.canZoomInside)&&k&&he.canZoomInside(f[0],C,I)&&(U[`zoom_${f}min`]=C,U[`zoom_${f}max`]=I,ee=!0,k=!1)}),Z&&(U[`zoom_${f}min`]!==U[`zoom_${f}max`]&&(ee=!0,"y"===f&&ue(U.getMainPainter())),U[`zoom_${f}min`]=U[`zoom_${f}max`]=0),!!ee&&U.interactiveRedraw("pad","zoom").then(()=>!0)})()}isAxisZoomed(f){return this[`zoom_${f}min`]!==this[`zoom_${f}max`]}unzoom(f,C,I){var U=this;return(0,Ee.A)(function*(){return"all"===f?U.unzoom("x2").then(()=>U.unzoom("y2")).then(()=>U.unzoom("xyz")):"x2"===f||"y2"===f?U.zoomSingle(f,0,0).then(k=>(k&&U.zoomChangedInteractive(f,"unzoom"),k)):(typeof f>"u"?f=C=I=!0:(0,x.isStr)(f)&&(I=f.indexOf("z")>=0,C=f.indexOf("y")>=0,f=f.indexOf("x")>=0),U.zoom(f?0:void 0,f?0:void 0,C?0:void 0,C?0:void 0,I?0:void 0,I?0:void 0).then(k=>(k&&f&&U.zoomChangedInteractive("x","unzoom"),k&&C&&U.zoomChangedInteractive("y","unzoom"),k&&I&&U.zoomChangedInteractive("z","unzoom"),k)))})()}zoomChangedInteractive(f,C){if("reset"===f)return void(this.zoom_changed_x=this.zoom_changed_y=this.zoom_changed_z=void 0);if(!f||"any"===f)return this.zoom_changed_x||this.zoom_changed_y||this.zoom_changed_z;if("x"!==f&&"y"!==f&&"z"!==f)return;const I="zoom_changed_"+f;if(void 0===C)return this[I];"unzoom"!==C?C&&(this[I]=!0):this[I]=void 0===this[I]}revertAxis(f,C){return this[`${f}_handle`]?.revertPoint(C)??0}showAxisStatus(f,C){const I=this.getAxis(f),U=(0,L.Wn)(C,this.getFrameSvg().node());let k=f,Z=x.clTAxis,ee="x"===f?0:1;I&&(k=I.fName,Z=I.fTitle||`TAxis object for ${f}`),this.swap_xy&&(ee=1-ee);const he=this.revertAxis(f,U[ee]);this.showObjectStatus(k,Z,`${f} : ${this.axisAsText(f,he)}`,`${U[0]},${U[1]}`)}addKeysHandler(){this.isBatchMode()||(E.assign(this),this.addFrameKeysHandler())}addInteractivity(f){return!(this.isBatchMode()||!x.settings.Zooming&&!x.settings.ContextMenu)&&(E.assign(this),f||this.addBasicInteractivity(),this.addFrameInteractivity(f))}}},5102:(Yr,mt,Se)=>{"use strict";Se.d(mt,{DR:()=>Q,O4:()=>X,cw:()=>F,jg:()=>B});var Ee=Se(4882),x=Se(8872),L=Se(8362),ve=Se(2985),ke=Se(2843),ot=Se(1922),Ye=Se(4082),Ze=Se(4246),Re=Se(5638),He=Se(7900),Ve=Se(5992),De=Se(6157);const F="TButton",J=(0,x.BIT)(22);function Y($,A){return Math.round((A||1)*($.iscan||!$.has_canvas?16:12))}function ue($,A,E){E?.preventDefault(),E?.stopPropagation();const g=$.getLayerSvg("btns_layer",$.this_pad_name),v=g.select("[name='Toggle']");if(v.empty())return;let f=v.property("buttons_state");v.property("timout_handler")&&("timeout"!==A&&clearTimeout(v.property("timout_handler")),v.property("timout_handler",null));let C=!1;switch(A){case"enable":C=!0,$.btns_active_flag=!0;break;case"enterbtn":return void($.btns_active_flag=!0);case"timeout":C=!1;break;case"toggle":f=!f,v.property("buttons_state",f),C=f;break;case"disable":case"leavebtn":return $.btns_active_flag=!1,void(f||v.property("timout_handler",setTimeout(()=>ue($,"timeout"),1200)))}g.selectAll("svg").each(function(){this!==v.node()&&(0,L.Lt)(this).style("display",C?"":"none")})}const Q={alignButtons($,A,E){const g=Y(this,1.25),v=($.property("nextx")||0)+g;let f,C;$.property("vertical")?(f=$.property("leftside")?2:A-g,C=E-v):(f=$.property("leftside")?2:A-v,C=E-g),(0,ke.bk)($,f,C)},findPadButton($){const A=this.getLayerSvg("btns_layer",this.this_pad_name);let E="";return A.empty()||A.selectAll("svg").each(function(){(0,L.Lt)(this).attr("key")===$&&(E=(0,L.Lt)(this).attr("name"))}),E},removePadButtons(){const $=this.getLayerSvg("btns_layer",this.this_pad_name);$.empty()||($.selectAll("*").remove(),$.property("nextx",null))},showPadButtons(){const $=this.getLayerSvg("btns_layer",this.this_pad_name);if($.empty()||($.selectAll("*").remove(),!this._buttons))return;const A=this.iscan||!this.has_canvas;let g,v=$.property("leftside")?Y(this,1.25):0;if(this._fast_drawing)g=Ve.IK.createSVG($,Ve.IK.circle,Y(this),"enlargePad",!1).attr("name","Enlarge").attr("x",0).attr("y",0).on("click",f=>this.clickPadButton("enlargePad",f));else{g=Ve.IK.createSVG($,Ve.IK.rect,Y(this),"Toggle tool buttons",!1).attr("name","Toggle").attr("x",0).attr("y",0).property("buttons_state","popup"!==x.settings.ToolBar||x.browser.touches).on("click",f=>ue(this,"toggle",f)),g.node()._mouseenter=()=>ue(this,"enable"),g.node()._mouseleave=()=>ue(this,"disable");for(let f=0;f<this._buttons.length;++f){const C=this._buttons[f];let I=C.btn;(0,x.isStr)(I)&&(I=Ve.IK[I]),I||(I=Ve.IK.circle);const U=Ve.IK.createSVG($,I,Y(this),C.tooltip+(A?"":` on pad ${this.this_pad_name}`)+(C.keyname?` (keyshortcut ${C.keyname})`:""),!1);$.property("vertical")?U.attr("x",0).attr("y",v):U.attr("x",v).attr("y",0),U.attr("name",C.funcname).style("display",g.property("buttons_state")?"":"none").attr("key",C.keyname||null).on("click",k=>this.clickPadButton(C.funcname,k)),U.node()._mouseenter=()=>ue(this,"enterbtn"),U.node()._mouseleave=()=>ue(this,"leavebtn"),v+=Y(this,1.25)}}$.property("nextx",v),this.alignButtons($,this.getPadWidth(),this.getPadHeight()),$.property("vertical")?g.attr("y",v):$.property("leftside")||g.attr("x",v)},assign($){Object.assign($,this)}};function X($){if(!$?.snapid)return null;const A={_typename:"TWebObjectOptions",snapid:$.snapid.toString(),opt:$.getDrawOpt(!0),fcust:"",fopt:[]};return(0,x.isFunc)($.fillWebObjectOptions)&&$.fillWebObjectOptions(A),A}class B extends ot.JW{constructor(A,E,g){super(A,E),this.pad=E,this.iscan=g,this.this_pad_name="",!this.iscan&&E?.fName&&(this.this_pad_name=E.fName.replace(" ","_"),(!/^[A-Za-z][A-Za-z0-9_]*$/.test(this.this_pad_name)||"button"===this.this_pad_name&&E._typename===F)&&(this.this_pad_name="jsroot_pad_"+x.internals.id_counter++)),this.painters=[],this.has_canvas=!0,this.forEachPainter=this.forEachPainterInPad;const v=this.selectDom();!v.empty()&&v.property("_batch_mode")&&(this.batch_mode=!0)}isBatchMode(){return void 0!==this.batch_mode?this.batch_mode:!!(0,x.isBatchMode)()||!(this.iscan||!this.has_canvas)&&this.getCanvPainter()?.isBatchMode()}isRoot6(){return!0}isEditable(){return this.pad?.fEditable??!0}svg_this_pad(){return this.getPadSvg(this.this_pad_name)}getMainPainter(){return this.main_painter_ref||null}setMainPainter(A,E){(!this.main_painter_ref||E)&&(this.main_painter_ref=A)}cleanup(){this._doing_draw&&console.error("pad drawing is not completed when cleanup is called"),this.painters.forEach(E=>E.cleanup());const A=this.svg_this_pad();A.empty()||(A.property("pad_painter",null),this.iscan||A.remove()),delete this.main_painter_ref,delete this.frame_painter_ref,delete this.pads_cache,delete this.custom_palette,delete this._pad_x,delete this._pad_y,delete this._pad_width,delete this._pad_height,delete this._doing_draw,delete this._interactively_changed,delete this._snap_primitives,delete this._last_grayscale,delete this._custom_colors,delete this._custom_palette_indexes,delete this._custom_palette_colors,delete this.root_colors,this.painters=[],this.pad=null,this.this_pad_name=void 0,this.has_canvas=!1,(0,ot.QD)({pp:this,active:!1}),super.cleanup()}getFramePainter(){return this.frame_painter_ref}getPadWidth(){return this._pad_width||0}getPadHeight(){return this._pad_height||0}getPadRect(){return{x:this._pad_x||0,y:this._pad_y||0,width:this.getPadWidth(),height:this.getPadHeight()}}getFrameRect(){const A=this.getFramePainter();if(A)return A.getFrameRect();const E=this.getPadWidth(),g=this.getPadHeight(),v={};return this.pad?(v.szx=Math.round(Math.max(0,.5-Math.max(this.pad.fLeftMargin,this.pad.fRightMargin))*E),v.szy=Math.round(Math.max(0,.5-Math.max(this.pad.fBottomMargin,this.pad.fTopMargin))*g)):(v.szx=Math.round(.5*E),v.szy=Math.round(.5*g)),v.width=2*v.szx,v.height=2*v.szy,v.x=Math.round(E/2-v.szx),v.y=Math.round(g/2-v.szy),v.hint_delta_x=v.szx,v.hint_delta_y=v.szy,v.transform=(0,ke.bk)(v.x,v.y)||"",v}getRootPad(A){return void 0===A||A?this.pad:null}cleanPrimitives(A){if((0,x.isFunc)(A))for(let E=this.painters.length-1;E>=0;--E)A(this.painters[E])&&(this.painters[E].cleanup(),this.painters.splice(E,1))}removePrimitive(A){const E=this.painters[A],g=[];let v=A;for(let f=this.painters.length-1;f>=0;--f)(f===A||this.painters[f].isSecondary(E))&&(g.push(this.painters[f]),this.painters.splice(f,1),f<=A&&v--);return g.forEach(f=>{f.cleanup(),this.main_painter_ref===f&&(delete this.main_painter_ref,v=-111)}),v}getCustomPalette(){return this.custom_palette||this.getCanvPainter()?.custom_palette}getNumPainters(){return this.painters.length}getAutoColor(A){A||(A=this._num_primitives||5),A<2&&(A=2);let E=this._auto_color??0;this._auto_color=(E+1)%A,E>=A&&(E=A-1);const g=this._custom_palette_indexes||this.getCanvPainter()?._custom_palette_indexes;if(g?.length)return g[Math.round(E*(g.length-3)/(A-1))];this._auto_palette||(this._auto_palette=(0,ve.jh)(x.settings.Palette,this.isGrayscale()));const v=Math.round(E*(this._auto_palette.getLength()-3)/(A-1)),f=this._auto_palette.getColor(v);return this.addColor(f)}forEachPainterInPad(A,E){E||(E="all"),"objects"!==E&&A(this);for(let g=0;g<this.painters.length;++g){const v=this.painters[g];(0,x.isFunc)(v.forEachPainterInPad)?"objects"!==E&&v.forEachPainterInPad(A,E):"pads"!==E&&A(v)}}registerForPadEvents(A){this.pad_events_receiver=A}producePadEvent(A,E,g,v,f){"select"===A&&(0,x.isFunc)(this.selectActivePad)&&this.selectActivePad(E,g,v),(0,x.isFunc)(this.pad_events_receiver)&&this.pad_events_receiver({what:A,padpainter:E,painter:g,position:v,place:f})}selectObjectPainter(A,E,g){const v=this.iscan||!this.has_canvas,f=v?this:this.getCanvPainter();void 0===A&&(A=this),E&&!v&&(E=(0,ke.md)(this.svg_this_pad(),E)),(0,ot.QD)({pp:this,active:!0}),f?.producePadEvent("select",this,A,E,g)}drawActiveBorder(A,E){if(void 0!==E){if(this.is_active_pad===E)return;this.is_active_pad=E}if(void 0===this.is_active_pad)return;A||(A=this.iscan?this.getCanvSvg().selectChild(".canvas_fillrect"):this.svg_this_pad().selectChild(".root_pad_border"));const g=this.getCanvPainter();let v=this.is_active_pad&&g?.highlight_gpad?new Ye.gx({style:1,width:1,color:"red"}):this.lineatt;v||(v=new Ye.gx({color:"none"})),A.call(v.func)}setFastDrawing(A,E){const g=this._fast_drawing;this._fast_drawing=x.settings.SmallPad&&(A<x.settings.SmallPad.width||E<x.settings.SmallPad.height),g!==this._fast_drawing&&this.showPadButtons()}isGrayscale(){return!!this.iscan&&(this.pad?.TestBit(J)??!1)}setGrayscale(A){if(!this.iscan)return;let E=!1;void 0===A?(A=this.pad?.TestBit(J)??!1,E=void 0!==this._last_grayscale&&this._last_grayscale!==A):A!==this.pad?.TestBit(J)&&(this.pad?.InvertBit(J),E=!0),E&&this.forEachPainter(g=>{delete g._color_palette}),this.root_colors=A?(0,ve.uw)(this._custom_colors):this._custom_colors,this._last_grayscale=A,this.custom_palette=this._custom_palette_colors?new ve.rE(this._custom_palette_colors,A):null}createCanvasSvg(A,E){const g=this.isBatchMode();let U,k,Z,f=null,C=null,I=null;if(A>0){if(this._fixed_size)return A>1;if(C=this.getCanvSvg(),C.empty()||(f=C.property("height_factor"),I=this.testMainResize(A,null,f),!I.changed&&1===A))return!1;g||(U=this.getLayerSvg("btns_layer",this.this_pad_name)),k=this.getLayerSvg("info_layer",this.this_pad_name),Z=C.selectChild(".canvas_fillrect")}else{const he=this.selectDom();"static"===he.style("position")&&he.style("position","relative"),C=he.append("svg").attr("class","jsroot root_canvas").property("pad_painter",this).property("current_pad","").property("redraw_by_resize",!1),this.setTopPainter(),g?C.attr("xmlns","http://www.w3.org/2000/svg"):this.online_canvas||C.append("svg:title").text("ROOT canvas"),(!g||this.pad.fFillStyle>0)&&(Z=C.append("svg:path").attr("class","canvas_fillrect")),g||Z.style("pointer-events","visibleFill").on("dblclick",G=>this.enlargePad(G,!0)).on("click",()=>this.selectObjectPainter()).on("mouseenter",()=>this.showObjectStatus()).on("contextmenu",x.settings.ContextMenu?G=>this.padContextMenu(G):null),C.append("svg:g").attr("class","primitives_layer"),k=C.append("svg:g").attr("class","info_layer"),g||(U=C.append("svg:g").attr("class","btns_layer").property("leftside","left"===x.settings.ToolBarSide).property("vertical",x.settings.ToolBarVert)),f=.66,this.pad?.fCw&&this.pad?.fCh&&this.pad?.fCw>0&&(f=this.pad.fCh/this.pad.fCw,(f<.1||f>10)&&(f=.66)),this._fixed_size?(he.style("overflow","auto"),I={width:this.pad.fCw,height:this.pad.fCh},(!I.width||!I.height)&&(I=(0,ke.xh)(he))):I=this.testMainResize(2,E,f)}this.setGrayscale(),this.createAttFill({attr:this.pad}),I.width<=5||I.height<=5?(C.style("display","none"),console.warn(`Hide canvas while geometry too small w=${I.width} h=${I.height}`),this._pad_width&&this._pad_height?(I.width=this._pad_width,I.height=this._pad_height):(I.width=800,I.height=600)):C.style("display",null),C.attr("x",0).attr("y",0).style("position","absolute"),this._fixed_size?C.attr("width",I.width).attr("height",I.height):C.style("width","100%").style("height","100%").style("left",0).style("top",0).style("bottom",0).style("right",0),C.style("filter",x.settings.DarkMode||this.pad?.$dark?"invert(100%)":null),C.attr("viewBox",`0 0 ${I.width} ${I.height}`).attr("preserveAspectRatio","none").property("height_factor",f).property("draw_x",0).property("draw_y",0).property("draw_width",I.width).property("draw_height",I.height),this._pad_x=0,this._pad_y=0,this._pad_width=I.width,this._pad_height=I.height,Z&&(Z.attr("d",`M0,0H${I.width}V${I.height}H0Z`).call(this.fillatt.func),this.drawActiveBorder(Z)),this.setFastDrawing(I.width*(1-this.pad.fLeftMargin-this.pad.fRightMargin),I.height*(1-this.pad.fBottomMargin-this.pad.fTopMargin)),this.alignButtons&&U&&this.alignButtons(U,I.width,I.height);let ee=k.selectChild(".canvas_date");if(x.gStyle.fOptDate){ee.empty()&&(ee=k.append("text").attr("class","canvas_date"));const he=new Date,G=Math.round(I.height*(1-x.gStyle.fDateY));let b=Math.round(I.width*x.gStyle.fDateX);!g&&b<25&&(b=25),x.gStyle.fOptDate>1&&he.setTime(1e3*x.gStyle.fOptDate),(0,ke.bk)(ee,b,G).style("text-anchor","start").text(he.toLocaleString("en-GB"))}else ee.remove();return x.gStyle.fOptFile&&this.getItemName()?this.drawItemNameOnCanvas(this.getItemName()):k.selectChild(".canvas_item").remove(),!0}drawItemNameOnCanvas(A){const E=this.getLayerSvg("info_layer",this.this_pad_name);let g=E.selectChild(".canvas_item");if(x.gStyle.fOptFile&&A){g.empty()&&(g=E.append("text").attr("class","canvas_item"));const v=this.getPadRect();(0,ke.bk)(g,Math.round(v.width*(1-x.gStyle.fDateX)),Math.round(v.height*(1-x.gStyle.fDateY))).style("text-anchor","end").text(A)}else g.remove()}isPadEnlarged(){return this.iscan||!this.has_canvas?"on"===this.enlargeMain("state"):this.getCanvSvg().property("pad_enlarged")===this.pad}enlargePad(A,E,g){if(A?.preventDefault(),A?.stopPropagation(),E&&this._websocket&&"off"===this.enlargeMain("state"))return;const v=this.getCanvSvg(),f=v.property("pad_enlarged");if(!this.iscan&&this.has_canvas&&(f||this.hasObjectsToDraw()||this.painters))f||g?f===this.pad?(this.enlargeMain(!1),v.property("pad_enlarged",null)):!g&&E&&console.error("missmatch with pad double click events"):(this.enlargeMain(!0,!0),v.property("pad_enlarged",this.pad),(0,ot.QD)({pp:this,active:!0}));else{if(this._fixed_size||!this.enlargeMain(!g&&"toggle"))return;"off"===this.enlargeMain("state")?v.property("pad_enlarged",null):(0,ot.QD)({pp:this,active:!0})}return this.checkResize(!0)}createPadSvg(A){if(!this.has_canvas)return this.createCanvasSvg(A?2:0),!0;const E=this.getCanvSvg(),g=E.property("draw_width"),v=E.property("draw_height"),f=E.property("pad_enlarged"),C=!(this.pad_draw_disabled||f&&f!==this.pad),I=this.isBatchMode();let he,G,b,U=Math.round(this.pad.fAbsWNDC*g),k=Math.round(this.pad.fAbsHNDC*v),Z=Math.round(this.pad.fAbsXlowNDC*g),ee=Math.round(v*(1-this.pad.fAbsYlowNDC))-k;if(f===this.pad&&(U=g,k=v,Z=ee=0),A?(he=this.svg_this_pad(),G=he.selectChild(".root_pad_border"),I||(b=this.getLayerSvg("btns_layer",this.this_pad_name)),this.addPadInteractive(!0)):(he=E.selectChild(".primitives_layer").append("svg:svg").classed("__root_pad_"+this.this_pad_name,!0).attr("pad",this.this_pad_name).property("pad_painter",this),I||he.append("svg:title").text("subpad "+this.this_pad_name),(!I||this.pad.fFillStyle>0||this.pad.fLineStyle>0&&this.pad.fLineColor>0)&&(G=he.append("svg:path").attr("class","root_pad_border")),I||G.style("pointer-events","visibleFill").on("dblclick",P=>this.enlargePad(P,!0)).on("click",()=>this.selectObjectPainter()).on("mouseenter",()=>this.showObjectStatus()).on("contextmenu",x.settings.ContextMenu?P=>this.padContextMenu(P):null),he.append("svg:g").attr("class","primitives_layer"),I||(b=he.append("svg:g").attr("class","btns_layer").property("leftside","left"!==x.settings.ToolBarSide).property("vertical",x.settings.ToolBarVert))),this.createAttFill({attr:this.pad}),this.createAttLine({attr:this.pad,color0:this.pad.fBorderMode?"":"none"}),he.style("display",C?null:"none").attr("viewBox",`0 0 ${U} ${k}`).attr("preserveAspectRatio","none").attr("x",Z).attr("y",ee).attr("width",U).attr("height",k).property("draw_x",Z).property("draw_y",ee).property("draw_width",U).property("draw_height",k),this._pad_x=Z,this._pad_y=ee,this._pad_width=U,this._pad_height=k,G){G.attr("d",`M0,0H${U}V${k}H0Z`).call(this.fillatt.func).call(this.lineatt.func),this.drawActiveBorder(G);let P=he.selectChild(".root_pad_border1"),T=he.selectChild(".root_pad_border2");if(this.pad.fBorderMode&&this.pad.fBorderSize){const z=this.pad.fBorderSize,W=this.pad.fBorderSize,fe=`M0,0h${U}l${-z},${W}h${2*z-U}v${k-2*W}l${-z},${W}z`,we=`M${U},${k}v${-k}l${-z},${W}v${k-2*W}h${2*z-U}l${-z},${W}z`;T.empty()&&(T=he.insert("svg:path",".primitives_layer").attr("class","root_pad_border2")),P.empty()&&(P=he.insert("svg:path",".primitives_layer").attr("class","root_pad_border1")),P.attr("d",this.pad.fBorderMode>0?fe:we).call(this.fillatt.func).style("fill",(0,L.Qh)(this.fillatt.color).brighter(.5).formatHex()),T.attr("d",this.pad.fBorderMode>0?we:fe).call(this.fillatt.func).style("fill",(0,L.Qh)(this.fillatt.color).darker(.5).formatHex())}else P.remove(),T.remove()}return this.setFastDrawing(U*(1-this.pad.fLeftMargin-this.pad.fRightMargin),k*(1-this.pad.fBottomMargin-this.pad.fTopMargin)),he.property("can3d")===x.constants.Embed3D.Overlay&&this.selectDom().select(".draw3d_"+this.this_pad_name).style("display",C?"":"none"),this.alignButtons&&b&&this.alignButtons(b,U,k),C}addPadInteractive(A=!1){if(this.iscan||this.isBatchMode())return;const E=this.getCanvSvg(),g=E.property("draw_width"),v=E.property("draw_height");(0,Re.WJ)(this,{cleanup:A,x:this._pad_x,y:this._pad_y,width:this._pad_width,height:this._pad_height,no_transform:!0,only_resize:!0,is_disabled:f=>E.property("pad_enlarged")||this.btns_active_flag||"move"===f&&(this._disable_dragging||this.getFramePainter()?.mode3d),getDrawG:()=>this.svg_this_pad(),pad_rect:{width:g,height:v},minwidth:20,minheight:20,move_resize:(f,C,I,U)=>{const k=this.pad.fAbsXlowNDC,Z=this.pad.fAbsYlowNDC,ee=I/g/this.pad.fAbsWNDC,he=U/v/this.pad.fAbsHNDC,G=f/g-k,b=1-(C+U)/v-Z;this.forEachPainterInPad(P=>{P.pad.fAbsXlowNDC+=(P.pad.fAbsXlowNDC-k)*(ee-1)+G,P.pad.fAbsYlowNDC+=(P.pad.fAbsYlowNDC-Z)*(he-1)+b,P.pad.fAbsWNDC*=ee,P.pad.fAbsHNDC*=he},"pads")},redraw:()=>this.interactiveRedraw("pad","padpos")})}disablePadDrawing(){!this.pad_draw_disabled&&this.has_canvas&&!this.iscan&&(this.pad_draw_disabled=!0,this.createPadSvg(!0))}checkSpecial(A){if(!A)return!1;if(A._typename===x.clTStyle)return Object.assign(x.gStyle,A),!0;if(A._typename===x.clTObjArray&&"ListOfColors"===A.name){if(this.options?.CreatePalette){let E=[];for(let g=A.arr.length-this.options.CreatePalette;g<A.arr.length;++g){const v=(0,ve.d_)(A.arr[g]);if(!v){console.log("Fail to create color for palette"),E=null;break}E.push(v)}E&&(this.custom_palette=new ve.rE(E))}return(!this.options||this.options.GlobalColors)&&(0,ve.np)(A),this._custom_colors=this.options?.LocalColors?(0,ve.TZ)(null,A):null,!0}if(A._typename===x.clTObjArray&&"CurrentColorPalette"===A.name){const E=[],g=[];let v=!1;for(let C=0;C<A.arr.length;++C){const I=A.arr[C];I?._typename===x.clTColor?(g[C]=I.fNumber,E[C]=(0,ve.d_)(I)):(console.log(`Missing color with index ${C}`),v=!0)}const f=!this.options||!v&&!this.options.IgnorePalette;return this._custom_palette_indexes=f?g:null,this._custom_palette_colors=f?E:null,!0}return!1}checkSpecialsInPrimitives(A){const E=A?.fPrimitives;if(E)for(let g=0;g<E.arr?.length;++g)this.checkSpecial(E.arr[g])&&(E.arr.splice(g,1),E.opt.splice(g,1),g--)}findInPrimitives(A,E){const g=f=>f&&f?.fName===A&&(!E||f?._typename===E),v=this._snap_primitives?.find(f=>g(1===f.fKind?f.fSnapshot:null));return v?v.fSnapshot:this.pad?.fPrimitives?.arr.find(g)}findPainterFor(A,E,g){return this.painters.find(v=>{const f=v.getObject();return!(!f||(!A||f!==A)&&(!E&&!g||E&&f.fName!==E||g&&f._typename!==g))})}hasObjectsToDraw(){return this.pad?.fPrimitives?.arr?.find(A=>A._typename!==x.clTPad)}syncDraw(A){const E={kind:A||"redraw"};return void 0===this._doing_draw?(this._doing_draw=[E],Promise.resolve(!0)):!(!0!==E.kind&&this._doing_draw.findIndex((g,v)=>v>0&&g.kind===E.kind)>0)&&(this._doing_draw.push(E),new Promise(g=>{E.func=g}))}doingDraw(){return void 0!==this._doing_draw}confirmDraw(){if(void 0===this._doing_draw)return console.warn("failure, should not happen");if(this._doing_draw.shift(),0===this._doing_draw.length)delete this._doing_draw;else{const A=this._doing_draw[0];A.func&&(A.func(),delete A.func)}}drawObject(){return(0,Ee.A)(function*(){return console.log("Not possible to draw object without loading of draw.mjs"),null})()}drawPrimitives(A){var E=this;return(0,Ee.A)(function*(){if(void 0===A)return E.iscan&&(E._start_tm=(new Date).getTime()),E._num_primitives=E.pad?.fPrimitives?.arr?.length||0,E.syncDraw(!0).then(()=>E.drawPrimitives(0));if(!E.pad||A>=E._num_primitives){if(E._start_tm){const v=(new Date).getTime()-E._start_tm;v>1e3&&console.log(`Canvas ${E.pad?.fName||"---"} drawing took ${(.001*v).toFixed(2)}s`),delete E._start_tm}return void E.confirmDraw()}const g=E.pad.fPrimitives.arr[A];return!g||A>0&&"TFrame"===g._typename&&E.getFramePainter()?E.drawPrimitives(A+1):E.drawObject(E.getDom(),g,E.pad.fPrimitives.opt[A]).then(v=>((0,x.isObject)(v)&&(v._primitive=!0),E.drawPrimitives(A+1)))})()}divide(A,E){var g=this;return(0,Ee.A)(function*(){if(!g.pad.Divide(A,E))return g;const v=f=>f>=g.pad.fPrimitives.arr.length?g:g.drawObject(g.getDom(),g.pad.fPrimitives.arr[f]).then(()=>v(f+1));return v(0)})()}getSubPadPainter(A){for(let E=0;E<this.painters.length;++E){const g=this.painters[E];if(g.pad&&(0,x.isFunc)(g.forEachPainterInPad)&&g.pad.fNumber===A)return g}return null}processPadTooltipEvent(A){const E=[],g=[];return this.painters?.forEach(v=>{(0,x.isFunc)(v.processTooltipEvent)&&E.push(v)}),A&&(A.nproc=E.length),E.forEach(v=>{const f=v.processTooltipEvent(A)||{user_info:null};g.push(f),A?.painters&&(f.painter=v)}),g}changeDarkMode(A){this.getCanvSvg().style("filter",A??x.settings.DarkMode?"invert(100%)":null)}fillContextMenu(A){if(A.add(this.pad?`header:${this.pad._typename}::${this.pad.fName}`:"header:Canvas"),A.addchk(this.isTooltipAllowed(),"Show tooltips",()=>this.setTooltipAllowed("toggle")),!this._websocket){let g=function(v){this.pad[v.slice(1)]=parseInt(v[0]),this.interactiveRedraw("pad",v.slice(1))};A.addchk(this.pad?.fGridx,"Grid x",(this.pad?.fGridx?"0":"1")+"fGridx",g),A.addchk(this.pad?.fGridy,"Grid y",(this.pad?.fGridy?"0":"1")+"fGridy",g),A.add("sub:Ticks x"),A.addchk(0===this.pad?.fTickx,"normal","0fTickx",g),A.addchk(1===this.pad?.fTickx,"ticks on both sides","1fTickx",g),A.addchk(2===this.pad?.fTickx,"labels on both sides","2fTickx",g),A.add("endsub:"),A.add("sub:Ticks y"),A.addchk(0===this.pad?.fTicky,"normal","0fTicky",g),A.addchk(1===this.pad?.fTicky,"ticks on both sides","1fTicky",g),A.addchk(2===this.pad?.fTicky,"labels on both sides","2fTicky",g),A.add("endsub:"),A.addchk(this.pad?.fEditable,"Editable",v=>{this.pad.fEditable=v,this.interactiveRedraw("pad")}),this.iscan&&A.addchk(this.pad?.TestBit(J),"Gray scale",v=>{this.setGrayscale(v),this.interactiveRedraw("pad")}),(0,x.isFunc)(this.drawObject)&&A.add("Build legend",()=>this.buildLegend()),A.addAttributesMenu(this),A.add("Save to gStyle",()=>{this.pad&&(this.fillatt?.saveToStyle(this.iscan?"fCanvasColor":"fPadColor"),x.gStyle.fPadGridX=this.pad.fGridX,x.gStyle.fPadGridY=this.pad.fGridX,x.gStyle.fPadTickX=this.pad.fTickx,x.gStyle.fPadTickY=this.pad.fTicky,x.gStyle.fOptLogx=this.pad.fLogx,x.gStyle.fOptLogy=this.pad.fLogy,x.gStyle.fOptLogz=this.pad.fLogz)},"Store pad fill attributes, grid, tick and log scale settings to gStyle"),this.iscan&&A.addSettingsMenu(!1,!1,v=>{"dark"===v&&this.changeDarkMode()})}A.add("separator"),(0,x.isFunc)(this.hasMenuBar)&&(0,x.isFunc)(this.actiavteMenuBar)&&A.addchk(this.hasMenuBar(),"Menu bar",g=>this.actiavteMenuBar(g)),(0,x.isFunc)(this.hasEventStatus)&&(0,x.isFunc)(this.activateStatusBar)&&(0,x.isFunc)(this.canStatusBar)&&this.canStatusBar()&&A.addchk(this.hasEventStatus(),"Event status",()=>this.activateStatusBar("toggle")),(this.enlargeMain()||this.has_canvas&&this.hasObjectsToDraw())&&A.addchk(this.isPadEnlarged(),"Enlarge "+(this.iscan?"canvas":"pad"),()=>this.enlargePad());const E=this.this_pad_name||(this.iscan?"canvas":"pad");return A.add("sub:Save as"),["svg","png","jpeg","pdf","webp"].forEach(g=>A.add(`${E}.${g}`,()=>this.saveAs(g,this.iscan,`${E}.${g}`))),A.add("endsub:"),!0}padContextMenu(A){var E=this;return(0,Ee.A)(function*(){return A.stopPropagation&&(A.stopPropagation(),A.preventDefault(),E.getFramePainter()?.setLastEventPos()),(0,He.ES)(A,E).then(g=>(E.fillContextMenu(g),E.fillObjectExecMenu(g,""))).then(g=>g.show())})()}redrawPad(A){var E=this;return(0,Ee.A)(function*(){const g=E.syncDraw(A);if(!1===g)return console.log(`Prevent redrawing of ${E.pad.fName}`),!1;let v=!0;const f=C=>{for(;C<E.painters.length;){const I=E.painters[C++];let U=0;if((v||I.this_pad_name)&&(U=I.redraw(A)),(0,x.isPromise)(U))return U.then(()=>f(C))}return!0};return g.then(()=>(E.iscan?E.createCanvasSvg(2):v=E.createPadSvg(!0),f(0))).then(()=>(E.addPadInteractive(),E.confirmDraw(),(0,ot.OZ)()===E&&E.getCanvPainter()?.producePadEvent("padredraw",E),!0))})()}redraw(A){this.redrawPad(A)}needRedrawByResize(){const A=this.svg_this_pad();return!A.empty()&&A.property("can3d")===x.constants.Embed3D.Overlay||this.painters.findIndex(E=>!!(0,x.isFunc)(E.needRedrawByResize)&&E.needRedrawByResize())>=0}checkCanvasResize(A,E){if(this._ignore_resize||!this.iscan&&this.has_canvas)return!1;const g=this.syncDraw("canvas_resize");if(!1===g)return!1;(!0===A||!1===A)&&(E=A,A=null),(0,x.isObject)(A)&&A.force&&(E=!0),E||(E=this.needRedrawByResize());let v=!1;const f=C=>!v||C>=this.painters.length?(this.confirmDraw(),v):(0,x.getPromise)(this.painters[C].redraw(E?"redraw":"resize")).then(()=>f(C+1));return g.then(()=>(v=this.createCanvasSvg(E?2:1,A),v&&this.iscan&&this.pad&&this.online_canvas&&!this.embed_canvas&&!this.isBatchMode()&&(this._resize_tmout&&clearTimeout(this._resize_tmout),this._resize_tmout=setTimeout(()=>{delete this._resize_tmout,(0,x.isFunc)(this.sendResized)&&this.sendResized()},1e3)),f(0)))}updateObject(A){if(!A)return!1;this.pad.fBits=A.fBits,this.pad.fTitle=A.fTitle,this.pad.fGridx=A.fGridx,this.pad.fGridy=A.fGridy,this.pad.fTickx=A.fTickx,this.pad.fTicky=A.fTicky,this.pad.fLogx=A.fLogx,this.pad.fLogy=A.fLogy,this.pad.fLogz=A.fLogz,this.pad.fUxmin=A.fUxmin,this.pad.fUxmax=A.fUxmax,this.pad.fUymin=A.fUymin,this.pad.fUymax=A.fUymax,this.pad.fX1=A.fX1,this.pad.fX2=A.fX2,this.pad.fY1=A.fY1,this.pad.fY2=A.fY2,this.pad.fLeftMargin=A.fLeftMargin,this.pad.fRightMargin=A.fRightMargin,this.pad.fBottomMargin=A.fBottomMargin,this.pad.fTopMargin=A.fTopMargin,this.pad.fFillColor=A.fFillColor,this.pad.fFillStyle=A.fFillStyle,this.pad.fLineColor=A.fLineColor,this.pad.fLineStyle=A.fLineStyle,this.pad.fLineWidth=A.fLineWidth,this.pad.fPhi=A.fPhi,this.pad.fTheta=A.fTheta,this.pad.fEditable=A.fEditable,this.iscan&&this.checkSpecialsInPrimitives(A);const E=this.getFramePainter();if(E&&E.updateAttributes(!E.modified_NDC),!A.fPrimitives)return!1;let g=!1,v=0;for(let f=0;f<A.fPrimitives.arr?.length;++f)for(;v<this.painters.length;){const C=this.painters[v++];if(C._primitive){C.updateObject(A.fPrimitives.arr[f],A.fPrimitives.opt[f])&&(g=!0);break}}return g}buildLegend(A,E,g,v,f,C){var I=this;return(0,Ee.A)(function*(){const U=I.findPainterFor(null,"",x.clTLegend);if(!U&&!(0,x.isFunc)(I.drawObject))return Promise.reject(Error("Not possible to build legend while module draw.mjs was not load"));const k=U?.getObject()??(0,x.create)(x.clTLegend),Z=I.getRootPad(!0);k.fPrimitives.Clear();for(let b=0;b<I.painters.length;++b){const P=I.painters[b],T=P.getObject();if(!T||"title"===T.fName||"stats"===T.fName||!1===P.draw_content||T._typename===x.clTLegend||T._typename===x.clTHStack||T._typename===x.clTMultiGraph)continue;const z=(0,x.create)(x.clTLegendEntry);z.fObject=T,z.fLabel=P.getItemName(),("all"===C||!z.fLabel)&&(z.fLabel=T.fName),z.fOption="",z.fLabel&&(P.lineatt?.used&&(z.fOption+="l"),P.fillatt?.used&&(z.fOption+="f"),P.markeratt?.used&&(z.fOption+="p"),z.fOption||(z.fOption="l"),k.fPrimitives.Add(z))}if(U)return U.redraw();let he=k.fPrimitives.arr.length;if(!he)return null;he>8&&(he=8),he*=.1,A===g||E===v?(k.fX1NDC=.4*Z.fLeftMargin+.6*(1-Z.fRightMargin),k.fY1NDC=(1-he)*(1-Z.fTopMargin)+he*Z.fBottomMargin,k.fX2NDC=.99-Z.fRightMargin,k.fY2NDC=.99-Z.fTopMargin,void 0===C&&(C="autoplace")):(k.fX1NDC=A,k.fY1NDC=E,k.fX2NDC=g,k.fY2NDC=v),k.fFillStyle=1001,k.fTitle=f??"";const G=I.has_canvas?I.selectCurrentPad(I.this_pad_name):void 0;return I.drawObject(I.getDom(),k,C).then(b=>(I.selectCurrentPad(G),b))})()}addObjectPainter(A,E,g){if(A&&E&&E[g]&&void 0===A.snapid){this.painters.indexOf(A)<0&&this.painters.push(A),A.snapid=E[g].fObjectID;const v=f=>{if(f._unique_painter_id)for(let C=0;C<this.painters.length;++C){const I=this.painters[C];I._main_painter_id===f._unique_painter_id&&I._secondary_id&&(I.snapid=f.snapid+"#"+I._secondary_id,v(I))}};v(A)}}processSnapStyle(A){Object.assign(x.gStyle,A.fSnapshot)}processSnapColors(A){const E=(0,ve.LQ)(A.fSnapshot.fOper);(!this.options||this.options.GlobalColors)&&(0,ve.np)(E);const g=this.pad?.TestBit(J)??!1,v=(0,ve.TZ)(null,E,g);if(this._custom_colors=this.options?.LocalColors?v:null,!A.fSnapshot.fBuf||this.options&&this.options.IgnorePalette)delete this._custom_palette_indexes,delete this._custom_palette_colors,delete this.custom_palette;else{const f=[],C=[];for(let I=0;I<A.fSnapshot.fBuf.length;++I)f[I]=Math.round(A.fSnapshot.fBuf[I]),C[I]=v[f[I]];this._custom_palette_indexes=f,this._custom_palette_colors=C,this.custom_palette=new ve.rE(C,g)}}processSnapFont(A){const E=A.fSnapshot.fOper.split(":");(0,Ze.uT)(Number.parseInt(E[0]),E[1],E[2],E[3])}processSpecialSnaps(A){for(;A?.length;){const E=A[0];if(5===E.fKind)A.shift(),this.processSnapStyle(E);else if(4===E.fKind)A.shift(),this.processSnapColors(E);else{if(6!==E.fKind)break;A.shift(),this.processSnapFont(E)}}}drawNextSnap(A,E){var g=this;return(0,Ee.A)(function*(){if(void 0===E&&(E=-1,g._snaps_map={},g._num_primitives=A?A.length:0),++E,!A||E>=A.length)return delete g._snaps_map,g;const v=A[E];if(5===v.fKind)return g.processSnapStyle(v),g.drawNextSnap(A,E);if(4===v.fKind)return g.processSnapColors(v),g.drawNextSnap(A,E);const f=v.fObjectID;let C=(g._snaps_map[f]||0)+1,I=null;g._snaps_map[f]=C;for(let U=0;U<g.painters.length;++U)if(g.painters[U].snapid===f&&0==--C){I=g.painters[U];break}if(I){if(3===v.fKind)return I.redrawPadSnap(v).then(()=>g.drawNextSnap(A,E));let U;return 1===v.fKind?I.updateObject(v.fSnapshot,v.fOption,!0)&&(U=I.redraw()):2===v.fKind&&I.updateObject(v.fSnapshot)&&(U=I.redraw()),(0,x.getPromise)(U).then(()=>g.drawNextSnap(A,E))}if(3===v.fKind){const U=v.fSnapshot;U.fPrimitives=null;const k=new B(g.getDom(),U,!1);k.decodeOptions(v.fOption),k.addToPadPrimitives(g.this_pad_name),k.snapid=v.fObjectID,k.is_active_pad=!!v.fActive,k._readonly=v.fReadOnly??!1,k._snap_primitives=v.fPrimitives,k._has_execs=v.fHasExecs??!1,k.processSpecialSnaps(v.fPrimitives),k.createPadSvg(),k.matchObjectType(x.clTPad)&&v.fPrimitives.length>0&&k.addPadButtons(!0);const Z=k.selectCurrentPad(k.this_pad_name);return k.drawNextSnap(v.fPrimitives).then(()=>(k.addPadInteractive(),k.selectCurrentPad(Z),g.drawNextSnap(A,E)))}return 1!==v.fKind&&2!==v.fKind||"__ignore_drawing__"===v.fOption?g.drawNextSnap(A,E):g.drawObject(g.getDom(),v.fSnapshot,v.fOption).then(U=>(g.addObjectPainter(U,A,E),g.drawNextSnap(A,E)))})()}findSnap(A){if(this.snapid===A)return this;if(!this.painters)return null;for(let E=0;E<this.painters.length;++E){let g=this.painters[E];if((0,x.isFunc)(g.findSnap)?g=g.findSnap(A):g.snapid!==A&&(g=null),g)return g}return null}redrawPadSnap(A){var E=this;return(0,Ee.A)(function*(){if(!A?.fPrimitives)return E;E.is_active_pad=!!A.fActive,E._readonly=A.fReadOnly??!1,E._snap_primitives=A.fPrimitives,E._has_execs=A.fHasExecs??!1;const g=A.fSnapshot;if(g.fPrimitives=null,E._deliver_webcanvas_events=g.fExecs?.arr?.length>0,void 0===E.snapid){E.snapid=A.fObjectID,E.draw_object=E.pad=g,E.isBatchMode()&&(!g.fCw||!g.fCh)&&(g.fCw=900,g.fCh=700),(!g.fCw||!g.fCh)&&(E._fixed_size=!1);const U=E.selectDom().attr("id");!E.isBatchMode()&&!E.use_openui&&!E.brlayout&&U&&(0,x.isStr)(U)&&(E.brlayout=new De.jX(U,null,E),E.brlayout.create(U,!0),E.setDom(E.brlayout.drawing_divid()),(0,Ve.d7)(E.brlayout)),E.processSpecialSnaps(A.fPrimitives),E.createCanvasSvg(0),E.isBatchMode()||E.addPadButtons(!0),typeof A.fHighlightConnect<"u"&&(E._highlight_connect=A.fHighlightConnect);let k=Promise.resolve(!0);if((0,x.isStr)(A.fScripts)&&A.fScripts){let Z="";0===A.fScripts.indexOf("load:")?Z=A.fScripts.slice(5).split(";"):0===A.fScripts.indexOf("assert:")&&(Z=A.fScripts.slice(7)),k=Z?(0,x.loadScript)(Z):(0,x.injectCode)(A.fScripts)}return k.then(()=>E.drawNextSnap(A.fPrimitives))}E.updateObject(g),E.iscan?E.createCanvasSvg(2):E.createPadSvg(!0);const v=(U,k,Z,ee)=>{const he=U.find(b=>!(void 0===b.snapid||!b.matchObjectType(Z)||ee&&(!b.getObject()||b.getObject().fName!==ee)));if(!he)return;const G=k.find(b=>!(1!==b.fKind||!b.fSnapshot||b.fSnapshot._typename!==Z||ee&&b.fSnapshot.fName!==ee));G&&he.snapid!==G.fObjectID&&(he.snapid=G.fObjectID)};A.fWithoutPrimitives||(v(E.painters,A.fPrimitives,"TFrame"),v(E.painters,A.fPrimitives,x.clTPaveText,"title"));let f=!1,C=!1;if(!A.fWithoutPrimitives)for(let U=0;U<E.painters.length;++U){const k=E.painters[U];if(!(0,x.isStr)(k.snapid)||k.isSecondary())continue;const Z=A.fPrimitives.find(ee=>ee.fObjectID===k.snapid&&!ee.$checked);if(Z)f=!0,Z.$checked=!0;else if(U=E.removePrimitive(U),C=!0,-111===U){f=!1;break}}if(C&&delete E.pads_cache,!f&&!A.fWithoutPrimitives){const U=E.getFramePainter(),k=E.painters;E.painters=[],k.forEach(Z=>{U!==Z&&Z.cleanup()}),delete E.main_painter_ref,U&&(E.painters.push(U),U.cleanFrameDrawings(),U.redraw()),(0,x.isFunc)(E.removePadButtons)&&E.removePadButtons(),E.addPadButtons(!0)}const I=E.selectCurrentPad(E.this_pad_name);return E.drawNextSnap(A.fPrimitives).then(()=>(E.addPadInteractive(),E.selectCurrentPad(I),(0,ot.OZ)()===E&&E.getCanvPainter()?.producePadEvent("padredraw",E),E))})()}deliverWebCanvasEvent(A,E,g,v){if(!this._deliver_webcanvas_events||!this.is_active_pad||this.doingDraw()||void 0===E||void 0===g)return;const f=this.getCanvPainter();if(!f||!f._websocket||!f._websocket.canSend(2)||f._readonly)return;let C="";v&&v[0]&&v[0].painter?.snapid&&(C=v[0].painter.snapid.toString());const I=JSON.stringify([this.snapid,A,E.toString(),g.toString(),C]);f.sendWebsocket(`EVENT:${I}`)}createImage(A){var E=this;return(0,Ee.A)(function*(){return"png"===A||"jpeg"===A||"svg"===A||"pdf"===A?E.produceImage(!0,A).then(g=>{if(!g||"svg"===A)return g;const v=g.indexOf("base64,");return v>0?g.slice(v+7):""}):""})()}getWebPadOptions(A,E){let g=void 0===A,v=null,f=!0;if(g&&this._readonly)return"";if("only_this"===A?(g=!0,f=!1):"with_subpads"===A&&(g=!0,f=!0),g&&(A=[]),E||(E=this.iscan?this:this.getCanvPainter()),this.snapid){if(v={_typename:"TWebPadOptions",snapid:this.snapid.toString(),active:!!this.is_active_pad,cw:0,ch:0,w:[],bits:0,primitives:[],logx:this.pad.fLogx,logy:this.pad.fLogy,logz:this.pad.fLogz,gridx:this.pad.fGridx,gridy:this.pad.fGridy,tickx:this.pad.fTickx,ticky:this.pad.fTicky,mleft:this.pad.fLeftMargin,mright:this.pad.fRightMargin,mtop:this.pad.fTopMargin,mbottom:this.pad.fBottomMargin,xlow:0,ylow:0,xup:1,yup:1,zx1:0,zx2:0,zy1:0,zy2:0,zz1:0,zz2:0},this.iscan)v.bits=this.getStatusBits(),v.cw=this.getPadWidth(),v.ch=this.getPadHeight(),v.w=[window.screenLeft,window.screenTop,window.outerWidth,window.outerHeight];else if(E){const C=E.getPadWidth(),I=E.getPadHeight(),U=this.getPadRect();v.cw=C,v.ch=I,v.xlow=U.x/C,v.ylow=1-(U.y+U.height)/I,v.xup=v.xlow+U.width/C,v.yup=v.ylow+U.height/I}this.getPadRanges(v)?A.push(v):console.log(`fail to get ranges for pad ${this.pad.fName}`)}return this.painters.forEach(C=>{if((0,x.isFunc)(C.getWebPadOptions))f&&C.getWebPadOptions(A,E);else{const I=X(C);I&&v.primitives.push(I)}}),g?(0,x.toJSON)(A):void 0}getPadRanges(A){if(!A)return!1;const E=this.getFramePainter(),g=this.svg_this_pad();if(A.ranges=E?.ranges_set??!1,A.ux1=A.px1=A.ranges?E.scale_xmin:0,A.uy1=A.py1=A.ranges?E.scale_ymin:0,A.ux2=A.px2=A.ranges?E.scale_xmax:0,A.uy2=A.py2=A.ranges?E.scale_ymax:0,A.uz1=A.ranges?E.scale_zmin??0:0,A.uz2=A.ranges?E.scale_zmax??0:0,E&&(E.zoom_xmin!==E.zoom_xmax&&(A.zx1=E.zoom_xmin,A.zx2=E.zoom_xmax),E.zoom_ymin!==E.zoom_ymax&&(A.zy1=E.zoom_ymin,A.zy2=E.zoom_ymax),E.zoom_zmin!==E.zoom_zmax&&(A.zz1=E.zoom_zmin,A.zz2=E.zoom_zmax)),!A.ranges||g.empty())return!0;const v=(I,U,k)=>I?U<=0?k:(U=Math.log10(U),I>1&&(U/=Math.log10(I)),U):U,f=E.getFrameRect();A.ux1=v(E.logx,A.ux1,0),A.ux2=v(E.logx,A.ux2,1);let C=(A.ux2-A.ux1)/(f.width||10);return A.px1=A.ux1-C*f.x,A.px2=A.px1+C*this.getPadWidth(),A.uy1=v(E.logy,A.uy1,0),A.uy2=v(E.logy,A.uy2,1),C=(A.uy2-A.uy1)/(f.height||10),A.py1=A.uy1-C*f.y,A.py2=A.py1+C*this.getPadHeight(),!0}itemContextMenu(A){const E=this.svg_this_pad().node().getBoundingClientRect(),g={clientX:E.left+10,clientY:E.top+10};if("pad"===A)return(0,x.postponePromise)(()=>this.padContextMenu(g),50);let f,v=null;switch(A){case"xaxis":case"yaxis":case"zaxis":v=this.getFramePainter(),f=A[0];break;case"frame":v=this.getFramePainter();break;default:{const C=parseInt(A);Number.isInteger(C)&&(v=this.painters[C])}}return(0,x.isFunc)(v?.fillContextMenu)?(0,He.ES)(g,v).then(C=>{if(v.fillContextMenu(C,f)||v.snapid)return v.fillObjectExecMenu(C,f).then(()=>(0,x.postponePromise)(()=>C.show(),50))}):void 0}saveAs(A,E,g){g||(g=(this.this_pad_name||(this.iscan?"canvas":"pad"))+"."+A),this.produceImage(E,A).then(v=>{if(!v)return console.error(`Fail to produce image ${g}`);(0,Ve.OJ)(g,"svg"!==A?v:"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(v))})}findActivePad(){let A;return this.forEachPainterInPad(E=>{E.is_active_pad&&!A&&(A=E)},"pads"),A}produceImage(A,E){var g=this;return(0,Ee.A)(function*(){const v="frame"===A,f=v?g.getFrameSvg(g.this_pad_name):A?g.getCanvSvg():g.svg_this_pad(),C=A&&!v?g.getCanvPainter():g,I=[];if(f.empty())return"";if(v||!A){const he=g.getCanvSvg().selectChild(".canvas_defs");he.empty()||(I.push({prnt:g.getCanvSvg(),defs:he}),f.node().insertBefore(he.node(),f.node().firstChild))}let U=null;C.forEachPainterInPad(he=>{if(he.is_active_pad&&!U&&(U=he,U.drawActiveBorder(null,!1)),v)return;const G={prnt:he.svg_this_pad()};I.push(G);const b=he.getLayerSvg("btns_layer",he.this_pad_name);G.btns_node=b.node(),G.btns_node&&(G.btns_prnt=G.btns_node.parentNode,G.btns_next=G.btns_node.nextSibling,b.remove());const P=he.getFramePainter();if(!(0,x.isFunc)(P?.render3D)||!(0,x.isFunc)(P?.access3dKind))return;const T=P.access3dKind();if(T!==x.constants.Embed3D.Overlay&&T!==x.constants.Embed3D.Embed)return;const z=P.getSizeFor3d(x.constants.Embed3D.Embed),W=P.renderer.domElement;P.render3D(0);const fe=W.toDataURL("image/png");T===x.constants.Embed3D.Embed&&(G.foreign=G.prnt.select("."+z.clname),G.foreign.remove());const we=P.getFrameSvg();G.frame_node=we.node(),G.frame_node&&(G.frame_next=G.frame_node.nextSibling,we.remove()),G.img=G.prnt.insert("image",".primitives_layer").attr("x",z.x).attr("y",z.y).attr("width",W.width).attr("height",W.height).attr("href",fe)},"pads");let k=f.property("draw_width"),Z=f.property("draw_height");if(v){const he=g.getFramePainter();k=he.getFrameWidth(),Z=he.getFrameHeight()}const ee="pdf"===E?{node:f.node(),width:k,height:Z,reset_tranform:v}:(0,ke.NM)(`<svg width="${k}" height="${Z}" xmlns="http://www.w3.org/2000/svg">${f.node().innerHTML}</svg>`);return(0,ke.Vm)(ee,E).then(he=>{U?.drawActiveBorder(null,!0);for(let G=0;G<I.length;++G){const b=I[G];b.img?.remove();const P=b.prnt.selectChild(".primitives_layer");b.foreign&&b.prnt.node().insertBefore(b.foreign.node(),P.node()),b.frame_node&&P.node().insertBefore(b.frame_node,b.frame_next),b.btns_node&&b.btns_prnt.insertBefore(b.btns_node,b.btns_next),b.defs&&b.prnt.node().insertBefore(b.defs.node(),b.prnt.node().firstChild)}return he})})()}clickPadButton(A,E){if("CanvasSnapShot"===A)return this.saveAs("png",!0);if("enlargePad"===A)return this.enlargePad();if("PadSnapShot"===A)return this.saveAs("png",!1);if("PadContextMenus"===A)return E?.preventDefault(),E?.stopPropagation(),(0,He.IV)()?void 0:(0,He.ES)(E,this).then(f=>{f.add("header:Menus"),f.add(this.iscan?"Canvas":"Pad","pad",this.itemContextMenu),this.getFramePainter()&&f.add("Frame","frame",this.itemContextMenu);const C=this.getMainPainter();if(C&&(f.add("X axis","xaxis",this.itemContextMenu),f.add("Y axis","yaxis",this.itemContextMenu),(0,x.isFunc)(C.getDimension)&&C.getDimension()>1&&f.add("Z axis","zaxis",this.itemContextMenu)),this.painters?.length){f.add("separator");const I=[];this.painters.forEach((U,k)=>{const Z=U?.getObject();if(!Z||I.indexOf(Z)>=0)return;let ee=(0,x.isFunc)(U.getClassName)?U.getClassName():Z._typename||"";ee&&(ee+="::"),ee+=(0,x.isFunc)(U.getObjectName)?U.getObjectName():Z.fName||`item${k}`,f.add(ee,k,this.itemContextMenu),I.push(Z)})}f.show()});let g=!1;const v=[];for(let f=0;f<this.painters.length;++f){const C=this.painters[f];(0,x.isFunc)(C.clickPadButton)&&v.push(C.clickPadButton(A,E)),!g&&(0,x.isFunc)(C.clickButton)&&(g=C.clickButton(A),(0,x.isPromise)(g)&&v.push(g))}return Promise.all(v)}addPadButton(A,E,g,v){if(x.settings.ToolBar&&!this.isBatchMode()){this._buttons||(this._buttons=[]);for(let C=0;C<this._buttons.length;++C)if(this._buttons[C].funcname===g)return;if(this._buttons.push({btn:A,tooltip:E,funcname:g,keyname:v}),!this.iscan&&this.has_canvas&&0!==g.indexOf("Pad")&&"enlargePad"!==g){const C=this.getCanvPainter();C&&C!==this&&C.addPadButton(A,E,g)}}}showPadButtons(){this._buttons&&(Q.assign(this),this.showPadButtons())}addPadButtons(A){this.addPadButton("camera","Create PNG",this.iscan?"CanvasSnapShot":"PadSnapShot","Ctrl PrintScreen"),x.settings.ContextMenu&&this.addPadButton("question","Access context menus","PadContextMenus"),(!this.iscan&&this.has_canvas&&this.hasObjectsToDraw()||this.enlargeMain("verify"))&&this.addPadButton("circle","Enlarge canvas","enlargePad"),A&&this.brlayout&&(this.addPadButton("diamand","Toggle Ged","ToggleGed"),this.addPadButton("three_circles","Toggle Status","ToggleStatus"))}decodeOptions(A){const E=this.getObject();if(!E)return;const g=new ke.nC(A);function v(f,C){C||(C=E),f(C);const I=C.fPrimitives?.arr||[];for(let U=0;U<I.length;++U)I[U]._typename===x.clTPad&&v(f,I[U])}this.options||(this.options={}),Object.assign(this.options,{GlobalColors:!0,LocalColors:!1,CreatePalette:0,IgnorePalette:!1,RotateFrame:!1,FixFrame:!1}),(g.check("NOCOLORS")||g.check("NOCOL"))&&(this.options.GlobalColors=this.options.LocalColors=!1),(g.check("LCOLORS")||g.check("LCOL"))&&(this.options.GlobalColors=!1,this.options.LocalColors=!0),(g.check("NOPALETTE")||g.check("NOPAL"))&&(this.options.IgnorePalette=!0),g.check("ROTATE")&&(this.options.RotateFrame=!0),g.check("FIXFRAME")&&(this.options.FixFrame=!0),g.check("FIXSIZE")&&this.iscan&&(this._fixed_size=!0),g.check("CP",!0)&&(this.options.CreatePalette=g.partAsInt(0,0)),g.check("NOZOOMX")&&(this.options.NoZoomX=!0),g.check("NOZOOMY")&&(this.options.NoZoomY=!0),g.check("GRAYSCALE")&&!E.TestBit(J)&&E.InvertBit(J),g.check("NOMARGINS")&&v(f=>{f.fLeftMargin=f.fRightMargin=f.fBottomMargin=f.fTopMargin=0}),g.check("WHITE")&&v(f=>{f.fFillColor=0}),g.check("LOG2X")&&v(f=>{f.fLogx=2,f.fUxmin=0,f.fUxmax=1,f.fX1=0,f.fX2=1}),g.check("LOGX")&&v(f=>{f.fLogx=1,f.fUxmin=0,f.fUxmax=1,f.fX1=0,f.fX2=1}),g.check("LOG2Y")&&v(f=>{f.fLogy=2,f.fUymin=0,f.fUymax=1,f.fY1=0,f.fY2=1}),g.check("LOGY")&&v(f=>{f.fLogy=1,f.fUymin=0,f.fUymax=1,f.fY1=0,f.fY2=1}),g.check("LOG2Z")&&v(f=>{f.fLogz=2}),g.check("LOGZ")&&v(f=>{f.fLogz=1}),g.check("LOGV")&&v(f=>{f.fLogv=1}),g.check("LOG2")&&v(f=>{f.fLogx=f.fLogy=f.fLogz=2}),g.check("LOG")&&v(f=>{f.fLogx=f.fLogy=f.fLogz=1}),g.check("LNX")&&v(f=>{f.fLogx=3,f.fUxmin=0,f.fUxmax=1,f.fX1=0,f.fX2=1}),g.check("LNY")&&v(f=>{f.fLogy=3,f.fUymin=0,f.fUymax=1,f.fY1=0,f.fY2=1}),g.check("LN")&&v(f=>{f.fLogx=f.fLogy=f.fLogz=3}),g.check("GRIDX")&&v(f=>{f.fGridx=1}),g.check("GRIDY")&&v(f=>{f.fGridy=1}),g.check("GRID")&&v(f=>{f.fGridx=f.fGridy=1}),g.check("TICKX")&&v(f=>{f.fTickx=1}),g.check("TICKY")&&v(f=>{f.fTicky=1}),g.check("TICKZ")&&v(f=>{f.fTickz=1}),g.check("TICK")&&v(f=>{f.fTickx=f.fTicky=1}),g.check("OTX")&&v(f=>{f.$OTX=!0}),g.check("OTY")&&v(f=>{f.$OTY=!0}),g.check("CTX")&&v(f=>{f.$CTX=!0}),g.check("CTY")&&v(f=>{f.$CTY=!0}),g.check("RX")&&v(f=>{f.$RX=!0}),g.check("RY")&&v(f=>{f.$RY=!0}),this.storeDrawOpt(A)}static draw(A,E,g){return(0,Ee.A)(function*(){const v=new B(A,E,!1);v.decodeOptions(g),v.getCanvSvg().empty()?(v.has_canvas=!1,v.this_pad_name="",v.setTopPainter()):v.addToPadPrimitives(v.pad_name),v.createPadSvg(),v.matchObjectType(x.clTPad)&&(!v.has_canvas||v.hasObjectsToDraw())&&v.addPadButtons();const f=v.has_canvas?v.selectCurrentPad(v.this_pad_name):void 0;return(0,ot.QD)({pp:v,active:!0}),v.drawPrimitives().then(()=>(v.showPadButtons(),v.addPadInteractive(),v.selectCurrentPad(f),v))})()}}},6043:(Yr,mt,Se)=>{"use strict";Se.r(mt),Se.d(mt,{HierarchyPainter:()=>U,drawInspector:()=>ee,drawList:()=>Y,drawStreamerInfo:()=>k,folderHierarchy:()=>Q,getHPainter:()=>He.gZ,keysHierarchy:()=>B,listHierarchy:()=>X,markAsStreamerInfo:()=>E,objectHierarchy:()=>$,taskHierarchy:()=>me});var Ee=Se(4882),x=Se(8872),L=Se(8362),ve=Se(4369),ke=Se(2985),ot=Se(2843),Ye=Se(1922),Ze=Se(7900),Re=Se(6923),He=Se(6157),Ve=Se(5992);const De="TopFolder";function J(G){return G<1e4?G.toFixed(0)+"B":G<1e6?(G/1e3).toFixed(2)+"KiB":G<1e9?(G/1e6).toFixed(2)+"MiB":(G/1e9).toFixed(2)+"GiB"}function Y(G,b,P){return ue.apply(this,arguments)}function ue(){return(ue=(0,Ee.A)(function*(G,b,P){return b&&b.arr?{dom:G,lst:b,opt:P,indx:-1,painter:null,draw_next(){for(;++this.indx<this.lst.arr.length;){const z=this.lst.arr[this.indx];if(z)return(0,Re.$2)(this.dom,z,this.lst.opt&&this.lst.opt[this.indx]?this.lst.opt[this.indx]:this.opt).then(fe=>(fe&&!this.painter&&(this.painter=fe),this.draw_next()))}return this.painter}}.draw_next():null})).apply(this,arguments)}function Q(G,b){if(!b?.fFolders)return!1;if(0===b.fFolders.arr.length)return G._more=!1,!0;G._childs=[];for(let P=0;P<b.fFolders.arr.length;++P){const T=b.fFolders.arr[P];G._childs.push({_name:T.fName,_kind:x.prROOT+T._typename,_obj:T})}return!0}function me(G,b){if(!b?.fTasks)return!1;if($(G,b,{exclude:["fTasks","fName"]}),0===b.fTasks.arr.length&&0===G._childs.length)return G._more=!1,!0;for(let P=0;P<b.fTasks.arr.length;++P){const T=b.fTasks.arr[P];G._childs.push({_name:T.fName,_kind:x.prROOT+T._typename,_obj:T})}return!0}function X(G,b){if(!(0,x.isRootCollection)(b))return!1;if(void 0===b.arr||0===b.arr.length)return G._more=!1,!0;let P=!1,T=G;for(;T;)T._do_context&&(P=!0),T=T._parent;const z=b._typename===x.clTMap,W=[],fe=[],we=[];for(let Me=0;Me<b.arr.length;++Me){const je=z?b.arr[Me].first:b.arr[Me];if(!je)continue;const Ge=je.fName||je.name;if(!Ge)continue;const lt=W.indexOf(Ge);lt>=0?fe[lt]++:(fe[W.length]=we[W.length]=1,W.push(Ge))}G._childs=[];for(let Me=0;Me<b.arr.length;++Me){const je=z?b.arr[Me].first:b.arr[Me];let Ge;if(je?._typename){switch(Ge={_name:je.fName||je.name,_kind:x.prROOT+je._typename,_title:`${je.fTitle||""} type:${je._typename}`,_obj:je},je._typename){case x.clTColor:Ge._value=(0,ke.d_)(je);break;case x.clTText:case x.clTLatex:Ge._value=je.fTitle;break;case x.clTObjString:Ge._value=je.fString;break;default:b.opt&&b.opt[Me]&&b.opt[Me].length&&(Ge._value=b.opt[Me])}if(P&&(0,Re.Xv)(je._typename)&&(Ge._direct_context=!0),!Ge._name||Number.isInteger(parseInt(Ge._name))&&parseInt(Ge._name)!==Me||b.arr.indexOf(je)<Me)Ge._name=Me.toString();else{const lt=W.indexOf(je.fName);lt>=0&&fe[lt]>1&&(Ge._cycle=we[lt]++,Ge._keyname=Ge._name,Ge._name=Ge._keyname+";"+Ge._cycle)}}else Ge={_name:Me.toString(),_kind:x.prROOT+"NULL",_title:"NULL",_value:"null",_obj:null};G._childs.push(Ge)}return!0}function B(G,b,P,T){if(void 0===b)return!1;G._childs=[];for(let z=0;z<b.length;++z){const W=b[z];if(x.settings.OnlyLastCycle&&z>0&&W.fName===b[z-1].fName&&W.fCycle<b[z-1].fCycle)continue;const fe={_name:W.fName+";"+W.fCycle,_cycle:W.fCycle,_kind:x.prROOT+W.fClassName,_title:W.fTitle+` (size: ${J(W.fObjlen)})`,_keyname:W.fName,_readobj:null,_parent:G};if(W.fRealName&&(fe._realname=W.fRealName+";"+W.fCycle),W.fClassName===ve.Fk||W.fClassName===ve.lZ){const we=T&&P?P.getDir(T+W.fName):null;we?(fe._name=W.fName,B(fe,we.fKeys,P,T+W.fName+"/")):(fe._more=!0,fe._expand=function(Me,je){return B(Me,je.fKeys)})}else if(W.fClassName===x.clTList&&W.fName===ve.D1){if(x.settings.SkipStreamerInfos)continue;fe._name=ve.D1,fe._kind=x.prROOT+ve.R0,fe._title="List of streamer infos for binary I/O",fe._readobj=P.fStreamerInfos}G._childs.push(fe)}return!0}function $(G,b,P=void 0){if(!G||null===b)return!1;G._childs=[];let T=Object.prototype.toString.apply(b);if("[object DataView]"===T){let Je={_parent:G,_name:"size",_value:b.byteLength.toString(),_vclass:"h_value_num"};G._childs.push(Je);const tt=b.byteLength<10?1:Math.log10(b.byteLength);for(let Fe=0;Fe<b.byteLength;++Fe){if(Fe%16==0){for(Je={_parent:G,_name:Fe.toString(),_value:"",_vclass:"h_value_num"};Je._name.length<tt;)Je._name="0"+Je._name;G._childs.push(Je)}let Ne=b.getUint8(Fe).toString(16);for(;Ne.length<2;)Ne="0"+Ne;Je._value&&(Je._value+=Fe%4==0?" | ":" "),Je._value+=Ne}return!0}let z=!0,W=!1,fe=G;for(;fe;){if(fe._do_context&&(W=!0),"_nosimple"in fe){z=fe._nosimple;break}fe=fe._parent}const we=(0,x.isArrayProto)(T)>0&&b.length,Me=we&&b.length>x.settings.HierarchyLimit;let Ge,lt,bt,te,je=!1;if(we&&"Object"===G._name&&!G._parent&&(G._name="Array"),Me){je=!0;for(let Je=0;Je<b.length;++Je){const tt=typeof b[Je];if(!("number"===tt||"boolean"===tt||"string"===tt&&b[Je].length<16)){je=!1;break}}}if("_obj"in G?G._obj!==b&&alert("object missmatch"):G._obj=b,G._title||(b._typename?G._title=x.prROOT+b._typename:we&&(G._title="Array len: "+b.length)),je){for(let Je=0;Je<b.length;){let tt=Math.min(Je+10,b.length),Fe=!0,Ne=Je;for(;Fe;){Fe=!0;for(let St=Ne;St<tt;++St)b[Je]!==b[St]&&(Fe=!1);if(Fe){if(tt===b.length)break;Ne=tt,tt=Math.min(tt+10,b.length)}else if(Ne!==Je){tt=Ne,Fe=!0;break}}const rt={_parent:G,_name:Je+".."+(tt-1),_vclass:"h_value_num"};if(Fe)rt._value=b[Je].toString();else{rt._value="";for(let St=Je;St<tt;++St)rt._value+=(St===Je?"[ ":", ")+b[St].toString();rt._value+=" ]"}G._childs.push(rt),Je=tt}return!0}for(const Je in b){if("_typename"===Je||"$"===Je[0])continue;const tt=b[Je];if((0,x.isFunc)(tt)||P?.exclude&&P.exclude.indexOf(Je)>=0)continue;if(Me&&Ge){if(bt===tt){++te,lt=Je;continue}te>0&&(Ge._name+=".."+lt)}const Fe={_parent:G,_name:Je};if(Me&&(Ge=Fe,lt=Je,bt=tt,te=0),null===tt){Fe._value=Fe._title="null",z||G._childs.push(Fe);continue}let Ne=!1;if((0,x.isObject)(tt))if(T=Object.prototype.toString.apply(tt),(0,x.isArrayProto)(T)>0)Fe._title="array len="+tt.length,Ne="[object Array]"!==T,0===tt.length?(Fe._value="[ ]",Fe._more=!1):(Fe._value="[...]",Fe._more=!0,Fe._expand=$,Fe._obj=tt);else if("[object DataView]"===T)Fe._title="DataView len="+tt.byteLength,Fe._value="[...]",Fe._more=!0,Fe._expand=$,Fe._obj=tt;else if("[object Date]"===T)Fe._more=!1,Fe._title="Date",Fe._value=tt.toString(),Fe._vclass="h_value_num";else{(tt.$kind||tt._typename)&&(Fe._kind=Fe._title=x.prROOT+(tt.$kind||tt._typename)),tt._typename&&(Fe._title=tt._typename,W&&(0,Re.Xv)(tt._typename)&&(Fe._direct_context=!0));let rt=G,St=!1;for(;rt&&!St;)St=rt._obj===tt,rt=rt._parent;if(St)Fe._value="{ prnt }",Fe._vclass="h_value_num",Fe._more=!1,Ne=!0;else switch(Fe._obj=tt,Fe._more=!1,tt._typename){case x.clTColor:Fe._value=(0,ke.d_)(tt);break;case x.clTText:case x.clTLatex:Fe._value=tt.fTitle;break;case x.clTObjString:Fe._value=tt.fString;break;default:(0,x.isRootCollection)(tt)&&(0,x.isObject)(tt.arr)?(Fe._value=tt.arr.length?"[...]":"[]",Fe._title+=", size:"+tt.arr.length,tt.arr.length>0&&(Fe._more=!0)):(Fe._more=!0,Fe._value="{ }")}}else"number"==typeof tt||"boolean"==typeof tt?(Ne=!0,Fe._value="fBits"===Je?"0x"+tt.toString(16):tt.toString(),Fe._vclass="h_value_num"):(0,x.isStr)(tt)?(Ne=!0,Fe._value="&quot;"+tt.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+"&quot;",Fe._vclass="h_value_str"):typeof tt>"u"?(Ne=!0,Fe._value="undefined",Fe._vclass="h_value_num"):(Ne=!0,alert(`miss ${Je} type ${typeof tt}`));(!Ne||!z)&&G._childs.push(Fe)}return Me&&Ge&&te>0&&(Ge._name+=".."+lt),!0}function A(G){const b={_name:ve.D1,_childs:[]};for(let P=0;P<G.arr.length;++P){const T=G.arr[P];if(T._typename===x.clTList)continue;if(typeof T.fName>"u"){console.warn(`strange element in StreamerInfo with type ${T._typename}`);continue}const z={_name:`${T.fName};${T.fClassVersion}`,_kind:`class ${T.fName}`,_title:`class:${T.fName} version:${T.fClassVersion} checksum:${T.fCheckSum}`,_icon:"img_class",_childs:[]};if(T.fTitle&&(z._title+="  "+T.fTitle),b._childs.push(z),!(typeof T.fElements>"u")){for(let W=0;W<T.fElements.arr.length;++W){const fe=T.fElements.arr[W];if(!fe?.fName)continue;let we=`${fe.fTypeName} ${fe.fName}`;const Me=`${fe.fTypeName} type:${fe.fType}`;if(1===fe.fArrayDim)we+=`[${fe.fArrayLength}]`;else for(let je=0;je<fe.fArrayDim;++je)we+=`[${fe.fMaxIndex[je]}]`;4294967295===fe.fBaseVersion?we+=":-1":void 0!==fe.fBaseVersion&&(we+=`:${fe.fBaseVersion}`),we+=";",fe.fTitle&&(we+=` // ${fe.fTitle}`),z._childs.push({_name:we,_title:Me,_kind:fe.fTypeName,_icon:"BASE"===fe.fTypeName?"img_class":"img_member"})}z._childs.length||delete z._childs}}return b}function E(G,b,P){P?._typename===x.clTList&&(P._typename=ve.R0)}function g(G){const b={_name:"Object",_title:"",_click_action:"expand",_nosimple:!1,_do_context:!0};return(0,x.isStr)(G.fName)&&G.fName&&(b._name=G.fName),(0,x.isStr)(G.fTitle)&&G.fTitle&&(b._title=G.fTitle),G._typename&&(b._title+=`  type:${G._typename}`),(0,x.isRootCollection)(G)?(b._name=G.name||G._typename,X(b,G)):$(b,G),b}function v(G){const b=[];if(!(0,x.isStr)(G)||!(G=G.trim()))return b;if(G.length<2||"["!==G[0]||"]"!==G[G.length-1])return b.push(G),b;let P=0,T=0,z=0,W=1;for(let fe=1;fe<G.length;++fe)if(T>0)"'"===G[fe]&&T--;else if(z>0)'"'===G[fe]&&z--;else switch(G[fe]){case"'":T++;break;case'"':z++;break;case"[":P++;break;case"]":if(fe<G.length-1){P--;break}case",":if(0===P){let we=G.substring(W,fe).trim();we.length>1&&we[0]===we[we.length-1]&&('"'===we[0]||"'"===we[0])&&(we=we.slice(1,we.length-1)),b.push(we),W=fe+1}}return 0===b.length&&b.push(G.slice(1,G.length-1).trim()),b}function f(G,b){if(b&&G&&"_childs"in b){for(let P=0;P<b._childs.length;++P)(b._childs[P]._more||b._childs[P]._childs)&&(b._childs[P]._expand=f);return G._childs=b._childs,b._childs=null,!0}return!1}function C(G){return G?.expand||G?.get_expand||G?.expand_item}const I=x.prROOT+x.clTFile;class U extends ot.b8{constructor(b,P,T){super(P),this.name=b,this.h=null,this.with_icons=!0,"__as_dark_mode__"===T?this.setBasicColors():this.background=T,this.files_monitoring=!P,this.nobrowser=null===P,(0,He.gZ)()||(0,He.kV)(this)}setBasicColors(){this.background=x.settings.DarkMode?"black":"white",this.textcolor=x.settings.DarkMode?"#eee":"#111"}cleanup(){this.clearHierarchy(!0),super.cleanup(),(0,He.gZ)()===this&&(0,He.kV)(null)}fileHierarchy(b,P){const T=this;return P||(P={}),P._name=b.fFileName,P._title=(b.fTitle?b.fTitle+", path: ":"")+b.fFullURL+`, size: ${J(b.fEND)}`,P._kind=I,P._file=b,P._fullurl=b.fFullURL,P._localfile=b.fLocalFile,P._had_direct_read=!1,P._get=function(z,W){if(z?._readobj)return Promise.resolve(z._readobj);z&&(W=T.itemFullName(z,this));const fe=we=>(this._file||(this._file=we),we?we.readObject(W).then(Me=>{if(!z&&Me){const je=T.findItem({name:W,top:this,last_exists:!0,check_keys:!0});if(void 0!==je?.last&&je.last!==this){const Ge=we.getDir(T.itemFullName(je.last,this));if(Ge){je.last._name=je.last._keyname;const lt=T.itemFullName(je.last,this);B(je.last,Ge.fKeys,we,lt+"/")}}else B(this,we.fKeys,we,"");z=T.findItem({name:W,top:this})}return z&&(z._readobj=Me,"_expand"in z&&(z._name=z._keyname)),Me}):Promise.resolve(null));return this._file?fe(this._file):this._localfile?(0,ve.Tq)(this._localfile).then(we=>fe(we)):this._fullurl?(0,ve.Tq)(this._fullurl).then(we=>fe(we)):Promise.resolve(null)},B(P,b.fKeys,b,""),P}forEachItem(b,P){(0,x.isFunc)(b)&&function T(z,W){if(z&&(W&&(z._parent=W),b(z),"_childs"in z))for(let fe=0;fe<z._childs.length;++fe)T(z._childs[fe],z)}(P||this.h)}findItem(b){let T=this.h,z="";if((0,x.isStr)(b))z=b,b={};else{if(!(0,x.isObject)(b))return null;z=b.name,"top"in b&&(T=b.top)}return"__top_folder__"===z?T:(0,x.isStr)(z)&&0===z.indexOf("img:")?null:function P(W,fe){if(!fe||!W)return W;let we=fe.length;if(!W._parent&&W._kind!==De&&0===fe.indexOf(W._name)){if(fe===W._name)return W;const je=W._name.length;"/"===fe[je]&&(fe=fe.slice(je+1),we=fe.length)}function Me(je,Ge){return Ge||(je._parent=W),we>=fe.length-1||we<0?je:P(je,fe.slice(we+1))}for(;we>0;){let je=we>=fe.length?fe:fe.slice(0,we);if(W._childs){for(let lt=0;lt<W._childs.length;++lt)if(W._childs[lt]._name===je)return Me(W._childs[lt]);if(W._kind===De&&void 0!==W._childs[0]._online)for(let lt=0;lt<W._childs[0]._childs.length;++lt)if(W._childs[0]._childs[lt]._name===je)return Me(W._childs[0]._childs[lt],!0);if(b.check_keys){let lt=null;for(let bt=0;bt<W._childs.length;++bt)W._childs[bt]._keyname===je&&(!lt||lt._cycle<W._childs[bt]._cycle)&&(lt=W._childs[bt]);if(lt)return Me(lt)}let Ge=b.allow_index;if("["===je[0]&&"]"===je[je.length-1]&&/^\d+$/.test(je.slice(1,je.length-1))&&(Ge=!0,je=je.slice(1,je.length-1)),Ge&&/^\d+$/.test(je)){const lt=parseInt(je);if(Number.isInteger(lt)&&lt>=0&&lt<W._childs.length)return Me(W._childs[lt])}}we=fe.lastIndexOf("/",we-1)}if(b.force){void 0===W._childs&&(W._childs=[]),we=fe.indexOf("/");const je={_name:we<0?fe:fe.slice(0,we)};return W._childs.push(je),Me(je)}return b.last_exists?{last:W,rest:fe}:null}(T,z)}itemFullName(b,P,T){if(b&&b._kind===De)return"__top_folder__";let z="";for(;b;){if(void 0!==b._online&&!P)return z;if(b===P||b._kind===De||T&&!b._parent)break;z&&(z="/"+z),z=b._name+z,b=b._parent}return z}executeCommand(b,P){var T=arguments,z=this;return(0,Ee.A)(function*(){const W=z.findItem(b),fe=z.getOnlineItemUrl(W)+"/cmd.json",we=(0,L.Lt)(P),Me=[];if("_numargs"in W)for(let Ge=0;Ge<W._numargs;++Ge)Me.push(Ge+2<T.length?T[Ge+2]:"");return(0!==Me.length&&P?(0,Ze.ES)().then(Ge=>Ge.showCommandArgsDialog(W._name,Me)):Promise.resolve(Me)).then(Ge=>{if(null===Ge)return!1;let lt="";for(let bt=0;bt<Ge.length;++bt)lt+=`${bt>0?"&":"?"}arg${bt+1}=${Ge[bt]}`;return we.empty()||(we.style("background","yellow"),W._title&&we.attr("title","Executing "+W._title)),(0,x.httpRequest)(fe+lt,"text").then(bt=>{if(we.empty())return bt;const te=bt&&"false"!==bt?"green":"red";return we.style("background",te),W._title&&we.attr("title",W._title+" lastres="+bt),setTimeout(()=>{we.style("background",null),W._icon&&we.classed("jsroot_fastcmd_btn")&&we.style("background-image",`url('${W._icon}')`)},2e3),"green"===te&&"_hreload"in W&&z.reload(),"green"===te&&"_update_item"in W&&z.updateItems(W._update_item.split(";")),bt})})})()}getObject(b,P){var T=this;return(0,Ee.A)(function*(){const z={item:null,obj:null};let W,fe;if(null===b)return z;if((0,x.isStr)(b)?W=b:(0,x.isObject)(b)&&(void 0!==b._parent&&void 0!==b._name&&void 0!==b._kind?fe=b:void 0!==b.name?W=b.name:void 0!==b.arg?W=b.arg:void 0!==b.item&&(fe=b.item)),(0,x.isStr)(W)&&0===W.indexOf("img:"))return z.obj={_typename:"TJSImage",fName:W.slice(4)},z;fe?W=T.itemFullName(fe):fe=T.findItem({name:W,allow_index:!0,check_keys:!0});const we=fe?null:T.findItem({name:W,last_exists:!0,check_keys:!0,allow_index:!0});if(null!==we&&"last"in we&&null!==we.last){const je=T.itemFullName(we.last);return(0,x.isObject)(b)&&"rest"in b&&(b.rest===we.rest||b.rest.length<=we.rest.length)?z:T.expandItem(je,void 0,"hierarchy_expand_verbose"!==P).then(Ge=>{if(!Ge)return z;let lt=T.itemFullName(we.last);return lt&&(lt+="/"),T.getObject({name:lt+we.rest,rest:we.rest},P)})}if(z.item=fe,null!==fe&&(0,x.isObject)(fe._obj))return z.obj=fe._obj,z;let Me=fe;for(;Me;){if((0,x.isFunc)(Me._get))return Me._get(fe,null,P).then(je=>(z.obj=je,z));Me="_parent"in Me?Me._parent:null}return z})()}isLastSibling(b){if(!b||!b._parent||!b._parent._childs)return!1;const P=b._parent._childs;let T=P.indexOf(b);if(T<0)return!1;for(;++T<P.length;)if(!("_hidden"in P[T]))return!1;return!0}addItemHtml(b,P,T){if(!b||"_hidden"in b)return!0;const z=b===this.h,W="_childs"in b,fe=(0,Re.hd)(b._kind),we=this.itemFullName(b);let bt,Me="",je="",Ge=!1,lt=!1;fe&&("icon"in fe&&(Me=fe.icon),"icon2"in fe&&(je=fe.icon2),!Me&&(0,x.isFunc)(fe.icon_get)&&(Me=fe.icon_get(b,this)),((0,Re.Xv)(fe)||"execute"in fe||"aslink"in fe||C(fe)&&!1!==b._more)&&(Ge=!0)),"_icon"in b&&(Me=b._icon),"_icon2"in b&&(je=b._icon2),!Me&&"_online"in b&&(b._icon=Me="img_globe"),!Me&&z&&(b._icon=Me="img_base"),(b._more||b._expand||b._player||b._can_draw)&&(Ge=!0);let te=Ge;!te&&(0,x.isStr)(b._kind)&&0===b._kind.indexOf(x.prROOT)&&(te=Ge=!0),je||(je=Me),Me||(Me=W||b._more?"img_folder":"img_page"),je||(je=W||b._more?"img_folderopen":"img_page"),"update"===T?(P.selectAll("*").remove(),bt=P):(bt=P.append("div"),T&&T>=(b._parent._show_limit||x.settings.HierarchyLimit)&&(lt=!0)),b._d3cont=bt.node(),bt.attr("item",we);const Je=bt.append("div").attr("class","h_line");let tt=z?null:b._parent;for(;tt&&tt!==this.h;)Je.insert("div",":first-child").attr("class",this.isLastSibling(tt)?"img_empty":"img_line"),tt=tt._parent;let Fe="",Ne=!1;z||(W&&!lt?(Fe=b._isopen?"img_minus":"img_plus",Ne=!0):Fe="img_join");const rt=this;if(Fe){(lt||this.isLastSibling(b))&&(Fe+="bottom");const vt=Je.append("div").attr("class",Fe);Ne&&vt.style("cursor","pointer").on("click",function(Yt){rt.tree_click(Yt,this,"plusminus")})}if(this.with_icons&&!lt){const vt=b._isopen?je:Me,Yt=0===vt.indexOf("img_")?Je.append("div").attr("class",vt).attr("title",b._kind):Je.append("img").attr("src",vt).attr("alt","").attr("title",b._kind).style("vertical-align","top").style("width","18px").style("height","18px");("_icon_click"in b||fe&&"icon_click"in fe)&&Yt.on("click",function(qt){rt.tree_click(qt,this,"icon")})}const St=Je.append("a");if((Ge||W||lt)&&St.attr("class","h_item").on("click",function(vt){rt.tree_click(vt,this)}),lt)return b._break_point=!0,St.attr("title","there are "+(b._parent._childs.length-T)+" more items").text("...more..."),!1;"disp_kind"in rt?(x.settings.DragAndDrop&&Ge&&this.enableDrag(St,we),x.settings.ContextMenu&&te&&St.on("contextmenu",function(vt){rt.tree_contextmenu(vt,this)}),St.on("mouseover",function(){rt.tree_mouseover(!0,this)}).on("mouseleave",function(){rt.tree_mouseover(!1,this)})):b._direct_context&&x.settings.ContextMenu&&St.on("contextmenu",function(vt){rt.direct_contextmenu(vt,this)});let pt=b._name,st="";if("_realname"in b&&(pt=b._realname),"_title"in b&&(st=b._title),"_fullname"in b&&(st+="  fullname: "+b._fullname),st||(st=pt),St.attr("title",st).text(pt+("_value"in b?":":"")).style("background",b._background?b._background:null),"_value"in b){const vt=Je.append("p");"_vclass"in b&&vt.attr("class",b._vclass),b._isopen||vt.html(b._value)}if(W&&(z||b._isopen)){const vt=bt.append("div").attr("class","h_childs");this.show_overflow&&vt.style("overflow","initial");for(let Yt=0;Yt<b._childs.length;++Yt){const qt=b._childs[Yt];if(qt._parent=b,!this.addItemHtml(qt,vt,Yt))break}}return!0}toggleOpenState(b,P,T){const z=P||this.h;if(void 0===z._childs){if(!b||this.with_icons&&!z._more&&!z._expand&&!this.canExpandItem(z))return!1;const fe=this.expandItem(this.itemFullName(z));return(0,x.isPromise)(fe)&&(0,x.isObject)(T)&&T.push(fe),void 0!==z._childs&&(z._isopen=!0),z._isopen}if(z!==this.h&&b&&!z._isopen)return z._isopen=!0,!0;let W=!1;for(let fe=0;fe<z._childs.length;++fe)this.toggleOpenState(b,z._childs[fe],T)&&(W=!0);return z===this.h||b||!z._isopen||W?(P||this.refreshHtml(),!1):(delete z._isopen,!0)}exapndToLevel(b){var P=this;return(0,Ee.A)(function*(){if(!b||!Number.isFinite(b)||b<0)return P;const T=[];return P.toggleOpenState(!0,P.h,T),Promise.all(T).then(()=>P.exapndToLevel(b-1))})()}refreshHtml(){var b=this;return(0,Ee.A)(function*(){const P=b.selectDom();if(P.empty())return b;P.html("").style("overflow",b.show_overflow?"auto":"hidden").style("display","flex").style("flex-direction","column"),function F(G){function b(W,fe,we,Me){return`.jsroot .img_${W} { display: inline-block; height: ${fe}px; width: ${fe}px; background-image: url("data:image/${we};base64,${Me}"); }`}(0,Ve.fz)(`\n.jsroot .h_tree { display: block; white-space: nowrap; }\n.jsroot .h_tree * { padding: 0; margin: 0; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; box-sizing: content-box; line-height: 14px }\n.jsroot .h_tree img { border: 0px; vertical-align: middle; }\n.jsroot .h_tree a { text-decoration: none; vertical-align: top; white-space: nowrap; padding: 1px 2px 0px 2px; display: inline-block; margin: 0; }\n.jsroot .h_tree p { font-weight: bold; white-space: nowrap; text-decoration: none; vertical-align: top; white-space: nowrap; padding: 1px 2px 0px 2px; display: inline-block; margin: 0; }\n.jsroot .h_value_str { color: green; }\n.jsroot .h_value_num { color: blue; }\n.jsroot .h_line { height: 18px; display: block; }\n.jsroot .h_button { cursor: pointer; color: blue; text-decoration: underline; }\n.jsroot .h_item { cursor: pointer; }\n.jsroot .h_item:hover { text-decoration: underline; }\n.jsroot .h_childs { overflow: hidden; display: block; }\n.jsroot_fastcmd_btn { height: 32px; width: 32px; display: inline-block; margin: 2px; padding: 2px; background-position: left 2px top 2px;\n                      background-repeat: no-repeat; background-size: 24px 24px; border-color: inherit; }\n.jsroot_inspector { border: 1px solid ${x.settings.DarkMode?"green":"black"}; box-shadow: 1px 1px 2px 2px ${x.settings.DarkMode?"#555":"#aaa"}; opacity: 0.95; background-color: ${x.settings.DarkMode?"black":"#E6E6FA"}; }\n.jsroot_drag_area { background-color: #007fff; }\n${b("minus",18,"gif","R0lGODlhEgASAJEDAIKCgoCAgAAAAP///yH5BAEAAAMALAAAAAASABIAAAInnD+By+2rnpyhWvsizE0zf4CIIpRlgiqaiDosa7zZdU22A9y6u98FADs=")}\n${b("minusbottom",18,"gif","R0lGODlhEgASAJECAICAgAAAAP///wAAACH5BAEAAAIALAAAAAASABIAAAImlC+Ay+2rnpygWvsizE0zf4CIEpRlgiqaiDosa7zZdU32jed6XgAAOw==")}\n${b("plus",18,"gif","R0lGODlhEgASAJECAICAgAAAAP///wAAACH5BAEAAAIALAAAAAASABIAAAIqlC+Ay+2rnpygWvsizCcczWieAW7BeSaqookfZ4yqU5LZdU06vfe8rysAADs=")}\n${b("plusbottom",18,"gif","R0lGODlhEgASAJECAICAgAAAAP///wAAACH5BAEAAAIALAAAAAASABIAAAIplC+Ay+2rnpygWvsizCcczWieAW7BeSaqookfZ4yqU5LZdU36zvd+XwAAOw==")}\n${b("empty",18,"gif","R0lGODlhEgASAJEAAAAAAP///4CAgP///yH5BAEAAAMALAAAAAASABIAAAIPnI+py+0Po5y02ouz3pwXADs=")}\n${b("line",18,"gif","R0lGODlhEgASAIABAICAgP///yH5BAEAAAEALAAAAAASABIAAAIZjB+Ay+2rnpwo0uss3kfz7X1XKE5k+ZxoAQA7")}\n${b("join",18,"gif","R0lGODlhEgASAIABAICAgP///yH5BAEAAAEALAAAAAASABIAAAIcjB+Ay+2rnpwo0uss3kf5BGocNJZiSZ2opK5BAQA7")}\n${b("joinbottom",18,"gif","R0lGODlhEgASAIABAICAgP///yH5BAEAAAEALAAAAAASABIAAAIZjB+Ay+2rnpwo0uss3kf5BGrcSJbmiaZGAQA7")}\n${b("base",18,"gif","R0lGODlhEwASAPcAAPv6/Pn4+mnN/4zf/764x2vO//Dv84HZ/5jl/0ZGmfTz9vLy8lHB/+zr70u+/7S03IODtd7d6c/P0ndqiq/w/4Pb/5SKo/Py9fPy9tTU121kjd/f4MzM062tx5+zy5rO67GwxNDM14d8mJzn/7awwry713zX/9bW27u71lFRmW5uoZ+fxjOy/zm1/9HQ2o3g/2xfgZeMplav7sn9/6Cgv37X/6Dp/3jU/2uJ2M7J1JC63vn5+v38/d7e38PD0Z7o/9LR4LS01cPDzPb1+Nzb5IJ2lHCEv5bk/53C3MrJ3X56t+np6YF7o3JsndTU5Wtgh5GHoKaesuLi4mrO/19RdnnV/4WBqF5QdWPK/4+PvW5uu4+PuuHh4q7w/97e68C9z63w/9PT0+zs7FtbmWVXerS0yaqitpuSqWVlpcL6/8jD0H/C9mVajqWu3nFwpYqHtFfE/42DnaWl0bTz/5OPt+7u7tra5Y+Yz+Tk56fM6Gek5pG50LGpvOHh72LJ/9XU5lbD/6GnwHpujfDu8mxpntzb45qav7PH41+n6JeXyUZGopyYsWeGyDu2/6LQ44re/1yV41TD/8LC1zix/sS/zdTU4Y+gsd/c5L7z+a6uzE+3+XG89L6+087O1sTD3K2twoGBtWVbgomo4P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAKMALAAAAAATABIAAAjtAEcJFLgDTyE7SVCsAAJgoMNRYTII8fEpkAckOpiEaPhwlARLexxhmpEGzJEmBAJ0HMXhw6MfXeZQsDHADZ8hK13kMTEAwQgEL2oYiaJgJZFDU24cqHCgSgFGFgysBJAJkB8BBQRggQNJxKCVo0rIcMAgEgMHmnBMaADWEyIWLRptEqWETRG2K//ombSmjRZFoaCo4djRyZ0HchIlSECIRNGVXur0WcAlCJoUoOhcAltpyQIxPSRtGQPhjRkMKyN0krLhBCcaKrJoOCO1I48vi0CU6WDIyhNBKcEGyBEDBpUrZOJQugC2ufPnDwMCADs=")}\n${b("folder",18,"gif","R0lGODlhEgASANUAAPv7++/v79u3UsyZNOTk5MHBwaNxC8KPKre3t55sBrqHIpxqBMmWMb2KJbOBG5lnAdu3cbWCHaBuCMuYM///urB+GMWSLad1D8eUL6ampqVzDbeEH6t5E8iVMMCNKMbGxq58FppoAqh2EKx6FP/Ub//4k+vr6///nP/bdf/kf//viba2tv//////mQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAC4ALAAAAAASABIAAAaRQJdwSCwaj8ik0jUYTBidAEA5YFkplANhehxABGAwpKHYRByVwHBibbvbo8+Q0TrZ7/jWBTHEtP6AgX8GK0MWLSWJiostEoVCBy0qk5SVLQmPLh4tKZ2eny0LmQ0tKKanqC0hmQotJK+wsS0PfEIBZxUgHCIaBhIJCw8ZBUMABAUrycrLBQREAAEm0tPUUktKQQA7")}\n${b("folderopen",18,"gif","R0lGODlhEgASANUAAO/v76VzDfv7+8yZNMHBweTk5JpoAqBuCMuYM8mWMZ5sBpxqBPr7/Le3t///pcaaGvDker2KJc+iJqd1D7B+GOKzQ8KPKqJwCrOBG7WCHbeEH9e4QNq/bP/rhJlnAffwiaampuLBUMmgIf3VcKRyDP/XhLqHIqNxC8iVMMbGxqx6FP/kf//bdf/vievr67a2tv/4k8aaGf//nP//mf///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAADUALAAAAAASABIAAAaVwJpwSCwaj8ikUjgYIBIogEA5oFkZDEtheqzKvl9axKTJYCiAIYIGblutqtQwQYPZ73jZpCGM+f+AfiEdJy99M21tMxwxJQeGNTGIeHcyHzEjCpAAki2en54OIhULkAKSMiuqqysOGxIGkDWcMyy2t7YQDx58QqcBwMAkFwcKCwYgBEQFBC/Oz9AEBUUALtbX2FJLSUEAOw==")}\n${b("page",18,"gif","R0lGODlhEgASAOYAAPv7++/v7/j7/+32/8HBweTk5P39/djr/8Df//7///P5/8Ph//T09fn5+YGVw2t0pc7n/15hkFWn7ZOq0nqDsMDA/9nh7YSbyoqo2eTx/5G46pK873N+sPX6//f395Cjy83m/7rd/9jl9m13qGVqmoeh0n+OvI+z5Yyu387T//b6/2dtnvz9/32JtpS/8sbGxv7+/tvn92lwom96rHJ8rnSAsoep3NHp/8nk/7e3t+vr67a2tun1/3V4o+Hw/9vt/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAEEALAAAAAASABIAAAejgEGCg4SFhoeILjaLjDY1AQCHG0AGAA0eDBY1E5CGGjBAoQkCMTUSHwGGJwaiAh0iNbEvhiihAgIDPDwpFRw5hhgsuLk8Pz8HNL+FJSoKuT4+xzczyoQXzjzQxjcgI9WDDrraPzc4OA/fgibZ0eTmCzLpQS0Z7TflCwgr8hT2EOYIQpCQ16OgwYMRCBgqQGCHw4cOCRQwBCCAjosYL3ZCxNFQIAA7")}\n${b("question",18,"gif","R0lGODlhEgASAPelAOP0//7//9bs//n///j//9Ls/8Pn//r//6rB1t3f5crO2N7g5k1livT4+7PW9dXt/+v4/+Xl5LHW9Ov6/+j1/6CyxrfCz9rd5Nzj6un1/Z6ouwcvj8HBzO7+/+3//+Ln7BUuXNHv/6K4y+/9/wEBZvX08snn/19qhufs8fP7/87n/+/t7czr/5q1yk55q97v/3Cfztnu//z//+X6/ypIdMHY7rPc/7fX9cbl/9/h52WHr2yKrd/0/9fw/4KTs9rm75Svzb2+ya690pu92mWJrcT3//H//+Dv/Xym35S216Ouwsvt/3N/mMnZ5gEBcMnq/wEBXs/o/wEBetzw/zdYpTdZpsvP2ClGml2N3b3H0Nzu/2Z2lF1ricrl/93w/97h6JqluktojM/u/+/z9g8pVff4+ebu9q+1xa6/zzdFaIiXr5Wyz0xslrTK4uL//2uIp11rh8Xj/NXn+Oz2/9bf6bG2xAEBePP//1xwkK/K5Nbr/8fp/2OBtG53kai3ykVCYwEBde/6/7O4xabI+fD//+by/x8+jDhZpM/q/6jK58nO19ny/7jV7ZO42NHr/9H4/2ZwimSV6VBxwMDX7Nvf5hYwX5m20sfb6Ieqyk9Yjr/k/cPM2NDp/+/098Tl9yQ9jLfW+Mne8sjU30JklP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAKUALAAAAAASABIAAAjxAEsJHEiwoMEyGMaQWthg0xeDAlGUWKjoz5mFAegY/LBiIalMUK54JCWEoJkIpA6kSDmoAykKgRaqGSiq04A5A5r4AKOEAAAtE2S0USAwSwYIhUb8METiUwAvemLMCMVEoIUjAF5MIYXAThUCDzgVWDQJjkA0cngIEHAHCCAqRqJ0QeQoDxeBFS71KKDCwxonhwiZwPEkzo4+AimJqBFCjBs+UjZ4WmLgxhAQVgb6acGIBShJkbAgMSAhCQ1IBTW8sZRI055HDhoRqXQCYo4tDMJgsqGDTJo6EAlyYFNkVJDgBgXBcJEAucEFeC44n04wIAA7")}\n${b("histo1d",16,"gif","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAADAFBMVEW9vb2np6empqanpqenpqivr6//AAD3+fn09vb19vf3+Pv8+v//+//29/v3+fr19vbZ3Nza3d7X0+Lb3t7b3N3AwMP2+PimpqXe4+Th6uvQ0dTi6uzg5ebFx8nt6vb////r5/T2+fnl4e3a3uDN0NT7/P6lpqX3+vvn9vhcVVHu+//W1uH48//29P///f+mpqelpqb4/v/t/f9oY2H6///59v/x8fXw9fny9/78/v+lpqf7//9iXl12dHPW2t/R1tdtaGbT2dpoZmT6/v9ycnKCgoJpZGJ6dnT3///2///0//95entpa2t+gIKLjI55d3aDgYBvcXL1+/z9/v6lpaWGiIt7fH6Ji42SlJeEhIZubGyMjI17fYD+//+kpKSmpaaRk5WIioyRk5aYmp2OkJJ+f4KTlZilpKWcnqGVl5qcnqCfoaOYmp6PkZOdn6GsrrGoqq6qrK+rrbGpq66lp6uqrbCoqq20tLSsrKzc3NzMzMzPz88AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB6enrU4/9iYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmLU4/9KSkoAAAAAAAAAAAB6enrU4//m5uZiYmLm5uZiYmLm5uZiYmLm5uZiYmLm5ubU4/9KSkoAAAAAAAAAAAB6enrU4/9KSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkrU4/9KSkoAAAAAAAAAAABubm7U4//U4//U4//U4//U4//U4//U4//U4//U4//U4//U4/9KSkoAAAAAAAAAAABubm5KSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABt6dBwBYjWHVG2AAAAB3RSTlP///////8AGksDRgAAAAlwSFlzAAALEgAACxIB0t1+/AAAAOxJREFUeNpjYGBkggBmFmYmRlY2BkZ2DhDg5OLm4eblY2RjYOIXEBQSFhEFkgKCYkxsDOKcEpJS0jKycvJS8gpcIAFFJWUVGFIFCqipa8hrymtpy+sI6crr6bMxGBgayRvLm8iamkmZW1gCBayslWxs7ewd7OwdlZStrYC2ODm7uLrJu3t4usl7mRiwMeh7+/j6+VsHBMr7+wQFhwAFQsPCIyKjomOiIsOiYuPYGOITEpOSU1LTElNTElPlgQLpGZlZ2Tm5eZm5OZm5IAGm/ILCouKS0rKS4oISeaDDypniEICpgo2hsgoZVLMBAHIaNxuoIXy2AAAAAElFTkSuQmCC")}\n${b("histo2d",16,"gif","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAACXBIWXMAAAsSAAALEgHS3X78AAABUUlEQVR42o1R0U7CQBDkU/w/v8qk1/OhCS+88miMiQYMBMNRTqiisQiRhF6h13adsuVKDEYvm81kdmdv9q7V7XallP65I30UrpErLGW73SaiFtDF5dXWmNNITJrubJ4RWUI2qU33GTorAdSJMeMwhOxpEE20noRTYISaajBcMrsdOlkgME+/vILtPw6j+BPg5vZuFRuUgZGX71tc2AjALuYrpWcP/WE1+ADAADMAY/OyFghfpJnlSTCAvLb1YDbJmArC5izwQa0K4g5EdgSbTQKTX8keOC8bgXSWAEbqmbs5BmPF3iyR8I+vdNrhIj3ewzdnlaBeWroCDHBZxWtm9DzaEyU2L8pSCNEI+N76+fVs8rE8fbeRUiWR53kHgWgs6cXbD2OOIScQnji7g7OE2UVZNILflnbrulx/XKfTAfL+OugJgqAShGF4/7/T6/Ug+AYZrx7y3UV8agAAAABJRU5ErkJggg==")}\n${b("histo3d",16,"gif","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAADAFBMVEX////48OjIgTrHfjjKgTr78+yixH9HiQBHiACiw37jvJXfpVP6wzT7zTn7yj3lp1qOhyJzvgCa3wCa3gB2ugBinQ6Pt2D4+vfOjEr96p3986z83mT99rD99a3WhEvC0kaU3gCV3ADG71zo/KORzw1gowBonS3Z5snHfTb6uyD6tzD+/Nb7z0/70D3KdTXI1l3h+qTi+KXD7luU3ACY3gCc4QCi3g1QjwXHfjr710T6xi/+9sn70UH73E/MdDqhvQCi1BKkug2XxACU1wCS2ADD51rr9aJXkw/MpYDgpkb71U7+9MP7007hnEO3niOj0hGq3SCZtQCbtQCjtwj//+7F4Vui0wBDhgDk5eTMxcGxfi3TfTq+fyPPz4ak3xux5TG87kmZuwCZvACWtgDf8a+c0gCy3yNLiwD7/Ps1iwCiyAPF3F7j7bG67EW77kmq5yWYzwCZwwCTugDc8KTE51ve9YZCigCgwgCVuQDa5p7U9YSq4yWT2gCV2wCT2wCp2h/y+9HC6lW87DlChQBGigCixgCYvgDK3nyXvgC72UjG7mSj3xXL7XDK7W7b9J+36TrG9lBDhQBHigClywCbxQDJ33SXvwCYvQCcwADq+8S77Ei460Hd+KDD9VHU/2VEhgBdlR1rowCXwwDK4W6bxgCaxQCVvQDp/L+/8k7F91fn/6zC9V18tiNbkx/U1dSyv6RglihnoQCYwwChyQDs/7/P/2fE92F5tCBdkib19vXW1taoupVLiwNooQCWwADo/7h5tSBFhgaouZXx8vHOz86ftYVJiQBNjQKetIXt7u3Nzs0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBfAAAAAAAAAA2tmA2tmAAACQAAAAAAAAAAAAAAAAAAAAAATgAABNBfMAAAAAAAAA2tpQ2tpQAACQAAAAAAAAAAAAAAAAAAAAAAdQAABNBfMAAAAAAAAA2tsg2tsgAACQAAAAAAAAAAAAAAAAAAAAAAggAABNBfMCaVmCSAAAAAXRSTlMAQObYZgAAAAlwSFlzAAALEgAACxIB0t1+/AAAAQVJREFUeNpjYGBkYmZhZWBj5+BkAAMubh5ePn4BQSFhEVExcaCAhKSUtIysnLyCopKyiqqaOoOGppa2jq6evoGhkbGJqZk5g4WllbWNrZ29g6OTs4urmzuDh6eXt4+vn39AYFBwSGhYOENEZFR0TGxcfEJiUnJKalo6A0NGZlZ2Tm5efkFhUXFJqTnQnrLyisqq6prauvqGxqZmoEBLa1t7R2dXd09vX/+EiUCBSZOnTJ02fcbMWbPnzJ03HyiwYOGixUuWLlu+YuWq1WvWAgXWrd+wcdPmTVu2btu+Y/06kHd27tq9Z+++/QcOHtq1E+JBhsNHjh47fuLIYQYEOHnq1EkwAwCuO1brXBOTOwAAAABJRU5ErkJggg==")}\n${b("graph",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AEFCgohaz8VogAAAT9JREFUOMulkz1LQlEYx39XmrIhcLa5i4mD4JBQrtHieDbb+gx3dbl9hca7tLi4VOsRMkKQVO7LLAQNNdSQgyJPg903tDT8w4HzPDznd56Xc1BKCVsokzTGjhPBXDcQAAEZDgPZCHDQaESH5/PYXyqZxp8A349vGHkjOXo3uXtp035sy79KABi8DQCwshb7x3U6gIYU6KNej+1kEwUEjbQeWtIb9mTsOCIgN1eXgiYd96OdcKNBOoCuQc47pFgoGmHw7skZTK9X16CUku5zV9BIkhz4vgSuG/nsWzvKIhmXAah+VpfJsxnGZMKkUln05NwykqOORq6UWkn+TRokXFEG/Vx/45c3fbrnFKjpRVkZgHKxbAC8NptrAfm9PAD2l42VtdJjDDwv2CSLpSaGMgsFc91hpdRFKtNtf6OxLeAbVYSb7ipFh3AAAAAASUVORK5CYII=")}\n${b("mgraph",16,"gif","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAADAFBMVEW9vb2np6empqanpqenpqivr68AAAD3+fn09vb19vf3+Pv8+v//+//29/v3+fr19vbZ3Nza3d6/wcLb3t7b3N3AwMPi4et2oz0yfwDh3+n2+PimpqXe4+Th6uvD0NHi6uzg5ebFx8nt6vY2ggDs/881gQDr5/T2+fnFz9DDZVrAIhDEZVvJ0tTN0NTX0+IvZAA4hAAuYgDT0N77/P6lpqX3+vvn9vi/JRL81cHBJhTu+//W1uEkXgD48//29P8fWwD//f+mpqelpqb4/v/t/f+yCwDBKBi3CgD6//8kYAD59v/x8fXQ0dTw9fny9/78/v+lpqf7//+wAADV5ezZ5e7g6PQjZQDf4+/W2t/R1tfT2drT3+OvAAD9///6/v/////k4vIiXwC1AAD3///2///X6Oz0//9+rUgzfwAwdADa6u6xCwDAJxb5///1+/z9/v6lpaUwfADo/8vl4e3a3uDb6eu+IxL808C+IhDZ5+nW2tr+//+kpKSmpaaArUgvewB1oj39/v/e5ebVd227HgvJa2H8///6/PylpKXn4+ze4eLg5+j9/v20tLSsrKzc3NzMzMzPz88AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAPAAAAAAEAAAEAAABzL1z/CSMAAAAAAAAAAAAAAAMAAAAmCTsAAAAAAAAAAAAAAAAAAAQAAQEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7op0gAAAAB3RSTlP///////8AGksDRgAAAAlwSFlzAAALEgAACxIB0t1+/AAAAOhJREFUeNpjYGBkggBmFmYmRlY2BkZ2DhDg5OLm4eblY2RjYOIXEBQSFhEVE5cQl5RiYmOQ5pSRlZNXUFRSVlFV4wIJqGtoamnr6OrpGxgaGQMFTEzNzC0sraxtbPXs7B0c2RicnF1c3dw9PL28fXz9/IECAYFBwSGhYeERkVHRMYEBQFti4+ITEuOTklNSg9I8nNgYHOPTMzLjA7Oyc7Jz8/ILQAKFRRnFJaVl5RWVVdU1bAy18XX1DfGNTc0trW3t8UCBjvj4+M746q74+O7qHpAAUzwyADqsl6kGAZj62Bj6JyCDiWwAyPNF46u5fYIAAAAASUVORK5CYII=")}\n${b("tree",16,"gif","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAAAQAAAAEABcxq3DAAACjklEQVQ4y4WTy49LcRzFP+2tzmVUr9dIDJOWGGVBicgEyTQTCzIetUFssDKJSFhY2SARCYvBbGrj8QcIkYglk8xCmEQ9xqNexbQVY2Zub3un9/W7PwstHZH4Jie/7+Kc8/suzgnwr+kjBqSBbm2lkm6bHyH3XM9SZQ8Z8s3UQJPo0IJVof5EZ7v2faxMrKONlhmQWN5GSFEwLbhybjBPhDwVsmQ4AaA09Mou+k8d702EAzXiS6KEgzahoIthGOi6DtKlN71GS+/cEPs0WewaX2R9ZphssP776UhESY0WSpQNg7Jh4Anx+zgJVKpV3uZyvHjzir27NwGs/XVBH8c7N2nnjx7eSqlYxPM8JCCkxBU+rhA4dVhCYJgmyc4Ej96/7rLi8nNAPc/k2ZNp7cnTpziuiy8lvpSI+tvYhS/xpY8vJXMiEbZv3MzFq3cJqaqiPX72jnKt9kfQRPZ9f5qZ70sMawyAas1GseIy1rNtVXK8Mkm1VsP2PBzhYQuB5Qns+t6AJQSqqlIcrTAy+ONGENBWLF3MN71MxXGo1mE6DqbrYLou8z/a7L3uMKvgUnU8xk2T3u71ADGFDdgvCx/3TwkLEfKxhWDHbY+eYZ+Obz6tJcmRApRsuJ8Ex4Po7Jl8/TDBl7flm4Gm5F1vSZKaFQUh4cB9OLgaDB3UVrjwA+6tBnKAis4El8lwujmJSVQeoKAxFzqDcG0KWhZC6R30tUJRQD3Odxqy4G+DDFks4pisY5RLgRx5pZ5T4cKy95yhSrxZDBCaVqIMOpAd2EIeSEW7wLQh3Ar7RtCHbk0v0vQy1WdgCymgf147Sa0dhAOVMZgoALDu2BDZ/xloQAzQgIOhMCnPYQ+gHRvi4d/8n00kYDRVLifLAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDEwLTAyLTExVDE0OjUxOjE3LTA2OjAwHh/NoQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAwNC0wOS0yMFQxNzoxMDoyNi0wNTowMCcJijsAAAAASUVORK5CYII=")}\n${b("branch",16,"gif","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAADAFBMVEX///99plFAfADL27hpmyfP8YxyoilSiRiv0XGGygK02VtRiBmVwjh8xQCcziFZkhLz9+9BfQB2rwaCyACRygFQigXw9Ox0mkpXkQCJzwBblgBmkzP8/fxEgQBCfwBEgQejwITe3t5hkC1CfgBfjynZ2tmSq3eArDu72oNvoDJajyTY2dhFgQDCzLqhvn9EgAazx55XkwCVzC2824GMs1J0oUTY48xajiK72YR9qj2Tq3dhkix+th99xAB3uADA3oQ+fABEgABIgwW82oOUyi5VkgCf0CaEygB+wwCbzjN1mkrA3YZ1tAB7wAB+uB1vl0JdmgCJwwCKzwBoqAB4nVBikiuayzZ8wQCFywCg0Sjd3t1lkjFBfABLgwhKgwlmpgCK0QCJxQBclwDMzMzPz89GggCDpFxDfgCIpmPl5eUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABhAABQEABuZQBjYQBvcgAIZABiYQBlZAAABQDU/wCx/wCO/wBr/wBI/wAl/wAA/wAA3AAAuQAAlgAAcwAAUADU/wCx/wCO/wBr/wBI/wAl/wAA/gAA3AAAuQAAlgAAcwAAUADj/wDH/wCr/wCP/wBz/wBX/wBV/wBJ3AA9uQAxlgAlcwAZUADw/wDi/wDU/wDG/wC4/wCq/wCq/wCS3AB6uQBilgBKcwAyUAD//wD//wD//wD//wD//wD//wD+/gDc3AC5uQCWlgBzcwBQUAD/8AD/4gD/1AD/xgD/uAD/qgD/qgDckgC5egCWYgBzSgBQMgD/4wD/xwD/qwD/jwD/cwD/VwD/VQDcSQC5PQCWMQBzJQBQGQD/1AD/sQD/jgD/awD/SAD/JQD+AADcAAC5AACWAABzAABQAAD/1AD/sQD/jgD/awD/SAD/JQD/AADcAACwULzWAAAAAXRSTlMAQObYZgAAAAlwSFlzAAALEgAACxIB0t1+/AAAALZJREFUeNpjYAADRiZGBmTAzMLKxowswM7BycWNLMDEw8vHL4AkICgkLCIqhiQgLiEpJS0D5cjKySsoKimrqMJk1dQ1NLW0dXQZ9PTlZEECBoZGxiamOmbmmhaWViABaxtbO3sHRycTZxdXA7ANbu4enkxeDt4+vn7WIAH/gMCg4JBQprDwiEhBkEBUtGBMrI5OXHxCYpI/2BrV5OSU5NS09BjB6CiE01JTM5KTVZHcmpycCWEAANfrHJleKislAAAAAElFTkSuQmCC")}\n${b("leaf",16,"gif","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAADAFBMVEX////M27mQs2tilDA9eQA7egBbkhVTjAxJgwWBqVdGgQBrnySdxViu0WrE4oaYv2PC35NtoCqxvaSevX5FgAB7qje73nDK6neu109vpyVupCGo2kJ9xwBQhBtilC9pnx7G63PM6olgnAB/vQBDigCVv0yb1CaDzAB8uBJwmkNnnBnB52ui2Ca94WZopAE/hgCtz2ue2CmDywCByACKujtdjyqdvHpdlhLV9YdkowCFxwCw1lFXmAJvpC5jng1coABlpwBprAB8sitAfABDfgKx31Gr3TuCsi5sqABtqgBUkxTV85zL7I213mef0j+OxyKk00k/ewCp3TCSyhCw0mRRjQC23HmU0h55wQB5vQB4uQB1tgCIwBeJxgCBvQDC3ndCjACYx1204Fx6wwB7vQB1tABzsQBBfQBpkzdtpQB9tQA/iQCMu1SMukNUlQBYmQBsqAd4rh11rwZyrQBvqgBDfwCqvZVWkQBUnACp0Hq/43K733C+4X+w12eZyT2IvSN5sgpZkwBxmUSDqFlbnACJzQy742p/wwB2ugBysgBwrwBvqwBwqQBhmgBCfwDV2NN8pk1foACO1QBZmABRkABpqwB3uQB0sgB0rgBnogBUjgC7w7NymkFdnQBUhxmis41okjdCfgBGgQWHpWPMzMzb3NtumD5NhQzT09Pv8O/a2trOz87l5eXc3NzPz88AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABtHAA4HXQAAEgAAB9CTigAAABCfCQ4HTxy6Kw4HXRy+8xy+8wAAMwAAAAAAAAAAAAAAAAAAAAAAAgAAAgAABgYAAG7AAAAACgAAAgAAAgYAAEAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4Hnw4HnwAAFRpRiYmO2V0aWRtSSY7ZWdsZVNpdGNBO251amRGO3R0bCYmO3J3ZWlvVCY7c2xuaVc7d28ABCwBG8q3AAAAAXRSTlMAQObYZgAAAAlwSFlzAAALEgAACxIB0t1+/AAAAOtJREFUeNpjYIACRiZmFlY2dg4ol5OLm4eXj19AUAjMFRYRFROXkJSSlpEF8+XkFRSVlFVU1dQ1NMF8LW0dXT19A0MjYxNTIN/M3MLSytrG1s7ewdHJGSjg4urm7uHp5e3j6+cfABIIDAoOCVUJC4+IjIqOAQk4x8bFJyQmJadEpaalpQMFMjKzsnNy8/ILCouKS0qBAmXlFZVV1TW1dfUNJY1NQIHmlta29o7ozq7unt6+fgaGCRMnTZ4ydVrU9BkzZ5XOBiqYM3HuvPkL0tPTFy5avATkzqXLlq9YuWoJEKxeA/Ho2nUMyAAA9OtDOfv2TiUAAAAASUVORK5CYII=")}\n${b("leaf_method",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAKlBMVEUAAAAAgADzExMAgIAAAADAwMCAgADxGRnuFxLnHhHuIyPKJQ/rLi7////aW8ZOAAAAAXRSTlMAQObYZgAAAAFiS0dEDfa0YfUAAAAHdElNRQfgCxIPFR/msbP7AAAAaUlEQVQI12NggANBBiYFMMNQxAjCYA4UUoZIBRpBGMyiQorGIIaxWRCEwSYo3igiCNJlaLkwGSwkJn1QGMhgNDQ0TDU2dACqERYTDksGG5SkmGoApBnFhBRTBUAiaYJpDIJgs10cGBgdACxbDamu76Z5AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE3LTAxLTE3VDA5OjMwOjM1KzAxOjAwyGHxKQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNi0xMS0xOFQxNToyMTozMSswMTowMJgvuUkAAAAASUVORK5CYII=")}\n${b("globe",18,"gif","R0lGODlhEwASAPcAAPr7/AFyAQFCpwGD6jy3/wE9on7N0AE+pAFjyMLI0AE2mwF94wGP9QFpzgU3nISSopWgrmJsfTNLfgFHqAFuBilNiTp4sLnGzwWb/0xYb/P09mRygGl0hRlnMgR12V2Pr6e4xF9peS2Cyh5FpBdSfgF84YmisdPa30hjvw+foQFYvlWj4HWIlkWb5gk5n/b4+gw+kgFMscXb6ylmieDj5ju2pylTsniElgqd/u/x8wGW/O7v8SVMsUq+JSSJXQFiwfv+/AFqvB9ntobZeKbc/9vt+B+YmW2rvKruzQGPkm3PPrjmxQFIklrFLVbD4QGMYaXkoIPD13LC+nGw5AGFQHG66gF2eBaJxket9sLf84HI+wF7axBdbg2c0CR+1QFsEIfJ7yqoUIbH41tldgF+KzVTjn3QfitZgTJZkaDR8gKDsXeWrE+zogE3nCeKzQFtJ0tknjdnbQGB6EJgxQFqAcLJ0WC//yKm/wE+o7vI0ARozEOz/4/g/4KToyaX4/D09pCpuNHV24HA6gw7oAF/AXWKnEVSb5TI6VzDTrPprxBQts7e6FNdcBA9oySd9RRjPAhnD2NvgIydrF+6wdLo9v7//2K+twKSdDmKyeD56wGCyHq12VnF+ZXXsARdTjZWthShoo7gtilDlAFw1RCXvF+z6p/R8kqZzAF0Oj5jjFuJqgFoAkRgxtzr9YmcrJKsugFlylfBgxJGhjJIeFnFuhmi/+bo65ipt8Hn+UhVco7B5SZowAGBKoaZqAGGAVHBUwF8Qq7Y819qe4DEoVyYwrnb8QGN9GCy6QFTuHB9jgGY/gFRtuTu9ZOhr150iwFbwTFiwFus4h9mYt/y+kWZ35vM7hGfccz43Xy/6m3BuS1GiYveqDRfwnbUV4rdu////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAN8ALAAAAAATABIAAAj/AL8JHEiwVTVspar8ITiwiJhswyaBibJJUq9Trxh+S2OAVihvSzqRcoTpmy5ADIPFqrHtGpBETbrIuXJEBgiGbHoogTItExJOoAbw8rHmAkFTC8KYwTWkGx8COp4AozAjD8Epo4wQQfTLCQEcxqigoiONBUFqerRYspYCgzIGmgi98cRlA8EVLaR4UJPk0oASVgKs6kAiBMFDdrzAarDFF5kgCJA9ilNBGMFjWAQse/YjwBcVMfCcgTMr2UBKe0QIaHNgAiQmBRS4+CSKEYSBWe44E6JoEAxZDhrxmDPCEAcaA4vVinTCwi5uKFhBs6EtQ4QEOQYy8+NGUDRiqdCUJJGQa8yNQDsADHyxSNUHE4Vc3erzoFkdWxoAVNLIv7///98EBAA7")}\n${b("canvas",16,"gif","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAADAFBMVEX/AAC1t7etsLCsrq6rrq6rrq2tr6+0tratsK/////p6enIysrl5OTn5uXo5+ajpaXo5+dhhKdliKlmialgg6elp6f6+/vIycnr7Ozw7u7x7u7x7u3t6+vLzMvp7vbs7/bz8PD17+3z7u2rrq/6xS76xy13zv9+z/+EwLF4zP/38/NfgqWAoL36uCj6vCmR2f+TxamSrBmNvoj++fz8+Pf69/WZ3f+g4P+n4/+Cnw2Dox16nQ3//f9hg6eBob6x5/+46f+77P+p2NKSZhOi1s////7//fusrq98sB6CsyWDtSmFuC9+dBl/tilfgqasr6+sr7DbAADcAABcgqWAoLyusLC4urqssLCssLGrsLCrr7Ctr67c3NzMzMwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABoAAAKAgJldmV0dU8GB3JvTnZDBWVyb2xsYwdjYWxhUBB0bmVrY2F1b3IICGRPYmFyZWQAAAXj1P/Hsf+rjv+Pa/9zSP9XJf9VAP9JANw9ALkxAJYlAHMZAFDU1P+xsf+Ojv9ra/9ISP8lJf8AAP4AANwAALkAAJYAAHMAAFDU4/+xx/+Oq/9rj/9Ic/8lV/8AVf8ASdwAPbkAMZYAJXMAGVDU8P+x4v+O1P9rxv9IuP8lqv8Aqv8AktwAerkAYpYASnMAMlDU//+x//+O//9r//9I//8l//8A/v4A3NwAubkAlpYAc3MAUFDU//Cx/+KO/9Rr/8ZI/7gl/6oA/6oA3JIAuXoAlmIAc0oAUDLU/+Ox/8eO/6tr/49I/3Ml/1cA/1UA3EkAuT0AljEAcyUAUBnU/9Sx/7GO/45r/2tI/0gl/yUA/gAA3AAAuQAAlgAAcwAAUADj/9TH/7Gr/46P/2tz/0hX/yVV/wBJ3AAQ+AFLAAAAAXRSTlMAQObYZgAAAAlwSFlzAAALEgAACxIB0t1+/AAAALpJREFUeNpjYGBkYmZhYWFlYWNngAAOTijg4oYIMHPy8PLx8nDycwpwQwUEhYSFRDhFxTi5xCECEpJS0jKcsqL8nGwgARZOOXkFRSWwMcwgAWVOFVU1dQ1NLW0dmICunr6BoZGxiSlEgJnTzNzC0sraxtYOJmDv4Ojk7MLp6gYRcOf08PTy9vHl9IOa4c+JAGCBAM7AoEDOwEDO4BCIABOSilCQQBhTeERkVGS4f3R0aBhIICYWAWIYGAClIBsa7hXG7gAAAABJRU5ErkJggg==")}\n${b("profile",16,"gif","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAACXBIWXMAAAsSAAALEgHS3X78AAABZElEQVR42o1R22rCQBD1U/p//apCNtsHwRdfBaFIKbRoUVKMMTWBWIxVCq2b+07POrn4UKjDMpw9O2fm7G5vNBpJKe2/Qto4uEc2WMrBYEBEPaAky36UulwnlSRpUeZEBSGrpEiyHJVGAPVJqZvbO3ftv83Dle+vvPV4/LD0PGYAcKrSFJUsEOgHKoj3s9dFGH9uou3k8ekQKxyDQcYpBnYC7Hm9zBZmlL8BiIJDC0AWpa4FwhZJXoDCBgYAjgU5ToBt+k1tL14ssFNNvIEBAFwVljJlSDBfpwyg1ISnYoEsiHju5XLcd+T50q0tEQm7eaWKKNfUWgKApUsbPFY0lzY6DraEZm585Do/CLMzqLQWQnSC9k34lVa7PTsBs/zYOa4LB5ZlnQXCbif40Ra50jUwE6JtCcMlUiMQlugEQYisG8CWtGlRdQL+jmui/rjhcAhk/Reo6ff7RuB53vN1MZ1OIfgFQC1cuR3Y6lIAAAAASUVORK5CYII=")}\n${b("execute",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAABlBMVEXAwMAAxwCvbOAvAAAAAXRSTlMAQObYZgAAAAlwSFlzAAALEgAACxIB0t1+/AAAACBJREFUCFtjYIABHgYGfiA6wMD/gYH/B5g8ABLhYUAGAHniBNrUPuoHAAAAAElFTkSuQmCC")}\n${b("file",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQEAYAAABPYyMiAAAABmJLR0T///////8JWPfcAAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAAAQAAAAEABcxq3DAAAA2klEQVRIx61VURbDIAgTX+9ljg4n2z5sNouj1ml+LE9rQkSU5PA6kTZBToTznj5aqKqq+py4lFJKScnMzCwlAAB6IbnNuyXycd1g3oHrf32CmR9mZqpVOdDHs2DmI+c+AiJixu1RAN9xFUcdWCjVIr8xCX8Jubc8Ao9CJF8nRFgNJBxZSCEkjmrIxxSS0yIAoBU4OkpfU8sCPEbEvqaOXcR31zWORbYJ8EI8rsK+DWm7gMVb8F/GK7eg6818jNjJZjMn0agY7x6oxqL5sWbIbhLHoQN78PQ5F3kDgX8u9tphBfoAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMDItMDZUMTA6Mjc6MzErMDE6MDChLu/mAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTExLTEyVDA4OjM5OjIwKzAxOjAwIGvf8wAAAABJRU5ErkJggg==")}\n${b("text",16,"gif","R0lGODlhEgASALMAAP/////MzP+Zmf9mZv8zM/8AAMzM/8zMzJmZ/5mZmWZm/2ZmZjMz/zMzMwAA/////yH5BAUUAA8ALAAAAAASABIAAARo8MlJq73SKGSwdSDjUQoIjhNYOujDnGAnFXRBZKoBIpMw1ICHaaigBAq/AUK1CVEIhcfPNFlRbAEBEvWr0VDYQLYgkCQWh8XiAfgRymPyoTFRa2uPO009maP8ZmsjAHxnBygLDQ1zihEAOw==")}\n${b("task",18,"png","iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAAAAACMfPpKAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAABIAAAASABGyWs+AAAATklEQVQY05XQUQoAIAgD0N3JY3fIChWttKR9xYvBCj0J0FsI3VVKQflwV22J0oyo3LOCc6pHW4dqi56v2CebbpMLtcmr+uTizz6UYpBnADSS8gvhaL5WAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE2LTA0LTA3VDA5OjQyOjQ4KzAyOjAwMgzRmQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMlQwODozOToxOCswMTowMJ0LlncAAAAASUVORK5CYII=")}\n${b("pavetext",18,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAAsSURBVBjTY2CgCuBAAt1gASS5KKgARBpJACSEooIsARRbkABYoDsKCRDhEQBA2Am/6OrPewAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNi0wMS0wNFQxMDoxODoyNyswMTowMHsz6UQAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MjArMDE6MDAga9/zAAAAAElFTkSuQmCC")}\n${b("pavelabel",18,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJ0Uk5TAAB2k804AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAApSURBVBjTY2CgCuBAAt1gASS5KJgABzUEgABFANUWJAAWYIhCAkR4BAAHoAkEyi2U3wAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNi0wMS0wNFQxMDoxODoyNyswMTowMHsz6UQAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTJUMDg6Mzk6MjArMDE6MDAga9/zAAAAAElFTkSuQmCC")}\n${b("list",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AEECTc01vBgywAAAE9JREFUOMu1k8ERwDAMwqRc9l/Z/eeRpKZlABkOLFD0JQGgAAah5kp8Y30F2HEwDhGTCG6tX5yqtAV/acEdwHQHl0Y8RbA7pLIxRPziGyM9xLEOKSpp/5AAAAAASUVORK5CYII=")}\n${b("color",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAM1BMVEUAAAAA4xcavGZGS1xZT79lW+9wdvFz/3N6fo3RISTZwXbyniXz80v/AAD/zAD/66v//6vGWiYeAAAAAXRSTlMAQObYZgAAAAFiS0dEAIgFHUgAAAAJcEhZcwAADswAAA7MAbGhBn4AAAAHdElNRQfgAQQLLBhOmhPcAAAAIklEQVQY02NgRgEMDAzMnLzcfDwC7IxMbKwsQ10A3XMEAQA3JQVNowlkTAAAAABJRU5ErkJggg==")}\n${b("colz",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAMFBMVEV6fo0A4xcavGZGS1xZT79lW+9wdvFz/3PRISTZwXbyniXz80v/AAD/zAD/66v//6t1AkcGAAAAAXRSTlMAQObYZgAAAAFiS0dEAIgFHUgAAAAJcEhZcwAADswAAA7MAbGhBn4AAAAHdElNRQfgAQQLNwdqpNWzAAAAT0lEQVQI12NgYGAwNjZmAAOLjmY0hs2ZwxCG1arFEIbt3csQhvXuzRCG/f/PEIZ5eTGEYSgoDGEYKSlDGGZpyRCGaWgwhGHi4gxhwG0HAwCr3BFWzqCkcAAAAABJRU5ErkJggg==")}\n${b("frame",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfgAQQLOwq4oOYCAAAAcUlEQVQoz7WQMQqAMAxFX0Uk4OLgIbp4oZ7BA/cOXR0KDnGpRbGayT+EQF74nw+GHIBo+5hdWdqAaFDoLIsegCSeWE0VcMxXYM6xvmiZSYDTooSR4WlxzzBZwGYBuwWs4mWUpVHJe1H9F1J7yC4ov+kAkTYXFCNzDrEAAAAASUVORK5CYII=")}\n${b("class",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QAvQC9AL1pQtWoAAAAjUlEQVR42p2T2wnAIAxFM0g/O6jDdBBHcAyHKKQYjfiI0UY4P8I9BG4CID8smB4+8SUsohpO3CFzKqmBFrhCO4kqQnCR6MJF4BEJTVQFhBAmASNIZkH6a0OMc8oUDAu8z7RhTTBVyIIEhxeCdYWjQApvK2TBrgGpwpP1livsBXC0ROMO/LqDKjKEzaf8AZWbJP6pTT9BAAAATHpUWHRTb2Z0d2FyZQAAeNpz0FDW9MxNTE/1TUzPTM5WMNEz0jNQsLTUNzDWNzBUSC7KLC6pdMitLC7JTNZLLdZLKS3IzyvRS87PBQDzvxJ8u4pLSgAAADN6VFh0U2lnbmF0dXJlAAB42ktKs0hLMkk2MzJKNEuzMLKwtEizSElMMbNITUw0NUtNAQCc7Qma0Goe1QAAAABJRU5ErkJggg==")}\n${b("member",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QAvQC9AL1pQtWoAAAAX0lEQVR42mNgAAIVBob/+DADPgBS8GCPBV6M1xCKDcDnBRcoZhgW4D8DBV75v2bLATAmxyC4ZmRMrCFYNfeU9BBvwJwpS8AYWTNZBoAwTDPFBpAciDCDyNFMtXSAFwAAUyq0GRPbbz4AAABMelRYdFNvZnR3YXJlAAB42nPQUNb0zE1MT/VNTM9MzlYw0TPSM1CwtNQ3MNY3MFRILsosLql0yK0sLslM1kst1kspLcjPK9FLzs8FAPO/Eny7iktKAAAAM3pUWHRTaWduYXR1cmUAAHjaS01JNrE0S00zSbU0NEsxMbMwM0xOSjYwNzY3NLRIMjUCAJcdCJ2BHe6SAAAAAElFTkSuQmCC")}\n${b("tf1",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAgMAAABinRfyAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAADFBMVEX/////AP8/SMz///+Cf5VqAAAAAXRSTlMAQObYZgAAAAFiS0dEAIgFHUgAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAHdElNRQfgCw4QHgSCla+2AAAAL0lEQVQI12MQYAACrAQXiFBoABINCgwMQgwcDAwSDEwMDKmhodMYJjAwaKDrAAEAoRAEjHDJ/uQAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTYtMTEtMTRUMTc6Mjk6MjErMDE6MDDxcSccAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE2LTExLTE0VDE3OjI5OjA1KzAxOjAwNka8zgAAAABJRU5ErkJggg==")}\n${b("tf2",16,"png","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAgMAAABinRfyAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAADFBMVEX/////AP8A/wD////pL6WoAAAAAXRSTlMAQObYZgAAAAFiS0dEAIgFHUgAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAHdElNRQfgCw4PNgzGaW1jAAAARUlEQVQI12NgEGDQZAASKkBigQKQ6GhgYBDiYgASIiAigIGBS8iBgUFhEpCnoAEkUkNDQxkagUIMrUDMMAVETAARQI0MAD5GCJ7tAr1aAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE2LTExLTE0VDE2OjUxOjUzKzAxOjAwi1Gz3gAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNi0xMS0xNFQxNjo1MTozNiswMTowMG5bLUIAAAAASUVORK5CYII=")}\n`,G,"jsroot_hstyle")}(P.node());const T=b,z=[];let W=null;if(b.forEachItem(Me=>{delete Me._d3cont,"_fastcmd"in Me&&"Command"===Me._kind&&z.push(Me),"_status"in Me&&!W&&(W=Me)}),!b.h||P.empty())return b;if(z.length){const Me=P.append("div").attr("style","display: inline; vertical-align: middle; white-space: nowrap;");for(let je=0;je<z.length;++je){const Ge=Me.append("button").text("").attr("class","jsroot_fastcmd_btn").attr("item",b.itemFullName(z[je])).attr("title",z[je]._title).on("click",function(){T.executeCommand((0,L.Lt)(this).attr("item"),this)});z[je]._icon&&Ge.style("background-image",`url('${z[je]._icon}')`)}}const fe=P.append("p").attr("class","jsroot").style("margin-bottom","3px").style("margin-top",0);fe.append("a").attr("class","h_button").text("expand all").attr("title","expand all items in the browser").on("click",()=>b.toggleOpenState(!0)),fe.append("text").text(" | "),fe.append("a").attr("class","h_button").text("collapse all").attr("title","collapse all items in the browser").on("click",()=>b.toggleOpenState(!1)),(0,x.isFunc)(b.removeInspector)&&(fe.append("text").text(" | "),fe.append("a").attr("class","h_button").text("remove").attr("title","remove inspector").on("click",()=>b.removeInspector())),"_online"in b.h&&(fe.append("text").text(" | "),fe.append("a").attr("class","h_button").text("reload").attr("title","reload object list from the server").on("click",()=>b.reload())),"disp_kind"in b&&(fe.append("text").text(" | "),fe.append("a").attr("class","h_button").text("clear").attr("title","clear all drawn objects").on("click",()=>b.clearHierarchy(!1)));const we=P.append("div").attr("class","jsroot").style("font-size",b.with_icons?"12px":"15px").style("flex","1");if(b.show_overflow||we.style("overflow","auto"),b.background&&we.style("background-color",b.background).style("margin","2px").style("padding","2px"),b.textcolor&&we.style("color",b.textcolor),b.addItemHtml(b.h,we.append("div").attr("class","h_tree")),b.setTopPainter(),W&&!b.status_disabled&&!(0,x.decodeUrl)().has("nostatus")){const Me=(0,x.findFunction)(W._status);if((0,x.isFunc)(Me))return b.createStatusLine().then(je=>{je&&Me(je,b.itemFullName(W))})}return b})()}updateTreeNode(b,P){if(void 0===P||P.empty()){P=(0,L.Lt)(b._d3cont?b._d3cont:null);const T=this.itemFullName(b);if(P.empty()&&(P=this.selectDom().select(`[item='${T}']`)),P.empty()&&"_cycle"in b&&(P=this.selectDom().select(`[item='${T};${b._cycle}']`)),P.empty())return}this.addItemHtml(b,P,"update"),this.brlayout?.adjustBrowserSize(!0)}updateBackground(b,P){if(!b||!b._d3cont)return;const T=(0,L.Lt)(b._d3cont);if(T.empty())return;const z=T.select(".h_item");z.style("background",b._background?b._background:null),P&&b._background&&z.node().scrollIntoView(!1)}focusOnItem(b){var P=this;return(0,Ee.A)(function*(){(0,x.isStr)(b)&&(b=P.findItem(b));const T=b?P.itemFullName(b):"";if(!T)return!1;let z=b,W=!1;for(;z;)void 0!==z._childs&&!z._isopen&&(z._isopen=!0,W=!0),z=z._parent;return(W?P.refreshHtml():Promise.resolve(!0)).then(()=>{const we=P.selectDom().select(`[item='${T}']`);return!we.empty()&&(we.node().scrollIntoView(),!0)})})()}tree_click(b,P,T){if(!P)return;const z=(0,L.Lt)(P.parentNode.parentNode),W=z.attr("item"),fe=W?this.findItem(W):null;if(!fe)return;if(fe._break_point){delete fe._break_point,this.addItemHtml(fe,z,"update");const bt=fe._parent,te=bt._childs.indexOf(fe),Je=(0,L.Lt)(z.node().parentNode);if(te<0)return console.error("internal error");bt._show_limit=2*(bt._show_limit||x.settings.HierarchyLimit);for(let tt=te+1;tt<bt._childs.length;++tt){const Fe=bt._childs[tt];if(Fe._parent=bt,!this.addItemHtml(Fe,Je,tt))break}return}let Me,we=fe;for(;we&&void 0===(Me=we._click_action);)we=we._parent;T||(T="item");const Ge=(0,Re.iO)(fe._kind,fe._kind===x.prROOT+x.clTKey&&fe._more?"noinspect":""),lt=Ge.handle;if("icon"===T){let bt=null;return(0,x.isFunc)(fe._icon_click)?bt=fe._icon_click:(0,x.isFunc)(lt?.icon_click)&&(bt=lt.icon_click),void(bt&&bt(fe,this)&&this.updateTreeNode(fe,z))}if("item"===T&&"_expand"in fe&&!b.ctrlKey&&!b.shiftKey&&(T="plusminus"),"plusminus"===T&&!("_childs"in fe)&&fe._more||"item"===T&&"expand"===Me)return this.expandItem(W,z);if("item"===T){if(fe._player)return this.player(W);if(lt?.aslink)return window.open(W+"/");if(lt?.execute)return this.executeCommand(W,P.parentNode);if(lt?.ignore_online&&this.isOnlineItem(fe))return;const bt="expand"===this.default_by_click;let te=fe._can_draw,Je=fe._more,tt="";if(b.shiftKey&&(tt=lt?.shift||x.kInspect,(0,x.isStr)(tt)&&0===tt.indexOf(x.kInspect)&&lt?.noinspect&&(tt="")),b.ctrlKey&&lt?.ctrl&&(tt=lt.ctrl),!tt&&!lt?.always_draw)for(let Fe=fe._parent;Fe;Fe=Fe._parent)if(Fe._painter){te=!1,void 0===Je&&(Je=!1);break}if(fe._childs&&(Je=!1),void 0===te&&(te=Ge.draw),void 0===Je&&(Je=Ge.expand||Ge.get_expand),te&&Je&&!tt&&(bt||"expand"===lt?.dflt||lt?.exapnd_after_draw&&this.isItemDisplayed(W))&&(te=!1),te&&!tt&&(tt="__default_draw_option__"),te)return this.display(W,tt,!0);if(Je||bt)return this.expandItem(W,z);if((0,x.isStr)(fe._kind)&&0===fe._kind.indexOf(x.prROOT)&&Ge.inspect&&!1!==te)return this.display(W,x.kInspect,!0);if(!fe._childs||fe===this.h)return}fe._isopen?delete fe._isopen:fe._isopen=!0,this.updateTreeNode(fe,z)}tree_mouseover(b,P){const T=(0,L.Lt)(P.parentNode.parentNode).attr("item"),z=this.findItem(T);if(!z)return;let W,fe=z;for(;fe&&!W;)W=fe._painter,fe=fe._parent;(0,x.isFunc)(W?.mouseOverHierarchy)&&W.mouseOverHierarchy(b,T,z)}direct_contextmenu(b,P){b.preventDefault();const T=(0,L.Lt)(P.parentNode.parentNode).attr("item"),z=this.findItem(T);z&&(0,x.isFunc)(this.fill_context)&&(0,Ze.ES)(b,this).then(W=>{this.fill_context(W,z),W.size()>0&&(W.tree_node=P.parentNode,W.show())})}fillSettingsMenu(b,P){b.addSettingsMenu(!0,P,T=>{"refresh"===T?(this.forEachRootFile(z=>B(z,z._file.fKeys,z._file,"")),this.refreshHtml()):"dark"===T?this.changeDarkMode():"width"===T&&this.brlayout?.adjustSeparators(x.settings.BrowserWidth,null)})}changeDarkMode(){this.textcolor&&(this.setBasicColors(),this.refreshHtml()),this.brlayout?.createStyle(),this.createButtons(),(0,x.isFunc)(this.disp?.changeDarkMode)&&this.disp.changeDarkMode(),this.disp?.forEachFrame(b=>{let P=(0,Ye.m6)(b);P||(P=(0,Ye.Nn)(b)),(0,x.isFunc)(P?.changeDarkMode)&&P!==this&&P.changeDarkMode()})}toggleDarkMode(){x.settings.DarkMode=!x.settings.DarkMode,this.changeDarkMode()}tree_contextmenu(b,P){b.preventDefault();const T=(0,L.Lt)(P.parentNode.parentNode).attr("item"),z=this.findItem(T);if(!z)return;const W=this.getOnlineProp(T),fe=this.getFileProp(T);return(0,Ze.ES)(b,this).then(Me=>{if(T&&z._parent||"_jsonfile"in z)if(W)this.fillOnlineMenu(Me,W,T);else{const je=(0,Re.iO)(z._kind,"nosame");if(z._can_draw&&(je.opts||(je.opts=[""]),je.opts.indexOf("")<0&&je.opts.unshift("")),je.opts){Me.addDrawMenu("Draw",je.opts,lt=>this.display(T,lt),"Draw item in the new frame");const Ge=this.disp?.getActiveFrame();!je.noappend&&Ge&&((0,Ye.m6)(Ge)||(0,Ye.Nn)(Ge))&&Me.addDrawMenu("Superimpose",je.opts,lt=>this.dropItem(T,Ge,lt),"Superimpose item with drawing on active frame")}if(fe&&je.opts&&!fe.localfile){let Ge=function we(Me){const Ge=document.createElement("div");return Ge.innerHTML=`<a href="${lt=Me,lt.split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;")}">x</a>`,Ge.firstChild.href;var lt}(fe.fileurl);if(0===Ge.indexOf(x.source_dir)&&(Ge=Ge.slice(x.source_dir.length)),Ge=`${fe.kind}=${Ge}`,fe.itemname){let bt=fe.itemname;bt.search(/\+| |,/)>=0&&(bt=`'${bt}'`),Ge+=`&item=${bt}`}let lt="nobrowser";x.settings.WithCredentials&&(lt+="&with_credentials"),Me.addDrawMenu("Draw in new tab",je.opts,bt=>window.open(`${x.source_dir}?${lt}&${Ge}&opt=${bt}`),"Draw item in the new browser tab or window")}(je.expand||je.get_expand)&&(z._more||void 0===z._more)&&(void 0===z._childs?Me.add("Expand",()=>this.expandItem(T),"Exapnd content of object"):Me.add("Unexpand",()=>{z._more=!0,delete z._childs,delete z._isopen,z.expand_item&&delete z._expand,this.updateTreeNode(z)},"Remove all childs from hierarchy")),z._kind===x.prROOT+x.clTStyle&&Me.add("Apply",()=>this.applyStyle(T))}else{let je="",Ge=0;const lt=[],bt=()=>Ge++>0?"&":"?";this.forEachRootFile(tt=>lt.push(tt._file.fFullURL)),this.getTopOnlineItem()||(je=x.source_dir+"index.htm"),this.isMonitoring()&&(je+=bt()+"monitoring="+this.getMonitoringInterval()),1===lt.length?je+=`${bt()}file=${lt[0]}`:lt.length>1&&(je+=`${bt()}files=${JSON.stringify(lt)}`),this.disp_kind&&(je+=bt()+"layout="+this.disp_kind.replace(/ /g,""));const te=[],Je=[];this.disp?.forEachFrame(tt=>{const Fe=new Ye.JW(tt);let St,Ne=Fe.getTopPainter(),rt=Ne?Ne.getItemName():null;rt?St=Ne.getDrawOpt()||Ne.getItemDrawOpt():(Ne=null,Fe.forEachPainter(pt=>{const st=pt.getItemName();if(!st)return;let vt=pt.getDrawOpt()||pt.getItemDrawOpt()||"";Ne?Ne.getPadPainter()===pt.getPadPainter()&&(0===vt.indexOf("same ")&&(vt=vt.slice(5)),rt+="+"+st,St+="+"+vt):(Ne=pt,rt=st,St=vt)})),rt&&(te.push(rt),Je.push(St||""))}),1===te.length?je+=bt()+"item="+te[0]+bt()+"opt="+Je[0]:te.length>1&&(je+=bt()+"items="+JSON.stringify(te)+bt()+"opts="+JSON.stringify(Je)),Me.add("Direct link",()=>window.open(je)),Me.add("Only items",()=>window.open(je+"&nobrowser")),this.fillSettingsMenu(Me)}(0,x.isFunc)(z._menu)&&z._menu(Me,z,this),Me.size()>0&&(Me.tree_node=P.parentNode,Me.separ&&Me.add("separator"),Me.add("Close"),Me.show())}),!1}player(b,P){var T=this;return(0,Ee.A)(function*(){const z=T.findItem(b);if(!z||!z._player||!(0,x.isStr)(z._player))return null;let W=null;if(z._module){const fe=yield T.importModule(z._module);W=fe?fe[z._player]:null}else(z._prereq||z._player.indexOf("JSROOT.")>=0)&&(yield T.loadScripts("",z._prereq)),W=(0,x.findFunction)(z._player);return(0,x.isFunc)(W)?(yield T.createDisplay(),W(T,b,P)):null})()}canDisplay(b,P){if(!b)return!1;if(b._player)return!0;if(void 0!==b._can_draw)return b._can_draw;if((0,x.isStr)(P)&&0===P.indexOf(x.kInspect))return!0;const T=(0,Re.hd)(b._kind,P);return(0,Re.Xv)(T)}isItemDisplayed(b){const P=this.getDisplay();return!!P&&null!==P.findFrame(b)}display(b,P,T){var z=this;return(0,Ee.A)(function*(){const W=b;let we=null,Me=!1,je=null,Ge=b;const lt=P?.indexOf("::_display_on_frame_::")??-1;lt>=0&&(Ge=P.slice(lt+22),P=P.slice(0,lt));const bt=(te,Je)=>(Je&&console.log("When display ",b,"got",Je),Me&&je&&delete je._doing_update,Me||(0,Ve.Rh)(),(0,x.isFunc)(te?.setItemName)&&(te.setItemName(W,Me?null:P,z),je&&!je._painter&&(je._painter=te)),te||we);return z.createDisplay().then(te=>{if(!te)return bt();if(je=z.findItem(W),je&&"_player"in je)return z.player(W,P).then(Fe=>bt(Fe));if(Me=(0,x.isStr)(P)&&0===P.indexOf("update:"),Me){if(P=P.slice(7),!je||je._doing_update)return bt();je._doing_update=!0}if(je&&!z.canDisplay(je,P))return bt();let Je="",tt=!1;if((0,x.isStr)(P)&&P.indexOf("divid:")>=0){const Fe=P.indexOf("divid:");Je=P.slice(Fe+6),P=P.slice(0,Fe)}return"__default_draw_option__"===P&&(tt=!0,P=""),Me||(0,Ve.Rh)(`Loading ${W} ...`),z.getObject(W,P).then(Fe=>{Me||(0,Ve.Rh)(),je||(je=Fe.item);let Ne=Fe.obj;if(!Ne)return bt();Me||(0,Ve.Rh)(`Drawing ${W} ...`);let rt=Ne._typename?(0,Re.hd)(x.prROOT+Ne._typename):null;if(rt?.draw_field&&Ne[rt.draw_field]&&(Ne=Ne[rt.draw_field],P||(P=rt.draw_field_opt||""),rt=Ne._typename?(0,Re.hd)(x.prROOT+Ne._typename):null),tt&&!P&&rt?.dflt&&"expand"!==rt.dflt&&(P=rt.dflt),Je)return(Me?Re.AI:Re.$2)(Je,Ne,P).then(vt=>bt(vt)).catch(vt=>bt(null,vt));let St=!1;if(te.forEachPainter((st,vt)=>{if(st.getItemName()!==W)return;const Yt=st.getItemDrawOpt();tt&&T&&(P=Yt),(Me||!P||Yt===P)&&(T&&!St&&(St=!0,te.activateFrame(vt)),(0,x.isFunc)(st.redrawObject)&&st.redrawObject(Ne,P)&&(we=st))}),we)return bt();if(Me)return console.warn(`something went wrong - did not found painter when doing update of ${W}`),bt();const pt=te.findFrame(Ge,!0);return(0,Ye.tP)(pt),te.activateFrame(pt),(0,Re.$2)(pt,Ne,P).then(st=>bt(st)).catch(st=>bt(null,st))})})})()}enableDrag(b){b.attr("draggable","true").on("dragstart",function(P){const T=this.parentNode.parentNode.getAttribute("item");P.dataTransfer.setData("item",T)})}enableDrop(b){const P=this;(0,L.Lt)(b).on("dragover",function(T){const z=T.dataTransfer.getData("item"),W=P.findItem(z);(0,x.isStr)(W?._kind)&&0===W._kind.indexOf(x.prROOT)&&T.preventDefault()}).on("dragenter",function(){(0,L.Lt)(this).classed("jsroot_drag_area",!0)}).on("dragleave",function(){(0,L.Lt)(this).classed("jsroot_drag_area",!1)}).on("drop",function(T){(0,L.Lt)(this).classed("jsroot_drag_area",!1);const z=T.dataTransfer.getData("item");z&&P.dropItem(z,this)})}clearDrop(b){(0,L.Lt)(b).on("dragover",null).on("dragenter",null).on("dragleave",null).on("drop",null)}dropItem(b,P,T){var z=this;return(0,Ee.A)(function*(){(!T||!(0,x.isStr)(T))&&(T="");const W=(fe,we)=>(!we&&(0,x.isFunc)(fe?.setItemName)&&fe.setItemName(b,null,z),fe);if("$legend"===b){const fe=(0,Ye.m6)(P);return(0,x.isFunc)(fe?.buildLegend)?fe.buildLegend(0,0,0,0,"",T).then(we=>W(we)):(console.error("Not possible to build legend"),W(null))}return z.getObject(b).then(fe=>{if(!fe.obj)return null;const we=(0,Ye.Nn)(P);return(0,x.isFunc)(we?.performDrop)?we.performDrop(fe.obj,b,fe.item,T).then(Me=>W(Me,we===Me)):we?.accept_drops?(0,Re.$2)(P,fe.obj,"same "+T).then(Me=>W(Me,we===Me)):(z.cleanupFrame(P),(0,Re.$2)(P,fe.obj,T).then(Me=>W(Me)))})})()}updateItems(b){var P=this;return(0,Ee.A)(function*(){if(!P.disp)return!1;const T=[],z=[];let W=!1,fe=!1;return(0,x.isStr)(b)?b=[b]:(0,x.isObject)(b)||(void 0===b&&(b=!P.isMonitoring()),fe=!0,W=!!b),P.disp.forEachPainter(we=>{const Me=we.getItemName();if((0,x.isStr)(Me)&&!(T.indexOf(Me)>=0)){if(fe){const je=P.findItem(Me);if(!je||"_not_monitor"in je||"_player"in je)return;if(!("_always_monitor"in je)){const Ge=(0,Re.hd)(je._kind);let lt=!1;if(void 0!==Ge?.monitor){if(!1===Ge.monitor||"never"===Ge.monitor)return;"always"===Ge.monitor&&(lt=!0)}if(!lt&&W)return}}else if(b.indexOf(Me)<0)return;T.push(Me),z.push("update:"+we.getItemDrawOpt())}},!0),P.files_monitoring&&!W&&fe&&P.forEachRootFile(we=>{P.forEachItem(Me=>{delete Me._readobj},we),delete we._file}),P.displayItems(T,z)})()}displayItems(b,P){var T=this;return(0,Ee.A)(function*(){if(!b||0===b.length)return!0;const z=T;for(P||(P=[]);P.length<b.length;)P.push("__default_draw_option__");if(1===P.length&&"iotest"===P[0]){T.clearHierarchy(),(0,L.Lt)("#"+T.disp_frameid).html("<h2>Start I/O test</h2>");const Ge=new Date;return T.getObject(b[0]).then(()=>{const lt=new Date;return(0,L.Lt)("#"+T.disp_frameid).append("h2").html("Item "+b[0]+" reading time = "+(lt.getTime()-Ge.getTime())+"ms"),!0})}const W=new Array(b.length),fe=new Array(b.length),we=new Array(b.length);for(let Ge=0;Ge<b.length;++Ge){W[Ge]=fe[Ge]=null;const lt=b[Ge];let bt=!0;if(0===lt?.indexOf("img:")){we[Ge]=!0;continue}lt?.length>1&&"'"===lt[0]&&"'"===lt[lt.length-1]&&(b[Ge]=lt.slice(1,lt.length-1),bt=!1);let te=z.findItem({name:b[Ge],check_keys:!0});if(te){b[Ge]=z.itemFullName(te);continue}if(bt&&"["===b[Ge][0]&&"]"===b[Ge][b[Ge].length-1]?(W[Ge]=v(b[Ge]),b[Ge]=W[Ge].shift()):bt&&b[Ge].indexOf("+")>0&&(W[Ge]=b[Ge].split("+"),b[Ge]=W[Ge].shift()),W[Ge]&&W[Ge].length>0){for(let tt=0;tt<W[Ge].length;++tt){const Fe=W[Ge][tt].indexOf("_same_");Fe>0&&null===z.findItem(W[Ge][tt])&&(W[Ge][tt]=W[Ge][tt].slice(0,Fe)+b[Ge].slice(Fe)),te=z.findItem({name:W[Ge][tt],check_keys:!0}),te&&(W[Ge][tt]=z.itemFullName(te))}for("["===P[Ge][0]&&"]"===P[Ge][P[Ge].length-1]?(fe[Ge]=v(P[Ge]),P[Ge]=fe[Ge].shift()):P[Ge].indexOf("+")>0?(fe[Ge]=P[Ge].split("+"),P[Ge]=fe[Ge].shift()):fe[Ge]=[];fe[Ge].length<W[Ge].length;)fe[Ge].push("")}const Je=b[Ge].indexOf("_same_");Je>0&&!z.findItem(b[Ge])&&Ge>0&&(b[Ge]=b[Ge].slice(0,Je)+b[0].slice(Je)),te=z.findItem({name:b[Ge],check_keys:!0}),te&&(b[Ge]=z.itemFullName(te))}for(let Ge=b.length-1;Ge>=0;--Ge){if(we[Ge])continue;const lt=z.findItem(b[Ge]);!lt||z.canDisplay(lt,P[Ge])||(z.expandItem(b[Ge],null,!0),b.splice(Ge,1),P.splice(Ge,1),W.splice(Ge,1))}if(0===b.length)return!0;const Me=new Array(b.length),je=new Array(b.length);for(let Ge=0;Ge<b.length;++Ge){je[Ge]=0;let lt=b[Ge],bt=0;b.indexOf(lt)<Ge&&(je[Ge]=!0);const te=P[Ge].indexOf("frameid:");if(te>=0)lt=P[Ge].slice(te+8),P[Ge]=P[Ge].slice(0,te);else for(;Me.indexOf(lt)>=0;)lt=b[Ge]+"_"+bt++;Me[Ge]=lt}for(let Ge=0;Ge<b.length;++Ge){if(0!==je[Ge])continue;let lt=Ge;for(let bt=0;bt<b.length;++bt)b[Ge]===b[bt]&&P[bt].indexOf("main")>=0&&(lt=bt);for(let bt=0;bt<b.length;++bt)b[Ge]===b[bt]&&(je[bt]=lt!==bt)}return T.createDisplay().then(Ge=>{if(!Ge)return!1;for(let te=0;te<b.length;++te)0!==P[te].indexOf("update:")&&(Ge.createFrame(Me[te]),P[te]+="::_display_on_frame_::"+Me[te]);function lt(te,Je){if(Je&&W[te]&&W[te].length>0)return z.dropItem(W[te].shift(),Je.getDom(),fe[te].shift()).then(()=>lt(te,Je));W[te]=null,b[te]=null;for(let tt=0;tt<b.length;++tt)if(null!==b[tt]&&je[tt]&&b.indexOf(b[tt])===tt)return je[tt]=!1,z.display(b[tt],P[tt]).then(Fe=>lt(tt,Fe))}const bt=[];if(T._one_by_one){let te=function(Je){return Je>=b.length||(je[Je]?te(Je+1):z.display(b[Je],P[Je]).then(tt=>lt(Je,tt)).then(()=>te(Je+1)))};bt.push(te(0))}else for(let te=0;te<b.length;++te)je[te]||bt.push(z.display(b[te],P[te]).then(Je=>lt(te,Je)));return Promise.all(bt)})})()}reload(){var b=this;return(0,Ee.A)(function*(){return"_online"in b.h&&b.openOnline(b.h._online).then(()=>b.refreshHtml())})()}activateItems(b,P){(0,x.isStr)(b)&&(b=[b]);const T=[],z=[];this.forEachItem(we=>{we._background&&(T.push(we),delete we._background)});const W=()=>{for(let we=z.length-1;we>=0;--we)this.updateTreeNode(z[we]);for(let we=0;we<T.length;++we)this.updateBackground(T[we],P)},fe=(we,Me)=>{if(void 0===we){if(0===b.length)return W();we=b.shift()}let je=this.findItem(we);if(!je){const Ge=this.findItem({name:we,last_exists:!0,check_keys:!0,allow_index:!0});if(!Ge||!Ge.last)return fe();if(Ge.now_found=this.itemFullName(Ge.last),P)return void 0!==Me&&Ge.now_found===Me?fe():this.expandItem(Ge.now_found).then(lt=>{if(!lt)return fe();let bt=this.itemFullName(Ge.last);bt&&(bt+="/"),fe(bt+Ge.rest,Ge.now_found)});je=Ge.last}if(je){let Ge=je._parent;for(;Ge;){if(!Ge._isopen){if(!P){je=Ge;break}Ge._isopen=!0,z.indexOf(Ge)<0&&z.push(Ge)}Ge=Ge._parent}je._background="LightSteelBlue",T.indexOf(je)<0&&T.push(je)}fe()};if(P&&this.brlayout){if(!this.brlayout.browser_kind)return this.createBrowser("float",!0).then(()=>fe());this.brlayout.browser_visible||this.brlayout.toggleBrowserVisisbility()}fe()}canExpandItem(b){if(!b)return!1;if(b._expand)return!0;const P=(0,Re.hd)(b._kind,"::expand");return P&&C(P)}expandItem(b,P,T){var z=this;return(0,Ee.A)(function*(){const W=z.findItem(b),fe=z;if(!W&&P)return;function we(Ge,lt){return Me.apply(this,arguments)}function Me(){return(Me=(0,Ee.A)(function*(Ge,lt){if((0,x.isStr)(Ge._expand)&&(Ge._expand=(0,x.findFunction)(Ge._expand)),!(0,x.isFunc)(Ge._expand)){let bt=(0,Re.hd)(Ge._kind,"::expand");if(bt?.expand_item&&!fe._inspector&&(lt=lt[bt.expand_item],Ge.expand_item=bt.expand_item,bt=lt?._typename?(0,Re.hd)(x.prROOT+lt._typename,"::expand"):null),bt?.expand||bt?.get_expand)if((0,x.isFunc)(bt.expand))Ge._expand=bt.expand;else if((0,x.isStr)(bt.expand)){if(!x.internals.ignore_v6){const te=yield(0,x._ensureJSROOT)();yield te.require(bt.prereq),yield te._complete_loading()}Ge._expand=bt.expand=(0,x.findFunction)(bt.expand)}else(0,x.isFunc)(bt.get_expand)&&(Ge._expand=bt.expand=yield bt.get_expand())}return lt&&(0,x.isFunc)(Ge._expand)&&Ge._expand(Ge,lt)||lt&&$(Ge,lt)?(Ge._isopen=!0,Ge._parent&&!Ge._parent._isopen?(Ge._parent._isopen=!0,T||fe.updateTreeNode(Ge._parent)):T||fe.updateTreeNode(Ge,P),Ge):-1})).apply(this,arguments)}let je=Promise.resolve(-1);if(W){if(!1===W._more||!W._parent&&W._childs)return;if(W._childs&&W._isopen)return W._isopen=!1,void(T||z.updateTreeNode(W,P));W._obj&&(je=we(W,W._obj))}return je.then(Ge=>-1!==Ge?Ge:((0,Ve.Rh)("Loading "+b),z.getObject(b,T?"hierarchy_expand":"hierarchy_expand_verbose").then(lt=>{if((0,Ve.Rh)(),lt.obj)return we(lt.item,lt.obj).then(bt=>-1!==bt?bt:void 0)})))})()}getTopOnlineItem(b){if(b){for(;b&&!("_online"in b);)b=b._parent;return b}return this.h?"_online"in this.h?this.h:this.h._childs&&"_online"in this.h._childs[0]?this.h._childs[0]:null:null}forEachJsonFile(b){if(this.h){if("_jsonfile"in this.h)return b(this.h);if(this.h._childs)for(let P=0;P<this.h._childs.length;++P){const T=this.h._childs[P];"_jsonfile"in T&&b(T)}}}openJsonFile(b){var P=this;return(0,Ee.A)(function*(){let T=!1;if(P.forEachJsonFile(z=>{z._jsonfile===b&&(T=!0)}),!T)return(0,x.httpRequest)(b,"object").then(z=>{if(!z)return;const W={_jsonfile:b,_kind:x.prROOT+z._typename,_jsontmp:z,_name:b.split("/").pop()};if(z.fTitle&&(W._title=z.fTitle),W._get=function(fe){return fe._jsontmp?Promise.resolve(fe._jsontmp):(0,x.httpRequest)(fe._jsonfile,"object").then(we=>(fe._jsontmp=we,we))},P.h)if(P.h._kind===De)P.h._childs.push(W);else{const fe=P.h;P.h={_name:"_jsonfile"in fe?"Files":"Items",_kind:De,_childs:[fe,W]}}else P.h=W;return P.refreshHtml()})})()}forEachRootFile(b){if(this.h){if(this.h._kind===I&&this.h._file)return b(this.h);if(this.h._childs)for(let P=0;P<this.h._childs.length;++P){const T=this.h._childs[P];T._kind===I&&"_fullurl"in T&&b(T)}}}openRootFile(b){var P=this;return(0,Ee.A)(function*(){let T=!1;if(P.forEachRootFile(W=>{W._fullurl===b&&(T=!0)}),T)return;const z=(0,x.isStr)(b)?b:"file";return(0,Ve.Rh)(`Opening ${z} ...`),(0,ve.Tq)(b).then(W=>{const fe=P.fileHierarchy(W);if(fe._isopen=!0,P.h)if(P.h._kind===De)P.h._childs.push(fe);else{const we=P.h;P.h={_name:we._kind===I?"Files":"Items",_kind:De,_childs:[we,fe],_isopen:!0}}else P.h=fe,P._topname&&(fe._name=P._topname);return P.refreshHtml()}).catch(()=>((0,x.isBatchMode)()?console.error(`Fail to open ${z} - check CORS headers`):(0,L.Lt)("#gui_fileCORS").style("background","red").empty()||setTimeout(()=>(0,L.Lt)("#gui_fileCORS").style("background",""),5e3),!1)).finally(()=>(0,Ve.Rh)())})()}listServerDir(b){var P=this;return(0,Ee.A)(function*(){return(0,x.httpRequest)(b,"text").then(T=>{if(!T)return!1;const z={_name:"Files",_kind:De,_childs:[],_isopen:!0};let W=0;for(;W<T.length&&(W=T.indexOf('a href="',W+1),!(W<0));){W+=8;const fe=T.indexOf('"',W+1);if(fe<0)break;const we=T.slice(W,fe);W=fe+1,we.lastIndexOf(".root")===we.length-5&&we.length>5?z._childs.push({_name:we,_title:b+we,_url:b+we,_kind:I,_click_action:"expand",_more:!0,_obj:{},_expand:Me=>(0,ve.Tq)(Me._url).then(je=>{if(!je)return!1;delete Me._exapnd,delete Me._more,delete Me._click_action,delete Me._obj,Me._isopen=!0,P.fileHierarchy(je,Me),P.updateTreeNode(Me)})}):(we.lastIndexOf(".json.gz")===we.length-8&&we.length>8||we.lastIndexOf(".json")===we.length-5&&we.length>5)&&z._childs.push({_name:we,_title:b+we,_jsonfile:b+we,_can_draw:!0,_get:Me=>(0,x.httpRequest)(Me._jsonfile,"object").then(je=>(je&&(Me._kind=x.prROOT+je._typename,Me._jsontmp=je,P.updateTreeNode(Me)),je))})}return z._childs.length>0&&(P.h=z),!0})})()}applyStyle(b){var P=this;return(0,Ee.A)(function*(){if(!b)return!0;let T=Promise.resolve(b);if((0,x.isStr)(b)){const z=P.findItem({name:b,allow_index:!0,check_keys:!0});null!==z?T=P.getObject(z).then(W=>W.obj):b.indexOf(".json")>0&&(T=(0,x.httpRequest)(b,"object"))}return T.then(z=>{z?._typename===x.clTStyle&&Object.assign(x.gStyle,z)})})()}getFileProp(b){let P=this.findItem(b);if(!P)return null;let T=P._name;for(;P._parent;){if(P=P._parent,"_file"in P)return{kind:"file",fileurl:P._file.fURL,itemname:T,localfile:!!P._file.fLocalFile};if("_jsonfile"in P)return{kind:"json",fileurl:P._jsonfile,itemname:T};T=P._name+"/"+T}return null}getOnlineItemUrl(b){(0,x.isStr)(b)&&(b=this.findItem(b));let P=b;for(;P&&void 0===P._online;)P=P._parent;return P?P._online+this.itemFullName(b,P):null}isOnlineItem(b){return null!==this.getOnlineItemUrl(b)}importModule(b){return(0,Ee.A)(function*(){switch(b){case"core":return Promise.resolve().then(Se.bind(Se,8872));case"draw_tree":return Promise.all([Se.e(679),Se.e(76),Se.e(122)]).then(Se.bind(Se,1122));case"hierarchy":return{HierarchyPainter:U,markAsStreamerInfo:E}}return import(b)})()}getOnlineItem(b,P,T){var z=this;return(0,Ee.A)(function*(){let W=P,fe=!1,we="",Me="object",je=null;if((0,x.isStr)(T)&&0===T.indexOf("hierarchy_expand")&&(fe=!0,T=void 0),b){W=z.getOnlineItemUrl(b);let Ge=null;if("_kind"in b&&(je=(0,Re.hd)(b._kind)),fe?(we="h.json?compact=3",b._expand=f):b._make_request?Ge=b._module?(yield z.importModule(b._module))[b._make_request]:(0,x.findFunction)(b._make_request):je?.make_request&&(Ge=je.make_request),(0,x.isFunc)(Ge)){const lt=Ge(z,b,W,T);lt&&((0,x.isStr)(lt)?we=lt:("req"in lt&&(we=lt.req),"kind"in lt&&(Me=lt.kind)))}!we&&0!==b._kind.indexOf(x.prROOT)&&(we="item.json.gz?compact=3")}if(!P&&b&&"_cached_draw_object"in z&&!we){const Ge=z._cached_draw_object;return delete z._cached_draw_object,Ge}return we||(we="root.json.gz?compact=23"),W&&(W+="/"),W+=we,new Promise(Ge=>{let lt=null;(0,x.createHttpRequest)(W,Me,bt=>{const te=Je=>{if((0,x.isFunc)(Je)){const tt=Je(z,b,bt,T,lt);(0,x.isObject)(tt)&&(bt=tt)}Ge(bt)};!fe&&b?._after_request?b._module?z.importModule(b._module).then(Je=>te(Je[b._after_request])):te((0,x.findFunction)(b._after_request)):te(je?.after_request)},void 0,!0).then(bt=>{lt=bt,bt.send(null)})})})()}openOnline(b){var P=this;return(0,Ee.A)(function*(){const T=function(){var z=(0,Ee.A)(function*(W){if(P.h=W,!W)return Promise.resolve(null);P.h?._title&&typeof document<"u"&&(document.title=P.h._title),W._isopen=!0,P.h._online=b,P.h._get=(Ge,lt,bt)=>P.getOnlineItem(Ge,lt,bt),P.h._expand=f;const fe=[],we=[],Me=[],je=[];return P.forEachItem(Ge=>{void 0!==Ge._childs&&(Ge._expand=f),Ge._autoload&&Ge._autoload.split(";").forEach(bt=>{bt.length>4&&bt.lastIndexOf(".mjs")===bt.length-4?je.push(P.importModule(bt)):bt.length>3&&bt.lastIndexOf(".js")===bt.length-3?we.find(te=>te===bt)||we.push(bt):bt.length>4&&bt.lastIndexOf(".css")===bt.length-4?fe.find(te=>te===bt)||fe.push(bt):bt&&!Me.find(te=>te===bt)&&Me.push(bt)})}),P.loadScripts(we,Me).then(()=>(0,x.loadScript)(fe)).then(()=>Promise.all(je)).then(()=>(P.forEachItem(Ge=>{if(!("_drawfunc"in Ge)||!("_kind"in Ge))return;let lt="kind:"+Ge._kind;0===Ge._kind.indexOf(x.prROOT)&&(lt=Ge._kind.slice(5));const bt=Ge._drawopt;(!(0,Re.Xv)(lt)||bt)&&(0,Re.uA)({name:lt,func:Ge._drawfunc,script:Ge._drawscript,opt:bt})}),P))});return function(fe){return z.apply(this,arguments)}}();if(b||(b=""),(0,x.isObject)(b)){const z=b;return b="",T(z)}return(0,x.httpRequest)(b+"h.json?compact=3","object").then(z=>T(z))})()}getOnlineProp(b){let P=this.findItem(b);if(!P)return null;let T=P._name;for(;P._parent;){if(P=P._parent,"_online"in P)return{server:P._online,itemname:T};T=P._name+"/"+T}return null}fillOnlineMenu(b,P,T){const z=this.findItem(T),W=(0,Re.iO)(z._kind,"nosame;noinspect"),fe=(0,Re.hd)(z._kind),we=!!(0,x.isStr)(z._kind)&&0===z._kind.indexOf(x.prROOT);W.opts&&!1!==z._can_draw&&(W.opts.push(x.kInspect),b.addDrawMenu("Draw",W.opts,Me=>this.display(T,Me))),!z._childs&&!1!==z._more&&(z._more||we||W.expand||W.get_expand)&&b.add("Expand",()=>this.expandItem(T)),fe?.execute&&b.add("Execute",()=>this.executeCommand(T,b.tree_node)),W.opts&&!1!==z._can_draw&&b.addDrawMenu("Draw in new window",W.opts,Me=>window.open(P.server+`?nobrowser&item=${P.itemname}`+(this.isMonitoring()?`&monitoring=${this.getMonitoringInterval()}`:"")+(Me?`&opt=${Me}`:""))),W.opts?.length&&we&&!1!==z._can_draw&&b.addDrawMenu("Draw as png",W.opts,Me=>window.open(P.server+P.itemname+"/root.png?w=600&h=400"+(Me?"&opt="+Me:"")),"Request PNG image from the server"),"_player"in z&&b.add("Player",()=>this.player(T))}setHierarchy(b){this.h=b,this.refreshHtml()}setMonitoring(b,P){this._runMonitoring("cleanup"),b&&(b=parseInt(b),Number.isInteger(b)&&b>0?(this._monitoring_interval=Math.max(100,b),P=!0):this._monitoring_interval=3e3),this._monitoring_on=P,this.isMonitoring()&&this._runMonitoring()}_runMonitoring(b){return"cleanup"!==b&&this.isMonitoring()?"frame"===b?(delete this._monitoring_handle,void(this._monitoring_frame=requestAnimationFrame(this._runMonitoring.bind(this,"draw")))):("draw"===b&&(delete this._monitoring_frame,this.updateItems()),void(this._monitoring_handle=setTimeout(this._runMonitoring.bind(this,"frame"),this.getMonitoringInterval()))):(this._monitoring_handle&&(clearTimeout(this._monitoring_handle),delete this._monitoring_handle),void(this._monitoring_frame&&(cancelAnimationFrame(this._monitoring_frame),delete this._monitoring_frame)))}getMonitoringInterval(){return this._monitoring_interval||3e3}isMonitoring(){return this._monitoring_on}setDisplay(b,P){!P&&(0,x.isObject)(b)?(this.disp=b,this.disp_kind="custom",this.disp_frameid=null):(this.disp_kind=b,this.disp_frameid=P),!this.register_resize&&"batch"!==this.disp_kind&&(this.register_resize=!0,(0,Ve.d7)(this))}getLayout(){return this.disp_kind}removePainter(b){this.forEachItem(P=>{P._painter===b&&(delete P._painter,(0,x.isFunc)(P.clear)&&P.clear())})}clearHierarchy(b){this.disp&&(this.disp.cleanup(),delete this.disp);const P=[];this.forEachItem(T=>{delete T._painter,!b&&(0,x.isFunc)(T.clear)&&T.clear(),b&&P.push(T)}),b&&(this.enableMonitoring(!1),this.selectDom().html(""),P.forEach(T=>{delete T._parent,delete T._childs,delete T._obj,delete T._d3cont}),delete this.h)}getDisplay(){return this.disp}cleanupFrame(b){(0,L.Lt)(b).attr("frame_title",null),this.clearDrop(b);const P=(0,Ye.tP)(b);P.length>0&&this.forEachItem(T=>{T._painter&&P.indexOf(T._painter)>=0&&delete T._painter})}createDisplay(){var b=this;return(0,Ee.A)(function*(){if("disp"in b){if(b.disp.numDraw()>0||"custom"===b.disp_kind)return b.disp;b.disp.cleanup(),delete b.disp}return"batch"===b.disp_kind?((0,x.isNodeJs)()?(0,ot.lf)():Promise.resolve(null)).then(T=>(b.disp=new He.bG(1200,800,T?.body),b.disp)):document.getElementById(b.disp_frameid)?(b.disp=0===b.disp_kind.indexOf("flex")||0===b.disp_kind.indexOf("coll")?new He.o5(b.disp_frameid):"tabs"===b.disp_kind?new He.Hb(b.disp_frameid):new He.ho(b.disp_frameid,b.disp_kind),b.disp.cleanupFrame=b.cleanupFrame.bind(b),x.settings.DragAndDrop&&b.disp.setInitFrame(b.enableDrop.bind(b)),b.disp):null})()}createCustomDisplay(b,P){var T=this;return(0,Ee.A)(function*(){if("simple"!==T.disp_kind)return T.createDisplay();if(T.disp_kind=P,T.disp){const z=T.disp.numDraw();if(z>1||1===z&&!T.disp.findFrame(b))return T.createDisplay();T.disp.cleanup(),delete T.disp}return T.createDisplay()})()}updateOnOtherFrames(b,P){const T=this.disp;if(!T)return!1;const z=P._typename?(0,Re.hd)(x.prROOT+P._typename):null;z?.draw_field&&P[z?.draw_field]&&(P=P[z?.draw_field]);let W=!1;return T.forEachPainter(fe=>{fe===b||fe.getItemName()!==b.getItemName()||(0,x.isFunc)(fe.redrawObject)&&fe.redrawObject(P)&&(W=!0)}),W}checkResize(b){this.disp&&this.disp.checkMDIResize(null,b)}loadScripts(b,P,T){return(0,Ee.A)(function*(){return!b?.length&&!P?.length||(T&&!globalThis.JSROOT&&(globalThis.JSROOT={version:x.version,gStyle:x.gStyle,create:x.create,httpRequest:x.httpRequest,loadScript:x.loadScript,decodeUrl:x.decodeUrl,source_dir:x.source_dir,settings:x.settings,addUserStreamer:ve.Ub,addDrawFunc:Re.uA,draw:Re.$2,redraw:Re.AI}),x.internals.ignore_v6||T?(0,x.loadScript)(b):(0,x._ensureJSROOT)().then(z=>z.require(P).then(()=>(0,x.loadScript)(b)).then(()=>z._complete_loading())))})()}startGUI(b,P){var T=this;return(0,Ee.A)(function*(){const z=(0,x.decodeUrl)(P),W=Dn=>{let $n=z.get(Dn,null);return null===$n&&b&&!b.empty()&&b.node().hasAttribute(Dn)&&($n=b.attr(Dn)),$n},we=Dn=>{let $n=(Dn=>{let $n=[];for(;Dn;){const Cn=Dn.indexOf(";");let yn=Cn>0?Dn.slice(0,Cn):Dn;Dn=Cn>0?Dn.slice(Cn+1):"";let Sn=!0;"#"===yn[0]&&(yn=yn.slice(1),Sn=!1);const ii=z.get(yn,null);Sn?$n=$n.concat(v(ii)):null!==ii&&$n.push(ii)}return $n})(Dn);if($n.length>0||!b||b.empty())return $n;for(;Dn;){const Cn=Dn.indexOf(";");let yn=Cn>0?Dn.slice(0,Cn):Dn;Dn=Cn>0?Dn.slice(Cn+1):"";let Sn=!0;if("#"===yn[0]&&(yn=yn.slice(1),Sn=!1),"files"===yn||!b.node().hasAttribute(yn))continue;const ii=b.attr(yn);Sn?$n=$n.concat(v(ii)):null!==ii&&$n.push(ii)}return $n},Me=z.get("path")||"",je=we("#json;jsons"),Ge=we("expand"),lt=W("focus"),bt=W("layout"),te=we("#style"),Je=W("title");T._one_by_one=x.settings.drop_items_one_by_one??null!==W("one_by_one");let tt=W("prereq")||"",Fe=W("load"),Ne=W("dir"),rt=W("inject"),St=we("#file;files"),pt=we("#item;items"),st=we("#opt;opts"),vt=W("monitoring"),Yt=0,qt=W("status"),Ot=W("browser"),Bn=!!Ot;if(vt=null===vt?0:""===vt?3e3:parseInt(vt),null!==W("float")?(Ot="float",Bn=!0):null!==W("fix")&&(Ot="fix",Bn=!0),!Bn&&x.browser.screenWidth<=640&&(Ot="float"),T.no_select=W("noselect"),null!==W("files_monitoring")&&(T.files_monitoring=!0),Je&&typeof document<"u"&&(document.title=Je),0===Ge.length&&""===W("expand")&&Ge.push(""),Me){for(let Dn=0;Dn<St.length;++Dn)St[Dn]=Me+St[Dn];for(let Dn=0;Dn<je.length;++Dn)je[Dn]=Me+je[Dn]}if(0===pt.length&&""===W("item")&&pt.push(""),1===je.length&&0===pt.length&&0===Ge.length&&pt.push(""),!T.disp_kind)if((0,x.isStr)(bt)&&bt)T.disp_kind=bt;else if(x.settings.DislpayKind&&"simple"!==x.settings.DislpayKind)T.disp_kind=x.settings.DislpayKind;else switch(pt.length){case 0:case 1:T.disp_kind="simple";break;case 2:T.disp_kind="vert2";break;case 3:T.disp_kind="vert21";break;case 4:T.disp_kind="vert22";break;case 5:T.disp_kind="vert32";break;case 6:T.disp_kind="vert222";break;case 7:T.disp_kind="vert322";break;case 8:T.disp_kind="vert332";break;case 9:T.disp_kind="vert333";break;default:T.disp_kind="flex"}"no"===qt?qt=null:"off"===qt?(T.status_disabled=!0,qt=null):"on"===qt?qt=!0:null!==qt&&(Yt=parseInt(qt),(!Number.isInteger(Yt)||Yt<5)&&(Yt=0),qt=!0),""===T.no_select&&(T.no_select=!0),Ot?"no"===Ot?Ot="":"off"===Ot&&(Ot="",qt=null,T.exclude_browser=!0):Ot="fix",null!==W("nofloat")&&(T.float_browser_disabled=!0),T.start_without_browser&&(Ot=""),T._topname=W("topname");const Mn=()=>{let Dn;if(Fe||tt)Dn=T.loadScripts(Fe,tt),Fe="",tt="";else if(rt)Dn=T.loadScripts(rt,"",!0),rt="";else if(Ot)Dn=T.createBrowser(Ot),Ot="";else if(null!==qt)Dn=T.createStatusLine(Yt,qt),qt=null;else if(je.length>0)Dn=T.openJsonFile(je.shift());else if(St.length>0)Dn=T.openRootFile(St.shift());else if(Ne)Dn=T.listServerDir(Ne),Ne="";else if(Ge.length>0)Dn=T.expandItem(Ge.shift());else{if(!(te.length>0))return T.refreshHtml().then(()=>T.displayItems(pt,st)).then(()=>lt?T.focusOnItem(lt):T).then(()=>(T.setMonitoring(vt),pt?T.refreshHtml():T));Dn=T.applyStyle(te.shift())}return Dn.then(Mn)};let bn=null;if(T.is_online){const Dn=x.internals.getCachedHierarchy||(0,x.findFunction)("GetCachedHierarchy");(0,x.isFunc)(Dn)&&(bn=Dn()),(0,x.isObject)(bn)||(bn=""),"draw"===T.is_online&&!pt.length&&pt.push("")}return null!==bn?T.openOnline(bn).then(()=>(!T.exclude_browser&&!Bn&&"_browser"in T.h&&(Ot=T.h._browser,"no"===Ot?Ot="":"off"===Ot&&(Ot="",qt=null,T.exclude_browser=!0)),"_monitoring"in T.h&&!vt&&(vt=T.h._monitoring),"_loadfile"in T.h&&0===St.length&&(St=v(T.h._loadfile)),"_drawitem"in T.h&&0===pt.length&&(pt=v(T.h._drawitem),st=v(T.h._drawopt)),"_layout"in T.h&&!bt&&("draw"!==T.is_online||pt.length>1)&&(T.disp_kind=T.h._layout),"_toptitle"in T.h&&T.exclude_browser&&typeof document<"u"&&(document.title=T.h._toptitle),b&&T.prepareGuiDiv(b.attr("id"),T.disp_kind),Mn())):(b&&T.prepareGuiDiv(b.attr("id"),T.disp_kind),Mn())})()}prepareGuiDiv(b,P){this.gui_div=(0,x.isStr)(b)?b:b.attr("id"),this.brlayout=new He.jX(this.gui_div,this),this.brlayout.create(!this.exclude_browser),this.createButtons(),this.setDisplay(P,this.brlayout.drawing_divid())}createButtons(){if(this.exclude_browser)return;const b=this.brlayout?.createBrowserBtns();b&&(Ve.IK.createSVG(b,Ve.IK.diamand,15,"toggle fix-pos browser","browser").style("margin","3px").on("click",()=>this.createBrowser("fix",!0)),this.float_browser_disabled||Ve.IK.createSVG(b,Ve.IK.circle,15,"toggle float browser","browser").style("margin","3px").on("click",()=>this.createBrowser("float",!0)),this.status_disabled||Ve.IK.createSVG(b,Ve.IK.three_circles,15,"toggle status line","browser").style("margin","3px").on("click",()=>this.createStatusLine(0,"toggle")))}hasStatusLine(){return!(this.status_disabled||!this.gui_div||!this.brlayout)&&this.brlayout.hasStatus()}createStatusLine(b,P){var T=this;return(0,Ee.A)(function*(){return!T.status_disabled&&T.gui_div&&T.brlayout?T.brlayout.createStatusLine(b,P):""})()}redrawObject(b){return!(!this._inspector&&!this._streamer_info)&&(this.h=this._streamer_info?A(b):g(b),this.refreshHtml().then(()=>{this.setTopPainter()}))}createBrowser(b,P){var T=this;return(0,Ee.A)(function*(){if(!T.gui_div||T.exclude_browser||!T.brlayout)return!1;const z=(0,L.Lt)(`#${T.gui_div} .jsroot_browser`);if(z.empty())return!1;if("float"===b&&T.float_browser_disabled&&(b="fix"),!z.select(".jsroot_browser_area").empty())return P&&T.brlayout.toggleKind(b),!0;let W=`<p class="jsroot_browser_version"><a href="https://root.cern/js/">JSROOT</a> version <span style="color:green"><b>${x.version}</b></span></p>`;if(T.is_online)W+='<p> Hierarchy in <a href="h.json">json</a> and <a href="h.xml">xml</a> format</p><div style="display:inline; vertical-align:middle; white-space: nowrap;"><label style="margin-right:5px"><input type="checkbox" name="monitoring" class="gui_monitoring"/>Monitoring</label>';else if(T.no_select)"file"===T.no_select&&(W+='<div style="display:flex;flex-direction:row">');else{const Me=(0,L.Lt)("#"+T.gui_div),je=Me.attr("files")||"../files/hsimple.root",Ge=(0,x.decodeUrl)().get("path")||Me.attr("path")||"",lt=je.split(";");W+='<input type="text" value="" style="width:95%; margin:5px;border:2px;" class="gui_urlToLoad" title="input file name"/><div style="display:flex;flex-direction:row;padding-top:5px"><select class="gui_selectFileName" style="flex:1;padding:2px;" title="select file name"<option value="" selected="selected"></option>',lt.forEach(bt=>{W+=`<option value="${Ge+bt}">${bt}</option>`}),W+='</select><input type="file" class="gui_localFile" accept=".root" style="display:none"/><output id="list" style="display:none"></output><input type="button" value="..." class="gui_fileBtn" style="min-width:3em;padding:3px;margin-left:5px;margin-right:5px;" title="select local file for reading"/><br/></div><p id="gui_fileCORS"><small><a href="https://github.com/root-project/jsroot/blob/master/docs/JSROOT.md#reading-root-files-from-other-servers">Read docu</a> how to open files from other servers.</small></p><div style="display:flex;flex-direction:row"><input style="padding:3px;margin-right:5px" class="gui_ReadFileBtn" type="button" title="Read the Selected File" value="Load"/><input style="padding:3px;margin-right:5px" class="gui_ResetUIBtn" type="button" title="Close all opened files and clear drawings" value="Reset"/>'}(T.is_online||!T.no_select||"file"===T.no_select)&&(W+='<select style="padding:2px;margin-right:5px;" title="layout kind" class="gui_layout"></select></div>'),W+=`<div id="${T.gui_div}_browser_hierarchy" class="jsroot_browser_hierarchy"></div>`,T.brlayout.setBrowserContent(W),T.brlayout.setBrowserTitle(T.is_online?"ROOT online server":"Read a ROOT file")?.on("contextmenu",Me=>{Me.preventDefault(),(0,Ze.ES)(Me).then(je=>{T.fillSettingsMenu(je,!0),je.show()})}).on("dblclick",()=>{T.createBrowser("float"===T.brlayout?.browser_kind?"fix":"float",!0)}),!T.is_online&&!T.no_select&&(T.readSelectedFile=function(){const Me=z.select(".gui_urlToLoad").property("value").trim();Me&&(Me.toLowerCase().lastIndexOf(".json")===Me.length-5?this.openJsonFile(Me):this.openRootFile(Me))},z.select(".gui_selectFileName").property("value","").on("change",Me=>z.select(".gui_urlToLoad").property("value",Me.target.value)),z.select(".gui_fileBtn").on("click",()=>z.select(".gui_localFile").node().click()),z.select(".gui_ReadFileBtn").on("click",()=>T.readSelectedFile()),z.select(".gui_ResetUIBtn").on("click",()=>T.clearHierarchy(!0)),z.select(".gui_urlToLoad").on("keyup",Me=>{"Enter"===Me.code&&T.readSelectedFile()}),z.select(".gui_localFile").on("change",Me=>{const je=Me.target.files;for(let Ge=0;Ge<je.length;++Ge){const lt=je[Ge];z.select(".gui_urlToLoad").property("value",lt.name),T.openRootFile(lt)}}));const we=z.select(".gui_layout");return we.empty()||(["simple","vert2","vert3","vert231","horiz2","horiz32","flex","tabs","grid 2x2","grid 1x3","grid 2x3","grid 3x3","grid 4x4"].forEach(Me=>we.append("option").attr("value",Me).html(Me)),we.on("change",Me=>{const je=Me.target.value||"flex";T.setDisplay(je,T.gui_div+"_drawing"),x.settings.DislpayKind=je})),T.setDom(T.gui_div+"_browser_hierarchy"),P&&(T.refreshHtml(),T.initializeBrowser()),T.brlayout.toggleBrowserKind(b||"fix")})()}initializeBrowser(){const b=(0,L.Lt)(`#${this.gui_div} .jsroot_browser`);if(b.empty()||!this.brlayout)return;this.brlayout.adjustBrowserSize();const P=b.select(".gui_layout").node();if(P){let T=!1;for(const z in P.options){const W=P.options[z].text;if((0,x.isStr)(W)&&(W===this.getLayout()||W.replace(/ /g,"")===this.getLayout())){P.selectedIndex=z,T=!0;break}}if(!T){const z=document.createElement("option");z.innerHTML=z.value=this.getLayout(),P.appendChild(z),P.selectedIndex=P.options.length-1}}if(this.is_online)this.h?._toptitle&&this.brlayout.setBrowserTitle(this.h._toptitle),b.select(".gui_monitoring").property("checked",this.isMonitoring()).on("click",T=>{this.enableMonitoring(T.target.checked),this.updateItems()});else if(!this.no_select){let T="";this.forEachRootFile(z=>{T||(T=z._fullurl)}),b.select(".gui_urlToLoad").property("value",T)}}enableMonitoring(b){this.setMonitoring(void 0,b);const P=(0,L.Lt)(`#${this.gui_div} .jsroot_browser .gui_monitoring`);!P.empty()&&P.property("checked")!==b&&P.property("checked",b)}}function k(G,b){return Z.apply(this,arguments)}function Z(){return(Z=(0,Ee.A)(function*(G,b){const P=new U("sinfo",G,"__as_dark_mode__");return(0,x.isBatchMode)()?(P.selectDom().property("_json_object_",b),P):(P._streamer_info=!0,P.h=A(b),P.refreshHtml().then(()=>(P.setTopPainter(),P)))})).apply(this,arguments)}function ee(G,b,P){return he.apply(this,arguments)}function he(){return(he=(0,Ee.A)(function*(G,b,P){(0,Ye.tP)(G);const T=new U("inspector",G,"__as_dark_mode__");if((0,x.isBatchMode)())return T.selectDom().property("_json_object_",b),T;T.default_by_click="expand",T.with_icons=!1,T._inspector=!0;let z=0;return(0,x.isStr)(P)&&0===P.indexOf(x.kInspect)&&(P=P.slice(x.kInspect.length)).length>0&&(z=Number.parseInt(P)),T.selectDom().classed("jsroot_inspector")&&(T.removeInspector=function(){this.selectDom().remove()}),T.fill_context=function(W,fe){const we=(0,Re.iO)(fe._kind,"nosame");we.opts&&W.addDrawMenu("nosub:Draw",we.opts,Me=>{if(!fe?._obj)return;const je=fe._obj;let Ge=this.selectDom().node();if((0,x.isFunc)(this.removeInspector)&&(Ge=Ge.parentNode,this.removeInspector(),0===Me.indexOf(x.kInspect)))return this.showInspector(Me,je);(0,Ye.tP)(Ge),(0,Re.$2)(Ge,je,Me)})},T.h=g(b),T.refreshHtml().then(()=>(T.setTopPainter(),T.exapndToLevel(z)))})).apply(this,arguments)}Ye.JW.prototype.showInspector=function(G,b){if("check"===G)return!0;const P=this.selectDom(),T=(0,ot.xh)(P),z=Math.round(.05*T.width)+"px",W=Math.round(.05*T.height)+"px",fe="root_inspector_"+x.internals.id_counter++;return P.append("div").attr("id",fe).attr("class","jsroot_inspector").style("position","absolute").style("top",W).style("bottom",W).style("left",z).style("right",z),b?._typename||(b=(0,x.isFunc)(this.getPrimaryObject)?this.getPrimaryObject():this.getObject()),ee(fe,b,G)},x.internals.drawInspector=ee},6157:(Yr,mt,Se)=>{"use strict";Se.d(mt,{Hb:()=>J,bG:()=>ue,gZ:()=>Re,ho:()=>F,jX:()=>Q,kV:()=>He,o5:()=>Y});var Ee=Se(4882),x=Se(8362),L=Se(8872),ve=Se(2843),ke=Se(1922),ot=Se(7900),Ye=Se(5992);let Ze=null;function Re(){return Ze}function He(me){Ze=me}class Ve extends ve.b8{constructor(X){super(),this.frameid=X,"$batch$"!==X&&(this.setDom(X),this.selectDom().property("mdi",this)),this.cleanupFrame=ke.tP,this.active_frame_title=""}setInitFrame(X){this.initFrame=X,this.forEachFrame(B=>X(B))}beforeCreateFrame(X){this.active_frame_title=X}afterCreateFrame(X){return(0,L.isFunc)(this.initFrame)&&this.initFrame(X),X}forEachFrame(X,B){console.warn(`forEachFrame not implemented in MDIDisplay ${typeof X} ${B}`)}forEachPainter(X,B){this.forEachFrame($=>{new ke.JW($).forEachPainter(A=>X(A,$))},B)}numDraw(){let X=0;return this.forEachFrame(()=>++X),X}findFrame(X,B){let $=null;return this.forEachFrame(A=>{(0,x.Lt)(A).attr("frame_title")===X&&($=A)}),!$&&B&&($=this.createFrame(X)),$}activateFrame(X){this.active_frame_title=X?(0,x.Lt)(X).attr("frame_title"):""}getActiveFrame(){return this.findFrame(this.active_frame_title)}checkMDIResize(X,B){let $=null;this.forEachPainter((A,E)=>{if((!X||(0,x.Lt)(E).attr("id")===X)&&null!==A.getItemName()&&(0,L.isFunc)(A.checkResize)){if($===E)return;A.checkResize(B),$=E}})}cleanup(){this.active_frame_title="",this.forEachFrame(this.cleanupFrame),this.selectDom().html("").property("mdi",null)}}class F extends Ve{constructor(X,B,$){super(X),this.framecnt=0,this.getcnt=0,this.groups=[],this.vertical=B&&"v"===B[0],this.use_separarators=!B||B.indexOf("x")<0,this.simple_layout=!1;const A=this.selectDom();if(A.style("overflow","hidden"),"simple"===B)return this.simple_layout=!0,this.use_separarators=!1,void(this.framecnt=1);let g,v,f,E=2;if("projxy"===B)this.vertical=!1,this.use_separarators=!0,g=[2,2],v=[1,3],f=[[3,1],[3,1]],B="",this.match_sizes=!0;else if(0===B.indexOf("grid")||$){B=$?B+"x"+$:B.slice(4).trim(),this.use_separarators=!1,"i"===B[0]&&(this.use_separarators=!0,B=B.slice(1));const C=B.indexOf("x");let I,U;if(C>0?(U=parseInt(B.slice(C+1)),I=parseInt(B.slice(0,C))):I=U=parseInt(B),Number.isInteger(I)||(I=3),Number.isInteger(U)||(U=3),U>1)this.vertical=!0,E=U,I>1&&(g=new Array(E).fill(I));else{if(!(I>1))return this.simple_layout=!0,this.use_separarators=!1,void(this.framecnt=1);this.vertical=!1,E=I}B=""}if(B&&B.indexOf("_")>0){let C=parseInt(B.slice(B.indexOf("_")+1),10);if(Number.isInteger(C)&&C>10)for(B=B.slice(0,B.indexOf("_")),v=[];C>0;)v.unshift(Math.max(C%10,1)),C=Math.round((C-v[0])/10),0===v[0]&&(v[0]=1)}if(B=B?parseInt(B.replace(/^\D+/g,""),10):0,Number.isInteger(B)&&B>1)if(B<10)E=B;else{for(g=[];B>0;)g.unshift(B%10),B=Math.round((B-g[0])/10),0===g[0]&&(g[0]=1);E=g.length}v?.length!==E&&(v=void 0),f?.length!==E&&(f=void 0),this.simple_layout||this.createGroup(this,A,E,g,v,f)}createGroup(X,B,$,A,E,g){E||(E=new Array($));let v=0,f=0;for(let C=0;C<$;++C)v+=E[C]||1;for(let C=0;C<$;++C)E[C]=Math.round(100*(E[C]||1)/v),f+=E[C],C===$-1&&(E[C]+=100-f);for(let C=0;C<$;++C){const I={id:C,drawid:-1,position:0,size:E[C],parent:X};C>0&&(I.position=X.groups[C-1].position+X.groups[C-1].size),I.position0=I.position,(!A||!A[C]||A[C]<2)&&(I.drawid=this.framecnt++),X.groups.push(I);const U=B.append("div").attr("groupid",I.id);X.match_sizes&&(I.node=U.node()),X.vertical?U.style("float","bottom").style("height",I.size.toFixed(2)+"%").style("width","100%"):U.style("float","left").style("width",I.size.toFixed(2)+"%").style("height","100%"),I.drawid>=0?(U.classed("jsroot_newgrid",!0),(0,L.isStr)(this.frameid)&&U.attr("id",`${this.frameid}_${I.drawid}`)):U.style("display","flex").style("flex-direction",X.vertical?"row":"column"),A&&A[C]>1&&(I.vertical=!X.vertical,I.groups=[],U.style("overflow","hidden"),this.createGroup(I,U,A[C],null,g?g[C]:null))}if(this.use_separarators&&(0,L.isFunc)(this.createSeparator))for(let C=1;C<$;++C)this.createSeparator(X,B,X.groups[C])}handleSeparator(X,B){const $=(ee,he)=>{let G=ee?.firstChild;for(;G;){if(G.getAttribute("groupid")===he)return(0,x.Lt)(G);G=G.nextSibling}return(0,x.Lt)(ee).select(`[groupid='${he}']`)},A=(ee,he,G)=>{const b=ee.vertical?"height":"width",P=ee.groups[G].size.toFixed(2)+"%";$(he,G).style(b,P).selectAll(".jsroot_separator").style(b,P)},E=(ee,he)=>{let G=$(ee,he);G.classed("jsroot_newgrid")||(G=G.select(".jsroot_newgrid")),G.each(function(){(0,ke.XR)(this)})},g=(ee,he,G)=>{G.style(ee.vertical?"top":"left",`calc(${he.position.toFixed(2)}% - 2px)`)},v=(0,x.Lt)(X),f=X.parentNode,C=v.property("handle"),I=v.property("separator_id"),U=C.groups[I];let k=!1,Z=!1;if("start"===B)return U.startpos=U.position,void(U.acc_drag=0);if("end"===B){if(Math.abs(U.startpos-U.position)<.5)return;k=!0}else{let ee;"restore"===B?ee=U.position0:C.vertical?(U.acc_drag+=B.dy,ee=U.startpos+(U.acc_drag+2)/f.clientHeight*100):(U.acc_drag+=B.dx,ee=U.startpos+(U.acc_drag+2)/f.clientWidth*100);const he=U.position-ee;if(Math.abs(he)<.3||Math.min(C.groups[I-1].size-he,U.size+he)<3)return;C.groups[I-1].size-=he,U.size+=he,U.position=ee,g(C,U,v),Z=!0,k="restore"===B}if(Z&&(A(C,f,I-1),A(C,f,I)),k&&(E(f,I-1),E(f,I)),C.parent?.match_sizes)for(let ee=0;ee<C.parent.groups.length;++ee){const he=C.parent.groups[ee];he===C||!he.node||(he.groups[I].size=C.groups[I].size,he.groups[I].position=C.groups[I].position,he.groups[I-1].size=C.groups[I-1].size,he.groups[I-1].position=C.groups[I-1].position,Z&&((0,x.Lt)(he.node).selectAll(".jsroot_separator").each(function(){const G=(0,x.Lt)(this);G.property("separator_id")===I&&g(he,he.groups[I],G)}),A(he,he.node,I-1),A(he,he.node,I)),k&&(E(he.node,I-1),E(he.node,I)))}}createSeparator(X,B,$){const A=B.append("div");A.classed("jsroot_separator",!0).property("handle",X).property("separator_id",$.id).attr("style","pointer-events: all; border: 0; margin: 0; padding: 0; position: absolute;").style(X.vertical?"top":"left",`calc(${$.position.toFixed(2)}% - 2px)`).style(X.vertical?"width":"height",(X.size?.toFixed(2)||100)+"%").style(X.vertical?"height":"width","5px").style("cursor",X.vertical?"ns-resize":"ew-resize").append("div").attr("style","position: absolute;"+(X.vertical?"left: 0; right: 0; top: 50%; height: 3px; border-top: 1px dotted #ff0000":"top: 0; bottom: 0; left: 50%; width: 3px; border-left: 1px dotted #ff0000"));const E=this,g=(0,x.$E)().on("start",function(){E.handleSeparator(this,"start")}).on("drag",function(v){E.handleSeparator(this,v)}).on("end",function(){E.handleSeparator(this,"end")});A.call(g).on("dblclick",function(){E.handleSeparator(this,"restore")}),L.browser.touches&&!B.on("touchmove")&&B.on("touchmove",()=>{})}forEachFrame(X){this.simple_layout?X(this.getGridFrame()):this.selectDom().selectAll(".jsroot_newgrid").each(function(){X(this)})}getActiveFrame(){if(this.simple_layout)return this.getGridFrame();let X=super.getActiveFrame();return X||(this.forEachFrame(B=>{X||(X=B)}),X)}numGridFrames(){return this.framecnt}getGridFrame(X){if(this.simple_layout)return this.selectDom("origin").node();let B=null;return this.selectDom().selectAll(".jsroot_newgrid").each(function(){0==X--&&(B=this)}),B}createFrame(X){this.beforeCreateFrame(X);let B=null,$=this.framecnt||2;for(;!B&&$--;)B=this.getGridFrame(this.getcnt),!this.simple_layout&&this.framecnt&&(this.getcnt=(this.getcnt+1)%this.framecnt),(0,x.Lt)(B).classed("jsroot_fixed_frame")&&(B=null);return B&&(this.cleanupFrame(B),(0,x.Lt)(B).attr("frame_title",X)),this.afterCreateFrame(B)}}class J extends Ve{constructor(X){super(X),this.cnt=0,this.selectDom().style("overflow","hidden")}cleanup(){this.selectDom().style("overflow",null),this.cnt=0,super.cleanup()}forEachFrame(X,B){if((0,L.isFunc)(X))if(B){const A=this.getActiveFrame();A&&X(A)}else this.selectDom().select(".jsroot_tabs_main").selectAll(".jsroot_tabs_draw").each(function(){X(this)})}modifyTabsFrame(X,B){const $=this.selectDom().select(".jsroot_tabs"),A=$.select(".jsroot_tabs_labels"),E=$.select(".jsroot_tabs_main");let g,v;if(A.selectAll(".jsroot_tabs_label").each(function(){const C=(0,x.Lt)(this).property("frame_id")===X,I=L.settings.DarkMode?"#333":"white";"activate"===B?(0,x.Lt)(this).style("background",C?I:L.settings.DarkMode?"black":"#ddd").style("color",L.settings.DarkMode?"#ddd":"inherit").style("border-color",I):"close"===B&&C&&this.parentNode.remove()}),E.selectAll(".jsroot_tabs_draw").each(function(){(0,x.Lt)(this).property("frame_id")===X?g=this:v=this,"activate"===B&&(0,x.Lt)(this).style("background",L.settings.DarkMode?"black":"white")}),g)if("activate"===B)g.parentNode.appendChild(g);else if("close"===B){const f=g===this.getActiveFrame();(0,ke.tP)(g),g.remove(),f&&this.activateFrame(v)}}activateFrame(X){X&&this.modifyTabsFrame((0,x.Lt)(X).property("frame_id"),"activate"),super.activateFrame(X)}createFrame(X){this.beforeCreateFrame(X);const B=this.selectDom();let A,E,$=B.select(".jsroot_tabs");$.empty()?($=B.append("div").attr("class","jsroot_tabs").attr("style","display: flex; flex-direction: column; position: absolute; overflow: hidden; left: 0px; top: 0px; bottom: 0px; right: 0px;"),A=$.append("div").attr("class","jsroot_tabs_labels").attr("style","white-space: nowrap; position: relative; overflow-x: auto"),E=$.append("div").attr("class","jsroot_tabs_main").attr("style","margin: 0; flex: 1 1 0%; position: relative")):(A=$.select(".jsroot_tabs_labels"),E=$.select(".jsroot_tabs_main"));const g=this.cnt++,v=this;let f=X;if((!f||!(0,L.isStr)(f))&&(f=`frame_${g}`),f.length>15){let I=f.lastIndexOf("/");I===f.length-1&&(I=f.lastIndexOf("/",I-1)),f=I>0&&f.length-I<20&&f.length-I>1?f.slice(I+1):"..."+f.slice(f.length-17)}A.append("span").attr("tabindex",0).append("label").attr("class","jsroot_tabs_label").attr("style","border: 1px solid; display: inline-block; font-size: 1rem; left: 1px;margin-left: 3px; padding: 0px 5px 1px 5px; position: relative; vertical-align: bottom;").property("frame_id",g).text(f).attr("title",X).on("click",function(I){I.preventDefault(),v.modifyTabsFrame((0,x.Lt)(this).property("frame_id"),"activate")}).append("button").attr("title","close").attr("style","margin-left: .5em; padding: 0; font-size: 0.5em; width: 1.8em; height: 1.8em; vertical-align: center;").html("&#x2715;").on("click",function(){v.modifyTabsFrame((0,x.Lt)(this.parentNode).property("frame_id"),"close")});const C=E.append("div").attr("frame_title",X).attr("class","jsroot_tabs_draw").attr("style","overflow: hidden; position: absolute; left: 0px; top: 0px; bottom: 0px; right: 0px;").property("frame_id",g);return this.modifyTabsFrame(g,"activate"),this.afterCreateFrame(C.node())}changeDarkMode(){const X=this.getActiveFrame();this.modifyTabsFrame((0,x.Lt)(X).property("frame_id"),"activate")}}class Y extends Ve{constructor(X){super(X),this.cnt=0,this.selectDom().on("contextmenu",B=>this.showContextMenu(B)).style("overflow","auto")}cleanup(){this.selectDom().style("overflow",null).on("contextmenu",null),this.cnt=0,super.cleanup()}forEachFrame(X,B){if(!(0,L.isFunc)(X))return;const $=this;this.selectDom().select(".jsroot_flex_top").selectAll(".jsroot_flex_draw").each(function(){B&&"min"===$.getFrameState(this)||X(this)})}getActiveFrame(){let X=super.getActiveFrame();return X&&"min"!==(0,x.Lt)(X.parentNode).property("state")||(X=null,this.forEachFrame(B=>{X=B},!0)),X}activateFrame(X){if("first"===X||"last"===X){let $=null;this.forEachFrame(A=>{("last"===X||!$)&&($=A)},!0),X=$}if(!X||"jsroot_flex_draw"!==X.getAttribute("class")||this.getActiveFrame()===X)return;super.activateFrame(X);const B=X.parentNode;B.parentNode.append(B),"min"!==this.getFrameState(X)&&((0,ke.QD)({pp:(0,ke.m6)(X),active:!0}),(0,ke.XR)(X))}getFrameState(X){return(0,x.Lt)(X.parentNode).property("state")}getFrameRect(X){if("max"===this.getFrameState(X)){const E=this.selectDom().select(".jsroot_flex_top");return{x:0,y:0,w:E.node().clientWidth,h:E.node().clientHeight}}const B=(0,x.Lt)(X.parentNode),$=B.style("left"),A=B.style("top");return{x:parseInt($.slice(0,$.length-2)),y:parseInt(A.slice(0,A.length-2)),w:B.node().clientWidth,h:B.node().clientHeight}}changeFrameState(X,B,$){const A=(0,x.Lt)(X.parentNode),E=A.property("state"),g=this.selectDom().select(".jsroot_flex_top");if(E===B)return!1;switch("normal"===E&&A.property("original_style",A.attr("style")),g.style("overflow",null),B){case"min":A.style("height","auto").style("width","auto"),A.select(".jsroot_flex_draw").style("display","none");break;case"max":A.style("height","100%").style("width","100%").style("left","").style("top",""),A.select(".jsroot_flex_draw").style("display",null),g.style("overflow","hidden");break;default:A.select(".jsroot_flex_draw").style("display",null),A.attr("style",A.property("original_style"))}if(A.select(".jsroot_flex_header").selectAll("button").each(function(v){const f=(0,x.Lt)(this);"minimize"===v.t&&"min"===B||"maximize"===v.t&&"max"===B?f.html("&#x259E;").attr("title","restore"):f.html(v.n).attr("title",v.t)}),A.property("state",B),A.select(".jsroot_flex_resize").style("display","normal"===B?null:"none"),"min"===B){const v=this.getFrameRect(X),f=this.selectDom().select(".jsroot_flex_top"),C=f.node().clientWidth,I=f.node().clientHeight,U=[],k=4,Z=(he,G)=>he.x<=G.x&&he.x+he.w>=G.x||G.x<=he.x&&G.x+G.w>=he.x,ee=(he,G)=>he.y<=G.y&&he.y+he.h>=G.y||G.y<=he.y&&G.y+G.h>=he.y;this.forEachFrame(he=>{he!==X&&"min"===this.getFrameState(he)&&U.push(this.getFrameRect(he))}),v.y=I;do{v.x=k,v.y-=v.h+k;let he=k,G=!1;U.forEach(b=>{ee(b,v)&&(he=Math.max(he,b.x+b.w+k),Z(b,v)&&(G=!0))}),G&&(v.x=he)}while(v.x+v.w>C-k&&v.y>0);v.y<0&&(v.x=k,v.y=I-v.h-k),A.style("left",v.x+"px").style("top",v.y+"px")}else $||(0,ke.XR)(X);return!0}_clickButton(X){const B=(0,x.Lt)(X).datum(),$=(0,x.Lt)(X.parentNode.parentNode),A=$.select(".jsroot_flex_draw").node();if("close"===B.t)return this.cleanupFrame(A),$.remove(),void this.activateFrame("last");const E=$.property("state");let g;g="maximize"===B.t?"max"===E?"normal":"max":"min"===E?"normal":"min",this.changeFrameState(A,g)&&this.activateFrame("min"!==g?A:"last")}createFrame(X){this.beforeCreateFrame(X);const B=this,$=this.selectDom();let A=$.select(".jsroot_flex_top");A.empty()&&(A=$.append("div").attr("class","jsroot_flex_top").attr("style","overflow: auto; position: relative; height: 100%; width: 100%"));const E=A.node().clientWidth,g=A.node().clientHeight,v=A.append("div");v.html(`<div class='jsroot_flex_header' style='height: 23px; overflow: hidden; background-color: lightblue'><p style='margin: 1px; float: left; font-size: 14px; padding-left: 5px'>${X}</p></div><div id='${this.frameid}_cont${this.cnt}' class='jsroot_flex_draw' style='overflow: hidden; width: 100%; height: calc(100% - 24px); background: white'></div><div class='jsroot_flex_resize' style='position: absolute; right: 3px; bottom: 1px; overflow: hidden; cursor: nwse-resize'>&#x25FF;</div>`),v.attr("class","jsroot_flex_frame").style("position","absolute").style("left",Math.round(E*(this.cnt%5)/10)+"px").style("top",Math.round(g*(this.cnt%5)/10)+"px").style("width",Math.round(.58*E)+"px").style("height",Math.round(.58*g)+"px").style("border","1px solid black").style("box-shadow","1px 1px 2px 2px #aaa").property("state","normal").select(".jsroot_flex_header").on("click",function(){B.activateFrame((0,x.Lt)(this.parentNode).select(".jsroot_flex_draw").node())}).selectAll("button").data([{n:"&#x2715;",t:"close"},{n:"&#x2594;",t:"maximize"},{n:"&#x2581;",t:"minimize"}]).enter().append("button").attr("type","button").attr("style","float: right; padding: 0; width: 1.4em; text-align: center; font-size: 10px; margin-top: 2px; margin-right: 4px").attr("title",ee=>ee.t).html(ee=>ee.n).on("click",function(){B._clickButton(this)});let f=null,C=null,I=!1,U=[];const k=(0,x.$E)().subject(Object);k.on("start",function(ee){if("button"===ee.sourceEvent.target.type)return B._clickButton(ee.sourceEvent.target);if((0,Ye.iE)(ee.sourceEvent))return;const he=(0,x.Lt)(this.parentNode);!he.classed("jsroot_flex_frame")||"max"===he.property("state")||(I=!(0,x.Lt)(this).classed("jsroot_flex_resize"),(I||"min"!==he.property("state"))&&(B.activateFrame(he.select(".jsroot_flex_draw").node()),C=A.append("div").attr("style",he.attr("style")).style("border","2px dotted #00F"),"min"===he.property("state")&&C.style("width",he.node().clientWidth+"px").style("height",he.node().clientHeight+"px"),ee.sourceEvent.preventDefault(),ee.sourceEvent.stopPropagation(),f=he,U=[]))}).on("drag",function(ee){if(!C)return;ee.sourceEvent.preventDefault(),ee.sourceEvent.stopPropagation();const he=(G,b,P)=>{if(G>=U.length){const T=C.style(b);U[G]=parseInt(T.slice(0,T.length-2))}U[G]+=P,C.style(b,Math.max(0,U[G])+"px")};I?(he(0,"left",ee.dx),he(1,"top",ee.dy)):(he(0,"width",ee.dx),he(1,"height",ee.dy))}).on("end",function(ee){C&&(ee.sourceEvent.preventDefault(),ee.sourceEvent.stopPropagation(),I?(f.style("left",C.style("left")),f.style("top",C.style("top"))):(f.style("width",C.style("width")),f.style("height",C.style("height"))),C.remove(),C=null,I||(0,ke.XR)(f.select(".jsroot_flex_draw").node()))}),v.select(".jsroot_flex_header").call(k),v.select(".jsroot_flex_resize").call(k);const Z=v.select(".jsroot_flex_draw").attr("frame_title",X).property("frame_cnt",this.cnt++).node();return this.afterCreateFrame(Z)}minimizeAll(){this.forEachFrame(X=>this.changeFrameState(X,"min"))}showAll(){this.forEachFrame(X=>{"min"===this.getFrameState(X)&&this.changeFrameState(X,"normal")})}closeAllFrames(){const X=[];this.forEachFrame(B=>X.push(B)),X.forEach(B=>{this.cleanupFrame(B),(0,x.Lt)(B.parentNode).remove()})}sortFrames(X){const B=[];if(this.forEachFrame(I=>{const U=this.getFrameState(I);"min"!==U&&("max"===U&&this.changeFrameState(I,"normal",!0),B.push(I))}),0===B.length)return;const $=this.selectDom(),A=$.node().clientWidth,E=$.node().clientHeight,g=Math.min(40,Math.round(.4*A/B.length)),v=Math.min(40,Math.round(.4*E/B.length));let f=Math.ceil(Math.sqrt(B.length)),C=f;f>1&&f*(f-1)>=B.length&&(A>E?C--:f--),B.forEach((I,U)=>{const k=(0,x.Lt)(I.parentNode);"cascade"===X?k.style("left",U*g+"px").style("top",U*v+"px").style("width",Math.round(.58*A)+"px").style("height",Math.round(.58*E)+"px"):k.style("left",Math.round(A/f*(U%f))+"px").style("top",Math.round(E/C*((U-U%f)/f))+"px").style("width",Math.round(A/f-4)+"px").style("height",Math.round(E/C-4)+"px"),(0,ke.XR)(I)})}showContextMenu(X){if("jsroot_flex_top"!==X.target.getAttribute("class")||0===this.numDraw())return;X.preventDefault();const B=[];let $=0;this.forEachFrame(E=>{B.push(E),"min"===this.getFrameState(E)&&$++});const A=this.getActiveFrame();B.sort((E,g)=>(0,x.Lt)(E).property("frame_cnt")<(0,x.Lt)(g).property("frame_cnt")?-1:1),(0,ot.ES)(X,this).then(E=>{E.add("header:Flex"),E.add("Cascade",()=>this.sortFrames("cascade"),"Cascade frames"),E.add("Tile",()=>this.sortFrames("tile"),"Tile all frames"),$<B.length&&E.add("Minimize all",()=>this.minimizeAll(),"Minimize all frames"),$>0&&E.add("Show all",()=>this.showAll(),"Restore minimized frames"),E.add("Close all",()=>this.closeAllFrames()),E.add("separator"),B.forEach((g,v)=>E.addchk(g===A,("min"===this.getFrameState(g)?"[min] ":"")+(0,x.Lt)(g).attr("frame_title"),v,f=>{const C=B[f];"min"===this.getFrameState(C)&&this.changeFrameState(C,"normal"),this.activateFrame(C)})),E.show()})}}class ue extends Ve{constructor(X,B,$){super("$batch$"),this.frames=[],this.width=X||1200,this.height=B||800,this.jsdom_body=$||(0,x.Lt)("body")}forEachFrame(X){this.frames.forEach(X)}createFrame(X){this.beforeCreateFrame(X);const B=this.jsdom_body.append("div").style("visible","hidden").attr("width",this.width).attr("height",this.height).style("width",this.width+"px").style("height",this.height+"px").attr("id","jsroot_batch_"+this.frames.length).attr("frame_title",X);return this.frames.push(B.node()),this.afterCreateFrame(B.node())}numFrames(){return this.frames.length}makeJSON(X,B){const $=this.frames[X];if(!$)return;const A=(0,x.Lt)($).property("_json_object_");return A?((0,x.Lt)($).property("_json_object_",null),(0,ke.tP)($),(0,x.Lt)($).remove(),(0,L.toJSON)(A,B)):void 0}makeSVG(X){const B=this.frames[X];if(!B)return;const $=(0,x.Lt)(B);function A(){const g=(0,x.Lt)(this);"none"===g.style("display")&&g.remove()}$.select("svg").attr("xmlns","http://www.w3.org/2000/svg").attr("width",this.width).attr("height",this.height).attr("title",null).attr("style",null).attr("class",null).attr("x",null).attr("y",null),$.selectAll("g.root_frame").each(A),$.selectAll("svg").each(A);const E=(0,ve.NM)($.html());return(0,ke.tP)(B),$.remove(),E}}class Q{constructor(X,B,$){this.gui_div=X,this.hpainter=B,this.objpainter=$,this.browser_kind=null}main(){return(0,x.Lt)("#"+this.gui_div)}browser(){return this.main().select(".jsroot_browser")}drawing(){return(0,x.Lt)(`#${this.gui_div}_drawing`)}status(){return(0,x.Lt)(`#${this.gui_div}_status`)}drawing_divid(){return this.gui_div+"_drawing"}checkResize(){(0,L.isFunc)(this.hpainter?.checkResize)?this.hpainter.checkResize():(0,L.isFunc)(this.objpainter?.checkResize)&&this.objpainter.checkResize(!0)}createStyle(){const X=L.settings.DarkMode?"black":"#E6E6FA",$=L.settings.DarkMode?"#ddd":"inherit",A=L.settings.DarkMode?`background-color: #222; color: ${$}`:"";(0,Ye.fz)(`.jsroot_browser { pointer-events: none; position: absolute; left: 0px; top: 0px; bottom: 0px; right: 0px; margin: 0px; border: 0px; overflow: hidden; }.jsroot_draw_area { background-color: ${X}; overflow: hidden; margin: 0px; border: 0px; }.jsroot_browser_area { color: ${$}; background-color: ${X}; font-size: 12px; font-family: Verdana; pointer-events: all; box-sizing: initial; }.jsroot_browser_area input { ${A} }.jsroot_browser_area select { ${A} }.jsroot_browser_title { font-family: Verdana; font-size: 20px; color: ${L.settings.DarkMode?"#ccc":"inherit"}; }.jsroot_browser_btns { pointer-events: all; display: flex; flex-direction: column; }.jsroot_browser_area p { margin-top: 5px; margin-bottom: 5px; white-space: nowrap; }.jsroot_browser_hierarchy { flex: 1; margin-top: 2px; }.jsroot_status_area { background-color: ${X}; overflow: hidden; font-size: 12px; font-family: Verdana; pointer-events: all; }.jsroot_browser_resize { position: absolute; right: 3px; bottom: 3px; margin-bottom: 0px; margin-right: 0px; opacity: 0.5; cursor: se-resize; z-index: 1; }`,this.main().node(),"browser_layout_style")}create(X){const B=this.main();B.append("div").attr("id",this.drawing_divid()).classed("jsroot_draw_area",!0).style("position","absolute").style("left",0).style("top",0).style("bottom",0).style("right",0),X&&B.append("div").classed("jsroot_browser",!0),this.createStyle()}createBrowserBtns(){const X=this.browser();if(X.empty())return;let B=X.select(".jsroot_browser_btns");return B.empty()?B=X.append("div").attr("class","jsroot jsroot_browser_btns").attr("style","position: absolute; left: 7px; top: 7px"):B.html(""),B}removeBrowserBtns(){this.browser().select(".jsroot_browser_btns").remove()}setBrowserContent(X){const B=this.browser();B.empty()||B.insert("div",".jsroot_browser_btns").classed("jsroot_browser_area",!0).style("position","absolute").style("left","0px").style("top","0px").style("bottom","0px").style("width","250px").style("overflow","hidden").style("padding-left","5px").style("display","flex").style("flex-direction","column").html(`<p class='jsroot_browser_title'>title</p><div class='jsroot_browser_resize' style='display:none'>&#9727</div>${X}`)}hasContent(){const X=this.browser();return!X.empty()&&!X.select(".jsroot_browser_area").empty()}deleteContent(X){const B=this.browser();B.empty()||(X||this.createStatusLine(0,"delete"),this.toggleBrowserVisisbility(!0),X?(B.select(".jsroot_browser_area").remove(),B.select(".jsroot_browser_btns").remove(),B.select(".jsroot_v_separator").remove()):B.selectAll("*").remove(),delete this.browser_visible,delete this.browser_kind,this.checkResize())}hasStatus(){return!this.browser().empty()&&!this.status().empty()}setBrowserTitle(X){const B=this.browser(),$=B.empty()?null:B.select(".jsroot_browser_title");return $&&$.text(X).style("cursor","flex"===this.browser_kind?"move":null),$}toggleKind(X){"changing"!==this.browser_visible&&(X===this.browser_kind?this.toggleBrowserVisisbility():this.toggleBrowserKind(X))}createStatusLine(X,B){var $=this;return(0,Ee.A)(function*(){const A=$.browser();if(A.empty())return"";const E=$.gui_div+"_status",g=(0,x.Lt)("#"+E),v=!g.empty();if("toggle"===B?B=!v:"delete"===B?(B=!1,X=0,delete $.status_layout):void 0===B&&(B=!0,$.status_layout="app"),v)return!0===B?E:(A.select(".jsroot_h_separator").remove(),g.remove(),"app"!==$.status_layout&&delete $.status_layout,$.status_handler&&L.internals.showStatus===$.status_handler&&(delete L.internals.showStatus,delete $.status_handler),$.adjustSeparators(null,0,!0),"");if(!1===B)return"";const f=$.drawing().style("left");A.insert("div",".jsroot_browser_area").attr("id",E).classed("jsroot_status_area",!0).style("position","absolute").style("left",f).style("height","20px").style("bottom","0px").style("right","0px").style("margin",0).style("border",0);const C=L.settings.DarkMode?"grey":"azure",I=A.insert("div",".jsroot_browser_area").classed("jsroot_h_separator",!0).attr("style",`pointer-events: all; border: 0; margin: 0; padding: 0; background-color: ${C}; position: absolute; left: ${f}; right: 0; bottom: 20px; height: 5px; cursor: ns-resize;`),U=(0,x.$E)().on("start",()=>{$._hsepar_move=$._hsepar_position,I.style("background-color","grey")}).on("drag",Z=>{$._hsepar_move-=Z.dy,$.adjustSeparators(null,Math.max(5,Math.round($._hsepar_move)))}).on("end",()=>{delete $._hsepar_move,I.style("background-color",null),$.checkResize()});if(I.call(U),L.browser.touches&&!A.on("touchmove")&&A.on("touchmove",()=>{}),(!X||(0,L.isStr)(X))&&(X=$.last_hsepar_height||20),$.adjustSeparators(null,X,!0),"app"===$.status_layout)return E;$.status_layout=new F(E,"horizx4_1213");const k=["object name","object title","mouse coordinates","object info"];for(let Z=0;Z<4;++Z)(0,x.Lt)($.status_layout.getGridFrame(Z)).attr("title",k[Z]).style("overflow","hidden").append("label").attr("style","margin: 3px; margin-left: 5px; font-size: 14px; vertical-align: middle; white-space: nowrap;");return L.internals.showStatus=$.status_handler=$.showStatus.bind($),E})()}adjustSeparators(X,B,$,A){if(!this.gui_div)return;const E=this.browser();if(null===B&&A&&!E.select(".jsroot_h_separator").empty()&&(B=E.select(".jsroot_h_separator").style("bottom"),B=(0,L.isStr)(B)&&B.length>2&&B.indexOf("px")===B.length-2?B.slice(0,B.length-2):null),null!==B){B=parseInt(B);const v=E.select(".jsroot_h_separator");let f=0;if(!v.empty()){B<5&&(B=5);const C=E.node().clientHeight-5;C>0&&(B<0&&(B+=C),B>C&&(B=C)),this.last_hsepar_height=B,v.style("bottom",B+"px").style("height","5px"),this.status().style("height",B+"px"),f=B+5}this._hsepar_position=B,this.drawing().style("bottom",`${f}px`)}null!==X&&(X=Math.max(50,Number.parseInt(X)),this._vsepar_position=X,E.select(".jsroot_browser_area").style("width",X-5+"px"),this.drawing().style("left",X+5+"px"),E.select(".jsroot_h_separator").style("left",X+5+"px"),this.status().style("left",X+5+"px"),E.select(".jsroot_v_separator").style("left",X+"px").style("width","5px")),$&&this.checkResize()}showStatus(...X){if(!(0,L.isObject)(this.status_layout)||!(0,L.isFunc)(this.status_layout.getGridFrame))return;let B=0;for(let $=0;$<4;++$){const A=this.status_layout.getGridFrame($).querySelector("label");B=Math.max(B,A.clientHeight),A.innerHTML=X[$]||""}this.status_layout.first_check||(this.status_layout.first_check=!0,B>5&&(B>this.last_hsepar_height||B<this.last_hsepar_height+5)&&this.adjustSeparators(null,B,!0))}toggleBrowserVisisbility(X){if(!this.gui_div||(0,L.isStr)(this.browser_visible))return;const B=this.browser(),$=B.select(".jsroot_browser_area");if($.empty())return;const A=B.select(".jsroot_v_separator"),E=(0,x.Lt)(`#${this.gui_div}_drawing`);let g=$.property("last_left"),v=$.property("last_vsepar"),f=$.property("last_drawing");if(this.browser_visible){$.property("last_left",$.style("left")),A.empty()||($.property("last_vsepar",A.style("left")),$.property("last_drawing",E.style("left"))),g=-$.node().clientWidth-10+"px";const U=B.node().clientWidth;A.empty()&&$.node().offsetLeft>U/2&&(g=U+10+"px"),v="-10px",f="0px"}else{if(X)return;$.property("last_left",null).property("last_vsepar",null).property("last_drawing",null)}const C=!this.browser_visible,I=X?0:700;this.browser_visible="changing",$.transition().style("left",g).duration(I).on("end",()=>{X||(this.browser_visible=C,C&&this.setButtonsPosition())}),C||B.select(".jsroot_browser_btns").transition().style("left","7px").style("top","7px").duration(I),A.empty()||(A.transition().style("left",v).duration(I),E.transition().style("left",f).duration(I).on("end",this.checkResize.bind(this))),this.status_layout&&"fix"===this.browser_kind&&(B.select(".jsroot_h_separator").transition().style("left",f).duration(I),B.select(".jsroot_status_area").transition().style("left",f).duration(I))}adjustBrowserSize(X){if(!this.gui_div||"float"!==this.browser_kind)return;const B=this.browser();if(B.empty())return;const $=B.select(".jsroot_browser_area"),A=B.select(".jsroot_browser_hierarchy"),E=(0,x.Lt)(A.node().firstChild);if(X)return void($.node().parentNode.clientHeight-10<$.node().clientHeight&&$.style("bottom","0px").style("top","0px"));if(E.empty())return;const g=A.node().clientHeight,v=E.node().clientHeight;void 0!==v&&v<.7*g&&$.style("bottom","")}setButtonsPosition(){if(!this.gui_div)return;const X=this.browser(),B=X.select(".jsroot_browser_btns");if(B.empty())return;let $=7,A=7;if(this.browser_visible){const E=X.select(".jsroot_browser_area");$=E.node().offsetTop+7,A=E.node().offsetLeft-X.node().offsetLeft+E.node().clientWidth-27}B.style("left",`${A}px`).style("top",`${$}px`)}toggleBrowserKind(X){var B=this;return(0,Ee.A)(function*(){if(!B.gui_div)return null;if(!X){if(!B.browser_kind)return null;X="float"===B.browser_kind?"fix":"float"}const $=B.browser(),A=$.select(".jsroot_browser_area");if("float"===B.browser_kind?A.style("bottom","0px").style("top","0px").style("width","").style("height","").classed("jsroot_float_browser",!1).style("border",null):"fix"===B.browser_kind&&($.select(".jsroot_v_separator").remove(),A.style("left","0px"),B.drawing().style("left","0px"),$.select(".jsroot_h_separator").style("left","0px"),B.status().style("left","0px"),B.checkResize()),B.browser_kind=X,B.browser_visible=!0,$.select(".jsroot_browser_resize").style("display","float"===X?null:"none"),$.select(".jsroot_browser_title").style("cursor","float"===X?"move":null),"float"===X){A.style("bottom","40px").classed("jsroot_float_browser",!0).style("border","solid 3px white");const E=(0,x.$E)().on("start",()=>{const v=A.style("left"),f=A.style("top");B._float_left=parseInt(v.slice(0,v.length-2)),B._float_top=parseInt(f.slice(0,f.length-2)),B._max_left=Math.max(0,$.node().clientWidth-A.node().offsetWidth-1),B._max_top=Math.max(0,$.node().clientHeight-A.node().offsetHeight-1)}).filter(v=>$.select(".jsroot_browser_title").node()===v.target).on("drag",v=>{B._float_left+=v.dx,B._float_top+=v.dy,A.style("left",Math.min(Math.max(0,B._float_left),B._max_left)+"px").style("top",Math.min(Math.max(0,B._float_top),B._max_top)+"px"),B.setButtonsPosition()}),g=(0,x.$E)().on("start",()=>{const v=A.style("width");B._float_width=parseInt(v.slice(0,v.length-2)),B._float_height=A.node().clientHeight,B._max_width=$.node().clientWidth-A.node().offsetLeft-1,B._max_height=$.node().clientHeight-A.node().offsetTop-1}).on("drag",v=>{B._float_width+=v.dx,B._float_height+=v.dy,A.style("width",Math.min(Math.max(100,B._float_width),B._max_width)+"px").style("height",Math.min(Math.max(100,B._float_height),B._max_height)+"px"),B.setButtonsPosition()});$.call(E),$.select(".jsroot_browser_resize").call(g),B.adjustBrowserSize()}else{A.style("left","0px").style("top","0px").style("bottom","0px").style("height",null);const E=L.settings.DarkMode?"grey":"azure",g=$.append("div").classed("jsroot_v_separator",!0).attr("style",`pointer-events: all; border: 0; margin: 0; padding: 0; background-color: ${E}; position: absolute; top: 0; bottom: 0; cursor: ew-resize;`),v=(0,x.$E)().on("start",()=>{B._vsepar_move=B._vsepar_position,g.style("background-color","grey")}).on("drag",f=>{B._vsepar_move+=f.dx,B.setButtonsPosition(),L.settings.BrowserWidth=Math.max(50,Math.round(B._vsepar_move)),B.adjustSeparators(L.settings.BrowserWidth,null)}).on("end",()=>{delete B._vsepar_move,g.style("background-color",null),B.checkResize()});g.call(v),L.browser.touches&&!$.on("touchmove")&&$.on("touchmove",()=>{}),B.adjustSeparators(L.settings.BrowserWidth,null,!0,!0)}return B.setButtonsPosition(),B})()}}},7900:(Yr,mt,Se)=>{"use strict";Se.d(mt,{ES:()=>De,Ew:()=>Re,IV:()=>F,sj:()=>J,wh:()=>Y});var Ee=Se(4882),x=Se(8872),L=Se(8362),ve=Se(5992),ke=Se(2985),ot=Se(2586),Ye=Se(4082),Ze=Se(4246);const Re="__front__";class He{constructor(Q,me,X){this.painter=Q,this.menuname=me,(0,x.isObject)(X)&&void 0!==X.clientX&&void 0!==X.clientY&&(this.show_evnt={clientX:X.clientX,clientY:X.clientY,skip_close:X.skip_close}),this.remove_handler=()=>this.remove(),this.element=null,this.cnt=0}native(){return!1}load(){var Q=this;return(0,Ee.A)(function*(){return Q})()}getEventPosition(){return this.show_evnt}add(){throw Error("add() method has to be implemented in the menu")}size(){return this.cnt}remove(){if(this.element){if(this.show_evnt?.skip_close)return void(this.show_evnt.skip_close=0);if(this.element.remove(),this.element=null,(0,x.isFunc)(this.resolveFunc)){const Q=this.resolveFunc;delete this.resolveFunc,Q()}document.body.removeEventListener("click",this.remove_handler)}}show(){throw Error("show() method has to be implemented in the menu class")}addchk(Q,me,X,B,$){let A=B;(0,x.isFunc)(X)&&($=B,B=X,A=E=>B("1"===E),X=Q?"0":"1"),this.add((Q?"chk:":"unk:")+me,X,A,$)}addDrawMenu(Q,me,X,B){if(!me||!me.length)return;let $=!1;if(0===Q.indexOf("nosub:")&&($=!0,Q=Q.slice(6)),1===me.length)return me[0]===x.kInspect&&(Q=Q.replace("Draw","Inspect")),void this.add(Q,me[0],X);$||this.add("sub:"+Q,me[0],X,B);for(let A=1;A<me.length;++A){let E=me[A]||(this._use_plain_text?"<dflt>":"&lt;dflt&gt;"),g=A+1;if(me.length>5)for(;g<me.length&&0===me[g].indexOf(E);)g++;if($&&(E=Q+" "+E),g>=A+2){this.add("sub:"+E,me[A],X);for(let v=A+1;v<g;++v)this.add(me[v],me[v],X);this.add("endsub:"),A=g-1}else if(E===x.kInspect){this.add("sub:"+E,me[A],X,"Inspect object content");for(let v=0;v<10;++v)this.add(v.toString(),x.kInspect+v,X,`Inspect object and expand to level ${v}`);this.add("endsub:")}else this.add(E,me[A],X)}$||(this.add("<input>",()=>{const A=(0,x.isFunc)(this.painter?.getDrawOpt)?this.painter.getDrawOpt():me[0];this.input("Provide draw option",A,"text").then(X)},"Enter draw option in dialog"),this.add("endsub:"))}addColorMenu(Q,me,X,B){if(void 0===me)return;const $=!(0,x.isStr)(me);this.add("sub:"+Q,()=>{this.input("Enter color "+($?"(only id number)":"(name or id)"),me,$?"int":"text",$?0:void 0,$?9999:void 0).then(A=>{const E=parseInt(A);if(Number.isInteger(E)&&(0,ke.oU)(E))A=(0,ke.oU)(E);else if($)return;X($?E:A)})});for(let A=0;A<5;++A){this.add("column:");for(let E=0;E<10;E++){let g=10*A+E;$||--g;let v=g<0?"none":(0,ke.oU)(g);0===g&&1===B&&(v="none"),this.add(`<svg width="50" height="18" style="margin:0px;background-color:${v}">${me===($?g:v)?`<rect width="50" height="18" style="fill:none;stroke-width:3px;stroke:${1===g?"red":"black"}"></rect>`:""}<text x="4" y="12" style='font-size:12px' fill="${1===g?"white":"black"}">${g<=0||"#"!==v[0]?v:`col ${g}`}</text></svg>`,$?g:v,Z=>X($?parseInt(Z):Z),"Select color "+v)}if(this.add("endcolumn:"),!this.native())break}this.add("endsub:")}addSizeMenu(Q,me,X,B,$,A,E){if(void 0===$)return;let g=[],v=!1;if((0,x.isObject)(B))g=B,B=1;else for(let I=me;I<=X;I+=B)g.push(I);const f=I=>Math.abs(I-$)<1e-5*(X-me),C=(I,U)=>(I===$&&v&&(U=!0),I.toFixed(B>=1?0:B>=.1?U?2:1:U?4:2));g.findIndex(f)<0&&(v=!0,g.push($),g=g.sort((I,U)=>I>U)),this.add("sub:"+Q,()=>this.input("Enter value of "+Q,C($,!0),B>=1?"int":"float").then(A),E),g.forEach(I=>this.addchk(f(I),C(I),I,U=>A(B>=1?parseInt(U):parseFloat(U)))),this.add("endsub:")}addPaletteMenu(Q,me){const X=(B,$,A,E)=>{$?A||(A=$):$=`pal ${B}`,A&&(A+=`, code ${B}`),this.addchk(B===Q||E,"<nobr>"+$+"</nobr>",B,me,A||$)};if(this.add("sub:Palette",()=>this.input("Enter palette code [1..113]",Q,"int",1,113).then(me)),this.add("column:"),X(57,"Bird","Default color palette",Q>113),X(55,"Rainbow"),X(51,"Deep Sea"),X(52,"Grayscale","New gray scale"),X(1,"","Old gray scale",Q>0&&Q<10),X(50,"ROOT 5","Default color palette in ROOT 5",Q>=10&&Q<51),X(53,"","Dark body radiator"),X(54,"","Two-color hue"),X(56,"","Inverted dark body radiator"),X(58,"Cubehelix"),X(59,"","Green Red Violet"),X(60,"","Blue Red Yellow"),X(61,"Ocean"),this.add("endcolumn:"),!this.native())return this.add("endsub:");this.add("column:"),X(62,"","Color Printable On Grey"),X(63,"Alpine"),X(64,"Aquamarine"),X(65,"Army"),X(66,"Atlantic"),X(67,"Aurora"),X(68,"Avocado"),X(69,"Beach"),X(70,"Black Body"),X(71,"","Blue Green Yellow"),X(72,"Brown Cyan"),X(73,"CMYK"),X(74,"Candy"),this.add("endcolumn:"),this.add("column:"),X(75,"Cherry"),X(76,"Coffee"),X(77,"","Dark Rain Bow"),X(78,"","Dark Terrain"),X(79,"Fall"),X(80,"Fruit Punch"),X(81,"Fuchsia"),X(82,"Grey Yellow"),X(83,"","Green Brown Terrain"),X(84,"Green Pink"),X(85,"Island"),X(86,"Lake"),X(87,"","Light Temperature"),this.add("endcolumn:"),this.add("column:"),X(88,"","Light Terrain"),X(89,"Mint"),X(90,"Neon"),X(91,"Pastel"),X(92,"Pearl"),X(93,"Pigeon"),X(94,"Plum"),X(95,"Red Blue"),X(96,"Rose"),X(97,"Rust"),X(98,"","Sandy Terrain"),X(99,"Sienna"),X(100,"Solar"),this.add("endcolumn:"),this.add("column:"),X(101,"","South West"),X(102,"","Starry Night"),X(103,"","Sunset"),X(104,"","Temperature Map"),X(105,"","Thermometer"),X(106,"Valentine"),X(107,"","Visible Spectrum"),X(108,"","Water Melon"),X(109,"Cool"),X(110,"Copper"),X(111,"","Gist Earth"),X(112,"Viridis"),X(113,"Cividis"),this.add("endcolumn:"),this.add("endsub:")}addRebinMenu(Q){this.add("sub:Rebin",()=>this.input("Enter rebin value",2,"int",2).then(Q));for(let me=2;me<=7;me++)this.add(me.toString(),me,X=>Q(parseInt(X)));this.add("endsub:")}addSelectMenu(Q,me,X,B){const $="number"==typeof X;this.add("sub:"+Q);for(let A=0;A<me.length;++A)this.addchk($?A===X:me[A]===X,me[A],$?A:me[A],E=>B($?Number.parseInt(E):E));this.add("endsub:")}addRColorMenu(Q,me,X){const B=["default","black","white","red","green","blue","yellow","magenta","cyan"];this.add("sub:"+Q,()=>{this.input("Enter color name - empty string will reset color",me).then(X)});let $="black";for(let A=0;A<B.length;++A){const E=B[A];let g=!1,v="";A>0?(v="background-color:"+E,$="white"===E?"black":"white",(0,x.isStr)(me)&&me&&"auto"!==me&&"["!==me[0]&&(g=(0,L.Qh)(me).toString()===(0,L.Qh)(E).toString())):g=!me,this.addchk(g,`<svg width='100' height='18' style='margin:0px;${v}'><text x='4' y='12' style='font-size:12px' fill='${$}'>${E}</text></svg>`,E,C=>X("default"===C?null:C))}this.add("endsub:")}addRAttrTextItems(Q,me,X){me||(me={}),this.addRColorMenu("color",Q.color,B=>X({name:"color",value:B})),Q.scaled?this.addSizeMenu("size",.01,.1,.01,Q.size/Q.scale,B=>X({name:"size",value:B})):this.addSizeMenu("size",6,20,2,Q.size,B=>X({name:"size",value:B})),this.addSelectMenu("family",["Arial","Times New Roman","Courier New","Symbol"],Q.name,B=>X({name:"font_family",value:B})),this.addSelectMenu("style",["normal","italic","oblique"],Q.style||"normal",B=>X({name:"font_style",value:"normal"===B?null:B})),this.addSelectMenu("weight",["normal","lighter","bold","bolder"],Q.weight||"normal",B=>X({name:"font_weight",value:"normal"===B?null:B})),me.noalign||this.add("align"),me.noangle||this.add("angle")}addLineStyleMenu(Q,me,X){this.add("sub:"+Q,()=>this.input("Enter line style id (1-solid)",me,"int",1,11).then(B=>{(0,Ye.Ov)(B)&&X(B)}));for(let B=1;B<11;++B){const $=(0,Ye.Ov)(B);this.addchk(me===B,`<svg width='100' height='14'><text x='2' y='13' style='font-size:12px'>${B}</text><line x1='30' y1='7' x2='100' y2='7' stroke='black' stroke-width='3' stroke-dasharray='${$}'></line></svg>`,B,E=>X(parseInt(E)))}this.add("endsub:")}addFillStyleMenu(Q,me,X,B,$){this.add("sub:"+Q,()=>{this.input("Enter fill style id (1001-solid, 3000..3010)",me,"int",0,4e3).then(E=>{E>=0&&E<=4e3&&$(E)})});const A=[1,1001,3001,3002,3003,3004,3005,3006,3007,3010,3021,3022];for(let E=0;E<A.length;++E){let g=A[E];if(B){const v=B.createAttFill({std:!1,pattern:A[E],color:X||1});g=`<svg width='100' height='18'><text x='1' y='12' style='font-size:12px'>${A[E].toString()}</text><rect x='40' y='0' width='60' height='18' stroke='none' fill='${v.getFillColor()}'></rect></svg>`}this.addchk(me===A[E],g,A[E],v=>$(parseInt(v)))}this.add("endsub:")}addFontMenu(Q,me,X){const B=me&&Number.isInteger(me)?me%10:2;this.add("sub:"+Q,()=>{this.input("Enter font id from [0..20]",Math.floor(me/10),"int",0,20).then(A=>{A>=0&&A<=20&&X(10*A+B)})}),this.add("column:");const $=(0,x.getDocument)();for(let A=1;A<20;++A){const E=10*A+B,g=new Ze.qg(E,14),v=(0,L.Lt)($.createElementNS("http://www.w3.org/2000/svg","text"));let f=g.getFontName(),C="";g.weight&&(C+="b",f+=" "+g.weight),g.style&&(C+=g.style[0],f+=" "+g.style),C&&(C=" "+C),v.attr("x",1).attr("y",15).text(f.split(" ")[0]+C),g.setFont(v);const I=me!==E?"":"<rect width='90' height='18' style='fill:none;stroke:black'></rect>",U=`<svg width='90' height='18'>${v.node().outerHTML}${I}</svg>`;this.add(U,E,k=>X(parseInt(k)),`${E}: ${f}`),10===A&&(this.add("endcolumn:"),this.add("column:"))}this.add("endcolumn:"),this.add("endsub:")}addAlignMenu(Q,me,X){this.add(`sub:${Q}`,()=>{this.input("Enter align like 12 or 31",me).then(A=>{const E=parseInt(A);if(E<11||E>33)return;const g=Math.floor(E/10),v=E%10;g>0&&g<4&&v>0&&v<4&&X(E)})});const B=["left","middle","right"],$=["bottom","centered","top"];for(let A=1;A<4;++A)for(let E=1;E<4;++E)this.addchk(10*A+E===me,`${10*A+E}: ${B[A-1]} ${$[A-1]}`,10*A+E,g=>X(parseInt(g)));this.add("endsub:")}addAttributesMenu(Q,me){if(me||(me=""),Q.lineatt?.used&&(this.add(`sub:${me}Line att`),this.addSizeMenu("width",1,10,1,Q.lineatt.width,X=>{Q.lineatt.change(void 0,X),Q.interactiveRedraw(!0,`exec:SetLineWidth(${X})`)}),this.addColorMenu("color",Q.lineatt.color,X=>{Q.lineatt.change(X),Q.interactiveRedraw(!0,(0,ve.pp)(X,"SetLineColor"))}),this.addLineStyleMenu("style",Q.lineatt.style,X=>{Q.lineatt.change(void 0,void 0,X),Q.interactiveRedraw(!0,`exec:SetLineStyle(${X})`)}),this.add("endsub:"),Q.lineatt?.excl_side)){this.add("sub:Exclusion"),this.add("sub:side");for(let X=-1;X<=1;++X)this.addchk(Q.lineatt.excl_side===X,X,X,B=>{Q.lineatt.changeExcl(parseInt(B)),Q.interactiveRedraw()});this.add("endsub:"),this.addSizeMenu("width",10,100,10,Q.lineatt.excl_width,X=>{Q.lineatt.changeExcl(void 0,X),Q.interactiveRedraw()}),this.add("endsub:")}if(Q.fillatt?.used&&(this.add(`sub:${me}Fill att`),this.addColorMenu("color",Q.fillatt.colorindx,X=>{Q.fillatt.change(X,void 0,Q.getCanvSvg()),Q.interactiveRedraw(!0,(0,ve.pp)(X,"SetFillColor"))},Q.fillatt.kind),this.addFillStyleMenu("style",Q.fillatt.pattern,Q.fillatt.colorindx,Q,X=>{Q.fillatt.change(void 0,X,Q.getCanvSvg()),Q.interactiveRedraw(!0,`exec:SetFillStyle(${X})`)}),this.add("endsub:")),Q.markeratt?.used){this.add(`sub:${me}Marker att`),this.addColorMenu("color",Q.markeratt.color,B=>{Q.markeratt.change(B),Q.interactiveRedraw(!0,(0,ve.pp)(B,"SetMarkerColor"))}),this.addSizeMenu("size",.5,6,.5,Q.markeratt.size,B=>{Q.markeratt.change(void 0,void 0,B),Q.interactiveRedraw(!0,`exec:SetMarkerSize(${B})`)}),this.add("sub:style");const X=[1,2,3,4,5,6,7,8,21,22,23,24,25,26,27,28,29,30,31,32,33,34];for(let B=0;B<X.length;++B){const $=new ot.e({style:X[B],color:Q.markeratt.color,size:1.7}),A=`<svg width='60' height='18'><text x='1' y='12' style='font-size:12px'>${X[B].toString()}</text><path stroke='black' fill='${$.fill?"black":"none"}' d='${$.create(40,8)}'></path></svg>`;this.addchk(Q.markeratt.style===X[B],A,X[B],E=>{Q.markeratt.change(void 0,parseInt(E)),Q.interactiveRedraw(!0,`exec:SetMarkerStyle(${E})`)})}this.add("endsub:"),this.add("endsub:")}if(Q.textatt?.used){this.add(`sub:${me}Text att`),this.addFontMenu("font",Q.textatt.font,B=>{Q.textatt.change(B),Q.interactiveRedraw(!0,`exec:SetTextFont(${B})`)});const X=Q.textatt.size<1;this.addSizeMenu("size",X?.03:6,X?.2:26,X?.01:2,Q.textatt.size,B=>{Q.textatt.change(void 0,parseFloat(B)),Q.interactiveRedraw(!0,`exec:SetTextSize(${B})`)}),this.addColorMenu("color",Q.textatt.color,B=>{Q.textatt.change(void 0,void 0,B),Q.interactiveRedraw(!0,(0,ve.pp)(B,"SetTextColor"))}),this.addAlignMenu("align",Q.textatt.align,B=>{Q.textatt.change(void 0,void 0,void 0,B),Q.interactiveRedraw(!0,`exec:SetTextAlign(${B})`)}),this.addSizeMenu("angle",-180,180,45,Q.textatt.angle,B=>{Q.textatt.change(void 0,void 0,void 0,void 0,parseFloat(B)),Q.interactiveRedraw(!0,`exec:SetTextAngle(${B})`)}),this.add("endsub:")}}addTAxisMenu(Q,me,X,B){const $=X._typename===x.clTGaxis;this.add("Divisions",()=>this.input("Set Ndivisions",X.fNdivisions,"int",0).then(E=>{X.fNdivisions=E,me.interactiveRedraw("pad",`exec:SetNdivisions(${E})`,B)})),this.add("sub:Labels"),this.addchk(X.TestBit(Q.kCenterLabels),"Center",E=>{X.InvertBit(Q.kCenterLabels),me.interactiveRedraw("pad",`exec:CenterLabels(${E})`,B)}),this.addchk(X.TestBit(Q.kLabelsVert),"Rotate",E=>{X.InvertBit(Q.kLabelsVert),me.interactiveRedraw("pad",`exec:SetBit(TAxis::kLabelsVert,${E})`,B)}),this.addColorMenu("Color",X.fLabelColor,E=>{X.fLabelColor=E,me.interactiveRedraw("pad",(0,ve.pp)(E,"SetLabelColor"),B)}),this.addSizeMenu("Offset",-.02,.1,.01,X.fLabelOffset,E=>{X.fLabelOffset=E,me.interactiveRedraw("pad",`exec:SetLabelOffset(${E})`,B)});let A=X.fLabelSize>=1;this.addSizeMenu("Size",A?2:.02,A?30:.11,A?2:.01,X.fLabelSize,E=>{X.fLabelSize=E,me.interactiveRedraw("pad",`exec:SetLabelSize(${E})`,B)}),this.add("endsub:"),this.add("sub:Title"),this.add("SetTitle",()=>{this.input("Enter axis title",X.fTitle).then(E=>{X.fTitle=E,me.interactiveRedraw("pad",`exec:SetTitle("${E}")`,B)})}),this.addchk(X.TestBit(Q.kCenterTitle),"Center",E=>{X.InvertBit(Q.kCenterTitle),me.interactiveRedraw("pad",`exec:CenterTitle(${E})`,B)}),this.addchk(X.TestBit(Q.kOppositeTitle),"Opposite",()=>{X.InvertBit(Q.kOppositeTitle),me.redrawPad()}),this.addchk(X.TestBit(Q.kRotateTitle),"Rotate",E=>{X.InvertBit(Q.kRotateTitle),me.interactiveRedraw("pad",$?`exec:SetBit(TAxis::kRotateTitle, ${E})`:`exec:RotateTitle(${E})`,B)}),$?this.addColorMenu("Color",X.fTextColor,E=>{X.fTextColor=E,me.interactiveRedraw("pad",(0,ve.pp)(E,"SetTitleColor"),B)}):this.addColorMenu("Color",X.fTitleColor,E=>{X.fTitleColor=E,me.interactiveRedraw("pad",(0,ve.pp)(E,"SetTitleColor"),B)}),this.addSizeMenu("Offset",0,3,.2,X.fTitleOffset,E=>{X.fTitleOffset=E,me.interactiveRedraw("pad",`exec:SetTitleOffset(${E})`,B)}),A=X.fTitleSize>=1,this.addSizeMenu("Size",A?2:.02,A?30:.11,A?2:.01,X.fTitleSize,E=>{X.fTitleSize=E,me.interactiveRedraw("pad",`exec:SetTitleSize(${E})`,B)}),this.add("endsub:"),this.add("sub:Ticks"),$?(this.addColorMenu("Color",X.fLineColor,E=>{X.fLineColor=E,me.interactiveRedraw("pad",(0,ve.pp)(E,"SetLineColor"),B)}),this.addSizeMenu("Size",-.05,.055,.01,X.fTickSize,E=>{X.fTickSize=E,me.interactiveRedraw("pad",`exec:SetTickLength(${E})`,B)})):(this.addColorMenu("Color",X.fAxisColor,E=>{X.fAxisColor=E,me.interactiveRedraw("pad",(0,ve.pp)(E,"SetAxisColor"),B)}),this.addSizeMenu("Size",-.05,.055,.01,X.fTickLength,E=>{X.fTickLength=E,me.interactiveRedraw("pad",`exec:SetTickLength(${E})`,B)})),this.add("endsub:"),$&&this.add("Options",()=>this.input("Enter TGaxis options like +L or -G",X.fChopt,"string").then(E=>{X.fChopt=E,me.interactiveRedraw("pad",`exec:SetOption("${E}")`,B)}))}addSettingsMenu(Q,me,X){this.add(me?"header:Settings":"sub:Settings"),this.add("sub:Files"),Q&&(this.addchk(x.settings.OnlyLastCycle,"Last cycle",A=>{x.settings.OnlyLastCycle=A,X&&X("refresh")}),this.addchk(!x.settings.SkipStreamerInfos,"Streamer infos",A=>{x.settings.SkipStreamerInfos=!A,X&&X("refresh")})),this.addchk(x.settings.UseStamp,"Use stamp arg",A=>{x.settings.UseStamp=A}),this.addSizeMenu("Max ranges",1,1e3,[1,10,20,50,200,1e3],x.settings.MaxRanges,A=>{x.settings.MaxRanges=A},"Maximal number of ranges in single http request"),this.addchk(x.settings.HandleWrongHttpResponse,"Handle wrong http response",A=>{x.settings.HandleWrongHttpResponse=A}),this.addchk(x.settings.WithCredentials,"With credentials",A=>{x.settings.WithCredentials=A},"Submit http request with user credentials"),this.add("endsub:"),this.add("sub:Toolbar"),this.addchk(!1===x.settings.ToolBar,"Off",A=>{x.settings.ToolBar=!A}),this.addchk(!0===x.settings.ToolBar,"On",A=>{x.settings.ToolBar=A}),this.addchk("popup"===x.settings.ToolBar,"Popup",A=>{x.settings.ToolBar=!!A&&"popup"}),this.add("separator"),this.addchk("left"===x.settings.ToolBarSide,"Left side",A=>{x.settings.ToolBarSide=A?"left":"right"}),this.addchk(x.settings.ToolBarVert,"Vertical",A=>{x.settings.ToolBarVert=A}),this.add("endsub:"),this.add("sub:Interactive"),this.addchk(x.settings.Tooltip,"Tooltip",A=>{x.settings.Tooltip=A}),this.addchk(x.settings.ContextMenu,"Context menus",A=>{x.settings.ContextMenu=A}),this.add("sub:Zooming"),this.addchk(x.settings.Zooming,"Global",A=>{x.settings.Zooming=A}),this.addchk(x.settings.ZoomMouse,"Mouse",A=>{x.settings.ZoomMouse=A}),this.addchk(x.settings.ZoomWheel,"Wheel",A=>{x.settings.ZoomWheel=A}),this.addchk(x.settings.ZoomTouch,"Touch",A=>{x.settings.ZoomTouch=A}),this.add("endsub:"),this.addchk(x.settings.HandleKeys,"Keypress handling",A=>{x.settings.HandleKeys=A}),this.addchk(x.settings.MoveResize,"Move and resize",A=>{x.settings.MoveResize=A}),this.addchk(x.settings.DragAndDrop,"Drag and drop",A=>{x.settings.DragAndDrop=A}),this.addchk(x.settings.DragGraphs,"Drag graph points",A=>{x.settings.DragGraphs=A}),this.addSelectMenu("Progress box",["off","on","modal"],(0,x.isStr)(x.settings.ProgressBox)?x.settings.ProgressBox:x.settings.ProgressBox?"on":"off",A=>{x.settings.ProgressBox="off"!==A&&(" on"===A||A)}),this.add("endsub:"),this.add("sub:Drawing"),this.addSelectMenu("Optimize",["None","Smart","Always"],x.settings.OptimizeDraw,A=>{x.settings.OptimizeDraw=A}),this.addPaletteMenu(x.settings.Palette,A=>{x.settings.Palette=A}),this.addchk(x.settings.AutoStat,"Auto stat box",A=>{x.settings.AutoStat=A}),this.addSelectMenu("Latex",["Off","Symbols","Normal","MathJax","Force MathJax"],x.settings.Latex,A=>{x.settings.Latex=A}),this.addSelectMenu("3D rendering",["Default","WebGL","Image"],x.settings.Render3D,A=>{x.settings.Render3D=A}),this.addSelectMenu("WebGL embeding",["Default","Overlay","Embed"],x.settings.Embed3D,A=>{x.settings.Embed3D=A}),this.add("endsub:"),this.add("sub:Geometry"),this.add("Grad per segment:  "+x.settings.GeoGradPerSegm,()=>this.input("Grad per segment in geometry",x.settings.GeoGradPerSegm,"int",1,60).then(A=>{x.settings.GeoGradPerSegm=A})),this.addchk(x.settings.GeoCompressComp,"Compress composites",A=>{x.settings.GeoCompressComp=A}),this.add("endsub:"),Q&&(this.add("sub:Browser"),this.add("Hierarchy limit:  "+x.settings.HierarchyLimit,()=>this.input("Max number of items in hierarchy",x.settings.HierarchyLimit,"int",10,1e5).then(A=>{x.settings.HierarchyLimit=A,X&&X("refresh")})),this.add("Browser width:  "+x.settings.BrowserWidth,()=>this.input("Browser width in px",x.settings.BrowserWidth,"int",50,2e3).then(A=>{x.settings.BrowserWidth=A,X&&X("width")})),this.add("endsub:")),this.add("Dark mode: "+(x.settings.DarkMode?"On":"Off"),()=>{x.settings.DarkMode=!x.settings.DarkMode,X&&X("dark")});const B=A=>{x.gStyle[A.slice(1)]=parseInt(A[0])},$=(A,E,g)=>{this.add("sub:"+A);for(let v=0;v<g.length;++v)this.addchk(x.gStyle[E]===v,g[v],`${v}${E}`,B);this.add("endsub:")};this.add("sub:gStyle"),this.add("sub:Canvas"),this.addColorMenu("Color",x.gStyle.fCanvasColor,A=>{x.gStyle.fCanvasColor=A}),this.addchk(x.gStyle.fOptDate,"Draw date",A=>{x.gStyle.fOptDate=A?1:0}),this.addchk(x.gStyle.fOptFile,"Draw item",A=>{x.gStyle.fOptFile=A?1:0}),this.addSizeMenu("Date X",.01,.1,.01,x.gStyle.fDateX,A=>{x.gStyle.fDateX=A},"configure gStyle.fDateX for date/item name drawings"),this.addSizeMenu("Date Y",.01,.1,.01,x.gStyle.fDateY,A=>{x.gStyle.fDateY=A},"configure gStyle.fDateY for date/item name drawings"),this.add("endsub:"),this.add("sub:Pad"),this.addColorMenu("Color",x.gStyle.fPadColor,A=>{x.gStyle.fPadColor=A}),this.add("sub:Grid"),this.addchk(x.gStyle.fPadGridX,"X",A=>{x.gStyle.fPadGridX=A}),this.addchk(x.gStyle.fPadGridY,"Y",A=>{x.gStyle.fPadGridY=A}),this.addColorMenu("Color",x.gStyle.fGridColor,A=>{x.gStyle.fGridColor=A}),this.addSizeMenu("Width",1,10,1,x.gStyle.fGridWidth,A=>{x.gStyle.fGridWidth=A}),this.addLineStyleMenu("Style",x.gStyle.fGridStyle,A=>{x.gStyle.fGridStyle=A}),this.add("endsub:"),$("Ticks X","fPadTickX",["normal","ticks on both sides","labels on both sides"]),$("Ticks Y","fPadTickY",["normal","ticks on both sides","labels on both sides"]),$("Log X","fOptLogx",["off","on","log 2"]),$("Log Y","fOptLogy",["off","on","log 2"]),$("Log Z","fOptLogz",["off","on","log 2"]),this.add("endsub:"),this.add("sub:Frame"),this.addColorMenu("Fill color",x.gStyle.fFrameFillColor,A=>{x.gStyle.fFrameFillColor=A}),this.addFillStyleMenu("Fill style",x.gStyle.fFrameFillStyle,x.gStyle.fFrameFillColor,null,A=>{x.gStyle.fFrameFillStyle=A}),this.addColorMenu("Line color",x.gStyle.fFrameLineColor,A=>{x.gStyle.fFrameLineColor=A}),this.addSizeMenu("Line width",1,10,1,x.gStyle.fFrameLineWidth,A=>{x.gStyle.fFrameLineWidth=A}),this.addLineStyleMenu("Line style",x.gStyle.fFrameLineStyle,A=>{x.gStyle.fFrameLineStyle=A}),this.addSizeMenu("Border size",0,10,1,x.gStyle.fFrameBorderSize,A=>{x.gStyle.fFrameBorderSize=A}),this.add("sub:Margins"),this.addSizeMenu("Bottom",0,.5,.05,x.gStyle.fPadBottomMargin,A=>{x.gStyle.fPadBottomMargin=A}),this.addSizeMenu("Top",0,.5,.05,x.gStyle.fPadTopMargin,A=>{x.gStyle.fPadTopMargin=A}),this.addSizeMenu("Left",0,.5,.05,x.gStyle.fPadLeftMargin,A=>{x.gStyle.fPadLeftMargin=A}),this.addSizeMenu("Right",0,.5,.05,x.gStyle.fPadRightMargin,A=>{x.gStyle.fPadRightMargin=A}),this.add("endsub:"),this.add("endsub:"),this.add("sub:Title"),this.addColorMenu("Fill color",x.gStyle.fTitleColor,A=>{x.gStyle.fTitleColor=A}),this.addFillStyleMenu("Fill style",x.gStyle.fTitleStyle,x.gStyle.fTitleColor,null,A=>{x.gStyle.fTitleStyle=A}),this.addColorMenu("Text color",x.gStyle.fTitleTextColor,A=>{x.gStyle.fTitleTextColor=A}),this.addSizeMenu("Border size",0,10,1,x.gStyle.fTitleBorderSize,A=>{x.gStyle.fTitleBorderSize=A}),this.addSizeMenu("Font size",.01,.1,.01,x.gStyle.fTitleFontSize,A=>{x.gStyle.fTitleFontSize=A}),this.addFontMenu("Font",x.gStyle.fTitleFont,A=>{x.gStyle.fTitleFont=A}),this.addSizeMenu("X: "+x.gStyle.fTitleX.toFixed(2),0,1,.1,x.gStyle.fTitleX,A=>{x.gStyle.fTitleX=A}),this.addSizeMenu("Y: "+x.gStyle.fTitleY.toFixed(2),0,1,.1,x.gStyle.fTitleY,A=>{x.gStyle.fTitleY=A}),this.addSizeMenu("W: "+x.gStyle.fTitleW.toFixed(2),0,1,.1,x.gStyle.fTitleW,A=>{x.gStyle.fTitleW=A}),this.addSizeMenu("H: "+x.gStyle.fTitleH.toFixed(2),0,1,.1,x.gStyle.fTitleH,A=>{x.gStyle.fTitleH=A}),this.add("endsub:"),this.add("sub:Stat box"),this.addColorMenu("Fill color",x.gStyle.fStatColor,A=>{x.gStyle.fStatColor=A}),this.addFillStyleMenu("Fill style",x.gStyle.fStatStyle,x.gStyle.fStatColor,null,A=>{x.gStyle.fStatStyle=A}),this.addColorMenu("Text color",x.gStyle.fStatTextColor,A=>{x.gStyle.fStatTextColor=A}),this.addSizeMenu("Border size",0,10,1,x.gStyle.fStatBorderSize,A=>{x.gStyle.fStatBorderSize=A}),this.addSizeMenu("Font size",0,30,5,x.gStyle.fStatFontSize,A=>{x.gStyle.fStatFontSize=A}),this.addFontMenu("Font",x.gStyle.fStatFont,A=>{x.gStyle.fStatFont=A}),this.add("Stat format",()=>this.input("Stat format",x.gStyle.fStatFormat).then(A=>{x.gStyle.fStatFormat=A})),this.addSizeMenu("X: "+x.gStyle.fStatX.toFixed(2),.2,1,.1,x.gStyle.fStatX,A=>{x.gStyle.fStatX=A}),this.addSizeMenu("Y: "+x.gStyle.fStatY.toFixed(2),.2,1,.1,x.gStyle.fStatY,A=>{x.gStyle.fStatY=A}),this.addSizeMenu("Width: "+x.gStyle.fStatW.toFixed(2),.1,1,.1,x.gStyle.fStatW,A=>{x.gStyle.fStatW=A}),this.addSizeMenu("Height: "+x.gStyle.fStatH.toFixed(2),.1,1,.1,x.gStyle.fStatH,A=>{x.gStyle.fStatH=A}),this.add("endsub:"),this.add("sub:Legend"),this.addColorMenu("Fill color",x.gStyle.fLegendFillColor,A=>{x.gStyle.fLegendFillColor=A}),this.addSizeMenu("Border size",0,10,1,x.gStyle.fLegendBorderSize,A=>{x.gStyle.fLegendBorderSize=A}),this.addFontMenu("Font",x.gStyle.fLegendFont,A=>{x.gStyle.fLegendFont=A}),this.addSizeMenu("Text size",0,.1,.01,x.gStyle.fLegendTextSize,A=>{x.gStyle.fLegendTextSize=A},"legend text size, when 0 - auto adjustment is used"),this.add("endsub:"),this.add("sub:Histogram"),this.addchk(1===x.gStyle.fOptTitle,"Hist title",A=>{x.gStyle.fOptTitle=A?1:0}),this.addchk(x.gStyle.fOrthoCamera,"Orthographic camera",A=>{x.gStyle.fOrthoCamera=A}),this.addchk(x.gStyle.fHistMinimumZero,"Base0",A=>{x.gStyle.fHistMinimumZero=A},"when true, BAR and LEGO drawing using base = 0"),this.add("Text format",()=>this.input("Paint text format",x.gStyle.fPaintTextFormat).then(A=>{x.gStyle.fPaintTextFormat=A})),this.add("Time offset",()=>this.input("Time offset in seconds, default is 788918400 for 1/1/1995",x.gStyle.fTimeOffset,"int").then(A=>{x.gStyle.fTimeOffset=A})),this.addSizeMenu("ErrorX: "+x.gStyle.fErrorX.toFixed(2),0,1,.1,x.gStyle.fErrorX,A=>{x.gStyle.fErrorX=A}),this.addSizeMenu("End error",0,12,1,x.gStyle.fEndErrorSize,A=>{x.gStyle.fEndErrorSize=A},"size in pixels of end error for E1 draw options, gStyle.fEndErrorSize"),this.addSizeMenu("Top margin",0,.5,.05,x.gStyle.fHistTopMargin,A=>{x.gStyle.fHistTopMargin=A},"Margin between histogram top and frame top"),this.addColorMenu("Fill color",x.gStyle.fHistFillColor,A=>{x.gStyle.fHistFillColor=A}),this.addFillStyleMenu("Fill style",x.gStyle.fHistFillStyle,x.gStyle.fHistFillColor,null,A=>{x.gStyle.fHistFillStyle=A}),this.addColorMenu("Line color",x.gStyle.fHistLineColor,A=>{x.gStyle.fHistLineColor=A}),this.addSizeMenu("Line width",1,10,1,x.gStyle.fHistLineWidth,A=>{x.gStyle.fHistLineWidth=A}),this.addLineStyleMenu("Line style",x.gStyle.fHistLineStyle,A=>{x.gStyle.fHistLineStyle=A}),this.add("endsub:"),this.add("separator"),this.add("sub:Predefined"),["Modern","Plain","Bold"].forEach(A=>this.addchk(x.gStyle.fName===A,A,A,ve.Jb)),this.add("endsub:"),this.add("endsub:"),this.add("separator"),this.add("Save settings",()=>{((0,ve.sb)(!0)?Promise.resolve(!0):this.confirm("Save settings","Pressing OK one agreess that JSROOT will store settings as browser cookies")).then(E=>{E&&((0,ve.DZ)(),(0,ve.PL)())})},"Store settings and gStyle as cookies"),this.add("Delete settings",()=>{(0,ve.DZ)(-1),(0,ve.PL)(-1)},"Delete settings and gStyle from cookies"),me||this.add("endsub:")}runModal(){return(0,Ee.A)(function*(){throw Error("runModal() must be reimplemented")})()}info(Q,me){return this.runModal(Q,`<p>${me}</p>`,{height:120,width:400,resizable:!0})}confirm(Q,me){var X=this;return(0,Ee.A)(function*(){return X.runModal(Q,me,{btns:!0,height:120,width:400}).then(B=>!!B)})()}input(Q,me,X,B,$){var A=this;return(0,Ee.A)(function*(){X||(X="text");let g="";null==me&&(me=""),"int"===X&&(void 0!==B&&(g+=` min="${B}"`),void 0!==$&&(g+=` max="${$}"`));const v=`<form><fieldset style="padding:0; border:0"><input type="${"int"===X?"number":"text"}" value="${me}" ${g} style="width:98%;display:block" class="jsroot_dlginp"/></fieldset></form>`;return new Promise(f=>{A.runModal(Q,v,{btns:!0,height:150,width:400}).then(C=>{if(!C)return;let I=C.querySelector(".jsroot_dlginp").value;"float"===X?(I=parseFloat(I),Number.isFinite(I)&&f(I)):"int"===X?(I=parseInt(I),Number.isInteger(I)&&f(I)):f(I)})})})()}showMethodArgsDialog(Q){var me=this;return(0,Ee.A)(function*(){const X=me.menuname+"_dialog";let B='<form> <fieldset style="padding:0; border:0">';for(let $=0;$<Q.fArgs.length;++$){const A=Q.fArgs[$];A.fValue=A.fDefault,'""'===A.fValue&&(A.fValue=""),B+=`<label for="${X}_inp${$}">${A.fName}</label>\n                          <input type='text' tabindex="${$+1}" id="${X}_inp${$}" value="${A.fValue}" style="width:100%;display:block"/>`}return B+="</fieldset></form>",new Promise($=>{me.runModal(Q.fClassName+"::"+Q.fName,B,{btns:!0,height:100+60*Q.fArgs.length,width:400,resizable:!0}).then(A=>{if(!A)return;let E="";for(let g=0;g<Q.fArgs.length;++g){const v=Q.fArgs[g];let f=A.querySelector(`#${X}_inp${g}`).value;""===f&&(f=v.fDefault),("Option_t*"===v.fTitle||"const char*"===v.fTitle)&&(f||(f='""'),'"'!==f[0]&&(f='"'+f),'"'!==f[f.length-1]&&(f+='"')),E+=(g>0?",":"")+f}$(E)})})})()}showCommandArgsDialog(Q,me){var X=this;return(0,Ee.A)(function*(){const B=X.menuname+"_dialog";let $='<form> <fieldset style="padding:0; border:0">';for(let A=0;A<me.length;++A)$+=`<label for="${B}_inp${A}">arg${A+1}</label><input type='text' id="${B}_inp${A}" value="${me[A]}" style="width:100%;display:block"/>`;return $+="</fieldset></form>",new Promise(A=>{X.runModal("Arguments for command "+Q,$,{btns:!0,height:110+60*me.length,width:400,resizable:!0}).then(E=>{if(!E)return A(null);const g=[];for(let v=0;v<me.length;++v)g.push(E.querySelector(`#${B}_inp${v}`).value);A(g)})})})()}}class Ve extends He{constructor(Q,me,X){super(Q,me,X),this.code=[],this._use_plain_text=!0,this.stack=[this.code]}native(){return!0}load(){var Q=this;return(0,Ee.A)(function*(){return Q})()}add(Q,me,X,B){let $=this.stack[this.stack.length-1];if("separator"===Q)return $.push({divider:!0});if(0===Q.indexOf("header:"))return $.push({text:Q.slice(7),header:!0});if("endsub:"===Q)return this.stack.pop(),$=this.stack[this.stack.length-1],void(0===$[$.length-1].sub.length&&($[$.length-1].sub=void 0));if("endcolumn:"===Q)return this.stack.pop();(0,x.isFunc)(me)&&(B=X,X=me,me=Q);const A={};if($.push(A),"column:"===Q)return A.column=!0,A.sub=[],void this.stack.push(A.sub);0===Q.indexOf("sub:")&&(Q=Q.slice(4),A.sub=[],this.stack.push(A.sub)),0===Q.indexOf("chk:")?(A.checked=!0,Q=Q.slice(4)):0===Q.indexOf("unk:")&&(A.checked=!1,Q=Q.slice(4)),A.text=Q,A.title=B,A.arg=me,A.func=X}size(){return this.code.length}_buildContextmenu(Q,me,X,B){const $=(0,x.getDocument)(),A=$.createElement("div"),E="position: absolute; top: 0; user-select: none; z-index: 100000; background-color: rgb(250, 250, 250); margin: 0; padding: 0px; width: auto;min-width: 100px; box-shadow: 0px 0px 10px rgb(0, 0, 0, 0.2); border: 3px solid rgb(215, 215, 215); font-family: Arial, helvetica, sans-serif, serif;font-size: 13px; color: rgb(0, 0, 0, 0.8); line-height: 15px;";if(B===$.body){const I=$.getElementsByClassName("jsroot_ctxt_container");for(;I.length>0;)I[0].parentNode.removeChild(I[0]);A.className="jsroot_ctxt_container",A.style=E,A.style.position="fixed",A.style.left=me+"px",A.style.top=X+"px"}else me<0&&X===me?(A.className="jsroot_ctxt_column",A.style.float="left",A.style.width=(100/-me).toFixed(1)+"%"):(A.className="jsroot_ctxt_container",A.style=E,A.style.left=-B.offsetLeft+B.offsetWidth+"px");let g=!1,v=0;Q.forEach(I=>{I.checked&&(g=!0),I.column&&v++}),Q.forEach(I=>{if(v>0)return A.style.display="flex",void(I.column&&this._buildContextmenu(I.sub,-v,-v,A));if(I.divider){const he=$.createElement("hr");return he.style="width: 85%; margin: 3px auto; border: 1px solid rgb(0, 0, 0, 0.15)",void A.appendChild(he)}const U=$.createElement("div");if(U.style.position="relative",A.appendChild(U),I.header)return U.style="background-color: lightblue; padding: 3px 7px; font-weight: bold; border-bottom: 1px;",void(U.innerHTML=I.text);const k=$.createElement("div");k.style.width="100%",k.style.height="100%",k.style.display="flex",k.style.justifyContent="space-between",k.style.cursor="pointer",I.title&&k.setAttribute("title",I.title),U.appendChild(k),I.text||(I.text="item");const Z=$.createElement("div");if(Z.style="margin: 0; padding: 3px 7px; pointer-events: none; white-space: nowrap",I.text.indexOf("<svg")>=0)if(g){Z.style.display="flex";const he=$.createElement("span");he.innerHTML=I.checked?"\u2713":"",he.style.display="inline-block",he.style.width="1em",Z.appendChild(he);const G=$.createElement("div");G.innerHTML=I.text,Z.appendChild(G)}else Z.innerHTML=I.text;else{if(g){const G=$.createElement("span");G.innerHTML=I.checked?"\u2713":"",G.style.display="inline-block",G.style.width="1em",Z.appendChild(G)}const he=$.createElement("span");he.textContent=0===I.text.indexOf("<nobr>")?I.text.slice(6,I.text.length-7):I.text,Z.appendChild(he)}function ee(he,G){G?(he.classList.add("jsroot_ctxt_focus"),he.style["background-color"]="rgb(220, 220, 220)"):he.classList.contains("jsroot_ctxt_focus")&&(he.style["background-color"]=null,he.classList.remove("jsroot_ctxt_focus"),he.querySelector(".jsroot_ctxt_container")?.remove())}if(k.appendChild(Z),I.extraText||I.sub){const he=$.createElement("span");he.className="jsroot_ctxt_extraText",he.style="margin: 0; padding: 3px 7px; color: rgb(0, 0, 0, 0.6);",he.textContent=I.sub?"\u25b6":I.extraText,k.appendChild(he),I.sub&&x.browser.touches&&he.addEventListener("click",G=>{G.preventDefault(),G.stopPropagation();const b=U.parentNode.querySelector(".jsroot_ctxt_focus");b&&ee(b,!1),U!==b&&(ee(U,!0),this._buildContextmenu(I.sub,0,0,U))})}x.browser.touches||k.addEventListener("mouseenter",()=>{this.prevHovArea&&(this.prevHovArea.style["background-color"]=null),k.style["background-color"]="rgb(235, 235, 235)",this.prevHovArea=k,A.childNodes.forEach(he=>ee(he,!1)),I.sub&&(ee(U,!0),this._buildContextmenu(I.sub,0,0,U))}),I.func&&U.addEventListener("click",he=>{(this.painter?I.func.bind(this.painter):I.func)(I.arg),he.stopPropagation(),this.remove()})}),B.appendChild(A);const f=$.documentElement.clientWidth,C=$.documentElement.clientHeight;if(B===$.body)me+A.offsetWidth>f&&(A.style.left=f-A.offsetWidth+"px"),A.offsetHeight>C?(A.style.top=0,A.style.overflowY="scroll",A.style.overflowX="hidden",A.style.height=C+"px"):X+A.offsetHeight>C&&(A.style.top=C-A.offsetHeight+"px");else if("jsroot_ctxt_column"!==A.className){const I=B.getBoundingClientRect(),U=A.getBoundingClientRect();U.left+U.width>f&&(A.style.left=-B.offsetLeft-U.width+"px"),U.height>C?(A.style.top=-U.top+"px",A.style.overflowY="scroll",A.style.overflowX="hidden",A.style.height=C+"px"):U.height<C&&U.height>C/2?A.style.top=U.top-C/2>=0?-U.top-U.height+C+"px":-U.top+"px":U.top+U.height>C&&(A.style.top=-U.height+I.height+"px")}return A}show(Q){var me=this;return(0,Ee.A)(function*(){me.remove(),!Q&&me.show_evnt&&(Q=me.show_evnt);const X=(0,x.getDocument)(),B=typeof window>"u"?{x:0,y:0}:{x:window.scrollX,y:window.scrollY};X.body.addEventListener("click",me.remove_handler);const $=X.getElementById(me.menuname);return $&&$.remove(),me.element=me._buildContextmenu(me.code,(Q?.clientX||0)+B.x,(Q?.clientY||0)+B.y,X.body),me.element.setAttribute("id",me.menuname),me})()}createModal(Q,me,X){X||(X={}),X.Ok||(X.Ok="Ok");const B={args:X},$=(this?.menuname??"root_modal")+"_dialog";(0,L.Lt)(`#${$}`).remove(),(0,L.Lt)(`#${$}_block`).remove();const A=Math.min(X.width||450,Math.round(.9*x.browser.screenWidth));B.block=(0,L.Lt)("body").append("div").attr("id",`${$}_block`).attr("class","jsroot_dialog_block").attr("style","z-index: 100000; position: absolute; left: 0px; top: 0px; bottom: 0px; right: 0px; opacity: 0.2; background-color: white"),B.element=(0,L.Lt)("body").append("div").attr("id",$).attr("class","jsroot_dialog").style("position","absolute").style("width",`${A}px`).style("left","50%").style("top","50%").style("z-index",100001).attr("tabindex","0").html(`<div style='position: relative; left: -50%; top: -50%; border: solid green 3px; padding: 5px; display: flex; flex-flow: column; background-color: white'><div style='flex: 0 1 auto; padding: 5px'>${Q}</div><div class='jsroot_dialog_content' style='flex: 1 1 auto; padding: 5px'>${me}</div><div class='jsroot_dialog_footer' style='flex: 0 1 auto; padding: 5px'><button class='jsroot_dialog_button' style='float: right; width: fit-content; margin-right: 1em'>${X.Ok}</button>`+(X.btns?"<button class='jsroot_dialog_button' style='float: right; width: fit-content; margin-right: 1em'>Cancel</button>":"")+"</div></div>"),B.done=function(g){this._done||(this._done=!0,(0,x.isFunc)(this.call_back)&&this.call_back(g),this.element.remove(),this.block.remove())},B.setContent=function(g,v){this._done||(this.element.select(".jsroot_dialog_content").html(g),v&&(this.args.Ok=v,this.element.select(".jsroot_dialog_button").text(v)))},B.element.on("keyup",g=>{("Enter"===g.code||"Escape"===g.code)&&(g.preventDefault(),g.stopPropagation(),B.done("Enter"===g.code?B.element.node():null))}),B.element.on("keydown",g=>{("Enter"===g.code||"Escape"===g.code)&&(g.preventDefault(),g.stopPropagation())}),B.element.selectAll(".jsroot_dialog_button").on("click",g=>{B.done(X.btns&&(0,L.Lt)(g.target).text()===X.Ok?B.element.node():null)});let E=B.element.select(".jsroot_dialog_content").select("input");return E.empty()&&(E=B.element.select(".jsroot_dialog_footer").select("button")),E.empty()||E.node().focus(),B}runModal(Q,me,X){var B=this;return(0,Ee.A)(function*(){const $=B.createModal(Q,me,X);return new Promise(A=>{$.call_back=A})})()}}function De(ue,Q,me){return new Ve(Q,me||"root_ctx_menu",ue).load()}function F(ue){const Q=(0,x.getDocument)().getElementById(ue||"root_ctx_menu");return Q?.remove(),!!Q}function J(ue,Q,me){(0,x.isFunc)(ue.stopPropagation)&&(ue.stopPropagation(),ue.preventDefault()),De(ue,Q).then(X=>(Q.fillContextMenu(X),me===Re&&(0,x.isFunc)(Q.bringToFront)&&(X.add("Bring to front",()=>Q.bringToFront(!0)),me=void 0),Q.fillObjectExecMenu(X,me))).then(X=>X.show())}function Y(ue,Q){!ue?.isBatchMode()&&ue?.draw_g&&ue.draw_g.on("contextmenu",x.settings.ContextMenu?me=>J(me,ue,Q):null)}x.internals._modalProgress=function(ue,Q){if(!ue||!(0,x.isStr)(ue))return x.internals.modal?.done(),void delete x.internals.modal;x.internals.modal||(x.internals.modal=Ve.prototype.createModal("Progress",ue)),x.internals.modal.setContent(ue,Q?"Abort":"Ok"),x.internals.modal.call_back=Q}},5992:(Yr,mt,Se)=>{"use strict";Se.d(mt,{DZ:()=>B,IK:()=>De,Jb:()=>Q,OJ:()=>f,PL:()=>A,Rh:()=>Ye,W4:()=>Ze,X2:()=>Y,cA:()=>He,d7:()=>F,fz:()=>ue,iE:()=>J,pp:()=>U,sb:()=>$});var Ee=Se(4882),x=Se(8872),L=Se(8362),ve=Se(2843),ke=Se(1922),ot=Se(2985);function Ye(k,Z,ee){if((0,x.isBatchMode)()||typeof document>"u")return;const he="jsroot_progressbox",G="modal"===x.settings.ProgressBox&&(0,x.isFunc)(x.internals._modalProgress)?x.internals._modalProgress:null;let b=(0,L.Lt)("#"+he);if(!x.settings.ProgressBox)return G&&G(),b.remove();if(0===arguments.length||!k)return(-1!==Z||!b.empty()&&b.property("with_timeout"))&&b.remove(),void(G&&G());if(G)b.remove(),G(k,ee);else{b.empty()&&(b=(0,L.Lt)(document.body).append("div").attr("id",he).attr("style","position: fixed; min-width: 100px; height: auto; overflow: visible; z-index: 101; border: 1px solid #999; background: #F8F8F8; left: 10px; bottom: 10px;"),b.append("p")),b.property("with_timeout",!1);const P=b.select("p");(0,x.isStr)(k)&&P.html(k).on("click",(0,x.isFunc)(ee)?ee:null).attr("title",(0,x.isFunc)(ee)?"Click element to abort current operation":""),P.attr("style","font-size: 10px; margin-left: 10px; margin-right: 10px; margin-top: 3px; margin-bottom: 3px")}Number.isFinite(Z)&&Z>0&&(b.empty()||b.property("with_timeout",!0),setTimeout(()=>Ye("",-1),Z))}function Ze(){typeof window>"u"||(window.close(),window.open("","_self").close())}function Re(k,Z){if(!k||0===k.length)return void((0,x.isFunc)(Z.rejectFunc)&&(Z.rejectFunc(Error("openui5 was not possible to load")),Z.rejectFunc=null));let ee=k.shift();0===ee.indexOf("roothandler")&&ee.indexOf("://")<0&&(ee=ee.replace(/:\//g,"://"));const he=document.createElement("script");he.setAttribute("type","text/javascript"),he.setAttribute("id","sap-ui-bootstrap"),he.setAttribute("src",ee+(Z.ui5dbg?"resources/sap-ui-core-dbg.js":"resources/sap-ui-core.js")),he.setAttribute("data-sap-ui-libs",Z.openui5libs??"sap.m, sap.ui.layout, sap.ui.unified, sap.ui.commons"),he.setAttribute("data-sap-ui-theme",Z.openui5theme||"sap_belize"),he.setAttribute("data-sap-ui-compatVersion","edge"),he.setAttribute("data-sap-ui-async","true"),he.setAttribute("data-sap-ui-preload","async"),he.setAttribute("data-sap-ui-evt-oninit","completeUI5Loading()"),he.onerror=function(){he.parentNode.removeChild(he),Re(k,Z)},he.onload=function(){console.log(`Load openui5 from ${ee}`)},document.head.appendChild(he)}function He(k){return Ve.apply(this,arguments)}function Ve(){return(Ve=(0,Ee.A)(function*(k){if("object"==typeof globalThis.sap)return globalThis.sap;k||(k={});let Z=x.source_dir.replace(/jsrootsys/g,"rootui5sys");Z===x.source_dir&&(Z=window.location.port&&window.location.pathname.indexOf("/win")>=0&&(!k.openui5src||"nojsroot"===k.openui5src||"jsroot"===k.openui5src)?window.location.origin+window.location.pathname+"../rootui5sys/":void 0);const ee=[];let he="https://openui5.hana.ondemand.com/1.98.0/",G=Z?Z+"distribution/":"";if((0,x.isStr)(k.openui5src))switch(k.openui5src){case"nodefault":he="";break;case"default":ee.push(he),he="";break;case"nojsroot":break;case"jsroot":ee.push(G),G="";break;default:ee.push(k.openui5src)}else k.ui5dbg&&(G="");return G&&ee.indexOf(G)<0&&ee.push(G),he&&ee.indexOf(he)<0&&ee.push(he),new Promise((b,P)=>{k.resolveFunc=b,k.rejectFunc=P,globalThis.completeUI5Loading=function(){globalThis.sap.ui.loader.config({paths:{jsroot:x.source_dir,rootui5:Z}}),k.resolveFunc&&(k.resolveFunc(globalThis.sap),k.resolveFunc=null)},Re(ee,k)})})).apply(this,arguments)}const De={camera:{path:"M 152.00,304.00c0.00,57.438, 46.562,104.00, 104.00,104.00s 104.00-46.562, 104.00-104.00s-46.562-104.00-104.00-104.00S 152.00,246.562, 152.00,304.00z M 480.00,128.00L 368.00,128.00 c-8.00-32.00-16.00-64.00-48.00-64.00L 192.00,64.00 c-32.00,0.00-40.00,32.00-48.00,64.00L 32.00,128.00 c-17.60,0.00-32.00,14.40-32.00,32.00l0.00,288.00 c0.00,17.60, 14.40,32.00, 32.00,32.00l 448.00,0.00 c 17.60,0.00, 32.00-14.40, 32.00-32.00L 512.00,160.00 C 512.00,142.40, 497.60,128.00, 480.00,128.00z M 256.00,446.00c-78.425,0.00-142.00-63.574-142.00-142.00c0.00-78.425, 63.575-142.00, 142.00-142.00c 78.426,0.00, 142.00,63.575, 142.00,142.00 C 398.00,382.426, 334.427,446.00, 256.00,446.00z M 480.00,224.00l-64.00,0.00 l0.00-32.00 l 64.00,0.00 L 480.00,224.00 z"},disk:{path:"M384,0H128H32C14.336,0,0,14.336,0,32v448c0,17.656,14.336,32,32,32h448c17.656,0,32-14.344,32-32V96L416,0H384z M352,160   V32h32v128c0,17.664-14.344,32-32,32H160c-17.664,0-32-14.336-32-32V32h128v128H352z M96,288c0-17.656,14.336-32,32-32h256   c17.656,0,32,14.344,32,32v192H96V288z"},question:{path:"M256,512c141.375,0,256-114.625,256-256S397.375,0,256,0S0,114.625,0,256S114.625,512,256,512z M256,64   c63.719,0,128,36.484,128,118.016c0,47.453-23.531,84.516-69.891,110.016C300.672,299.422,288,314.047,288,320   c0,17.656-14.344,32-32,32c-17.664,0-32-14.344-32-32c0-40.609,37.25-71.938,59.266-84.031   C315.625,218.109,320,198.656,320,182.016C320,135.008,279.906,128,256,128c-30.812,0-64,20.227-64,64.672   c0,17.664-14.336,32-32,32s-32-14.336-32-32C128,109.086,193.953,64,256,64z M256,449.406c-18.211,0-32.961-14.75-32.961-32.969   c0-18.188,14.75-32.953,32.961-32.953c18.219,0,32.969,14.766,32.969,32.953C288.969,434.656,274.219,449.406,256,449.406z"},undo:{path:"M450.159,48.042c8.791,9.032,16.983,18.898,24.59,29.604c7.594,10.706,14.146,22.207,19.668,34.489  c5.509,12.296,9.82,25.269,12.92,38.938c3.113,13.669,4.663,27.834,4.663,42.499c0,14.256-1.511,28.863-4.532,43.822  c-3.009,14.952-7.997,30.217-14.953,45.795c-6.955,15.577-16.202,31.52-27.755,47.826s-25.88,32.9-42.942,49.807  c-5.51,5.444-11.787,11.67-18.834,18.651c-7.033,6.98-14.496,14.366-22.39,22.168c-7.88,7.802-15.955,15.825-24.187,24.069  c-8.258,8.231-16.333,16.203-24.252,23.888c-18.3,18.13-37.354,37.016-57.191,56.65l-56.84-57.445  c19.596-19.472,38.54-38.279,56.84-56.41c7.75-7.685,15.772-15.604,24.108-23.757s16.438-16.163,24.33-24.057  c7.894-7.893,15.356-15.33,22.402-22.312c7.034-6.98,13.312-13.193,18.821-18.651c22.351-22.402,39.165-44.648,50.471-66.738  c11.279-22.09,16.932-43.567,16.932-64.446c0-15.785-3.217-31.005-9.638-45.671c-6.422-14.665-16.229-28.504-29.437-41.529  c-3.282-3.282-7.358-6.395-12.217-9.325c-4.871-2.938-10.381-5.503-16.516-7.697c-6.121-2.201-12.815-3.992-20.058-5.373  c-7.242-1.374-14.9-2.064-23.002-2.064c-8.218,0-16.802,0.834-25.788,2.507c-8.961,1.674-18.053,4.429-27.222,8.271  c-9.189,3.842-18.456,8.869-27.808,15.089c-9.358,6.219-18.521,13.819-27.502,22.793l-59.92,60.271l93.797,94.058H0V40.91  l93.27,91.597l60.181-60.532c13.376-15.018,27.222-27.248,41.536-36.697c14.308-9.443,28.608-16.776,42.89-21.992  c14.288-5.223,28.505-8.74,42.623-10.557C294.645,0.905,308.189,0,321.162,0c13.429,0,26.389,1.185,38.84,3.562  c12.478,2.377,24.2,5.718,35.192,10.029c11.006,4.311,21.126,9.404,30.374,15.265C434.79,34.724,442.995,41.119,450.159,48.042z"},arrow_right:{path:"M30.796,226.318h377.533L294.938,339.682c-11.899,11.906-11.899,31.184,0,43.084c11.887,11.899,31.19,11.893,43.077,0  l165.393-165.386c5.725-5.712,8.924-13.453,8.924-21.539c0-8.092-3.213-15.84-8.924-21.551L338.016,8.925  C332.065,2.975,324.278,0,316.478,0c-7.802,0-15.603,2.968-21.539,8.918c-11.899,11.906-11.899,31.184,0,43.084l113.391,113.384  H30.796c-16.822,0-30.463,13.645-30.463,30.463C0.333,212.674,13.974,226.318,30.796,226.318z"},arrow_up:{path:"M295.505,629.446V135.957l148.193,148.206c15.555,15.559,40.753,15.559,56.308,0c15.555-15.538,15.546-40.767,0-56.304  L283.83,11.662C276.372,4.204,266.236,0,255.68,0c-10.568,0-20.705,4.204-28.172,11.662L11.333,227.859  c-7.777,7.777-11.666,17.965-11.666,28.158c0,10.192,3.88,20.385,11.657,28.158c15.563,15.555,40.762,15.555,56.317,0  l148.201-148.219v493.489c0,21.993,17.837,39.82,39.82,39.82C277.669,669.267,295.505,651.439,295.505,629.446z"},arrow_diag:{path:"M279.875,511.994c-1.292,0-2.607-0.102-3.924-0.312c-10.944-1.771-19.333-10.676-20.457-21.71L233.97,278.348  L22.345,256.823c-11.029-1.119-19.928-9.51-21.698-20.461c-1.776-10.944,4.031-21.716,14.145-26.262L477.792,2.149  c9.282-4.163,20.167-2.165,27.355,5.024c7.201,7.189,9.199,18.086,5.024,27.356L302.22,497.527  C298.224,506.426,289.397,511.994,279.875,511.994z M118.277,217.332l140.534,14.294c11.567,1.178,20.718,10.335,21.878,21.896  l14.294,140.519l144.09-320.792L118.277,217.332z"},auto_zoom:{path:"M505.441,242.47l-78.303-78.291c-9.18-9.177-24.048-9.171-33.216,0c-9.169,9.172-9.169,24.045,0.006,33.217l38.193,38.188  H280.088V80.194l38.188,38.199c4.587,4.584,10.596,6.881,16.605,6.881c6.003,0,12.018-2.297,16.605-6.875  c9.174-9.172,9.174-24.039,0.011-33.217L273.219,6.881C268.803,2.471,262.834,0,256.596,0c-6.229,0-12.202,2.471-16.605,6.881  l-78.296,78.302c-9.178,9.172-9.178,24.045,0,33.217c9.177,9.171,24.051,9.171,33.21,0l38.205-38.205v155.4H80.521l38.2-38.188  c9.177-9.171,9.177-24.039,0.005-33.216c-9.171-9.172-24.039-9.178-33.216,0L7.208,242.464c-4.404,4.403-6.881,10.381-6.881,16.611  c0,6.227,2.477,12.207,6.881,16.61l78.302,78.291c4.587,4.581,10.599,6.875,16.605,6.875c6.006,0,12.023-2.294,16.61-6.881  c9.172-9.174,9.172-24.036-0.005-33.211l-38.205-38.199h152.593v152.063l-38.199-38.211c-9.171-9.18-24.039-9.18-33.216-0.022  c-9.178,9.18-9.178,24.059-0.006,33.222l78.284,78.302c4.41,4.404,10.382,6.881,16.611,6.881c6.233,0,12.208-2.477,16.611-6.881  l78.302-78.296c9.181-9.18,9.181-24.048,0-33.205c-9.174-9.174-24.054-9.174-33.21,0l-38.199,38.188v-152.04h152.051l-38.205,38.199  c-9.18,9.175-9.18,24.037-0.005,33.211c4.587,4.587,10.596,6.881,16.604,6.881c6.01,0,12.024-2.294,16.605-6.875l78.303-78.285  c4.403-4.403,6.887-10.378,6.887-16.611C512.328,252.851,509.845,246.873,505.441,242.47z"},statbox:{path:"M28.782,56.902H483.88c15.707,0,28.451-12.74,28.451-28.451C512.331,12.741,499.599,0,483.885,0H28.782   C13.074,0,0.331,12.741,0.331,28.451C0.331,44.162,13.074,56.902,28.782,56.902zM483.885,136.845H28.782c-15.708,0-28.451,12.741-28.451,28.451c0,15.711,12.744,28.451,28.451,28.451H483.88   c15.707,0,28.451-12.74,28.451-28.451C512.331,149.586,499.599,136.845,483.885,136.845zM483.885,273.275H28.782c-15.708,0-28.451,12.731-28.451,28.452c0,15.707,12.744,28.451,28.451,28.451H483.88   c15.707,0,28.451-12.744,28.451-28.451C512.337,286.007,499.599,273.275,483.885,273.275zM256.065,409.704H30.492c-15.708,0-28.451,12.731-28.451,28.451c0,15.707,12.744,28.451,28.451,28.451h225.585   c15.707,0,28.451-12.744,28.451-28.451C284.516,422.436,271.785,409.704,256.065,409.704z"},circle:{path:"M256,256 m-150,0 a150,150 0 1,0 300,0 a150,150 0 1,0 -300,0"},three_circles:{path:"M256,85 m-70,0 a70,70 0 1,0 140,0 a70,70 0 1,0 -140,0  M256,255 m-70,0 a70,70 0 1,0 140,0 a70,70 0 1,0 -140,0  M256,425 m-70,0 a70,70 0 1,0 140,0 a70,70 0 1,0 -140,0 "},diamand:{path:"M256,0L384,256L256,511L128,256z"},rect:{path:"M90,90h352v352h-352z"},cross:{path:"M80,40l176,176l176,-176l40,40l-176,176l176,176l-40,40l-176,-176l-176,176l-40,-40l176,-176l-176,-176z"},vrgoggles:{size:"245.82 141.73",path:"M175.56,111.37c-22.52,0-40.77-18.84-40.77-42.07S153,27.24,175.56,27.24s40.77,18.84,40.77,42.07S198.08,111.37,175.56,111.37ZM26.84,69.31c0-23.23,18.25-42.07,40.77-42.07s40.77,18.84,40.77,42.07-18.26,42.07-40.77,42.07S26.84,92.54,26.84,69.31ZM27.27,0C11.54,0,0,12.34,0,28.58V110.9c0,16.24,11.54,30.83,27.27,30.83H99.57c2.17,0,4.19-1.83,5.4-3.7L116.47,118a8,8,0,0,1,12.52-.18l11.51,20.34c1.2,1.86,3.22,3.61,5.39,3.61h72.29c15.74,0,27.63-14.6,27.63-30.83V28.58C245.82,12.34,233.93,0,218.19,0H27.27Z"},th2colorz:{recs:[{x:128,y:486,w:256,h:26,f:"rgb(38,62,168)"},{y:461,f:"rgb(22,82,205)"},{y:435,f:"rgb(16,100,220)"},{y:410,f:"rgb(18,114,217)"},{y:384,f:"rgb(20,129,214)"},{y:358,f:"rgb(14,143,209)"},{y:333,f:"rgb(9,157,204)"},{y:307,f:"rgb(13,167,195)"},{y:282,f:"rgb(30,175,179)"},{y:256,f:"rgb(46,183,164)"},{y:230,f:"rgb(82,186,146)"},{y:205,f:"rgb(116,189,129)"},{y:179,f:"rgb(149,190,113)"},{y:154,f:"rgb(179,189,101)"},{y:128,f:"rgb(209,187,89)"},{y:102,f:"rgb(226,192,75)"},{y:77,f:"rgb(244,198,59)"},{y:51,f:"rgb(253,210,43)"},{y:26,f:"rgb(251,230,29)"},{y:0,f:"rgb(249,249,15)"}]},th2color:{recs:[{x:0,y:256,w:13,h:39,f:"rgb(38,62,168)"},{x:13,y:371,w:39,h:39},{y:294,h:39},{y:256,h:39},{y:218,h:39},{x:51,y:410,w:39,h:39},{y:371,h:39},{y:333,h:39},{y:294},{y:256,h:39},{y:218,h:39},{y:179,h:39},{y:141,h:39},{y:102,h:39},{y:64},{x:90,y:448,w:39,h:39},{y:410},{y:371,h:39},{y:333,h:39,f:"rgb(22,82,205)"},{y:294},{y:256,h:39,f:"rgb(16,100,220)"},{y:218,h:39},{y:179,h:39,f:"rgb(22,82,205)"},{y:141,h:39},{y:102,h:39,f:"rgb(38,62,168)"},{y:64},{y:0,h:27},{x:128,y:448,w:39,h:39},{y:410},{y:371,h:39},{y:333,h:39,f:"rgb(22,82,205)"},{y:294,f:"rgb(20,129,214)"},{y:256,h:39,f:"rgb(9,157,204)"},{y:218,h:39,f:"rgb(14,143,209)"},{y:179,h:39,f:"rgb(20,129,214)"},{y:141,h:39,f:"rgb(16,100,220)"},{y:102,h:39,f:"rgb(22,82,205)"},{y:64,f:"rgb(38,62,168)"},{y:26,h:39},{y:0,h:27},{x:166,y:486,h:14},{y:448,h:39},{y:410},{y:371,h:39,f:"rgb(22,82,205)"},{y:333,h:39,f:"rgb(20,129,214)"},{y:294,f:"rgb(82,186,146)"},{y:256,h:39,f:"rgb(179,189,101)"},{y:218,h:39,f:"rgb(116,189,129)"},{y:179,h:39,f:"rgb(82,186,146)"},{y:141,h:39,f:"rgb(14,143,209)"},{y:102,h:39,f:"rgb(16,100,220)"},{y:64,f:"rgb(38,62,168)"},{y:26,h:39},{x:205,y:486,w:39,h:14},{y:448,h:39},{y:410},{y:371,h:39,f:"rgb(16,100,220)"},{y:333,h:39,f:"rgb(9,157,204)"},{y:294,f:"rgb(149,190,113)"},{y:256,h:39,f:"rgb(244,198,59)"},{y:218,h:39},{y:179,h:39,f:"rgb(226,192,75)"},{y:141,h:39,f:"rgb(13,167,195)"},{y:102,h:39,f:"rgb(18,114,217)"},{y:64,f:"rgb(22,82,205)"},{y:26,h:39,f:"rgb(38,62,168)"},{x:243,y:448,w:39,h:39},{y:410},{y:371,h:39,f:"rgb(18,114,217)"},{y:333,h:39,f:"rgb(30,175,179)"},{y:294,f:"rgb(209,187,89)"},{y:256,h:39,f:"rgb(251,230,29)"},{y:218,h:39,f:"rgb(249,249,15)"},{y:179,h:39,f:"rgb(226,192,75)"},{y:141,h:39,f:"rgb(30,175,179)"},{y:102,h:39,f:"rgb(18,114,217)"},{y:64,f:"rgb(38,62,168)"},{y:26,h:39},{x:282,y:448,h:39},{y:410},{y:371,h:39,f:"rgb(18,114,217)"},{y:333,h:39,f:"rgb(14,143,209)"},{y:294,f:"rgb(149,190,113)"},{y:256,h:39,f:"rgb(226,192,75)"},{y:218,h:39,f:"rgb(244,198,59)"},{y:179,h:39,f:"rgb(149,190,113)"},{y:141,h:39,f:"rgb(9,157,204)"},{y:102,h:39,f:"rgb(18,114,217)"},{y:64,f:"rgb(38,62,168)"},{y:26,h:39},{x:320,y:448,w:39,h:39},{y:410},{y:371,h:39,f:"rgb(22,82,205)"},{y:333,h:39,f:"rgb(20,129,214)"},{y:294,f:"rgb(46,183,164)"},{y:256,h:39},{y:218,h:39,f:"rgb(82,186,146)"},{y:179,h:39,f:"rgb(9,157,204)"},{y:141,h:39,f:"rgb(20,129,214)"},{y:102,h:39,f:"rgb(16,100,220)"},{y:64,f:"rgb(38,62,168)"},{y:26,h:39},{x:358,y:448,h:39},{y:410},{y:371,h:39,f:"rgb(22,82,205)"},{y:333,h:39},{y:294,f:"rgb(16,100,220)"},{y:256,h:39,f:"rgb(20,129,214)"},{y:218,h:39,f:"rgb(14,143,209)"},{y:179,h:39,f:"rgb(18,114,217)"},{y:141,h:39,f:"rgb(22,82,205)"},{y:102,h:39,f:"rgb(38,62,168)"},{y:64},{y:26,h:39},{x:397,y:448,w:39,h:39},{y:371,h:39},{y:333,h:39},{y:294,f:"rgb(22,82,205)"},{y:256,h:39},{y:218,h:39},{y:179,h:39,f:"rgb(38,62,168)"},{y:141,h:39},{y:102,h:39},{y:64},{y:26,h:39},{x:435,y:410,h:39},{y:371,h:39},{y:333,h:39},{y:294},{y:256,h:39},{y:218,h:39},{y:179,h:39},{y:141,h:39},{y:102,h:39},{y:64},{x:474,y:256,h:39},{y:179,h:39}]},th2draw3d:{path:"M172.768,0H51.726C23.202,0,0.002,23.194,0.002,51.712v89.918c0,28.512,23.2,51.718,51.724,51.718h121.042   c28.518,0,51.724-23.2,51.724-51.718V51.712C224.486,23.194,201.286,0,172.768,0z M177.512,141.63c0,2.611-2.124,4.745-4.75,4.745   H51.726c-2.626,0-4.751-2.134-4.751-4.745V51.712c0-2.614,2.125-4.739,4.751-4.739h121.042c2.62,0,4.75,2.125,4.75,4.739 L177.512,141.63L177.512,141.63z M460.293,0H339.237c-28.521,0-51.721,23.194-51.721,51.712v89.918c0,28.512,23.2,51.718,51.721,51.718h121.045   c28.521,0,51.721-23.2,51.721-51.718V51.712C512.002,23.194,488.802,0,460.293,0z M465.03,141.63c0,2.611-2.122,4.745-4.748,4.745   H339.237c-2.614,0-4.747-2.128-4.747-4.745V51.712c0-2.614,2.133-4.739,4.747-4.739h121.045c2.626,0,4.748,2.125,4.748,4.739 V141.63z M172.768,256.149H51.726c-28.524,0-51.724,23.205-51.724,51.726v89.915c0,28.504,23.2,51.715,51.724,51.715h121.042   c28.518,0,51.724-23.199,51.724-51.715v-89.915C224.486,279.354,201.286,256.149,172.768,256.149z M177.512,397.784   c0,2.615-2.124,4.736-4.75,4.736H51.726c-2.626-0.006-4.751-2.121-4.751-4.736v-89.909c0-2.626,2.125-4.753,4.751-4.753h121.042 c2.62,0,4.75,2.116,4.75,4.753L177.512,397.784L177.512,397.784z M460.293,256.149H339.237c-28.521,0-51.721,23.199-51.721,51.726v89.915c0,28.504,23.2,51.715,51.721,51.715h121.045   c28.521,0,51.721-23.199,51.721-51.715v-89.915C512.002,279.354,488.802,256.149,460.293,256.149z M465.03,397.784   c0,2.615-2.122,4.736-4.748,4.736H339.237c-2.614,0-4.747-2.121-4.747-4.736v-89.909c0-2.626,2.121-4.753,4.747-4.753h121.045 c2.615,0,4.748,2.116,4.748,4.753V397.784z"},createSVG(k,Z,ee,he,G){const b=!0===G||!1===G?G:x.settings.DarkMode,P="browser"===G?x.browser.touches?.2:0:b?.8:.2,T=k.append("svg:svg").attr("width",ee+"px").attr("height",ee+"px").attr("viewBox","0 0 512 512").style("overflow","hidden").style("cursor","pointer").style("fill",b?"rgba(255, 224, 160)":"steelblue").style("opacity",P).property("opacity0",P).property("opacity1",b?1:.8).on("mouseenter",function(){const z=(0,L.Lt)(this);z.style("opacity",z.property("opacity1"));const W=z.node()._mouseenter;(0,x.isFunc)(W)&&W()}).on("mouseleave",function(){const z=(0,L.Lt)(this);z.style("opacity",z.property("opacity0"));const W=z.node()._mouseleave;(0,x.isFunc)(W)&&W()});if("recs"in Z){const z={};for(let W=0;W<Z.recs.length;++W)Object.assign(z,Z.recs[W]),T.append("rect").attr("x",z.x).attr("y",z.y).attr("width",z.w).attr("height",z.h).style("fill",z.f)}else T.append("svg:path").attr("d",Z.path);return T.append("svg:rect").attr("x",0).attr("y",0).attr("width",512).attr("height",512).style("opacity",0).style("fill","none").style("pointer-events","visibleFill").append("svg:title").text(he),T}};function F(k,Z){if(!k||(0,x.isBatchMode)()||typeof window>"u"||typeof document>"u")return;let ee=null,he=Z||300;function G(){if(ee=null,document.body.style.cursor="wait",(0,x.isFunc)(k))k();else if((0,x.isFunc)(k?.checkResize))k.checkResize();else{const b=new ve.b8(k).selectDom();if(!b.empty()){const P=b.property("mdi");(0,x.isFunc)(P?.checkMDIResize)?P.checkMDIResize():(0,ke.XR)(b.node())}}document.body.style.cursor="auto"}he<20&&(he=20),window.addEventListener("resize",()=>{null!==ee&&clearTimeout(ee),ee=setTimeout(G,he)})}function J(k){return 2===k?.buttons||2===k?.button}function Y(k,Z=!0){if(!x.settings.MoveResize||k.isBatchMode()||!k.draw_g)return;if(!1===k.getPadPainter()?.isEditable()&&(Z=!1),!Z){if(k.draw_g.property("assigned_move")){const b=(0,L.$E)().subject(Object);b.on("start",null).on("drag",null).on("end",null),k.draw_g.style("cursor",null).property("assigned_move",null).call(b)}return}if(k.draw_g.property("assigned_move"))return;const ee=(0,L.$E)().subject(Object);let he=!0,G=!1;ee.on("start",function(b){if(G=!!this.moveEnabled&&!this.moveEnabled(),G||J(b.sourceEvent))return;b.sourceEvent.preventDefault(),b.sourceEvent.stopPropagation();const P=(0,L.Wn)(b,this.draw_g.node());he=!0,this.moveStart&&this.moveStart(P[0],P[1])}.bind(k)).on("drag",function(b){G||(b.sourceEvent.preventDefault(),b.sourceEvent.stopPropagation(),he=!1,this.moveDrag&&this.moveDrag(b.dx,b.dy))}.bind(k)).on("end",function(b){if(G)return;b.sourceEvent.preventDefault(),b.sourceEvent.stopPropagation(),this.moveEnd&&this.moveEnd(he);let P=null;if(he){const T=(0,L.Wn)(b,this.draw_g.node());P={x:T[0],y:T[1],dbl:!1}}this.getPadPainter()?.selectObjectPainter(this,P)}.bind(k)),k.draw_g.style("cursor","move").property("assigned_move",!0).call(ee)}function ue(k,Z,ee){if((0,x.isBatchMode)()||!k||typeof document>"u")return!0;const he=(Z||document).getElementsByTagName("style");for(let b=0;b<he.length;++b){if(ee&&he[b].getAttribute("tag")===ee)return he[b].innerHTML=k,!0;if(he[b].innerHTML===k)return!0}const G=document.createElement("style");return ee&&G.setAttribute("tag",ee),G.innerHTML=k,(Z||document.head).appendChild(G),!0}function Q(k){switch(x.gStyle.fName=k,k){case"Modern":Object.assign(x.gStyle,{fFrameBorderMode:0,fFrameFillColor:0,fCanvasBorderMode:0,fCanvasColor:0,fPadBorderMode:0,fPadColor:0,fStatColor:0,fTitleAlign:23,fTitleX:.5,fTitleBorderSize:0,fTitleColor:0,fTitleStyle:0,fOptStat:1111,fStatY:.935,fLegendBorderSize:1,fLegendFont:42,fLegendTextSize:0,fLegendFillColor:0});break;case"Plain":Object.assign(x.gStyle,{fFrameBorderMode:0,fCanvasBorderMode:0,fPadBorderMode:0,fPadColor:0,fCanvasColor:0,fTitleColor:0,fTitleBorderSize:0,fStatColor:0,fStatBorderSize:1,fLegendBorderSize:1});break;case"Bold":Object.assign(x.gStyle,{fCanvasColor:10,fCanvasBorderMode:0,fFrameLineWidth:3,fFrameFillColor:10,fPadColor:10,fPadTickX:1,fPadTickY:1,fPadBottomMargin:.15,fPadLeftMargin:.15,fTitleColor:10,fTitleTextColor:600,fStatColor:10})}}function me(k,Z,ee){const he=Z<=0?"":(0,x.btoa_func)(JSON.stringify(k)),G=new Date;G.setTime(Z<=0?0:G.getTime()+24*Z*60*60*1e3),typeof document<"u"&&(document.cookie=`${ee}=${he}; expires=${G.toUTCString()}; SameSite=None; Secure; path=/;`)}function B(k=365,Z="jsroot_settings"){me(x.settings,k,Z)}function $(k=!1,Z="jsroot_settings"){const ee=function X(k){if(typeof document>"u")return null;const ee=decodeURIComponent(document.cookie).split(";");k+="=";for(let he=0;he<ee.length;he++){let G=ee[he];for(;" "===G.charAt(0);)G=G.substring(1);if(0===G.indexOf(k)){const b=JSON.parse((0,x.atob_func)(G.substring(k.length,G.length)));return(0,x.isObject)(b)?b:null}}return null}(Z);return!!ee&&(k||Object.assign(x.settings,ee),!0)}function A(k=365,Z="jsroot_style"){me(x.gStyle,k,Z)}let g=null;function v(k){if(0===k.indexOf("data:image/svg+xml;charset=utf-8,"))return decodeURIComponent(k.slice(33));if(0===k.indexOf("data:image/")){const ee=k.indexOf("base64,");if(ee>0){const he=k.slice(ee+7);return(0,x.atob_func)(he)}}return k}function f(k,Z){return C.apply(this,arguments)}function C(){return(C=(0,Ee.A)(function*(k,Z){if((0,x.isFunc)(g))return g(k,v(Z));if((0,x.isNodeJs)())return Se.e(756).then(Se.t.bind(Se,9756,19)).then(ee=>(ee.writeFileSync(k,v(Z)),!0));if(typeof document<"u"){const ee=document.createElement("a");return ee.download=k,ee.href=Z,document.body.appendChild(ee),new Promise(he=>{ee.addEventListener("click",()=>{ee.parentNode.removeChild(ee),he(!0)}),ee.click()})}return!1})).apply(this,arguments)}function U(k,Z){const ee=(0,ot.HG)();let he=-1;if((0,x.isStr)(k)){if(k&&"none"!==k){for(let G=1;G<ee.length;++G)if(ee[G]===k){he=G;break}}else he=0;he<0&&0===k.indexOf("rgb")&&(he=9999)}else Number.isInteger(k)&&ee[k]&&(he=k,k=ee[he]);if(he<0)return"";if(he>=50){const G=(0,L.yW)(k);he=`TColor::GetColor(${G.r},${G.g},${G.b})`}return`exec:${Z}(${he})`}},212:(Yr,mt,Se)=>{"use strict";Se.d(mt,{N:()=>Ye,c:()=>ot});var Ee=Se(4882),x=Se(8872),L=Se(8362),ve=Se(2843),ke=Se(4615);const ot=["LOGXY","LOGX","LOGY","LOGZ","LOGV","LOG","LOG2X","LOG2Y","LOG2","LNX","LNY","LN","GRIDXY","GRIDX","GRIDY","TICKXY","TICKX","TICKY","TICKZ","FB","GRAYSCALE"];class Ye extends ke.mf{convertTH1K(){const Re=this.getObject();if(Re.fReady)return;const He=Re.fArray,Ve=Re.fEntries;Re.fNcells=Re.fXaxis.fNbins+2,Re.fArray=new Float64Array(Re.fNcells).fill(0);for(let De=0;De<Re.fNIn;++De)Re.Fill(He[De]);Re.fReady=1,Re.fEntries=Ve}scanContent(Re){Re&&!this.nbinsx&&(Re=!1),this.isTH1K()&&this.convertTH1K();const He=this.getHisto();Re||this.extractAxesProperties(1);const Ve=this.getSelectIndex("x","left"),De=this.getSelectIndex("x","right");if(Re&&Ve===this.scan_xleft&&De===this.scan_xright)return;this.draw_content=!(this.options.Axis>0),this.scan_xleft=Ve,this.scan_xright=De;const F=this.isTProfile();let X,B,J=0,Y=0,ue=0,Q=0,me=!0;for(let A=0;A<this.nbinsx;++A)X=He.getBinContent(A+1),Q+=F?He.fBinEntries[A+1]:X,!(A<Ve||A>=De)&&(X>0&&(0===Y||X<Y)&&(Y=X),me&&(J=ue=X,me=!1),B=this.options.Error?He.getBinError(A+1):0,J=Math.min(J,X-B),ue=Math.max(ue,X+B));Q+=F?He.fBinEntries[0]+He.fBinEntries[this.nbinsx+1]:He.getBinContent(0)+He.getBinContent(this.nbinsx+1),this.stat_entries=He.fEntries>1?He.fEntries:Q,this.hmin=J,this.hmax=ue,(0===this.nbinsx||Math.abs(J)<1e-300&&Math.abs(ue)<1e-300)&&(this.draw_content=!1);let $=!1;if(this.draw_content||this.isMainPainter()&&this.options.Axis>0&&!this.options.ohmin&&!this.options.ohmax&&He.fMinimum===x.kNoZoom&&He.fMaximum===x.kNoZoom)if(J>=ue)0===J?(this.ymin=0,this.ymax=1):J<0?(this.ymin=2*J,this.ymax=0):(this.ymin=0,this.ymax=2*J);else{const A=this.getPadPainter()?.getRootPad();(this.options.BarStyle>=20?A.fLogx:A?.fLogv??A?.fLogy)?(this.ymin=.5*(Y||J),this.ymax=2*ue*(.9/.95)):(this.ymin=J-(ue-J)*x.gStyle.fHistTopMargin,this.ymin<0&&J>=0&&(this.ymin=0),this.ymax=ue+(ue-this.ymin)*x.gStyle.fHistTopMargin)}J=this.options.minimum,ue=this.options.maximum,J===ue&&J!==x.kNoZoom&&(J<0?(J*=2,ue=0):(J=0,ue*=2,ue||(ue=1))),J!==x.kNoZoom&&ue!==x.kNoZoom&&!this.draw_content&&(this.ymin===this.ymax||this.ymin>J||this.ymax<ue)?(this.ymin=J,this.ymax=ue):(J!==x.kNoZoom&&(J<this.ymin&&(this.ymin=J),$=!0),ue!==x.kNoZoom&&(ue>this.ymax&&(this.ymax=ue),$=!0)),Re||($?(this.zoom_ymin=J===x.kNoZoom?this.ymin:J,this.zoom_ymax=ue===x.kNoZoom?this.ymax:ue):(delete this.zoom_ymin,delete this.zoom_ymax)),this.wheel_zoomy=this.getDimension()>1||!this.draw_content}countStat(Re,He){const Ve=this.isTProfile(),De=this.getHisto(),F=De.fXaxis,J=this.getSelectIndex("x","left"),Y=this.getSelectIndex("x","right"),ue=this.getFramePainter(),Q={name:De.fName,meanx:0,meany:0,rmsx:0,rmsy:0,integral:0,entries:this.stat_entries,eff_entries:0,xmax:0,wmax:0,skewx:0,skewd:0,kurtx:0,kurtd:0},me=!ue.isAxisZoomed("x")&&Math.abs(De.fTsumw)>1e-300;let v,X=0,B=0,$=0,A=0,E=0,g=0,f=0,C=0,I=null,U=null;for((0,x.isFunc)(Re)||(Re=null),v=J;v<Y;++v)f=F.GetBinCoord(v+.5),(!Re||Re(f))&&(Ve?(C=De.fBinEntries[v+1],E+=De.fArray[v+1],g+=De.fSumw2[v+1]):C=De.getBinContent(v+1),(null===I||C>U)&&(I=f,U=C),me||(X+=C,B+=C*C,$+=C*f,A+=C*f**2));if(me&&(X=De.fTsumw,B=De.fTsumw2,$=De.fTsumwx,A=De.fTsumwx2),Q.integral=X,Q.eff_entries=B?X*X/B:Math.abs(X),Math.abs(X)>1e-300&&(Q.meanx=$/X,Q.meany=E/X,Q.rmsx=Math.sqrt(Math.abs(A/X-Q.meanx**2)),Q.rmsy=Math.sqrt(Math.abs(g/X-Q.meany**2))),null!==I&&(Q.xmax=I,Q.wmax=U),He){let k=0,Z=0,ee=0;for(v=J;v<Y;++v)f=F.GetBinCoord(v+.5),(!Re||Re(f))&&(C=Ve?De.fBinEntries[v+1]:De.getBinContent(v+1),ee+=C,k+=C*Math.pow(f-Q.meanx,3),Z+=C*Math.pow(f-Q.meanx,4));const he=Math.pow(Q.rmsx,3),G=Math.pow(Q.rmsx,4);ee*he!=0&&(Q.skewx=k/(ee*he)),Q.skewd=Q.eff_entries>0?Math.sqrt(6/Q.eff_entries):0,ee*G!=0&&(Q.kurtx=Z/(ee*G)-3),Q.kurtd=Q.eff_entries>0?Math.sqrt(24/Q.eff_entries):0}return Q}fillStatistic(Re,He,Ve){if(this.isIgnoreStatsFill())return!1;1===He&&(He=1111),1===Ve&&(Ve=111);const De=this.getHisto(),F=He%10,J=Math.floor(He/10)%10,Y=Math.floor(He/100)%10,ue=Math.floor(He/1e3)%10,Q=Math.floor(He/1e4)%10,me=Math.floor(He/1e5)%10,X=Math.floor(He/1e6)%10,B=Math.floor(He/1e7)%10,$=Math.floor(He/1e8)%10,A=this.countStat(void 0,B>0||$>0);return Re.clearPave(),F>0&&Re.addText(A.name),this.isTProfile()?(J>0&&Re.addText("Entries = "+Re.format(A.entries,"entries")),Y>0&&(Re.addText("Mean = "+Re.format(A.meanx)),Re.addText("Mean y = "+Re.format(A.meany))),ue>0&&(Re.addText("Std Dev = "+Re.format(A.rmsx)),Re.addText("Std Dev y = "+Re.format(A.rmsy)))):(J>0&&Re.addText("Entries = "+Re.format(A.entries,"entries")),Y>0&&Re.addText("Mean = "+Re.format(A.meanx)),ue>0&&Re.addText("Std Dev = "+Re.format(A.rmsx)),Q>0&&Re.addText("Underflow = "+Re.format(De.fArray.length>0?De.fArray[0]:0,"entries")),me>0&&Re.addText("Overflow = "+Re.format(De.fArray.length>0?De.fArray[De.fArray.length-1]:0,"entries")),X>0&&Re.addText("Integral = "+Re.format(A.integral,"entries")),2===B?Re.addText(`Skewness = ${Re.format(A.skewx)} #pm ${Re.format(A.skewd)}`):B>0&&Re.addText(`Skewness = ${Re.format(A.skewx)}`),2===$?Re.addText(`Kurtosis = ${Re.format(A.kurtx)} #pm ${Re.format(A.kurtd)}`):$>0&&Re.addText(`Kurtosis = ${Re.format(A.kurtx)}`)),Ve&&Re.fillFunctionStat(this.findFunction(x.clTF1),Ve,1),!0}drawBars(Re,He){var Ve=this;return(0,Ee.A)(function*(){const De=Ve.getSelectIndex("x","left",-1),F=Ve.getSelectIndex("x","right",1),J=Ve.getHisto(),Y=J.fXaxis,ue=Ve.options.Text;let Q,me,X,B,$,A,E,g,v,f,C,I,U="",k="",Z="",ee=Ve.options.BarStyle>10?Ve.options.BarStyle%10:0;for(ee>4&&(ee=4),C=Re.swap_xy?0:He,Number.isFinite(Ve.options.BaseLine)&&Ve.options.BaseLine>=Re.scale_ymin&&(C=Math.round(Re.gry(Ve.options.BaseLine))),ue&&(Q=Ve.getColor(J.fMarkerColor),me=-1*Ve.options.TextAngle,X=20,1!==J.fMarkerSize&&me&&(X=.02*He*J.fMarkerSize),Ve.startTextDrawing(42,X,Ve.draw_g,X)),B=De;B<F;++B)if($=Y.GetBinLowEdge(B+1),A=Y.GetBinLowEdge(B+2),!(Re.logx&&A<=0)&&(E=Math.round(Re.grx($)),g=Math.round(Re.grx(A)),v=J.getBinContent(B+1),!(Re.logy&&v<Re.scale_ymin)&&(f=Math.round(Re.gry(v)),I=g-E,E+=Math.round(J.fBarOffset/1e3*I),I=Math.round(J.fBarWidth/1e3*I),U+=Re.swap_xy?`M${C},${E}h${f-C}v${I}h${C-f}z`:`M${E},${f}h${I}v${C-f}h${-I}z`,ee>0&&(g=E+I,I=Math.round(I*ee/10),Re.swap_xy?(k+=`M${C},${E}h${f-C}v${I}h${C-f}z`,Z+=`M${C},${g}h${f-C}v${-I}h${C-f}z`):(k+=`M${E},${f}h${I}v${C-f}h${-I}z`,Z+=`M${g},${f}h${-I}v${C-f}h${I}z`)),ue&&v))){const he=v===Math.round(v)?v.toString():(0,ve.lg)(v,x.gStyle.fPaintTextFormat);Ve.drawText(Re.swap_xy?{align:12,x:Math.round(f+X/2),y:Math.round(E+.1),height:Math.round(.8*I),text:he,color:Q,latex:0}:me?{align:12,x:E+I/2,y:Math.round(f-2-X/5),width:0,height:0,rotate:me,text:he,color:Q,latex:0}:{align:22,x:Math.round(E+.1*I),y:Math.round(f-2-X),width:Math.round(.8*I),height:X,text:he,color:Q,latex:0})}if(U&&Ve.draw_g.append("svg:path").attr("d",U).call(Ve.fillatt.func),k&&Ve.draw_g.append("svg:path").attr("d",k).call(Ve.fillatt.func).style("fill",(0,L.Qh)(Ve.fillatt.color).brighter(.5).formatHex()),Z&&Ve.draw_g.append("svg:path").attr("d",Z).call(Ve.fillatt.func).style("fill",(0,L.Qh)(Ve.fillatt.color).darker(.5).formatHex()),ue)return Ve.finishTextDrawing()})()}drawFilledErrors(Re){const He=this.getSelectIndex("x","left",-1),Ve=this.getSelectIndex("x","right",1),De=this.getHisto(),F=De.fXaxis,J=[],Y=[];let ue,Q,me,X,B;for(ue=He;ue<Ve;++ue)Q=F.GetBinCoord(ue+.5),!(Re.logx&&Q<=0)&&(me=Math.round(Re.grx(Q)),X=De.getBinContent(ue+1),B=De.getBinError(ue+1),!(Re.logy&&X-B<Re.scale_ymin)&&(J.push({grx:me,gry:Math.round(Re.gry(X+B))}),Y.unshift({grx:me,gry:Math.round(Re.gry(X-B))})));const $=(0,ve.Mw)(J,{line:4!==this.options.ErrorKind}),A=(0,ve.Mw)(Y,{line:4!==this.options.ErrorKind,cmd:"L"});this.draw_g.append("svg:path").attr("d",$+A+"Z").call(this.fillatt.func)}drawNormal(Re,He,Ve){const De=this.getSelectIndex("x","left",-1),F=this.getSelectIndex("x","right",2),J=this.getHisto(),Y=!this.isBatchMode()&&x.settings.Tooltip,ue=J.fXaxis,Q=!this.options.Zero,me=this.options.Error,X=this.options.Curve,B=this.options.Text,$=B&&"E"===this.options.TextKind&&this.isTProfile()&&J.fBinEntries,A=[];let C,I,U,k,Z,ee,he,G,b,P,T,z,W,fe,we,St,pt,st,vt,Yt,qt,Ot,Bn,Mn,bn,Dn,$n,Cn,yn,Sn,E="",g=!1,v=this.options.Mark,f=this.options.Line,Me=null,je=null,Ge=null,lt="",bt=null,te=null,Je=5,tt=!1,Fe=!1,Ne=0,rt=0;if(me&&!v&&J.fMarkerStyle>1&&(v=!0),2===this.options.ErrorKind?this.fillatt.empty()?v=!0:Me="":me&&(f=!1,je="",bt=Y?"":null,Fe=!0),rt=this.lineatt.width+x.gStyle.fEndErrorSize,1===this.options.ErrorKind&&(Ne=Math.floor((this.lineatt.width-1)/2)),v){let ye=this.options.MarkStyle;!ye&&1===J.fMarkerStyle&&(ye=8),this.createAttMarker({attr:J,style:ye}),this.markeratt.size>0?(Ge="",tt=!0,this.markeratt.resetPos(),null===bt&&Y&&(!this.markeratt.fill||this.markeratt.getFullSize()<7)&&(te="",Je=Math.max(5,Math.round(.7*this.markeratt.getFullSize())))):v=!1}const ii=me||v,ai=ii||B||f||X,Hi=this.options.Hist&&(!this.lineatt.empty()||!this.fillatt.empty());if(!Hi&&!ai)return this.removeG();if(B){if(Cn=this.getColor(J.fMarkerColor),yn=-1*this.options.TextAngle,Sn=20,1!==J.fMarkerSize&&yn&&(Sn=.02*Ve*J.fMarkerSize),!yn&&!this.options.TextKind){const ye=He/(F-De+1);ye<3*Sn&&(yn=270,Sn=Math.round(.7*ye))}this.startTextDrawing(42,Sn,this.draw_g,Sn)}const ti=ai||F-De>3*He,Nr=ye=>(vt=J.getBinContent(ye+1),!(Q&&0===vt||(qt=Math.round(Re.grx(ue.GetBinLowEdge(ye+1))),Ot=Math.round(Re.grx(ue.GetBinLowEdge(ye+2))),Bn=Math.round((qt+Ot)/2),void 0===I&&(I=Bn),St=Math.round(Re.gry(vt)),me?(Yt=J.getBinError(ye+1),pt=Math.round(St-Re.gry(vt+Yt)),st=Math.round(Re.gry(vt-Yt)-St)):pt=st=20,0))),ss=()=>{let ye=5;if(this.options.errorX>0&&(ye=Math.round((Ot-qt)*this.options.errorX),Dn=Bn-ye,$n=Bn+ye,je+=1===this.options.ErrorKind?`M${Dn+Ne},${St-rt}v${2*rt}m0,-${rt}h${$n-Dn-2*Ne}m0,-${rt}v${2*rt}`:`M${Dn+Ne},${St}h${$n-Dn-2*Ne}`),je+=1===this.options.ErrorKind?`M${Bn-rt},${St-pt+Ne}h${2*rt}m${-rt},0v${pt+st-2*Ne}m${-rt},0h${2*rt}`:`M${Bn},${St-pt+Ne}v${pt+st-2*Ne}`,null!==bt){const Pe=Math.max(pt,5),At=Math.max(st,5);bt+=`M${Bn-ye},${St-Pe}h${2*ye}v${Pe+At}h${-2*ye}z`}},Bs=ye=>{if(Nr(ye)){if(B){const Pe=$?J.fBinEntries[ye+1]:vt;if(0!==Pe){const At=Pe===Math.round(Pe)?Pe.toString():(0,ve.lg)(Pe,x.gStyle.fPaintTextFormat);this.drawText(yn?{align:12,x:Bn,y:Math.round(St-2-Sn/5),width:0,height:0,rotate:yn,text:At,color:Cn,latex:0}:{align:22,x:Math.round(qt+.1*(Ot-qt)),y:Math.round(St-2-Sn),width:Math.round(.8*(Ot-qt)),height:Sn,text:At,color:Cn,latex:0})}}f?(0===lt.length?lt=`M${Bn},${St}`:lt+=Mn===Bn?"v"+(St-bn):bn===St?"h"+(Bn-Mn):`l${Bn-Mn},${St-bn}`,Mn=Bn,bn=St):X&&A.push({grx:(qt+Ot)/2,gry:Re.gry(vt)}),ii&&St>=-pt&&St<=Ve+st&&(null!==Me&&(Me+=`M${qt},${St-pt}h${Ot-qt}v${pt+st+1}h${qt-Ot}z`),null!==Ge&&tt&&(Ge+=this.markeratt.create(Bn,St),null!==te&&(te+=`M${Bn-Je},${St-Je}h${2*Je}v${2*Je}h${-2*Je}z`)),null!==je&&Fe&&ss())}};if((tt||Fe)&&(!x.settings.OptimizeDraw||F-De<5e4&&1===x.settings.OptimizeDraw)){for(W=De;W<F;++W)Nr(W)&&(null!==Ge&&(Ge+=this.markeratt.create(Bn,St)),null!==te&&(te+=`M${Bn-Je},${St-Je}h${2*Je}v${2*Je}h${-2*Je}z`),null!==je&&ss());Fe=tt=!1}for(W=De;W<=F;++W)Z=ue.GetBinLowEdge(W+1),!(this.logx&&Z<=0)&&(ee=Math.round(Re.grx(Z)),g=W===F,g&&De<F?G=k:(he=J.getBinContent(W+1),G=Math.round(Re.gry(he))),0===E.length?(fe=we=W,z=C=U=ee,T=b=P=k=G,E=`M${U},${k}`):ti?ee!==U||g?(ai&&(fe===we?Bs(fe):fe<we?(Bs(fe),Bs(we)):(Bs(we),Bs(fe))),Hi&&(b!==P||T!==b)&&(z!==U&&(E+="h"+(U-z)),k===b?(P!==T&&(E+="v"+(P-T)),b!==P&&(E+="v"+(b-P))):(b!==T&&(E+="v"+(b-T)),P!==b&&(E+="v"+(P-b)),k!==P&&(E+="v"+(k-P))),z=U,T=k),g&&z!==ee&&(E+="h"+(ee-z)),fe=we=W,b=P=k=G,U=ee):(G<b?we=W:G>P&&(fe=W),b=Math.min(b,G),P=Math.max(P,G),k=G):(G!==k||g)&&(ee!==U&&(E+="h"+(ee-U)),G!==k&&(E+="v"+(G-k)),k=G,U=ee));const yo=Y&&this.fillatt.empty()&&Hi&&!ii&&!f&&!X,xt=()=>{this.draw_g.append("svg:path").attr("d",E+(!this.fillatt.empty()||yo?ge:"")).style("stroke-linejoin","miter").call(this.lineatt.func).call(this.fillatt.func)};let K=Ve+3;if(!yo){const ye=Math.round(Re.gry(0));ye<=0?K=-3:ye<Ve&&(K=ye)}const ge=`L${U},${K}H${C}Z`;return E&&Hi&&!this.fillatt.empty()&&(xt(),E=""),(ii||f||X)&&(!lt&&A.length&&(lt=(0,ve.Mw)(A)),Me?this.draw_g.append("svg:path").attr("d",Me).call(this.fillatt.func):lt&&!this.fillatt.empty()&&!Hi&&this.draw_g.append("svg:path").attr("d",lt+`L${Bn},${K}H${I}Z`).call(this.fillatt.func),je&&this.draw_g.append("svg:path").attr("d",je).call(this.lineatt.func),bt&&this.draw_g.append("svg:path").attr("d",bt).style("fill","none").style("pointer-events",this.isBatchMode()?null:"visibleFill"),lt&&this.draw_g.append("svg:path").attr("d",lt).style("fill","none").call(this.lineatt.func),Ge&&this.draw_g.append("svg:path").attr("d",Ge).call(this.markeratt.func),te&&this.draw_g.append("svg:path").attr("d",te).style("fill","none").style("pointer-events",this.isBatchMode()?null:"visibleFill")),E&&Hi&&xt(),B?this.finishTextDrawing():void 0}draw1DBins(){this.createHistDrawAttributes();const Re=this.getFramePainter(),He=Re.getGrFuncs(this.options.second_x,this.options.second_y),Ve=Re.getFrameWidth(),De=Re.getFrameHeight();return!this.draw_content||Ve<=0||De<=0?this.removeG():(this.createG(!0),this.options.Bar?this.drawBars(He,De).then(()=>{if(1===this.options.ErrorKind)return this.drawNormal(He,Ve,De)}):3===this.options.ErrorKind||4===this.options.ErrorKind?this.drawFilledErrors(He):this.drawNormal(He,Ve,De))}getBinTooltips(Re){const He=[],Ve=this.getObjectHint(),F=this.getFramePainter().getGrFuncs(this.options.second_x,this.options.second_y),J=this.getHisto(),Y=J.fXaxis.GetBinLowEdge(Re+1),ue=J.fXaxis.GetBinLowEdge(Re+2),Q=this.getAxisBinTip("x",J.fXaxis,Re);let me=J.getBinContent(Re+1);return Ve&&He.push(Ve),this.options.Error||this.options.Mark||this.isTF1()?(He.push("x = "+Q,"y = "+F.axisAsText("y",me)),this.options.Error&&("["===Q[0]&&He.push("error x = "+((ue-Y)/2).toPrecision(4)),He.push("error y = "+J.getBinError(Re+1).toPrecision(4)))):(He.push(`bin = ${Re+1}`,`x = ${Q}`),J.$baseh&&(me-=J.$baseh.getBinContent(Re+1)),me===Math.round(me)?He.push("entries = "+me):He.push("entries = "+(0,ve.lg)(me,x.gStyle.fStatFormat))),He}processTooltipEvent(Re){if(!Re||!this.draw_content||!this.draw_g||this.options.Mode3D)return this.draw_g?.selectChild(".tooltip_bin").remove(),null;const He=this.getFramePainter(),Ve=He.getGrFuncs(this.options.second_x,this.options.second_y),De=this.getHisto(),F=this.getSelectIndex("x","left",-1),J=this.getSelectIndex("x","right",2);let me,X,B,$,A,Y=He.getFrameWidth(),ue=He.getFrameHeight(),Q=null,E=2,g=F,v=J,f=Re.x,C=Re.y;const I=b=>{const P=De.fXaxis.GetBinLowEdge(b+1);return Ve.logx&&P<=0?null:Ve.grx(P)},U=b=>{const P=De.getBinContent(b+1);return Ve.logy&&P<Ve.scale_ymin?Ve.swap_xy?-1e3:10*ue:Math.round(Ve.gry(P))};Ve.swap_xy&&([f,C,Y,ue]=[C,f,ue,Y]);const k=Ve.swap_xy!==He.x_handle.reverse;for(;g<v-1;){const b=Math.round(.5*(g+v)),P=I(b);null===P||P<f-.5?k?v=b:g=b:P>f+.5?k?g=b:v=b:(g++,v--)}if(Q=v=g,X=I(Q),k){for(;g>F&&I(g-1)<X+2;)--g;for(;v<J&&I(v+1)>X-2;)++v}else{for(;g>F&&I(g-1)>X-2;)--g;for(;v<J&&I(v+1)<X+2;)++v}if(g<v){let b=ue;for(let P=g;P<=v;P++){const T=Math.abs(U(P)-C);T<b&&(b=T,Q=P)}b>ue/10&&(Q=Math.round(g+(v-g)/ue*C)),X=I(Q)}if(X=Math.round(X),B=Math.round(I(Q+1)),this.options.Bar){const b=B-X;X+=Math.round(De.fBarOffset/1e3*b),B=X+Math.round(De.fBarWidth/1e3*b)}X>B&&([X,B]=[B,X]);const Z=Math.round((X+B)/2),ee=$=A=U(Q);if(this.options.Bar)me=!0,E=0,$=Math.round(Ve.gry(!1!==this.options.BaseLine&&this.options.BaseLine>Ve.scale_ymin?this.options.BaseLine:Ve.scale_ymin)),$>A&&([$,A]=[A,$]),!Re.touch&&1===Re.nproc&&(C<$||C>A)&&(Q=null);else if(this.options.Error&&!0!==this.options.Hist||this.options.Mark||this.options.Line||this.options.Curve){me=!this.isTF1();let b=3;if(this.markeratt&&(b=Math.max(b,this.markeratt.getFullSize())),this.options.Error){const P=De.getBinContent(Q+1),T=De.getBinError(Q+1);$=Math.round(Ve.gry(P+T)),A=Math.round(Ve.gry(P-T)),0===P&&this.isTProfile()&&(Q=null);const z=(B-X)*this.options.errorX;X=Math.round(Z-z),B=Math.round(Z+z)}B-X<2*b&&(X=Z-b,B=Z+b),$=Math.min($,ee-b),A=Math.max(A,ee+b),!Re.touch&&1===Re.nproc&&(C<$||C>A)&&(Q=null)}else me=1===Re.nproc&&J-F<Y,me&&(A=ue,this.fillatt.empty()||(A=Math.min(ue,Math.max(0,Math.round(Ve.gry(0)))),A<$&&([$,A]=[A,$])),(Re.y<$||Re.y>A)&&!Re.touch&&(Q=null));null!==Q&&(Q===F&&X>f+E||Q===J-1&&B<f-E||f<X-E||f>B+E||!this.options.Zero&&0===De.getBinContent(Q+1))&&(Q=null);let he=this.draw_g.selectChild(".tooltip_bin");if(null===Q||A<=0||$>=ue)return he.remove(),null;const G={name:this.getObjectName(),title:De.fTitle,x:Z,y:ee,exact:!0,color1:this.lineatt?.color??"green",color2:this.fillatt?.getFillColorAlt("blue")??"blue",lines:this.getBinTooltips(Q)};if(Re.disabled)he.remove(),G.changed=!0;else if(me)he.empty()&&(he=this.draw_g.append("svg:rect").attr("class","tooltip_bin").style("pointer-events","none").call(ve.Ru)),G.changed=he.property("current_bin")!==Q,G.changed&&he.attr("x",Ve.swap_xy?$:X).attr("width",Ve.swap_xy?A-$:B-X).attr("y",Ve.swap_xy?X:$).attr("height",Ve.swap_xy?B-X:A-$).style("opacity","0.3").property("current_bin",Q),G.exact=Math.abs(ee-C)<=5||C>=$&&C<=A,G.menu=G.exact,G.menu_dist=Math.sqrt((Z-f)**2+(ee-C)**2);else{const b=this.lineatt.width+3;he.empty()&&(he=this.draw_g.append("svg:circle").attr("class","tooltip_bin").style("pointer-events","none").attr("r",b).call(this.lineatt.func).call(this.fillatt.func)),G.exact=Math.abs(Z-Re.x)<=b&&Math.abs(ee-Re.y)<=b,G.menu=G.exact,G.menu_dist=Math.sqrt((Z-Re.x)**2+(ee-Re.y)**2),G.changed=he.property("current_bin")!==Q,G.changed&&he.attr("cx",Z).attr("cy",ee).property("current_bin",Q)}return G.changed&&(G.user_info={obj:De,name:De.fName,bin:Q,cont:De.getBinContent(Q+1),grx:Z,gry:ee}),G}fillHistContextMenu(Re){Re.add("Auto zoom-in",()=>this.autoZoom());const He=this.getSupportedDrawOptions();Re.addDrawMenu("Draw with",He,Ve=>{if(0===Ve.indexOf(x.kInspect))return this.showInspector(Ve);this.decodeOptions(Ve),this.options.need_fillcol&&this.fillatt?.empty()&&this.fillatt.change(5,1001),this.interactiveRedraw("pad","drawopt")}),!this.snapid&&!this.isTProfile()&&!this.isTF1()&&Re.addRebinMenu(Ve=>this.rebinHist(Ve))}rebinHist(Re){const He=this.getHisto(),Ve=He.fXaxis,De=Math.floor(Ve.fNbins/Re);if(De<2)return;const F=new Array(De+2),J=Ve.fXbins.length>0?new Array(De):null;F[0]=He.fArray[0];let Y=1;for(let Q=1;Q<=De;++Q){J&&(J[Q-1]=Ve.fXbins[Y-1]);let me=0;for(let X=0;X<Re;++X)me+=He.fArray[Y++];F[Q]=me}J?(Y<=Ve.fXbins.length&&(Ve.fXmax=Ve.fXbins[Y-1]),Ve.fXbins=J):Ve.fXmax=Ve.fXmin+(Ve.fXmax-Ve.fXmin)/Ve.fNbins*De*Re,Ve.fNbins=De;let ue=0;for(;Y<He.fArray.length;)ue+=He.fArray[Y++];F[De+1]=ue,He.fArray=F,He.fSumw2=[],this.scanContent(),this.interactiveRedraw("pad")}autoZoom(){let Re=this.getSelectIndex("x","left",-1),He=this.getSelectIndex("x","right",1);const Ve=He-Re,De=this.getHisto();if(0===Ve||!De)return;let F=De.getBinContent(Re+1);for(let J=Re;J<He;++J)F=Math.min(F,De.getBinContent(J+1));if(!(F>0)){for(;Re<He&&De.getBinContent(Re+1)<=F;)++Re;for(;Re<He&&De.getBinContent(He)<=F;)--He;if(Re===He-1&&Re>2&&He<this.nbinsx-2&&(--Re,++He),He-Re<Ve&&Re<He)return this.getFramePainter().zoom(De.fXaxis.GetBinLowEdge(Re+1),De.fXaxis.GetBinLowEdge(He+1))}}canZoomInside(Re,He,Ve){const De=this.getHisto();return!!("x"===Re&&De&&De.fXaxis.FindBin(Ve,.5)-De.fXaxis.FindBin(He,0)>1||"y"===Re&&Math.abs(Ve-He)>1e-6*Math.abs(this.ymax-this.ymin))}callDrawFunc(Re){var He=this;return(0,Ee.A)(function*(){const Ve=He.getMainPainter(),De=He.getFramePainter();return Ve!==He&&De&&De.mode3d!==He.options.Mode3D&&He.copyOptionsFrom(Ve),He.options.Mode3D?He.draw3D(Re):He.draw2D(Re)})()}draw2D(){var Re=this;return(0,Ee.A)(function*(){return Re.clear3DScene(),Re.scanContent(!0),(Re.isMainPainter()?Re.drawColorPalette(!1):Promise.resolve(!0)).then(()=>Re.drawAxes()).then(()=>Re.draw1DBins()).then(()=>Re.drawHistTitle()).then(()=>Re.updateFunctions()).then(()=>(Re.updateStatWebCanvas(),Re.addInteractivity()))})()}draw3D(Re){var He=this;return(0,Ee.A)(function*(){return console.log("3D drawing is disabled, load ./hist/TH1Painter.mjs"),He.draw2D(Re)})()}redraw(Re){return this.callDrawFunc(Re)}static draw(Re,He,Ve){return(0,Ee.A)(function*(){return ke.mf._drawHist(new Ye(Re,He),Ve)})()}}},9997:(Yr,mt,Se)=>{"use strict";Se.d(mt,{AJ:()=>Ve,Hn:()=>Ze,N7:()=>Re,YB:()=>He});var Ee=Se(4882),x=Se(8872),L=Se(8362),ve=Se(2985),ke=Se(2843),ot=Se(1922),Ye=Se(4615);function Ze(De,F,J,Y,ue){const X=new Float32Array(4008),B=new Float32Array(4008),$=new Int32Array(4008),A=J.length,E=J[0],g=J[A-1],v=[],f=[0,0,0,0],C=[0,0,0,0],I=[0,0,0,0],U=[0,0,0,0],k=F.grx,Z=F.gry;let he,G,b,T,z,W,fe,we,Me,je,Ge,lt,bt,te,Je,ee=0,P=0;const Ne=A<10?qt=>{if(qt>=g)return A-1;for(let Ot=0;Ot<A;++Ot)if(qt<J[Ot])return Ot-1;return A-1}:qt=>{if(qt<E)return-1;if(qt>=g)return A-1;let Mn,Ot=0,Bn=A-1;for(;Bn-Ot>1;)Mn=Math.round((Bn+Ot)/2),qt<J[Mn]?Bn=Mn:Ot=Mn;return Ot},rt=(qt,Ot,Bn,Mn,bn,Dn,$n,Cn)=>{const yn=Bn===$n,Sn=yn?Cn-Mn:$n-Bn,ii=bn-qt;let Nr,ss,Bs,yo,ai=Ot+1,Hi=ee-1,ti=0;const xt=Hi+1002-3;for(;ai<=Dn&&Hi<=xt;)yo=J[ai],Bs=yo-qt,ss=Bs/ii,Nr=Sn*ss,yn?(X[Hi]=Bn,B[Hi]=Mn+Nr):(X[Hi]=Bn+Nr,B[Hi]=Mn),$[Hi]=ai,ti++,Hi+=2,ai++;return ti};for(z=F.j1;z<F.j2-1;++z)for(C[1]=C[0]=(Z[z]+Z[z+1])/2,C[3]=C[2]=(Z[z+1]+Z[z+2])/2,T=F.i1;T<F.i2-1;++T){for(I[0]=De.getBinContent(T+1,z+1),I[1]=De.getBinContent(T+2,z+1),I[2]=De.getBinContent(T+2,z+2),I[3]=De.getBinContent(T+1,z+2),W=0;W<4;W++)U[W]=Ne(I[W]);if(U[0]!==U[1]||U[1]!==U[2]||U[2]!==U[3]||U[3]!==U[0]){for(f[3]=f[0]=(k[T]+k[T+1])/2,f[2]=f[1]=(k[T+1]+k[T+2])/2,fe=I[0]<=I[1]?0:1,we=I[2]<=I[3]?2:3,I[fe]>I[we]&&(fe=we),fe++,ee=1,te=1;te<=4;te++)we=fe%4+1,Me=rt(I[fe-1],U[fe-1],f[fe-1],C[fe-1],I[we-1],U[we-1],f[we-1],C[we-1]),ee+=2*Me,fe=we;for(fe=I[0]<=I[1]?0:1,we=I[2]<=I[3]?2:3,I[fe]>I[we]&&(fe=we),fe++,ee=2,te=1;te<=4;te++)we=1===fe?4:fe-1,Me=rt(I[fe-1],U[fe-1],f[fe-1],C[fe-1],I[we-1],U[we-1],f[we-1],C[we-1]),ee+=2*Me,fe=we;for(je=0,te=1;te<=ee-5;te+=2)for(;$[te-1]!==$[te];){for(Ge=X[te],lt=B[te],bt=$[te],Je=te;Je<=ee-5;Je+=2)X[Je]=X[Je+2],B[Je]=B[Je+2],$[Je]=$[Je+2];if(X[ee-3]=Ge,B[ee-3]=lt,$[ee-3]=bt,je>2e3)break;je++}if(je>100)continue;for(te=1;te<=ee-2;te+=2)he=$[te-1],he>=0&&he<J.length&&(G=v[he],G||(G=v[he]=(0,x.createTPolyLine)(8016,!0)),b=G.fLastPoint,b<G.fN-2&&(G.fX[b+1]=Math.round(X[te-1]),G.fY[b+1]=Math.round(B[te-1]),G.fX[b+2]=Math.round(X[te]),G.fY[b+2]=Math.round(B[te]),G.fLastPoint=b+2,P=Math.max(P,G.fLastPoint+1)))}}const St=new Int32Array(J.length);let pt=0;for(he=0;he<J.length;he++)if(J[he]>=0){pt=he;break}for(W=0,he=pt-1;he>=0;he--)St[W]=he,W++;for(he=pt;he<J.length;he++)St[W]=he,W++;const st=new Float32Array(2*P),vt=new Float32Array(2*P),Yt=(0,x.isFunc)(Y.calcColorIndex);for(W=0;W<J.length;++W){if(he=St[W],G=v[he],!G)continue;const qt=Yt?Y.calcColorIndex(he,J.length):he,Ot=G.fX,Bn=G.fY,Mn=G.fLastPoint+1,bn=0,Dn=0;let Cn,yn,Sn,$n=0;for(;;){for(Cn=P,yn=Cn+1,st[Cn]=Ot[$n],vt[Cn]=Bn[$n],st[yn]=Ot[$n+1],vt[yn]=Bn[$n+1],Ot[$n]=Ot[$n+1]=bn,Bn[$n]=Bn[$n+1]=Dn;;){for(Sn=0,T=2;T<Mn;T+=2)yn<2*P-1&&Ot[T]===st[yn]&&Bn[T]===vt[yn]&&(yn++,st[yn]=Ot[T+1],vt[yn]=Bn[T+1],Ot[T]=Ot[T+1]=bn,Bn[T]=Bn[T+1]=Dn,Sn++),Cn>0&&Ot[T+1]===st[Cn]&&Bn[T+1]===vt[Cn]&&(Cn--,st[Cn]=Ot[T],vt[Cn]=Bn[T],Ot[T]=Ot[T+1]=bn,Bn[T]=Bn[T+1]=Dn,Sn++);if(0===Sn)break}for(Cn+1<yn&&Cn>=0&&ue(qt,st,vt,Cn,yn,he),$n=0,T=2;T<Mn;T+=2)if(Ot[T]!==bn&&Bn[T]!==Dn){$n=T;break}if(0===$n)break}}}class Re{constructor(F,J,Y,ue,Q,me,X){let B=[Y,ue];if(F){B=new Float32Array(F.length);for(let fe=0;fe<F.length;++fe)B[fe]=J(F[fe])}Object.assign(this,{grz_min:Y,grz_max:ue,dolines:Q,donormals:me,dogrid:X}),this.loop=0;const $=[],A=[],E=[],g=new Float32Array(18),v=new Float32Array(6),f=(B[B.length-1]-B[0])/B.length/100;let C=0,I=null,U=0,k=0,Z=null,ee=0,he=[],G=0,b=0,P=0;function T(fe,we,Me,je){return fe<we-je?-1:fe>Me+je?1:0}function z(fe,we,Me,je,Ge,lt,bt,te){G>=g.length&&console.log("more than 6 points???");const Je=(bt-Me)/(lt-Me);let tt=3;0!==b&&Math.abs(Je)<Math.abs(b)&&(g[G]=g[G-3],g[G+1]=g[G-2],g[G+2]=g[G-1],G-=3,tt=6),g[G]=fe+Je*(je-fe),g[G+1]=we+Je*(Ge-we),g[G+2]=bt,te&&Z&&(v[P]=g[G],v[P+1]=g[G+1],v[P+2]=g[G+2],P+=3),G+=tt,b=Je}function W(fe,we,Me,je){const Ge=8*((Me-we.i1)*(we.j2-we.j1)+(je-we.j1));if(he[Ge]>=0)return console.error("More than 8 vertexes for the bin");const lt=Ge+8+he[Ge];he[Ge]--,he[lt]=fe}this.createNormIndex=function(fe){fe.donormals&&(he=new Int32Array((fe.i2-fe.i1)*(fe.j2-fe.j1)*8).fill(-1))},this.createBuffers=function(){if(this.loop){for(let fe=1;fe<B.length;++fe)$[fe]&&(A[fe]=new Float32Array(9*$[fe]),E[fe]=0);this.dolines&&C>0&&(I=new Float32Array(6*C)),this.dogrid&&k>0&&(Z=new Float32Array(6*k))}},this.addLineSegment=function(fe,we,Me,je,Ge,lt){if(!this.dolines)return;const bt=T(Me,this.grz_min,this.grz_max,0),te=T(lt,this.grz_min,this.grz_max,0);if(bt!==te||0===bt){if(!this.loop)return++C;if(0!==bt){const Je=lt-Me;fe=je-(je-fe)/Je*(lt-(Me=bt<0?this.grz_min:this.grz_max)),we=Ge-(Ge-we)/Je*(lt-Me)}if(0!==te){const Je=Me-lt;je=fe-(fe-je)/Je*(Me-(lt=te<0?this.grz_min:this.grz_max)),Ge=we-(we-Ge)/Je*(Me-lt)}I[U]=fe,I[U+1]=we,I[U+2]=Me,U+=3,I[U]=je,I[U+1]=Ge,I[U+2]=lt,U+=3}},this.addMainTriangle=function(fe,we,Me,je,Ge,lt,bt,te,Je,tt,Fe,Ne,rt){for(let St=1;St<B.length;++St){let pt=T(Me,B[St-1],B[St],f),st=T(lt,B[St-1],B[St],f),vt=T(Je,B[St-1],B[St],f),Yt=pt+st+vt;if(St>1&&St===B.length-1&&3===Yt&&Me<=this.grz_max&&(pt=st=vt=Yt=0),3===Yt)continue;if(-3===Yt)return;if(!this.loop){let Bn=Math.abs(st-pt)+Math.abs(vt-st)+Math.abs(pt-vt);0===pt&&++Bn,0===st&&++Bn,0===vt&&++Bn,(1===Bn||2===Bn)&&console.error(`FOUND npnts = ${Bn}`),Bn>2&&(void 0===$[St]&&($[St]=0),$[St]+=Bn-2),(pt>0||st>0||vt>0)&&(pt!==st||st!==vt||vt!==pt)&&++k;continue}if(P=0,G=0,0===pt&&(g[G]=fe,g[G+1]=we,g[G+2]=Me,G+=3),pt!==st&&(b=0,(pt<0||st<0)&&z(fe,we,Me,je,Ge,lt,B[St-1]),(pt>0||st>0)&&z(fe,we,Me,je,Ge,lt,B[St],!0)),0===st&&(g[G]=je,g[G+1]=Ge,g[G+2]=lt,G+=3),st!==vt&&(b=0,(st<0||vt<0)&&z(je,Ge,lt,bt,te,Je,B[St-1]),(st>0||vt>0)&&z(je,Ge,lt,bt,te,Je,B[St],!0)),0===vt&&(g[G]=bt,g[G+1]=te,g[G+2]=Je,G+=3),vt!==pt&&(b=0,(vt<0||pt<0)&&z(bt,te,Je,fe,we,Me,B[St-1]),(vt>0||pt>0)&&z(bt,te,Je,fe,we,Me,B[St],!0)),0===G)continue;if(G<9){console.log(`found ${G/3} points, must be at least 3`);continue}if(Z&&6===P){for(let Bn=0;Bn<6;++Bn)Z[ee+Bn]=v[Bn];ee+=6}const qt=A[St];let Ot=E[St];this.donormals&&9===G&&(W(Ot,Fe,Ne,rt),W(Ot+3,Fe,Ne+1,tt?rt+1:rt),W(Ot+6,Fe,tt?Ne:Ne+1,rt+1));for(let Bn=3;Bn<G-3;Bn+=3)qt[Ot]=g[0],qt[Ot+1]=g[1],qt[Ot+2]=g[2],Ot+=3,qt[Ot]=g[Bn],qt[Ot+1]=g[Bn+1],qt[Ot+2]=g[Bn+2],Ot+=3,qt[Ot]=g[Bn+3],qt[Ot+1]=g[Bn+4],qt[Ot+2]=g[Bn+5],Ot+=3;E[St]=Ot}},this.callFuncs=function(fe,we){for(let Me=1;Me<B.length;++Me)A[Me]&&fe&&fe(Me,A[Me],he);I&&we&&(6*C!==U&&console.error(`SURF lines mismmatch nsegm=${C} lindx=${U} diff=${6*C-U}`),we(!1,I)),Z&&we&&(6*k!==ee&&console.error(`SURF grid draw mismatch ngridsegm=${k} gindx=${ee} diff=${6*k-ee}`),we(!0,Z))}}}function He(De,F,J,Y,ue){const Q=F.grz,me=F.original?F.origx:F.grx,X=F.original?F.origy:F.gry,B=new Re(J,F.grz,F.grz_min,F.grz_max,F.dolines,F.donormals,F.dogrid);let $,A,E,g,v,f,C,I,U,k;for(B.createNormIndex(F),B.loop=0;B.loop<2;++B.loop)for(B.createBuffers(),$=F.i1;$<F.i2-1;++$)for(E=F.original?.5*(me[$]+me[$+1]):me[$],g=F.original?.5*(me[$+1]+me[$+2]):me[$+1],A=F.j1;A<F.j2-1;++A)v=F.original?.5*(X[A]+X[A+1]):X[A],f=F.original?.5*(X[A+1]+X[A+2]):X[A+1],C=Q(De.getBinContent($+1,A+1)),I=Q(De.getBinContent($+1,A+2)),U=Q(De.getBinContent($+2,A+1)),k=Q(De.getBinContent($+2,A+2)),B.addMainTriangle(E,v,C,g,f,k,E,f,I,!0,F,$,A),B.addMainTriangle(E,v,C,g,v,U,g,f,k,!1,F,$,A),B.addLineSegment(E,f,I,E,v,C),B.addLineSegment(E,v,C,g,v,U),$===F.i2-2&&B.addLineSegment(g,v,U,g,f,k),A===F.j2-2&&B.addLineSegment(E,f,I,g,f,k);B.callFuncs(Y,ue)}class Ve extends Ye.mf{constructor(F,J){super(F,J),this.wheel_zoomy=!0,this._show_empty_bins=!1}cleanup(){delete this.tt_handle,super.cleanup()}toggleProjection(F,J){("Projections"===F||"Off"===F)&&(F="");let Y=J,ue=J;if((0,x.isStr)(F)&&0===F.indexOf("XY")){const me=F.length>2?F.slice(2):"";F="XY",Y=ue=parseInt(me)||1}else if((0,x.isStr)(F)&&F.length>1){const me=F.indexOf("_");me>0&&"X"===F[0]&&"Y"===F[me+1]?(Y=parseInt(F.slice(1,me))||1,ue=parseInt(F.slice(me+2))||1,F="XY"):me>0&&"Y"===F[0]&&"X"===F[me+1]?(ue=parseInt(F.slice(1,me))||1,Y=parseInt(F.slice(me+2))||1,F="XY"):(Y=ue=parseInt(F.slice(1))||1,F=F[0])}if(!Y&&!ue&&(Y=ue=1),F&&this.is_projection===F){if(this.projection_widthX!==Y||this.projection_widthY!==ue)return this.projection_widthX=Y,void(this.projection_widthY=ue);F=""}delete this.proj_hist;const Q=this.is_projection===F?"":F;this.projection_widthX=Y,this.projection_widthY=ue,this.is_projection="",this.provideSpecialDrawArea(Q).then(()=>(this.is_projection=Q,this.redrawProjection()))}redrawProjection(F,J,Y,ue){var Q=this;return(0,Ee.A)(function*(){if(!Q.is_projection)return!1;if(void 0===ue){if(!Q.tt_handle)return;F=Math.round((Q.tt_handle.i1+Q.tt_handle.i2)/2),J=F+1,Y=Math.round((Q.tt_handle.j1+Q.tt_handle.j2)/2),ue=Y+1}const me=Q.getCanvPainter();if(me&&!me._readonly&&void 0!==Q.snapid)return("X"===Q.is_projection||"XY"===Q.is_projection)&&!me.websocketTimeout("projX")&&me.sendWebsocket(`EXECANDSEND:DXPROJ:${Q.snapid}:ProjectionX("_projx",${Y+1},${ue},"")`)&&me.websocketTimeout("projX",1e3),("Y"===Q.is_projection||"XY"===Q.is_projection)&&!me.websocketTimeout("projY")&&me.sendWebsocket(`EXECANDSEND:DYPROJ:${Q.snapid}:ProjectionY("_projy",${F+1},${J},"")`)&&me.websocketTimeout("projY",1e3),!0;if(Q.doing_projection)return!1;Q.doing_projection=!0;const X=Q.getHisto(),B=()=>{const E=(0,x.createHistogram)(x.clTH1D,Q.nbinsx);return Object.assign(E.fXaxis,X.fXaxis),E.fName="xproj",E.fTitle="X projection",E},$=()=>{const E=(0,x.createHistogram)(x.clTH1D,Q.nbinsy);return Object.assign(E.fXaxis,X.fYaxis),E.fName="yproj",E.fTitle="Y projection",E},A=(E,g)=>{let v=0,f=-1;if("X"===E){for(let C=0;C<Q.nbinsx;++C){let I=0;for(let U=Y;U<ue;++U)I+=X.getBinContent(C+1,U+1);g.setBinContent(C+1,I)}g.fTitle="X projection "+(Y+1===ue?`bin ${ue}`:`bins [${Y+1} .. ${ue}]`),Q.tt_handle&&(v=Q.tt_handle.i1+1,f=Q.tt_handle.i2)}else{for(let C=0;C<Q.nbinsy;++C){let I=0;for(let U=F;U<J;++U)I+=X.getBinContent(U+1,C+1);g.setBinContent(C+1,I)}g.fTitle="Y projection "+(F+1===J?`bin ${J}`:`bins [${F+1} .. ${J}]`),Q.tt_handle&&(v=Q.tt_handle.j1+1,f=Q.tt_handle.j2)}if(v<f){const C=g.fXaxis;C.fFirst=v,C.fLast=f,(1===C.fFirst&&C.fLast===C.fNbins)===C.TestBit(ot.rb.kAxisRange)&&C.InvertBit(ot.rb.kAxisRange)}g.fEntries=0,g.fTsumw=0};if(!Q.proj_hist)switch(Q.is_projection){case"X":Q.proj_hist=B();break;case"XY":Q.proj_hist=B(),Q.proj_hist2=$();break;default:Q.proj_hist=$()}return"XY"===Q.is_projection?(A("X",Q.proj_hist),A("Y",Q.proj_hist2),Q.drawInSpecialArea(Q.proj_hist,"","X").then(()=>Q.drawInSpecialArea(Q.proj_hist2,"","Y")).then(E=>(delete Q.doing_projection,E))):(A(Q.is_projection,Q.proj_hist),Q.drawInSpecialArea(Q.proj_hist).then(E=>(delete Q.doing_projection,E)))})()}executeMenuCommand(F,J){return!!super.executeMenuCommand(F,J)||("SetShowProjectionX"===F.fName||"SetShowProjectionY"===F.fName?(this.toggleProjection(F.fName[17],J&&parseInt(J)?parseInt(J):1),!0):"SetShowProjectionXY"===F.fName&&(this.toggleProjection("X"+J.replaceAll(",","_Y")),!0))}fillHistContextMenu(F){if(!this.isTH2Poly()&&this.getPadPainter()?.iscan){let Y=this.is_projection||"";Y&&(Y+=this.projection_widthX),this.projection_widthX!==this.projection_widthY&&"XY"===this.is_projection&&(Y=`X${this.projection_widthX}_Y${this.projection_widthY}`);const ue=["X1","X2","X3","X5","X10","Y1","Y2","Y3","Y5","Y10","XY1","XY2","XY3","XY5","XY10"];Y&&ue.unshift("Off"),F.add("sub:Projections",()=>F.input("Input projection kind X1 or XY2 or X3_Y4",Y,"string").then(Q=>this.toggleProjection(Q)));for(let Q=0;Q<ue.length;++Q)F.addchk(Y===ue[Q],ue[Q],ue[Q],me=>this.toggleProjection(me));F.add("endsub:")}this.isTH2Poly()||F.add("Auto zoom-in",()=>this.autoZoom());const J=this.getSupportedDrawOptions();F.addDrawMenu("Draw with",J,Y=>{if(0===Y.indexOf(x.kInspect))return this.showInspector(Y);this.decodeOptions(Y),this.interactiveRedraw("pad","drawopt")}),(this.options.Color||this.options.Contour||this.options.Surf||12===this.options.Lego||14===this.options.Lego)&&this.fillPaletteMenu(F,!0)}clickButton(F){const J=super.clickButton(F);if(J)return J;if(this.isMainPainter())switch(F){case"ToggleColor":return this.toggleColor();case"ToggleColorZ":return this.toggleColz();case"Toggle3D":return this.toggleMode3D()}return!1}fillToolbar(){super.fillToolbar(!0);const F=this.getPadPainter();F&&(!this.isTH2Poly()&&!this.options.Axis&&F.addPadButton("th2color","Toggle color","ToggleColor"),this.options.Axis||F.addPadButton("th2colorz","Toggle color palette","ToggleColorZ"),F.addPadButton("th2draw3d","Toggle 3D mode","Toggle3D"),F.showPadButtons())}toggleColor(){return this.options.Mode3D?(this.options.Mode3D=!1,this.options.Color=!0):(this.options.Color=!this.options.Color,this.options.Scat=!this.options.Color),this._can_move_colz=!0,this.copyOptionsToOthers(),this.interactiveRedraw("pad","drawopt")}autoZoom(){if(this.isTH2Poly())return;const F=this.getSelectIndex("x","left",-1),J=this.getSelectIndex("x","right",1),Y=this.getSelectIndex("y","left",-1),ue=this.getSelectIndex("y","right",1),Q=this.getObject();if(F===J||Y===ue)return;let me=Q.getBinContent(F+1,Y+1);for(let I=F;I<J;++I)for(let U=Y;U<ue;++U)me=Math.min(me,Q.getBinContent(I+1,U+1));if(me>0)return;let X=J,B=F,$=ue,A=Y;for(let I=F;I<J;++I)for(let U=Y;U<ue;++U)Q.getBinContent(I+1,U+1)>me&&(I<X&&(X=I),I>=B&&(B=I+1),U<$&&($=U),U>=A&&(A=U+1));let E,g,v,f,C=!1;return X===B-1&&X>F+1&&B<J-1&&(X--,B++),$===A-1&&$>Y+1&&A<ue-1&&($--,A++),(X>F||B<J)&&X<B-1&&(E=Q.fXaxis.GetBinLowEdge(X+1),g=Q.fXaxis.GetBinLowEdge(B+1),C=!0),($>Y||A<ue)&&$<A-1&&(v=Q.fYaxis.GetBinLowEdge($+1),f=Q.fYaxis.GetBinLowEdge(A+1),C=!0),C?this.getFramePainter().zoom(E,g,v,f):void 0}scanContent(F){if(F&&this.nbinsx&&this.nbinsy)return;const J=this.getObject();let Y,ue;if(this.extractAxesProperties(2),this.isTH2Poly()){this.gminposbin=null,this.gminbin=this.gmaxbin=0;for(let Q=0,me=J.fBins.arr.length;Q<me;++Q){const X=J.fBins.arr[Q].fContent;0===Q&&(this.gminbin=this.gmaxbin=X),X<this.gminbin?this.gminbin=X:X>this.gmaxbin&&(this.gmaxbin=X),X>0&&(null===this.gminposbin||this.gminposbin>X)&&(this.gminposbin=X)}}else for(this.gminbin=this.gmaxbin=J.getBinContent(1,1),this.gminposbin=null,Y=0;Y<this.nbinsx;++Y)for(ue=0;ue<this.nbinsy;++ue){const Q=J.getBinContent(Y+1,ue+1);Q<this.gminbin?this.gminbin=Q:Q>this.gmaxbin&&(this.gmaxbin=Q),Q>0&&(null===this.gminposbin||this.gminposbin>Q)&&(this.gminposbin=Q)}null===this.gminposbin&&this.gmaxbin>0&&(this.gminposbin=1e-4*this.gmaxbin),this.options.Axis>0?this.draw_content=!1:(this.draw_content=0!==this.gmaxbin||0!==this.gminbin,!this.draw_content&&this.options.Zero&&this.isTH2Poly()&&(this.draw_content=!0,this.options.Line=1))}countStat(F,J){(0,x.isFunc)(F)||(F=this.options.cutg?(T,z)=>this.options.cutg.IsInside(T,z):null);const Y=this.getHisto(),ue=Y.fXaxis,Q=Y.fYaxis,me=this.getFramePainter(),X=me.getGrFuncs(this.options.second_x,this.options.second_y),B={name:Y.fName,entries:0,eff_entries:0,integral:0,meanx:0,meany:0,rmsx:0,rmsy:0,matrix:[0,0,0,0,0,0,0,0,0],xmax:0,ymax:0,wmax:null,skewx:0,skewy:0,skewd:0,kurtx:0,kurty:0,kurtd:0},$=!me.isAxisZoomed("x")&&!me.isAxisZoomed("y")&&Math.abs(Y.fTsumw)>1e-300&&!F;let I,U,k,Z,ee,he,G,b,P,A=0,E=0,g=0,v=0,f=0,C=0;if(this.isTH2Poly()){const T=Y.fBins.arr.length;let z,W,fe,we,Me,je,Ge;for(z=0;z<T;++z){for(W=Y.fBins.arr[z],I=W.fXmin>X.scale_xmax?2:W.fXmax<X.scale_xmin?0:1,U=W.fYmin>X.scale_ymax?2:W.fYmax<X.scale_ymin?0:1,k=Z=Ge=0,we=W.fPoly,je=1,we._typename===x.clTMultiGraph&&(je=W.fPoly.fGraphs.arr.length,we=null),Me=0;Me<je;++Me)for((!we||Me>0)&&(we=W.fPoly.fGraphs.arr[Me]),fe=0;fe<we.fNpoints;++fe)++Ge,k+=we.fX[fe],Z+=we.fY[fe];Ge>1&&(k/=Ge,Z/=Ge),ee=W.fContent,B.entries+=ee,B.matrix[3*U+I]+=ee,1===I&&1===U&&(!F||F(k,Z))&&((null===B.wmax||ee>B.wmax)&&(B.wmax=ee,B.xmax=k,B.ymax=Z),$||(A+=ee,E+=ee*ee,g+=k*ee,v+=Z*ee,f+=k*k*ee,C+=Z*Z*ee))}}else{he=this.getSelectIndex("x","left"),G=this.getSelectIndex("x","right"),b=this.getSelectIndex("y","left"),P=this.getSelectIndex("y","right");for(let T=0;T<=this.nbinsx+1;++T){I=T<=he?0:T>G?2:1,k=ue.GetBinCoord(T-.5);for(let z=0;z<=this.nbinsy+1;++z)U=z<=b?0:z>P?2:1,Z=Q.GetBinCoord(z-.5),ee=Y.getBinContent(T,z),B.entries+=ee,B.matrix[3*U+I]+=ee,1===I&&1===U&&(!F||F(k,Z))&&((null===B.wmax||ee>B.wmax)&&(B.wmax=ee,B.xmax=k,B.ymax=Z),$||(A+=ee,E+=ee*ee,g+=k*ee,v+=Z*ee,f+=k**2*ee,C+=Z**2*ee))}}if($&&(A=Y.fTsumw,E=Y.fTsumw2,g=Y.fTsumwx,f=Y.fTsumwx2,v=Y.fTsumwy,C=Y.fTsumwy2),Math.abs(A)>1e-300&&(B.meanx=g/A,B.meany=v/A,B.rmsx=Math.sqrt(Math.abs(f/A-B.meanx**2)),B.rmsy=Math.sqrt(Math.abs(C/A-B.meany**2))),null===B.wmax&&(B.wmax=0),B.integral=A,Y.fEntries>1&&(B.entries=Y.fEntries),B.eff_entries=E?A*A/E:Math.abs(A),J&&!this.isTH2Poly()){let T=0,z=0,W=0,fe=0,we=0,Me=0;for(let te=he;te<G;++te){k=ue.GetBinCoord(te+.5);for(let Je=b;Je<P;++Je)Z=Q.GetBinCoord(Je+.5),(!F||F(k,Z))&&(Me=Y.getBinContent(te+1,Je+1),we+=Me,T+=Me*Math.pow(k-B.meanx,3),z+=Me*Math.pow(Z-B.meany,3),W+=Me*Math.pow(k-B.meanx,4),fe+=Me*Math.pow(Z-B.meany,4))}const je=Math.pow(B.rmsx,3),Ge=Math.pow(B.rmsy,3),lt=Math.pow(B.rmsx,4),bt=Math.pow(B.rmsy,4);we*je!=0&&(B.skewx=T/(we*je)),we*Ge!=0&&(B.skewy=z/(we*Ge)),B.skewd=B.eff_entries>0?Math.sqrt(6/B.eff_entries):0,we*lt!=0&&(B.kurtx=W/(we*lt)-3),we*bt!=0&&(B.kurty=fe/(we*bt)-3),B.kurtd=B.eff_entries>0?Math.sqrt(24/B.eff_entries):0}return B}fillStatistic(F,J,Y){if(this.isIgnoreStatsFill())return!1;1===J&&(J=1111);const ue=Math.floor(J%10),Q=Math.floor(J/10)%10,me=Math.floor(J/100)%10,X=Math.floor(J/1e3)%10,B=Math.floor(J/1e4)%10,$=Math.floor(J/1e5)%10,A=Math.floor(J/1e6)%10,E=Math.floor(J/1e7)%10,g=Math.floor(J/1e8)%10,v=this.countStat(void 0,E>0||g>0);if(F.clearPave(),ue>0&&F.addText(v.name),Q>0&&F.addText("Entries = "+F.format(v.entries,"entries")),me>0&&(F.addText("Mean x = "+F.format(v.meanx)),F.addText("Mean y = "+F.format(v.meany))),X>0&&(F.addText("Std Dev x = "+F.format(v.rmsx)),F.addText("Std Dev y = "+F.format(v.rmsy))),A>0&&F.addText("Integral = "+F.format(v.matrix[4],"entries")),2===E?(F.addText(`Skewness x = ${F.format(v.skewx)} #pm ${F.format(v.skewd)}`),F.addText(`Skewness y = ${F.format(v.skewy)} #pm ${F.format(v.skewd)}`)):E>0&&(F.addText(`Skewness x = ${F.format(v.skewx)}`),F.addText(`Skewness y = ${F.format(v.skewy)}`)),2===g?(F.addText(`Kurtosis x = ${F.format(v.kurtx)} #pm ${F.format(v.kurtd)}`),F.addText(`Kurtosis y = ${F.format(v.kurty)} #pm ${F.format(v.kurtd)}`)):g>0&&(F.addText(`Kurtosis x = ${F.format(v.kurtx)}`),F.addText(`Kurtosis y = ${F.format(v.kurty)}`)),B>0||$>0){const f=C=>v.matrix[C].toFixed(0);F.addText(`${f(6)} | ${f(7)} | ${f(7)}`),F.addText(`${f(3)} | ${f(4)} | ${f(5)}`),F.addText(`${f(0)} | ${f(1)} | ${f(2)}`)}return Y&&F.fillFunctionStat(this.findFunction(x.clTF2),Y,2),!0}drawBinsColor(){const F=this.getHisto(),J=this.prepareDraw(),Y=this.getContour(),ue=this.getHistPalette(),Q=[],me=this._show_empty_bins,X=1===J.xbar2&&0===J.xbar1,B=1===J.ybar2&&0===J.ybar1;let $,A,E,g,v,f,C,I=null,U=!this.options.Zero;const k=this.options.cutg,Z=()=>{I.path+=`h${$}v${I.y1-I.y2}h${-$}z`,I=null};!U&&!me&&null===Y.getPaletteIndex(ue,0)&&(U=!0);for(let ee=J.i1;ee<J.i2;++ee){$=J.grx[ee+1]-J.grx[ee]||1,X?E=J.grx[ee]:(E=Math.round(J.grx[ee]+$*J.xbar1),$=Math.round($*(J.xbar2-J.xbar1))||1);for(let he=J.j2-1;he>=J.j1;--he){if(v=F.getBinContent(ee+1,he+1),f=0===v,f&&U||k&&!k.IsInside(F.fXaxis.GetBinCoord(ee+.5),F.fYaxis.GetBinCoord(he+.5))){I&&Z();continue}if(C=Y.getPaletteIndex(ue,v),null===C){if(!f||!me){I&&Z();continue}C=0}A=J.gry[he]-J.gry[he+1]||1,B?g=J.gry[he+1]:(g=Math.round(J.gry[he]-A*J.ybar2),A=Math.round(A*(J.ybar2-J.ybar1))||1);const G=`M${E},${g}`;let b=Q[C];if(b){if(B&&b===I){b.y1=g+A;continue}{const P=E-b.x1,T=g-b.y2;if(P||T){const z=`m${P},${T}`;b.path+=z.length<G.length?z:G}}}else b=Q[C]={path:G};I&&Z(),b.x1=E,b.y2=g,B?(b.y1=g+A,I=b):b.path+=`h${$}v${A}h${-$}z`}I&&Z()}return Q.forEach((ee,he)=>{ee&&this.draw_g.append("svg:path").attr("fill",ue.getColor(he)).attr("d",ee.path)}),J}drawBinsProjected(){const F=this.prepareDraw({rounding:!1,nozoom:!0,extra:100,original:!0}),J=this.getFramePainter(),Y=J.getGrFuncs(this.options.second_x,this.options.second_y),ue=this.getContourLevels(),Q=this.getHistPalette(),me=J.getProjectionFunc();return F.grz=X=>X,F.grz_min=ue[0],F.grz_max=ue[ue.length-1],He(this.getHisto(),F,ue,(X,B)=>{let A,E,$="";for(let g=0;g<B.length;g+=3){const v=me(B[g],B[g+1]),f=Math.round(Y.grx(v.x)),C=Math.round(Y.gry(v.y));if(0===g)$=`M${f},${C}`;else{if(f===A&&C===E)continue;$+=g%9==0?`m${f-A},${C-E}`:C===E?"h"+(f-A):f===A?"v"+(C-E):`l${f-A},${C-E}`}A=f,E=C}this.draw_g.append("svg:path").attr("d",$).style("fill",Q.calcColor(X,ue.length))}),F}drawBinsContour(){const F=this.prepareDraw({rounding:!1,extra:100}),J=this.getFramePainter(),Y=J.getFrameWidth(),ue=J.getFrameHeight(),Q=this.getContourLevels(),me=this.getHistPalette(),X=($,A)=>{const E=$.x2-$.x1,g=$.y2-$.y1,v=A.x2-A.x1,f=A.y2-A.y1,C=E*f-v*g;if(0===C)return 0;const I=C>0,U=$.x1-A.x1,k=$.y1-A.y1,Z=E*k-g*U;if(Z<0===I)return null;const ee=v*k-f*U;if(ee<0===I||Z>C===I||ee>C===I)return null;const he=ee/C;return{x:Math.round($.x1+he*E),y:Math.round($.y1+he*g)}},B=($,A,E,g,v,f)=>{let I,U,k,Z,he,G,b,C="",ee=!1;for(let Ge=E;Ge<=g;++Ge){if(G=Math.round($[Ge]),b=Math.round(A[Ge]),C)if(Ge===g&&E!==g&&G===k&&b===Z){if(!ee)return"";C+="z",v=!1,he=!0}else{const lt=G-I,bt=b-U;lt?(ee=!0,C+=bt?`l${lt},${bt}`:`h${lt}`):bt&&(ee=!0,C+=`v${bt}`)}else C=`M${G},${b}`,k=G,Z=b;I=G,U=b}if(!v||he||!f)return v?C+"z":C;const P=[{x:0,y:0},{x:Y,y:0},{x:Y,y:ue},{x:0,y:ue}],T=(Ge,lt)=>{const bt={x1:$[Ge],y1:A[Ge],x2:2*$[Ge]-$[Ge+lt],y2:2*A[Ge]-A[Ge+lt]};for(let te=0;te<4;++te){const Je=X(bt,{x1:P[te].x,y1:P[te].y,x2:P[(te+1)%4].x,y2:P[(te+1)%4].y});if(Je)return Je.indx=te+.5,Je}return null};let z,W;for(E--;E<g-1&&!z;)z=T(++E,1);if(!z)return"";for(g++;E<g-1&&!W;)W=T(--g,-1);if(!W)return"";let fe=B($,A,E,g),we=W.indx;for(fe+=`L${W.x},${W.y}`;Math.abs(we-z.indx)>.1;)we=Math.round(we+.5)%4,fe+=`L${P[we].x},${P[we].y}`,we+=.5;return fe+`L${z.x},${z.y}z`};return 14===this.options.Contour&&this.draw_g.append("svg:path").attr("d",`M0,0h${Y}v${ue}h${-Y}z`).style("fill",me.calcColor(0,Q.length)),Ze(this.getHisto(),F,Q,me,($,A,E,g,v,f)=>{const C=me.getColor($);let U,I=C;switch(this.options.Contour){case 1:case 14:break;case 11:I="none",U=this.createAttLine({color:C,std:!1});break;case 12:I="none",U=this.createAttLine({color:1,style:f%5+1,width:1,std:!1});break;case 13:I="none",U=this.lineatt}const k=B(A,E,g,v,"none"!==I,!0);if(!k)return;const Z=this.draw_g.append("svg:path").attr("d",k).style("fill",I);U&&Z.call(U.func)}),F.hide_only_zeros=!0,F}createPolyBin(F,J,Y){let B,ue="",Q="",me=0,X=0,$=1,A=null;J.fPoly._typename===x.clTMultiGraph?$=J.fPoly.fGraphs.arr.length:A=J.fPoly,Y&&(J._sumx=J._sumy=J._suml=0);const E=(v,f,C,I)=>{const U=Math.sqrt((v-C)**2+(f-I)**2);J._sumx+=(v+C)*U/2,J._sumy+=(f+I)*U/2,J._suml+=U},g=()=>{me&&(Q+="h"+me,me=0),X&&(Q+="v"+X,X=0)};for(B=0;B<$;++B){(!A||B>0)&&(A=J.fPoly.fGraphs.arr[B]);const v=A.fX,f=A.fY;let C,I,U,Z,ee,k=A.fNpoints,he=Math.round(F.grx(v[0])),G=Math.round(F.gry(f[0]));k>2&&v[0]===v[k-1]&&f[0]===f[k-1]&&k--;const b=`M${he},${G}`;for(Q="",C=1;C<k;++C)I=Math.round(F.grx(v[C])),U=Math.round(F.gry(f[C])),Y&&E(he,G,I,U),Z=I-he,ee=U-G,(Z||ee)&&(0===Z?((0===X||ee<0!=X<0)&&g(),X+=ee):0===ee?((0===me||Z<0!=me<0)&&g(),me+=Z):(g(),Q+="l"+Z+","+ee),he=I,G=U);Y&&E(he,G,Math.round(F.grx(v[0])),Math.round(F.gry(f[0]))),g(),Q&&(ue+=b+Q+"z")}return Y&&(J._suml>0?(J._midx=Math.round(J._sumx/J._suml),J._midy=Math.round(J._sumy/J._suml)):(J._midx=Math.round(F.grx((J.fXmin+J.fXmax)/2)),J._midy=Math.round(F.gry((J.fYmin+J.fYmax)/2)))),ue}drawPolyBinsColor(){var F=this;return(0,Ee.A)(function*(){const J=F.getObject(),Y=F.getFramePainter(),ue=Y.getGrFuncs(F.options.second_x,F.options.second_y),Q=Y.getFrameHeight(),me=[],X=[],B=J.fBins.arr.length;let $,A,E,g,v;F.maxbin=F.gmaxbin,F.minbin=F.gminbin,F.minposbin=F.gminposbin;const f=F.getContour(!0),C=F.getHistPalette(),I=F.options.Line||F.options.Text;for(v=0;v<B;++v){if(E=J.fBins.arr[v],$=f.getPaletteIndex(C,E.fContent),null===$){if(!I)continue;$=0}0===E.fContent&&!F.options.Zero||E.fXmin>ue.scale_xmax||E.fXmax<ue.scale_xmin||E.fYmin>ue.scale_ymax||E.fYmax<ue.scale_ymin||(A=F.createPolyBin(ue,E,F.options.Text&&E.fContent),void 0===me[$]?me[$]=A:me[$]+=A,F.options.Text&&E.fContent&&X.push(E))}for($=0;$<me.length;++$)me[$]&&(g=F.draw_g.append("svg:path").style("fill",$?F._color_palette.getColor($):"none").attr("d",me[$]),I&&g.call(F.lineatt.func));let U=Promise.resolve(!0);if(X.length>0){const k=F.getColor(J.fMarkerColor),Z=-1*F.options.TextAngle,ee=F.draw_g.append("svg:g").attr("class","th2poly_text"),he=1!==J.fMarkerSize&&Z?Math.round(.02*Q*J.fMarkerSize):12;for(F.startTextDrawing(42,he,ee,he),v=0;v<X.length;++v){let G;E=X[v],F.options.TextKind?(G=E.fPoly?.fName,(!G||"Graph"===G)&&(G=E.fNumber.toString())):G=Math.round(E.fContent)===E.fContent?E.fContent.toString():(0,ke.lg)(E.fContent,x.gStyle.fPaintTextFormat),F.drawText({align:22,x:E._midx,y:E._midy,rotate:Z,text:G,color:k,latex:0,draw_g:ee})}U=F.finishTextDrawing(ee,!0)}return U.then(()=>({poly:!0}))})()}drawBinsText(F){var J=this;return(0,Ee.A)(function*(){const Y=J.getObject(),ue=J.options.cutg,Q=J.getColor(Y.fMarkerColor),me=-1*J.options.TextAngle,X=J.draw_g.append("svg:g").attr("class","th2_text"),B=J.matchObjectType(x.clTProfile2D)&&(0,x.isFunc)(Y.getBinEntries),$="E"===J.options.TextKind,A=$&&!J.options.TextLine?1:0;let E,g,v,f,C=20,I=0;F||(F=J.prepareDraw({rounding:!1})),1!==Y.fMarkerSize&&me&&(C=Math.round(.02*Y.fMarkerSize*J.getFramePainter().getFrameHeight())),0!==Y.fBarOffset&&(I=.001*Y.fBarOffset),J.startTextDrawing(42,C,X,C);for(let U=F.i1;U<F.i2;++U){const k=F.grx[U+1]-F.grx[U];for(let Z=F.j1;Z<F.j2;++Z){let ee=Y.getBinContent(U+1,Z+1);if(0===ee&&!J._show_empty_bins||ue&&!ue.IsInside(Y.fXaxis.GetBinCoord(U+.5),Y.fYaxis.GetBinCoord(Z+.5)))continue;const he=F.gry[Z]-F.gry[Z+1];B&&(ee=Y.getBinEntries(U+1,Z+1));let G=ee===Math.round(ee)?ee.toString():(0,ke.lg)(ee,x.gStyle.fPaintTextFormat);if($){const b=Y.getBinError(Y.getBin(U+1,Z+1)),P=b===Math.round(b)?b.toString():(0,ke.lg)(b,x.gStyle.fPaintTextFormat);J.options.TextLine?G+="\xb1"+P:G=`#splitline{${G}}{#pm${P}}`}me?(E=Math.round(F.grx[U]+.5*k),g=Math.round(F.gry[Z+1]+he*(.5+I)),v=f=0):(E=Math.round(F.grx[U]+.1*k),g=Math.round(F.gry[Z+1]+he*(.1+I)),v=Math.round(.8*k),f=Math.round(.8*he)),J.drawText({align:22,x:E,y:g,width:v,height:f,rotate:me,text:G,color:Q,latex:A,draw_g:X})}}return F.hide_only_zeros=!0,J.finishTextDrawing(X,!0).then(()=>F)})()}drawBinsArrow(){const F=this.getObject(),J=this.options.cutg,Y=this.prepareDraw({rounding:!1}),ue=(Y.grx[Y.i2]-Y.grx[Y.i1])/(Y.i2-Y.i1+1)/2,Q=(Y.gry[Y.j2]-Y.gry[Y.j1])/(Y.j2-Y.j1+1)/2,me=(P,T)=>P?T?`l${P},${T}`:`h${P}`:T?`v${T}`:"";let X,B,A,E,g,v,C,I,U,k,Z,ee,he,G,b,$=1e-30,f="";for(let P=0;P<2;++P)for(X=Y.i1;X<Y.i2;++X)for(B=Y.j1;B<Y.j2;++B)J&&!J.IsInside(F.fXaxis.GetBinCoord(X+.5),F.fYaxis.GetBinCoord(B+.5))||(A=X===Y.i1?F.getBinContent(X+2,B+1)-F.getBinContent(X+1,B+1):X===Y.i2-1?F.getBinContent(X+1,B+1)-F.getBinContent(X,B+1):.5*(F.getBinContent(X+2,B+1)-F.getBinContent(X,B+1)),E=B===Y.j1?F.getBinContent(X+1,B+2)-F.getBinContent(X+1,B+1):B===Y.j2-1?F.getBinContent(X+1,B+1)-F.getBinContent(X+1,B):.5*(F.getBinContent(X+1,B+2)-F.getBinContent(X+1,B)),0===P?$=Math.max($,Math.abs(A),Math.abs(E)):(g=(Y.grx[X]+Y.grx[X+1])/2,v=(Y.gry[B]+Y.gry[B+1])/2,C=ue*A/$,I=Q*E/$,U=g-C,k=g+C,Z=v-I,ee=v+I,A=Math.round(k-U),E=Math.round(ee-Z),(A||E)&&(f+=`M${Math.round(U)},${Math.round(Z)}${me(A,E)}`,(Math.abs(A)>5||Math.abs(E)>5)&&(he=Math.sqrt(9/(A**2+E**2)),G=Math.round(he*(A+E)),b=Math.round(he*(A-E)),(G||b)&&(f+=`m${-G},${b}${me(G,-b)}${me(-b,-G)}`)))));return this.draw_g.append("svg:path").attr("d",f).style("fill","none").call(this.lineatt.func),Y}drawBinsBox(){const F=this.getObject(),J=this.prepareDraw({rounding:!1}),Y=this.getMainPainter();Y===this&&(Y.maxbin===Y.minbin&&(Y.maxbin=Y.gmaxbin,Y.minbin=Y.gminbin,Y.minposbin=Y.gminposbin),Y.maxbin===Y.minbin&&(Y.minbin=Math.min(0,Y.maxbin-1)));const ue=Math.max(Math.abs(Y.maxbin),Math.abs(Y.minbin)),Q=Math.max(0,Y.minbin),me=this.getPadPainter().getRootPad(!0),X=this.options.cutg;let B,$,A,E,I,U,k,Z,ee,he,G,b,g="",v="",f="",C="",P=!1,T=0;if((me?.fLogv??me?.fLogz)&&ue>0){P=!0;const z=Math.log(ue);T=Q>0?Math.log(Q):Y.minposbin>=1&&Y.minposbin<100?Math.log(.7):Y.minposbin>0?Math.log(.7*Y.minposbin):z-10,T>=z&&(T=z-10),b=1/(z-T)}else b=1/(ue-Q);for(B=J.i1;B<J.i2;++B)for($=J.j1;$<J.j2;++$)if(A=F.getBinContent(B+1,$+1),E=Math.abs(A),!(0===E||E<Q)&&(!X||X.IsInside(F.fXaxis.GetBinCoord(B+.5),F.fYaxis.GetBinCoord($+.5)))&&(I=P?E>0?Math.log(E)-T:0:E-Q,I=.5*(I<0?1:1-Math.sqrt(I*b)),I<0&&(I=0),he=J.grx[B+1]-J.grx[B],G=J.gry[$]-J.gry[$+1],U=I*he,k=I*G,Z=Math.round(J.grx[B]+U),ee=Math.round(J.gry[$+1]+k),he=Math.max(Math.round(he-2*U),1),G=Math.max(Math.round(G-2*k),1),g+=`M${Z},${ee}v${G}h${he}v${-G}z`,A<0&&10===this.options.BoxStyle&&(v+=`M${Z},${ee}l${he},${G}m0,${-G}l${-he},${G}`),11===this.options.BoxStyle&&he>5&&G>5)){const z=Math.round(.1*he),W=Math.round(.1*G),fe=`M${Z},${ee}h${he}l${-z},${W}h${2*z-he}v${G-2*W}l${-z},${W}z`,we=`M${Z+he},${ee+G}v${-G}l${-z},${W}v${G-2*W}h${2*z-he}l${-z},${W}z`;f+=A<0?we:fe,C+=A<0?fe:we}if(g){const z=this.draw_g.append("svg:path").attr("d",g).call(this.fillatt.func);11!==this.options.BoxStyle&&this.fillatt.empty()&&z.call(this.lineatt.func)}if(f&&this.fillatt.hasColor()&&this.draw_g.append("svg:path").attr("d",f).call(this.fillatt.func).style("fill",(0,L.Qh)(this.fillatt.color).brighter(.5).formatHex()),C&&this.draw_g.append("svg:path").attr("d",C).call(this.fillatt.func).style("fill",this.fillatt.hasColor()?(0,L.Qh)(this.fillatt.color).darker(.5).formatHex():"red"),v){const z=this.draw_g.append("svg:path").attr("d",v).style("fill","none");this.lineatt.empty()?z.style("stroke","black"):z.call(this.lineatt.func)}return J}drawBinsCandle(){let he=0;const G=Cn=>{let yn=1;for(;Cn>=yn;)yn*=10;return yn/=10,Math.floor(he/yn)%10===Math.floor(Cn/yn)},b=(Cn,yn)=>{let Sn="",ii="",ai=0;const Hi=Cn[0],ti=Cn[1];if(Hi>="A"&&Hi<="Z"&&(Sn=Hi),Hi>="1"&&Hi<="9"&&(ii=Hi),ti>="A"&&ti<="Z"&&ii&&(Sn=ti),ti>="1"&&ti<="9"&&Sn&&(ii=ti),yn)switch(ii){case"1":default:ai+=11311;break;case"2":ai+=112111;break;case"3":ai+=112311;break;case"4":ai+=112321;break;case"5":ai+=212111;break;case"6":ai+=312311}else switch(ii){case"1":default:ai+=13001300;break;case"2":ai+=13102300}const Nr=Cn.indexOf("("),ss=Cn.lastIndexOf(")");Nr>=0&&ss>Nr+1&&(ai=parseInt(Cn.slice(Nr+1,ss))),he=ai,("Y"===Sn||"H"===Sn)&&!G(1e8)&&(he+=1e8)};this.options.Candle?b(this.options.Candle,!0):this.options.Violin&&b(this.options.Violin,!1);const T=this.getHisto(),z=this.prepareDraw(),W=this.getFramePainter(),fe=this.getCanvPainter(),we=W.getGrFuncs(this.options.second_x,this.options.second_y),Me=G(1e8);let Ne,rt,je="",Ge="",lt="",bt="",te="",Je="",tt="",Fe=null,St=x.gStyle.fViolinScaled,pt=x.gStyle.fCandleScaled,st=0,vt=0;if(null!==this.options.Scaled?St=pt=this.options.Scaled:fe?.online_canvas||(T.fTitle.indexOf("unscaled")>=0?St=pt=!1:T.fTitle.indexOf("scaled")>=0&&(St=pt=!0)),St&&(G(2e6)||G(1e6)||G(3e6)))for(let Cn=0;Cn<this.nbinsx;++Cn)for(let yn=0;yn<this.nbinsy;++yn)st=Math.max(st,T.getBinContent(Cn+1,yn+1));const Yt=(...Cn)=>{"array"===Cn[1]&&(Cn=Cn[0]);const yn=Cn.length;let Sn=2,ii=Cn[0],ai=Cn[1],Hi=Me?`M${ai},${ii}`:`M${ii},${ai}`;for(;Sn<yn;){switch(Cn[Sn]){case"Z":return Hi+"z";case"V":ai!==Cn[Sn+1]&&(Hi+=(Me?"h":"v")+(Cn[Sn+1]-ai),ai=Cn[Sn+1]);break;case"H":ii!==Cn[Sn+1]&&(Hi+=(Me?"v":"h")+(Cn[Sn+1]-ii),ii=Cn[Sn+1]);break;default:Hi+=Me?`l${Cn[Sn+1]-ai},${Cn[Sn]-ii}`:`l${Cn[Sn]-ii},${Cn[Sn+1]-ai}`,ii=Cn[Sn],ai=Cn[Sn+1]}Sn+=2}return Hi},qt=(Cn,yn)=>{Je||(this.createAttMarker({attr:T,style:G(3e5)?0:5}),this.markeratt.resetPos()),Je+=Me?this.markeratt.create(yn,Cn):this.markeratt.create(Cn,yn)},Ot=(Cn,yn)=>{Fe||(Fe=this.createAttMarker({attr:T,style:24,std:!1}),Fe.resetPos()),tt+=Me?Fe.create(yn,Cn):Fe.create(Cn,yn)};1===T.fMarkerColor&&(T.fMarkerColor=T.fLineColor),z.candle=[];const Bn=x.gStyle.fCandleWhiskerRange,Mn=x.gStyle.fCandleBoxRange,bn=[Bn>=1?1e-15:.5-Bn/2,Mn>=1?1e-14:.5-Mn/2,.5,Mn>=1?1-1e-14:.5+Mn/2,Bn>=1?1-1e-15:.5+Bn/2],Dn=(Cn,yn,Sn,ii,ai)=>{const Hi=((Cn,yn,Sn)=>{let ii=0,ai=0,Hi=0;const ti={max:0,first:-1,last:-1,entries:0};for(let Nr=0;Nr<yn.length;++Nr)yn[Nr]>0&&(ti.max=Math.max(ti.max,yn[Nr]),ti.first<0&&(ti.first=Nr),ti.last=Nr),ii+=yn[Nr],Hi+=yn[Nr]*(Cn[Nr]+Cn[Nr+1])/2;if(ii<=0)return null;ti.entries=ii,ti.mean=Hi/ii,ti.quantiles=new Array(Sn.length),ti.indx=new Array(Sn.length);for(let Nr=0,ss=0,Bs=0;Nr<yn.length;++Nr){const yo=Bs;let xt=Cn[Nr];if(yo===Sn[ai]&&0===yn[Nr]&&yo<.99){for(;0===yn[Nr]&&Nr<yn.length;)Nr++;xt=(Cn[Nr]+xt)/2}for(ss+=yn[Nr],Bs=ss/ii;Sn[ai]>=yo&&Sn[ai]<Bs;){if(ti.indx[ai]=Nr,ti.quantiles[ai]=xt+(Sn[ai]-yo)/(Bs-yo)*(Cn[Nr+1]-xt),ai++===Sn.length)return ti;xt=Cn[Nr]}}for(;ai<Sn.length;)ti.indx[ai]=yn.length-1,ti.quantiles[ai++]=Cn[Cn.length-1];return ti})(Ne,rt,bn);if(!Hi)return;const ti={bin:Cn,swapXY:Me,fBoxDown:Hi.quantiles[1],fMedian:Hi.quantiles[2],fBoxUp:Hi.quantiles[3]},Nr=ti.fBoxUp-ti.fBoxDown;let ss=Hi.quantiles[0],Bs=Hi.quantiles[4];if(G(2e3)){let dn=ti.fBoxDown-1.5*Nr,In=Hi.indx[1];for(;Ne[In]>dn&&In>0;)In--;for(;!rt[In];)In++;for(ss=Ne[In],dn=ti.fBoxUp+1.5*Nr,In=Hi.indx[3];Ne[In]<dn&&In<rt.length;)In++;for(;!rt[In];)In--;Bs=Ne[In+1]}const yo=Hi.mean,xt=1.57*Nr/Math.sqrt(Hi.entries);if(ss<=0&&(Me&&we.logx||!Me&&we.logy))return;const K=Sn-yn;let ge,ye,Pe=(yn+Sn)/2+T.fBarOffset/1e3*K;T.fBarWidth>0&&1e3!==T.fBarWidth?ge=ye=K*T.fBarWidth/1e3:(ge=.66*K,ye=.8*K),St&&st>0&&(ye*=Hi.max/st),pt&&vt>0&&(ge*=Hi.entries/vt),ti.x1=Math.round(Pe-ge/2),ti.x2=Math.round(Pe+ge/2),Pe=Math.round(Pe);const At=Math.round(Pe-ge/3),Vt=Math.round(Pe+ge/3),Nt=Me?we.grx:we.gry;ti.yy1=Math.round(Nt(Bs)),ti.y1=Math.round(Nt(ti.fBoxUp)),ti.y0=Math.round(Nt(ti.fMedian)),ti.y2=Math.round(Nt(ti.fBoxDown)),ti.yy2=Math.round(Nt(ss));const nn=Math.round(Nt(yo)),hn=Math.round(Nt(ti.fMedian+xt)),kn=Math.round(Nt(ti.fMedian-xt));if(G(1e7)&&(te+=Yt(Pe,Math.round(Nt(Ne[ii])),"V",Math.round(Nt(Ne[ai])))),G(10)?Ge+=Yt(ti.x1,ti.y0,"H",ti.x2):G(20)?Ge+=Yt(At,ti.y0,"H",Vt):G(30)&&Ot(Pe,ti.y0),G(300)?Ot(Pe,nn):G(100)&&(lt+=Yt(ti.x1,nn,"H",ti.x2)),G(1)&&(G(20)?je+=Yt(ti.x1,ti.y1,"V",hn,At,ti.y0,ti.x1,kn,"V",ti.y2,"H",ti.x2,"V",kn,Vt,ti.y0,ti.x2,hn,"V",ti.y1,"Z"):je+=Yt(ti.x1,ti.y1,"V",ti.y2,"H",ti.x2,"V",ti.y1,"Z")),G(1e4)&&(Ge+=Yt(ti.x1,ti.yy1,"H",ti.x2)+Yt(ti.x1,ti.yy2,"H",ti.x2)),G(1e3)&&!G(1e7)?lt+=Yt(Pe,ti.y1,"V",ti.yy1)+Yt(Pe,ti.y2,"V",ti.yy2):(G(1e3)&&G(1e7)||G(2e3))&&(Ge+=Yt(Pe,ti.y1,"V",ti.yy1)+Yt(Pe,ti.y2,"V",ti.yy2)),G(1e5)||G(2e5)||G(3e5)){const dn=new ke.YF(7521*Cn+Math.round(Hi.integral)),In=!G(1e5),ci=G(3e5);for(let Pi=0;Pi<rt.length;++Pi){const Si=rt[Pi],bi=(Ne[Pi]+Ne[Pi+1])/2;let Jn=Pe,Wi=0;if(Si&&!(!In&&bi>=ss&&bi<=Bs))for(let Ln=0;Ln<Si;Ln++)ci&&(Jn=Pe+Math.round((dn.random()-.5)*ge)),Wi=1!==Si||ci?Math.round(Nt(Ne[Pi]+dn.random()*(Ne[Pi+1]-Ne[Pi]))):Math.round(Nt(bi)),qt(Jn,Wi)}}if((G(2e6)||G(1e6)||G(3e6))&&Hi.max>0&&Hi.first>=0){const dn=[],In=(Me?-.5:.5)*ye/Hi.max;if(ii=Math.max(ii,Hi.first),ai=Math.min(ai-1,Hi.last),G(2e6)||G(3e6)){let ci=Pe,Pi=Math.round(Nt(Ne[ii]));dn.push(ci,Pi);for(let Si=ii;Si<=ai;Si++){const bi=Math.round(Pe+In*rt[Si]),Jn=Math.round(Nt(Ne[Si+1]));bi!==ci&&(Si!==ii&&dn.push("V",Pi),dn.push("H",bi)),ci=bi,Pi=Jn}dn.push("V",Pi)}if(G(1e6)||G(3e6)){let ci=Pe,Pi=Math.round(Nt(Ne[ai+1]));0===dn.length&&dn.push(ci,Pi);for(let Si=ai;Si>=ii;Si--){const bi=Math.round(Pe-In*rt[Si]),Jn=Math.round(Nt(Ne[Si]));bi!==ci&&(Si!==ai&&dn.push("V",Pi),dn.push("H",bi)),ci=bi,Pi=Jn}dn.push("V",Pi)}dn.push("H",Pe),bt+=Yt(dn,"array"),this.fillatt.empty()||(bt+="Z")}z.candle.push(ti)};if(Me){Ne=new Array(this.nbinsx+1),rt=new Array(this.nbinsx);for(let Cn=0;Cn<this.nbinsx+1;++Cn)Ne[Cn]=T.fXaxis.GetBinLowEdge(Cn+1);if(pt)for(let Cn=0;Cn<this.nbinsy;++Cn){let yn=0;for(let Sn=0;Sn<this.nbinsx;++Sn)yn+=T.getBinContent(Sn+1,Cn+1);vt=Math.max(vt,yn)}for(let Cn=z.j1;Cn<z.j2;++Cn){for(let yn=0;yn<this.nbinsx;++yn)rt[yn]=T.getBinContent(yn+1,Cn+1);Dn(Cn,z.gry[Cn+1],z.gry[Cn],z.i1,z.i2)}}else{Ne=new Array(this.nbinsy+1),rt=new Array(this.nbinsy);for(let Cn=0;Cn<this.nbinsy+1;++Cn)Ne[Cn]=T.fYaxis.GetBinLowEdge(Cn+1);if(pt)for(let Cn=0;Cn<this.nbinsx;++Cn){let yn=0;for(let Sn=0;Sn<this.nbinsy;++Sn)yn+=T.getBinContent(Cn+1,Sn+1);vt=Math.max(vt,yn)}for(let Cn=z.i1;Cn<z.i2;++Cn){for(let yn=0;yn<this.nbinsy;++yn)rt[yn]=T.getBinContent(Cn+1,yn+1);Dn(Cn,z.grx[Cn],z.grx[Cn+1],z.j1,z.j2)}}te&&T.fFillColor>0&&this.draw_g.append("svg:path").attr("d",te).style("stroke",this.getColor(T.fFillColor));const $n=G(1e7)&&0!==T.fFillStyle?this.fillatt.color:this.lineatt.color;if(bt&&(!this.fillatt.empty()||"none"!==$n)&&this.draw_g.append("svg:path").attr("d",bt).style("stroke","none"!==$n?$n:null).style("pointer-events",this.isBatchMode()?null:"visibleFill").call(this.fillatt.func),je&&this.draw_g.append("svg:path").attr("d",je).call(this.lineatt.func).call(this.fillatt.func),Ge&&this.draw_g.append("svg:path").attr("d",Ge).call(this.lineatt.func).style("fill","none"),lt){const Cn=this.createAttLine({attr:T,style:2,std:!1,color:ve.tA});this.draw_g.append("svg:path").attr("d",lt).call(Cn.func).style("fill","none")}return tt&&this.draw_g.append("svg:path").attr("d",tt).call(Fe.func),Je&&this.draw_g.append("svg:path").attr("d",Je).call(this.markeratt.func),z}drawBinsScatter(){const F=this.getObject(),J=this.prepareDraw({rounding:!0,pixel_density:!0}),Y=this.options.cutg,ue=[],Q=[],me=[],X=[],B=[],$=this.options.ScatCoef*(this.gmaxbin>2e3?2e3/this.gmaxbin:1),A=new ke.YF(J.sumz);let E,g,v,f,C,I,U,k,Z=1;if(J.ScatterPlot=!0,$*J.sumz<1e5){this.createAttMarker({attr:F}),this.markeratt.resetPos();let P="";for(f=J.i1;f<J.i2;++f)for(U=J.grx[f+1]-J.grx[f],C=J.j1;C<J.j2;++C){k=J.gry[C]-J.gry[C+1],I=F.getBinContent(f+1,C+1);const T=Math.round($*I);if(!(T<=0)&&(!Y||Y.IsInside(F.fXaxis.GetBinCoord(f+.5),F.fYaxis.GetBinCoord(C+.5))))for(let z=0;z<T;++z)P+=this.markeratt.create(Math.round(J.grx[f]+U*A.random()),Math.round(J.gry[C+1]+k*A.random()))}return this.draw_g.append("svg:path").attr("d",P).call(this.markeratt.func),J}this.maxbin>.7&&(Z=.7/this.maxbin);const ee=Math.round(J.max-J.min),he=this.createContour(ee>50?50:ee,this.minposbin,this.maxbin,this.minposbin);for(f=J.i1;f<J.i2;++f)for(C=J.j1;C<J.j2;++C)I=F.getBinContent(f+1,C+1),!(I<=0||I<this.minbin)&&(U=J.grx[f+1]-J.grx[f],k=J.gry[C]-J.gry[C+1],!(U*k<=0)&&(E=he.getContourIndex(I/U/k),!(E<0)&&(Y&&!Y.IsInside(F.fXaxis.GetBinCoord(f+.5),F.fYaxis.GetBinCoord(C+.5))||(g=`M${J.grx[f]},${J.gry[C+1]}`,void 0===ue[E]?(ue[E]=g,X[E]=U,B[E]=k):(v=`m${J.grx[f]-Q[E]},${J.gry[C+1]-me[E]}`,ue[E]+=v.length<g.length?v:g,X[E]=Math.max(X[E],U),B[E]=Math.max(B[E],k)),Q[E]=J.grx[f],me[E]=J.gry[C+1],ue[E]+=`v${k}h${U}v${-k}z`))));const G=this.getFrameSvg().selectChild(".main_layer");let b=G.selectChild("defs");for(b.empty()&&ue.length>0&&(b=G.insert("svg:defs",":first-child")),this.createAttMarker({attr:F}),E=0;E<ue.length;++E)if(void 0!==ue[E]&&E<he.arr.length){const P=(this.pad_name||"canv")+`_scatter_${E}`;let T=b.selectChild(`#${P}`);T.empty()?T=b.append("svg:pattern").attr("id",P).attr("patternUnits","userSpaceOnUse"):T.selectAll("*").remove();let z=Math.round(Z*he.arr[E]*X[E]*B[E]);z<1&&(z=1);const W=new Float32Array(z),fe=new Float32Array(z);if(1===z)W[0]=fe[0]=.5;else for(let Me=0;Me<z;++Me)W[Me]=A.random(),fe[Me]=A.random();this.markeratt.resetPos();let we="";for(let Me=0;Me<z;++Me)we+=this.markeratt.create(W[Me]*X[E],fe[Me]*B[E]);T.attr("width",X[E]).attr("height",B[E]).append("svg:path").attr("d",we).call(this.markeratt.func),this.draw_g.append("svg:path").attr("scatter-index",E).style("fill",`url(#${P})`).attr("d",ue[E])}return J}draw2DBins(){if(this._hide_frame&&this.isMainPainter()&&(this.getFrameSvg().style("display",null),delete this._hide_frame),!this.draw_content)return this.removeG();let F,J;if(this.createHistDrawAttributes(),this.createG(!0),this.isTH2Poly()?J=this.drawPolyBinsColor():(this.options.Scat&&(F=this.drawBinsScatter()),this.options.Color?F=this.drawBinsColor():this.options.Box?F=this.drawBinsBox():this.options.Arrow?F=this.drawBinsArrow():this.options.Proj?F=this.drawBinsProjected():this.options.Contour?F=this.drawBinsContour():(this.options.Candle||this.options.Violin)&&(F=this.drawBinsCandle()),this.options.Text&&(J=this.drawBinsText(F)),!F&&!J&&(F=this.drawBinsColor())),F)this.tt_handle=F;else if(J)return J.then(Y=>{this.tt_handle=Y})}drawBinsCircular(){this.getFrameSvg().style("display","none"),this._hide_frame=!0;const F=this.getPadPainter().getFrameRect(),J=this.getHisto(),Y=this.options.Circular>10?this.getHistPalette():null,me=J.fXaxis,X=v=>{if(me.fLabels)for(let f=0;f<me.fLabels.arr.length;++f){const C=me.fLabels.arr[f];if(C.fUniqueID===v+1)return C.fString}return v.toString()};this.createG(),(0,ke.bk)(this.draw_g,Math.round(F.x+F.width/2),Math.round(F.y+F.height/2));const B=Math.min(this.nbinsx,this.nbinsy);this.startTextDrawing(42,20,this.draw_g);const $=[];for(let v=0;v<B;v++){const f=(.5-v/B)*Math.PI*2,C=Math.round((.9*F.width/2-32)*Math.cos(f)),I=Math.round((.9*F.height/2-32)*Math.sin(f)),U=Math.round(.9*F.width/2*Math.cos(f)),k=Math.round(.9*F.height/2*Math.sin(f)),Z=Y?.calcColor(v,B)??"black";let ee=Math.round(f/Math.PI*180),he=12;$.push({x:C,y:I,a:f,color:Z}),(ee<-90||ee>90)&&(ee+=180,he=32);const G=Math.round(10),b=2*G;this.draw_g.append("path").attr("d",`M${C-G},${I} a${G},${G},0,1,0,${b},0a${G},${G},0,1,0,${-b},0z`).style("stroke",Z).style("fill","none"),this.drawText({align:he,rotate:ee,x:U,y:k,text:X(v)})}let E=0,g=0;if(this.options.Circular>11)for(let v=0;v<B-1;++v)for(let f=v+1;f<B;++f){const C=J.getBinContent(v+1,f+1);C>0&&(E=Math.max(E,C),(!g||C<g)&&(g=C))}for(let v=0;v<B-1;++v){const f=$[v];let C="";for(let I=v+1;I<B;++I){const U=J.getBinContent(v+1,I+1);if(U<=0)continue;const k=$[I],Z=(f.a+k.a)/2,ee=.5*(1-Math.abs(f.a-k.a)/Math.PI),he=Math.round(ee*F.width/2*Math.cos(Z)),G=Math.round(ee*F.height/2*Math.sin(Z));if(C+=`M${f.x},${f.y}Q${he},${G},${k.x},${k.y}`,this.options.Circular>11&&E>g){const b=Math.round((U-g)/(E-g)*7+1);this.draw_g.append("path").attr("d",C).style("stroke",f.color).style("stroke-width",b).style("fill","none"),C=""}}C&&this.draw_g.append("path").attr("d",C).style("stroke",f.color).style("fill","none")}return this.finishTextDrawing()}drawBinsChord(){var F=this;return(0,Ee.A)(function*(){F.getFrameSvg().style("display","none"),F._hide_frame=!0;const J=[],Y=Math.min(F.nbinsx,F.nbinsy),ue=F.getHisto();let Q=0,me=!0;for(let z=0;z<Y;++z){let W=0;for(let fe=0;fe<Y;++fe){const we=ue.getBinContent(z+1,fe+1);we>0&&(W+=we,me&&Math.round(we)!==we&&(me=!1))}W>0&&J.push(z),Q+=W}if(J.length<2)return!0;let X=0,B=1;const $=F.getPadPainter().getFrameRect(),A=F.getHistPalette(),E=Math.max(10,.5*Math.min($.width,$.height)-60),g=Math.max(2,E-10),v=[],f=[],C=z=>A.calcColor(z,J.length),I=z=>z.toString(),k=(z,W)=>W<z?-1:W>z?1:W>=z?0:Number.NaN;if(!me&&Q<10){const z=Math.round(Math.log10(Q)-2.3);X=-z,B=Math.pow(10,z)}else if(Q>200){const z=Math.round(Math.log10(Q)-2.3);B=Math.pow(10,z)}250*B<Q?B*=5:100*B<Q&&(B*=2);for(let z=0;z<J.length;++z){v[z]=[];for(let we=0;we<J.length;++we)v[z].push(ue.getBinContent(J[z]+1,J[we]+1));const W=ue.fXaxis;let fe="indx_"+J[z].toString();if(W.fLabels)for(let we=0;we<W.fLabels.arr.length;++we){const Me=W.fLabels.arr[we];if(Me.fUniqueID===J[z]+1){fe=Me.fString;break}}f.push(fe)}F.createG(),(0,ke.bk)(F.draw_g,Math.round($.x+$.width/2),Math.round($.y+$.height/2));const ee=(0,L.JQ)().padAngle(10/g).sortSubgroups(k).sortChords(k)(v),he=F.draw_g.append("g").attr("font-size",10).attr("font-family","sans-serif").selectAll("g").data(ee.groups).join("g"),G=(0,L.JL)().innerRadius(g).outerRadius(E),b=(0,L.F6)().radius(g-1).padAngle(1/g);he.append("path").attr("fill",z=>C(z.index)).attr("d",G),he.append("title").text(z=>`${f[z.index]} ${I(z.value)}`);const T=he.append("g").selectAll("g").data(function P({startAngle:z,endAngle:W,value:fe}){const we=(W-z)/fe,Me=[];for(let je=0;je<=fe;je+=B)Me.push({value:je,angle:je*we+z});return Me}).join("g").attr("transform",z=>`rotate(${Math.round(180*z.angle/Math.PI-90)}) translate(${E})`);return T.append("line").attr("stroke","currentColor").attr("x2",6),T.append("text").attr("x",8).attr("dy","0.35em").attr("transform",z=>z.angle>Math.PI?"rotate(180) translate(-16)":null).attr("text-anchor",z=>z.angle>Math.PI?"end":null).text(z=>(z=>X>3?z.toExponential(0):z.toFixed(X))(z.value)),he.select("text").attr("font-weight","bold").text(function(z){return"end"===this.getAttribute("text-anchor")?`\u2191 ${f[z.index]}`:`${f[z.index]} \u2193`}),F.draw_g.append("g").attr("fill-opacity",.8).selectAll("path").data(ee).join("path").style("mix-blend-mode","multiply").attr("fill",z=>C(z.source.index)).attr("d",b).append("title").text(z=>`${I(z.source.value)} ${f[z.target.index]} \u2192 ${f[z.source.index]}${z.source.index===z.target.index?"":`\n${I(z.target.value)} ${f[z.source.index]} \u2192 ${f[z.target.index]}`}`),!0})()}getBinTooltips(F,J){const Y=this.getHisto();let ue=Y.getBinContent(F+1,J+1);Y.$baseh&&(ue-=Y.$baseh.getBinContent(F+1,J+1));const Q=[this.getObjectHint(),"x = "+this.getAxisBinTip("x",Y.fXaxis,F),"y = "+this.getAxisBinTip("y",Y.fYaxis,J),`bin = ${Y.getBin(F+1,J+1)}  x: ${F+1}  y: ${J+1}`,"entries = "+(ue===Math.round(ue)?ue:(0,ke.lg)(ue,x.gStyle.fStatFormat))];if("E"===this.options.TextKind||this.matchObjectType(x.clTProfile2D)){const me=Y.getBinError(Y.getBin(F+1,J+1));Q.push("error = "+(me===Math.round(me)?me.toString():(0,ke.lg)(me,x.gStyle.fPaintTextFormat)))}return Q}getCandleTooltips(F){const Y=this.getFramePainter().getGrFuncs(this.options.second_x,this.options.second_y),ue=this.getHisto();return[this.getObjectHint(),F.swapXY?"y = "+Y.axisAsText("y",ue.fYaxis.GetBinLowEdge(F.bin+1)):"x = "+Y.axisAsText("x",ue.fXaxis.GetBinLowEdge(F.bin+1)),"m-25%  = "+(0,ke.lg)(F.fBoxDown,x.gStyle.fStatFormat),"median = "+(0,ke.lg)(F.fMedian,x.gStyle.fStatFormat),"m+25%  = "+(0,ke.lg)(F.fBoxUp,x.gStyle.fStatFormat)]}getPolyBinTooltips(F,J,Y){const Q=this.getHisto().fBins.arr[F],X=this.getFramePainter().getGrFuncs(this.options.second_x,this.options.second_y),B=[];let $=Q.fPoly.fName,A=0;if("Graph"===$&&($=""),0===$.length&&($=Q.fNumber),void 0===J&&void 0===Y){J=Y=0;let E=Q.fPoly,g=1;E._typename===x.clTMultiGraph&&(g=Q.fPoly.fGraphs.arr.length,E=null);for(let v=0;v<g;++v){(!E||v>0)&&(E=Q.fPoly.fGraphs.arr[v]);for(let f=0;f<E.fNpoints;++f)++A,J+=E.fX[f],Y+=E.fY[f]}A>1&&(J/=A,Y/=A)}return B.push(this.getObjectHint(),"x = "+X.axisAsText("x",J),"y = "+X.axisAsText("y",Y)),A>0&&B.push("npnts = "+A),B.push(`bin = ${$}`),Q.fContent===Math.round(Q.fContent)?B.push("content = "+Q.fContent):B.push("content = "+(0,ke.lg)(Q.fContent,x.gStyle.fStatFormat)),B}processTooltipEvent(F){const J=this.getHisto(),Y=this.tt_handle;let ue=this.draw_g?.selectChild(".tooltip_bin");if(!F||!this.draw_content||!this.draw_g||!Y||this.options.Proj)return ue?.remove(),null;if(Y.poly){const ee=this.getFramePainter().getGrFuncs(this.options.second_x,this.options.second_y),he=ee.revertAxis("x",F.x),G=ee.revertAxis("y",F.y);let P,b=-1;if(void 0!==he&&void 0!==G){const z=J.fBins.arr.length;for(let W=0;W<z&&b<0;++W){if(P=J.fBins.arr[W],he<P.fXmin||he>P.fXmax||G<P.fYmin||G>P.fYmax||0===P.fContent&&!this.options.Zero)continue;let fe=P.fPoly,we=1;fe._typename===x.clTMultiGraph&&(we=P.fPoly.fGraphs.arr.length,fe=null);for(let Me=0;Me<we;++Me)if((!fe||Me>0)&&(fe=P.fPoly.fGraphs.arr[Me]),fe.IsInside(he,G)){b=W;break}}}if(b<0)return ue.remove(),null;const T={name:J.fName,title:J.fTitle,x:F.x,y:F.y,color1:this.lineatt?.color??"green",color2:this.fillatt?.getFillColorAlt("blue")??"blue",exact:!0,menu:!0,lines:this.getPolyBinTooltips(b,he,G)};return F.disabled?(ue.remove(),T.changed=!0):(ue.empty()&&(ue=this.draw_g.append("svg:path").attr("class","tooltip_bin").style("pointer-events","none").call(ke.Ru)),T.changed=ue.property("current_bin")!==b,T.changed&&ue.attr("d",this.createPolyBin(ee,P)).style("opacity","0.7").property("current_bin",b)),T.changed&&(T.user_info={obj:J,name:J.fName,bin:b,cont:P.fContent,grx:F.x,gry:F.y}),T}if(Y.candle){let Z,ee,he;for(Z=0;Z<Y.candle.length&&(ee=Y.candle[Z],he=ee.swapXY?ee.x1<=F.y&&F.y<=ee.x2&&ee.yy1>=F.x&&F.x>=ee.yy2:ee.x1<=F.x&&F.x<=ee.x2&&ee.yy1<=F.y&&F.y<=ee.yy2,!he);++Z);if(!he)return ue.remove(),null;const G={name:J.fName,title:J.fTitle,x:F.x,y:F.y,color1:this.lineatt?.color??"green",color2:this.fillatt?.getFillColorAlt("blue")??"blue",lines:this.getCandleTooltips(ee),exact:!0,menu:!0};return F.disabled?(ue.remove(),G.changed=!0):(ue.empty()&&(ue=this.draw_g.append("svg:path").attr("class","tooltip_bin").style("pointer-events","none").call(ke.Ru).style("opacity","0.7")),G.changed=ue.property("current_bin")!==Z,G.changed&&ue.attr("d",ee.swapXY?`M${ee.yy1},${ee.x1}H${ee.yy2}V${ee.x2}H${ee.yy1}Z`:`M${ee.x1},${ee.yy1}H${ee.x2}V${ee.yy2}H${ee.x1}Z`).property("current_bin",Z)),G.changed&&(G.user_info={obj:J,name:J.fName,bin:Z+1,cont:ee.fMedian,binx:Z+1,biny:1,grx:F.x,gry:F.y}),G}const Q=this.getFramePainter();let me,X,A,E,g,v,f,C,I,U,B=0,$=null;if(Q.reverse_x)for(me=Y.i1;me<Y.i2&&!(F.x<=Y.grx[me]&&F.x>=Y.grx[me+1]);++me);else for(me=Y.i1;me<Y.i2&&!(F.x>=Y.grx[me]&&F.x<=Y.grx[me+1]);++me);if(Q.reverse_y)for(X=Y.j1;X<Y.j2&&!(F.y<=Y.gry[X+1]&&F.y>=Y.gry[X]);++X);else for(X=Y.j1;X<Y.j2&&!(F.y>=Y.gry[X+1]&&F.y<=Y.gry[X]);++X);if(me<Y.i2&&X<Y.j2){A=me,E=me+1,g=X,v=X+1,f=Y.grx[A],C=Y.grx[E],I=Y.gry[v],U=Y.gry[g];let Z=!0;if(this.options.Color){const ee=C-f,he=U-I;C=Math.round(f+ee*Y.xbar2),f=Math.round(f+ee*Y.xbar1),U=Math.round(I+he*Y.ybar2),I=Math.round(I+he*Y.ybar1),Q.reverse_x?(F.x>f||F.x<=C)&&(Z=!1):(F.x<f||F.x>=C)&&(Z=!1),Q.reverse_y?(F.y>I||F.y<=U)&&(Z=!1):(F.y<I||F.y>=U)&&(Z=!1)}B=J.getBinContent(me+1,X+1),this.is_projection?$=0:Z?Y.hide_only_zeros?$=0!==B||this._show_empty_bins?0:null:($=this.getContour().getPaletteIndex(this.getHistPalette(),B),null===$&&0===B&&this._show_empty_bins&&($=0)):$=null}if(null===$)return ue.remove(),null;const k={name:J.fName,title:J.fTitle,x:F.x,y:F.y,color1:this.lineatt?.color??"green",color2:this.fillatt?.getFillColorAlt("blue")??"blue",lines:this.getBinTooltips(me,X),exact:!0,menu:!0};if(this.options.Color&&(k.color2=this.getHistPalette().getColor($)),F.disabled&&!this.is_projection)ue.remove(),k.changed=!0;else{ue.empty()&&(ue=this.draw_g.append("svg:path").attr("class","tooltip_bin").style("pointer-events","none").call(ke.Ru));let ee,Z=1e4*me+X;if(this.is_projection){const he=this.projection_widthX||1,G=(he-1)/2;this.is_projection.indexOf("X")>=0&&he>1&&(v+G>=Y.j2?(v=Math.min(Math.round(v+G),Y.j2),g=Math.max(v-he,Y.j1)):(g=Math.max(Math.round(g-G),Y.j1),v=Math.min(g+he,Y.j2)));const b=this.projection_widthY||1,P=(b-1)/2;this.is_projection.indexOf("Y")>=0&&b>1&&(E+P>=Y.i2?(E=Math.min(Math.round(E+P),Y.i2),A=Math.max(E-b,Y.i1)):(A=Math.max(Math.round(A-P),Y.i1),E=Math.min(A+b,Y.i2)))}"X"===this.is_projection?(f=0,C=Q.getFrameWidth(),I=Y.gry[v],U=Y.gry[g],Z=777*g+333*v):"Y"===this.is_projection?(I=0,U=Q.getFrameHeight(),f=Y.grx[A],C=Y.grx[E],Z=777*A+333*E):"XY"===this.is_projection&&(I=Y.gry[v],U=Y.gry[g],f=Y.grx[A],C=Y.grx[E],Z=789*A+653*E+12345*g+654321*v,ee=`M${f},0H${C}V${I}H${Q.getFrameWidth()}V${U}H${C}V${Q.getFrameHeight()}H${f}V${U}H0V${I}H${f}Z`),k.changed=ue.property("current_bin")!==Z,k.changed&&ue.attr("d",ee||`M${f},${I}H${C}V${U}H${f}Z`).style("opacity","0.7").property("current_bin",Z),this.is_projection&&k.changed&&this.redrawProjection(A,E,g,v)}return k.changed&&(k.user_info={obj:J,name:J.fName,bin:J.getBin(me+1,X+1),cont:B,binx:me+1,biny:X+1,grx:F.x,gry:F.y}),k}canZoomInside(F,J,Y){if("z"===F||this.options.Proj)return!0;let ue=this.getHisto();return ue&&(ue="y"===F?ue.fYaxis:ue.fXaxis),!ue||ue.FindBin(Y,.5)-ue.FindBin(J,0)>1}completePalette(F){return!F||(F.$main_painter=this,this.options.Zvert=F._palette_vertical,F.drawPave(this.options.Cjust?"cjust":""))}draw2D(){var F=this;return(0,Ee.A)(function*(){F.clear3DScene();const J=F.options.Zscale&&F.options.canHavePalette();return F.drawColorPalette(J,!0).then(function(){var Y=(0,Ee.A)(function*(ue){let Q;return Q=F.options.Circular&&F.isMainPainter()?F.drawBinsCircular():F.options.Chord&&F.isMainPainter()?F.drawBinsChord():F.drawAxes().then(()=>F.draw2DBins()),Q.then(()=>F.completePalette(ue))});return function(ue){return Y.apply(this,arguments)}}()).then(()=>F.drawHistTitle()).then(()=>F.updateFunctions()).then(()=>(F.updateStatWebCanvas(),F.addInteractivity()))})()}draw3D(F){var J=this;return(0,Ee.A)(function*(){return console.log("3D drawing is disabled, load ./hist/TH2Painter.mjs"),J.draw2D(F)})()}callDrawFunc(F){var J=this;return(0,Ee.A)(function*(){const Y=J.getMainPainter(),ue=J.getFramePainter();return Y!==J&&ue&&ue.mode3d!==J.options.Mode3D&&J.copyOptionsFrom(Y),J.options.Mode3D?J.draw3D(F):J.draw2D(F)})()}redraw(F){var J=this;return(0,Ee.A)(function*(){return J.callDrawFunc(F)})()}static draw(F,J,Y){return(0,Ee.A)(function*(){return Ye.mf._drawHist(new Ve(F,J),Y)})()}}},4615:(Yr,mt,Se)=>{"use strict";Se.d(mt,{Ee:()=>Re,Z8:()=>J,ZE:()=>Ve,eP:()=>Y,ef:()=>He,kH:()=>De,m:()=>Ze,mf:()=>me});var Ee=Se(4882),x=Se(8872),L=Se(2985),ve=Se(2843),ke=Se(1922),ot=Se(5891),Ye=Se(4483);const Ze=1,Re=2,He=3,Ve=4,De=5;class F{constructor(){this.reset()}reset(){Object.assign(this,{Axis:0,RevX:!1,RevY:!1,SymlogX:0,SymlogY:0,Bar:!1,BarStyle:0,Curve:!1,Hist:1,Line:!1,Fill:!1,Error:0,ErrorKind:-1,errorX:x.gStyle.fErrorX,Mark:!1,Same:!1,Scat:!1,ScatCoef:1,Func:!0,AllFunc:!1,Arrow:!1,Box:!1,BoxStyle:0,Text:!1,TextAngle:0,TextKind:"",Char:0,Color:!1,Contour:0,Cjust:!1,Lego:0,Surf:0,Off:0,Tri:0,Proj:0,AxisPos:0,Ortho:x.gStyle.fOrthoCamera,Spec:!1,Pie:!1,List:!1,Zscale:!1,Zvert:!0,PadPalette:!1,Candle:"",Violin:"",Scaled:null,Circular:0,GLBox:0,GLColor:!1,Project:"",System:Ze,AutoColor:!1,NoStat:!1,ForceStat:!1,PadStats:!1,PadTitle:!1,AutoZoom:!1,HighRes:0,Zero:1,Palette:0,BaseLine:!1,Optimize:x.settings.OptimizeDraw,adjustFrame:!1,Mode3D:!1,x3dscale:1,y3dscale:1,Render3D:x.constants.Render3D.Default,FrontBox:!0,BackBox:!0,need_fillcol:!1,minimum:x.kNoZoom,maximum:x.kNoZoom,ymin:0,ymax:0,cutg:null,IgnoreMainScale:!1})}isCartesian(){return this.System===Ze}decodeSumw2(B,$){const A=B.fSumw2?.length??0;let E=!1;for(let g=0;g<A;++g)if(B.fSumw2[g]>0){E=!0;break}(Number.isInteger(this.Error)||$)&&(this.Error=E?1:0),(Number.isInteger(this.Hist)||$)&&(this.Hist=E?0:1),(Number.isInteger(this.Zero)||$)&&(this.Zero=E?0:1)}canHavePalette(){return 2===this.ndim&&(this.Mode3D?12===this.Lego||14===this.Lego||11===this.Surf||12===this.Surf:!!(this.Color||this.Contour||this.Axis)||!(this.Scat||this.Box||this.Arrow||this.Proj||this.Candle||this.Violin||this.Text))}decode(B,$,A,E,g,v){if(this.orginal=B,this.cutg_name="",(0,x.isStr)(B)&&2===$){const ee=B.lastIndexOf("["),he=B.lastIndexOf("]");ee>=0&&he>ee+1&&(this.cutg_name=B.slice(ee+1,he),B=B.slice(0,ee)+B.slice(he+1),this.cutg=E?.findInPrimitives(this.cutg_name,x.clTCutG),this.cutg&&(this.cutg.$redraw_pad=!0))}const f=new ve.nC(B);1===$&&this.decodeSumw2(A,!0),this.ndim=$||1,f.check("USE_PAD_TITLE"),f.check("USE_PAD_PALETTE"),f.check("USE_PAD_STATS"),f.check("PAL",!0)&&(this.Palette=f.partAsInt()),f.check("MINIMUM:",!0)?(this.ominimum=!0,this.minimum=parseFloat(f.part)):(this.ominimum=!1,this.minimum=A.fMinimum),f.check("MAXIMUM:",!0)?(this.omaximum=!0,this.maximum=parseFloat(f.part)):(this.omaximum=!1,this.maximum=A.fMaximum),f.check("HMIN:",!0)?(this.ohmin=!0,this.hmin=parseFloat(f.part)):(this.ohmin=!1,delete this.hmin),f.check("HMAX:",!0)?(this.ohmax=!0,this.hmax=parseFloat(f.part)):(this.ohmax=!1,delete this.hmax),f.check("HTITLE:",!0)&&(A.fTitle=decodeURIComponent(f.part.toLowerCase())),f.check("XTITLE:",!0)&&(A.fXaxis.fTitle=decodeURIComponent(f.part.toLowerCase())),f.check("YTITLE:",!0)&&(A.fYaxis.fTitle=decodeURIComponent(f.part.toLowerCase())),f.check("ZTITLE:",!0)&&(A.fZaxis.fTitle=decodeURIComponent(f.part.toLowerCase())),f.check("FORCE_TITLE")&&(this.ForceTitle=!0),f.check("_ADJUST_FRAME_")&&(this.adjustFrame=!0),f.check("NOOPTIMIZE")&&(this.Optimize=0),f.check("OPTIMIZE")&&(this.Optimize=2),f.check("AUTOCOL")&&(this.AutoColor=!0),f.check("AUTOZOOM")&&(this.AutoZoom=!0),f.check("OPTSTAT",!0)&&(this.optstat=f.partAsInt()),f.check("OPTFIT",!0)&&(this.optfit=f.partAsInt()),(this.optstat||this.optstat)&&A?.TestBit(x.kNoStats)&&A?.InvertBit(x.kNoStats),f.check("NOSTAT")&&(this.NoStat=!0),f.check("STAT")&&(this.ForceStat=!0),f.check("NOTOOLTIP")&&v&&v.setTooltipAllowed(!1),f.check("TOOLTIP")&&v&&v.setTooltipAllowed(!0),f.check("SYMLOGX",!0)&&(this.SymlogX=f.partAsInt(0,3)),f.check("SYMLOGY",!0)&&(this.SymlogY=f.partAsInt(0,3)),f.check("X3DSC",!0)&&(this.x3dscale=f.partAsInt(0,100)/100),f.check("Y3DSC",!0)&&(this.y3dscale=f.partAsInt(0,100)/100),(f.check("PERSPECTIVE")||f.check("PERSP"))&&(this.Ortho=!1),f.check("ORTHO")&&(this.Ortho=!0);let C=0,I=0,U="";f.check("LOG2XY")&&(C=I=2),f.check("LOGXY")&&(C=I=1),f.check("LOG2X")&&(C=2),f.check("LOGX")&&(C=1),f.check("LOG2Y")&&(I=2),f.check("LOGY")&&(I=1),C&&g&&(g.fLogx=C,g.fUxmin=0,g.fUxmax=1,g.fX1=0,g.fX2=1),I&&g&&(g.fLogy=I,g.fUymin=0,g.fUymax=1,g.fY1=0,g.fY2=1),f.check("LOG2Z")&&g&&(g.fLogz=2),f.check("LOGZ")&&g&&(g.fLogz=1),f.check("LOGV")&&g&&(g.fLogv=1),f.check("GRIDXY")&&g&&(g.fGridx=g.fGridy=1),f.check("GRIDX")&&g&&(g.fGridx=1),f.check("GRIDY")&&g&&(g.fGridy=1),f.check("TICKXY")&&g&&(g.fTickx=g.fTicky=1),f.check("TICKX")&&g&&(g.fTickx=1),f.check("TICKY")&&g&&(g.fTicky=1),f.check("TICKZ")&&g&&(g.fTickz=1),f.check("GRAYSCALE")&&E?.setGrayscale(!0),f.getColor=function(){if(this.color=this.partAsInt(1)-1,this.color>=0)return!0;for(let ee=0;ee<8;++ee)if((0,L.oU)(ee).toUpperCase()===this.part)return this.color=ee,!0;return!1},f.check("FILL_",!0)&&f.getColor()&&(this.histoFillColor=f.color,this.histoFillPattern=1001),f.check("LINE_",!0)&&f.getColor()&&(this.histoLineColor=(0,L.oU)(f.color)),f.check("XAXIS_",!0)&&f.getColor()&&(A.fXaxis.fAxisColor=A.fXaxis.fLabelColor=A.fXaxis.fTitleColor=f.color),f.check("YAXIS_",!0)&&f.getColor()&&(A.fYaxis.fAxisColor=A.fYaxis.fLabelColor=A.fYaxis.fTitleColor=f.color);const k=!!v&&!!v.getMainPainter();f.check("X+")&&(this.AxisPos=10,this.second_x=k),f.check("Y+")&&(this.AxisPos+=1,this.second_y=k),f.check("SAME0")&&(this.Same=!0,this.IgnoreMainScale=!0),f.check("SAMES")&&(this.Same=!0,this.ForceStat=!0),f.check("SAME")&&(this.Same=!0,this.Func=!0),f.check("SPEC")&&(this.Spec=!0),(f.check("BASE0")||f.check("MIN0")||x.gStyle.fHistMinimumZero)&&(this.BaseLine=0),f.check("PIE")&&(this.Pie=!0),f.check("CANDLE",!0)&&(this.Candle=f.part||"1"),f.check("VIOLIN",!0)&&(this.Violin=f.part||"1",delete this.Candle),f.check("NOSCALED")&&(this.Scaled=!1),f.check("SCALED")&&(this.Scaled=!0),f.check("GLBOX",!0)&&(this.GLBox=10+f.partAsInt()),f.check("GLCOL")&&(this.GLColor=!0),f.check("GL"),(f.check("CIRCULAR",!0)||f.check("CIRC",!0))&&(this.Circular=11,f.part.indexOf("0")>=0&&(this.Circular=10),f.part.indexOf("1")>=0&&(this.Circular=11),f.part.indexOf("2")>=0&&(this.Circular=12)),this.Chord=f.check("CHORD"),f.check("LEGO",!0)&&(this.Lego=1,f.part.indexOf("0")>=0&&(this.Zero=!1),f.part.indexOf("1")>=0&&(this.Lego=11),f.part.indexOf("2")>=0&&(this.Lego=12),f.part.indexOf("3")>=0&&(this.Lego=13),f.part.indexOf("4")>=0&&(this.Lego=14),U=f.part,f.part.indexOf("Z")>=0&&(this.Zscale=!0),f.part.indexOf("H")>=0&&(this.Zvert=!1)),f.check("R3D_",!0)&&(this.Render3D=x.constants.Render3D.fromString(f.part.toLowerCase())),f.check("POL")&&(this.System=Re),f.check("CYL")&&(this.System=He),f.check("SPH")&&(this.System=Ve),f.check("PSR")&&(this.System=De),f.check("SURF",!0)&&(this.Surf=f.partAsInt(10,1),U=f.part,f.part.indexOf("Z")>=0&&(this.Zscale=!0),f.part.indexOf("H")>=0&&(this.Zvert=!1)),f.check("TF3",!0)&&(U=f.part),f.check("ISO",!0)&&(U=f.part),f.check("LIST")&&(this.List=!0),f.check("CONT",!0)&&$>1&&(this.Contour=1,f.part.indexOf("Z")>=0&&(this.Zscale=!0),f.part.indexOf("H")>=0&&(this.Zvert=!1),f.part.indexOf("1")>=0?this.Contour=11:f.part.indexOf("2")>=0?this.Contour=12:f.part.indexOf("3")>=0?this.Contour=13:f.part.indexOf("4")>=0&&(this.Contour=14)),f.check("HBAR",!0)?this.BarStyle=20:f.check("BAR",!0)&&(this.BarStyle=10),this.BarStyle>0&&(this.Hist=!1,this.need_fillcol=!0,this.BarStyle+=f.partAsInt()),f.check("ARR")&&(this.Arrow=!0),f.check("BOX",!0)&&(this.BoxStyle=10,f.part.indexOf("1")>=0?this.BoxStyle=11:f.part.indexOf("2")>=0?this.BoxStyle=12:f.part.indexOf("3")>=0&&(this.BoxStyle=13),f.part.indexOf("Z")>=0&&(this.Zscale=!0),f.part.indexOf("H")>=0&&(this.Zvert=!1)),this.Box=this.BoxStyle>0,f.check("CJUST")&&(this.Cjust=!0),f.check("COL")&&(this.Color=!0),f.check("CHAR")&&(this.Char=1),f.check("ALLFUNC")&&(this.AllFunc=!0),f.check("FUNC")&&(this.Func=!0,this.Hist=!1),f.check("AXIS")&&(this.Axis=1),f.check("AXIG")&&(this.Axis=2),f.check("TEXT",!0)&&(this.Text=!0,this.Hist=!1,this.TextAngle=Math.min(f.partAsInt(),90),f.part.indexOf("N")>=0&&(this.TextKind="N"),f.part.indexOf("E0")>=0&&(this.TextLine=!0),f.part.indexOf("E")>=0&&(this.TextKind="E")),f.check("SCAT=",!0)&&(this.Scat=!0,this.ScatCoef=parseFloat(f.part),(!Number.isFinite(this.ScatCoef)||this.ScatCoef<=0)&&(this.ScatCoef=1)),f.check("SCAT")&&(this.Scat=!0),f.check("TRI",!0)&&(this.Color=!1,this.Tri=1,U=f.part,f.part.indexOf("ERR")>=0&&(this.Error=!0)),f.check("AITOFF")&&(this.Proj=1),f.check("MERCATOR")&&(this.Proj=2),f.check("SINUSOIDAL")&&(this.Proj=3),f.check("PARABOLIC")&&(this.Proj=4),f.check("MOLLWEIDE")&&(this.Proj=5),this.Proj>0&&(this.Contour=14),f.check("PROJXY",!0)&&(this.Project="XY"+f.partAsInt(0,1)),f.check("PROJX",!0)&&(this.Project="X"+f.part),f.check("PROJY",!0)&&(this.Project="Y"+f.part),f.check("PROJ")&&(this.Project="Y1"),U&&(U.indexOf("FB")>=0&&(this.FrontBox=!1),U.indexOf("BB")>=0&&(this.BackBox=!1)),3===$&&f.check("FB")&&(this.FrontBox=!1),3===$&&f.check("BB")&&(this.BackBox=!1),f.check("PFC")&&!this._pfc&&(this._pfc=2),(f.check("PLC")||this.AutoColor)&&!this._plc&&(this._plc=2),f.check("PMC")&&!this._pmc&&(this._pmc=2),f.check("L")&&(this.Line=!0,this.Hist=!1),f.check("F")&&(this.Fill=!0,this.need_fillcol=!0),f.check("A")&&(this.Axis=-1),(f.check("RX")||g?.$RX)&&(this.RevX=!0),(f.check("RY")||g?.$RY)&&(this.RevY=!0);const Z=(ee,he,G)=>{let b=f.check(ee);g&&g["$"+ee]&&(b=!0,g["$"+ee]=void 0),b&&A&&(A[he].TestBit(G)||A[he].InvertBit(G))};Z("OTX","fXaxis",ke.rb.kOppositeTitle),Z("OTY","fYaxis",ke.rb.kOppositeTitle),Z("CTX","fXaxis",ke.rb.kCenterTitle),Z("CTY","fYaxis",ke.rb.kCenterTitle),f.check("B1")&&(this.BarStyle=1,this.BaseLine=0,this.Hist=!1,this.need_fillcol=!0),f.check("B")&&(this.BarStyle=1,this.Hist=!1,this.need_fillcol=!0),f.check("C")&&(this.Curve=!0,this.Hist=!1),f.check("][")&&(this.Off=1,this.Hist=!0),f.check("HIST")&&(this.Hist=!0,this.Func=!0,this.Error=!1),this.Bar=this.BarStyle>0,delete this.MarkStyle,f.check("P0")&&(this.Mark=!0,this.Hist=!1,this.Zero=!0),f.check("P")&&(this.Mark=!0,this.Hist=!1,this.Zero=!1),f.check("HZ")&&(this.Zscale=!0,this.Zvert=!1),f.check("Z")&&(this.Zscale=!0),f.check("*")&&(this.Mark=!0,this.MarkStyle=3,this.Hist=!1),f.check("H")&&(this.Hist=!0),f.check("E",!0)&&(this.Error=!0,1===$&&(this.Zero=!1,1===this.Hist&&(this.Hist=!1),Number.isInteger(parseInt(f.part[0]))&&(this.ErrorKind=parseInt(f.part[0])),(3===this.ErrorKind||4===this.ErrorKind)&&(this.need_fillcol=!0),0===this.ErrorKind&&(this.Zero=!0),f.part.indexOf("X0")>=0&&(this.errorX=0))),f.check("9")&&(this.HighRes=1),f.check("0")&&(this.Zero=!1),this.Color&&f.check("1")&&(this.Zero=!1),(this.Lego>0||3===$||(this.Surf>0||this.Error)&&2===$)&&(this.Mode3D=!0),v?.isTF1()&&1===$&&1===this.Hist&&!this.Line&&!this.Fill&&!this.Curve&&!this.Mark&&(this.Hist=!1,this.Curve=x.settings.FuncAsCurve,this.Line=!this.Curve,this.Fill=!0),15===this.Surf&&(this.System===Re||this.System===Ze)&&(this.Surf=13)}asString(B,$){let A="",E="";return this.Zscale&&(E=this.Zvert?"Z":"HZ"),this.Mode3D?(this.Lego?(A="LEGO",this.Zero||(A+="0"),this.Lego>10&&(A+=this.Lego-10),A+=E):this.Surf&&(A="SURF"+(this.Surf-10),A+=E),this.FrontBox||(A+="FB"),this.BackBox||(A+="BB"),1!==this.x3dscale&&(A+=`_X3DSC${Math.round(100*this.x3dscale)}`),1!==this.y3dscale&&(A+=`_Y3DSC${Math.round(100*this.y3dscale)}`)):(this.Candle?A="CANDLE"+this.Candle:this.Violin?A="VIOLIN"+this.Violin:this.Scat?A="SCAT":this.Color?(A="COL",this.Zero||(A+="0"),A+=E,this.Axis<0&&(A+="A")):this.Contour?(A="CONT",this.Contour>10&&(A+=this.Contour-10),A+=E):this.Bar?A=!1===this.BaseLine?"B":"B1":this.Mark?A=this.Zero?"P0":"P":this.Error?(A="E",this.ErrorKind>=0&&(A+=this.ErrorKind)):this.Line&&(A+="L",this.Fill&&(A+="F")),this.Cjust&&(A+=" CJUST"),this.Text&&(A+="TEXT",this.TextAngle&&(A+=this.TextAngle),A+=this.TextKind)),B&&A&&(this.ForceStat||!0===this.StatEnabled?A+="_STAT":(this.NoStat||!1===this.StatEnabled)&&(A+="_NOSTAT")),B&&$&&A&&(2===$.fLogx?A+="_LOG2X":$.fLogx&&(A+="_LOGX"),2===$.fLogy?A+="_LOG2Y":$.fLogy&&(A+="_LOGY"),2===$.fLogz?A+="_LOG2Z":$.fLogz&&(A+="_LOGZ"),$.fGridx&&(A+="_GRIDX"),$.fGridy&&(A+="_GRIDY"),$.fTickx&&(A+="_TICKX"),$.fTicky&&(A+="_TICKY"),$.fTickz&&(A+="_TICKZ")),this.cutg_name&&(A+=` [${this.cutg_name}]`),A}}class J{constructor(B,$){this.arr=[],this.colzmin=B,this.colzmax=$,this.below_min_indx=-1,this.exact_min_indx=0}getLevels(){return this.arr}createNormal(B,$,A){if($){this.colzmax<=0&&(this.colzmax=1),this.colzmin<=0&&(this.colzmin=void 0===A||A<=0?1e-4*this.colzmax:A<3||A>100?.3*A:1),this.colzmin>=this.colzmax&&(this.colzmin=1e-4*this.colzmax);const E=Math.log(this.colzmin)/Math.log(10),v=(Math.log(this.colzmax)/Math.log(10)-E)/B;this.arr.push(this.colzmin);for(let f=1;f<B;f++)this.arr.push(Math.exp((E+v*f)*Math.log(10)));this.arr.push(this.colzmax),this.custom=!0}else{this.colzmin===this.colzmax&&0!==this.colzmin&&(this.colzmax+=.01*Math.abs(this.colzmax),this.colzmin-=.01*Math.abs(this.colzmin));const E=(this.colzmax-this.colzmin)/B;for(let g=0;g<=B;g++)this.arr.push(this.colzmin+E*g)}}createCustom(B){this.custom=!0;for(let $=0;$<B.length;++$)this.arr.push(B[$]);this.colzmax>this.arr[this.arr.length-1]&&this.arr.push(this.colzmax)}configIndicies(B,$){this.below_min_indx=B,this.exact_min_indx=$}getContourIndex(B){if(B<this.colzmin)return this.below_min_indx;if(B===this.colzmin)return this.exact_min_indx;if(!this.custom)return Math.floor(.01+(B-this.colzmin)*(this.arr.length-1)/(this.colzmax-this.colzmin));let $=0,A=this.arr.length-1;if(B<this.arr[0])return-1;if(B>=this.arr[A])return A;for(;$<A-1;){const E=Math.round(($+A)/2);this.arr[E]>B?A=E:$=E}return $}getPaletteColor(B,$){const A=this.getContourIndex($);if(A<0)return null;const E=B.calcColorIndex(A,this.arr.length);return B.getColor(E)}getPaletteIndex(B,$){const A=this.getContourIndex($);return A<0?null:B.calcColorIndex(A,this.arr.length)}}class Y{constructor(B,$,A,E){this.painter=B,this.pp=$;const g=[],v=[],f=!0===E;this.newfuncs=[],this.newopts=[],f||$?.forEachPainterInPad(C=>{C.isSecondary(B)&&C._secondary_id?.match(/^func_|^indx_/)&&g.push(C)},"objects");for(let C=0;C<A?.arr.length;++C){const I=A.arr[C],U=A.opt[C];if(!I?._typename||(0,x.isFunc)(B.needDrawFunc)&&!B.needDrawFunc(B.getObject(),I))continue;let k=null,Z=-1;if(!f){for(let ee=0;ee<g.length;++ee)if(g[ee].matchObjectType(I._typename)&&g[ee].getObjectName()===I.fName){k=g[ee],Z=ee;break}!k&&I.fName&&(k=$?.findPainterFor(null,I.fName,I._typename))}k?(k.updateObject(I,U),Z>=0&&(g.splice(Z,1),v.push(k))):(this.newfuncs[C]=I,this.newopts[C]=U)}if((0,x.isObject)(E)){const C=g.indexOf(E);C>=0&&g.splice(C,1)}g.length>0&&$?.cleanPrimitives(C=>g.indexOf(C)>=0),v.length>0&&(this._extraPainters=v)}drawNext(B){if(this._extraPainters){const v=this._extraPainters.shift();return 0===this._extraPainters.length&&delete this._extraPainters,(0,x.getPromise)(v.redraw()).then(()=>this.drawNext(0))}if(!this.newfuncs||B>=this.newfuncs.length)return delete this.newfuncs,delete this.newopts,Promise.resolve(this.painter);const $=this.newfuncs[B],A=this.newopts[B];if(!$||this.pp?.findPainterFor($))return this.drawNext(B+1);const E=$?.fName?`func_${$.fName}`:`indx_${B}`;return $.$main_painter=this.painter,(ot.TPavePainter.canDraw($)?ot.TPavePainter.draw(this.painter.getDom(),$,A):this.pp.drawObject(this.painter.getDom(),$,A)).then(v=>(v.setSecondaryId(this.painter,E),this.drawNext(B+1)))}}const ue=(0,x.BIT)(10),Q=(0,x.BIT)(17);class me extends ke.JW{constructor(B,$){super(B,$),this.draw_content=!0,this.nbinsx=this.nbinsy=0,this.accept_drops=!0,this.mode3d=!1}getHisto(){return this.getObject()}getAxis(B){const $=this.getObject();switch(B){case"x":return $?.fXaxis;case"y":return $?.fYaxis;case"z":return $?.fZaxis}return null}isTProfile(){return this.matchObjectType(x.clTProfile)}isTF1(){return!1}isTH1K(){return this.matchObjectType("TH1K")}isTH2Poly(){return this.matchObjectType(/^TH2Poly/)||this.matchObjectType(/^TProfile2Poly/)}clear3DScene(){const B=this.getFramePainter();(0,x.isFunc)(B?.create3DScene)&&B.create3DScene(-1),this.mode3d=!1}cleanup(){this.clear3DScene(),delete this._color_palette,delete this.fContour,delete this.options,super.cleanup()}getDimension(){const B=this.getHisto();return B?B._typename.match(/^TH2/)||B._typename===x.clTProfile2D?2:B._typename.match(/^TH3/)||B._typename===x.clTProfile3D?3:this.isTH2Poly()?2:1:0}decodeOptions(B){const $=this.getHisto(),A=this.getDimension(),E=this.getPadPainter(),g=E?.getRootPad(!0);this.options?this.options.reset():this.options=new F,this.lineatt?.setUsed(!1),this.fillatt?.setUsed(!1),this.markeratt?.setUsed(!1),this.options.decode(B||$.fOption,A,$,E,g,this),this.storeDrawOpt(B)}copyOptionsFrom(B){if(B===this)return;const $=this.options,A=B.options;$.Mode3D=A.Mode3D,$.Zero=A.Zero,A.Mode3D?($.Lego=A.Lego,$.Surf=A.Surf):($.Color=A.Color,$.Contour=A.Contour)}copyOptionsToOthers(){this.forEachPainter(B=>{B!==this&&(0,x.isFunc)(B.copyOptionsFrom)&&B.copyOptionsFrom(this)},"objects")}scanContent(){}checkPadRange(B){this.isMainPainter()&&(this.check_pad_range=!B||"pad_range")}createHistDrawAttributes(B){const $=this.getHisto(),A=this.options;if(A._pfc>1||A._plc>1||A._pmc>1){const E=this.getPadPainter();if((0,x.isFunc)(E?.getAutoColor)){const g=E.getAutoColor($.$num_histos);this._auto_exec="",A._pfc>1&&(A._pfc=1,$.fFillColor=g,this._auto_exec+=`SetFillColor(${g});;`,delete this.fillatt),A._plc>1&&(A._plc=1,$.fLineColor=g,this._auto_exec+=`SetLineColor(${g});;`,delete this.lineatt),A._pmc>1&&(A._pmc=1,$.fMarkerColor=g,this._auto_exec+=`SetMarkerColor(${g});;`,delete this.markeratt)}}B?this.deleteAttr():(this.createAttFill({attr:$,color:this.options.histoFillColor,pattern:this.options.histoFillPattern,kind:1}),this.createAttLine({attr:$,color0:this.options.histoLineColor}))}updateAxes(B,$,A){const E=(g,v,f)=>{g.fTitle=v.fTitle,g.fLabels=v.fLabels,g.fXmin=v.fXmin,g.fXmax=v.fXmax,g.fTimeDisplay=v.fTimeDisplay,g.fTimeFormat=v.fTimeFormat,g.fAxisColor=v.fAxisColor,g.fLabelColor=v.fLabelColor,g.fLabelFont=v.fLabelFont,g.fLabelOffset=v.fLabelOffset,g.fLabelSize=v.fLabelSize,g.fNdivisions=v.fNdivisions,g.fTickLength=v.fTickLength,g.fTitleColor=v.fTitleColor,g.fTitleFont=v.fTitleFont,g.fTitleOffset=v.fTitleOffset,g.fTitleSize=v.fTitleSize,f&&(g.fFirst=v.fFirst,g.fLast=v.fLast,g.fBits=v.fBits)};E(B.fXaxis,$.fXaxis,this.snapid&&!A?.zoomChangedInteractive("x")),E(B.fYaxis,$.fYaxis,this.snapid&&!A?.zoomChangedInteractive("y")),E(B.fZaxis,$.fZaxis,this.snapid&&!A?.zoomChangedInteractive("z"))}updateObject(B,$){const A=this.getHisto(),E=this.getFramePainter(),g=this.getPadPainter(),v=this.options;if(B!==A){if(!this.matchObjectType(B))return!1;const f=g?.findPainterFor(this.findStat());A.TestBit(x.kNoStats)!==B.TestBit(x.kNoStats)&&(A.fBits=B.fBits,f&&(f.Enabled=!A.TestBit(x.kNoStats))),void 0!==this.snapid&&(A.fName=B.fName,v._pfc=v._plc=v._pmc=0),v._pfc||(A.fFillColor=B.fFillColor),A.fFillStyle=B.fFillStyle,v._plc||(A.fLineColor=B.fLineColor),A.fLineStyle=B.fLineStyle,A.fLineWidth=B.fLineWidth,v._pmc||(A.fMarkerColor=B.fMarkerColor),A.fMarkerSize=B.fMarkerSize,A.fMarkerStyle=B.fMarkerStyle,A.fEntries=B.fEntries,A.fTsumw=B.fTsumw,A.fTsumwx=B.fTsumwx,A.fTsumwx2=B.fTsumwx2,A.fXaxis.fNbins=B.fXaxis.fNbins,this.getDimension()>1&&(A.fTsumwy=B.fTsumwy,A.fTsumwy2=B.fTsumwy2,A.fTsumwxy=B.fTsumwxy,A.fYaxis.fNbins=B.fYaxis.fNbins,this.getDimension()>2&&(A.fTsumwz=B.fTsumwz,A.fTsumwz2=B.fTsumwz2,A.fTsumwxz=B.fTsumwxz,A.fTsumwyz=B.fTsumwyz,A.fZaxis.fNbins=B.fZaxis.fNbins)),this.updateAxes(A,B,E),A.fArray=B.fArray,A.fNcells=B.fNcells,A.fTitle=B.fTitle,A.fMinimum=B.fMinimum,A.fMaximum=B.fMaximum,A.fSumw2=B.fSumw2,1===this.getDimension()&&v.decodeSumw2(A),this.isTProfile()?A.fBinEntries=B.fBinEntries:this.isTH1K()?(A.fNIn=B.fNIn,A.fReady=0):this.isTH2Poly()&&(A.fBins=B.fBins),this._funcHandler=new Y(this,g,B.fFunctions,f);const C=A.fOption!==B.fOption;A.fOption=B.fOption,(void 0!==$&&v.original!==$||C)&&this.decodeOptions($||A.fOption)}return v.ominimum||(v.minimum=A.fMinimum),v.omaximum||(v.maximum=A.fMaximum),(this.snapid||!E||!E.zoomChangedInteractive())&&this.checkPadRange(),this.scanContent(),this.histogram_updated=!0,!0}extractAxesProperties(B){const $=E=>{E.fXbins.length>=E.fNbins?(E.regular=!1,E.GetBinCoord=function(g){const v=Math.round(g);if(v<=0)return this.fXmin;if(v>this.fNbins)return this.fXmax;if(v===g)return this.fXbins[v];const f=g<v?v-1:v+1;return this.fXbins[v]*Math.abs(g-f)+this.fXbins[f]*Math.abs(g-v)},E.FindBin=function(g,v){for(let f=1;f<this.fXbins.length;++f)if(g<this.fXbins[f])return Math.floor(f-1+v);return this.fNbins}):(E.regular=!0,E.binwidth=(E.fXmax-E.fXmin)/(E.fNbins||1),E.GetBinCoord=function(g){return this.fXmin+g*this.binwidth},E.FindBin=function(g,v){return Math.floor((g-this.fXmin)/this.binwidth+v)})};this.nbinsx=this.nbinsy=this.nbinsz=0;const A=this.getHisto();this.nbinsx=A.fXaxis.fNbins,this.xmin=A.fXaxis.fXmin,this.xmax=A.fXaxis.fXmax,$(A.fXaxis),this.ymin=A.fYaxis.fXmin,this.ymax=A.fYaxis.fXmax,1===B&&this.options.ohmin&&this.options.ohmax&&(this.ymin=this.options.hmin,this.ymax=this.options.hmax),B>1&&(this.nbinsy=A.fYaxis.fNbins,$(A.fYaxis),this.zmin=A.fZaxis.fXmin,this.zmax=A.fZaxis.fXmax,2===B&&this.options.ohmin&&this.options.ohmax&&(this.zmin=this.options.hmin,this.zmax=this.options.hmax)),B>2&&(this.nbinsz=A.fZaxis.fNbins,$(A.fZaxis))}drawAxes(){var B=this;return(0,Ee.A)(function*(){const $=B.getFramePainter();if(!$)return!1;const A=B.getHisto();if(B.ymin===B.ymax&&(B.ymax+=1),!B.isMainPainter()){const g={second_x:B.options.AxisPos>=10,second_y:B.options.AxisPos%10==1,hist_painter:B};return!(!g.second_x&&!g.second_y||$.hasDrawnAxes(g.second_x,g.second_y))&&($.setAxes2Ranges(g.second_x,A.fXaxis,B.xmin,B.xmax,g.second_y,A.fYaxis,B.ymin,B.ymax),$.createXY2(g),$.drawAxes2(g.second_x,g.second_y))}if(B.options.adjustFrame){const g=B.getPadPainter().getRootPad();g&&(g.fUxmin<g.fUxmax&&($.fX1NDC=(B.xmin-g.fUxmin)/(g.fUxmax-g.fUxmin),$.fX2NDC=(B.xmax-g.fUxmin)/(g.fUxmax-g.fUxmin)),g.fUymin<g.fUymax&&($.fY1NDC=(B.ymin-g.fUymin)/(g.fUymax-g.fUymin),$.fY2NDC=(B.ymax-g.fUymin)/(g.fUymax-g.fUymin)),g.fLeftMargin=$.fX1NDC,g.fRightMargin=1-$.fX2NDC,g.fBottomMargin=$.fY1NDC,g.fTopMargin=1-$.fY2NDC,g.fFrameLineColor=0,g.fFrameLineWidth=0,$.setRootPadRange(g),$.fillatt.setSolidColor("none"),$.redraw()),B.options.adjustFrame=!1}if($.setAxesRanges(A.fXaxis,B.xmin,B.xmax,A.fYaxis,B.ymin,B.ymax,A.fZaxis,0,0),$.createXY({ndim:B.getDimension(),check_pad_range:B.check_pad_range,zoom_ymin:B.zoom_ymin,zoom_ymax:B.zoom_ymax,ymin_nz:B.ymin_nz,swap_xy:B.options.BarStyle>=20,reverse_x:B.options.RevX,reverse_y:B.options.RevY,symlog_x:B.options.SymlogX,symlog_y:B.options.SymlogY,Proj:B.options.Proj,extra_y_space:B.options.Text&&B.options.BarStyle>0,hist_painter:B}),delete B.check_pad_range,B.options.Same)return!1;const E=B.options.Axis<0||2===B.options.Axis;return $.drawAxes(!1,E,E,B.options.AxisPos,B.options.Zscale&&B.options.Zvert,B.options.Zscale&&!B.options.Zvert)})()}processOnlineChange(B){const $=this.getCanvPainter();(0,x.isFunc)($?.processChanges)&&$.processChanges(B,this)}fillWebObjectOptions(B){this._auto_exec&&B&&(B.fcust="auto_exec:"+this._auto_exec,delete this._auto_exec)}toggleTitle(B){const $=this.getHisto();return!(!this.isMainPainter()||!$)&&("only-check"===B?!$.TestBit(Q):($.InvertBit(Q),void this.drawHistTitle().then(()=>this.processOnlineChange(`exec:SetBit(TH1::kNoTitle,${$.TestBit(Q)?1:0})`))))}drawHistTitle(){var B=this;return(0,Ee.A)(function*(){if(!B.isMainPainter()||B.options.Same||B.options.Axis>0&&!B.options.ForceTitle)return B;const $=B.getHisto(),A=x.gStyle,E=B.getPadPainter(),g=E?.findPainterFor(null,"title"),v=!$.TestBit(Q)&&A.fOptTitle>0;let f=g?.getObject();if(!f&&(0,x.isFunc)(E?.findInPrimitives)&&(f=E.findInPrimitives("title",x.clTPaveText)),f){if(f.Clear(),v&&f.AddText($.fTitle),g)return g.redraw().then(()=>B)}else if(v&&!g&&$.fTitle)return f=(0,x.create)(x.clTPaveText),Object.assign(f,{fName:"title",fFillColor:A.fTitleColor,fFillStyle:A.fTitleStyle,fBorderSize:A.fTitleBorderSize,fTextFont:A.fTitleFont,fTextSize:A.fTitleFontSize,fTextColor:A.fTitleTextColor,fTextAlign:A.fTitleAlign}),f.AddText($.fTitle),ot.TPavePainter.draw(B.getDom(),f,"postitle").then(C=>(C?.setSecondaryId(B),B));return B})()}processTitleChange(B){const $=this.getHisto(),A=this.getPadPainter()?.findPainterFor(null,"title");return $&&A?"check"===B?!this.isMainPainter()||this.options.Same?null:$:(A.clearPave(),A.addText($.fTitle),A.redraw(),void this.submitCanvExec(`SetTitle("${$.fTitle}")`)):null}updateStatWebCanvas(){if(!this.snapid)return;const B=this.findStat(),$=this.getPadPainter()?.findPainterFor(B);$&&!$.snapid&&$.redraw()}findStat(){return this.findFunction(x.clTPaveStats,"stats")}toggleStat(B){let A,E,$=this.findStat();if(B||(B=""),$)A=this.getPadPainter()?.findPainterFor($);else{if(B.indexOf("-check")>0)return!1;$=this.createStat(!0)}if("only-check"===B)return A?.Enabled||!1;if("fitpar-check"===B)return $?.fOptFit||!1;if("fitpar-toggle"===B)return!!$&&($.fOptFit=$.fOptFit?0:1111,A?.redraw(),!0);if(A)A.Enabled=!A.Enabled,this.options.StatEnabled=A.Enabled,A.redraw(),E=A.Enabled;else{const g=this.selectCurrentPad(this.getPadName());E=ot.TPavePainter.draw(this.getDom(),$).then(()=>this.selectCurrentPad(g))}return this.processOnlineChange(`exec:SetBit(TH1::kNoStats,${E?0:1})`,this),E}isIgnoreStatsFill(){return!this.getObject()||!this.draw_content&&!this.create_stats&&!this.snapid}createStat(B){const $=this.getHisto();if(!$||!B&&!this.options.ForceStat&&(this.options.NoStat||$.TestBit(x.kNoStats)||!x.settings.AutoStat||!this.isMainPainter()))return null;const A=x.gStyle;let E=this.findStat(),g=this.options.optstat,v=this.options.optfit;return void 0!==g?(E&&(E.fOptStat=g),delete this.options.optstat):g=$.$custom_stat||A.fOptStat,void 0!==v?(E&&(E.fOptFit=v),delete this.options.optfit):v=A.fOptFit,E||g||v?(this.create_stats=!0,E||(E=(0,x.create)(x.clTPaveStats),Object.assign(E,{fName:"stats",fOptStat:g,fOptFit:v,fX1NDC:A.fStatX-A.fStatW,fY1NDC:A.fStatY-A.fStatH,fX2NDC:A.fStatX,fY2NDC:A.fStatY,fTextAlign:12}),E.AddText($.fName),this.addFunction(E),E)):null}findFunction(B,$){const A=this.getHisto()?.fFunctions?.arr;if(!A)return null;for(let E=0;E<A.length;++E){const g=A[E];if((!$||g.fName===$)&&g._typename===B)return g}return null}addFunction(B,$){const A=this.getHisto();!A||!B||(A.fFunctions||(A.fFunctions=(0,x.create)(x.clTList)),$?A.fFunctions.AddFirst(B):A.fFunctions.Add(B))}needDrawFunc(B,$){return $._typename===x.clTPaveStats?"stats"!==$.fName||!B.TestBit(x.kNoStats)&&!this.options.NoStat:$._typename===x.clTF1||$._typename===x.clTF2?this.options.AllFunc||!$.TestBit((0,x.BIT)(9)):"TGraphDelaunay"!==$._typename&&"TGraphDelaunay2D"!==$._typename&&$._typename!==x.clTPaletteAxis}drawFunctions(){var B=this;return(0,Ee.A)(function*(){return new Y(B,B.getPadPainter(),B.getHisto().fFunctions,!0).drawNext(0)})()}updateFunctions(){var B=this;return(0,Ee.A)(function*(){const $=B._funcHandler?.drawNext(0)??B;return delete B._funcHandler,$})()}getSelectIndex(B,$,A){let E=0,g=this.getAxis(B);const v=this[`nbins${B}`]??0;this.options.second_x&&"x"===B&&(B="x2"),this.options.second_y&&"y"===B&&(B="y2");const f=this.getFramePainter(),C=f?f[`zoom_${B}min`]:0,I=f?f[`zoom_${B}max`]:0;return C!==I&&g?(E="left"===$?g.FindBin(C,A||0):g.FindBin(I,(A||0)+.5),E<0?E=0:E>v&&(E=v)):E="left"===$?0:v,g&&(g.fFirst===g.fLast||!g.TestBit(ke.rb.kAxisRange)||g.fFirst<=1&&g.fLast>=v)&&(g=void 0),"left"===$?(E<0&&(E=0),g&&g.fFirst>1&&E<g.fFirst&&(E=g.fFirst-1)):(E>v&&(E=v),g&&g.fLast<=v&&E>g.fLast&&(E=g.fLast)),E}unzoomUserRange(B,$,A){const E=this.getHisto();if(!E)return!1;let g=!1;const v=C=>!(!C||!C.TestBit(ke.rb.kAxisRange)||C.fFirst===C.fLast||C.fFirst<=1&&C.fLast>=C.fNbins||(C.InvertBit(ke.rb.kAxisRange),0)),f=C=>!(this.getDimension()!==C||this.options.minimum===x.kNoZoom&&this.options.maximum===x.kNoZoom||!this.draw_content||(this.options.minimum=this.options.maximum=x.kNoZoom,this.scanContent(!0),0));return B&&v(E.fXaxis)&&(g=!0),$&&(v(E.fYaxis)||f(1))&&(g=!0),A&&(v(E.fZaxis)||f(2))&&(g=!0),g}addInteractivity(){var B=this;return(0,Ee.A)(function*(){const $=B.isMainPainter(),A=B.options.AxisPos>0;return($||A?B.getFramePainter():null)?.addInteractivity(!$&&A)??!1})()}changeUserRange(B,$){const A=this.getHisto(),E=A?A[`f${$}axis`]:null;if(!E)return;let g=`[1,${E.fNbins}]`;E.TestBit(ke.rb.kAxisRange)&&(g=`[${E.fFirst},${E.fLast}]`),B.input(`Enter user range for axis ${$} like [1,${E.fNbins}]`,g).then(v=>{if(!v||!(v=JSON.parse(v))||2!==v.length)return;const f=parseInt(v[0]),C=parseInt(v[1]);Number.isInteger(f)&&Number.isInteger(C)&&(E.fFirst=f,E.fLast=C,(E.fFirst<E.fLast&&E.fFirst>=1&&E.fLast<=E.fNbins)!==E.TestBit(ke.rb.kAxisRange)&&E.InvertBit(ke.rb.kAxisRange),this.interactiveRedraw())})}changeValuesRange(B){let $;$=this.options.minimum!==x.kNoZoom&&this.options.maximum!==x.kNoZoom?`[${this.options.minimum},${this.options.maximum}]`:`[${this.gminbin},${this.gmaxbin}]`,B.input("Enter min/max hist values or empty string to reset",$).then(A=>{A=A?JSON.parse(A):[],(0,x.isObject)(A)&&2===A.length&&Number.isFinite(A[0])&&Number.isFinite(A[1])?(this.options.minimum=A[0],this.options.maximum=A[1]):this.options.minimum=this.options.maximum=x.kNoZoom,this.interactiveRedraw()})}executeMenuCommand(B,$){if(super.executeMenuCommand(B,$))return!0;if(B.fClassName===x.clTAxis){const A=(0,x.isStr)(B.$execid)?B.$execid.indexOf("#"):-1,E=A>0?B.$execid.slice(A+1):"x",g=this.getFramePainter();if("UnZoom"===B.fName)return g?.unzoom(E),!0;if("SetRange"===B.fName){const v=g?.getAxis(E),f=JSON.parse(`[${$}]`);v&&2===f?.length&&g?.zoom(E,v.GetBinLowEdge(f[0]),v.GetBinLowEdge(f[1]+1))}else if("SetRangeUser"===B.fName){const v=JSON.parse(`[${$}]`);2===v?.length&&g?.zoom(E,v[0],v[1])}}return!1}fillContextMenuItems(B){const $=this.getHisto(),A=this.getFramePainter();if($){if(this.options.Axis<=0&&!this.isTF1()&&B.addchk(this.toggleStat("only-check"),"Show statbox",()=>this.toggleStat()),$.fTitle&&this.isMainPainter()&&B.addchk(this.toggleTitle("only-check"),"Show title",()=>this.toggleTitle()),this.draw_content&&(1===this.getDimension()?B.add("User range X",()=>this.changeUserRange(B,"X")):(B.add("sub:User ranges"),B.add("X",()=>this.changeUserRange(B,"X")),B.add("Y",()=>this.changeUserRange(B,"Y")),this.getDimension()>2?B.add("Z",()=>this.changeUserRange(B,"Z")):B.add("Values",()=>this.changeValuesRange(B)),B.add("endsub:")),(0,x.isFunc)(this.fillHistContextMenu)&&this.fillHistContextMenu(B)),this.options.Mode3D){B.size()>0&&B.add("separator");const E=this.getMainPainter()||this;B.addchk(E.isTooltipAllowed(),"Show tooltips",()=>E.setTooltipAllowed("toggle")),B.addchk(A?.enable_highlight,"Highlight bins",()=>{A.enable_highlight=!A.enable_highlight,!A.enable_highlight&&A.mode3d&&(0,x.isFunc)(A.highlightBin3D)&&A.highlightBin3D(null)}),(0,x.isFunc)(A?.render3D)&&(B.addchk(E.options.FrontBox,"Front box",()=>{E.options.FrontBox=!E.options.FrontBox,A.render3D()}),B.addchk(E.options.BackBox,"Back box",()=>{E.options.BackBox=!E.options.BackBox,A.render3D()}),B.addchk(A.camera?.isOrthographicCamera,"Othographic camera",g=>A.change3DCamera(g))),this.draw_content&&(B.addchk(!this.options.Zero,"Suppress zeros",()=>{this.options.Zero=!this.options.Zero,this.interactiveRedraw("pad")}),(12===this.options.Lego||14===this.options.Lego)&&(B.addchk(this.options.Zscale,"Z scale",()=>this.toggleColz()),this.fillPaletteMenu(B,!0))),(0,x.isFunc)(E.control?.reset)&&B.add("Reset camera",()=>E.control.reset())}this.histogram_updated&&A.zoomChangedInteractive()&&B.add("Let update zoom",()=>A.zoomChangedInteractive("reset"))}}getSnapId(B){if(!this.snapid)return"";let $=this.snapid.toString();return B&&($+="#",this.isTF1()&&("x"===B||"y"===B||"z"===B)&&($+="hist#"),$+=B),$}autoZoom(){}clickButton(B){const $=this.getFramePainter();if(!this.isMainPainter()||!$)return!1;switch(B){case"ToggleZoom":if($.zoom_xmin!==$.zoom_xmax||$.zoom_ymin!==$.zoom_ymax||$.zoom_zmin!==$.zoom_zmax){const A=$.unzoom();return $.zoomChangedInteractive("reset"),A}if(this.draw_content)return this.autoZoom();break;case"ToggleLogX":return $.toggleAxisLog("x");case"ToggleLogY":return $.toggleAxisLog("y");case"ToggleLogZ":return $.toggleAxisLog("z");case"ToggleStatBox":return(0,x.getPromise)(this.toggleStat())}return!1}fillToolbar(B){const $=this.getPadPainter();$&&($.addPadButton("auto_zoom","Toggle between unzoom and autozoom-in","ToggleZoom","Ctrl *"),$.addPadButton("arrow_right","Toggle log x","ToggleLogX","PageDown"),$.addPadButton("arrow_up","Toggle log y","ToggleLogY","PageUp"),this.getDimension()>1&&$.addPadButton("arrow_diag","Toggle log z","ToggleLogZ"),$.addPadButton("statbox","Toggle stat box","ToggleStatBox"),B||$.showPadButtons())}get3DToolTip(B){const $=this.getHisto(),A={bin:B,name:$.fName,title:$.fTitle};switch(this.getDimension()){case 1:A.ix=B,A.iy=1,A.value=$.getBinContent(A.ix),A.error=$.getBinError(B),A.lines=this.getBinTooltips(B-1);break;case 2:A.ix=B%(this.nbinsx+2),A.iy=(B-A.ix)/(this.nbinsx+2),A.value=$.getBinContent(A.ix,A.iy),A.error=$.getBinError(B),A.lines=this.getBinTooltips(A.ix-1,A.iy-1);break;case 3:A.ix=B%(this.nbinsx+2),A.iy=(B-A.ix)/(this.nbinsx+2)%(this.nbinsy+2),A.iz=(B-A.ix-A.iy*(this.nbinsx+2))/(this.nbinsx+2)/(this.nbinsy+2),A.value=$.getBinContent(A.ix,A.iy,A.iz),A.error=$.getBinError(B),A.lines=this.getBinTooltips(A.ix-1,A.iy-1,A.iz-1)}return A}createContour(B,$,A,E,g){const v=new J($,A),f=this.getDimension();if(g)v.createCustom(g);else{B<2&&(B=x.gStyle.fNumberContours);const I=this.getPadPainter().getRootPad(!0);v.createNormal(B,I?.fLogv??(2===f&&I?.fLogz)??0,E)}v.configIndicies(this.options.Zero?-1:0,0!==v.colzmin||!this.options.Zero||this.isTH2Poly()?0:-1);const C=this.getFramePainter();return C&&f<3&&!C.mode3d&&(C.zmin=v.colzmin,C.zmax=v.colzmax),this.fContour=v,v}getContour(B){if(this.fContour&&!B)return this.fContour;const $=this.getMainPainter(),A=this.getFramePainter();if($?.fContour&&$!==this&&!this.options.IgnoreMainScale)return this.fContour=$.fContour,this.fContour;const E=this.getObject(),g=this===$||void 0===$?.minbin||this.options.IgnoreMainScale||$?.tt_handle?.ScatterPlot?this:$;let f,k,v=0,C=g.minbin,I=g.maxbin,U=g.minposbin;C===I&&(C=g.gminbin,I=g.gmaxbin,U=g.gminposbin);let Z=C,ee=I;this.options.minimum!==x.kNoZoom&&(C=this.options.minimum,Z=Math.min(Z,C),f=!0),this.options.maximum!==x.kNoZoom&&(I=this.options.maximum,ee=Math.max(ee,I),f=!1),C>=I&&(f?I=C+1:C=I-1),A&&A.zoom_zmin!==A.zoom_zmax&&(C=A.zoom_zmin,I=A.zoom_zmax),E.fContour?.length>1&&(E.TestBit(ue)?k=E.fContour:v=E.fContour.length);const he=this.createContour(v,C,I,U,k);return this.getDimension()<3&&A&&(A.zmin=Z,A.zmax=ee,Z!==he.colzmin||ee!==he.colzmax?(A.zoom_zmin=he.colzmin,A.zoom_zmax=he.colzmax):A.zoom_zmin=A.zoom_zmax=void 0),he}getContourLevels(B){return this.getContour(B).getLevels()}getHistPalette(B){B&&(this._color_palette=null);const $=this.getPadPainter();return!this._color_palette&&!this.options.Palette&&(0,x.isFunc)($?.getCustomPalette)&&(this._color_palette=$.getCustomPalette()),this._color_palette||(this._color_palette=(0,L.jh)(this.options.Palette,$?.isGrayscale())),this._color_palette}fillPaletteMenu(B,$){if(B.addPaletteMenu(this.options.Palette||x.settings.Palette,A=>{this.options.Palette=parseInt(A),this.getHistPalette(!0),this.redraw()}),!$){B.add("Default position",()=>{this.drawColorPalette(this.options.Zscale,!1,!0).then(()=>this.processOnlineChange("drawopt"))},"Set default position for palette");const A=this.findFunction(x.clTPaletteAxis);B.addchk(!A||A.fX2NDC-A.fX1NDC<A.fY2NDC-A.fY1NDC,"Vertical",g=>{this.options.Zvert=g,this.drawColorPalette(this.options.Zscale,!1,"toggle").then(()=>this.processOnlineChange("drawopt"))},"Toggle palette vertical/horizontal flag"),B.add("Bring to front",()=>this.getPadPainter()?.findPainterFor(A)?.bringToFront())}}drawColorPalette(B,$,A){var E=this;return(0,Ee.A)(function*(){const g=E.getMainPainter(),v=E.getPadPainter();if(g!==E&&g&&!1!==g.draw_content&&g.options.Zscale)return null;let f=E.findFunction(x.clTPaletteAxis),C=v?.findPainterFor(f);const I=!!f;if(E._can_move_colz&&(delete E._can_move_colz,A||(A=!0)),!C&&!f&&!E.options.Axis&&(C=v?.findPainterFor(void 0,void 0,x.clTPaletteAxis),C&&(f=C.getObject(),E.addFunction(f,!0))),!B)return C&&(E.options.Zvert=C._palette_vertical,C.Enabled=!1,C.removeG()),null;if(f)void 0!==v?._palette_vertical&&(E.options.Zvert=v._palette_vertical);else{if(f=(0,x.create)(x.clTPaletteAxis),f.fInit=1,f.$can_move=!0,f.$generated=!0,Object.assign(f,E.options.Zvert?{fX1NDC:1.005-x.gStyle.fPadRightMargin,fX2NDC:1.045-x.gStyle.fPadRightMargin,fY1NDC:x.gStyle.fPadBottomMargin,fY2NDC:1-x.gStyle.fPadTopMargin}:{fX1NDC:x.gStyle.fPadLeftMargin,fX2NDC:1-x.gStyle.fPadRightMargin,fY1NDC:1.005-x.gStyle.fPadTopMargin,fY2NDC:1.045-x.gStyle.fPadTopMargin}),Object.assign(f.fAxis,{fChopt:"+",fLineSyle:1,fLineWidth:1,fTextAngle:0,fTextAlign:11}),2===E.getDimension()){const ee=E.getHisto().fZaxis;Object.assign(f.fAxis,{fTitle:ee.fTitle,fTitleSize:ee.fTitleSize,fTitleOffset:ee.fTitleOffset,fTitleColor:ee.fTitleColor,fLineColor:ee.fAxisColor,fTextSize:ee.fLabelSize,fTextColor:ee.fLabelColor,fTextFont:ee.fLabelFont,fLabelOffset:ee.fLabelOffset})}E.addFunction(f,!0),A=!0}const U=E.getFramePainter();if(A&&U&&f.$can_move)if(E.options.Zvert){if("toggle"===A){const ee=f.fY2NDC-f.fY1NDC;f.fX1NDC=U.fX2NDC+.005,f.fX2NDC=f.fX1NDC+ee}f.fX1NDC>.5*(U.fX1NDC+U.fX2NDC)?(f.fX2NDC=U.fX2NDC+.005+(f.fX2NDC-f.fX1NDC),f.fX1NDC=U.fX2NDC+.005):(f.fX1NDC=U.fX1NDC-.03-(f.fX2NDC-f.fX1NDC),f.fX2NDC=U.fX1NDC-.03),f.fY1NDC=U.fY1NDC,f.fY2NDC=U.fY2NDC}else{if("toggle"===A){const ee=f.fX2NDC-f.fX1NDC;f.fY1NDC=U.fY2NDC+.005,f.fY2NDC=f.fY1NDC+ee}f.fX1NDC=U.fX1NDC,f.fX2NDC=U.fX2NDC,f.fY2NDC>.5*(U.fY1NDC+U.fY2NDC)?(f.fY2NDC=U.fY2NDC+.005+(f.fY2NDC-f.fY1NDC),f.fY1NDC=U.fY2NDC+.005):(f.fY1NDC=U.fY1NDC-.05-(f.fY2NDC-f.fY1NDC),f.fY2NDC=U.fY1NDC-.05)}f.$main_painter=E;let Z,k="";if($&&(k+=";postpone"),A&&!E.do_redraw_palette&&(k+=";can_move"),E.options.Cjust&&(k+=";cjust"),C){if(C.Enabled=!0,$)return C;Z=C.drawPave(k)}else{const ee=E.selectCurrentPad(E.getPadName());Z=ot.TPavePainter.draw(E.getDom(),f,k).then(he=>{C=he,E.selectCurrentPad(ee),C.setSecondaryId(E,I&&!f.$generated?`func_${f.fName}`:void 0)})}return Z.then(()=>{E.options.Zvert=C._palette_vertical,C.redraw=()=>{};let ee=!1;if(A&&U&&!E.do_redraw_palette){const G=v?.getRootPad(!0);E.options.Zvert?(f.fX1NDC>.5&&U.fX2NDC>f.fX1NDC?(ee=!0,U.fX2NDC=f.fX1NDC-.01,U.fX1NDC>U.fX2NDC-.1&&(U.fX1NDC=Math.max(0,U.fX2NDC-.1))):f.fX2NDC<.5&&U.fX1NDC<f.fX2NDC&&(ee=!0,U.fX1NDC=f.fX2NDC+.05,U.fX2NDC<U.fX1NDC+.1&&(U.fX2NDC=Math.min(1,U.fX1NDC+.1))),ee&&G&&(G.fLeftMargin=U.fX1NDC,G.fRightMargin=1-U.fX2NDC)):(f.fY1NDC>.5&&U.fY2NDC>f.fY1NDC?(ee=!0,U.fY2NDC=f.fY1NDC-.01,U.fY1NDC>U.fY2NDC-.1&&(U.fY1NDC=Math.max(0,U.fXYNDC-.1))):f.fY2NDC<.5&&U.fY1NDC<f.fY2NDC&&(ee=!0,U.fY1NDC=f.fY2NDC+.05,U.fXYNDC<U.fY1NDC+.1&&(U.fY2NDC=Math.min(1,U.fY1NDC+.1))),ee&&G&&(G.fTopMargin=U.fY1NDC,G.fBottomMargin=1-U.fY2NDC))}return ee?(E.do_redraw_palette=!0,U.redraw(),($?Promise.resolve(!0):E.redraw()).then(()=>(delete E.do_redraw_palette,C))):C})})()}toggleColz(){if(this.options.canHavePalette())return this.options.Zscale=!this.options.Zscale,this.drawColorPalette(this.options.Zscale,!1,!0).then(()=>this.processOnlineChange("drawopt"))}toggleMode3D(){return this.options.Mode3D=!this.options.Mode3D,this.options.Mode3D&&!this.options.Surf&&!this.options.Lego&&!this.options.Error&&(this.options.Lego=this.nbinsx>=50||this.nbinsy>=50?this.options.Scat?13:14:this.options.Scat?1:12,this.options.Zero=!1),this.copyOptionsToOthers(),this.interactiveRedraw("pad","drawopt")}prepareDraw(B){B||(B={rounding:!0,extra:0,middle:0}),void 0===B.extra&&(B.extra=0),void 0===B.middle&&(B.middle=0);const $=this.getHisto(),A=$.fXaxis,E=$.fYaxis,g=this.getFramePainter(),v=this.getDimension(),f={i1:B.nozoom?0:this.getSelectIndex("x","left",0-B.extra),i2:B.nozoom?this.nbinsx:this.getSelectIndex("x","right",1+B.extra),j1:1===v||B.nozoom?0:this.getSelectIndex("y","left",0-B.extra),j2:1===v?1:B.nozoom?this.nbinsy:this.getSelectIndex("y","right",1+B.extra),min:0,max:0,sumz:0,xbar1:0,xbar2:1,ybar1:0,ybar2:1};if(B.cutg){let G=f.i2,b=f.i1,P=f.j2,T=f.j1;for(let z=f.i1;z<f.i2;++z)for(let W=f.j1;W<f.j2;++W)B.cutg.IsInside(A.GetBinCoord(z+B.middle),E.GetBinCoord(W+B.middle))&&(G=Math.min(G,z),b=Math.max(b,z+1),P=Math.min(P,W),T=Math.max(T,W+1));f.i1=G,f.i2=b,f.j1=P,f.j2=T}let C,I,U,k,Z,ee;if(f.grx=new Float32Array(f.i2+1),f.gry=new Float32Array(f.j2+1),"number"==typeof $.fBarOffset&&"number"==typeof $.fBarWidth&&($.fBarOffset||1e3!==$.fBarWidth)&&($.fBarOffset<=1e3?f.xbar1=f.ybar1=.001*$.fBarOffset:$.fBarOffset<=3e3?f.xbar1=.001*($.fBarOffset-2e3):$.fBarOffset<=5e3&&(f.ybar1=.001*($.fBarOffset-4e3)),$.fBarWidth<=1e3?(f.xbar2=Math.min(1,f.xbar1+.001*$.fBarWidth),f.ybar2=Math.min(1,f.ybar1+.001*$.fBarWidth)):$.fBarWidth<=3e3?f.xbar2=Math.min(1,f.xbar1+.001*($.fBarWidth-2e3)):$.fBarWidth<=5e3&&(f.ybar2=Math.min(1,f.ybar1+.001*($.fBarWidth-4e3)))),B.original&&(f.original=!0,f.origx=new Float32Array(f.i2+1),f.origy=new Float32Array(f.j2+1)),B.pixel_density&&(B.rounding=!0),!g)return console.warn("cannot draw histogram without frame"),f;const he=g.getGrFuncs(this.options.second_x,this.options.second_y);for(C=f.i1;C<=f.i2;++C)U=A.GetBinCoord(C+B.middle),he.logx&&U<=0?f.i1=C+1:(f.origx&&(f.origx[C]=U),f.grx[C]=he.grx(U),B.rounding&&(f.grx[C]=Math.round(f.grx[C])),B.use3d&&(f.grx[C]<-g.size_x3d&&(f.grx[C]=-g.size_x3d,this.options.RevX?f.i2=C:f.i1=C),f.grx[C]>g.size_x3d&&(f.grx[C]=g.size_x3d,this.options.RevX?f.i1=C:f.i2=C)));if(1===v)f.gry[0]=he.gry(0),f.gry[1]=he.gry(1);else for(I=f.j1;I<=f.j2;++I)k=E.GetBinCoord(I+B.middle),he.logy&&k<=0?f.j1=I+1:(f.origy&&(f.origy[I]=k),f.gry[I]=he.gry(k),B.rounding&&(f.gry[I]=Math.round(f.gry[I])),B.use3d&&(f.gry[I]<-g.size_y3d&&(f.gry[I]=-g.size_y3d,this.options.RevY?f.j2=I:f.j1=I),f.gry[I]>g.size_y3d&&(f.gry[I]=g.size_y3d,this.options.RevY?f.j1=I:f.j2=I)));for(this.maxbin=this.minbin=this.minposbin=null,C=f.i1;C<f.i2;++C)for(I=f.j1;I<f.j2;++I){if(Z=$.getBinContent(C+1,I+1),f.sumz+=Z,B.pixel_density){if(ee=(f.grx[C+1]-f.grx[C])*(f.gry[I]-f.gry[I+1]),ee<=0)continue;f.max=Math.max(f.max,Z),Z>0&&(Z<f.min||0===f.min)&&(f.min=Z),Z/=ee}null===this.maxbin?this.maxbin=this.minbin=Z:(this.maxbin=Math.max(this.maxbin,Z),this.minbin=Math.min(this.minbin,Z)),Z>0&&(null===this.minposbin||Z<this.minposbin)&&(this.minposbin=Z)}return this.fContour=null,f}getAxisBinTip(B,$,A){const g=this.getFramePainter().getGrFuncs(this.options.second_x,this.options.second_y),v=g[`${B}_handle`],f=$.GetBinLowEdge(A+1);if("labels"===v.kind)return g.axisAsText(B,f);const C=$.GetBinLowEdge(A+2);return"time"===v.kind||this.isTF1()?g.axisAsText(B,(f+C)/2):`[${g.axisAsText(B,f)}, ${g.axisAsText(B,C)})`}static _drawHist(B,$){return(0,Ee.A)(function*(){return(0,Ye.ensureTCanvas)(B).then(()=>(B.setAsMainPainter(),B.decodeOptions($),B.isTH2Poly()&&(B.options.Mode3D?B.options.Lego=12:B.options.Color||(B.options.Color=!0)),B.checkPadRange(14!==B.options.Contour),B.scanContent(),B.createStat(),B.callDrawFunc())).then(()=>B.drawFunctions()).then(()=>{if(!B.Mode3D&&B.options.AutoZoom)return B.autoZoom()}).then(()=>{if(B.options.Project&&!B.mode3d&&(0,x.isFunc)(B.toggleProjection))return B.toggleProjection(B.options.Project)}).then(()=>(B.fillToolbar(),B))})()}}},8868:(Yr,mt,Se)=>{"use strict";Se.r(mt),Se.d(mt,{TF1Painter:()=>De,getTF1Value:()=>He,produceTAxisLogScale:()=>Ve,proivdeEvalPar:()=>Ze});var Ee=Se(4882),x=Se(8872),L=Se(2843),ve=Se(1922),ke=Se(4615),ot=Se(212),Ye=Se(6983);function Ze(F,J){F.$math=Ye;let Y=F.fTitle,ue=!1,Q="[";if("gaus"===Y&&(Y="gaus(0)"),(0,x.isStr)(F.fFormula?.fFormula)&&(0===F.fFormula.fFormula.indexOf("[](double*x,double*p)")?(ue=!0,Q="p[",Y=F.fFormula.fFormula.slice(21)):(Y=F.fFormula.fFormula,Q="[p"),F.fFormula.fClingParameters&&F.fFormula.fParams&&F.fFormula.fParams.forEach(me=>{const X=new RegExp(`(\\[${me.first}\\])`,"g"),B=F.fFormula.fClingParameters[me.second];Y=Y.replace(X,B<0?`(${B})`:B)})),!Y)return!J||F.fSave?.length>2;if(F.formulas?.forEach(me=>{Y=Y.replaceAll(me.fName,me.fTitle)}),Y=Y.replace(/\b(TMath::SinH)\b/g,"Math.sinh").replace(/\b(TMath::CosH)\b/g,"Math.cosh").replace(/\b(TMath::TanH)\b/g,"Math.tanh").replace(/\b(TMath::ASinH)\b/g,"Math.asinh").replace(/\b(TMath::ACosH)\b/g,"Math.acosh").replace(/\b(TMath::ATanH)\b/g,"Math.atanh").replace(/\b(TMath::ASin)\b/g,"Math.asin").replace(/\b(TMath::ACos)\b/g,"Math.acos").replace(/\b(TMath::Atan)\b/g,"Math.atan").replace(/\b(TMath::ATan2)\b/g,"Math.atan2").replace(/\b(sin|SIN|TMath::Sin)\b/g,"Math.sin").replace(/\b(cos|COS|TMath::Cos)\b/g,"Math.cos").replace(/\b(tan|TAN|TMath::Tan)\b/g,"Math.tan").replace(/\b(exp|EXP|TMath::Exp)\b/g,"Math.exp").replace(/\b(log|LOG|TMath::Log)\b/g,"Math.log").replace(/\b(log10|LOG10|TMath::Log10)\b/g,"Math.log10").replace(/\b(pow|POW|TMath::Power)\b/g,"Math.pow").replace(/\b(pi|PI)\b/g,"Math.PI").replace(/\b(abs|ABS|TMath::Abs)\b/g,"Math.abs").replace(/\bsqrt\(/g,"Math.sqrt(").replace(/\bxygaus\(/g,"this.$math.gausxy(this, x, y, ").replace(/\bgaus\(/g,"this.$math.gaus(this, x, ").replace(/\bgausn\(/g,"this.$math.gausn(this, x, ").replace(/\bexpo\(/g,"this.$math.expo(this, x, ").replace(/\blandau\(/g,"this.$math.landau(this, x, ").replace(/\blandaun\(/g,"this.$math.landaun(this, x, ").replace(/\b(TMath::|ROOT::Math::)/g,"this.$math."),Y.match(/^pol[0-9]$/)&&parseInt(Y[3])===F.fNpar-1){Y="[0]";for(let me=1;me<F.fNpar;++me)Y+=` + [${me}] * `+(1===me?"x":`Math.pow(x,${me})`)}if(Y.match(/^chebyshev[0-9]$/)&&parseInt(Y[9])===F.fNpar-1){Y=`this.$math.ChebyshevN(${F.fNpar-1}, x, `;for(let me=0;me<F.fNpar;++me)Y+=(0===me?"[":", ")+`[${me}]`;Y+="])"}for(let me=0;me<F.fNpar;++me)Y=Y.replaceAll(Q+me+"]",`(${F.GetParValue(me)})`);for(let me=2;me<10;++me)Y=Y.replaceAll(`x^${me}`,`Math.pow(x,${me})`);return ue?(Y=Y.replace(/x\[0\]/g,"x"),F._typename===x.clTF3?(Y=Y.replace(/x\[1\]/g,"y"),Y=Y.replace(/x\[2\]/g,"z"),F.evalPar=new Function("x","y","z",Y).bind(F)):F._typename===x.clTF2?(Y=Y.replace(/x\[1\]/g,"y"),F.evalPar=new Function("x","y",Y).bind(F)):F.evalPar=new Function("x",Y).bind(F)):F.evalPar=F._typename===x.clTF3?new Function("x","y","z","return "+Y).bind(F):F._typename===x.clTF2?new Function("x","y","return "+Y).bind(F):new Function("x","return "+Y).bind(F),!0}function Re(F,J){const Y=F.fSave.length-3,ue=F.fSave[Y+1],Q=F.fSave[Y+2],me=(Q-ue)/Y;if(J<ue)return F.fSave[0];if(J>Q)return F.fSave[Y];const X=Math.min(Y-1,Math.floor((J-ue)/me));let B=ue+X*me,$=B+me,A=F.fSave[X],E=F.fSave[X+1];return!Number.isFinite(A)&&X<Y-1?(B+=me,$+=me,A=E,E=F.fSave[X+2]):!Number.isFinite(E)&&X>0&&($-=me,B-=me,E=A,A=F.fSave[X-1]),($*A-B*E+J*(E-A))/me}function He(F,J,Y=void 0){let ue=0,Q=!1;if(!F)return 0;if(!Y&&!F.evalPar)try{Ze(F)||(Q=!0)}catch{Q=!0}if(F.evalPar&&!Q)try{return ue=F.evalPar(J),ue}catch{ue=0}const me=F.fSave.length-3;return me<2||F.fSave[me+1]===F.fSave[me+2]?0:Re(F,J)}function Ve(F,J,Y,ue){let Q,me;ue>0?(me=Math.log(ue),Q=Y>0?Math.log(Y):me-5):(me=-10,Q=-15),F.fNbins=J,F.fXbins=new Array(J+1);for(let X=0;X<=J;++X)F.fXbins[X]=Math.exp(Q+X/J*(me-Q));F.fXmin=Math.exp(Q),F.fXmax=Math.exp(me)}class De extends ot.N{getObjectName(){return this.$func?.fName??"func"}getClassName(){return this.$func?._typename??x.clTF1}isTF1(){return!0}getPrimaryObject(){return this.$func}updateObject(J){if(!J||this.getClassName()!==J._typename)return!1;delete J.evalPar;const Y=this.getHisto();if(this.webcanv_hist){const ue=this.getPadPainter()?.findInPrimitives("Func",x.clTH1D);ue&&this.updateAxes(Y,ue,this.getFramePainter())}return this.$func=J,this.createTF1Histogram(J,Y),this.scanContent(),!0}redraw(J){return!this._use_saved_points&&("logx"===J||"zoom"===J)&&(this.createTF1Histogram(this.$func,this.getHisto()),this.scanContent()),super.redraw(J)}createTF1Histogram(J,Y){const ue=this.getFramePainter(),Q=this.getPadPainter()?.getRootPad(!0),me=Q?.fLogx,X=ue?.getGrFuncs(this.second_x,this.second_y);let B=J.fXmin,$=J.fXmax;X?.zoom_xmin!==X?.zoom_xmax&&(B=Math.min(B,X.zoom_xmin),$=Math.max($,X.zoom_xmax)),this._use_saved_points=J.fSave.length>3&&(x.settings.PreferSavedPoints||this.force_saved);const A=E=>{Y.fNcells!==E+2&&(Y.fNcells=E+2,Y.fArray=new Float32Array(Y.fNcells)),Y.fArray.fill(0),Y.fXaxis.fNbins=E,Y.fXaxis.fXbins=[]};if(delete this._fail_eval,!this._use_saved_points){const E=Math.max(J.fNpx,100);let g=!1;if(!J.evalPar)try{Ze(J)||(g=!0)}catch{g=!0}A(E),me?Ve(Y.fXaxis,E,B,$):(Y.fXaxis.fXmin=B,Y.fXaxis.fXmax=$);for(let v=0;v<E&&!g;v++){const f=Y.fXaxis.GetBinCenter(v+1);let C=0;try{C=J.evalPar(f)}catch{g=!0}g||Y.setBinContent(v+1,Number.isFinite(C)?C:0)}g&&(this._fail_eval=!0),g&&J.fSave.length>3&&(this._use_saved_points=!0)}if(this._use_saved_points){const E=J.fSave.length-3;let g=null;if(B=J.fSave[E+1],$=J.fSave[E+2],B===$){const v=this.getMainPainter();(0,x.isFunc)(v?.getHisto)&&(g=v?.getHisto()?.fXaxis)}if(g){A(Y.fXaxis.fNbins),Object.assign(Y.fXaxis,g);for(let v=0;v<E;++v){const f=J.fSave[v];Y.setBinContent(v+1,Number.isFinite(f)?f:0)}}else{A(J.fNpx),Y.fXaxis.fXmin=J.fXmin,Y.fXaxis.fXmax=J.fXmax;for(let v=0;v<J.fNpx;++v){const f=Re(J,Y.fXaxis.GetBinCenter(v+1));Y.setBinContent(v+1,Number.isFinite(f)?f:0)}}}Y.fName="Func",(0,x.setHistogramTitle)(Y,J.fTitle),Y.fMinimum=J.fMinimum,Y.fMaximum=J.fMaximum,Y.fLineColor=J.fLineColor,Y.fLineStyle=J.fLineStyle,Y.fLineWidth=J.fLineWidth,Y.fFillColor=J.fFillColor,Y.fFillStyle=J.fFillStyle,Y.fMarkerColor=J.fMarkerColor,Y.fMarkerStyle=J.fMarkerStyle,Y.fMarkerSize=J.fMarkerSize,Y.fBits|=x.kNoStats}extractAxesProperties(J){super.extractAxesProperties(J);const Y=this.$func,ue=Y?.fSave.length??0;ue>3&&this._use_saved_points&&(this.xmin=Math.min(this.xmin,Y.fSave[ue-2]),this.xmax=Math.max(this.xmax,Y.fSave[ue-1])),Y&&(this.xmin=Math.min(this.xmin,Y.fXmin),this.xmax=Math.max(this.xmax,Y.fXmax))}canZoomInside(J,Y,ue){if(this.$func?.fSave.length>0&&this._use_saved_points&&"x"===J){const Q=this.$func.fNpx;return Math.abs(this.$func.fSave[Q+2]-this.$func.fSave[Q+1])/Q<Math.abs(ue-Y)}return"x"===J||"y"===J}getTF1Tooltips(J){delete this.$tmp_tooltip;const Y=[this.getObjectHint()],ue=this.getFramePainter()?.getGrFuncs(this.options.second_x,this.options.second_y);if(!ue||!(0,x.isFunc)(this.$func?.evalPar))return Y.push("grx = "+J.x,"gry = "+J.y),Y;const Q=ue.revertAxis("x",J.x);let me=0,X=0,B=!1;try{me=this.$func.evalPar(Q),X=Math.round(ue.gry(me))}catch{B=!0}return Y.push("x = "+ue.axisAsText("x",Q),"value = "+(B?"<fail>":(0,L.lg)(me,x.gStyle.fStatFormat))),B||(this.$tmp_tooltip={y:me,gry:X}),Y}processTooltipEvent(J){if(this._use_saved_points)return super.processTooltipEvent(J);let Y=this.draw_g?.selectChild(".tooltip_bin");if(!this.draw_g||!J)return Y?.remove(),null;const ue={name:this.$func?.fName,title:this.$func?.fTitle,x:J.x,y:J.y,color1:this.lineatt?.color??"green",color2:this.fillatt?.getFillColorAlt("blue")??"blue",lines:this.getTF1Tooltips(J),exact:!0,menu:!0};return J.disabled?Y.remove():(Y.empty()&&(Y=this.draw_g.append("svg:circle").attr("class","tooltip_bin").style("pointer-events","none").style("fill","none").attr("r",(this.lineatt?.width??1)+4)),Y.attr("cx",J.x).attr("cy",this.$tmp_tooltip.gry??J.y).call(this.lineatt?.func)),ue}fillWebObjectOptions(J){J.fcust=this._fail_eval?"func_fail":""}static draw(J,Y,ue){return(0,Ee.A)(function*(){(0,x.isStr)(ue)||(ue="");let B,Q=ue.indexOf(";webcanv_hist"),me=!1,X=!1;Q>=0&&(me=!0,ue=ue.slice(0,Q)),Q=ue.indexOf(";force_saved"),Q>=0&&(X=!0,ue=ue.slice(0,Q)),me&&(B=new ve.JW(J).getPadPainter()?.findInPrimitives("Func",x.clTH1D)),B||(B=(0,x.createHistogram)(x.clTH1D,100),B.fBits|=x.kNoStats),!ue&&(0,ve.Nn)(J)&&(ue="same");const $=new De(J,B);return $.$func=Y,$.webcanv_hist=me,$.force_saved=X,$.createTF1Histogram(Y,B),ke.mf._drawHist($,ue)})()}}},8142:(Yr,mt,Se)=>{"use strict";Se.r(mt),Se.d(mt,{TH1Painter:()=>Ye});var Ee=Se(4882),x=Se(8872),L=Se(8537),ve=Se(2866),ke=Se(4615),ot=Se(212);class Ye extends ot.N{draw3D(Re){this.mode3d=!0;const He=this.getFramePainter(),Ve=this.isMainPainter(),De=this.getHisto(),F=1+2*x.gStyle.fHistTopMargin;let J=Promise.resolve(!0);return"resize"===Re?Ve&&He.resize3D()&&He.render3D():(this.createHistDrawAttributes(!0),this.scanContent(!0),Ve&&((0,L.wx)(He),J=He.create3DScene(this.options.Render3D,this.options.x3dscale,this.options.y3dscale,this.options.Ortho).then(()=>{He.setAxesRanges(De.fXaxis,this.xmin,this.xmax,De.fYaxis,this.ymin,this.ymax,De.fZaxis,0,0,this),He.set3DOptions(this.options),He.drawXYZ(He.toplevel,ve.TB,{use_y_for_z:!0,zmult:F,zoom:x.settings.Zooming,ndim:1,draw:-1!==this.options.Axis,drawany:this.options.isCartesian()})})),He.mode3d&&(J=J.then(()=>{(0,L.CS)(this),He.render3D(),this.updateStatWebCanvas(),He.addKeysHandler()}))),Ve&&(J=J.then(()=>this.drawColorPalette(this.options.Zscale&&(12===this.options.Lego||14===this.options.Lego))).then(()=>this.drawHistTitle())),J.then(()=>this.updateFunctions()).then(()=>this)}static draw(Re,He,Ve){return(0,Ee.A)(function*(){return ke.mf._drawHist(new Ye(Re,He),Ve)})()}}},4355:(Yr,mt,Se)=>{"use strict";Se.r(mt),Se.d(mt,{TH2Painter:()=>He});var Ee=Se(4882),x=Se(8872),L=Se(2923),ve=Se(3847),ke=Se(8537),ot=Se(2866),Ye=Se(4615),Ze=Se(9997);class He extends Ze.AJ{draw3D(De){var F=this;return(0,Ee.A)(function*(){F.mode3d=!0;const J=F.getFramePainter(),Y=F.isMainPainter(),ue=F.getHisto();let Q=Promise.resolve(!0);if("resize"===De)Y&&J.resize3D()&&J.render3D();else{const me=F.getPadPainter().getRootPad(!0),X=me?.fLogv??me?.fLogz;let B=1;F.options.minimum!==x.kNoZoom&&F.options.maximum!==x.kNoZoom?(F.zmin=F.options.minimum,F.zmax=F.options.maximum):(F.draw_content||0!==F.gmaxbin)&&(F.zmin=X?.3*F.gminposbin:F.gminbin,F.zmax=F.gmaxbin,B=1+2*x.gStyle.fHistTopMargin),X&&F.zmin<=0&&(F.zmin=1e-5*F.zmax),F.createHistDrawAttributes(!0),Y&&((0,ke.wx)(J),Q=J.create3DScene(F.options.Render3D,F.options.x3dscale,F.options.y3dscale,F.options.Ortho).then(()=>{J.setAxesRanges(ue.fXaxis,F.xmin,F.xmax,ue.fYaxis,F.ymin,F.ymax,ue.fZaxis,F.zmin,F.zmax,F),J.set3DOptions(F.options),J.drawXYZ(J.toplevel,ot.TB,{zmult:B,zoom:x.settings.Zooming,ndim:2,draw:-1!==F.options.Axis,drawany:F.options.isCartesian(),reverse_x:F.options.RevX,reverse_y:F.options.RevY})})),J.mode3d&&(Q=Q.then(()=>{F.draw_content?F.isTH2Poly()?function Re(Ve){const De=Ve.getHisto(),F=Ve.getFramePainter(),J=F.z_handle.getScaleMin(),Y=F.z_handle.getScaleMax(),ue=De.fBins.arr.length,Q=F.grz(J);let me,X,B,$;Ve.maxbin=Ve.gmaxbin,Ve.minbin=Ve.gminbin,Ve.minposbin=Ve.gminposbin;const A=Ve.getContour(!0),E=Ve.getHistPalette();for(B=0;B<ue;++B){if(X=De.fBins.arr[B],X.fContent<J||(me=A.getPaletteIndex(E,X.fContent),null===me)||X.fXmin>F.scale_xmax||X.fXmax<F.scale_xmin||X.fYmin>F.scale_ymax||X.fYmax<F.scale_ymin)continue;$=F.grz(X.fContent>Y?Y:X.fContent);const g=[],v=[];let f=1,C=X.fPoly,I=0;C._typename===x.clTMultiGraph&&(f=X.fPoly.fGraphs.arr.length,C=null);for(let G=0;G<f;++G){(!C||G>0)&&(C=X.fPoly.fGraphs.arr[G]);const b=C.fX,P=C.fY;let z,W,T=C.fNpoints;for(;T>2&&b[0]===b[T-1]&&P[0]===P[T-1];)--T;for(let fe=0;fe<2;++fe){let we,Me,je,Ge,lt=F.size_x3d*F.size_z3d;const bt=fe>0?0:lt/1e6;z=[],W=null;for(let te=0;te<T;++te)je=F.grx(b[te]),Ge=F.gry(P[te]),te>0&&(lt=(je-we)*(je-we)+(Ge-Me)*(Ge-Me)),lt>bt&&(z.push(new L.I9Y(je,Ge)),we=je,Me=Ge);try{z.length>2&&(W=L.xJ6.triangulateShape(z,[]))}catch{W=null}if(W&&W.length>z.length-3)break}W&&W.length&&z&&(g.push(z),v.push(W),I+=2*W.length,$>Q&&(I+=2*z.length))}const U=new Float32Array(9*I);let k=0;for(let G=0;G<g.length;++G){const b=g[G],P=v[G];for(let T=0;T<2;++T)for(let z=0;z<P.length;++z){const W=P[z],fe=b[W[0]],we=b[W[0===T?2:1]],Me=b[W[0===T?1:2]];U[k]=fe.x,U[k+1]=fe.y,U[k+2]=T?$:Q,k+=3,U[k]=we.x,U[k+1]=we.y,U[k+2]=T?$:Q,k+=3,U[k]=Me.x,U[k+1]=Me.y,U[k+2]=T?$:Q,k+=3}if($>Q)for(let T=0;T<b.length;++T){const z=b[T],W=b[T>0?T-1:b.length-1];U[k]=z.x,U[k+1]=z.y,U[k+2]=Q,k+=3,U[k]=W.x,U[k+1]=W.y,U[k+2]=Q,k+=3,U[k]=W.x,U[k+1]=W.y,U[k+2]=$,k+=3,U[k]=z.x,U[k+1]=z.y,U[k+2]=Q,k+=3,U[k]=W.x,U[k+1]=W.y,U[k+2]=$,k+=3,U[k]=z.x,U[k+1]=z.y,U[k+2]=$,k+=3}}const Z=new L.LoY;Z.setAttribute("position",new L.THS(U,3)),Z.computeVertexNormals();const ee=new L.V9B((0,ve.Bx)(Ve._color_palette?.getColor(me),{vertexColors:!1})),he=new L.eaF(Z,ee);F.add3DMesh(he),he.painter=Ve,he.bins_index=B,he.draw_z0=Q,he.draw_z1=$,he.tip_color=65280,he.tooltip=function(){const G=this.painter,b=G.getFramePainter(),P=G.getObject().fBins.arr[this.bins_index];return{use_itself:!0,x1:b.grx(P.fXmin),x2:b.grx(P.fXmax),y1:b.gry(P.fYmin),y2:b.gry(P.fYmax),z1:this.draw_z0,z2:this.draw_z1,bin:this.bins_index,value:P.fContent,color:this.tip_color,lines:G.getPolyBinTooltips(this.bins_index)}}}}(F):F.options.Contour?(0,ke.SF)(F,!0):F.options.Surf?(0,ke.u$)(F):F.options.Error?(0,ke.s6)(F):(0,ke.CS)(F):F.options.Axis&&F.options.Zscale&&(F.getContourLevels(!0),F.getHistPalette()),J.render3D(),F.updateStatWebCanvas(),J.addKeysHandler()}))}return Y&&(Q=Q.then(()=>F.drawColorPalette(F.options.Zscale&&(12===F.options.Lego||14===F.options.Lego||11===F.options.Surf||12===F.options.Surf))).then(()=>F.drawHistTitle())),Q.then(()=>F.updateFunctions()).then(()=>F)})()}static draw(De,F,J){return(0,Ee.A)(function*(){return Ye.mf._drawHist(new He(De,F),J)})()}}},1828:(Yr,mt,Se)=>{"use strict";Se.r(mt),Se.d(mt,{TH3Painter:()=>Ve});var Ee=Se(4882),x=Se(8872),L=Se(2923),ve=Se(2843),ke=Se(4483),ot=Se(2866),Ye=Se(3847),Ze=Se(4615),Re=Se(8537),He=Se(8868);class Ve extends Ze.mf{getDimension(){return 3}scanContent(F){if(F&&this.nbinsx&&this.nbinsy&&this.nbinsz)return;const J=this.getHisto();this.extractAxesProperties(3),this.gminbin=this.gmaxbin=J.getBinContent(1,1,1),this.gminposbin=null;for(let Y=0;Y<this.nbinsx;++Y)for(let ue=0;ue<this.nbinsy;++ue)for(let Q=0;Q<this.nbinsz;++Q){const me=J.getBinContent(Y+1,ue+1,Q+1);me<this.gminbin?this.gminbin=me:me>this.gmaxbin&&(this.gmaxbin=me),me>0&&(null===this.gminposbin||this.gminposbin>me)&&(this.gminposbin=me)}null===this.gminposbin&&this.gmaxbin>0&&(this.gminposbin=1e-4*this.gmaxbin),this.draw_content=0!==this.gmaxbin||0!==this.gminbin,this.transferFunc=this.findFunction(x.clTF1,"TransferFunction"),this.transferFunc&&!this.transferFunc.TestBit((0,x.BIT)(9))&&this.transferFunc.InvertBit((0,x.BIT)(9))}countStat(F,J){const Y=this.getHisto(),ue=Y.fXaxis,Q=Y.fYaxis,me=Y.fZaxis,X=this.getSelectIndex("x","left"),B=this.getSelectIndex("x","right"),$=this.getSelectIndex("y","left"),A=this.getSelectIndex("y","right"),E=this.getSelectIndex("z","left"),g=this.getSelectIndex("z","right"),v=this.getFramePainter(),f={name:Y.fName,entries:0,eff_entries:0,integral:0,meanx:0,meany:0,meanz:0,rmsx:0,rmsy:0,rmsz:0,skewx:0,skewy:0,skewz:0,skewd:0,kurtx:0,kurty:0,kurtz:0,kurtd:0},C=Math.abs(Y.fTsumw)>1e-300&&!v.isAxisZoomed("x")&&!v.isAxisZoomed("y")&&!v.isAxisZoomed("z");let I,U,k,Z,ee,he,G,b,P,T,z=0,W=0,fe=0,we=0,Me=0,je=0,Ge=0,lt=0;for((0,x.isFunc)(F)||(F=null),I=0;I<this.nbinsx+2;++I)for(Z=ue.GetBinCoord(I-.5),ee=I<X?0:I>B?2:1,U=0;U<this.nbinsy+2;++U)for(he=Q.GetBinCoord(U-.5),G=U<$?0:U>A?2:1,k=0;k<this.nbinsz+2;++k)b=me.GetBinCoord(k-.5),P=k<E?0:k>g?2:1,(!F||F(Z,he,b))&&(T=Y.getBinContent(I,U,k),f.entries+=T,!C&&1===ee&&1===G&&1===P&&(z+=T,W+=T*T,fe+=Z*T,we+=he*T,Me+=b*T,je+=Z**2*T,Ge+=he**2*T,lt+=b**2*T));if(C&&(z=Y.fTsumw,W=Y.fTsumw2,fe=Y.fTsumwx,je=Y.fTsumwx2,we=Y.fTsumwy,Ge=Y.fTsumwy2,Me=Y.fTsumwz,lt=Y.fTsumwz2),Math.abs(z)>1e-300&&(f.meanx=fe/z,f.meany=we/z,f.meanz=Me/z,f.rmsx=Math.sqrt(Math.abs(je/z-f.meanx*f.meanx)),f.rmsy=Math.sqrt(Math.abs(Ge/z-f.meany*f.meany)),f.rmsz=Math.sqrt(Math.abs(lt/z-f.meanz*f.meanz))),f.integral=z,Y.fEntries>1&&(f.entries=Y.fEntries),f.eff_entries=W?z*z/W:Math.abs(z),J&&!this.isTH2Poly()){let bt=0,te=0,Je=0,tt=0,Fe=0,Ne=0,rt=0,St=0;for(let Bn=X;Bn<B;++Bn){Z=ue.GetBinCoord(Bn+.5);for(let Mn=$;Mn<A;++Mn){he=Q.GetBinCoord(Mn+.5);for(let bn=E;bn<g;++bn)b=me.GetBinCoord(bn+.5),(!F||F(Z,he,b))&&(St=Y.getBinContent(Bn+1,Mn+1,bn+1),rt+=St,bt+=St*Math.pow(Z-f.meanx,3),te+=St*Math.pow(he-f.meany,3),Je+=St*Math.pow(b-f.meany,3),tt+=St*Math.pow(Z-f.meanx,4),Fe+=St*Math.pow(he-f.meany,4),Ne+=St*Math.pow(he-f.meany,4))}}const pt=Math.pow(f.rmsx,3),st=Math.pow(f.rmsy,3),vt=Math.pow(f.rmsz,3),Yt=Math.pow(f.rmsx,4),qt=Math.pow(f.rmsy,4),Ot=Math.pow(f.rmsz,4);rt*pt!=0&&(f.skewx=bt/(rt*pt)),rt*st!=0&&(f.skewy=te/(rt*st)),rt*vt!=0&&(f.skewz=Je/(rt*vt)),f.skewd=f.eff_entries>0?Math.sqrt(6/f.eff_entries):0,rt*Yt!=0&&(f.kurtx=tt/(rt*Yt)-3),rt*qt!=0&&(f.kurty=Fe/(rt*qt)-3),rt*Ot!=0&&(f.kurtz=Ne/(rt*Ot)-3),f.kurtd=f.eff_entries>0?Math.sqrt(24/f.eff_entries):0}return f}fillStatistic(F,J,Y){if(this.isIgnoreStatsFill())return!1;1===J&&(J=1111);const ue=J%10,Q=Math.floor(J/10)%10,me=Math.floor(J/100)%10,X=Math.floor(J/1e3)%10,B=Math.floor(J/1e6)%10,$=Math.floor(J/1e7)%10,A=Math.floor(J/1e8)%10,E=this.countStat(void 0,$>0||A>0);return F.clearPave(),ue>0&&F.addText(E.name),Q>0&&F.addText("Entries = "+F.format(E.entries,"entries")),me>0&&(F.addText("Mean x = "+F.format(E.meanx)),F.addText("Mean y = "+F.format(E.meany)),F.addText("Mean z = "+F.format(E.meanz))),X>0&&(F.addText("Std Dev x = "+F.format(E.rmsx)),F.addText("Std Dev y = "+F.format(E.rmsy)),F.addText("Std Dev z = "+F.format(E.rmsz))),B>0&&F.addText("Integral = "+F.format(E.integral,"entries")),2===$?(F.addText(`Skewness x = ${F.format(E.skewx)} #pm ${F.format(E.skewd)}`),F.addText(`Skewness y = ${F.format(E.skewy)} #pm ${F.format(E.skewd)}`),F.addText(`Skewness z = ${F.format(E.skewz)} #pm ${F.format(E.skewd)}`)):$>0&&(F.addText(`Skewness x = ${F.format(E.skewx)}`),F.addText(`Skewness y = ${F.format(E.skewy)}`),F.addText(`Skewness z = ${F.format(E.skewz)}`)),2===A?(F.addText(`Kurtosis x = ${F.format(E.kurtx)} #pm ${F.format(E.kurtd)}`),F.addText(`Kurtosis y = ${F.format(E.kurty)} #pm ${F.format(E.kurtd)}`),F.addText(`Kurtosis z = ${F.format(E.kurtz)} #pm ${F.format(E.kurtd)}`)):A>0&&(F.addText(`Kurtosis x = ${F.format(E.kurtx)}`),F.addText(`Kurtosis y = ${F.format(E.kurty)}`),F.addText(`Kurtosis z = ${F.format(E.kurtz)}`)),Y&&F.fillFunctionStat(this.findFunction(x.clTF3),Y,3),!0}getBinTooltips(F,J,Y){const ue=[],Q=this.getHisto();ue.push(this.getObjectHint(),`x = ${this.getAxisBinTip("x",Q.fXaxis,F)}  xbin=${F+1}`,`y = ${this.getAxisBinTip("y",Q.fYaxis,J)}  ybin=${J+1}`,`z = ${this.getAxisBinTip("z",Q.fZaxis,Y)}  zbin=${Y+1}`);const me=Q.getBinContent(F+1,J+1,Y+1);if(me===Math.round(me)?ue.push(`entries = ${me}`):ue.push(`entries = ${(0,ve.lg)(me,x.gStyle.fStatFormat)}`),this.matchObjectType(x.clTProfile3D)){const X=Q.getBinError(Q.getBin(F+1,J+1,Y+1));ue.push("error = "+(X===Math.round(X)?X.toString():(0,ve.lg)(X,x.gStyle.fPaintTextFormat)))}return ue}draw3DScatter(){const F=this.getObject(),J=this.getFramePainter(),Y=this.getSelectIndex("x","left",.5),ue=this.getSelectIndex("x","right",0),Q=this.getSelectIndex("y","left",.5),me=this.getSelectIndex("y","right",0),X=this.getSelectIndex("z","left",.5),B=this.getSelectIndex("z","right",0);let $,A,E,g;if(ue<=Y||me<=Q||B<=X)return Promise.resolve(!0);const v=this.gmaxbin>1e3?1e3/this.gmaxbin:1,f=Math.max(0,this.gminbin);let C=0,I=0;for($=Y;$<ue;++$)for(A=Q;A<me;++A)for(E=X;E<B;++E)g=F.getBinContent($+1,A+1,E+1),I+=g,!(g<=f)&&(C+=Math.round(g*v));if(C>(J.webgl?1e5:3e4))return!1;const U=new Ye._l(C,J.webgl,J.size_x3d/200),k=new Int32Array(C),Z=new ve.YF(I);let ee=0;for($=Y;$<ue;++$)for(A=Q;A<me;++A)for(E=X;E<B;++E){if(g=F.getBinContent($+1,A+1,E+1),g<=f)continue;const he=Math.round(g*v);for(let G=0;G<he;++G){const b=F.fXaxis.GetBinCoord($+Z.random()),P=F.fYaxis.GetBinCoord(A+Z.random()),T=F.fZaxis.GetBinCoord(E+Z.random());k[ee++]=F.getBin($+1,A+1,E+1),U.addPoint(J.grx(b),J.gry(P),J.grz(T))}}return U.createPoints({color:this.getColor(F.fMarkerColor)}).then(he=>(J.add3DMesh(he),he.bins=k,he.painter=this,he.tip_color=3===F.fMarkerColor?16711680:65280,he.tooltip=function(G){const b=Math.floor(G.index/this.nvertex);if(b<0||b>=this.bins.length)return null;const P=this.painter,T=P.getHisto(),z=P.getFramePainter(),W=P.get3DToolTip(this.bins[b]);return W.x1=z.grx(T.fXaxis.GetBinLowEdge(W.ix)),W.x2=z.grx(T.fXaxis.GetBinLowEdge(W.ix+1)),W.y1=z.gry(T.fYaxis.GetBinLowEdge(W.iy)),W.y2=z.gry(T.fYaxis.GetBinLowEdge(W.iy+1)),W.z1=z.grz(T.fZaxis.GetBinLowEdge(W.iz)),W.z2=z.grz(T.fZaxis.GetBinLowEdge(W.iz+1)),W.color=this.tip_color,W.opacity=.3,W},!0))}draw3DBins(){var F=this;return(0,Ee.A)(function*(){if(!F.draw_content)return!1;let J=F.options.Box?F.options.BoxStyle:0;if(!J&&F.options.Scat){const yn=F.draw3DScatter();if(!1!==yn)return yn;J=12}else!J&&!F.options.GLBox&&!F.options.GLColor&&!F.options.Lego&&(J=12);const Y=F.getHisto(),ue=F.getFramePainter();let f,C,Q=0,me=!1,X=!1,B=!1,$=1,A=-1,E=F.getPadPainter()?.getRootPad()?.fLogv,g=!0,v=0,I=F.getColor(Y.fFillColor),U=.5;if(!J&&F.options.Lego&&(J=1===F.options.Lego?10:F.options.Lego),11===F.options.GLBox||12===F.options.GLBox){U=.4,me=!0,12===F.options.GLBox&&(B=!0);const yn=ue.webgl?new L.Gu$(.5,16,12):new L.Gu$(.5,8,6);yn.applyMatrix4((new L.kn4).makeRotationX(Math.PI/2)),yn.computeVertexNormals();const Sn=yn.getIndex().array,ii=yn.getAttribute("position").array,ai=yn.getAttribute("normal").array;Q=3*Sn.length,f=new Float32Array(Q),C=new Float32Array(Q);for(let Hi=0;Hi<Sn.length;++Hi){const ti=3*Sn[Hi];f[3*Hi]=ii[ti],f[3*Hi+1]=ii[ti+1],f[3*Hi+2]=ii[ti+2],C[3*Hi]=ai[ti],C[3*Hi+1]=ai[ti+1],C[3*Hi+2]=ai[ti+2]}}else{const yn=Ye.DJ.Indexes,Sn=Ye.DJ.Normals,ii=Ye.DJ.Vertices;Q=3*yn.length,f=new Float32Array(Q),C=new Float32Array(Q);for(let ai=0,Hi=-3;ai<yn.length;++ai){const ti=ii[yn[ai]];f[3*ai]=ti.x-.5,f[3*ai+1]=ti.y-.5,f[3*ai+2]=ti.z-.5,ai%6==0&&(Hi+=3),C[3*ai]=Sn[Hi],C[3*ai+1]=Sn[Hi+1],C[3*ai+2]=Sn[Hi+2]}X=!0,12===J?B=!0:13===J?(B=!0,X=!1):F.options.GLColor&&(B=!0,$=.5,g=!1,X=!1,A=0,me=!0)}F._box_option=J,g&&E?F.gminposbin&&F.gmaxbin>F.gminposbin?(v=Math.log(F.gminposbin)-.1,g=1/(Math.log(F.gmaxbin)-v)):(E=0,g=1):g&&(g=F.gminbin||F.gmaxbin?1/Math.max(Math.abs(F.gminbin),Math.abs(F.gmaxbin)):1);const k=yn=>{if(A>=0&&yn<A)return 0;if(!g)return 1;if(E){if(yn<=0)return 0;yn=Math.log(yn)-v}return Math.pow(Math.abs(yn*g),.3333)},Z=F.getSelectIndex("x","left",.5),ee=F.getSelectIndex("x","right",0),he=F.getSelectIndex("y","left",.5),G=F.getSelectIndex("y","right",0),b=F.getSelectIndex("z","left",.5),P=F.getSelectIndex("z","right",0);if(ee<=Z||G<=he||P<=b)return!1;const T=(ue.grx(Y.fXaxis.GetBinLowEdge(ee+1))-ue.grx(Y.fXaxis.GetBinLowEdge(Z+1)))/(ee-Z),z=(ue.gry(Y.fYaxis.GetBinLowEdge(G+1))-ue.gry(Y.fYaxis.GetBinLowEdge(he+1)))/(G-he),W=(ue.grz(Y.fZaxis.GetBinLowEdge(P+1))-ue.grz(Y.fZaxis.GetBinLowEdge(b+1)))/(P-b),fe={},we={},Me=B?F.getContour():null,je=B?F.getHistPalette():null;let lt,bt,te,Je,tt,Ge=0,Fe=0,Ne=null;F.transferFunc&&(0,He.proivdeEvalPar)(F.transferFunc,!0)&&(Ne=F.transferFunc);const rt=yn=>{const Sn=3*(0,He.getTF1Value)(Ne,tt,!1);return!Sn||Sn<0||Sn>=1?yn:yn+1e4*Math.round(200*Sn)};for(lt=Z;lt<ee;++lt)for(bt=he;bt<G;++bt)for(te=b;te<P;++te){if(tt=Y.getBinContent(lt+1,bt+1,te+1),!F.options.GLColor&&(0===tt||tt<F.gminbin)||(Je=k(tt),Je<.001)||(Ge++,!B))continue;let yn=Me.getPaletteIndex(je,tt);null!==yn?(Ne&&(yn=rt(yn)),void 0===fe[yn]&&(fe[yn]=0,we[yn]=Fe++),fe[yn]+=1):console.error(`not found color for value = ${tt}`)}B||(fe[0]=Ge,Fe=1,we[0]=0);const St=new Array(Fe),pt=new Array(Fe),st=new Array(Fe),vt=new Array(Fe),Yt=new Array(Fe),qt=new Array(Fe),Ot=new Array(Fe);for(const yn in fe){Ge=fe[yn];const Sn=we[yn];St[Sn]=Yt[Sn]=0,X&&(Yt[Sn]=Ge*Q/3>65520?2:1),pt[Sn]=new Float32Array(Ge*Q),st[Sn]=new Float32Array(Ge*Q),vt[Sn]=new Int32Array(Ge),1===Yt[Sn]&&(qt[Sn]=new Uint16Array(Ge*Ye.DJ.MeshSegments.length)),2===Yt[Sn]&&(Ot[Sn]=new Float32Array(Ge*Ye.DJ.Segments.length*3))}let Bn,Mn,bn,Dn,$n,Cn;for(lt=Z;lt<ee;++lt)for(Bn=Y.fXaxis.GetBinCenter(lt+1),Mn=ue.grx(Bn),bt=he;bt<G;++bt)for(bn=Y.fYaxis.GetBinCenter(bt+1),Dn=ue.gry(bn),te=b;te<P;++te){if(tt=Y.getBinContent(lt+1,bt+1,te+1),!F.options.GLColor&&(0===tt||tt<F.gminbin)||(Je=k(tt),Je<.001))continue;let yn=0;if(B){let Hi=Me.getPaletteIndex(je,tt);if(null===Hi)continue;Ne&&(Hi=rt(Hi)),yn=we[Hi]}Ge=St[yn],$n=Y.fZaxis.GetBinCenter(te+1),Cn=ue.grz($n),vt[yn][Ge]=Y.getBin(lt+1,bt+1,te+1);const Sn=pt[yn],ii=st[yn];let ai=Ge*Q;for(let Hi=0;Hi<Q;Hi+=3,ai+=3)Sn[ai]=Mn+f[Hi]*T*Je,Sn[ai+1]=Dn+f[Hi+1]*z*Je,Sn[ai+2]=Cn+f[Hi+2]*W*Je,ii[ai]=C[Hi],ii[ai+1]=C[Hi+1],ii[ai+2]=C[Hi+2];if(1===Yt[yn]){const Hi=Ye.DJ.MeshSegments;ai=Ge*Hi.length;const ti=Math.round(Ge*Q/3),Nr=qt[yn];for(let ss=0;ss<Hi.length;++ss)Nr[ai+ss]=ti+Hi[ss]}if(2===Yt[yn]){const Hi=Ye.DJ.Segments,ti=Ot[yn];ai=Ge*Hi.length*3;for(let Nr=0;Nr<Hi.length;++Nr,ai+=3){const ss=Ye.DJ.Vertices[Hi[Nr]];ti[ai]=Mn+(ss.x-.5)*T*Je,ti[ai+1]=Dn+(ss.y-.5)*z*Je,ti[ai+2]=Cn+(ss.z-.5)*W*Je}}St[yn]=Ge+1}for(const yn in fe){const Sn=we[yn],ii=new L.LoY;ii.setAttribute("position",new L.THS(pt[Sn],3)),ii.setAttribute("normal",new L.THS(st[Sn],3));let ai=$;B&&(I=F._color_palette.getColor(yn%1e4),yn>1e4&&(ai=Math.floor(yn/1e4)/200));const Hi=me?new L.G_z({color:I,opacity:ai,transparent:ai<1,vertexColors:!1}):new L.V9B({color:I,opacity:ai,transparent:ai<1,vertexColors:!1}),ti=new L.eaF(ii,Hi);if(ti.bins=vt[Sn],ti.bins_faces=Q/9,ti.painter=F,ti.scalex=U*T,ti.scaley=U*z,ti.scalez=U*W,ti.tip_color=3===Y.fFillColor?16711680:65280,ti.get_weight=k,ti.tooltip=function(Nr){const ss=Math.floor(Nr.faceIndex/this.bins_faces);if(ss<0||ss>=this.bins.length)return null;const Bs=this.painter,yo=Bs.getHisto(),xt=Bs.getFramePainter(),K=Bs.get3DToolTip(this.bins[ss]),ge=xt.grx(yo.fXaxis.GetBinCoord(K.ix-.5)),ye=xt.gry(yo.fYaxis.GetBinCoord(K.iy-.5)),Pe=xt.grz(yo.fZaxis.GetBinCoord(K.iz-.5)),At=this.get_weight(K.value);return K.x1=ge-this.scalex*At,K.x2=ge+this.scalex*At,K.y1=ye-this.scaley*At,K.y2=ye+this.scaley*At,K.z1=Pe-this.scalez*At,K.z2=Pe+this.scalez*At,K.color=this.tip_color,K},ue.add3DMesh(ti),Yt[Sn]>0){const Nr=new L.mrM({color:F.getColor(Y.fLineColor)}),ss=1===Yt[Sn]?(0,Ye.Fc)(pt[Sn],Nr,qt[Sn]):(0,Ye.Fc)(Ot[Sn],Nr);ue.add3DMesh(ss)}}return!0})()}redraw(F){var J=this;return(0,Ee.A)(function*(){const Y=J.getFramePainter(),ue=J.getHisto();let Q=Promise.resolve(!0);return"resize"===F?Y.resize3D()&&Y.render3D():((0,Re.wx)(Y),Q=Y.create3DScene(J.options.Render3D,J.options.x3dscale,J.options.y3dscale,J.options.Ortho).then(()=>(Y.setAxesRanges(ue.fXaxis,J.xmin,J.xmax,ue.fYaxis,J.ymin,J.ymax,ue.fZaxis,J.zmin,J.zmax,J),Y.set3DOptions(J.options),Y.drawXYZ(Y.toplevel,ot.TB,{zoom:x.settings.Zooming,ndim:3,draw:-1!==J.options.Axis,drawany:J.options.isCartesian()}),J.draw3DBins())).then(()=>{Y.render3D(),J.updateStatWebCanvas(),Y.addKeysHandler()})),J.isMainPainter()&&(Q=Q.then(()=>J.drawColorPalette(J.options.Zscale&&(12===J._box_option||13===J._box_option))).then(()=>J.drawHistTitle())),Q.then(()=>J.updateFunctions()).then(()=>J)})()}fillToolbar(){const F=this.getPadPainter();F&&(F.addPadButton("auto_zoom","Unzoom all axes","ToggleZoom","Ctrl *"),this.draw_content&&F.addPadButton("statbox","Toggle stat box","ToggleStatBox"),F.showPadButtons())}canZoomInside(F,J,Y){let ue=this.getHisto();return ue&&(ue=ue[`f${F.toUpperCase()}axis`]),!ue||ue.FindBin(Y,.5)-ue.FindBin(J,0)>1}autoZoom(){const F=this.getSelectIndex("x","left"),J=this.getSelectIndex("x","right"),Y=this.getSelectIndex("y","left"),ue=this.getSelectIndex("y","right"),Q=this.getSelectIndex("z","left"),me=this.getSelectIndex("z","right"),X=this.getObject();let B,$,A;if(F===J||Y===ue||Q===me)return;let E=X.getBinContent(F+1,Y+1,Q+1);for(B=F;B<J;++B)for($=Y;$<ue;++$)for(A=Q;A<me;++A)E=Math.min(E,X.getBinContent(B+1,$+1,A+1));if(E>0)return;let g=J,v=F,f=ue,C=Y,I=me,U=Q;for(B=F;B<J;++B)for($=Y;$<ue;++$)for(A=Q;A<me;++A)X.getBinContent(B+1,$+1,A+1)>E&&(B<g&&(g=B),B>=v&&(v=B+1),$<f&&(f=$),$>=C&&(C=$+1),A<I&&(I=A),A>=U&&(U=A+1));let k,Z,ee,he,G,b,P=!1;return g===v-1&&g>F+1&&v<J-1&&(g--,v++),f===C-1&&f>Y+1&&C<ue-1&&(f--,C++),I===U-1&&I>Q+1&&U<me-1&&(I--,U++),(g>F||v<J)&&g<v-1&&(k=X.fXaxis.GetBinLowEdge(g+1),Z=X.fXaxis.GetBinLowEdge(v+1),P=!0),(f>Y||C<ue)&&f<C-1&&(ee=X.fYaxis.GetBinLowEdge(f+1),he=X.fYaxis.GetBinLowEdge(C+1),P=!0),(I>Q||U<me)&&I<U-1&&(G=X.fZaxis.GetBinLowEdge(I+1),b=X.fZaxis.GetBinLowEdge(U+1),P=!0),P?this.getFramePainter().zoom(k,Z,ee,he,G,b):void 0}fillHistContextMenu(F){const J=this.getSupportedDrawOptions();F.addDrawMenu("Draw with",J,Y=>{if(0===Y.indexOf(x.kInspect))return this.showInspector(Y);this.decodeOptions(Y),this.interactiveRedraw(!0,"drawopt")})}static draw(F,J,Y){return(0,Ee.A)(function*(){const ue=new Ve(F,J);return ue.mode3d=!0,(0,ke.ensureTCanvas)(ue,"3d").then(()=>(ue.setAsMainPainter(),ue.decodeOptions(Y),ue.checkPadRange(),ue.scanContent(),ue.createStat(),ue.redraw())).then(()=>ue.drawFunctions()).then(()=>(ue.fillToolbar(),ue))})()}}},5891:(Yr,mt,Se)=>{"use strict";Se.r(mt),Se.d(mt,{TPavePainter:()=>F});var Ee=Se(4882),x=Se(8872),L=Se(8362),ve=Se(6983),ke=Se(2843),ot=Se(1922),Ye=Se(7900),Ze=Se(2866),Re=Se(5638),He=Se(4483);const Ve=(0,x.BIT)(17);class F extends ot.JW{constructor(Y,ue){super(Y,ue),this.Enabled=!0,this.UseContextMenu=!0}autoPlaceLegend(Y,ue,Q){var me=this;return(0,Ee.A)(function*(){let B=me.getFrameSvg().selectChild(".main_layer").node().outerHTML;B=(0,ke.NM)(B),B='<svg xmlns="http://www.w3.org/2000/svg"'+B.slice(4);const $=ue?.fLeftMargin??x.gStyle.fPadLeftMargin,A=ue?.fRightMargin??x.gStyle.fPadRightMargin,E=ue?.fTopMargin??x.gStyle.fPadTopMargin,g=ue?.fBottomMargin??x.gStyle.fPadBottomMargin;return(0,ke.Vm)(B).then(v=>{if(!v)return!1;let f=100,C=100;const U=v.getContext("2d").getImageData(0,0,v.width,v.height).data,k=Math.floor(v.width/f),Z=Math.floor(v.height/C),ee=new Array(f*C);U.length!==v.width*v.height*4&&(console.log(`Image size missmatch in TLegend autoplace ${U.length} expected ${v.width*v.height*4}`),f=C=0);for(let z=0;z<f;++z){const W=z*k,fe=W+k;for(let we=0;we<C;++we){const Me=we*Z,je=Me+Z;let Ge=0;for(let lt=W;lt<fe&&!Ge;++lt)for(let bt=Me;bt<je;++bt){const te=4*(bt*v.width+lt);if(U[te]||U[te+1]||U[te+2]||U[te+3]){Ge=1;break}}ee[we*f+z]=Ge}}const he=.3/Math.max(.2,1-$-A),G=Math.min(.5,Math.max(.1,.05*Y.fPrimitives.arr.length))/Math.max(.2,1-E-g),b=Math.round(he*f),P=Math.round(G*C),T=(z,W)=>{for(let fe=z;fe<z+b;++fe)for(let we=W;we<W+P;++we)if(ee[we*f+fe])return!1;return!0};for(let z=0;z<f-b;++z)for(let W=C-P-1;W>=0;--W)if(T(z,W))return Y.fX1NDC=$+z/f*(1-$-A),Y.fX2NDC=Y.fX1NDC+he*(1-$-A),Y.fY2NDC=1-E-W/C*(1-g-E),Y.fY1NDC=Y.fY2NDC-G*(1-g-E),!0}).then(v=>{if(v||Q)return v;Y.fX1NDC=Math.max($??0,Y.fX2NDC-.3),Y.fX2NDC=Math.min(Y.fX1NDC+.3,1-A);const f=Math.max(Y.fPrimitives?.05*Y.fPrimitives.arr.length:0,.2);return Y.fY2NDC=Math.min(1-E,Y.fY1NDC+f),Y.fY1NDC=Math.max(Y.fY2NDC-f,g),!0})})()}drawPave(Y){var ue=this;return(0,Ee.A)(function*(){if(!ue.Enabled)return ue.removeG(),ue;const Q=ue.getObject(),me=Q.fOption.toUpperCase(),X=ue.getFramePainter(),B=ue.getPadPainter(),$=B.getRootPad(!0);let A,E,g;0===Q.fInit&&(ue.stored=Object.assign({},Q),Q.fInit=1,Q._typename!==x.clTPaletteAxis||Q.fX1||Q.fX2||Q.fY1||Q.fY2?me.indexOf("NDC")>=0?(Q.fX1NDC=Q.fX1,Q.fX2NDC=Q.fX2,Q.fY1NDC=Q.fY1,Q.fY2NDC=Q.fY2):$&&0===$.fX1&&1===$.fX2&&0===$.fY1&&1===$.fY2&&(0,x.isStr)(Y)&&Y.indexOf("postpone")>=0?(Q.fInit=0,Q.fX1NDC=Q.fY1NDC=.99,Q.fX2NDC=Q.fY2NDC=1):$?($.fLogx&&(Q.fX1>0&&(Q.fX1=Math.log10(Q.fX1)),Q.fX2>0&&(Q.fX2=Math.log10(Q.fX2))),$.fLogy&&(Q.fY1>0&&(Q.fY1=Math.log10(Q.fY1)),Q.fY2>0&&(Q.fY2=Math.log10(Q.fY2))),Q.fX1NDC=(Q.fX1-$.fX1)/($.fX2-$.fX1),Q.fY1NDC=(Q.fY1-$.fY1)/($.fY2-$.fY1),Q.fX2NDC=(Q.fX2-$.fX1)/($.fX2-$.fX1),Q.fY2NDC=(Q.fY2-$.fY1)/($.fY2-$.fY1)):(Q.fX1NDC=Q.fY1NDC=.1,Q.fX2NDC=Q.fY2NDC=.9):X?(Q.fX1NDC=X.fX2NDC+.01,Q.fX2NDC=Math.min(.96,X.fX2NDC+.06),Q.fY1NDC=X.fY1NDC,Q.fY2NDC=X.fY2NDC):(Q.fX2NDC=.8,Q.fX1NDC=.9,Q.fY1NDC=.1,Q.fY2NDC=.9));let v=Promise.resolve(!0);return Q._typename===x.clTLegend&&(ue.AutoPlace||Q.fX1NDC===Q.fX2NDC&&Q.fY1NDC===Q.fY2NDC)&&(v=ue.autoPlaceLegend(Q,$).then(f=>(delete ue.AutoPlace,f||(Q.fX1NDC=X.fX2NDC-.2,Q.fX2NDC=X.fX2NDC,Q.fY1NDC=X.fY2NDC-.1,Q.fY2NDC=X.fY2NDC),f))),v.then(()=>{if(ue.isStats()&&!ue.NoFillStats&&!B._fast_drawing){const Z=Q.$main_painter||ue.getMainPainter();if((0,x.isFunc)(Z?.fillStatistic)){let ee=parseInt(Q.fOptStat),he=parseInt(Q.fOptFit);if((!Number.isInteger(ee)||Q.TestBit(Ve))&&(ee=x.gStyle.fOptStat),(!Number.isInteger(he)||Q.TestBit(Ve))&&(he=x.gStyle.fOptFit),Z.fillStatistic(ue,ee,he)){let G=Q.fLines?.arr.length||0;if(G>0&&!ue.moved_interactive&&function De(J){const Y=(ue,Q)=>Math.abs(ue-Q)<.001;return Y(J.fX1NDC,x.gStyle.fStatX-x.gStyle.fStatW)&&Y(J.fY1NDC,x.gStyle.fStatY-x.gStyle.fStatH)&&Y(J.fX2NDC,x.gStyle.fStatX)&&Y(J.fY2NDC,x.gStyle.fStatY)}(Q)){const b=ue._has_fit&&ue._fit_dim>1?x.gStyle.fStatH:0;b&&(G-=ue._fit_cnt);let P=x.gStyle.fStatH,T=x.gStyle.fStatW;ue._has_fit&&(T=1.8*x.gStyle.fStatW),x.gStyle.fStatFontSize<=0||x.gStyle.fStatFont%10==3?P=.25*G*x.gStyle.fStatH:x.gStyle.fStatFontSize<1&&(P=G*x.gStyle.fStatFontSize),Q.fX1NDC=Math.max(.02,Q.fX2NDC-T),Q.fY1NDC=Math.max(.02,Q.fY2NDC-P-b)}}}}const f=B.getPadRect(),C=Q.fBorderSize,I=me.indexOf("NB")>=0,U=me.indexOf("L")>=0?-1:me.indexOf("R")>=0?1:0,k=me.indexOf("T")>=0?-1:me.indexOf("B")>=0?1:0;if(ue.createG(),ue._pave_x=Math.round(Q.fX1NDC*f.width),ue._pave_y=Math.round((1-Q.fY2NDC)*f.height),E=Math.round((Q.fX2NDC-Q.fX1NDC)*f.width),g=Math.round((Q.fY2NDC-Q.fY1NDC)*f.height),(0,ke.bk)(ue.draw_g,ue._pave_x,ue._pave_y),ue.createAttLine({attr:Q,width:C>0?Q.fLineWidth:0}),ue.createAttFill({attr:Q}),Q._typename===x.clTDiamond){const Z=Math.round(g/2),ee=Math.round(E/2),he=`l${ee},${-Z}l${ee},${Z}l${-ee},${Z}z`;C>1&&Q.fShadowColor>0&&(U||k)&&!ue.fillatt.empty()&&!I&&ue.draw_g.append("svg:path").attr("d","M0,"+(Z+C)+he).style("fill",ue.getColor(Q.fShadowColor)).style("stroke",ue.getColor(Q.fShadowColor)).style("stroke-width","1px"),A=ue.draw_g.append("svg:path").attr("d","M0,"+Z+he).call(ue.fillatt.func).call(ue.lineatt.func);const G=ue.draw_g.append("svg:g");return(0,ke.bk)(G,Math.round(E/4),Math.round(g/4)),ue.drawPaveText(ee,Z,Y,G)}if(C>1&&Q.fShadowColor>0&&!Q.fNpaves&&(U||k)&&!I){const Z=ue.getColor(Q.fShadowColor);let ee="";ee=U<0&&k<0?`M0,0v${g-C}h${-C}v${-g}h${E}v${C}z`:U<0&&k>0?`M0,${g}v${C-g}h${-C}v${g}h${E}v${-C}z`:U>0&&k<0?`M${C},0v${-C}h${E}v${g}h${-C}v${C-g}z`:`M${E},${C}h${C}v${g}h${-E}v${-C}h${E-C}z`,ue.draw_g.append("svg:path").attr("d",ee).style("fill",Z).style("stroke",Z).style("stroke-width","1px")}if(Q.fNpaves)for(let Z=Q.fNpaves-1;Z>0;--Z)ue.draw_g.append("svg:path").attr("d",`M${4*U*Z},${4*k*Z}h${E}v${g}h${-E}z`).call(ue.fillatt.func).call(ue.lineatt.func);return(!ue.isBatchMode()||!ue.fillatt.empty()||!ue.lineatt.empty()&&!I)&&(A=ue.draw_g.append("svg:path").attr("d",`M0,0H${E}V${g}H0Z`).call(ue.fillatt.func),I||A.call(ue.lineatt.func)),!(0,x.isFunc)(ue.paveDrawFunc)||ue.paveDrawFunc(E,g,Y)}).then(()=>(ue.isBatchMode()||Q._typename===x.clTPave||(A&&A.style("pointer-events","visibleFill").on("mouseenter",()=>ue.showObjectStatus()),(0,Re.WJ)(ue,{obj:Q,x:ue._pave_x,y:ue._pave_y,width:E,height:g,minwidth:10,minheight:20,canselect:!0,redraw:()=>{ue.moved_interactive=!0,ue.interactiveRedraw(!1,"pave_moved"),ue.drawPave()},ctxmenu:x.browser.touches&&x.settings.ContextMenu&&ue.UseContextMenu}),ue.UseContextMenu&&x.settings.ContextMenu&&ue.draw_g.on("contextmenu",f=>ue.paveContextMenu(f)),Q._typename===x.clTPaletteAxis&&ue.interactivePaletteAxis(E,g)),ue))})()}fillWebObjectOptions(Y){const ue=this.getObject();return ue?.fInit&&(Y.fcust="pave",Y.fopt=[ue.fX1NDC,ue.fY1NDC,ue.fX2NDC,ue.fY2NDC],"stats"===ue.fName&&this.isStats()&&ue.fLines.arr.forEach(Q=>{(Q._typename===x.clTText||Q._typename===x.clTLatex)&&(Y.fcust+=`;;${Q.fTitle}`)})),Y}drawPaveLabel(Y,ue){var Q=this;return(0,Ee.A)(function*(){const me=Q.getObject();return me.fLabel&&me.fLabel.trim()?(Q.createAttText({attr:me}),Q.startTextDrawing(Q.textatt.font,ue/1.2),Q.drawText(Q.textatt.createArg({width:Y,height:ue,text:me.fLabel,norotate:!0})),Q.finishTextDrawing()):Q})()}drawPaveStats(Y,ue){const Q=this.getObject(),me=[],X=[];let B=0,$=0,A=0;for(let I=0;I<Q.fLines.arr.length;++I){const U=Q.fLines.arr[I];(U._typename===x.clTText||U._typename===x.clTLatex)&&(me.push(U.fTitle),X.push(U.fTextColor))}const E=me.length;for(let I=0;I<E;++I){const U=me[I];if(I>0&&(A=Math.max(A,U.length)),0===I||U.indexOf("|")<0)continue;0===B&&(B=I);const k=U.split("|");k.length>$&&($=k.length)}const g=ue/E,v=Q.fMargin*Y;let f=!1;if(this.createAttText({attr:Q}),this.startTextDrawing(this.textatt.font,ue/(1.2*E)),1===E)this.drawText(this.textatt.createArg({width:Y,height:ue,text:me[0],latex:1,norotate:!0}));else for(let I=0;I<E;++I){const U=I*g,k=X[I]>1?this.getColor(X[I]):this.textatt.color;if(B&&I>=B){const Z=me[I].split("|");for(let ee=0;ee<Z.length;++ee)this.drawText({align:"middle",x:Y*ee/$,y:U,latex:0,width:Y/$,height:g,text:Z[ee],color:k})}else if(me[I].indexOf("=")<0){if(0===I){f=!0;const Z=Math.max(A,Math.round((Y-2*v)/g/.65));me[I].length>Z+5&&(me[I]=me[I].slice(0,Z+2)+"...")}this.drawText({align:0===I?"middle":"start",x:v,y:U,width:Y-2*v,height:g,text:me[I],color:k})}else{const Z=me[I].split("="),ee=[];for(let he=0;he<2;++he)ee.push({align:0===he?"start":"end",x:v,y:U,width:Y-2*v,height:g,text:Z[he],color:k,_expected_width:Y-2*v,_args:ee,post_process(b){this._args[0].ready&&this._args[1].ready&&b.scaleTextDrawing(1.05*(this._args[0].result_width+this._args[1].result_width)/this._expected_width,b.draw_g)}});for(let he=0;he<2;++he)this.drawText(ee[he])}}let C="";if(Q.fBorderSize>0&&f&&(C+=`M0,${Math.round(g)}h${Y}`),B>0&&$>1){for(let I=B;I<E;++I)C+=`M0,${Math.round(I*g)}h${Y}`;for(let I=0;I<$-1;++I)C+=`M${Math.round(Y/$*(I+1))},${Math.round(B*g)}V${ue}`}return C&&this.draw_g.append("svg:path").attr("d",C).call(this.lineatt.func),this.finishTextDrawing(void 0,E>1)}drawPaveText(Y,ue,Q,me){const X=this.getObject(),B=X.fLines?.arr||[],$=B.length,A=this.getPadPainter(),E=A.getPadHeight(),g=X.fLabel.length>0,v=[],f=X.fMargin*Y,C=ue/($||1);let I=0;this.createAttText({attr:X}),1===$&&this.textatt.size>0&&(I=Math.max(3,this.textatt.getSize(E))),me||(me=this.draw_g);const U=1===$&&A._fast_drawing;let k=0;for(let Z=0;Z<$;++Z){const ee=B[Z],he=Z*C;switch(ee._typename){case x.clTText:case x.clTLatex:{if(!ee.fTitle||!ee.fTitle.trim())continue;let G=ee.fTextColor?this.getColor(ee.fTextColor):"";if(G||(G=this.textatt.color),ee.fX||ee.fY||ee.fTextSize){const b=ee.fTextAlign||this.textatt.align,P=Math.floor(b/10),T=b%10,z=ee.fX?ee.fX*Y:1===P?f:2===P?Y/2:Y-f,W=ee.fY?(1-ee.fY)*ue:he+(2===T?C/2:3===T?C:0),fe=me.append("svg:g");this.startTextDrawing(this.textatt.font,this.textatt.getAltSize(ee.fTextSize,E),fe),this.drawText({align:b,x:z,y:W,text:ee.fTitle,color:G,latex:ee._typename===x.clTText?0:1,draw_g:fe,fast:U}),v.push(this.finishTextDrawing(fe))}else 0==k++&&this.startTextDrawing(this.textatt.font,.85*ue/$,me,I),this.drawText({x:f,y:he,width:Y-2*f,height:C,align:ee.fTextAlign||this.textatt.align,draw_g:me,latex:ee._typename===x.clTText?0:1,text:ee.fTitle,color:G,fast:U});break}case x.clTLine:{const G=ee.fX1?Math.round(ee.fX1*Y):0,b=ee.fX2?Math.round(ee.fX2*Y):Y,P=ee.fY1?Math.round((1-ee.fY1)*ue):Math.round(he+.5*C),T=ee.fY2?Math.round((1-ee.fY2)*ue):Math.round(he+.5*C),z=this.createAttLine(ee);me.append("svg:path").attr("d",`M${G},${P}L${b},${T}`).call(z.func);break}case x.clTBox:{const G=ee.fX1?Math.round(ee.fX1*Y):0,b=ee.fX2?Math.round(ee.fX2*Y):Y,P=ee.fY1?Math.round((1-ee.fY1)*ue):Math.round(he),T=ee.fY2?Math.round((1-ee.fY2)*ue):Math.round(he+C),z=this.createAttFill(ee);me.append("svg:path").attr("d",`M${G},${P}H${b}V${T}H${G}Z`).call(z.func);break}}}if(k>0&&v.push(this.finishTextDrawing(me,k>1)),g){const Z=Math.round(.25*Y),ee=Math.round(.02*-ue),he=Math.round(.5*Y),G=Math.round(.04*ue),b=me.append("svg:g");b.append("svg:path").attr("d",`M${Z},${ee}h${he}v${G}h${-he}z`).call(this.fillatt.func).call(this.lineatt.func),this.startTextDrawing(this.textatt.font,G/1.5,b),this.drawText({align:22,x:Z,y:ee,width:he,height:G,text:X.fLabel,color:this.textatt.color,draw_g:b}),v.push(this.finishTextDrawing(b))}return Promise.all(v).then(()=>this)}format(Y,ue){ue||(ue="stat");const Q=this.getObject();switch(ue){case"stat":ue=Q.fStatFormat||x.gStyle.fStatFormat;break;case"fit":ue=Q.fFitFormat||x.gStyle.fFitFormat;break;case"entries":if(Math.abs(Y)<1e9&&Math.round(Y)===Y)return Y.toFixed(0);ue="14.7g";break;case"last":ue=this.lastformat}const me=(0,ke.lg)(Y,ue||"6.4g",!0);return this.lastformat=me[1],me[0]}drawLegend(Y,ue){const Q=this.getObject(),me=Q.fPrimitives.arr.length;let X=Q.fNColumns,B=me,$=!1,A=!1;if(X<2)X=1;else for(;(B-1)*X>=me;)B--;const E=G=>!(G.fObject||G.fOption||G.fLabel&&" "!==G.fLabel);for(let G=0;G<me;++G){const b=Q.fPrimitives.arr[G];E(b)?1===X&&B--:b.fLabel&&($=!0,(b.fTextFont&&b.fTextFont!==Q.fTextFont||b.fTextSize&&b.fTextSize!==Q.fTextSize)&&(A=!0))}B<1&&(B=1);const g=new Array(X+1).fill(0);if(X>1){const G=new Array(X).fill(1);for(let P=0;P<me;++P){const T=Q.fPrimitives.arr[P];if(E(T))continue;const z=P%X;G[z]=Math.max(G[z],T.fLabel.length)}let b=0;for(let P=0;P<X;++P)b+=G[P];for(let P=0;P<X-1;++P)g[P+1]=g[P]+Q.fMargin*Y/X+G[P]*(1-Q.fMargin)*Y/b}g[X]=Y;const v=Math.round(.03*Y/X),f=Math.round(.03*ue),C=(ue-2*f)/B,I=[],U=this.getPadPainter();let k=.9*C,Z=0,ee=!1;this.createAttText({attr:Q});const he=this.textatt.getSize(U.getPadHeight());he&&he<k&&(k=Z=he),$&&!A&&this.startTextDrawing(this.textatt.font,k,this.draw_g,Z);for(let G=0,b=-1;G<me;++G){const P=Q.fPrimitives.arr[G];if(E(P))continue;1===X?++b:b=G;const T=P.fOption.toLowerCase(),z=b%X,W=(b-z)/X,fe=Math.round(g[z]),we=Math.round(g[z+1]-g[z]),Me=fe+Math.round(Q.fMargin*Y/X),je=Math.round((fe+Me)/2),Ge=Math.round(W*C+f),lt=Math.round((W+.5)*C+f),bt=P.fObject,te=-1!==T.indexOf("f"),Je=-1!==T.indexOf("l"),tt=-1!==T.indexOf("e"),Fe=-1!==T.indexOf("p");let Ne=P,rt=P,St=P,pt=null,st=!1;if((0,x.isObject)(bt)&&("fLineColor"in bt&&(St=bt),"fFillColor"in bt&&(Ne=bt),"fMarkerColor"in bt&&(rt=bt),pt=U.findPainterFor(bt)),te){const Yt=pt?.fillatt?.used?pt.fillatt:this.createAttFill(Ne);let qt;if(!Je&&!tt&&!Fe&&(qt=pt?.lineatt?.used?pt.lineatt:this.createAttLine(St),qt.empty()&&(qt=null)),!Yt.empty()||qt){st=!0;const Ot=this.draw_g.append("svg:path").attr("d",`M${fe+v},${Math.round(Ge+.1*C)}v${Math.round(.8*C)}h${Me-2*v-fe}v${-Math.round(.8*C)}z`);Yt.empty()||Ot.call(Yt.func),qt&&Ot.call(qt.func)}}if(Je||tt){const Yt=pt?.lineatt?.used?pt.lineatt:this.createAttLine(St);if(!Yt.empty()&&(st=!0,Je&&this.draw_g.append("svg:path").attr("d",`M${fe+v},${lt}H${Me-v}`).call(Yt.func),tt)){let qt=0,Ot=.05*C;(0,x.isFunc)(pt?.getHisto)&&1===pt.options?.ErrorKind?qt=1:(0,x.isFunc)(pt?.getGraph)&&void 0!==bt?.fLineWidth&&void 0!==bt?.fMarkerSize&&(qt=pt.options?.Ends??1,Ot=bt.fLineWidth+x.gStyle.fEndErrorSize,qt>1&&(Ot=Math.max(Ot,8*bt.fMarkerSize*.66)));const Bn=3===qt?.03:0,Mn=Math.round(Ge+C*(.1+Bn)),bn=Math.round(Ge+C*(.9-Bn)),Dn=Math.round(.66*Ot);Ot=Math.round(Ot);let $n=`M${je},${Mn}V${bn}`;switch(qt){case 1:$n+=`M${je-Ot},${Mn}h${2*Ot}M${je-Ot},${bn}h${2*Ot}`;break;case 2:$n+=`M${je-Ot},${Mn+Dn}v${-Dn}h${2*Ot}v${Dn}M${je-Ot},${bn-Dn}v${Dn}h${2*Ot}v${-Dn}`;break;case 3:$n+=`M${je-Ot},${Mn}h${2*Ot}l${-Ot},${-Dn}zM${je-Ot},${bn}h${2*Ot}l${-Ot},${Dn}z`;break;case 4:$n+=`M${je-Ot},${Mn+Dn}l${Ot},${-Dn}l${Ot},${Dn}M${je-Ot},${bn-Dn}l${Ot},${Dn}l${Ot},${-Dn}`}this.draw_g.append("svg:path").attr("d",$n).call(Yt.func).style("fill",qt>1?"none":null)}}if(Fe){const Yt=pt?.markeratt?.used?pt.markeratt:this.createAttMarker(rt);Yt.empty()||(st=!0,this.draw_g.append("svg:path").attr("d",Yt.create((fe+Me)/2,lt)).call(Yt.func))}!st&&pt?.lineatt&&!pt.lineatt.empty()&&this.draw_g.append("svg:path").attr("d",`M${fe+v},${Math.round(Ge+.1*C)}v${Math.round(.8*C)}h${Me-2*v-fe}v${-Math.round(.8*C)}z`).style("fill","none").call(pt.lineatt.func);let vt=Me;if((0,x.isStr)(T)&&"h"!==T.toLowerCase()?ee=!0:ee||(vt=fe+v),P.fLabel){let Yt=this.draw_g;const qt=this.createAttText({attr:P,std:!1,attr_alt:Q});if(A){Yt=this.draw_g.append("svg:g");const Ot=qt.getSize(U.getPadHeight());this.startTextDrawing(qt.font,Ot,Yt,Z)}this.drawText({draw_g:Yt,align:qt.align,x:vt,y:Ge,scale:A&&!P.fTextSize||!Q.fTextSize,width:fe+we-vt-v,height:C,text:P.fLabel,color:qt.color}),A&&I.push(this.finishTextDrawing(Yt))}}return $&&!A&&I.push(this.finishTextDrawing()),Promise.all(I)}drawPaletteAxis(Y,ue,Q){const me=this.getObject(),X=me.fAxis,B=(0,x.isStr)(Q)&&Q.indexOf("can_move")>=0,$=(0,x.isStr)(Q)&&Q.indexOf("postpone")>=0,A=(0,x.isStr)(Q)&&Q.indexOf("cjust")>=0,E=this.getPadPainter(),g=E.getPadWidth(),v=E.getPadHeight(),f=E.getRootPad(!0),C=me.$main_painter||this.getMainPainter(),I=this.getFramePainter(),U=C.fContour,k=U?.getLevels(),Z=(0,x.isFunc)(C.getDimension)&&3===C.getDimension(),ee=(Z?f?.fLogv:f?.fLogz)??0,he=C._color_palette,G=C.getObject()?.fZaxis,b=f?.fTickz?.35:.7;let z,W,P=0,T=100,fe="",we=0;if(this._palette_vertical=me.fX2NDC-me.fX1NDC<me.fY2NDC-me.fY1NDC,X.fTickSize=.6*Y/g,typeof G?.fLabelOffset<"u"&&!Z&&(X.fTitle=G.fTitle,X.fTitleSize=G.fTitleSize,X.fTitleOffset=G.fTitleOffset,X.fTextColor=G.fTitleColor,X.fTextFont=G.fTitleFont,X.fLineColor=G.fAxisColor,X.fLabelSize=G.fLabelSize,X.fLabelColor=G.fLabelColor,X.fLabelFont=G.fLabelFont,X.fLabelOffset=G.fLabelOffset,this.z_handle.setHistPainter(C,"z"),this.z_handle.source_axis=G),U&&I&&!Z?void 0!==I.zmin&&void 0!==I.zmax&&I.zmin!==I.zmax?(z=I.zmin,W=I.zmax,P=I.zoom_zmin,T=I.zoom_zmax,P===T&&(P=z,T=W)):(P=k[0],T=k[k.length-1]):void 0!==C.gmaxbin&&void 0!==C.gminbin?(P=C.gminbin,T=C.gmaxbin):void 0!==C.hmin&&void 0!==C.hmax&&(P=C.hmin,T=C.hmax),this.draw_g.selectAll("rect").style("fill","white"),(void 0===z||void 0===W||z===W)&&(z=P,W=T),this._palette_vertical?(this._swap_side=me.fX2NDC<.5,this.z_handle.configureAxis("zaxis",z,W,P,T,!0,[0,ue],{log:ee,fixed_ticks:A?k:null,maxTickSize:Math.round(Y*b),swap_side:this._swap_side}),fe=this._swap_side?null:`translate(${Y})`,f?.fTickz&&(we=this._swap_side?Y:-Y)):(this._swap_side=me.fY1NDC>.5,this.z_handle.configureAxis("zaxis",z,W,P,T,!1,[0,Y],{log:ee,fixed_ticks:A?k:null,maxTickSize:Math.round(ue*b),swap_side:this._swap_side}),fe=this._swap_side?null:`translate(0,${ue})`,f?.fTickz&&(we=this._swap_side?ue:-ue)),U&&he&&!$)for(let Me=0;Me<k.length-1;++Me){let bt,je=Math.round(this.z_handle.gr(k[Me])),Ge=Math.round(this.z_handle.gr(k[Me+1])),lt=(k[Me]+k[Me+1])/2;if(this._palette_vertical){if(Ge>=ue||je<0)continue;je+=1,je>ue?(je=ue,lt=.001*k[Me]+.999*k[Me+1]):Ge<0&&(Ge=0,lt=.999*k[Me]+.001*k[Me+1]),bt=`M0,${Ge}H${Y}V${je}H0Z`}else{if(je>=Y||Ge<0)continue;Ge+=1,Ge>Y?(Ge=Y,lt=.999*k[Me]+.001*k[Me+1]):je<0&&(je=0,lt=.001*k[Me]+.999*k[Me+1]),bt=`M${je},0V${ue}H${Ge}V0Z`}const te=U.getPaletteColor(he,lt);if(!te)continue;const Je=this.draw_g.append("svg:path").attr("d",bt).style("fill",te).property("fill0",te).property("fill1",(0,L.Qh)(te).darker(.5).formatHex());this.isTooltipAllowed()&&Je.on("mouseover",function(){(0,L.Lt)(this).transition().duration(100).style("fill",(0,L.Lt)(this).property("fill1"))}).on("mouseout",function(){(0,L.Lt)(this).transition().duration(100).style("fill",(0,L.Lt)(this).property("fill0"))}).append("svg:title").text(k[Me].toFixed(2)+" - "+k[Me+1].toFixed(2)),x.settings.Zooming&&Je.on("dblclick",()=>this.getFramePainter().unzoom("z"))}else this.draw_g.append("svg:path").attr("d",`M0,0H${Y}V${ue}H0Z`).style("fill","white");return this.z_handle.drawAxis(this.draw_g,Y,ue,fe,we).then(()=>{if(B&&"getBoundingClientRect"in this.draw_g.node()){const Me=this.draw_g.node().getBoundingClientRect();if(this._palette_vertical){const je=this._pave_x+parseInt(Me.width)-Math.round(.995*g)+3;je>0&&(this._pave_x-=je,(0,ke.bk)(this.draw_g,this._pave_x,this._pave_y),me.fX1NDC-=je/g,me.fX2NDC-=je/g)}else{const je=Math.round((1.05-x.gStyle.fTitleY)*v)-Me.y;je>0&&(this._pave_y+=je,(0,ke.bk)(this.draw_g,this._pave_x,this._pave_y),me.fY1NDC-=je/v,me.fY2NDC-=je/v)}}return this})}interactivePaletteAxis(Y,ue){let Q=!1,me=0,X=0,B=null;const $=g=>{if(!Q)return;g.preventDefault();const v=(0,L.Wn)(g,this.draw_g.node());this._palette_vertical?(X=Math.min(Math.max(v[1],0),ue),B.attr("y",Math.min(me,X)).attr("height",Math.abs(X-me))):(X=Math.min(Math.max(v[0],0),Y),B.attr("x",Math.min(me,X)).attr("width",Math.abs(X-me)))},A=g=>{if(!Q)return;g.preventDefault(),(0,L.Lt)(window).on("mousemove.colzoomRect",null).on("mouseup.colzoomRect",null),B.remove(),B=null,Q=!1;const v=this.z_handle.gr,f=v.invert(me),C=v.invert(X);this.getFramePainter().zoom("z",Math.min(f,C),Math.max(f,C))};x.settings.Zooming&&this.draw_g.selectAll(".axis_zoom").on("mousedown",g=>{if(Q)return;Q=!0,g.preventDefault(),g.stopPropagation();const v=(0,L.Wn)(g,this.draw_g.node());B=this.draw_g.append("svg:rect").attr("id","colzoomRect").call(ke.Ru,!0),this._palette_vertical?(me=X=v[1],B.attr("x","0").attr("width",Y).attr("y",me).attr("height",1)):(me=X=v[0],B.attr("x",me).attr("width",1).attr("y",0).attr("height",ue)),(0,L.Lt)(window).on("mousemove.colzoomRect",$).on("mouseup.colzoomRect",A,!0)}).on("dblclick",()=>this.getFramePainter().unzoom("z")),x.settings.ZoomWheel&&this.draw_g.on("wheel",g=>{const v=(0,L.Wn)(g,this.draw_g.node()),C=this.z_handle.analyzeWheelEvent(g,this._palette_vertical?1-v[1]/ue:v[0]/Y);C?.changed&&this.getFramePainter().zoom("z",C.min,C.max)})}fillContextMenuItems(Y){const ue=this.getObject();if(this.isStats()){Y.add("Default position",()=>{ue.fX2NDC=x.gStyle.fStatX,ue.fX1NDC=ue.fX2NDC-x.gStyle.fStatW,ue.fY2NDC=x.gStyle.fStatY,ue.fY1NDC=ue.fY2NDC-x.gStyle.fStatH,ue.fInit=1,this.interactiveRedraw(!0,"pave_moved")}),Y.add("Save to gStyle",()=>{x.gStyle.fStatX=ue.fX2NDC,x.gStyle.fStatW=ue.fX2NDC-ue.fX1NDC,x.gStyle.fStatY=ue.fY2NDC,x.gStyle.fStatH=ue.fY2NDC-ue.fY1NDC,this.fillatt?.saveToStyle("fStatColor","fStatStyle"),x.gStyle.fStatTextColor=ue.fTextColor,x.gStyle.fStatFontSize=ue.fTextSize,x.gStyle.fStatFont=ue.fTextFont},"Store stats position and graphical attributes to gStyle"),Y.add("SetStatFormat",()=>{Y.input("Enter StatFormat",ue.fStatFormat).then(me=>{me&&(ue.fStatFormat=me,this.interactiveRedraw(!0,`exec:SetStatFormat("${me}")`))})}),Y.add("SetFitFormat",()=>{Y.input("Enter FitFormat",ue.fFitFormat).then(me=>{me&&(ue.fFitFormat=me,this.interactiveRedraw(!0,`exec:SetFitFormat("${me}")`))})}),Y.add("separator"),Y.add("sub:SetOptStat",()=>{Y.input("Enter OptStat",ue.fOptStat,"int").then(me=>{ue.fOptStat=me,this.interactiveRedraw(!0,`exec:SetOptStat(${me})`)})});const Q=(me,X)=>{let B=me<10?ue.fOptStat:ue.fOptFit;B=parseInt(parseInt(B)/parseInt(Math.pow(10,me%10)))%10,Y.addchk(B,X,100*B+me,$=>{const A=parseInt($/100);let E=$%100<10?ue.fOptStat:ue.fOptFit;E-=(A>0?A:-1)*parseInt(Math.pow(10,$%10)),$%100<10?(ue.fOptStat=E,this.interactiveRedraw(!0,`exec:SetOptStat(${E})`)):(ue.fOptFit=E,this.interactiveRedraw(!0,`exec:SetOptFit(${E})`))})};Q(0,"Histogram name"),Q(1,"Entries"),Q(2,"Mean"),Q(3,"Std Dev"),Q(4,"Underflow"),Q(5,"Overflow"),Q(6,"Integral"),Q(7,"Skewness"),Q(8,"Kurtosis"),Y.add("endsub:"),Y.add("sub:SetOptFit",()=>{Y.input("Enter OptStat",ue.fOptFit,"int").then(me=>{ue.fOptFit=me,this.interactiveRedraw(!0,`exec:SetOptFit(${me})`)})}),Q(10,"Fit parameters"),Q(11,"Par errors"),Q(12,"Chi square / NDF"),Q(13,"Probability"),Y.add("endsub:"),Y.add("separator")}else ue._typename===x.clTLegend?Y.add("Autoplace",()=>{this.autoPlaceLegend(ue,this.getPadPainter()?.getRootPad(!0),!0).then(Q=>{Q&&this.interactiveRedraw(!0,"pave_moved")})}):"title"===ue.fName&&(Y.add("Default position",()=>{ue.fX1NDC=x.gStyle.fTitleW>0?x.gStyle.fTitleX-x.gStyle.fTitleW/2:x.gStyle.fPadLeftMargin,ue.fY1NDC=x.gStyle.fTitleY-Math.min(1.1*x.gStyle.fTitleFontSize,.06),ue.fX2NDC=x.gStyle.fTitleW>0?x.gStyle.fTitleX+x.gStyle.fTitleW/2:1-x.gStyle.fPadRightMargin,ue.fY2NDC=x.gStyle.fTitleY,ue.fInit=1,this.interactiveRedraw(!0,"pave_moved")}),Y.add("Save to gStyle",()=>{x.gStyle.fTitleX=(ue.fX2NDC+ue.fX1NDC)/2,x.gStyle.fTitleY=ue.fY2NDC,this.fillatt?.saveToStyle("fTitleColor","fTitleStyle"),x.gStyle.fTitleTextColor=ue.fTextColor,x.gStyle.fTitleFontSize=ue.fTextSize,x.gStyle.fTitleFont=ue.fTextFont},"Store title position and graphical attributes to gStyle"));Y.add("Bring to front",()=>this.bringToFront(!this.isStats()&&!this.z_handle))}paveContextMenu(Y){if(this.z_handle){const ue=this.getFramePainter();(0,x.isFunc)(ue?.showContextMenu)&&ue.showContextMenu("pal",Y)}else(0,Ye.sj)(Y,this,this.isTitle()?"title":void 0)}isStats(){return this.matchObjectType(x.clTPaveStats)}isTitle(){return this.matchObjectType(x.clTPaveText)&&"title"===this.getObject()?.fName}clearPave(){this.getObject().Clear()}addText(Y){this.getObject().AddText(Y)}fillFunctionStat(Y,ue,Q=1){if(this._has_fit=!1,!ue||!Y)return!1;this._has_fit=!0,this._fit_dim=Q,this._fit_cnt=0;const me=1===Q?ue%10:1,X=1===Q?Math.floor(ue/10)%10:1,B=1===Q?Math.floor(ue/100)%10:1,$=1===Q?Math.floor(ue/1e3)%10:0;if(B&&(this.addText("#chi^{2} / ndf = "+this.format(Y.fChisquare,"fit")+" / "+Y.fNDF),this._fit_cnt++),$&&(this.addText("Prob = "+this.format((0,ve.Prob)(Y.fChisquare,Y.fNDF))),this._fit_cnt++),me)for(let A=0;A<Y.GetNumPars();++A){const E=Y.GetParName(A);let g=Y.GetParValue(A),v=Y.GetParError(A);g=void 0===g?"<not avail>":this.format(Number(g),"fit"),void 0!==v&&(v=this.format(v,"last"),0===Number(v)&&0!==Y.GetParError(A)&&(v=this.format(Y.GetParError(A),"4.2g"))),this.addText(X&&v?`${E} = ${g} #pm ${v}`:`${E} = ${g}`),this._fit_cnt++}return!0}isDummyPos(Y){return!Y||!(Y.fInit||Y.fX1||Y.fX2||Y.fY1||Y.fY2||Y.fX1NDC||Y.fX2NDC||Y.fY1NDC||Y.fY2NDC)}updateObject(Y,ue){if(!this.matchObjectType(Y))return!1;const Q=this.getObject();switch(!Q.modified_NDC&&!this.isDummyPos(Y)&&(this.stored&&!Y.fInit&&this.stored.fX1===Y.fX1&&this.stored.fX2===Y.fX2&&this.stored.fY1===Y.fY1&&this.stored.fY2===Y.fY2?(this.stored.fX1NDC!==Y.fX1NDC&&(Q.fX1NDC=Y.fX1NDC),this.stored.fX2NDC!==Y.fX2NDC&&(Q.fX2NDC=Y.fX2NDC),this.stored.fY1NDC!==Y.fY1NDC&&(Q.fY1NDC=Y.fY1NDC),this.stored.fY2NDC!==Y.fY2NDC&&(Q.fY2NDC=Y.fY2NDC)):(Q.fInit=Y.fInit,Q.fX1=Y.fX1,Q.fX2=Y.fX2,Q.fY1=Y.fY1,Q.fY2=Y.fY2,Q.fX1NDC=Y.fX1NDC,Q.fX2NDC=Y.fX2NDC,Q.fY1NDC=Y.fY1NDC,Q.fY2NDC=Y.fY2NDC),this.stored=Object.assign({},Y)),Q.fOption=Y.fOption,Q.fBorderSize=Y.fBorderSize,void 0!==Q.fTextColor&&void 0!==Y.fTextColor&&(Q.fTextAngle=Y.fTextAngle,Q.fTextSize=Y.fTextSize,Q.fTextAlign=Y.fTextAlign,Q.fTextColor=Y.fTextColor,Q.fTextFont=Y.fTextFont),Y._typename){case x.clTDiamond:case x.clTPaveText:return Q.fLines=(0,x.clone)(Y.fLines),!0;case x.clTPavesText:return Q.fLines=(0,x.clone)(Y.fLines),Q.fNpaves=Y.fNpaves,!0;case x.clTPaveLabel:case x.clTPaveClass:return Q.fLabel=Y.fLabel,!0;case x.clTPaveStats:return Q.fOptStat=Y.fOptStat,Q.fOptFit=Y.fOptFit,!0;case x.clTLegend:{const me=Q.fPrimitives;if(Q.fPrimitives=Y.fPrimitives,Q.fNColumns=Y.fNColumns,this.AutoPlace="autoplace"===ue,me?.arr?.length&&me?.arr?.length===Q.fPrimitives?.arr?.length)for(let X=0;X<me.arr.length;++X){const B=me.arr[X].fObject,$=Q.fPrimitives.arr[X].fObject;B&&$&&B._typename===$._typename&&B.fName===$.fName&&(Q.fPrimitives.arr[X].fObject=B)}return!0}case x.clTPaletteAxis:return Q.fBorderSize=1,Q.fShadowColor=0,!0}return!1}redraw(){var Y=this;return(0,Ee.A)(function*(){return Y.drawPave()})()}cleanup(){this.z_handle&&(this.z_handle.cleanup(),delete this.z_handle),super.cleanup()}static canDraw(Y){const ue=Y?._typename;return ue===x.clTPave||ue===x.clTPaveLabel||ue===x.clTPaveClass||ue===x.clTPaveStats||ue===x.clTPaveText||ue===x.clTPavesText||ue===x.clTDiamond||ue===x.clTLegend||ue===x.clTPaletteAxis}static draw(Y,ue,Q){return(0,Ee.A)(function*(){const me=new F(Y,ue);return(0,He.ensureTCanvas)(me,!1).then(()=>{if("title"===ue.fName&&ue._typename===x.clTPaveText){const X=me.getPadPainter().findPainterFor(null,"title");if(X&&X!==me)X.removeFromPadPrimitives(),X.cleanup();else if("postitle"===Q||me.isDummyPos(ue)){const B=x.gStyle,$=me.getFramePainter();if(B&&$){const A=B.fTitleX,E=B.fTitleY;let g=B.fTitleW,v=B.fTitleH;v||(v=.7*(E-$.fY2NDC)),g||(g=$.fX2NDC-$.fX1NDC),(!Number.isFinite(v)||v<=0)&&(v=.06),(!Number.isFinite(g)||g<=0)&&(g=.44),ue.fX1NDC=A-g/2,ue.fY1NDC=E-v,ue.fX2NDC=A+g/2,ue.fY2NDC=E,ue.fInit=1}}}else ue._typename===x.clTPaletteAxis&&(ue.fBorderSize=1,ue.fShadowColor=0,ue.fAxis&&(ue.fAxis.fChopt||(ue.fAxis.fChopt="+"),ue.fAxis.fNdiv||(ue.fAxis.fNdiv=12),ue.fAxis.fLabelOffset||(ue.fAxis.fLabelOffset=.005)),me.z_handle=new Ze.TB(Y,ue.fAxis,!0),me.z_handle.setPadName(me.getPadName()),me.UseContextMenu=!0);switch(me.NoFillStats="nofillstats"===Q||"stats"!==ue.fName,ue._typename){case x.clTPaveLabel:case x.clTPaveClass:me.paveDrawFunc=me.drawPaveLabel;break;case x.clTPaveStats:me.paveDrawFunc=me.drawPaveStats;break;case x.clTPaveText:case x.clTPavesText:case x.clTDiamond:me.paveDrawFunc=me.drawPaveText;break;case x.clTLegend:me.AutoPlace="autoplace"===Q,me.paveDrawFunc=me.drawLegend;break;case x.clTPaletteAxis:me.paveDrawFunc=me.drawPaletteAxis}return me.drawPave(Q)})})()}}},8537:(Yr,mt,Se)=>{"use strict";Se.d(mt,{CS:()=>f,QK:()=>He,SF:()=>I,cD:()=>Ve,s6:()=>C,u$:()=>U,wx:()=>v});var Ee=Se(8872),x=Se(8362),L=Se(2923),ve=Se(3847),ke=Se(3147),ot=Se(4615),Ye=Se(9997);function Ze(k,Z,ee){if((0,ke.KA)(Z))return new L._l5((0,ke.xV)(Z),{font:ve.Te,size:ee,height:0,curveSegments:5});const he=100*ee,G=[];let b=5;class P{constructor(lt,bt){this.kind=lt??"g",this.childs=[],this.x=0,this.y=0,this.font_size=bt?.font_size??he,bt?.childs.push(this)}append(lt){return"svg:g"===lt?new P("g",this):"svg:text"===lt?new P("text",this):"svg:path"===lt?new P("path",this):void console.log("should create",lt)}style(lt,bt){return"stroke-width"===lt&&bt&&(b=Number.parseInt(bt)),this}translate(){this.geom&&this.geom.translate(this.x,this.y,0),this.childs.forEach(lt=>{lt.x+=this.x,lt.y+=this.y,lt.translate()})}attr(lt,bt){const te=()=>{if(!bt)return"";const tt=bt[0];return bt=bt.slice(1),tt},Je=tt=>{let Fe=0;for(;bt[Fe]>="0"&&bt[Fe]<="9"||"-"===bt[Fe];)Fe++;const Ne=Number.parseInt(bt.slice(0,Fe));return bt=bt.slice(Fe),tt&&te(),Ne};if("font-size"===lt&&bt)this.font_size=Number.parseInt(bt);else if("transform"===lt&&(0,Ee.isStr)(bt)&&0===bt.indexOf("translate")){const tt=bt.slice(bt.indexOf("(")+1,bt.lastIndexOf(")")).split(",");this.x+=tt[0]?.01*Number.parseInt(tt[0]):0,this.y-=tt[1]?.01*Number.parseInt(tt[1]):0}else if("x"===lt&&"text"===this.kind)this.x+=.01*Number.parseInt(bt);else if("y"===lt&&"text"===this.kind)this.y-=.01*Number.parseInt(bt);else if("d"===lt&&"path"===this.kind){if("M"!==te())return console.error("Not starts with M");const tt=[];let rt,Fe=Je(!0),Ne=Je();for(;rt=te();){let pt=Fe,st=Ne;switch(rt){case"L":pt=Je(!0),st=Je();break;case"l":pt+=Je(!0),st+=Je();break;case"H":pt=Je();break;case"h":pt+=Je();break;case"V":st=Je();break;case"v":st+=Je();break;default:console.log("not supported operator",rt)}const vt=Math.atan2(st-Ne,pt-Fe),Yt=.5*b*Math.sin(vt),qt=-.5*b*Math.cos(vt);tt.push(Fe-Yt,Ne-qt,0,pt-Yt,st-qt,0,pt+Yt,st+qt,0,Fe-Yt,Ne-qt,0,pt+Yt,st+qt,0,Fe+Yt,Ne+qt,0),Fe=pt,Ne=st}const St=new Float32Array(tt);this.geom=new L.LoY,this.geom.setAttribute("position",new L.THS(St,3)),this.geom.scale(.01,-.01,.01),this.geom.computeVertexNormals(),G.push(this.geom)}return this}text(lt){"text"===this.kind&&(this.geom=new L._l5(lt,{font:ve.Te,size:Math.round(.01*this.font_size),height:0,curveSegments:5}),G.push(this.geom))}}const T=new P;if((0,ke.Bm)(k,T,{font_size:he,latex:1,x:0,y:0,text:Z,align:["start","top"],fast:!0,font:{size:he,isMonospace:()=>!1,aver_width:.9}}),!G.length)return new L._l5((0,ke.xV)(Z),{font:ve.Te,size:ee,height:0,curveSegments:5});if(T.translate(),1===G.length)return G[0];let W=0;G.forEach(Ge=>{W+=Ge.getAttribute("position").array.length});const fe=new Float32Array(W),we=new Float32Array(W);let Me=0;G.forEach(Ge=>{const lt=Ge.getAttribute("position").array,bt=Ge.getAttribute("normal").array;for(let te=0;te<lt.length;++te,++Me)fe[Me]=lt[te],we[Me]=bt[te]});const je=new L.LoY;return je.setAttribute("position",new L.THS(fe,3)),je.setAttribute("normal",new L.THS(we,3)),je}function Re(k,Z,ee=!1,he=!1){let G;if(Z?.children)for(let W=0;W<Z.children.length&&(G=Z.children[W],!G.axis_draw);++W)G=void 0;if(!G)return;if(!k)return void Z.remove(G);const b=k.position;let P=1;b.x<0&&b.y>=0&&(P=2),b.x>=0&&b.y>=0&&(P=3),b.x>=0&&b.y<0&&(P=4);const T=(W,fe)=>(W<=P&&(W+=4),W>P&&W<P+fe),z=W=>{for(let fe=0;fe<W.children?.length;++fe)void 0!==W.children[fe].zoom&&(W.children[fe].zoom_disabled=!W.visible)};for(let W=0;W<G.children.length;++W){const fe=G.children[W];if(fe.grid)fe.visible=he&&T(fe.grid,3);else if(fe.zid)fe.visible=T(fe.zid,2),z(fe);else if(fe.xyid)fe.visible=T(fe.xyid,3),z(fe);else if(fe.xyboxid){let we=5,Me=0;he&&!ee?(we=3,Me=-2):ee&&!he?we=3:!ee&&!he&&(we=fe.bottom?3:0),fe.visible=T(fe.xyboxid+Me,we),!fe.visible&&fe.bottom&&he&&(fe.visible=T(fe.xyboxid,3))}else if(fe.zboxid){let we=2,Me=0;ee&&he?we=5:he&&!ee?we=4:!he&&ee&&(Me=-2,we=4),fe.visible=T(fe.zboxid+Me,we)}}}function He(k,Z,ee,he){if(k.options.System===ot.m)return Z;const G=k.getFramePainter();let b=1/G.size_x3d,P=1/G.size_y3d;if(ee&&he&&(b*=ee/(ee-1),P*=he/(he-1)),k.options.System===ot.Ee)for(let T=0;T<Z.length;T+=3){const z=(1-Z[T]*b)*Math.PI,W=.5+.5*Z[T+1]*P;Z[T]=Math.cos(z)*W*G.size_x3d,Z[T+1]=Math.sin(z)*W*G.size_y3d}else if(k.options.System===ot.ef)for(let T=0;T<Z.length;T+=3){const z=(1-Z[T]*b)*Math.PI,W=.5+Z[T+2]/G.size_z3d/4;Z[T]=Math.cos(z)*W*G.size_x3d,Z[T+2]=(1+Math.sin(z)*W)*G.size_z3d}else if(k.options.System===ot.ZE)for(let T=0;T<Z.length;T+=3){const z=(1+Z[T]*b)*Math.PI,W=Z[T+1]*P*Math.PI,fe=.5+Z[T+2]/G.size_z3d/4;Z[T]=fe*Math.cos(W)*Math.cos(z)*G.size_x3d,Z[T+1]=fe*Math.cos(W)*Math.sin(z)*G.size_y3d,Z[T+2]=(1+fe*Math.sin(W))*G.size_z3d}else if(k.options.System===ot.kH)for(let T=0;T<Z.length;T+=3){const z=(1-Z[T]*b)*Math.PI,W=Z[T+1]*P*Math.PI,fe=.5+Z[T+2]/G.size_z3d/4;Z[T]=fe*Math.cos(z)*G.size_x3d,Z[T+1]=fe*Math.sin(W)/Math.cos(W)*G.size_y3d/2,Z[T+2]=(1+fe*Math.sin(z))*G.size_z3d}return Z}function Ve(k,Z,ee,he,G){const b=new L.LoY;return k.options.System===ot.m?(b.setAttribute("position",new L.THS(Z,3)),ee?b.setAttribute("normal",new L.THS(ee,3)):b.computeVertexNormals()):(He(k,Z,he,G),b.setAttribute("position",new L.THS(Z,3)),b.computeVertexNormals()),b}function De(k,Z){k.camera&&(k.scene.remove(k.camera),(0,ve.G1)(k.camera),delete k.camera),k.camera=Z?new L.qUd(-1.3*k.size_x3d,1.3*k.size_x3d,2.3*k.size_z3d,-.7*k.size_z3d,.001,40*k.size_z3d):new L.ubm(45,k.scene_width/k.scene_height,1,40*k.size_z3d),k.camera.up.set(0,0,1),k.pointLight=new L.ZyN(16777215,3),k.pointLight.position.set(k.size_x3d/2,k.size_y3d/2,k.size_z3d/2),k.camera.add(k.pointLight),k.lookat=new L.Pq0(0,0,Z?.3*k.size_z3d:.8*k.size_z3d),k.scene.add(k.camera)}function F(k,Z){const ee=k.getPadPainter().getRootPad(!0),he=k.camera.isOrthographicCamera?1:1.4;let G=Math.max(.75*k.size_x3d,k.size_z3d),b=Math.max(.75*k.size_y3d,k.size_z3d);if(Z&&(G===b?k.camera.position.set(-1.6*G,-3.5*b,he*k.size_z3d):G>b?k.camera.position.set(-2*G,-3.5*b,he*k.size_z3d):k.camera.position.set(-3.5*G,-2*b,he*k.size_z3d)),ee&&(Z||!k.zoomChangedInteractive())&&Number.isFinite(ee.fTheta)&&Number.isFinite(ee.fPhi)&&(ee.fTheta!==k.camera_Theta||ee.fPhi!==k.camera_Phi)){k.camera_Phi=ee.fPhi,k.camera_Theta=ee.fTheta,G=3*Math.max(k.size_x3d,k.size_z3d),b=3*Math.max(k.size_y3d,k.size_z3d);const P=(270-ee.fPhi)/180*Math.PI,T=(ee.fTheta-10)/180*Math.PI;k.camera.position.set(G*Math.cos(P)*Math.cos(T),b*Math.sin(P)*Math.cos(T),k.size_z3d+(he-.9)*(G+b)*Math.sin(T)),Z=!0}if(Z&&k.camera.lookAt(k.lookat),Z&&k.camera.isOrthographicCamera&&k.scene_width&&k.scene_height){const P=k.scene_width/k.scene_height,T=k.camera.right-k.camera.left,z=k.camera.top-k.camera.bottom;if(P>T/z){const W=(k.camera.right+k.camera.left)/2;k.camera.left=W-z*P/2,k.camera.right=W+z*P/2}else{const W=(k.camera.top+k.camera.bottom)/2;k.camera.top=W+T/P/2,k.camera.bottom=W-T/P/2}}k.camera.updateProjectionMatrix()}function J(k){k.control=(0,ve.Sc)(k,k.camera,k.scene,k.renderer,k.lookat);const Z=k,ee=k.getMainPainter();k.control.processMouseMove=function(he){let G=null,b=null,P=null;const T=Z.isTooltipAllowed();for(let z=0;z<he.length;++z)if(T&&(0,Ee.isFunc)(he[z].object?.tooltip)){if(G=he[z].object.tooltip(he[z]),G){b=he[z].object;break}}else he[z].object?.zoom&&!P&&(P=he[z].object);if(G&&!G.use_itself){const z=1e-4*Z.size_x3d,W=1e-4*Z.size_y3d,fe=1e-4*Z.size_z3d;(G.x1>G.x2||G.y1>G.y2||G.z1>G.z2)&&console.warn("check 3D hints coordinates"),G.x1-=z,G.x2+=z,G.y1-=W,G.y2+=W,G.z1-=fe,G.z2+=fe}if(Z.highlightBin3D(G,b),!G&&P&&(0,Ee.isFunc)(Z.get3dZoomCoord)){let z=P.zoom;const W=P.globalIntersect(this.raycaster),fe=Z.get3dZoomCoord(W,z);return"z"===z&&P.use_y_for_z&&(z="y"),{name:z,title:"axis object",line:z+" : "+Z.axisAsText(z,fe),only_status:!0}}return G?.lines?G:""},k.control.processMouseLeave=function(){Z.highlightBin3D(null)},k.control.contextMenu=function(he,G){let b="painter",P=ee;if(G)for(let z=0;z<G.length;++z){const W=G[z].object;if(W.zoom){b=W.zoom,P=null;break}if((0,Ee.isFunc)(W.painter?.fillContextMenu)){P=W.painter;break}}const T=ee.getFramePainter();(0,Ee.isFunc)(T?.showContextMenu)&&T.showContextMenu(b,he,P)}}function Y(k,Z,ee,he){if(-1===k){if(!this.mode3d)return;return(0,Ee.isFunc)(this.clear3dCanvas)?(Re(null,this.toplevel),this.clear3dCanvas(),(0,ve.G1)(this.scene),this.control?.cleanup(),(0,ve.yW)(this.renderer),delete this.size_x3d,delete this.size_y3d,delete this.size_z3d,delete this.tooltip_mesh,delete this.scene,delete this.toplevel,delete this.camera,delete this.pointLight,delete this.renderer,delete this.control,this.render_tmout&&(clearTimeout(this.render_tmout),delete this.render_tmout),void(this.mode3d=!1)):void console.error(`Strange, why mode3d=${this.mode3d} is configured!!!!`)}if(this.mode3d=!0,"toplevel"in this){this.scene.remove(this.toplevel),(0,ve.G1)(this.toplevel),delete this.tooltip_mesh,delete this.toplevel,this.control&&this.control.HideTooltip();const b=new L.B69;return this.scene.add(b),this.toplevel=b,this.resize3D(),F(this,!1),Promise.resolve(!0)}k=(0,ve.ke)(k,this.isBatchMode()),(0,ve.LR)(this);const G=this.getSizeFor3d(void 0,k);return this.size_z3d=100,this.size_x3d=this.size_y3d=G.height>10&&G.width>10?Math.round(G.width/G.height*this.size_z3d):this.size_z3d,Z&&(this.size_x3d*=Z),ee&&(this.size_y3d*=ee),this.scene=new L.Z58,this.toplevel=new L.B69,this.scene.add(this.toplevel),this.scene_width=G.width,this.scene_height=G.height,this.scene_x=G.x??0,this.scene_y=G.y??0,this.camera_Phi=30,this.camera_Theta=30,De(this,he),F(this,!0),(0,ve.Yw)(this.scene_width,this.scene_height,k).then(b=>(this.renderer=b,this.webgl=k===Ee.constants.Render3D.WebGL,this.add3dCanvas(G,this.renderer.jsroot_dom,this.webgl),this.first_render_tm=0,this.enable_highlight=!1,!this.isBatchMode()&&this.webgl&&J(this),this))}function ue(k){let Z=!1;this.control&&(this.control.cleanup(),delete this.control,Z=!0),De(this,k),F(this,!0),Z&&J(this),this.render3D()}function Q(k,Z,ee){if(k){if(!this.toplevel)return console.error("3D objects are not yet created in the frame");Z&&ee&&this.remove3DMeshes(Z),this.toplevel.add(k),k._painter=Z}}function me(k){if(!k||!this.toplevel)return;let Z=this.toplevel.children.length;for(;Z>0;){const ee=this.toplevel.children[--Z];ee._painter===k&&(this.toplevel.remove(ee),(0,ve.G1)(ee))}}function X(k){if(-1111===k){const G=(0,Ee.getDocument)(),b=(0,ve.mZ)(!1,0,G);if(b.setSize(this.scene_width,this.scene_height),b.render(this.scene,this.camera),b.makeOuterHTML){const P=G.createElement("div");return P.innerHTML=b.makeOuterHTML(),P.childNodes[0]}return b.domElement}void 0===k&&(k=5);const Z=this.isBatchMode();if(k>0&&!this.usesvg&&!Z)return void(this.render_tmout||(this.render_tmout=setTimeout(()=>this.render3D(0),k)));if(this.render_tmout&&(clearTimeout(this.render_tmout),delete this.render_tmout),!this.renderer)return;(0,ve.rv)(this.renderer);const ee=new Date;Re(this.camera,this.toplevel,this.opt3d?.FrontBox,this.opt3d?.BackBox),this.renderer.render(this.scene,this.camera),(0,ve.oE)(this.renderer),0===this.first_render_tm&&(this.first_render_tm=(new Date).getTime()-ee.getTime(),this.enable_highlight=this.first_render_tm<1200&&this.isTooltipAllowed(),this.first_render_tm>500&&console.log(`three.js r${L.sPf}, first render tm = ${this.first_render_tm}`)),this.processRender3D&&this.getPadPainter()?.painters?.forEach(G=>{(0,Ee.isFunc)(G.handleRender3D)&&G.handleRender3D()})}function B(){const k=this.getSizeFor3d(this.access3dKind());return this.apply3dSize(k),!(this.scene_width===k.width&&this.scene_height===k.height||k.width<10||k.height<10||(this.scene_width=k.width,this.scene_height=k.height,this.camera.aspect=this.scene_width/this.scene_height,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.scene_width,this.scene_height),0))}function $(k,Z){const ee=!k||void 0===k.x1||!this.enable_highlight;let he=!1,G=null,b=!0,P=this.getMainPainter();if(P&&(!P.provideUserTooltip||!P.hasUserTooltip())&&(P=null),this.tooltip_selfmesh&&(b=this.tooltip_selfmesh!==Z,this.tooltip_selfmesh.material.color=this.tooltip_selfmesh.save_color,delete this.tooltip_selfmesh,he=!0),this.tooltip_mesh&&(G=this.tooltip_mesh,this.toplevel.remove(this.tooltip_mesh),delete this.tooltip_mesh,he=!0),ee)return he&&this.render3D(),void(he&&P&&P.provideUserTooltip(null));if(k.use_itself)Z.save_color=Z.material.color,Z.material.color=new L.Q1f(k.color),this.tooltip_selfmesh=Z,he=b;else{he=!0;const T=ve.DJ.Indexes,z=ve.DJ.Normals,W=ve.DJ.Vertices,fe=new L.Q1f(k.color?k.color:16711680),we=k.opacity||1;let Me,je;if(G)Me=G.geometry.attributes.position.array,G.geometry.attributes.position.needsUpdate=!0,G.material.color=fe,G.material.opacity=we;else{Me=new Float32Array(3*T.length),je=new Float32Array(3*T.length);const Ge=new L.LoY;Ge.setAttribute("position",new L.THS(Me,3)),Ge.setAttribute("normal",new L.THS(je,3));const lt=new L.V9B({color:fe,opacity:we,vertexColors:!1});G=new L.eaF(Ge,lt)}k.x1===k.x2&&console.warn(`same tip X ${k.x1} ${k.x2}`),k.y1===k.y2&&console.warn(`same tip Y ${k.y1} ${k.y2}`),k.z1===k.z2&&(k.z2=k.z1+1e-4);for(let Ge=0,lt=-3;Ge<T.length;++Ge){const bt=W[T[Ge]];Me[3*Ge]=k.x1+bt.x*(k.x2-k.x1),Me[3*Ge+1]=k.y1+bt.y*(k.y2-k.y1),Me[3*Ge+2]=k.z1+bt.z*(k.z2-k.z1),je&&(Ge%6==0&&(lt+=3),je[3*Ge]=z[lt],je[3*Ge+1]=z[lt+1],je[3*Ge+2]=z[lt+2])}this.tooltip_mesh=G,this.toplevel.add(G),k.$painter&&k.$painter.options.System!==ot.m&&(He(k.$painter,Me),G.geometry.computeVertexNormals())}he&&this.render3D(),he&&k.$projection&&(0,Ee.isFunc)(k.$painter?.redrawProjection)&&k.$painter.redrawProjection(k.ix-1,k.ix,k.iy-1,k.iy),he&&P?.getObject()&&P.provideUserTooltip({obj:P.getObject(),name:P.getObject().fName,bin:k.bin,cont:k.value,binx:k.ix,biny:k.iy,binz:k.iz,grx:(k.x1+k.x2)/2,gry:(k.y1+k.y2)/2,grz:(k.z1+k.z2)/2})}function A(k){this.opt3d=k}function E(k,Z,ee){ee||(ee={}),!1===ee.drawany?ee.draw=!1:ee.drawany=!0;const he=ee.v7?null:this.getPadPainter().getRootPad(!0);let G=-this.size_x3d,b=this.size_x3d,P=-this.size_y3d,T=this.size_y3d,z=0,W=2*this.size_z3d,fe=this.size_z3d,we=this.xmin,Me=this.xmax,je=this.ymin,Ge=this.ymax,lt=this.zmin,bt=this.zmax,te=!1,Je=!1;this.size_z3d||(G=this.xmin,b=this.xmax,P=this.ymin,T=this.ymax,z=this.zmin,W=this.zmax,fe=W-z),"zoom_xmin"in this&&"zoom_xmax"in this&&this.zoom_xmin!==this.zoom_xmax&&(we=this.zoom_xmin,Me=this.zoom_xmax),"zoom_ymin"in this&&"zoom_ymax"in this&&this.zoom_ymin!==this.zoom_ymax&&(je=this.zoom_ymin,Ge=this.zoom_ymax,te=!0),"zoom_zmin"in this&&"zoom_zmax"in this&&this.zoom_zmin!==this.zoom_zmax&&(lt=this.zoom_zmin,bt=this.zoom_zmax,Je=!0),ee.use_y_for_z&&(this.zmin=this.ymin,this.zmax=this.ymax,lt=je,bt=Ge,Je=te,je=0,Ge=1),this.lego_zmin=lt,this.lego_zmax=bt,void 0!==ee.zmult&&!Je&&(bt*=ee.zmult),this.x_handle=new Z(null,this.xaxis),ee.v7&&(this.x_handle.setPadName(this.getPadName()),this.x_handle.snapid=this.snapid),this.x_handle.configureAxis("xaxis",this.xmin,this.xmax,we,Me,!1,[G,b],{log:he?.fLogx??0,reverse:ee.reverse_x}),this.x_handle.assignFrameMembers(this,"x"),this.x_handle.extractDrawAttributes(fe),this.y_handle=new Z(null,this.yaxis),ee.v7&&(this.y_handle.setPadName(this.getPadName()),this.y_handle.snapid=this.snapid),this.y_handle.configureAxis("yaxis",this.ymin,this.ymax,je,Ge,!1,[P,T],{log:he&&!ee.use_y_for_z?he.fLogy:0,reverse:ee.reverse_y}),this.y_handle.assignFrameMembers(this,"y"),this.y_handle.extractDrawAttributes(fe),this.z_handle=new Z(null,this.zaxis),ee.v7&&(this.z_handle.setPadName(this.getPadName()),this.z_handle.snapid=this.snapid),this.z_handle.configureAxis("zaxis",this.zmin,this.zmax,lt,bt,!1,[z,W],{log:(ee.use_y_for_z||2===ee.ndim?he?.fLogv:void 0)??he?.fLogz??0,reverse:ee.reverse_z}),this.z_handle.assignFrameMembers(this,"z"),this.z_handle.extractDrawAttributes(fe),this.setRootPadRange(he,!0);const tt={},Fe={},Ne=this.x_handle.createTicks(!1,!0),rt=this.y_handle.createTicks(!1,!0),St=this.z_handle.createTicks(!1,!0);let pt=1;function st(xt,K){const ge=("ticks"===K?xt.ticksColor:xt.lineatt.color)||"black",ye="ticks"===K?xt.ticksWidth:xt.lineatt.width,Pe=`${ge}_${ye}`;return Fe[Pe]||(Fe[Pe]=new L.mrM((0,ve.Bx)(ge,{linewidth:ye,vertexColors:!1}))),Fe[Pe]}function vt(xt,K,ge){const ye=ge||("title"===K?xt.titleFont?.color:xt.labelsFont?.color)||"black";return tt[ye]||(tt[ye]=new L.V9B((0,ve.Bx)(ye,{vertexColors:!1}))),tt[ye]}const Yt=new L.B69;Yt.axis_draw=!0,k.add(Yt);let qt=[],Ot=[],Bn=0;for(;Ne.next();){const xt=Ne.grpos;let K=1===Ne.kind,ge=this.x_handle.format(Ne.tick,2);if(Ne.last_major()?this.x_handle.fTitle||(ge="x"):null===ge&&(K=!1,ge=""),K&&ge&&ee.draw){const ye=Ne.get_modifier();ye?.fLabText&&(ge=ye.fLabText);const Pe=Ze(this,ge,this.x_handle.labelsFont.size);Pe.computeBoundingBox();const At=Pe.boundingBox.max.x-Pe.boundingBox.min.x,Vt=Pe.boundingBox.max.y-Pe.boundingBox.min.y;Pe.center=!0,Pe.offsety=this.x_handle.labelsOffset+.005*(T-P),Bn=Math.max(Bn,Vt),ye?.fTextColor&&(Pe.color=this.getColor(ye.fTextColor)),Pe.grx=xt,Ot.push(Pe);let Nt=0;Ne.last_major()||(Nt=Math.abs(Ne.next_major_grpos()-xt),At>0&&Nt>0&&(pt=Math.min(pt,.9*Nt/At))),this.x_handle.isCenteredLabels()&&(Nt||(Nt=Math.min(xt-G,b-xt)),Pe.grx+=Nt/2)}qt.push(xt,0,0,xt,this.x_handle.ticksSize*(K?-1:-.6),0)}if(this.x_handle.fTitle&&ee.draw){const xt=Ze(this,this.x_handle.fTitle,this.x_handle.titleFont.size);xt.computeBoundingBox(),xt.center=this.x_handle.titleCenter,xt.opposite=this.x_handle.titleOpposite,xt.offsety=1.6*this.x_handle.titleOffset+.005*(T-P),xt.grx=(G+b)/2,xt.kind="title",Ot.push(xt)}this.get3dZoomCoord=function(xt,K){const ge=this[`scale_${K}min`],ye=this[`scale_${K}max`];let Pe=xt[K];switch(K){case"x":Pe=(Pe+this.size_x3d)/2/this.size_x3d;break;case"y":Pe=(Pe+this.size_y3d)/2/this.size_y3d;break;case"z":Pe=Pe/2/this.size_z3d}return Pe=this["log"+K]?Math.exp(Math.log(ge)+Pe*(Math.log(ye)-Math.log(ge))):ge+Pe*(ye-ge),Pe};const Mn=(xt,K,ge)=>{const ye=new L.LoY,Pe=Math.max(this[xt+"_handle"].ticksSize,.005*K);let At;At="z"===xt?new Float32Array([0,0,0,4*Pe,0,2*K,4*Pe,0,0,0,0,0,0,0,2*K,4*Pe,0,2*K]):new Float32Array([-K,0,0,K,4*-Pe,0,K,0,0,-K,0,0,-K,4*-Pe,0,K,4*-Pe,0]),ye.setAttribute("position",new L.THS(At,3)),ye.computeVertexNormals();const Vt=new L.V9B({transparent:!0,vertexColors:!1,side:L.$EB,opacity:0}),Nt=new L.eaF(ye,Vt);return Nt.zoom=xt,Nt.size_3d=K,Nt.tsz=Pe,Nt.use_y_for_z=ge,"y"===xt&&Nt.rotateZ(Math.PI/2).rotateX(Math.PI),Nt.v1=new L.Pq0(At[0],At[1],At[2]),Nt.v2=new L.Pq0(At[6],At[7],At[8]),Nt.v3=new L.Pq0(At[3],At[4],At[5]),Nt.globalIntersect=function(nn){if(!this.v1||!this.v2||!this.v3)return;const hn=new L.Zcv;hn.setFromCoplanarPoints(this.v1,this.v2,this.v3),hn.applyMatrix4(this.matrixWorld);const kn=nn.ray.origin.clone(),dn=kn.clone().addScaledVector(nn.ray.direction,1e10),In=hn.intersectLine(new L.cZY(kn,dn),new L.Pq0);if(!In)return;let ci=-this.size_3d,Pi=this.size_3d;return"z"===this.zoom&&(ci=0,Pi=2*this.size_3d),In[this.zoom]<ci?In[this.zoom]=ci:In[this.zoom]>Pi&&(In[this.zoom]=Pi),In},Nt.showSelection=function(nn,hn){const kn=this.zoom;let In,dn=this.children?this.children[0]:null;if(!nn||!hn)return dn&&(this.remove(dn),(0,ve.G1)(dn)),dn;if(!this.geometry)return!1;if(dn)In=dn.geometry;else{In=this.geometry.clone();const Pi=In.getAttribute("position").array;"z"===kn?Pi[6]=Pi[3]=Pi[15]=this.tsz:Pi[4]=Pi[16]=Pi[13]=-this.tsz,dn=new L.eaF(In,new L.V9B({color:65280,side:L.$EB,vertexColors:!1})),this.add(dn)}const ci=In.getAttribute("position").array;return"z"===kn?(ci[2]=ci[11]=ci[8]=nn[kn],ci[5]=ci[17]=ci[14]=hn[kn]):(ci[0]=ci[9]=ci[12]=nn[kn],ci[6]=ci[3]=ci[15]=hn[kn]),In.getAttribute("position").needsUpdate=!0,!0},Nt};let Dn,bn=new L.B69;for(bn.position.set(0,P,z),bn.rotation.x=1/4*Math.PI,bn.xyid=2,ee.draw&&(Dn=(0,ve.Fc)(qt,st(this.x_handle,"ticks")),bn.add(Dn)),Ot.forEach(xt=>{const K=xt.boundingBox.max.x-xt.boundingBox.min.x,ge=xt.center?xt.grx-K/2:xt.opposite?G:b-K,ye=new L.kn4;ye.set(pt,0,0,ge,0,pt,0,-Bn*pt-this.x_handle.ticksSize-xt.offsety,0,0,1,0,0,0,0,1);const Pe=new L.eaF(xt,vt(this.x_handle,xt.kind,xt.color));Pe.applyMatrix4(ye),bn.add(Pe)}),ee.zoom&&ee.drawany&&bn.add(Mn("x",this.size_x3d)),Yt.add(bn),bn=new L.B69,bn.position.set(0,T,z),bn.rotation.x=3/4*Math.PI,ee.draw&&bn.add(new L.DXC(Dn.geometry,Dn.material)),Ot.forEach(xt=>{const K=xt.boundingBox.max.x-xt.boundingBox.min.x,ge=xt.center?xt.grx+K/2:xt.opposite?G+K:b,ye=new L.kn4;ye.set(-pt,0,0,ge,0,pt,0,-Bn*pt-this.x_handle.ticksSize-xt.offsety,0,0,-1,0,0,0,0,1);const Pe=new L.eaF(xt,vt(this.x_handle,xt.kind,xt.color));Pe.applyMatrix4(ye),bn.add(Pe)}),bn.xyid=4,ee.zoom&&ee.drawany&&bn.add(Mn("x",this.size_x3d)),Yt.add(bn),Ot=[],pt=1,Bn=0,qt=[];rt.next();){const xt=rt.grpos;let K=1===rt.kind,ge=this.y_handle.format(rt.tick,2);if(rt.last_major()?this.y_handle.fTitle||(ge="y"):null===ge&&(K=!1,ge=""),K&&ge&&ee.draw){const ye=rt.get_modifier();ye?.fLabText&&(ge=ye.fLabText);const Pe=Ze(this,ge,this.y_handle.labelsFont.size);Pe.computeBoundingBox();const At=Pe.boundingBox.max.x-Pe.boundingBox.min.x,Vt=Pe.boundingBox.max.y-Pe.boundingBox.min.y;Pe.center=!0,Bn=Math.max(Bn,Vt),ye?.fTextColor&&(Pe.color=this.getColor(ye.fTextColor)),Pe.gry=xt,Pe.offsetx=this.y_handle.labelsOffset+.005*(b-G),Ot.push(Pe);let Nt=0;rt.last_major()||(Nt=Math.abs(rt.next_major_grpos()-xt),At>0&&(pt=Math.min(pt,.9*Nt/At))),this.y_handle.isCenteredLabels()&&(Nt||(Nt=Math.min(xt-P,T-xt)),Pe.gry+=Nt/2)}qt.push(0,xt,0,this.y_handle.ticksSize*(K?-1:-.6),xt,0)}if(this.y_handle.fTitle&&ee.draw){const xt=Ze(this,this.y_handle.fTitle,this.y_handle.titleFont.size);xt.computeBoundingBox(),xt.center=this.y_handle.titleCenter,xt.opposite=this.y_handle.titleOpposite,xt.offsetx=1.6*this.y_handle.titleOffset+.005*(b-G),xt.gry=(P+T)/2,xt.kind="title",Ot.push(xt)}if(!ee.use_y_for_z){let xt,K=new L.B69;K.position.set(G,0,z),K.rotation.y=-1/4*Math.PI,ee.draw&&(xt=(0,ve.Fc)(qt,st(this.y_handle,"ticks")),K.add(xt)),Ot.forEach(ge=>{const ye=ge.boundingBox.max.x-ge.boundingBox.min.x,Pe=ge.center?ge.gry+ye/2:ge.opposite?P+ye:T,At=new L.kn4;At.set(0,pt,0,-Bn*pt-this.y_handle.ticksSize-ge.offsetx,-pt,0,0,Pe,0,0,1,0,0,0,0,1);const Vt=new L.eaF(ge,vt(this.y_handle,ge.kind,ge.color));Vt.applyMatrix4(At),K.add(Vt)}),K.xyid=3,ee.zoom&&ee.drawany&&K.add(Mn("y",this.size_y3d)),Yt.add(K),K=new L.B69,K.position.set(b,0,z),K.rotation.y=-3/4*Math.PI,ee.draw&&K.add(new L.DXC(xt.geometry,xt.material)),Ot.forEach(ge=>{const ye=ge.boundingBox.max.x-ge.boundingBox.min.x,Pe=ge.center?ge.gry-ye/2:ge.opposite?P:T-ye,At=new L.kn4;At.set(0,pt,0,-Bn*pt-this.y_handle.ticksSize-ge.offsetx,pt,0,0,Pe,0,0,-1,0,0,0,0,1);const Vt=new L.eaF(ge,vt(this.y_handle,ge.kind,ge.color));Vt.applyMatrix4(At),K.add(Vt)}),K.xyid=1,ee.zoom&&ee.drawany&&K.add(Mn("y",this.size_y3d)),Yt.add(K)}Ot=[],pt=1,qt=[];let $n=null,Cn=null,yn=null,Sn=0;for(this.size_z3d&&ee.drawany&&($n=[],Cn=[]);St.next();){const xt=St.grpos;let K=1===St.kind,ge=this.z_handle.format(St.tick,2);if(null===ge&&(K=!1,ge=""),K&&ge&&ee.draw){const ye=St.get_modifier();ye?.fLabText&&(ge=ye.fLabText);const Pe=Ze(this,ge,this.z_handle.labelsFont.size);Pe.computeBoundingBox();const At=Pe.boundingBox.max.x-Pe.boundingBox.min.x,Vt=Pe.boundingBox.max.y-Pe.boundingBox.min.y;Pe.translate(-At,-Vt/2,0),ye?.fTextColor&&(Pe.color=this.getColor(ye.fTextColor)),Pe.grz=xt,Ot.push(Pe),null!==yn&&Vt>0&&(pt=Math.min(pt,.9*(xt-yn)/Vt)),Sn=Math.max(Sn,At),yn=xt}$n&&K&&$n.push(G,0,xt,b,0,xt),Cn&&K&&Cn.push(0,P,xt,0,T,xt),qt.push(0,0,xt,this.z_handle.ticksSize*(K?1:.6),0,xt)}if($n&&$n.length>0){const xt=new L.Fvt({color:this.x_handle.ticksColor,dashSize:2,gapSize:2}),K=(0,ve.Fc)($n,xt);K.position.set(0,T,0),K.grid=2,K.visible=!1,Yt.add(K);const ge=new L.DXC(K.geometry,xt);ge.position.set(0,P,0),ge.grid=4,ge.visible=!1,Yt.add(ge)}if(Cn&&Cn.length>0){const xt=new L.Fvt({color:this.y_handle.ticksColor,dashSize:2,gapSize:2}),K=(0,ve.Fc)(Cn,xt);K.position.set(b,0,0),K.grid=3,K.visible=!1,Yt.add(K);const ge=new L.DXC(K.geometry,xt);ge.position.set(G,0,0),ge.grid=1,ge.visible=!1,Yt.add(ge)}const ii=[],ai=ee.draw?(0,ve.Fc)(qt,st(this.z_handle,"ticks")):null;for(let xt=0;xt<4;++xt){if(ii.push(new L.B69),Ot.forEach((K,ge)=>{const ye=new L.kn4;let Pe=K.grz;this.z_handle.isCenteredLabels()&&(ge<Ot.length-1?Pe=(Pe+Ot[ge+1].grz)/2:ge>0&&(Pe=Math.min(1.5*Pe-.5*Ot[ge-1].grz,W))),ye.set(-pt,0,0,this.z_handle.ticksSize+.005*(b-G)+this.z_handle.labelsOffset,0,0,1,0,0,pt,0,Pe);const At=new L.eaF(K,vt(this.z_handle));At.applyMatrix4(ye),ii[xt].add(At)}),this.z_handle.fTitle&&ee.draw){const K=Ze(this,this.z_handle.fTitle,this.z_handle.titleFont.size);K.computeBoundingBox();const ge=K.boundingBox.max.x-K.boundingBox.min.x,ye=this.z_handle.titleCenter?(W+z-ge)/2:this.z_handle.titleOpposite?z:W-ge;K.rotateZ(Math.PI/2);const Pe=new L.kn4;Pe.set(-pt,0,0,this.z_handle.ticksSize+.005*(b-G)+Sn+this.z_handle.titleOffset,0,0,1,0,0,pt,0,ye);const At=new L.eaF(K,vt(this.z_handle,"title"));At.applyMatrix4(Pe),ii[xt].add(At)}ee.draw&&ai&&ii[xt].add(0===xt?ai:new L.DXC(ai.geometry,ai.material)),ee.zoom&&ee.drawany&&ii[xt].add(Mn("z",this.size_z3d,ee.use_y_for_z)),ii[xt].zid=xt+2,Yt.add(ii[xt])}if(ii[0].position.set(G,T,0),ii[0].rotation.z=3/4*Math.PI,ii[1].position.set(b,T,0),ii[1].rotation.z=1/4*Math.PI,ii[2].position.set(b,P,0),ii[2].rotation.z=-1/4*Math.PI,ii[3].position.set(G,P,0),ii[3].rotation.z=-3/4*Math.PI,!ee.drawany)return;const Hi=st(this.x_handle),ti=(0,ve.Fc)([G,0,0,b,0,0],Hi,null,!0);for(let xt=0;xt<2;++xt){let K=new L.DXC(ti,Hi);K.position.set(0,P,0===xt?z:W),K.xyboxid=2,K.bottom=0===xt,Yt.add(K),K=new L.DXC(ti,Hi),K.position.set(0,T,0===xt?z:W),K.xyboxid=4,K.bottom=0===xt,Yt.add(K)}const Nr=st(this.y_handle),ss=(0,ve.Fc)([0,P,0,0,T,0],Nr,null,!0);for(let xt=0;xt<2;++xt){let K=new L.DXC(ss,Nr);K.position.set(G,0,0===xt?z:W),K.xyboxid=3,K.bottom=0===xt,Yt.add(K),K=new L.DXC(ss,Nr),K.position.set(b,0,0===xt?z:W),K.xyboxid=1,K.bottom=0===xt,Yt.add(K)}const Bs=st(this.z_handle),yo=(0,ve.Fc)([0,0,z,0,0,W],Bs,null,!0);for(let xt=0;xt<4;++xt){const K=new L.DXC(yo,Bs);K.zboxid=ii[xt].zid,K.position.copy(ii[xt].position),Yt.add(K)}}function g(k,Z,ee){k=this.x_handle.gr(k),Z=this.y_handle.gr(Z),ee=this.z_handle.gr(ee);const he=(new L.Pq0).set(k,Z,ee);he.project(this.camera),he.x=(he.x+1)/2,he.y=(he.y+1)/2;const G=this.getPadPainter(),b=G?.getPadWidth(),P=G?.getPadHeight();return b&&P&&(he.x=(this.scene_x+he.x*this.scene_width)/b,he.y=(this.scene_y+he.y*this.scene_height)/P),he}function v(k){Object.assign(k,{create3DScene:Y,add3DMesh:Q,remove3DMeshes:me,render3D:X,resize3D:B,change3DCamera:ue,highlightBin3D:$,set3DOptions:A,drawXYZ:E,convert3DtoPadNDC:g})}function f(k,Z=!1){if(!k.draw_content)return;const ee=ve.DJ.Vertices,he=ve.DJ.Indexes,G=ve.DJ.Normals,b=ve.DJ.Segments,P=[0,1,1,2,2,3,3,0],T=[new L.Pq0(0,0,0),new L.Pq0(0,1,0),new L.Pq0(1,1,0),new L.Pq0(1,0,0)],z=k.getFramePainter(),W=k.prepareDraw({rounding:!1,use3d:!0,extra:1}),fe=k.options.cutg,we=W.i1,Me=W.i2,je=W.j1,Ge=W.j2,lt=k.getHisto(),bt=lt.$baseh,te=11===k.options.Lego||13===k.options.Lego,Je=lt.getBin(Me,Ge)<65535;if(we>=Me||je>=Ge)return;let tt,Fe,Ne,rt,St,pt,st,vt,Yt,qt,Ot,Bn,Mn,bn,Dn,$n=z.z_handle.getScaleMin(),Cn=z.z_handle.getScaleMax();const yn=(Nt,nn,hn)=>(Bn=lt.getBinContent(Nt+1,nn+1),Ot=bt?bt.getBinContent(Nt+1,nn+1):!1!==k.options.BaseLine?k.options.BaseLine:k.options.Zero?$n:0,Bn<Ot&&([Ot,Bn]=[Bn,Ot]),!(Ot>=Fe||Bn<tt||fe&&!fe.IsInside(lt.fXaxis.GetBinCoord(Nt+.5),lt.fYaxis.GetBinCoord(nn+.5)))&&(Mn=Bn===tt||Ot>=Bn,!Mn||hn>0||!bt&&(!!(k.options.Zero||$n>0)||k._show_empty_bins)));let Sn=[$n,Cn],ii=null;(12===k.options.Lego||14===k.options.Lego)&&(Z?(ii=z.getHistPalette(),k.createContour(z,ii,{full_z_range:!0}),Sn=ii.getContour(),$n=Sn[0],Cn=Sn[Sn.length-1]):(Sn=k.createContour(lt.fContour?lt.fContour.length:20,z.lego_zmin,z.lego_zmax).arr,ii=k.getHistPalette()));for(let Nt=0;Nt<Sn.length-1;++Nt){tt=Sn[Nt],Fe=Sn[Nt+1],ii&&Nt===Sn.length-2&&Fe<Cn&&(Fe=Cn);const nn=z.grz(tt),hn=z.grz(Fe);let kn=0,dn=0,In=0,ci=0;for(Ne=we;Ne<Me;++Ne)for(rt=je;rt<Ge;++rt)yn(Ne,rt,Nt)&&(bn=!Mn&&Nt>0,Dn=!Mn&&Bn>Fe&&Nt<Sn.length-2,In+=Mn?12:he.length,bn&&(In-=6),Dn&&(In-=6),te&&!Mn&&(In-=12,ci+=12));const Pi=new Float32Array(3*In),Si=new Float32Array(3*In),bi=Je?new Uint16Array(In/3):new Uint32Array(In/3),Jn=0===ci?null:new Float32Array(3*ci),Wi=0===ci?null:new Float32Array(3*ci),Ln=0===ci?null:Je?new Uint16Array(ci/3):new Uint32Array(ci/3);let D,O,ie,Rs=0,oe=0;for(Ne=we;Ne<Me;++Ne)for(st=W.grx[Ne]+W.xbar1*(W.grx[Ne+1]-W.grx[Ne]),vt=W.grx[Ne]+W.xbar2*(W.grx[Ne+1]-W.grx[Ne]),rt=je;rt<Ge;++rt){if(!yn(Ne,rt,Nt))continue;bn=!Mn&&Nt>0,Dn=!Mn&&Bn>Fe&&Nt<Sn.length-2,Yt=W.gry[rt]+W.ybar1*(W.gry[rt+1]-W.gry[rt]),qt=W.gry[rt]+W.ybar2*(W.gry[rt+1]-W.gry[rt]),kn=Ot<=tt?nn:z.grz(Ot),dn=Bn>Fe?hn:z.grz(Bn),ie=0,O=0,Mn&&(ie+=12,O+=24);const yt=lt.getBin(Ne+1,rt+1);let sn=he.length;for(bn&&(sn-=6);O<sn;)D=ee[he[O]],te&&O<12?(Jn[oe]=st+D.x*(vt-st),Jn[oe+1]=Yt+D.y*(qt-Yt),Jn[oe+2]=kn+D.z*(dn-kn),Wi[oe]=G[ie],Wi[oe+1]=G[ie+1],Wi[oe+2]=G[ie+2],oe%9==0&&(Ln[oe/9]=yt),oe+=3):(Pi[Rs]=st+D.x*(vt-st),Pi[Rs+1]=Yt+D.y*(qt-Yt),Pi[Rs+2]=kn+D.z*(dn-kn),Si[Rs]=G[ie],Si[Rs+1]=G[ie+1],Si[Rs+2]=G[ie+2],Rs%9==0&&(bi[Rs/9]=yt),Rs+=3),++O,O%6==0&&(ie+=3,Dn&&O===he.length-12&&(O+=6,ie+=3))}const _e=Ve(k,Pi,Si);let Oe=Z?3:lt.fFillColor,$e=k.getColor(Oe);ii?$e=Z?ii.getColor(Nt):ii.calcColor(Nt,Sn.length):(1===k.options.Lego||Oe<2)&&(Oe=1,$e="white");const et=new L.V9B((0,ve.Bx)($e,{vertexColors:!1})),it=new L.eaF(_e,et);if(it.face_to_bins_index=bi,it.painter=k,it.zmin=$n,it.zmax=Cn,it.baseline=!1!==k.options.BaseLine?k.options.BaseLine:k.options.Zero?$n:0,it.tip_color=3===Oe?16711680:65280,it.handle=W,it.tooltip=function(yt){if(yt.faceIndex<0||yt.faceIndex>=this.face_to_bins_index.length)return null;const sn=this.painter,tn=this.handle,xn=sn.getFramePainter(),wn=sn.getHisto(),Ut=sn.get3DToolTip(this.face_to_bins_index[yt.faceIndex]),Qe=Math.min(xn.size_x3d,Math.max(-xn.size_x3d,tn.grx[Ut.ix-1]+tn.xbar1*(tn.grx[Ut.ix]-tn.grx[Ut.ix-1]))),nt=Math.min(xn.size_x3d,Math.max(-xn.size_x3d,tn.grx[Ut.ix-1]+tn.xbar2*(tn.grx[Ut.ix]-tn.grx[Ut.ix-1]))),at=Math.min(xn.size_y3d,Math.max(-xn.size_y3d,tn.gry[Ut.iy-1]+tn.ybar1*(tn.gry[Ut.iy]-tn.gry[Ut.iy-1]))),ht=Math.min(xn.size_y3d,Math.max(-xn.size_y3d,tn.gry[Ut.iy-1]+tn.ybar2*(tn.gry[Ut.iy]-tn.gry[Ut.iy-1])));Ut.x1=Math.min(Qe,nt),Ut.x2=Math.max(Qe,nt),Ut.y1=Math.min(at,ht),Ut.y2=Math.max(at,ht);let Qt=this.baseline,vn=Ut.value;return wn.$baseh&&(Qt=wn.$baseh.getBinContent(Ut.ix,Ut.iy)),vn<Qt&&([Qt,vn]=[vn,Qt]),Ut.z1=xn.grz(Math.max(this.zmin,Qt)),Ut.z2=xn.grz(Math.min(this.zmax,vn)),Ut.color=this.tip_color,Ut.$painter=sn,Ut.$projection=sn.is_projection&&2===sn.getDimension(),Ut},z.add3DMesh(it),ci>0){const yt=Ve(k,Jn,Wi),sn=new L.Q1f(Oe<2?16711680:(0,x.Qh)($e).darker(.5).toString()),tn=new L.V9B({color:sn,vertexColors:!1}),xn=new L.eaF(yt,tn);xn.face_to_bins_index=Ln,xn.painter=k,xn.handle=it.handle,xn.tooltip=it.tooltip,xn.zmin=it.zmin,xn.zmax=it.zmax,xn.baseline=it.baseline,xn.tip_color=it.tip_color,z.add3DMesh(xn)}}if(k.options.Lego>12)return;let ai=0,Hi=0;for(Fe=Cn,tt=$n,Ne=we;Ne<Me;++Ne)for(rt=je;rt<Ge;++rt)yn(Ne,rt,0)&&(ai+=Mn?T.length:ee.length,Hi+=Mn?P.length:b.length);const ti=ai<=65520;ti||(ai=3*Hi);const Nr=new Float32Array(3*ai),ss=ti?new Uint16Array(Hi):null,Bs=z.grz($n),yo=z.grz(Cn);let xt=0,K=0,ge=0,ye=0;for(Ne=we;Ne<Me;++Ne)for(st=W.grx[Ne]+W.xbar1*(W.grx[Ne+1]-W.grx[Ne]),vt=W.grx[Ne]+W.xbar2*(W.grx[Ne+1]-W.grx[Ne]),rt=je;rt<Ge;++rt){if(!yn(Ne,rt,0))continue;Yt=W.gry[rt]+W.ybar1*(W.gry[rt+1]-W.gry[rt]),qt=W.gry[rt]+W.ybar2*(W.gry[rt+1]-W.gry[rt]),xt=Ot<=$n?Bs:z.grz(Ot),K=Bn>Cn?yo:z.grz(Bn);const Nt=Mn?P:b,nn=Mn?T:ee;if(ti){for(St=0;St<Nt.length;++St)ss[ye++]=ge/3+Nt[St];for(St=0;St<nn.length;++St)pt=nn[St],Nr[ge]=st+pt.x*(vt-st),Nr[ge+1]=Yt+pt.y*(qt-Yt),Nr[ge+2]=xt+pt.z*(K-xt),ge+=3}else for(St=0;St<Nt.length;++St)pt=nn[Nt[St]],Nr[ge]=st+pt.x*(vt-st),Nr[ge+1]=Yt+pt.y*(qt-Yt),Nr[ge+2]=xt+pt.z*(K-xt),ge+=3}const Pe=Z?k.v7EvalColor("line_color","lightblue"):k.getColor(lt.fLineColor),At=new L.mrM((0,ve.Bx)(Pe,{linewidth:Z?k.v7EvalAttr("line_width",1):lt.fLineWidth})),Vt=(0,ve.Fc)(He(k,Nr),At,ti?ss:null);z.add3DMesh(Vt)}function C(k,Z=!1){const ee=k.getFramePainter(),he=k.getHisto(),G=k.prepareDraw({rounding:!1,use3d:!0,extra:1}),b=ee.z_handle.getScaleMin(),P=ee.z_handle.getScaleMax(),T=k.options.cutg;let z,W,fe,we,Me,je,Ge,lt,bt,te,Je,tt=0,Fe=null,Ne=null,rt=0;for(let Yt=0;Yt<2;++Yt){for(z=G.i1;z<G.i2;++z)for(je=G.grx[z],lt=G.grx[z+1],W=G.j1;W<G.j2;++W)if(we=he.getBinContent(z+1,W+1),!(we<b||we>P)&&(we!==b||k.options.Zero||b>0||k._show_empty_bins)&&(!T||T.IsInside(he.fXaxis.GetBinCoord(z+.5),he.fYaxis.GetBinCoord(W+.5)))){if(0===Yt){tt+=3;continue}fe=he.getBin(z+1,W+1),Me=he.getBinError(fe),Ne[rt/18]=fe,Ge=G.gry[W],bt=G.gry[W+1],te=ee.grz(we-Me<b?b:we-Me),Je=ee.grz(we+Me>P?P:we+Me),Fe[rt]=je,Fe[rt+3]=lt,Fe[rt+1]=Fe[rt+4]=(Ge+bt)/2,Fe[rt+2]=Fe[rt+5]=(te+Je)/2,rt+=6,Fe[rt]=Fe[rt+3]=(je+lt)/2,Fe[rt+1]=Ge,Fe[rt+4]=bt,Fe[rt+2]=Fe[rt+5]=(te+Je)/2,rt+=6,Fe[rt]=Fe[rt+3]=(je+lt)/2,Fe[rt+1]=Fe[rt+4]=(Ge+bt)/2,Fe[rt+2]=te,Fe[rt+5]=Je,rt+=6}if(0===Yt){if(0===tt)return;Fe=new Float32Array(6*tt),Ne=new Int32Array(tt/3)}}const pt=Z?k.v7EvalColor("line_color","lightblue"):k.getColor(he.fLineColor),st=new L.mrM((0,ve.Bx)(pt,{linewidth:Z?k.v7EvalAttr("line_width",1):he.fLineWidth})),vt=(0,ve.Fc)(Fe,st);vt.painter=k,vt.intersect_index=Ne,vt.zmin=b,vt.zmax=P,vt.tip_color=3===he.fLineColor?16711680:65280,vt.tooltip=function(Yt){const qt=Math.floor(Yt.index/6);if(qt<0||qt>=this.intersect_index.length)return null;const Ot=this.painter,Bn=Ot.getHisto(),Mn=Ot.getFramePainter(),bn=Ot.get3DToolTip(this.intersect_index[qt]),Dn=Math.min(Mn.size_x3d,Math.max(-Mn.size_x3d,Mn.grx(Bn.fXaxis.GetBinLowEdge(bn.ix)))),$n=Math.min(Mn.size_x3d,Math.max(-Mn.size_x3d,Mn.grx(Bn.fXaxis.GetBinLowEdge(bn.ix+1)))),Cn=Math.min(Mn.size_y3d,Math.max(-Mn.size_y3d,Mn.gry(Bn.fYaxis.GetBinLowEdge(bn.iy)))),yn=Math.min(Mn.size_y3d,Math.max(-Mn.size_y3d,Mn.gry(Bn.fYaxis.GetBinLowEdge(bn.iy+1))));return bn.x1=Math.min(Dn,$n),bn.x2=Math.max(Dn,$n),bn.y1=Math.min(Cn,yn),bn.y2=Math.max(Cn,yn),bn.z1=Mn.grz(bn.value-bn.error<this.zmin?this.zmin:bn.value-bn.error),bn.z2=Mn.grz(bn.value+bn.error>this.zmax?this.zmax:bn.value+bn.error),bn.color=this.tip_color,bn},ee.add3DMesh(vt)}function I(k,Z=!1,ee=!1){const he=k.getFramePainter(),G=k.prepareDraw({rounding:!1,use3d:!0,extra:100,middle:0}),b=k.getHisto(),P=k.getContourLevels(),T=k.getHistPalette(),z=[];let W=2*he.size_z3d;(0,Ye.Hn)(b,G,P,T,(we,Me,je,Ge,lt,bt)=>{if(!(lt-Ge<3||Z&&(W=he.grz(P[bt]),W<0||W>2*he.size_z3d)))for(let te=Ge;te<lt;++te)z.push(Me[te],je[te],W),z.push(Me[te+1],je[te+1],W)});const fe=(0,ve.Fc)(z,(0,ve.DH)(k,ee?"line_":b));he.add3DMesh(fe)}function U(k,Z=!1){const ee=k.getHisto(),he=k.getFramePainter(),G=he.z_handle.getScaleMin(),b=he.logz?Me=>Me<G?-.1:he.grz(Me):he.grz,T=2*he.size_z3d;let z=k.prepareDraw({rounding:!1,use3d:!0,extra:1,middle:.5,cutg:(0,Ee.isFunc)(k.options?.cutg?.IsInside)?k.options?.cutg:null});if(z.i2-z.i1<2||z.j2-z.j1<2)return;let W=null,fe=null,we=null;if(z.dolines=!0,Z){let Me=0;switch(k.options.Surf){case 11:Me=2;break;case 12:case 15:case 17:Me=2,z.dolines=!1;break;case 14:z.dolines=!1,z.donormals=!0;break;case 16:Me=1,z.dogrid=!0,z.dolines=!1;break;default:W=he.z_handle.createTicks(!0),z.dogrid=!0}Me>0&&(we=he.getHistPalette(),2===Me&&k.createContour(he,we,{full_z_range:!0}),W=we.getContour())}else switch(k.options.Surf){case 11:W=k.getContourLevels(),we=k.getHistPalette();break;case 12:case 15:case 17:W=k.getContourLevels(),we=k.getHistPalette(),z.dolines=!1;break;case 14:z.dolines=!1,z.donormals=!0;break;case 16:W=k.getContourLevels(),z.dogrid=!0,z.dolines=!1;break;default:W=he.z_handle.createTicks(!0),z.dogrid=!0}if(W){fe=new Float32Array(W.length);for(let Me=0;Me<W.length;++Me)fe[Me]=b(W[Me])}else fe=[0,T];if(z.grz=b,z.grz_min=0,z.grz_max=T,(0,Ye.YB)(ee,z,W,(Me,je,Ge)=>{const lt=Ve(k,je,null,z.i2-z.i1,z.j2-z.j1),bt=lt.getAttribute("normal").array;if(z.donormals&&1===Me)for(let Fe=z.i1;Fe<z.i2;++Fe)for(let Ne=z.j1;Ne<z.j2;++Ne){const rt=8*((Fe-z.i1)*(z.j2-z.j1)+(Ne-z.j1));if(-1===Ge[rt])continue;const St=Ge[rt]>=0?rt:rt+9+Ge[rt],pt=rt+8;let st=0,vt=0,Yt=0;for(let qt=St;qt<pt;++qt){const Ot=Ge[qt];if(Ot<0)return console.error("FAILURE in NORMALS RECALCULATIONS");st+=bt[Ot],vt+=bt[Ot+1],Yt+=bt[Ot+2]}st/=pt-St,vt/=pt-St,Yt/=pt-St;for(let qt=St;qt<pt;++qt){const Ot=Ge[qt];bt[Ot]=st,bt[Ot+1]=vt,bt[Ot+2]=Yt}}let te,Je;Z?te=we?.getColor(Me-1)??k.getColor(5):we?te=we.calcColor(Me,fe.length):(te=ee.fFillColor>1?k.getColor(ee.fFillColor):"white",14===k.options.Surf&&ee.fFillColor<2&&(te=k.getColor(48))),te||(te="white"),Je=14===k.options.Surf?new L.G_z((0,ve.Bx)(te,{side:L.$EB,vertexColors:!1})):new L.V9B((0,ve.Bx)(te,{side:L.$EB,vertexColors:!1}));const tt=new L.eaF(lt,Je);he.add3DMesh(tt),tt.painter=k},(Me,je)=>{const Ge=k.getColor(ee.fLineColor)??"white";let lt;lt=Me?1===k.options.Surf?new L.Fvt({color:0,dashSize:2,gapSize:2}):new L.mrM((0,ve.Bx)(Ge)):new L.mrM((0,ve.Bx)(Ge,{linewidth:ee.fLineWidth}));const bt=(0,ve.Fc)(He(k,je,z.i2-z.i1,z.j2-z.j1),lt);bt.painter=k,he.add3DMesh(bt)}),17===k.options.Surf&&I(k,!1,Z),13===k.options.Surf){z=k.prepareDraw({rounding:!1,use3d:!0,extra:100,middle:0});const Me=k.getContourLevels(),je=k.getHistPalette();let Ge=-1,lt=T;(0,Ye.Hn)(ee,z,Me,je,(bt,te,Je,tt,Fe)=>{if(te[Fe]===te[tt]&&Je[Fe]===Je[tt]&&Fe--,Fe-tt<3)return;const Ne=[];for(let Ot=tt;Ot<=Fe;++Ot)(Ot===tt||te[Ot]!==te[Ot-1]||Je[Ot]!==Je[Ot-1])&&Ne.push(new L.I9Y(te[Ot],Je[Ot]));if(Ne.length<3)return;const rt=L.xJ6.triangulateShape(Ne,[]);if(!rt||0===rt.length)return;(Ge<0||Ge!==bt)&&(Ge=bt,lt+=5e-5*T);const St=new Float32Array(9*rt.length),pt=new Float32Array(9*rt.length);let st=0;for(let Ot=0;Ot<rt.length;++Ot){const Bn=rt[Ot];for(let Mn=0;Mn<3;++Mn){const bn=Ne[Bn[Mn]];St[st]=bn.x,St[st+1]=bn.y,St[st+2]=lt,pt[st]=0,pt[st+1]=0,pt[st+2]=1,st+=3}}const vt=Ve(k,St,pt,z.i2-z.i1,z.j2-z.j1),Yt=new L.V9B((0,ve.Bx)(je.getColor(bt),{side:L.$EB,opacity:.5,vertexColors:!1})),qt=new L.eaF(vt,Yt);qt.painter=k,he.add3DMesh(qt)})}}},4369:(Yr,mt,Se)=>{"use strict";Se.d(mt,{$o:()=>lt,D1:()=>De,FF:()=>T,Fk:()=>Ye,Hg:()=>B,Mx:()=>Nr,N8:()=>bt,NE:()=>U,PI:()=>Z,Ph:()=>b,Pk:()=>G,Q_:()=>$,Ql:()=>je,Qu:()=>k,R0:()=>ot,Tq:()=>Rs,Ub:()=>Sn,V$:()=>W,_T:()=>Hi,aM:()=>J,bP:()=>g,bm:()=>he,c4:()=>v,h0:()=>E,k:()=>X,k1:()=>Q,lW:()=>kn,lZ:()=>Ze,mU:()=>te,nc:()=>Y,ry:()=>nn,s4:()=>I,v5:()=>Ge,w1:()=>P,yd:()=>F,ym:()=>He});var Ee=Se(4882),x=Se(8872);const L="TStreamerElement",ve="TStreamerObject",ke="TStreamerSTL",ot="TStreamerInfoList",Ye="TDirectory",Ze="TDirectoryFile",He="TBasket",Ve="TDatime",De="StreamerInfo",F=1,J=2,Y=3,ue=4,Q=5,me=6,X=7,B=8,$=9,A=10,E=11,g=12,v=13,f=14,C=15,I=16,U=17,k=18,Z=19,ee=0,he=20,G=40,b=61,P=62,T=63,z=64,W=65,fe=66,we=67,Me=68,je=69,Ge=71,lt=300,bt=500,te=501,tt=1073741824,Fe=4294967295,Ne=2147483648,rt=(0,x.BIT)(14),St=0,pt=1,st=2,vt=3,Yt=4,qt=5,Ot=6,Bn=7,Mn=8,bn=["BASE","char","short","int","long","float","int","const char*","double","Double32_t","char","unsigned  char","unsigned short","unsigned","unsigned long","unsigned","Long64_t","ULong64_t","bool","Float16_t"],Dn=["","vector","list","deque","map","multimap","set","multiset","bitset"],$n=(0,x.BIT)(4),Cn=(0,x.BIT)(5),yn={TObject(oe,D){D.fUniqueID=oe.ntou4(),D.fBits=oe.ntou4(),D.fBits&$n&&oe.ntou2()},TNamed:[{basename:x.clTObject,base:1,func(oe,D){D._typename||(D._typename=x.clTNamed),oe.classStreamer(D,x.clTObject)}},{name:"fName",func(oe,D){D.fName=oe.readTString()}},{name:"fTitle",func(oe,D){D.fTitle=oe.readTString()}}],TObjString:[{basename:x.clTObject,base:1,func(oe,D){D._typename||(D._typename=x.clTObjString),oe.classStreamer(D,x.clTObject)}},{name:"fString",func(oe,D){D.fString=oe.readTString()}}],TClonesArray(oe,D){D._typename||(D._typename=x.clTClonesArray),D.$kind=x.clTClonesArray,D.name="";const O=oe.last_read_version;O>2&&oe.classStreamer(D,x.clTObject),O>1&&(D.name=oe.readTString());let ie=oe.readTString(),_e=0;const Oe=ie.lastIndexOf(";");Oe>0&&(_e=parseInt(ie.slice(Oe+1)),ie=ie.slice(0,Oe));let $e=oe.ntou4();$e<0&&($e=-$e),D.arr=new Array($e),D.fLast=$e-1,D.fLowerBound=oe.ntou4();let et=oe.fFile.getStreamer(ie,{val:_e});if(et=oe.fFile.getSplittedStreamer(et),et){for(let it=0;it<$e;++it)D.arr[it]={_typename:ie};for(let it=0;it<et.length;++it)for(let yt=0;yt<$e;++yt)et[it].func(oe,D.arr[yt])}else console.log(`Cannot get member-wise streamer for ${ie}:${_e}`)},TMap(oe,D){D._typename||(D._typename=x.clTMap),D.name="",D.arr=[];const O=oe.last_read_version;O>2&&oe.classStreamer(D,x.clTObject),O>1&&(D.name=oe.readTString());const ie=oe.ntou4();for(let _e=0;_e<ie;++_e){const Oe={_typename:"TPair"};Oe.first=oe.readObjectAny(),Oe.second=oe.readObjectAny(),Oe.first&&D.arr.push(Oe)}},TTreeIndex(oe,D){const O=oe.last_read_version;D._typename="TTreeIndex",oe.classStreamer(D,"TVirtualIndex"),D.fMajorName=oe.readTString(),D.fMinorName=oe.readTString(),D.fN=oe.ntoi8(),D.fIndexValues=oe.readFastArray(D.fN,I),O>1&&(D.fIndexValuesMinor=oe.readFastArray(D.fN,I)),D.fIndex=oe.readFastArray(D.fN,I)},TRefArray(oe,D){D._typename="TRefArray",oe.classStreamer(D,x.clTObject),D.name=oe.readTString();const O=oe.ntoi4();D.fLast=O-1,D.fLowerBound=oe.ntoi4(),oe.ntou2(),D.fUIDs=oe.readFastArray(O,v)},TCanvas(oe,D){D._typename=x.clTCanvas,oe.classStreamer(D,x.clTPad),D.fDISPLAY=oe.readTString(),D.fDoubleBuffer=oe.ntoi4(),D.fRetained=0!==oe.ntou1(),D.fXsizeUser=oe.ntoi4(),D.fYsizeUser=oe.ntoi4(),D.fXsizeReal=oe.ntoi4(),D.fYsizeReal=oe.ntoi4(),D.fWindowTopX=oe.ntoi4(),D.fWindowTopY=oe.ntoi4(),D.fWindowWidth=oe.ntoi4(),D.fWindowHeight=oe.ntoi4(),D.fCw=oe.ntou4(),D.fCh=oe.ntou4(),D.fCatt=oe.classStreamer({},x.clTAttCanvas),oe.ntou1(),oe.ntou1(),D.fHighLightColor=oe.ntoi2(),D.fBatch=0!==oe.ntou1(),oe.ntou1(),oe.ntou1(),oe.ntou1()},TObjArray(oe,D){D._typename||(D._typename=x.clTObjArray),D.$kind=x.clTObjArray,D.name="";const O=oe.last_read_version;O>2&&oe.classStreamer(D,x.clTObject),O>1&&(D.name=oe.readTString());const ie=oe.ntou4();let _e=0;for(D.arr=new Array(ie),D.fLast=ie-1,D.fLowerBound=oe.ntou4();_e<ie;)D.arr[_e++]=oe.readObjectAny()},TPolyMarker3D(oe,D){const O=oe.last_read_version;oe.classStreamer(D,x.clTObject),oe.classStreamer(D,x.clTAttMarker),D.fN=oe.ntoi4(),D.fP=oe.readFastArray(3*D.fN,Q),D.fOption=oe.readTString(),D.fName=O>1?oe.readTString():x.clTPolyMarker3D},TPolyLine3D(oe,D){oe.classStreamer(D,x.clTObject),oe.classStreamer(D,x.clTAttLine),D.fN=oe.ntoi4(),D.fP=oe.readFastArray(3*D.fN,Q),D.fOption=oe.readTString()},TStreamerInfo(oe,D){oe.classStreamer(D,x.clTNamed),D.fCheckSum=oe.ntou4(),D.fClassVersion=oe.ntou4(),D.fElements=oe.readObjectAny()},TStreamerElement(oe,D){const O=oe.last_read_version;if(oe.classStreamer(D,x.clTNamed),D.fType=oe.ntou4(),D.fSize=oe.ntou4(),D.fArrayLength=oe.ntou4(),D.fArrayDim=oe.ntou4(),D.fMaxIndex=oe.readFastArray(1===O?oe.ntou4():5,v),D.fTypeName=oe.readTString(),D.fType===E&&("Bool_t"===D.fTypeName||"bool"===D.fTypeName)&&(D.fType=k),D.fXmin=D.fXmax=D.fFactor=0,3===O)D.fXmin=oe.ntod(),D.fXmax=oe.ntod(),D.fFactor=oe.ntod();else if(O>3&&D.fBits&(0,x.BIT)(6)){let ie=D.fTitle.indexOf("[");ie>=0&&D.fType>G&&(ie=D.fTitle.indexOf("[",ie+1));const _e=D.fTitle.indexOf("]",ie+1);if(ie>=0&&_e>=ie+2){const Oe=D.fTitle.slice(ie+1,_e).split(",");let $e=32;if(!Oe||Oe.length<2)throw new Error(`Problem to decode range setting from streamer element title ${D.fTitle}`);3===Oe.length&&($e=parseInt(Oe[2])),(!Number.isInteger($e)||$e<2||$e>32)&&($e=32);const et=yt=>{if(!yt)return 0;if(yt.indexOf("pi")<0)return parseFloat(yt);let sn=1;switch("-"===(yt=yt.trim())[0]&&(sn=-1,yt=yt.slice(1)),yt){case"2pi":case"2*pi":case"twopi":return 2*sn*Math.PI;case"pi/2":return sn*Math.PI/2;case"pi/4":return sn*Math.PI/4}return sn*Math.PI};D.fXmin=et(Oe[0]),D.fXmax=et(Oe[1]);const it=$e>=0&&$e<32?Math.pow(2,$e):4294967295;D.fXmin<D.fXmax?D.fFactor=it/(D.fXmax-D.fXmin):$e<15&&(D.fXmin=$e)}}},TStreamerBase(oe,D){const O=oe.last_read_version;oe.classStreamer(D,L),O>2&&(D.fBaseVersion=oe.ntou4())},TStreamerSTL(oe,D){oe.classStreamer(D,L),D.fSTLtype=oe.ntou4(),D.fCtype=oe.ntou4(),D.fSTLtype===qt&&(0===D.fTypeName.indexOf("std::set")||0===D.fTypeName.indexOf("set"))&&(D.fSTLtype=Ot),D.fSTLtype===Ot&&(0===D.fTypeName.indexOf("std::multimap")||0===D.fTypeName.indexOf("multimap"))&&(D.fSTLtype=qt)},TStreamerSTLstring(oe,D){oe.last_read_version>0&&oe.classStreamer(D,ke)},TList(oe,D){if(D._typename||(D._typename=this.typename),D.$kind=x.clTList,oe.last_read_version>3){oe.classStreamer(D,x.clTObject),D.name=oe.readTString();const O=oe.ntou4();D.arr=new Array(O),D.opt=new Array(O);for(let ie=0;ie<O;++ie)D.arr[ie]=oe.readObjectAny(),D.opt[ie]=oe.readTString()}else D.name="",D.arr=[],D.opt=[]},THashList:x.clTList,TStreamerLoop(oe,D){oe.last_read_version>1&&(oe.classStreamer(D,L),D.fCountVersion=oe.ntou4(),D.fCountName=oe.readTString(),D.fCountClass=oe.readTString())},TStreamerBasicPointer:"TStreamerLoop",TStreamerObject(oe,D){oe.last_read_version>1&&oe.classStreamer(D,L)},TStreamerBasicType:ve,TStreamerObjectAny:ve,TStreamerString:ve,TStreamerObjectPointer:ve,TStreamerObjectAnyPointer(oe,D){oe.last_read_version>0&&oe.classStreamer(D,L)},TTree:{name:"$file",func(oe,D){D.$kind="TTree",D.$file=oe.fFile}},RooRealVar(oe,D){const O=oe.last_read_version;oe.classStreamer(D,"RooAbsRealLValue"),1===O&&(oe.ntod(),oe.ntod(),oe.ntoi4()),D._error=oe.ntod(),D._asymErrLo=oe.ntod(),D._asymErrHi=oe.ntod(),O>=2&&(D._binning=oe.readObjectAny()),3===O&&(D._sharedProp=oe.readObjectAny()),O>=4&&(D._sharedProp=oe.classStreamer({},"RooRealVarSharedProperties"))},RooAbsBinning(oe,D){oe.classStreamer(D,1===oe.last_read_version?x.clTObject:x.clTNamed),oe.classStreamer(D,"RooPrintable")},RooCategory(oe,D){const O=oe.last_read_version;oe.classStreamer(D,"RooAbsCategoryLValue"),D._sharedProp=1===O?oe.readObjectAny():oe.classStreamer({},"RooCategorySharedProperties")},"RooWorkspace::CodeRepo":oe=>{const D=2===oe.last_read_version?3:2;for(let O=0;O<D;++O){let ie=oe.ntoi4()*(0===O?4:3);for(;ie--;)oe.readTString()}},RooLinkedList(oe,D){const O=oe.last_read_version;oe.classStreamer(D,x.clTObject);let ie=oe.ntoi4();for(D.arr=(0,x.create)(x.clTList);ie--;)D.arr.Add(oe.readObjectAny());O>1&&(D._name=oe.readTString())},TImagePalette:[{basename:x.clTObject,base:1,func(oe,D){D._typename||(D._typename=x.clTImagePalette),oe.classStreamer(D,x.clTObject)}},{name:"fNumPoints",func(oe,D){D.fNumPoints=oe.ntou4()}},{name:"fPoints",func(oe,D){D.fPoints=oe.readFastArray(D.fNumPoints,B)}},{name:"fColorRed",func(oe,D){D.fColorRed=oe.readFastArray(D.fNumPoints,g)}},{name:"fColorGreen",func(oe,D){D.fColorGreen=oe.readFastArray(D.fNumPoints,g)}},{name:"fColorBlue",func(oe,D){D.fColorBlue=oe.readFastArray(D.fNumPoints,g)}},{name:"fColorAlpha",func(oe,D){D.fColorAlpha=oe.readFastArray(D.fNumPoints,g)}}],TAttImage:[{name:"fImageQuality",func(oe,D){D.fImageQuality=oe.ntoi4()}},{name:"fImageCompression",func(oe,D){D.fImageCompression=oe.ntou4()}},{name:"fConstRatio",func(oe,D){D.fConstRatio=0!==oe.ntou1()}},{name:"fPalette",func(oe,D){D.fPalette=oe.classStreamer({},x.clTImagePalette)}}],TASImage(oe,D){if(1===oe.last_read_version&&oe.fFile.fVersion>0&&oe.fFile.fVersion<5e4)return console.warn("old TASImage version - not yet supported");if(oe.classStreamer(D,x.clTNamed),0!==oe.ntou1()){const O=oe.ntoi4();D.fPngBuf=oe.readFastArray(O,E)}else oe.classStreamer(D,"TAttImage"),D.fWidth=oe.ntoi4(),D.fHeight=oe.ntoi4(),D.fImgBuf=oe.readFastArray(D.fWidth*D.fHeight,B)},TMaterial(oe,D){const O=oe.last_read_version;oe.classStreamer(D,x.clTNamed),D.fNumber=oe.ntoi4(),D.fA=oe.ntof(),D.fZ=oe.ntof(),D.fDensity=oe.ntof(),O>2?(oe.classStreamer(D,x.clTAttFill),D.fRadLength=oe.ntof(),D.fInterLength=oe.ntof()):D.fRadLength=D.fInterLength=0},TMixture(oe,D){oe.classStreamer(D,"TMaterial"),D.fNmixt=oe.ntoi4(),D.fAmixt=oe.readFastArray(oe.ntoi4(),Q),D.fZmixt=oe.readFastArray(oe.ntoi4(),Q),D.fWmixt=oe.readFastArray(oe.ntoi4(),Q)},TVirtualPerfStats:x.clTObject,TMethodCall:x.clTObject};function Sn(oe,D){yn[oe]=D}const ii={TQObject(){},TGraphStruct(){},TGraphNode(){},TGraphEdge(){},TDatime(oe,D){D.fDatime=oe.ntou4()},TKey(oe,D){D.fNbytes=oe.ntoi4(),D.fVersion=oe.ntoi2(),D.fObjlen=oe.ntou4(),D.fDatime=oe.classStreamer({},Ve),D.fKeylen=oe.ntou2(),D.fCycle=oe.ntou2(),D.fVersion>1e3?(D.fSeekKey=oe.ntou8(),oe.shift(8)):(D.fSeekKey=oe.ntou4(),oe.shift(4)),D.fClassName=oe.readTString(),D.fName=oe.readTString(),D.fTitle=oe.readTString()},TDirectory(oe,D){const O=oe.ntou2();D.fDatimeC=oe.classStreamer({},Ve),D.fDatimeM=oe.classStreamer({},Ve),D.fNbytesKeys=oe.ntou4(),D.fNbytesName=oe.ntou4(),D.fSeekDir=O>1e3?oe.ntou8():oe.ntou4(),D.fSeekParent=O>1e3?oe.ntou8():oe.ntou4(),D.fSeekKeys=O>1e3?oe.ntou8():oe.ntou4()},TBasket(oe,D){oe.classStreamer(D,x.clTKey);const O=oe.readVersion();D.fBufferSize=oe.ntoi4(),D.fNevBufSize=oe.ntoi4(),D.fNevBuf=oe.ntoi4(),D.fLast=oe.ntoi4(),D.fLast>D.fBufferSize&&(D.fBufferSize=D.fLast);const ie=oe.ntoi1();if(0!==ie){if(ie%10!=2){if(D.fNevBuf&&(D.fEntryOffset=oe.readFastArray(oe.ntoi4(),Y),ie>20&&ie<40))for(let _e=0,Oe=4278190080;_e<D.fNevBuf;++_e)D.fEntryOffset[_e]&=~Oe;ie>40&&(D.fDisplacement=oe.readFastArray(oe.ntoi4(),Y))}if(1===ie||ie>10){const _e=O.val<=1?oe.ntoi4():D.fLast;if(_e>D.fKeylen){const Oe=oe.extract([oe.o+D.fKeylen,_e-D.fKeylen]);D.fBufferRef=new kn(Oe,0,oe.fFile,_e-D.fKeylen),D.fBufferRef.fTagOffset=D.fKeylen}oe.shift(_e)}}},TRef(oe,D){oe.classStreamer(D,x.clTObject),D.fBits&Cn?D.fUUID=oe.readTString():D.fPID=oe.ntou2()},"TMatrixTSym<float>":(oe,D)=>{oe.classStreamer(D,"TMatrixTBase<float>"),D.fElements=new Float32Array(D.fNelems);const O=oe.readFastArray(D.fNrows*(D.fNcols+1)/2,Q);for(let ie=0,_e=0;ie<D.fNrows;++ie)for(let Oe=ie;Oe<D.fNcols;++Oe)D.fElements[Oe*D.fNcols+ie]=D.fElements[ie*D.fNcols+Oe]=O[_e++]},"TMatrixTSym<double>":(oe,D)=>{oe.classStreamer(D,"TMatrixTBase<double>"),D.fElements=new Float64Array(D.fNelems);const O=oe.readFastArray(D.fNrows*(D.fNcols+1)/2,B);for(let ie=0,_e=0;ie<D.fNrows;++ie)for(let Oe=ie;Oe<D.fNcols;++Oe)D.fElements[Oe*D.fNcols+ie]=D.fElements[ie*D.fNcols+Oe]=O[_e++]}};function ai(oe,D){switch(oe){case"bool":case"Bool_t":return k;case"char":case"signed char":case"Char_t":return F;case"Color_t":case"Style_t":case"Width_t":case"short":case"Short_t":return J;case"int":case"EErrorType":case"Int_t":return Y;case"long":case"Long_t":return ue;case"float":case"Float_t":return Q;case"double":case"Double_t":return B;case"unsigned char":case"UChar_t":return E;case"unsigned short":case"UShort_t":return g;case"unsigned":case"unsigned int":case"UInt_t":return v;case"unsigned long":case"ULong_t":return f;case"int64_t":case"long long":case"Long64_t":return I;case"uint64_t":case"unsigned long long":case"ULong64_t":return U;case"Double32_t":return $;case"Float16_t":return Z;case"char*":case"const char*":case"const Char_t*":return X}if(!D){const O=yn[oe];if((0,x.isStr)(O))return ai(O,!0)}return-1}function Hi(oe,D,O){const ie={_typename:L,fName:oe,fTypeName:D,fType:0,fSize:0,fArrayLength:0,fArrayDim:0,fMaxIndex:[0,0,0,0,0],fXmin:0,fXmax:0,fFactor:0};if((0,x.isStr)(D)?(ie.fType=ai(D),ie.fType<0&&O&&O.fBasicTypes[D]&&(ie.fType=O.fBasicTypes[D])):(ie.fType=D,D=ie.fTypeName=bn[ie.fType]||"int"),ie.fType>0)return ie;const _e=D.indexOf("<");let Oe=St;if(_e>0&&D.indexOf(">")>_e+2)for(let et=1;et<Dn.length;++et)if(D.slice(0,_e)===Dn[et]){Oe=et;break}if(Oe!==St)return ie._typename=ke,ie.fType=bt,ie.fSTLtype=Oe,ie.fCtype=0,ie;const $e=D.lastIndexOf("*")===D.length-1;return $e&&(ie.fTypeName=D=D.slice(0,D.length-1)),0===ss(D)?(ie.fType=W,ie):(ie.fType=$e?je:P,ie)}function ti(oe,D,O){if(!oe){if(0!==D.indexOf("pair"))return null;if(!(oe=O.findStreamerInfo(D))){let $e=function(){let et="",it=_e+1,yt=0;for(;it<Oe&&yt>=0;){switch(D[it]){case"<":yt++;break;case",":0===yt&&yt--;break;case">":yt--}yt>=0&&(et+=D[it]),it++}return _e=it-1,et.trim()},_e=D.indexOf("<");const Oe=D.lastIndexOf(">");(oe={_typename:"TStreamerInfo",fVersion:1,fName:D,fElements:(0,x.create)(x.clTList)}).fElements.Add(Hi("first",$e(),O)),oe.fElements.Add(Hi("second",$e(),O))}}const ie=O.getStreamer(D,null,oe);if(!ie)return null;if(2!==ie.length)return console.error(`Streamer for pair class contains ${ie.length} elements`),null;for(let _e=0;_e<2;++_e)ie[_e].readelem&&!ie[_e].pair_name&&(ie[_e].pair_name=0===_e?"first":"second",ie[_e].func=function(Oe,$e){$e[this.pair_name]=this.readelem(Oe)});return ie}function Nr(oe,D){const O={name:oe.fName,type:oe.fType,fArrayLength:oe.fArrayLength,fArrayDim:oe.fArrayDim,fMaxIndex:oe.fMaxIndex};switch("BASE"===oe.fTypeName&&(ss(O.name)>0?(O.name="fArray",O.type=P):O.type=ee),O.type){case ee:O.base=oe.fBaseVersion,O.basename=oe.fName,O.func=function(ie,_e){ie.classStreamer(_e,this.basename)};break;case J:O.func=function(ie,_e){_e[this.name]=ie.ntoi2()};break;case Y:case me:O.func=function(ie,_e){_e[this.name]=ie.ntoi4()};break;case ue:case I:O.func=function(ie,_e){_e[this.name]=ie.ntoi8()};break;case B:O.func=function(ie,_e){_e[this.name]=ie.ntod()};break;case Q:O.func=function(ie,_e){_e[this.name]=ie.ntof()};break;case A:case E:O.func=function(ie,_e){_e[this.name]=ie.ntou1()};break;case g:O.func=function(ie,_e){_e[this.name]=ie.ntou2()};break;case C:case v:O.func=function(ie,_e){_e[this.name]=ie.ntou4()};break;case U:case f:O.func=function(ie,_e){_e[this.name]=ie.ntou8()};break;case k:O.func=function(ie,_e){_e[this.name]=0!==ie.ntou1()};break;case he+k:case he+Y:case he+me:case he+B:case he+E:case he+J:case he+g:case he+C:case he+v:case he+f:case he+U:case he+ue:case he+I:case he+Q:oe.fArrayDim<2?(O.arrlength=oe.fArrayLength,O.func=function(ie,_e){_e[this.name]=ie.readFastArray(this.arrlength,this.type-he)}):(O.arrlength=oe.fMaxIndex[oe.fArrayDim-1],O.minus1=!0,O.func=function(ie,_e){_e[this.name]=ie.readNdimArray(this,(Oe,$e)=>Oe.readFastArray($e.arrlength,$e.type-he))});break;case he+F:oe.fArrayDim<2?(O.arrlength=oe.fArrayLength,O.func=function(ie,_e){_e[this.name]=ie.readFastString(this.arrlength)}):(O.minus1=!0,O.arrlength=oe.fMaxIndex[oe.fArrayDim-1],O.func=function(ie,_e){_e[this.name]=ie.readNdimArray(this,(Oe,$e)=>Oe.readFastString($e.arrlength))});break;case G+k:case G+Y:case G+B:case G+E:case G+J:case G+g:case G+C:case G+v:case G+f:case G+U:case G+ue:case G+I:case G+Q:O.cntname=oe.fCountName,O.func=function(ie,_e){_e[this.name]=1===ie.ntou1()?ie.readFastArray(_e[this.cntname],this.type-G):[]};break;case G+F:O.cntname=oe.fCountName,O.func=function(ie,_e){_e[this.name]=1===ie.ntou1()?ie.readFastString(_e[this.cntname]):null};break;case $:case he+$:case G+$:O.double32=!0;case Z:case he+Z:case G+Z:0!==oe.fFactor?(O.factor=1/oe.fFactor,O.min=oe.fXmin,O.read=function(ie){return ie.ntou4()*this.factor+this.min}):0===oe.fXmin&&O.double32?O.read=function(ie){return ie.ntof()}:(O.nbits=Math.round(oe.fXmin),0===O.nbits&&(O.nbits=12),O.dv=new DataView(new ArrayBuffer(8),0),O.read=function(ie){const _e=ie.ntou1(),Oe=ie.ntou2();return this.dv.setUint32(0,_e<<23|(Oe&(1<<this.nbits+1)-1)<<23-this.nbits),(1<<this.nbits+1&Oe?-1:1)*this.dv.getFloat32(0)}),O.readarr=function(ie,_e){const Oe=this.double32?new Float64Array(_e):new Float32Array(_e);for(let $e=0;$e<_e;++$e)Oe[$e]=this.read(ie);return Oe},O.type<he?O.func=function(ie,_e){_e[this.name]=this.read(ie)}:O.type>G?(O.cntname=oe.fCountName,O.func=function(ie,_e){_e[this.name]=1===ie.ntou1()?this.readarr(ie,_e[this.cntname]):null}):oe.fArrayDim<2?(O.arrlength=oe.fArrayLength,O.func=function(ie,_e){_e[this.name]=this.readarr(ie,this.arrlength)}):(O.arrlength=oe.fMaxIndex[oe.fArrayDim-1],O.minus1=!0,O.func=function(ie,_e){_e[this.name]=ie.readNdimArray(this,(Oe,$e)=>$e.readarr(Oe,$e.arrlength))});break;case je:case z:O.func=function(ie,_e){_e[this.name]=ie.readNdimArray(this,Oe=>Oe.readObjectAny())};break;case P:case Me:case T:case b:{let ie="BASE"===oe.fTypeName?oe.fName:oe.fTypeName;"*"===ie[ie.length-1]&&(ie=ie.slice(0,ie.length-1));const _e=ss(ie);_e>0?(O.arrkind=_e,O.func=function(Oe,$e){$e[this.name]=Oe.readFastArray(Oe.ntou4(),this.arrkind)}):0===_e?O.func=function(Oe,$e){$e[this.name]=Oe.readTString()}:(O.classname=ie,O.func=oe.fArrayLength>1?function(Oe,$e){$e[this.name]=Oe.readNdimArray(this,(et,it)=>et.classStreamer({},it.classname))}:function(Oe,$e){$e[this.name]=Oe.classStreamer({},this.classname)});break}case he+b:case he+P:case he+Me:case he+T:{let ie=oe.fTypeName;"*"===ie[ie.length-1]&&(ie=ie.slice(0,ie.length-1)),O.arrkind=ss(ie),O.arrkind<0&&(O.classname=ie),O.func=function(_e,Oe){Oe[this.name]=_e.readNdimArray(this,($e,et)=>et.arrkind>0?$e.readFastArray($e.ntou4(),et.arrkind):0===et.arrkind?$e.readTString():$e.classStreamer({},et.classname))};break}case F:O.func=function(ie,_e){_e[this.name]=ie.ntoi1()};break;case X:O.func=function(ie,_e){const Oe=ie.ntoi4();_e[this.name]=ie.substring(ie.o,ie.o+Oe),ie.o+=Oe};break;case W:O.func=function(ie,_e){_e[this.name]=ie.readTString()};break;case fe:case we:O.typename=oe.fTypeName,O.func=function(ie,_e){_e[this.name]=ie.classStreamer({},this.typename)};break;case he+W:case he+fe:case he+we:O.typename=oe.fTypeName,O.func=function(ie,_e){const Oe=ie.readVersion();_e[this.name]=ie.readNdimArray(this,($e,et)=>et.typename===x.clTString?$e.readTString():$e.classStreamer({},et.typename)),ie.checkByteCount(Oe,this.typename+"[]")};break;case te:case he+te:O.typename=oe.fTypeName,O.cntname=oe.fCountName,O.typename.lastIndexOf("**")>0?(O.typename=O.typename.slice(0,O.typename.lastIndexOf("**")),O.isptrptr=!0):(O.typename=O.typename.slice(0,O.typename.lastIndexOf("*")),O.isptrptr=!1),O.isptrptr?O.readitem=function(ie){return ie.readObjectAny()}:(O.arrkind=ss(O.typename),O.readitem=O.arrkind>0?function(ie){return ie.readFastArray(ie.ntou4(),this.arrkind)}:0===O.arrkind?function(ie){return ie.readTString()}:function(ie){return ie.classStreamer({},this.typename)}),void 0!==O.readitem?(O.read_loop=function(ie,_e){return ie.readNdimArray(this,(Oe,$e)=>{const et=new Array(_e);for(let it=0;it<_e;++it)et[it]=$e.readitem(Oe);return et})},O.func=function(ie,_e){const Oe=ie.readVersion(),$e=this.read_loop(ie,_e[this.cntname]);_e[this.name]=ie.checkByteCount(Oe,this.typename)?$e:null},O.branch_func=function(ie,_e){const Oe=ie.readVersion(),$e=_e[this.stl_size],et=new Array($e);for(let it=0;it<$e;++it)et[it]=this.read_loop(ie,_e[this.cntname][it]);_e[this.name]=ie.checkByteCount(Oe,this.typename)?et:null},O.objs_branch_func=function(ie,_e){const Oe=ie.readVersion(),$e=_e[this.name0];for(let et=0;et<$e.length;++et){const it=this.get($e,et);it[this.name]=this.read_loop(ie,it[this.cntname])}ie.checkByteCount(Oe,this.typename)}):(console.error(`fail to provide function for ${oe.fName} (${oe.fTypeName})  typ = ${oe.fType}`),O.func=function(ie,_e){const Oe=ie.readVersion();ie.checkByteCount(Oe),_e[this.name]=null});break;case bt:{O.typename=oe.fTypeName;const ie=(oe.fSTLtype||0)%40;if("TStreamerSTLstring"===oe._typename||"string"===O.typename||"string*"===O.typename)O.readelem=_e=>_e.readTString();else if(ie===pt||ie===st||ie===vt||ie===Ot||ie===Bn){const _e=O.typename.indexOf("<"),Oe=O.typename.lastIndexOf(">");if(O.conttype=O.typename.slice(_e+1,Oe).trim(),O.typeid=ai(O.conttype),O.typeid<0&&D.fBasicTypes[O.conttype]&&(O.typeid=D.fBasicTypes[O.conttype],console.log(`!!! Reuse basic type ${O.conttype} from file streamer infos`)),oe.fCtype&&oe.fCtype<20&&oe.fCtype!==O.typeid&&(console.warn(`Contained type ${O.conttype} not recognized as basic type ${oe.fCtype} FORCE`),O.typeid=oe.fCtype),O.typeid>0)O.readelem=function($e){return $e.readFastArray($e.ntoi4(),this.typeid)};else if(O.isptr=!1,O.conttype.lastIndexOf("*")===O.conttype.length-1&&(O.isptr=!0,O.conttype=O.conttype.slice(0,O.conttype.length-1)),oe.fCtype===T&&(O.isptr=!0),O.arrkind=ss(O.conttype),O.readelem=Pi,!O.isptr&&O.arrkind<0){const $e=Hi("temp",O.conttype);$e.fType===bt&&($e.$fictional=!0,O.submember=Nr($e,D))}}else if(ie===Yt||ie===qt){const _e=O.typename.indexOf("<"),Oe=O.typename.lastIndexOf(">");O.pairtype="pair<"+O.typename.slice(_e+1,Oe)+">",O.si=D.findStreamerInfo(O.pairtype),O.streamer=ti(O.si,O.pairtype,D),(!O.streamer||2!==O.streamer.length)&&(console.error(`Fail to build streamer for pair ${O.pairtype}`),delete O.streamer),O.streamer&&(O.readelem=Si)}else ie===Mn&&(O.readelem=_e=>_e.readFastArray(_e.ntou4(),k));O.readelem?oe.$fictional||(O.read_version=function(_e,Oe){if(0===Oe)return null;const $e=_e.readVersion();return this.member_wise=!!($e.val&rt),this.stl_version=void 0,this.member_wise&&($e.val=$e.val&~rt,this.stl_version={val:_e.ntoi2()},this.stl_version.val<=0&&(this.stl_version.checksum=_e.ntou4())),$e},O.func=function(_e,Oe){const $e=this.read_version(_e);let et=_e.readNdimArray(this,(it,yt)=>yt.readelem(it));_e.checkByteCount($e,this.typename)||(et=null),Oe[this.name]=et},O.branch_func=function(_e,Oe){const $e=Oe[this.stl_size],et=this.read_version(_e,$e),it=new Array($e);for(let yt=0;yt<$e;++yt)it[yt]=_e.readNdimArray(this,(sn,tn)=>tn.readelem(sn));et&&_e.checkByteCount(et,`branch ${this.typename}`),Oe[this.name]=it},O.split_func=function(_e,Oe,$e){const et=this.read_version(_e);for(let it=0;it<$e;++it)Oe[it][this.name]=_e.readNdimArray(this,(yt,sn)=>sn.readelem(yt));_e.checkByteCount(et,this.typename)},O.objs_branch_func=function(_e,Oe){const $e=Oe[this.name0],et=this.read_version(_e,$e.length);for(let it=0;it<$e.length;++it)this.get($e,it)[this.name]=_e.readNdimArray(this,(sn,tn)=>tn.readelem(sn));et&&_e.checkByteCount(et,`branch ${this.typename}`)}):(console.error(`failed to create streamer for element ${O.typename} ${O.name} element ${oe._typename} STL type ${oe.fSTLtype}`),O.func=function(_e,Oe){const $e=_e.readVersion();_e.checkByteCount($e),Oe[this.name]=null});break}default:console.error(`fail to provide function for ${oe.fName} (${oe.fTypeName})  typ = ${oe.fType}`),O.func=function(){}}return O}function ss(oe){if(oe===x.clTString||"string"===oe||yn[oe]===x.clTString)return 0;if(oe.length<7||0!==oe.indexOf("TArray"))return-1;if(7===oe.length)switch(oe[6]){case"I":return Y;case"D":return B;case"F":return Q;case"S":return J;case"C":return F;case"L":return ue;default:return-1}return"TArrayL64"===oe?I:-1}function Bs(oe,D){if(null===D)return D;const O=(0,x.getMethods)(oe);if(O)for(const ie in O)((0,x.isFunc)(O[ie])||0===ie.indexOf("_"))&&D.push({name:ie,method:O[ie],func(_e,Oe){Oe[this.name]=this.method}});return D}const yo=32768,xt=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],ge=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],ye=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],Pe=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],At=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];function Vt(oe,D){const O=new Array(2*yo),ie=oe,_e=oe.byteLength;let et,it,yt,at,ht,Qt,Oe=0,$e=null,sn=0,tn=0,xn=-1,wn=!1,Ut=0,Qe=0,nt=null,vn=0;function en(Vs){for(;tn<Vs;)vn<_e&&(sn|=ie[vn++]<<tn),tn+=8}function jt(Vs){return sn&xt[Vs]}function fn(Vs){sn>>=Vs,tn-=Vs}function Gn(Vs,un,di,Rt,ui,Pn){const Fn={status:0,root:null,m:0},gs=Array(17).fill(0),Qr=Array(17).fill(0),ro=Array(16).fill(null),Zs=Array(288).fill(0),qi=Array(17).fill(0),Uo={e:0,b:0,n:0,t:null},ra=un>256?Vs[256]:16;let jh,rc,Au,Io,$l,Td,Bi,mc,ll,sc,Ju,ic=null,hd=Vs,fd=0,eh=null,tl=un;do{gs[hd[fd++]]++}while(--tl>0);if(gs[0]===un)return Fn;for(Io=1;Io<=16&&0===gs[Io];++Io);for($l=Io,Pn<Io&&(Pn=Io),tl=16;0!==tl&&0===gs[tl];--tl);const $o=tl;for(Pn>tl&&(Pn=tl),ll=1<<Io;Io<tl;++Io,ll<<=1)if((ll-=gs[Io])<0)return Fn.status=2,Fn.m=Pn,Fn;if((ll-=gs[tl])<0)return Fn.status=2,Fn.m=Pn,Fn;for(gs[tl]+=ll,qi[1]=Io=0,hd=gs,fd=1,mc=2;--tl>0;)qi[mc++]=Io+=hd[fd++];hd=Vs,fd=0,tl=0;do{0!==(Io=hd[fd++])&&(Zs[qi[Io]++]=tl)}while(++tl<un);for(un=qi[$o],qi[0]=tl=0,hd=Zs,fd=0,Au=-1,Bi=Qr[0]=0,Td=null,sc=0;$l<=$o;++$l)for(jh=gs[$l];jh-- >0;){for(;$l>Bi+Qr[1+Au];){if(Bi+=Qr[1+Au++],sc=(sc=$o-Bi)>Pn?Pn:sc,(rc=1<<(Io=$l-Bi))>jh+1)for(rc-=jh+1,mc=$l;++Io<sc&&!((rc<<=1)<=gs[++mc]);)rc-=gs[mc];for(Bi+Io>ra&&Bi<ra&&(Io=ra-Bi),sc=1<<Io,Qr[1+Au]=Io,Td=new Array(sc),Ju=0;Ju<sc;++Ju)Td[Ju]={e:0,b:0,n:0,t:null};eh=null==eh?Fn.root={next:null,list:null}:eh.next={next:null,list:null},eh.next=null,eh.list=Td,ro[Au]=Td,Au>0&&(qi[Au]=tl,Uo.b=Qr[Au],Uo.e=16+Io,Uo.t=Td,Io=(tl&(1<<Bi)-1)>>Bi-Qr[Au],ic=ro[Au-1][Io],ic.e=Uo.e,ic.b=Uo.b,ic.n=Uo.n,ic.t=Uo.t)}for(Uo.b=$l-Bi,fd>=un?Uo.e=99:hd[fd]<di?(Uo.e=hd[fd]<256?16:15,Uo.n=hd[fd++]):(Uo.e=ui[hd[fd]-di],Uo.n=Rt[hd[fd++]-di]),rc=1<<$l-Bi,Io=tl>>Bi;Io<sc;Io+=rc)ic=Td[Io],ic.e=Uo.e,ic.b=Uo.b,ic.n=Uo.n,ic.t=Uo.t;for(Io=1<<$l-1;tl&Io;Io>>=1)tl^=Io;for(tl^=Io;(tl&(1<<Bi)-1)!==qi[Au];)Bi-=Qr[Au--]}return Fn.m=Qr[1],Fn.status=0!==ll&&1!==$o?1:0,Fn}function qn(Vs,un,di){if(0===di)return 0;let Rt,ui,Pn=0;for(;;){for(en(ht),ui=nt.list[jt(ht)],Rt=ui.e;Rt>16;){if(99===Rt)return-1;fn(ui.b),Rt-=16,en(Rt),ui=ui.t[jt(Rt)],Rt=ui.e}if(fn(ui.b),16!==Rt){if(15===Rt)break;for(en(Rt),Ut=ui.n+jt(Rt),fn(Rt),en(Qt),ui=at.list[jt(Qt)],Rt=ui.e;Rt>16;){if(99===Rt)return-1;fn(ui.b),Rt-=16,en(Rt),ui=ui.t[jt(Rt)],Rt=ui.e}for(fn(ui.b),en(Rt),Qe=Oe-ui.n-jt(Rt),fn(Rt);Ut>0&&Pn<di;)--Ut,Qe&=yo-1,Oe&=yo-1,Vs[un+Pn++]=O[Oe++]=O[Qe++];if(Pn===di)return di}else if(Oe&=yo-1,Vs[un+Pn++]=O[Oe++]=ui.n,Pn===di)return di}return xn=-1,Pn}function Vi(Vs,un,di){let Rt=7&tn;if(fn(Rt),en(16),Rt=jt(16),fn(16),en(16),Rt!==(65535&~sn))return-1;for(fn(16),Ut=Rt,Rt=0;Ut>0&&Rt<di;)--Ut,Oe&=yo-1,en(8),Vs[un+Rt++]=O[Oe++]=jt(8),fn(8);return 0===Ut&&(xn=-1),Rt}function _r(Vs,un,di){if(null==$e){const Rt=Array(288).fill(8,0,144).fill(9,144,256).fill(7,256,280).fill(8,280,288);it=7;let ui=Gn(Rt,288,257,K,ge,it);if(0!==ui.status)throw new Error("HufBuild error: "+ui.status);if($e=ui.root,it=ui.m,Rt.fill(5,0,30),yt=5,ui=Gn(Rt,30,0,ye,Pe,yt),ui.status>1)throw $e=null,new Error("HufBuild error: "+ui.status);et=ui.root,yt=ui.m}return nt=$e,at=et,ht=it,Qt=yt,qn(Vs,un,di)}function Ni(Vs,un,di){let Rt,ui,Pn,Fn,_i;const Dr=new Array(316).fill(0);en(5);const gs=257+jt(5);fn(5),en(5);const Qr=1+jt(5);fn(5),en(4);const ro=4+jt(4);if(fn(4),gs>286||Qr>30)return-1;for(ui=0;ui<ro;++ui)en(3),Dr[At[ui]]=jt(3),fn(3);for(;ui<19;++ui)Dr[At[ui]]=0;if(ht=7,_i=Gn(Dr,19,19,null,null,ht),0!==_i.status)return-1;nt=_i.root,ht=_i.m;const Zs=gs+Qr;for(Rt=Pn=0;Rt<Zs;)if(en(ht),Fn=nt.list[jt(ht)],ui=Fn.b,fn(ui),ui=Fn.n,ui<16)Dr[Rt++]=Pn=ui;else if(16===ui){if(en(2),ui=3+jt(2),fn(2),Rt+ui>Zs)return-1;for(;ui-- >0;)Dr[Rt++]=Pn}else if(17===ui){if(en(3),ui=3+jt(3),fn(3),Rt+ui>Zs)return-1;for(;ui-- >0;)Dr[Rt++]=0;Pn=0}else{if(en(7),ui=11+jt(7),fn(7),Rt+ui>Zs)return-1;for(;ui-- >0;)Dr[Rt++]=0;Pn=0}if(ht=9,_i=Gn(Dr,gs,257,K,ge,ht),0===ht&&(_i.status=1),0!==_i.status)return-1;for(nt=_i.root,ht=_i.m,Rt=0;Rt<Qr;++Rt)Dr[Rt]=Dr[Rt+gs];return Qt=6,_i=Gn(Dr,Qr,0,ye,Pe,Qt),at=_i.root,Qt=_i.m,0===Qt&&gs>257||0!==_i.status?-1:qn(Vs,un,di)}function Kr(Vs,un,di){let ui,Rt=0;for(;Rt<di;){if(wn&&-1===xn)return Rt;if(Ut>0){if(0!==xn)for(;Ut>0&&Rt<di;)--Ut,Qe&=yo-1,Oe&=yo-1,Vs[un+Rt++]=O[Oe++]=O[Qe++];else{for(;Ut>0&&Rt<di;)--Ut,Oe&=yo-1,en(8),Vs[un+Rt++]=O[Oe++]=jt(8),fn(8);0===Ut&&(xn=-1)}if(Rt===di)return Rt}if(-1===xn){if(wn)break;en(1),0!==jt(1)&&(wn=!0),fn(1),en(2),xn=jt(2),fn(2),nt=null,Ut=0}switch(xn){case 0:ui=Vi(Vs,un+Rt,di-Rt);break;case 1:ui=null!=nt?qn(Vs,un+Rt,di-Rt):_r(Vs,un+Rt,di-Rt);break;case 2:ui=null!=nt?qn(Vs,un+Rt,di-Rt):Ni(Vs,un+Rt,di-Rt);break;default:ui=-1}if(-1===ui)return wn?0:-1;Rt+=ui}return Rt}let os,ia=0;for(;(os=Kr(D,ia,Math.min(1024,D.byteLength-ia)))>0;)ia+=os;return ia}function Nt(oe,D,O,ie){let _e=0;for(let Oe=O=O||0,$e=ie=ie||oe.length-O;Oe<$e;){const et=oe[Oe++];let it=et>>4;if(it>0){let Ut=it+240;for(;255===Ut;)Ut=oe[Oe++],it+=Ut;const Qe=Oe+it;for(;Oe<Qe;)D[_e++]=oe[Oe++];if(Oe===$e)return _e}const yt=oe[Oe++]|oe[Oe++]<<8;if(0===yt||yt>_e)return-(Oe-2);let sn=15&et,tn=sn+240;for(;255===tn;)tn=oe[Oe++],sn+=tn;let xn=_e-yt;const wn=_e+sn+4;for(;_e<wn;)D[_e++]=D[xn++]}return _e}function nn(oe,D,O,ie){return hn.apply(this,arguments)}function hn(){return(hn=(0,Ee.A)(function*(oe,D,O,ie){const Oe=oe.byteLength,$e=(xn,wn)=>String.fromCharCode(oe.getUint8(xn))===wn,et=xn=>oe.getUint8(xn);let it=ie||0,yt=0,sn=null;const tn=()=>{for(;yt<D;){let xn="unknown",wn=0,Ut=0;if(it+9>=Oe)return O||console.error("Error R__unzip: header size exceeds buffer size"),Promise.resolve(null);if($e(it,"Z")&&$e(it+1,"L")&&8===et(it+2)?(xn="new",wn=2):$e(it,"C")&&$e(it+1,"S")&&8===et(it+2)?(xn="old",wn=0):$e(it,"X")&&$e(it+1,"Z")&&0===et(it+2)?(xn="LZMA",wn=0):$e(it,"Z")&&$e(it+1,"S")&&1===et(it+2)?xn="ZSTD":$e(it,"L")&&$e(it+1,"4")&&(xn="LZ4",wn=0,Ut=8),"new"!==xn&&"old"!==xn&&"LZ4"!==xn&&"ZSTD"!==xn&&"LZMA"!==xn)return O||console.error(`R__unzip: ${xn} format is not supported!`),Promise.resolve(null);const Qe=9+(255&et(it+3)|(255&et(it+4))<<8|(255&et(it+5))<<16),nt=new Uint8Array(oe.buffer,oe.byteOffset+it+9+wn+Ut,Math.min(oe.byteLength-it-9-wn-Ut,Qe-9-Ut));sn||(sn=new ArrayBuffer(D));const at=new Uint8Array(sn,yt);if("ZSTD"===xn)return(x.internals._ZstdStream?Promise.resolve(x.internals._ZstdStream):((0,x.isNodeJs)()?Se.e(817).then(Se.t.bind(Se,9817,19)):import("./base/zstd.mjs")).then(({ZstdInit:vn})=>vn()).then(({ZstdStream:vn})=>(x.internals._ZstdStream=vn,vn))).then(vn=>{const en=vn.decompress(nt),jt=en.length;for(let fn=0;fn<jt;++fn)at[fn]=en[fn];return yt+=jt,it+=Qe,tn()});if("LZMA"===xn)return import("./base/lzma.mjs").then(Qt=>{const vn=255&et(it+6)|(255&et(it+7))<<8|(255&et(it+8))<<16,en=Qt.decompress(nt,at,vn);return yt+=en,it+=Qe,tn()});const ht="LZ4"===xn?Nt(nt,at):Vt(nt,at);if(ht<=0)break;yt+=ht,it+=Qe}return yt!==D?(O||console.error(`R__unzip: fail to unzip data expects ${D}, got ${yt}`),Promise.resolve(null)):Promise.resolve(new DataView(sn))};return tn()})).apply(this,arguments)}class kn{constructor(D,O,ie,_e){this._typename="TBuffer",this.arr=D,this.o=O||0,this.fFile=ie,this.length=_e||(D?D.byteLength:0),this.clearObjectMap(),this.fTagOffset=0,this.last_read_version=0}locate(D){this.o=D}shift(D){this.o+=D}remain(){return this.length-this.o}getMappedObject(D){return this.fObjectMap[D]}mapObject(D,O){null!==O&&(this.fObjectMap[D]=O)}mapClass(D,O){this.fClassMap[D]=O}getMappedClass(D){return D in this.fClassMap?this.fClassMap[D]:-1}clearObjectMap(){this.fObjectMap={},this.fClassMap={},this.fObjectMap[0]=null,this.fDisplacement=0}readVersion(){const D={},O=this.ntou4();return O&tt?D.bytecnt=O-tt-2:this.o-=4,this.last_read_version=D.val=this.ntoi2(),this.last_read_checksum=0,D.off=this.o,D.val<=0&&D.bytecnt&&D.bytecnt>=4&&(D.checksum=this.ntou4(),this.fFile.findStreamerInfo(void 0,void 0,D.checksum)?this.last_read_checksum=D.checksum:(this.o-=4,delete D.checksum)),D}checkByteCount(D,O){return void 0===D.bytecnt||D.off+D.bytecnt===this.o||(O&&console.log(`Missmatch in ${O} bytecount expected = ${D.bytecnt}  got = ${this.o-D.off}`),this.o=D.off+D.bytecnt,!1)}readTString(){let D=this.ntou1();if(255===D&&(D=this.ntou4()),0===D)return"";const O=this.o;return this.o+=D,0===this.codeAt(O)?"":this.substring(O,O+D)}readFastString(D){let ie,O="",_e=!1;for(let Oe=0;(D<0||Oe<D)&&(ie=this.ntou1(),!(0===ie&&(_e=!0,D<0)));++Oe)_e||(O+=String.fromCharCode(ie));return O}ntou1(){return this.arr.getUint8(this.o++)}ntou2(){const D=this.o;return this.o+=2,this.arr.getUint16(D)}ntou4(){const D=this.o;return this.o+=4,this.arr.getUint32(D)}ntou8(){const D=this.arr.getUint32(this.o);this.o+=4;const O=this.arr.getUint32(this.o);return this.o+=4,D<2097152?4294967296*D+O:BigInt(D)*BigInt(4294967296)+BigInt(O)}ntoi1(){return this.arr.getInt8(this.o++)}ntoi2(){const D=this.o;return this.o+=2,this.arr.getInt16(D)}ntoi4(){const D=this.o;return this.o+=4,this.arr.getInt32(D)}ntoi8(){const D=this.arr.getUint32(this.o);this.o+=4;const O=this.arr.getUint32(this.o);return this.o+=4,D<2147483648?D<2097152?4294967296*D+O:BigInt(D)*BigInt(4294967296)+BigInt(O):~D<2097152?-1-(4294967296*~D+~O):BigInt(-1)-(BigInt(~D)*BigInt(4294967296)+BigInt(~O))}ntof(){const D=this.o;return this.o+=4,this.arr.getFloat32(D)}ntod(){const D=this.o;return this.o+=8,this.arr.getFloat64(D)}readFastArray(D,O){let ie,_e=0,Oe=this.o;const $e=this.arr;switch(O){case B:for(ie=new Float64Array(D);_e<D;++_e,Oe+=8)ie[_e]=$e.getFloat64(Oe);break;case Q:for(ie=new Float32Array(D);_e<D;++_e,Oe+=4)ie[_e]=$e.getFloat32(Oe);break;case ue:case I:for(ie=new Array(D);_e<D;++_e)ie[_e]=this.ntoi8();return ie;case f:case U:for(ie=new Array(D);_e<D;++_e)ie[_e]=this.ntou8();return ie;case Y:case me:for(ie=new Int32Array(D);_e<D;++_e,Oe+=4)ie[_e]=$e.getInt32(Oe);break;case J:for(ie=new Int16Array(D);_e<D;++_e,Oe+=2)ie[_e]=$e.getInt16(Oe);break;case g:for(ie=new Uint16Array(D);_e<D;++_e,Oe+=2)ie[_e]=$e.getUint16(Oe);break;case F:for(ie=new Int8Array(D);_e<D;++_e)ie[_e]=$e.getInt8(Oe++);break;case k:case E:for(ie=new Uint8Array(D);_e<D;++_e)ie[_e]=$e.getUint8(Oe++);break;case W:for(ie=new Array(D);_e<D;++_e)ie[_e]=this.readTString();return ie;case $:throw new Error("kDouble32 should not be used in readFastArray");case Z:throw new Error("kFloat16 should not be used in readFastArray");default:for(ie=new Uint32Array(D);_e<D;++_e,Oe+=4)ie[_e]=$e.getUint32(Oe)}return this.o=Oe,ie}canExtract(D){for(let O=0;O<D.length;O+=2)if(D[O]+D[O+1]>this.length)return!1;return!0}extract(D){if(!this.arr||!this.arr.buffer||!this.canExtract(D))return null;if(2===D.length)return new DataView(this.arr.buffer,this.arr.byteOffset+D[0],D[1]);const O=new Array(D.length/2);for(let ie=0;ie<D.length;ie+=2)O[ie/2]=new DataView(this.arr.buffer,this.arr.byteOffset+D[ie],D[ie+1]);return O}codeAt(D){return this.arr.getUint8(D)}substring(D,O){let ie="";for(let _e=D;_e<O;++_e)ie+=String.fromCharCode(this.arr.getUint8(_e));return ie}readNdimArray(D,O){let Oe,ie=D.fArrayDim,_e=D.fMaxIndex;if(ie<1&&D.fArrayLength>0&&(ie=1,_e=[D.fArrayLength]),D.minus1&&--ie,ie<1)return O(this,D);if(1===ie){Oe=new Array(_e[0]);for(let $e=0;$e<_e[0];++$e)Oe[$e]=O(this,D)}else if(2===ie){Oe=new Array(_e[0]);for(let $e=0;$e<_e[0];++$e){const et=new Array(_e[1]);for(let it=0;it<_e[1];++it)et[it]=O(this,D);Oe[$e]=et}}else{const $e=new Array(ie).fill(0),et=new Array(ie);for(let it=0;it<ie;++it)et[it]=[];for(Oe=et[0];$e[0]<_e[0];){let it=ie-1;for(et[it].push(O(this,D)),++$e[it];$e[it]===_e[it]&&it>0;)$e[it]=0,et[it-1].push(et[it]),et[it]=[],++$e[--it]}}return Oe}readTKey(D){D||(D={}),this.classStreamer(D,x.clTKey);const O=D.fName.replace(/['"]/g,"");return O!==D.fName&&(D.fRealName=D.fName,D.fName=O),D}readBasketEntryOffset(D,O){if(this.locate(D.fLast-O),this.remain()<=0)return!D.fEntryOffset&&D.fNevBuf<=1&&(D.fEntryOffset=[D.fKeylen]),void(D.fEntryOffset||console.warn(`No fEntryOffset when expected for basket with ${D.fNevBuf} entries`));const ie=this.ntoi4();if(ie<0||ie>4*this.remain())return console.error(`Error when reading entries offset from basket fNevBuf ${D.fNevBuf} remains ${this.remain()} want to read ${ie}`),void(D.fNevBuf<=1&&(D.fEntryOffset=[D.fKeylen]));D.fEntryOffset=this.readFastArray(ie,Y),D.fEntryOffset||(D.fEntryOffset=[D.fKeylen]),D.fDisplacement=this.remain()>0?this.readFastArray(this.ntoi4(),Y):void 0}readClass(){const D={name:-1},O=this.ntou4(),ie=this.o;let _e;if(_e=O&tt&&O!==Fe?this.ntou4():O,!(_e&Ne))return D.objtag=_e+this.fDisplacement,D;if(_e===Fe)D.name=this.readFastString(-1),-1===this.getMappedClass(this.fTagOffset+ie+2)&&this.mapClass(this.fTagOffset+ie+2,D.name);else{const Oe=(_e&~Ne)+this.fDisplacement;D.name=this.getMappedClass(Oe),-1===D.name&&console.error(`Did not found class with tag ${Oe}`)}return D}readObjectAny(){const D=this.fTagOffset+this.o+2,O=this.readClass();if("objtag"in O)return this.getMappedObject(O.objtag);if(-1===O.name)return null;const ie=ss(O.name);let _e;return 0===ie?_e=this.readTString():ie>0?(_e=this.readFastArray(this.ntou4(),ie),this.mapObject(D,_e)):(_e={},this.mapObject(D,_e),this.classStreamer(_e,O.name)),_e}classStreamer(D,O){void 0===D._typename&&(D._typename=O);const ie=ii[O];if(ie)return ie(this,D),D;const _e=this.readVersion(),Oe=this.fFile.getStreamer(O,_e);if(null!==Oe){const $e=Oe.length;for(let et=0;et<$e;++et)Oe[et].func(this,D)}else(0,x.addMethods)(D);return this.checkByteCount(_e,O),D}}class dn{constructor(D,O,ie){this.fFile=D,this._typename=Ye,this.dir_name=O,this.dir_cycle=ie,this.fKeys=[]}getKey(D,O,ie){"number"!=typeof O&&(O=-1);let _e=null;for(let $e=0;$e<this.fKeys.length;++$e){const et=this.fKeys[$e];if(et&&et.fName===D){if(et.fCycle===O){_e=et;break}O<0&&(!_e||et.fCycle>_e.fCycle)&&(_e=et)}}if(_e)return ie?_e:Promise.resolve(_e);let Oe=D.lastIndexOf("/");for(;Oe>0;){const $e=D.slice(0,Oe),et=D.slice(Oe+1),it=this.getKey($e,void 0,!0);if(it&&!ie&&0===it.fClassName.indexOf(Ye))return this.fFile.readObject(this.dir_name+"/"+$e,1).then(yt=>yt.getKey(et,O));Oe=D.lastIndexOf("/",Oe-1)}return ie?null:Promise.reject(Error(`Key not found ${D}`))}readObject(D,O){return this.fFile.readObject(this.dir_name+"/"+D,O)}readKeys(D){var O=this;return(0,Ee.A)(function*(){return D.classStreamer(O,Ye),O.fSeekKeys<=0||O.fNbytesKeys<=0?O:O.fFile.readBuffer([O.fSeekKeys,O.fNbytesKeys]).then(ie=>{const _e=new kn(ie,0,O.fFile);_e.readTKey();const Oe=_e.ntoi4();for(let $e=0;$e<Oe;++$e)O.fKeys.push(_e.readTKey());return O.fFile.fDirectories.push(O),O})})()}}class In{constructor(D){if(this._typename=x.clTFile,this.fEND=0,this.fFullURL=D,this.fURL=D,this.fAcceptRanges=!0,this.fUseStampPar=!!x.settings.UseStamp&&"stamp="+(new Date).getTime(),this.fFileContent=null,this.fMaxRanges=x.settings.MaxRanges||200,this.fDirectories=[],this.fKeys=[],this.fSeekInfo=0,this.fNbytesInfo=0,this.fTagOffset=0,this.fStreamers=0,this.fStreamerInfos=null,this.fFileName="",this.fStreamers=[],this.fBasicTypes={},!(0,x.isStr)(this.fURL))return this;"+"===this.fURL[this.fURL.length-1]&&(this.fURL=this.fURL.slice(0,this.fURL.length-1),this.fAcceptRanges=!1),"^"===this.fURL[this.fURL.length-1]&&(this.fURL=this.fURL.slice(0,this.fURL.length-1),this.fSkipHeadRequest=!0),"-"===this.fURL[this.fURL.length-1]&&(this.fURL=this.fURL.slice(0,this.fURL.length-1),this.fUseStampPar=!1),0===this.fURL.indexOf("file://")&&(this.fUseStampPar=!1,this.fAcceptRanges=!1);const O=Math.max(this.fURL.lastIndexOf("/"),this.fURL.lastIndexOf("\\"));this.fFileName=O>=0?this.fURL.slice(O+1):this.fURL}assignFileContent(D){this.fFileContent=new kn(new DataView(D)),this.fAcceptRanges=!1,this.fUseStampPar=!1,this.fEND=this.fFileContent.length}_open(){var D=this;return(0,Ee.A)(function*(){return D.readKeys()})()}readBuffer(D,O,ie){var _e=this;return(0,Ee.A)(function*(){if(null!==_e.fFileContent&&!O&&(!_e.fAcceptRanges||_e.fFileContent.canExtract(D)))return _e.fFileContent.extract(D);let Oe,$e;const et=_e,it=0===D[0]&&2===D.length,yt=[],sn=new Promise((ht,Qt)=>{Oe=ht,$e=Qt});let Ut,Qe,tn=et.fURL,xn=0,wn=0,nt=!1;if((0,x.isStr)(O)&&O){const ht=tn.lastIndexOf("/");tn=ht<0?O:tn.slice(0,ht+1)+O}function at(ht){if(ht&&(xn=wn,wn=Math.min(xn+2*et.fMaxRanges,D.length),xn>=D.length))return Oe(yt);let Qt=tn,vn="bytes",en=0;et.fUseStampPar&&(Qt+=(Qt.indexOf("?")<0?"?":"&")+et.fUseStampPar);for(let jt=xn;jt<wn;jt+=2)vn+=(jt>xn?",":"=")+`${D[jt]}-${D[jt]+D[jt+1]-1}`,en+=D[jt+1];return wn-xn>2&&(en+=60*(wn-xn)),et.fAcceptRanges&&it&&(en=Math.max(en,1e7)),(0,x.createHttpRequest)(Qt,"buf",Ut,void 0,!0).then(jt=>{if(et.fAcceptRanges&&(jt.setRequestHeader("Range",vn),jt.expected_size=Math.max(Math.round(1.1*en),en+200)),(0,x.isFunc)(ie)&&(0,x.isFunc)(jt.addEventListener)){let fn=0,Gn=0,qn=0;for(let Ni=1;Ni<D.length;Ni+=2)qn+=D[Ni],Ni<xn&&(fn+=D[Ni]),Ni<wn&&(Gn+=D[Ni]);qn||(qn=1);const Vi=fn/qn,_r=(Gn-fn)/qn;jt.addEventListener("progress",Ni=>{Ni.lengthComputable&&"break"===ie(Vi+_r*Ni.loaded/Ni.total)&&jt.abort()})}else nt&&(0,x.isFunc)(jt.addEventListener)&&jt.addEventListener("progress",fn=>{fn.total?fn.total>5e7&&(console.error(`Try to load very large file ${fn.total} at once - abort`),jt.abort()):console.warn("Fail to get file size information")});Qe=it?jt:null,jt.send(null)})}return Ut=function(ht){if(!ht&&it){if(et.fUseStampPar)return et.fUseStampPar=!1,at();if(et.fAcceptRanges)return et.fAcceptRanges=!1,nt=!0,at()}if(ht&&Qe){if(et.fAcceptRanges&&!Qe.getResponseHeader("Accept-Ranges")&&(et.fAcceptRanges=!1,ht?.byteLength===D[1]))return console.warn(`First block is ${D[1]} bytes but browser does not provides access to header - try to read full file`),nt=!0,at();const Vi=x.browser.isFirefox?Qe.getResponseHeader("Server"):"";(0,x.isStr)(Vi)&&0===Vi.indexOf("SimpleHTTP")&&(et.fMaxRanges=1,et.fUseStampPar=!1)}if(ht&&it&&!et.fFileContent)return et.fFileContent=new kn((0,x.isStr)(ht)?ht:new DataView(ht)),et.fAcceptRanges||(et.fEND=et.fFileContent.length),Oe(et.fFileContent.extract(D));if(!ht)return 0===xn&&wn>2&&et.fMaxRanges>1?(et.fMaxRanges=wn/2>200?200:wn/2>50?50:wn/2>20?20:wn/2>5?5:1,wn=Math.min(wn,2*et.fMaxRanges),at()):$e(Error("Fail to read with several ranges"));if(wn-xn==2){const Vi=new DataView(ht);return 2===D.length?Oe(Vi):(yt.push(Vi),at(!0))}const Qt=this.getResponseHeader("Content-Type"),vn=(0,x.isStr)(Qt)&&Qt.indexOf("multipart")>=0,en=new DataView(ht);if(!vn){const Vi=this.getResponseHeader("Content-Range");let _r=0,Ni=-1;if((0,x.isStr)(Vi)&&Vi.indexOf("bytes")>=0){const os=Vi.slice(Vi.indexOf("bytes")+6).split(/[\s-/]+/);3===os.length&&(_r=parseInt(os[0]),Ni=parseInt(os[1]),(!Number.isInteger(_r)||!Number.isInteger(Ni)||_r>Ni)&&(_r=0,Ni=-1))}let Kr=_r<=Ni;for(let os=xn;os<wn;os+=2)(D[os]<_r||D[os]+D[os+1]-1>Ni)&&(Kr=!1);if(Kr){for(let os=xn;os<wn;os+=2)yt.push(new DataView(ht,D[os]-_r,D[os+1]));return at(!0)}return 1===et.fMaxRanges||0!==xn?$e(Error("Server returns normal response when multipart was requested, disable multirange support")):(et.fMaxRanges=1,wn=Math.min(wn,2*et.fMaxRanges),at())}const jt=Qt.indexOf("boundary=");let fn="",Gn=xn,qn=0;for(jt>0?(fn=Qt.slice(jt+9),'"'===fn[0]&&'"'===fn[fn.length-1]&&(fn=fn.slice(1,fn.length-1)),fn="--"+fn):console.error("Did not found boundary id in the response header");Gn<wn;){let Vi,_r=en.getUint8(qn),Ni=0,Kr="",os=!1,ia=0,Vs=-1;for(;qn<en.byteLength-1&&!os&&Ni<5;){if(Vi=_r,_r=en.getUint8(qn+1),13===Vi&&10===_r||10===Vi){if(Kr.length>2&&"--"===Kr.slice(0,2)&&Kr!==fn)return $e(Error(`Decode multipart message, expect boundary ${fn} got ${Kr}`));if(Kr=Kr.toLowerCase(),Kr.indexOf("content-range")>=0&&Kr.indexOf("bytes")>0){const un=Kr.slice(Kr.indexOf("bytes")+6).split(/[\s-/]+/);3===un.length?(ia=parseInt(un[0]),Vs=parseInt(un[1]),(!Number.isInteger(ia)||!Number.isInteger(Vs)||ia>Vs)&&(ia=0,Vs=-1)):console.error(`Fail to decode content-range ${Kr} ${un}`)}Ni>1&&0===Kr.length&&(os=!0),Ni++,Kr="",10!==Vi&&(qn++,_r=en.getUint8(qn+1))}else Kr+=String.fromCharCode(Vi);qn++}if(!os)return $e(Error("Cannot decode header in multipart message"));if(ia>Vs)yt.push(new DataView(ht,qn,D[Gn+1])),qn+=D[Gn+1],Gn+=2;else{for(;Gn<wn&&D[Gn]>=ia&&D[Gn]+D[Gn+1]-1<=Vs;)yt.push(new DataView(ht,qn+D[Gn]-ia,D[Gn+1])),Gn+=2;qn+=Vs-ia+1}}at(!0)},at(!0).then(()=>sn)})()}getFileName(){return this.fFileName}getDir(D,O){if(void 0===O&&(0,x.isStr)(D)){const ie=D.lastIndexOf(";");ie>0&&(O=parseInt(D.slice(ie+1)),D=D.slice(0,ie))}for(let ie=0;ie<this.fDirectories.length;++ie){const _e=this.fDirectories[ie];if(_e.dir_name===D&&(void 0===O||_e.dir_cycle===O))return _e}return null}getKey(D,O,ie){"number"!=typeof O&&(O=-1);let _e=null;for(let $e=0;$e<this.fKeys.length;++$e){const et=this.fKeys[$e];if(et&&et.fName===D){if(et.fCycle===O){_e=et;break}O<0&&(!_e||et.fCycle>_e.fCycle)&&(_e=et)}}if(_e)return ie?_e:Promise.resolve(_e);let Oe=D.lastIndexOf("/");for(;Oe>0;){const $e=D.slice(0,Oe),et=D.slice(Oe+1),it=this.getDir($e);if(it)return it.getKey(et,O,ie);const yt=this.getKey($e,void 0,!0);if(yt&&!ie&&0===yt.fClassName.indexOf(Ye))return this.readObject($e).then(sn=>sn.getKey(et,O));Oe=D.lastIndexOf("/",Oe-1)}return ie?null:Promise.reject(Error(`Key not found ${D}`))}readObjBuffer(D){var O=this;return(0,Ee.A)(function*(){return O.readBuffer([D.fSeekKey+D.fKeylen,D.fNbytes-D.fKeylen]).then(ie=>{if(D.fObjlen<=D.fNbytes-D.fKeylen){const _e=new kn(ie,0,O);return _e.fTagOffset=D.fKeylen,_e}return nn(ie,D.fObjlen).then(_e=>{if(!_e)return Promise.reject(Error(`Fail to UNZIP buffer for ${D.fName}`));const Oe=new kn(_e,0,O);return Oe.fTagOffset=D.fKeylen,Oe})})})()}readObject(D,O,ie){var _e=this;return(0,Ee.A)(function*(){const Oe=D.lastIndexOf(";");for(Oe>0&&(O=parseInt(D.slice(Oe+1)),D=D.slice(0,Oe)),"number"!=typeof O&&(O=-1);D.length&&"/"===D[0];)D=D.slice(1);return _e.getKey(D,O).then($e=>{if(D===De&&$e.fClassName===x.clTList)return _e.fStreamerInfos;let et=!1;if($e.fClassName===Ye||$e.fClassName===Ze){const it=_e.getDir(D,O);if(it)return it;et=!0}return!et&&ie?Promise.reject(Error(`Key ${D} is not directory}`)):_e.readObjBuffer($e).then(it=>{if(et){const sn=new dn(_e,D,O);return sn.fTitle=$e.fTitle,sn.readKeys(it)}const yt={};return it.mapObject(1,yt),it.classStreamer(yt,$e.fClassName),$e.fClassName===x.clTF1||$e.fClassName===x.clTF2?_e._readFormulas(yt):yt})})})()}_readFormulas(D){var O=this;return(0,Ee.A)(function*(){const ie=[];for(let _e=0;_e<O.fKeys.length;++_e)"TFormula"===O.fKeys[_e].fClassName&&ie.push(O.readObject(O.fKeys[_e].fName,O.fKeys[_e].fCycle));return Promise.all(ie).then(_e=>(_e.forEach(Oe=>D.addFormula(Oe)),D))})()}extractStreamerInfos(D){if(!D)return;const O={};D.mapObject(1,O);try{D.classStreamer(O,x.clTList)}catch(ie){return void console.error("Fail extract streamer infos",ie)}O._typename=ot,this.fStreamerInfos=O,(0,x.isFunc)(x.internals.addStreamerInfosForPainter)&&x.internals.addStreamerInfosForPainter(O);for(let ie=0;ie<O.arr.length;++ie){const _e=O.arr[ie];if(_e.fElements)for(let Oe=0;Oe<_e.fElements.arr.length;++Oe){const $e=_e.fElements.arr[Oe];if(!$e.fTypeName||!$e.fType)continue;let et=$e.fType,it=$e.fTypeName;if(et>=60){if(et===bt&&$e._typename===ke&&$e.fSTLtype&&$e.fCtype&&$e.fCtype<20){const sn=(Dn[$e.fSTLtype]||"undef")+"<";if(0===it.indexOf(sn)&&">"===it[it.length-1]&&(et=$e.fCtype,it=it.slice(sn.length,it.length-1).trim(),$e.fSTLtype===Yt||$e.fSTLtype===qt)){if(!(it.indexOf(",")>0))continue;it=it.slice(0,it.indexOf(",")).trim()}}if(et>=60)continue}else et>20&&"*"===it[it.length-1]&&(it=it.slice(0,it.length-1)),et%=20;const yt=ai(it);yt!==et&&(et===C&&yt===v||et===me&&yt===Y||it&&et&&this.fBasicTypes[it]!==et&&(this.fBasicTypes[it]=et))}}}readKeys(){var D=this;return(0,Ee.A)(function*(){return D.readBuffer([0,1024]).then(O=>{const ie=new kn(O,0,D);if("root"!==ie.substring(0,4))return Promise.reject(Error(`Not a ROOT file ${D.fURL}`));if(ie.shift(4),D.fVersion=ie.ntou4(),D.fBEGIN=ie.ntou4(),D.fVersion<1e6?(D.fEND=ie.ntou4(),D.fSeekFree=ie.ntou4(),D.fNbytesFree=ie.ntou4(),ie.shift(4),D.fNbytesName=ie.ntou4(),D.fUnits=ie.ntou1(),D.fCompress=ie.ntou4(),D.fSeekInfo=ie.ntou4(),D.fNbytesInfo=ie.ntou4()):(D.fEND=ie.ntou8(),D.fSeekFree=ie.ntou8(),D.fNbytesFree=ie.ntou4(),ie.shift(4),D.fNbytesName=ie.ntou4(),D.fUnits=ie.ntou1(),D.fCompress=ie.ntou4(),D.fSeekInfo=ie.ntou8(),D.fNbytesInfo=ie.ntou4()),!D.fSeekInfo||!D.fNbytesInfo)return Promise.reject(Error(`File ${D.fURL} does not provide streamer infos`));if(!D.fNbytesName||D.fNbytesName>1e5)return Promise.reject(Error(`Cannot read directory info of the file ${D.fURL}`));let _e=D.fNbytesName+22;return _e+=4,_e+=4,_e+=18,D.fVersion>=4e4&&(_e+=12),D.readBuffer([D.fBEGIN,Math.max(300,_e)])}).then(O=>{const ie=new kn(O,0,D);return D.fTitle=ie.readTKey().fTitle,ie.locate(D.fNbytesName),ie.classStreamer(D,Ye),D.fSeekKeys?D.readBuffer([D.fSeekKeys,D.fNbytesKeys,D.fSeekInfo,D.fNbytesInfo]):Promise.reject(Error(`Empty keys list in ${D.fURL}`))}).then(O=>{const ie=new kn(O[0],0,D);ie.readTKey();const _e=ie.ntoi4();for(let et=0;et<_e;++et)D.fKeys.push(ie.readTKey());const $e=new kn(O[1],0,D).readTKey();return $e?(D.fKeys.push($e),D.readObjBuffer($e)):Promise.reject(Error(`Fail to read StreamerInfo data in ${D.fURL}`))}).then(O=>(D.extractStreamerInfos(O),D))})()}readDirectory(D,O){var ie=this;return(0,Ee.A)(function*(){return ie.readObject(D,O,!0)})()}findStreamerInfo(D,O,ie){if(!this.fStreamerInfos)return null;const _e=this.fStreamerInfos.arr,Oe=_e.length;if(void 0!==ie){let $e=this.fStreamerInfos.cache;$e||($e=this.fStreamerInfos.cache={});let et=$e[ie];if(void 0!==et)return et;for(let it=0;it<Oe;++it)if(et=_e[it],et.fCheckSum===ie)return $e[ie]=et,et;$e[ie]=null}else for(let $e=0;$e<Oe;++$e){const et=_e[$e];if(et.fName===D&&(et.fClassVersion===O||void 0===O))return et}return null}getStreamer(D,O,ie){if("TQObject"===D||D===He)return null;let _e,Oe=D;if(O&&(Oe+=O.checksum?`$chksum${O.checksum}`:`$ver${O.val}`,_e=this.fStreamers[Oe],void 0!==_e))return _e;const $e=yn[D];if((0,x.isStr)($e))return this.getStreamer($e,O,ie);if((0,x.isFunc)($e))return _e=[{typename:D,func:$e}],Bs(D,_e);if(_e=[],(0,x.isObject)($e)){if(!$e.name&&!$e.func)return $e;_e.push($e)}if(ie||(ie=this.findStreamerInfo(D,O.val,O.checksum)),!ie)return delete this.fStreamers[Oe],O.nowarning||console.warn(`Not found streamer for ${D} ver ${O.val} checksum ${O.checksum} full ${Oe}`),null;if(ie.fName===x.clTStyle&&ie.fElements&&ie.fElements.arr.forEach(et=>{"fLineStyle"===et.fName&&(et.fName="fLineStyles")}),ie.fElements)for(let et=0;et<ie.fElements.arr.length;++et)_e.push(Nr(ie.fElements.arr[et],this));return this.fStreamers[Oe]=_e,Bs(D,_e)}getSplittedStreamer(D,O){if(!D)return O;O||(O=[]);for(let ie=0;ie<D.length;++ie){const _e=D[ie];if(void 0===_e.base){O.push(_e);continue}if(_e.basename===x.clTObject){O.push({func(et,it){et.ntoi2(),it.fUniqueID=et.ntou4(),it.fBits=et.ntou4(),it.fBits&$n&&et.ntou2()}});continue}const Oe={val:_e.base};4294967295===Oe.val&&(Oe.val=1);const $e=this.getStreamer(_e.basename,Oe);$e&&this.getSplittedStreamer($e,O)}return O}delete(){this.fDirectories=null,this.fKeys=null,this.fStreamers=null,this.fSeekInfo=0,this.fNbytesInfo=0,this.fTagOffset=0}}function Pi(oe){if(this.member_wise){const _e=oe.ntou4(),Oe=this.stl_version;let $e=null;if(0===_e)return[];if(_e>1e6)throw new Error(`member-wise streaming of ${this.conttype} num ${_e} member ${this.name}`);Oe.val===this.member_ver&&Oe.checksum===this.member_checksum?$e=this.member_streamer:($e=oe.fFile.getStreamer(this.conttype,Oe),this.member_streamer=$e=oe.fFile.getSplittedStreamer($e),this.member_ver=Oe.val,this.member_checksum=Oe.checksum);const et=new Array(_e);let it,yt,sn;for(it=0;it<_e;++it)et[it]={_typename:this.conttype};if($e)for(yt=0;yt<$e.length;++yt)if(sn=$e[yt],sn.split_func)sn.split_func(oe,et,_e);else for(it=0;it<_e;++it)sn.func(oe,et[it]);else console.error(`Fail to create split streamer for ${this.conttype} need to read ${_e} objects version ${Oe}`);return et}const D=oe.ntou4(),O=new Array(D);let ie=0;if(D>2e5)return console.error(`vector streaming for ${this.conttype} at ${D}`),O;if(this.arrkind>0)for(;ie<D;)O[ie++]=oe.readFastArray(oe.ntou4(),this.arrkind);else if(0===this.arrkind)for(;ie<D;)O[ie++]=oe.readTString();else if(this.isptr)for(;ie<D;)O[ie++]=oe.readObjectAny();else if(this.submember)for(;ie<D;)O[ie++]=this.submember.readelem(oe);else for(;ie<D;)O[ie++]=oe.classStreamer({},this.conttype);return O}function Si(oe){let D=this.streamer;if(this.member_wise){const _e=this.stl_version;if(this.si){const Oe=oe.fFile.findStreamerInfo(this.pairtype,_e.val,_e.checksum);if(this.si!==Oe&&(D=ti(Oe,this.pairtype,oe.fFile),!D||2!==D.length))return console.log(`Fail to produce streamer for ${this.pairtype}`),null}}const O=oe.ntoi4(),ie=new Array(O);this.member_wise&&oe.remain()>=6&&(oe.ntoi2()===rt?oe.shift(4):oe.shift(-2));for(let _e=0;_e<O;++_e)ie[_e]={_typename:this.pairtype},D[0].func(oe,ie[_e]),this.member_wise||D[1].func(oe,ie[_e]);if(this.member_wise){oe.remain()>=6&&(oe.ntoi2()===rt?oe.shift(4):oe.shift(-2));for(let _e=0;_e<O;++_e)D[1].func(oe,ie[_e])}return ie}class bi extends In{constructor(D){super(null),this.fUseStampPar=!1,this.fLocalFile=D,this.fEND=D.size,this.fFullURL=D.name,this.fURL=D.name,this.fFileName=D.name}_open(){var D=this;return(0,Ee.A)(function*(){return D.readKeys()})()}readBuffer(D,O){var ie=this;return(0,Ee.A)(function*(){const _e=ie.fLocalFile;return new Promise((Oe,$e)=>{if(O)return $e(Error(`Cannot access other local file ${O}`));const et=new FileReader,it=[];let yt=0;et.onload=function(sn){const tn=new DataView(sn.target.result);return 2===D.length?Oe(tn):(it.push(tn),yt+=2,yt>=D.length?Oe(it):void et.readAsArrayBuffer(_e.slice(D[yt],D[yt]+D[yt+1])))},et.readAsArrayBuffer(_e.slice(D[0],D[0]+D[1]))})})()}}class Jn extends In{constructor(D){super(null),this.fUseStampPar=!1,this.fEND=0,this.fFullURL=D,this.fURL=D,this.fFileName=D}_open(){var D=this;return(0,Ee.A)(function*(){return Se.e(424).then(Se.t.bind(Se,9424,19)).then(O=>(D.fs=O,new Promise((ie,_e)=>D.fs.open(D.fFileName,"r",(Oe,$e)=>{if(Oe)return console.log(Oe.message),_e(Error(`Not possible to open ${D.fFileName} inside node.js`));const et=D.fs.fstatSync($e);D.fEND=et.size,D.fd=$e,D.readKeys().then(ie).catch(_e)}))))})()}readBuffer(D,O){var ie=this;return(0,Ee.A)(function*(){return new Promise((_e,Oe)=>{if(O)return Oe(Error(`Cannot access other local file ${O}`));if(!ie.fs||!ie.fd)return Oe(Error(`File is not opened ${ie.fFileName}`));const $e=[];let et=0;const it=(yt,sn,tn)=>{const xn=new DataView(tn.buffer,tn.byteOffset,D[et+1]);return 2===D.length?_e(xn):($e.push(xn),et+=2,et>=D.length?_e($e):void ie.fs.read(ie.fd,Buffer.alloc(D[et+1]),0,D[et+1],D[et],it))};ie.fs.read(ie.fd,Buffer.alloc(D[1]),0,D[1],D[0],it)})})()}}class Wi{openFile(){return(0,Ee.A)(function*(){return!1})()}getFileName(){return""}getFileSize(){return 0}readBuffer(){return(0,Ee.A)(function*(){return null})()}}class Ln extends In{constructor(D){super(null),this.fUseStampPar=!1,this.proxy=D}_open(){var D=this;return(0,Ee.A)(function*(){return D.proxy.openFile().then(O=>{if(!O)return!1;if(D.fEND=D.proxy.getFileSize(),D.fFullURL=D.fURL=D.fFileName=D.proxy.getFileName(),(0,x.isStr)(D.fFileName)){const ie=D.fFileName.lastIndexOf("/");ie>0&&ie<D.fFileName.length-4&&(D.fFileName=D.fFileName.slice(ie+1))}return D.readKeys()})})()}readBuffer(D,O){var ie=this;return(0,Ee.A)(function*(){if(O)return Promise.reject(Error(`Cannot access other file ${O}`));if(!ie.proxy)return Promise.reject(Error(`File is not opened ${ie.fFileName}`));if(2===D.length)return ie.proxy.readBuffer(D[0],D[1]);const _e=[];for(let Oe=0;Oe<D.length;Oe+=2)_e.push(ie.proxy.readBuffer(D[Oe],D[Oe+1]));return Promise.all(_e)})()}}function Rs(oe){let D;return(0,x.isNodeJs)()&&(0,x.isStr)(oe)&&(0===oe.indexOf("file://")?D=new Jn(oe.slice(7)):0!==oe.indexOf("http")&&(D=new Jn(oe))),!D&&(0,x.isObject)(oe)&&oe instanceof Wi&&(D=new Ln(oe)),!D&&(0,x.isObject)(oe)&&oe instanceof ArrayBuffer&&(D=new In("localfile.root"),D.assignFileContent(oe)),!D&&(0,x.isObject)(oe)&&oe.size&&oe.name&&(D=new bi(oe)),D||(D=new In(oe)),D._open()}Bs(x.clTNamed,yn[x.clTNamed]),Bs(x.clTObjString,yn[x.clTObjString])},2923:(Yr,mt,Se)=>{"use strict";Se.d(mt,{$EB:()=>Y,$p8:()=>$T,AHc:()=>yP,B69:()=>Rl,BH$:()=>YC,CSG:()=>em,Cgj:()=>lb,DXC:()=>dT,Df:()=>hM,FNr:()=>FT,Fvt:()=>fM,GOR:()=>Wx,G_z:()=>kT,Gu$:()=>Vv,I9Y:()=>zi,JeP:()=>BB,KQV:()=>fP,LoY:()=>Cs,NRn:()=>rl,NUf:()=>yy,O9p:()=>Gr,ONl:()=>hT,PPD:()=>Jh,PTz:()=>Lu,Pq0:()=>Ft,Q1f:()=>Os,THS:()=>sa,Tap:()=>LT,V9B:()=>Xc,YJl:()=>nd,Z58:()=>WC,ZLX:()=>jC,ZM4:()=>t3,Zcv:()=>ih,ZyN:()=>jT,_4j:()=>qv,_l5:()=>n3,c9P:()=>UM,cZY:()=>tb,dth:()=>WT,eaF:()=>Jc,hB5:()=>F,iNn:()=>Mh,jUj:()=>qx,kn4:()=>bo,mrM:()=>j1,nWS:()=>Ou,qBx:()=>RT,qUd:()=>kd,qtW:()=>Bo,s0G:()=>KA,sPf:()=>x,tBo:()=>dP,tXL:()=>PT,tcD:()=>tM,uSd:()=>Qv,ubm:()=>Vl,w4A:()=>bP,xJ6:()=>Ym});var Ee=Se(4882);const x="158",He=1,Ve=2,De=3,F=0,Y=2,E=100,Ne=0,rt=1,St=2,pt=0,st=1,vt=2,Yt=3,qt=4,Ot=5,Dn=301,$n=302,Sn=306,ai=1001,ti=1003,xt=1006,ye=1008,At=1009,kn=1014,dn=1015,In=1016,Si=1020,Jn=1023,Rs=1026,oe=1027,$l=3001,ll="srgb",sc="srgb-linear",Ju="display-p3",eh="display-p3-linear",tl="linear",$o="srgb",N0="rec709",Uf="p3",zf=7680,H0="300 es",Dd=2e3;class xh{addEventListener(o,c){void 0===this._listeners&&(this._listeners={});const h=this._listeners;void 0===h[o]&&(h[o]=[]),-1===h[o].indexOf(c)&&h[o].push(c)}hasEventListener(o,c){if(void 0===this._listeners)return!1;const h=this._listeners;return void 0!==h[o]&&-1!==h[o].indexOf(c)}removeEventListener(o,c){if(void 0===this._listeners)return;const m=this._listeners[o];if(void 0!==m){const M=m.indexOf(c);-1!==M&&m.splice(M,1)}}dispatchEvent(o){if(void 0===this._listeners)return;const h=this._listeners[o.type];if(void 0!==h){o.target=this;const m=h.slice(0);for(let M=0,N=m.length;M<N;M++)m[M].call(this,o);o.target=null}}}const Ac=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],Xd=Math.PI/180,pd=180/Math.PI;function gu(){const w=4294967295*Math.random()|0,o=4294967295*Math.random()|0,c=4294967295*Math.random()|0,h=4294967295*Math.random()|0;return(Ac[255&w]+Ac[w>>8&255]+Ac[w>>16&255]+Ac[w>>24&255]+"-"+Ac[255&o]+Ac[o>>8&255]+"-"+Ac[o>>16&15|64]+Ac[o>>24&255]+"-"+Ac[63&c|128]+Ac[c>>8&255]+"-"+Ac[c>>16&255]+Ac[c>>24&255]+Ac[255&h]+Ac[h>>8&255]+Ac[h>>16&255]+Ac[h>>24&255]).toLowerCase()}function nl(w,o,c){return Math.max(o,Math.min(c,w))}function Gf(w,o,c){return(1-c)*w+c*o}function _u(w){return!(w&w-1)&&0!==w}function Yd(w){return Math.pow(2,Math.floor(Math.log(w)/Math.LN2))}function Kl(w,o){switch(o.constructor){case Float32Array:return w;case Uint32Array:return w/4294967295;case Uint16Array:return w/65535;case Uint8Array:return w/255;case Int32Array:return Math.max(w/2147483647,-1);case Int16Array:return Math.max(w/32767,-1);case Int8Array:return Math.max(w/127,-1);default:throw new Error("Invalid component type.")}}function ko(w,o){switch(o.constructor){case Float32Array:return w;case Uint32Array:return Math.round(4294967295*w);case Uint16Array:return Math.round(65535*w);case Uint8Array:return Math.round(255*w);case Int32Array:return Math.round(2147483647*w);case Int16Array:return Math.round(32767*w);case Int8Array:return Math.round(127*w);default:throw new Error("Invalid component type.")}}class zi{constructor(o=0,c=0){zi.prototype.isVector2=!0,this.x=o,this.y=c}get width(){return this.x}set width(o){this.x=o}get height(){return this.y}set height(o){this.y=o}set(o,c){return this.x=o,this.y=c,this}setScalar(o){return this.x=o,this.y=o,this}setX(o){return this.x=o,this}setY(o){return this.y=o,this}setComponent(o,c){switch(o){case 0:this.x=c;break;case 1:this.y=c;break;default:throw new Error("index is out of range: "+o)}return this}getComponent(o){switch(o){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+o)}}clone(){return new this.constructor(this.x,this.y)}copy(o){return this.x=o.x,this.y=o.y,this}add(o){return this.x+=o.x,this.y+=o.y,this}addScalar(o){return this.x+=o,this.y+=o,this}addVectors(o,c){return this.x=o.x+c.x,this.y=o.y+c.y,this}addScaledVector(o,c){return this.x+=o.x*c,this.y+=o.y*c,this}sub(o){return this.x-=o.x,this.y-=o.y,this}subScalar(o){return this.x-=o,this.y-=o,this}subVectors(o,c){return this.x=o.x-c.x,this.y=o.y-c.y,this}multiply(o){return this.x*=o.x,this.y*=o.y,this}multiplyScalar(o){return this.x*=o,this.y*=o,this}divide(o){return this.x/=o.x,this.y/=o.y,this}divideScalar(o){return this.multiplyScalar(1/o)}applyMatrix3(o){const c=this.x,h=this.y,m=o.elements;return this.x=m[0]*c+m[3]*h+m[6],this.y=m[1]*c+m[4]*h+m[7],this}min(o){return this.x=Math.min(this.x,o.x),this.y=Math.min(this.y,o.y),this}max(o){return this.x=Math.max(this.x,o.x),this.y=Math.max(this.y,o.y),this}clamp(o,c){return this.x=Math.max(o.x,Math.min(c.x,this.x)),this.y=Math.max(o.y,Math.min(c.y,this.y)),this}clampScalar(o,c){return this.x=Math.max(o,Math.min(c,this.x)),this.y=Math.max(o,Math.min(c,this.y)),this}clampLength(o,c){const h=this.length();return this.divideScalar(h||1).multiplyScalar(Math.max(o,Math.min(c,h)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(o){return this.x*o.x+this.y*o.y}cross(o){return this.x*o.y-this.y*o.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(o){const c=Math.sqrt(this.lengthSq()*o.lengthSq());if(0===c)return Math.PI/2;const h=this.dot(o)/c;return Math.acos(nl(h,-1,1))}distanceTo(o){return Math.sqrt(this.distanceToSquared(o))}distanceToSquared(o){const c=this.x-o.x,h=this.y-o.y;return c*c+h*h}manhattanDistanceTo(o){return Math.abs(this.x-o.x)+Math.abs(this.y-o.y)}setLength(o){return this.normalize().multiplyScalar(o)}lerp(o,c){return this.x+=(o.x-this.x)*c,this.y+=(o.y-this.y)*c,this}lerpVectors(o,c,h){return this.x=o.x+(c.x-o.x)*h,this.y=o.y+(c.y-o.y)*h,this}equals(o){return o.x===this.x&&o.y===this.y}fromArray(o,c=0){return this.x=o[c],this.y=o[c+1],this}toArray(o=[],c=0){return o[c]=this.x,o[c+1]=this.y,o}fromBufferAttribute(o,c){return this.x=o.getX(c),this.y=o.getY(c),this}rotateAround(o,c){const h=Math.cos(c),m=Math.sin(c),M=this.x-o.x,N=this.y-o.y;return this.x=M*h-N*m+o.x,this.y=M*m+N*h+o.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class zo{constructor(o,c,h,m,M,N,q,de,pe){zo.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==o&&this.set(o,c,h,m,M,N,q,de,pe)}set(o,c,h,m,M,N,q,de,pe){const xe=this.elements;return xe[0]=o,xe[1]=m,xe[2]=q,xe[3]=c,xe[4]=M,xe[5]=de,xe[6]=h,xe[7]=N,xe[8]=pe,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(o){const c=this.elements,h=o.elements;return c[0]=h[0],c[1]=h[1],c[2]=h[2],c[3]=h[3],c[4]=h[4],c[5]=h[5],c[6]=h[6],c[7]=h[7],c[8]=h[8],this}extractBasis(o,c,h){return o.setFromMatrix3Column(this,0),c.setFromMatrix3Column(this,1),h.setFromMatrix3Column(this,2),this}setFromMatrix4(o){const c=o.elements;return this.set(c[0],c[4],c[8],c[1],c[5],c[9],c[2],c[6],c[10]),this}multiply(o){return this.multiplyMatrices(this,o)}premultiply(o){return this.multiplyMatrices(o,this)}multiplyMatrices(o,c){const h=o.elements,m=c.elements,M=this.elements,N=h[0],q=h[3],de=h[6],pe=h[1],xe=h[4],Ie=h[7],Be=h[2],Le=h[5],Ke=h[8],ft=m[0],We=m[3],ze=m[6],Mt=m[1],ct=m[4],Dt=m[7],Jt=m[2],cn=m[5],rn=m[8];return M[0]=N*ft+q*Mt+de*Jt,M[3]=N*We+q*ct+de*cn,M[6]=N*ze+q*Dt+de*rn,M[1]=pe*ft+xe*Mt+Ie*Jt,M[4]=pe*We+xe*ct+Ie*cn,M[7]=pe*ze+xe*Dt+Ie*rn,M[2]=Be*ft+Le*Mt+Ke*Jt,M[5]=Be*We+Le*ct+Ke*cn,M[8]=Be*ze+Le*Dt+Ke*rn,this}multiplyScalar(o){const c=this.elements;return c[0]*=o,c[3]*=o,c[6]*=o,c[1]*=o,c[4]*=o,c[7]*=o,c[2]*=o,c[5]*=o,c[8]*=o,this}determinant(){const o=this.elements,c=o[0],h=o[1],m=o[2],M=o[3],N=o[4],q=o[5],de=o[6],pe=o[7],xe=o[8];return c*N*xe-c*q*pe-h*M*xe+h*q*de+m*M*pe-m*N*de}invert(){const o=this.elements,c=o[0],h=o[1],m=o[2],M=o[3],N=o[4],q=o[5],de=o[6],pe=o[7],xe=o[8],Ie=xe*N-q*pe,Be=q*de-xe*M,Le=pe*M-N*de,Ke=c*Ie+h*Be+m*Le;if(0===Ke)return this.set(0,0,0,0,0,0,0,0,0);const ft=1/Ke;return o[0]=Ie*ft,o[1]=(m*pe-xe*h)*ft,o[2]=(q*h-m*N)*ft,o[3]=Be*ft,o[4]=(xe*c-m*de)*ft,o[5]=(m*M-q*c)*ft,o[6]=Le*ft,o[7]=(h*de-pe*c)*ft,o[8]=(N*c-h*M)*ft,this}transpose(){let o;const c=this.elements;return o=c[1],c[1]=c[3],c[3]=o,o=c[2],c[2]=c[6],c[6]=o,o=c[5],c[5]=c[7],c[7]=o,this}getNormalMatrix(o){return this.setFromMatrix4(o).invert().transpose()}transposeIntoArray(o){const c=this.elements;return o[0]=c[0],o[1]=c[3],o[2]=c[6],o[3]=c[1],o[4]=c[4],o[5]=c[7],o[6]=c[2],o[7]=c[5],o[8]=c[8],this}setUvTransform(o,c,h,m,M,N,q){const de=Math.cos(M),pe=Math.sin(M);return this.set(h*de,h*pe,-h*(de*N+pe*q)+N+o,-m*pe,m*de,-m*(-pe*N+de*q)+q+c,0,0,1),this}scale(o,c){return this.premultiply(th.makeScale(o,c)),this}rotate(o){return this.premultiply(th.makeRotation(-o)),this}translate(o,c){return this.premultiply(th.makeTranslation(o,c)),this}makeTranslation(o,c){return o.isVector2?this.set(1,0,o.x,0,1,o.y,0,0,1):this.set(1,0,o,0,1,c,0,0,1),this}makeRotation(o){const c=Math.cos(o),h=Math.sin(o);return this.set(c,-h,0,h,c,0,0,0,1),this}makeScale(o,c){return this.set(o,0,0,0,c,0,0,0,1),this}equals(o){const c=this.elements,h=o.elements;for(let m=0;m<9;m++)if(c[m]!==h[m])return!1;return!0}fromArray(o,c=0){for(let h=0;h<9;h++)this.elements[h]=o[h+c];return this}toArray(o=[],c=0){const h=this.elements;return o[c]=h[0],o[c+1]=h[1],o[c+2]=h[2],o[c+3]=h[3],o[c+4]=h[4],o[c+5]=h[5],o[c+6]=h[6],o[c+7]=h[7],o[c+8]=h[8],o}clone(){return(new this.constructor).fromArray(this.elements)}}const th=new zo;function Wc(w){for(let o=w.length-1;o>=0;--o)if(w[o]>=65535)return!0;return!1}function mi(w){return document.createElementNS("http://www.w3.org/1999/xhtml",w)}function Tg(){const w=mi("canvas");return w.style.display="block",w}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const Dg={};function Cm(w){w in Dg||(Dg[w]=!0,console.warn(w))}const yu=(new zo).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),Mp=(new zo).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),_A={[sc]:{transfer:tl,primaries:N0,toReference:w=>w,fromReference:w=>w},[ll]:{transfer:$o,primaries:N0,toReference:w=>w.convertSRGBToLinear(),fromReference:w=>w.convertLinearToSRGB()},[eh]:{transfer:tl,primaries:Uf,toReference:w=>w.applyMatrix3(Mp),fromReference:w=>w.applyMatrix3(yu)},[Ju]:{transfer:$o,primaries:Uf,toReference:w=>w.convertSRGBToLinear().applyMatrix3(Mp),fromReference:w=>w.applyMatrix3(yu).convertLinearToSRGB()}},Yh=new Set([sc,eh]),Ya={enabled:!0,_workingColorSpace:sc,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(w){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!w},get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(w){if(!Yh.has(w))throw new Error(`Unsupported working color space, "${w}".`);this._workingColorSpace=w},convert:function(w,o,c){return!1!==this.enabled&&o!==c&&o&&c?(0,_A[c].fromReference)((0,_A[o].toReference)(w)):w},fromWorkingColorSpace:function(w,o){return this.convert(w,this._workingColorSpace,o)},toWorkingColorSpace:function(w,o){return this.convert(w,o,this._workingColorSpace)},getPrimaries:function(w){return _A[w].primaries},getTransfer:function(w){return""===w?tl:_A[w].transfer}};function Ch(w){return w<.04045?.0773993808*w:Math.pow(.9478672986*w+.0521327014,2.4)}function Ig(w){return w<.0031308?12.92*w:1.055*Math.pow(w,.41666)-.055}let Wf;class vu{static getDataURL(o){if(/^data:/i.test(o.src)||typeof HTMLCanvasElement>"u")return o.src;let c;if(o instanceof HTMLCanvasElement)c=o;else{void 0===Wf&&(Wf=mi("canvas")),Wf.width=o.width,Wf.height=o.height;const h=Wf.getContext("2d");o instanceof ImageData?h.putImageData(o,0,0):h.drawImage(o,0,0,o.width,o.height),c=Wf}return c.width>2048||c.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",o),c.toDataURL("image/jpeg",.6)):c.toDataURL("image/png")}static sRGBToLinear(o){if(typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&o instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&o instanceof ImageBitmap){const c=mi("canvas");c.width=o.width,c.height=o.height;const h=c.getContext("2d");h.drawImage(o,0,0,o.width,o.height);const m=h.getImageData(0,0,o.width,o.height),M=m.data;for(let N=0;N<M.length;N++)M[N]=255*Ch(M[N]/255);return h.putImageData(m,0,0),c}if(o.data){const c=o.data.slice(0);for(let h=0;h<c.length;h++)c[h]=c instanceof Uint8Array||c instanceof Uint8ClampedArray?Math.floor(255*Ch(c[h]/255)):Ch(c[h]);return{data:c,width:o.width,height:o.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),o}}let cv=0;class jf{constructor(o=null){this.isSource=!0,Object.defineProperty(this,"id",{value:cv++}),this.uuid=gu(),this.data=o,this.version=0}set needsUpdate(o){!0===o&&this.version++}toJSON(o){const c=void 0===o||"string"==typeof o;if(!c&&void 0!==o.images[this.uuid])return o.images[this.uuid];const h={uuid:this.uuid,url:""},m=this.data;if(null!==m){let M;if(Array.isArray(m)){M=[];for(let N=0,q=m.length;N<q;N++)M.push($f(m[N].isDataTexture?m[N].image:m[N]))}else M=$f(m);h.url=M}return c||(o.images[this.uuid]=h),h}}function $f(w){return typeof HTMLImageElement<"u"&&w instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&w instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&w instanceof ImageBitmap?vu.getDataURL(w):w.data?{data:Array.from(w.data),width:w.width,height:w.height,type:w.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let G0=0,bu=(()=>{class w extends xh{constructor(c=w.DEFAULT_IMAGE,h=w.DEFAULT_MAPPING,m=ai,M=ai,N=xt,q=ye,de=Jn,pe=At,xe=w.DEFAULT_ANISOTROPY,Ie=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:G0++}),this.uuid=gu(),this.name="",this.source=new jf(c),this.mipmaps=[],this.mapping=h,this.channel=0,this.wrapS=m,this.wrapT=M,this.magFilter=N,this.minFilter=q,this.anisotropy=xe,this.format=de,this.internalFormat=null,this.type=pe,this.offset=new zi(0,0),this.repeat=new zi(1,1),this.center=new zi(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new zo,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"==typeof Ie?this.colorSpace=Ie:(Cm("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=Ie===$l?ll:""),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(c=null){this.source.data=c}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(c){return this.name=c.name,this.source=c.source,this.mipmaps=c.mipmaps.slice(0),this.mapping=c.mapping,this.channel=c.channel,this.wrapS=c.wrapS,this.wrapT=c.wrapT,this.magFilter=c.magFilter,this.minFilter=c.minFilter,this.anisotropy=c.anisotropy,this.format=c.format,this.internalFormat=c.internalFormat,this.type=c.type,this.offset.copy(c.offset),this.repeat.copy(c.repeat),this.center.copy(c.center),this.rotation=c.rotation,this.matrixAutoUpdate=c.matrixAutoUpdate,this.matrix.copy(c.matrix),this.generateMipmaps=c.generateMipmaps,this.premultiplyAlpha=c.premultiplyAlpha,this.flipY=c.flipY,this.unpackAlignment=c.unpackAlignment,this.colorSpace=c.colorSpace,this.userData=JSON.parse(JSON.stringify(c.userData)),this.needsUpdate=!0,this}toJSON(c){const h=void 0===c||"string"==typeof c;if(!h&&void 0!==c.textures[this.uuid])return c.textures[this.uuid];const m={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(c).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(m.userData=this.userData),h||(c.textures[this.uuid]=m),m}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(c){if(300!==this.mapping)return c;if(c.applyMatrix3(this.matrix),c.x<0||c.x>1)switch(this.wrapS){case 1e3:c.x=c.x-Math.floor(c.x);break;case ai:c.x=c.x<0?0:1;break;case 1002:c.x=1===Math.abs(Math.floor(c.x)%2)?Math.ceil(c.x)-c.x:c.x-Math.floor(c.x)}if(c.y<0||c.y>1)switch(this.wrapT){case 1e3:c.y=c.y-Math.floor(c.y);break;case ai:c.y=c.y<0?0:1;break;case 1002:c.y=1===Math.abs(Math.floor(c.y)%2)?Math.ceil(c.y)-c.y:c.y-Math.floor(c.y)}return this.flipY&&(c.y=1-c.y),c}set needsUpdate(c){!0===c&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Cm("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===ll?$l:3e3}set encoding(c){Cm("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=c===$l?ll:""}}return w.DEFAULT_IMAGE=null,w.DEFAULT_MAPPING=300,w.DEFAULT_ANISOTROPY=1,w})();class il{constructor(o=0,c=0,h=0,m=1){il.prototype.isVector4=!0,this.x=o,this.y=c,this.z=h,this.w=m}get width(){return this.z}set width(o){this.z=o}get height(){return this.w}set height(o){this.w=o}set(o,c,h,m){return this.x=o,this.y=c,this.z=h,this.w=m,this}setScalar(o){return this.x=o,this.y=o,this.z=o,this.w=o,this}setX(o){return this.x=o,this}setY(o){return this.y=o,this}setZ(o){return this.z=o,this}setW(o){return this.w=o,this}setComponent(o,c){switch(o){case 0:this.x=c;break;case 1:this.y=c;break;case 2:this.z=c;break;case 3:this.w=c;break;default:throw new Error("index is out of range: "+o)}return this}getComponent(o){switch(o){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+o)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(o){return this.x=o.x,this.y=o.y,this.z=o.z,this.w=void 0!==o.w?o.w:1,this}add(o){return this.x+=o.x,this.y+=o.y,this.z+=o.z,this.w+=o.w,this}addScalar(o){return this.x+=o,this.y+=o,this.z+=o,this.w+=o,this}addVectors(o,c){return this.x=o.x+c.x,this.y=o.y+c.y,this.z=o.z+c.z,this.w=o.w+c.w,this}addScaledVector(o,c){return this.x+=o.x*c,this.y+=o.y*c,this.z+=o.z*c,this.w+=o.w*c,this}sub(o){return this.x-=o.x,this.y-=o.y,this.z-=o.z,this.w-=o.w,this}subScalar(o){return this.x-=o,this.y-=o,this.z-=o,this.w-=o,this}subVectors(o,c){return this.x=o.x-c.x,this.y=o.y-c.y,this.z=o.z-c.z,this.w=o.w-c.w,this}multiply(o){return this.x*=o.x,this.y*=o.y,this.z*=o.z,this.w*=o.w,this}multiplyScalar(o){return this.x*=o,this.y*=o,this.z*=o,this.w*=o,this}applyMatrix4(o){const c=this.x,h=this.y,m=this.z,M=this.w,N=o.elements;return this.x=N[0]*c+N[4]*h+N[8]*m+N[12]*M,this.y=N[1]*c+N[5]*h+N[9]*m+N[13]*M,this.z=N[2]*c+N[6]*h+N[10]*m+N[14]*M,this.w=N[3]*c+N[7]*h+N[11]*m+N[15]*M,this}divideScalar(o){return this.multiplyScalar(1/o)}setAxisAngleFromQuaternion(o){this.w=2*Math.acos(o.w);const c=Math.sqrt(1-o.w*o.w);return c<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=o.x/c,this.y=o.y/c,this.z=o.z/c),this}setAxisAngleFromRotationMatrix(o){let c,h,m,M;const de=o.elements,pe=de[0],xe=de[4],Ie=de[8],Be=de[1],Le=de[5],Ke=de[9],ft=de[2],We=de[6],ze=de[10];if(Math.abs(xe-Be)<.01&&Math.abs(Ie-ft)<.01&&Math.abs(Ke-We)<.01){if(Math.abs(xe+Be)<.1&&Math.abs(Ie+ft)<.1&&Math.abs(Ke+We)<.1&&Math.abs(pe+Le+ze-3)<.1)return this.set(1,0,0,0),this;c=Math.PI;const ct=(pe+1)/2,Dt=(Le+1)/2,Jt=(ze+1)/2,cn=(xe+Be)/4,rn=(Ie+ft)/4,Rn=(Ke+We)/4;return ct>Dt&&ct>Jt?ct<.01?(h=0,m=.707106781,M=.707106781):(h=Math.sqrt(ct),m=cn/h,M=rn/h):Dt>Jt?Dt<.01?(h=.707106781,m=0,M=.707106781):(m=Math.sqrt(Dt),h=cn/m,M=Rn/m):Jt<.01?(h=.707106781,m=.707106781,M=0):(M=Math.sqrt(Jt),h=rn/M,m=Rn/M),this.set(h,m,M,c),this}let Mt=Math.sqrt((We-Ke)*(We-Ke)+(Ie-ft)*(Ie-ft)+(Be-xe)*(Be-xe));return Math.abs(Mt)<.001&&(Mt=1),this.x=(We-Ke)/Mt,this.y=(Ie-ft)/Mt,this.z=(Be-xe)/Mt,this.w=Math.acos((pe+Le+ze-1)/2),this}min(o){return this.x=Math.min(this.x,o.x),this.y=Math.min(this.y,o.y),this.z=Math.min(this.z,o.z),this.w=Math.min(this.w,o.w),this}max(o){return this.x=Math.max(this.x,o.x),this.y=Math.max(this.y,o.y),this.z=Math.max(this.z,o.z),this.w=Math.max(this.w,o.w),this}clamp(o,c){return this.x=Math.max(o.x,Math.min(c.x,this.x)),this.y=Math.max(o.y,Math.min(c.y,this.y)),this.z=Math.max(o.z,Math.min(c.z,this.z)),this.w=Math.max(o.w,Math.min(c.w,this.w)),this}clampScalar(o,c){return this.x=Math.max(o,Math.min(c,this.x)),this.y=Math.max(o,Math.min(c,this.y)),this.z=Math.max(o,Math.min(c,this.z)),this.w=Math.max(o,Math.min(c,this.w)),this}clampLength(o,c){const h=this.length();return this.divideScalar(h||1).multiplyScalar(Math.max(o,Math.min(c,h)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(o){return this.x*o.x+this.y*o.y+this.z*o.z+this.w*o.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(o){return this.normalize().multiplyScalar(o)}lerp(o,c){return this.x+=(o.x-this.x)*c,this.y+=(o.y-this.y)*c,this.z+=(o.z-this.z)*c,this.w+=(o.w-this.w)*c,this}lerpVectors(o,c,h){return this.x=o.x+(c.x-o.x)*h,this.y=o.y+(c.y-o.y)*h,this.z=o.z+(c.z-o.z)*h,this.w=o.w+(c.w-o.w)*h,this}equals(o){return o.x===this.x&&o.y===this.y&&o.z===this.z&&o.w===this.w}fromArray(o,c=0){return this.x=o[c],this.y=o[c+1],this.z=o[c+2],this.w=o[c+3],this}toArray(o=[],c=0){return o[c]=this.x,o[c+1]=this.y,o[c+2]=this.z,o[c+3]=this.w,o}fromBufferAttribute(o,c){return this.x=o.getX(c),this.y=o.getY(c),this.z=o.getZ(c),this.w=o.getW(c),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class yA extends xh{constructor(o=1,c=1,h={}){super(),this.isRenderTarget=!0,this.width=o,this.height=c,this.depth=1,this.scissor=new il(0,0,o,c),this.scissorTest=!1,this.viewport=new il(0,0,o,c);const m={width:o,height:c,depth:1};void 0!==h.encoding&&(Cm("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),h.colorSpace=h.encoding===$l?ll:""),h=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:xt,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},h),this.texture=new bu(m,h.mapping,h.wrapS,h.wrapT,h.magFilter,h.minFilter,h.format,h.type,h.anisotropy,h.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=h.generateMipmaps,this.texture.internalFormat=h.internalFormat,this.depthBuffer=h.depthBuffer,this.stencilBuffer=h.stencilBuffer,this.depthTexture=h.depthTexture,this.samples=h.samples}setSize(o,c,h=1){(this.width!==o||this.height!==c||this.depth!==h)&&(this.width=o,this.height=c,this.depth=h,this.texture.image.width=o,this.texture.image.height=c,this.texture.image.depth=h,this.dispose()),this.viewport.set(0,0,o,c),this.scissor.set(0,0,o,c)}clone(){return(new this.constructor).copy(this)}copy(o){this.width=o.width,this.height=o.height,this.depth=o.depth,this.scissor.copy(o.scissor),this.scissorTest=o.scissorTest,this.viewport.copy(o.viewport),this.texture=o.texture.clone(),this.texture.isRenderTargetTexture=!0;const c=Object.assign({},o.texture.image);return this.texture.source=new jf(c),this.depthBuffer=o.depthBuffer,this.stencilBuffer=o.stencilBuffer,null!==o.depthTexture&&(this.depthTexture=o.depthTexture.clone()),this.samples=o.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Ou extends yA{constructor(o=1,c=1,h={}){super(o,c,h),this.isWebGLRenderTarget=!0}}const m1={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},nh={h:0,s:0,l:0},Zr={h:0,s:0,l:0};function Bg(w,o,c){return c<0&&(c+=1),c>1&&(c-=1),c<1/6?w+6*(o-w)*c:c<.5?o:c<2/3?w+6*(o-w)*(2/3-c):w}class Os{constructor(o,c,h){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(o,c,h)}set(o,c,h){if(void 0===c&&void 0===h){const m=o;m&&m.isColor?this.copy(m):"number"==typeof m?this.setHex(m):"string"==typeof m&&this.setStyle(m)}else this.setRGB(o,c,h);return this}setScalar(o){return this.r=o,this.g=o,this.b=o,this}setHex(o,c=ll){return o=Math.floor(o),this.r=(o>>16&255)/255,this.g=(o>>8&255)/255,this.b=(255&o)/255,Ya.toWorkingColorSpace(this,c),this}setRGB(o,c,h,m=Ya.workingColorSpace){return this.r=o,this.g=c,this.b=h,Ya.toWorkingColorSpace(this,m),this}setHSL(o,c,h,m=Ya.workingColorSpace){if(o=function cl(w,o){return(w%o+o)%o}(o,1),c=nl(c,0,1),h=nl(h,0,1),0===c)this.r=this.g=this.b=h;else{const M=h<=.5?h*(1+c):h+c-h*c,N=2*h-M;this.r=Bg(N,M,o+1/3),this.g=Bg(N,M,o),this.b=Bg(N,M,o-1/3)}return Ya.toWorkingColorSpace(this,m),this}setStyle(o,c=ll){function h(M){void 0!==M&&parseFloat(M)<1&&console.warn("THREE.Color: Alpha component of "+o+" will be ignored.")}let m;if(m=/^(\w+)\(([^\)]*)\)/.exec(o)){let M;const q=m[2];switch(m[1]){case"rgb":case"rgba":if(M=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(q))return h(M[4]),this.setRGB(Math.min(255,parseInt(M[1],10))/255,Math.min(255,parseInt(M[2],10))/255,Math.min(255,parseInt(M[3],10))/255,c);if(M=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(q))return h(M[4]),this.setRGB(Math.min(100,parseInt(M[1],10))/100,Math.min(100,parseInt(M[2],10))/100,Math.min(100,parseInt(M[3],10))/100,c);break;case"hsl":case"hsla":if(M=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(q))return h(M[4]),this.setHSL(parseFloat(M[1])/360,parseFloat(M[2])/100,parseFloat(M[3])/100,c);break;default:console.warn("THREE.Color: Unknown color model "+o)}}else if(m=/^\#([A-Fa-f\d]+)$/.exec(o)){const M=m[1],N=M.length;if(3===N)return this.setRGB(parseInt(M.charAt(0),16)/15,parseInt(M.charAt(1),16)/15,parseInt(M.charAt(2),16)/15,c);if(6===N)return this.setHex(parseInt(M,16),c);console.warn("THREE.Color: Invalid hex color "+o)}else if(o&&o.length>0)return this.setColorName(o,c);return this}setColorName(o,c=ll){const h=m1[o.toLowerCase()];return void 0!==h?this.setHex(h,c):console.warn("THREE.Color: Unknown color "+o),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(o){return this.r=o.r,this.g=o.g,this.b=o.b,this}copySRGBToLinear(o){return this.r=Ch(o.r),this.g=Ch(o.g),this.b=Ch(o.b),this}copyLinearToSRGB(o){return this.r=Ig(o.r),this.g=Ig(o.g),this.b=Ig(o.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(o=ll){return Ya.fromWorkingColorSpace(vo.copy(this),o),65536*Math.round(nl(255*vo.r,0,255))+256*Math.round(nl(255*vo.g,0,255))+Math.round(nl(255*vo.b,0,255))}getHexString(o=ll){return("000000"+this.getHex(o).toString(16)).slice(-6)}getHSL(o,c=Ya.workingColorSpace){Ya.fromWorkingColorSpace(vo.copy(this),c);const h=vo.r,m=vo.g,M=vo.b,N=Math.max(h,m,M),q=Math.min(h,m,M);let de,pe;const xe=(q+N)/2;if(q===N)de=0,pe=0;else{const Ie=N-q;switch(pe=xe<=.5?Ie/(N+q):Ie/(2-N-q),N){case h:de=(m-M)/Ie+(m<M?6:0);break;case m:de=(M-h)/Ie+2;break;case M:de=(h-m)/Ie+4}de/=6}return o.h=de,o.s=pe,o.l=xe,o}getRGB(o,c=Ya.workingColorSpace){return Ya.fromWorkingColorSpace(vo.copy(this),c),o.r=vo.r,o.g=vo.g,o.b=vo.b,o}getStyle(o=ll){Ya.fromWorkingColorSpace(vo.copy(this),o);const c=vo.r,h=vo.g,m=vo.b;return o!==ll?`color(${o} ${c.toFixed(3)} ${h.toFixed(3)} ${m.toFixed(3)})`:`rgb(${Math.round(255*c)},${Math.round(255*h)},${Math.round(255*m)})`}offsetHSL(o,c,h){return this.getHSL(nh),this.setHSL(nh.h+o,nh.s+c,nh.l+h)}add(o){return this.r+=o.r,this.g+=o.g,this.b+=o.b,this}addColors(o,c){return this.r=o.r+c.r,this.g=o.g+c.g,this.b=o.b+c.b,this}addScalar(o){return this.r+=o,this.g+=o,this.b+=o,this}sub(o){return this.r=Math.max(0,this.r-o.r),this.g=Math.max(0,this.g-o.g),this.b=Math.max(0,this.b-o.b),this}multiply(o){return this.r*=o.r,this.g*=o.g,this.b*=o.b,this}multiplyScalar(o){return this.r*=o,this.g*=o,this.b*=o,this}lerp(o,c){return this.r+=(o.r-this.r)*c,this.g+=(o.g-this.g)*c,this.b+=(o.b-this.b)*c,this}lerpColors(o,c,h){return this.r=o.r+(c.r-o.r)*h,this.g=o.g+(c.g-o.g)*h,this.b=o.b+(c.b-o.b)*h,this}lerpHSL(o,c){this.getHSL(nh),o.getHSL(Zr);const h=Gf(nh.h,Zr.h,c),m=Gf(nh.s,Zr.s,c),M=Gf(nh.l,Zr.l,c);return this.setHSL(h,m,M),this}setFromVector3(o){return this.r=o.x,this.g=o.y,this.b=o.z,this}applyMatrix3(o){const c=this.r,h=this.g,m=this.b,M=o.elements;return this.r=M[0]*c+M[3]*h+M[6]*m,this.g=M[1]*c+M[4]*h+M[7]*m,this.b=M[2]*c+M[5]*h+M[8]*m,this}equals(o){return o.r===this.r&&o.g===this.g&&o.b===this.b}fromArray(o,c=0){return this.r=o[c],this.g=o[c+1],this.b=o[c+2],this}toArray(o=[],c=0){return o[c]=this.r,o[c+1]=this.g,o[c+2]=this.b,o}fromBufferAttribute(o,c){return this.r=o.getX(c),this.g=o.getY(c),this.b=o.getZ(c),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const vo=new Os;Os.NAMES=m1;class Lu{constructor(o=0,c=0,h=0,m=1){this.isQuaternion=!0,this._x=o,this._y=c,this._z=h,this._w=m}static slerpFlat(o,c,h,m,M,N,q){let de=h[m+0],pe=h[m+1],xe=h[m+2],Ie=h[m+3];const Be=M[N+0],Le=M[N+1],Ke=M[N+2],ft=M[N+3];if(0===q)return o[c+0]=de,o[c+1]=pe,o[c+2]=xe,void(o[c+3]=Ie);if(1===q)return o[c+0]=Be,o[c+1]=Le,o[c+2]=Ke,void(o[c+3]=ft);if(Ie!==ft||de!==Be||pe!==Le||xe!==Ke){let We=1-q;const ze=de*Be+pe*Le+xe*Ke+Ie*ft,Mt=ze>=0?1:-1,ct=1-ze*ze;if(ct>Number.EPSILON){const Jt=Math.sqrt(ct),cn=Math.atan2(Jt,ze*Mt);We=Math.sin(We*cn)/Jt,q=Math.sin(q*cn)/Jt}const Dt=q*Mt;if(de=de*We+Be*Dt,pe=pe*We+Le*Dt,xe=xe*We+Ke*Dt,Ie=Ie*We+ft*Dt,We===1-q){const Jt=1/Math.sqrt(de*de+pe*pe+xe*xe+Ie*Ie);de*=Jt,pe*=Jt,xe*=Jt,Ie*=Jt}}o[c]=de,o[c+1]=pe,o[c+2]=xe,o[c+3]=Ie}static multiplyQuaternionsFlat(o,c,h,m,M,N){const q=h[m],de=h[m+1],pe=h[m+2],xe=h[m+3],Ie=M[N],Be=M[N+1],Le=M[N+2],Ke=M[N+3];return o[c]=q*Ke+xe*Ie+de*Le-pe*Be,o[c+1]=de*Ke+xe*Be+pe*Ie-q*Le,o[c+2]=pe*Ke+xe*Le+q*Be-de*Ie,o[c+3]=xe*Ke-q*Ie-de*Be-pe*Le,o}get x(){return this._x}set x(o){this._x=o,this._onChangeCallback()}get y(){return this._y}set y(o){this._y=o,this._onChangeCallback()}get z(){return this._z}set z(o){this._z=o,this._onChangeCallback()}get w(){return this._w}set w(o){this._w=o,this._onChangeCallback()}set(o,c,h,m){return this._x=o,this._y=c,this._z=h,this._w=m,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(o){return this._x=o.x,this._y=o.y,this._z=o.z,this._w=o.w,this._onChangeCallback(),this}setFromEuler(o,c){const h=o._x,m=o._y,M=o._z,N=o._order,q=Math.cos,de=Math.sin,pe=q(h/2),xe=q(m/2),Ie=q(M/2),Be=de(h/2),Le=de(m/2),Ke=de(M/2);switch(N){case"XYZ":this._x=Be*xe*Ie+pe*Le*Ke,this._y=pe*Le*Ie-Be*xe*Ke,this._z=pe*xe*Ke+Be*Le*Ie,this._w=pe*xe*Ie-Be*Le*Ke;break;case"YXZ":this._x=Be*xe*Ie+pe*Le*Ke,this._y=pe*Le*Ie-Be*xe*Ke,this._z=pe*xe*Ke-Be*Le*Ie,this._w=pe*xe*Ie+Be*Le*Ke;break;case"ZXY":this._x=Be*xe*Ie-pe*Le*Ke,this._y=pe*Le*Ie+Be*xe*Ke,this._z=pe*xe*Ke+Be*Le*Ie,this._w=pe*xe*Ie-Be*Le*Ke;break;case"ZYX":this._x=Be*xe*Ie-pe*Le*Ke,this._y=pe*Le*Ie+Be*xe*Ke,this._z=pe*xe*Ke-Be*Le*Ie,this._w=pe*xe*Ie+Be*Le*Ke;break;case"YZX":this._x=Be*xe*Ie+pe*Le*Ke,this._y=pe*Le*Ie+Be*xe*Ke,this._z=pe*xe*Ke-Be*Le*Ie,this._w=pe*xe*Ie-Be*Le*Ke;break;case"XZY":this._x=Be*xe*Ie-pe*Le*Ke,this._y=pe*Le*Ie-Be*xe*Ke,this._z=pe*xe*Ke+Be*Le*Ie,this._w=pe*xe*Ie+Be*Le*Ke;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+N)}return!1!==c&&this._onChangeCallback(),this}setFromAxisAngle(o,c){const h=c/2,m=Math.sin(h);return this._x=o.x*m,this._y=o.y*m,this._z=o.z*m,this._w=Math.cos(h),this._onChangeCallback(),this}setFromRotationMatrix(o){const c=o.elements,h=c[0],m=c[4],M=c[8],N=c[1],q=c[5],de=c[9],pe=c[2],xe=c[6],Ie=c[10],Be=h+q+Ie;if(Be>0){const Le=.5/Math.sqrt(Be+1);this._w=.25/Le,this._x=(xe-de)*Le,this._y=(M-pe)*Le,this._z=(N-m)*Le}else if(h>q&&h>Ie){const Le=2*Math.sqrt(1+h-q-Ie);this._w=(xe-de)/Le,this._x=.25*Le,this._y=(m+N)/Le,this._z=(M+pe)/Le}else if(q>Ie){const Le=2*Math.sqrt(1+q-h-Ie);this._w=(M-pe)/Le,this._x=(m+N)/Le,this._y=.25*Le,this._z=(de+xe)/Le}else{const Le=2*Math.sqrt(1+Ie-h-q);this._w=(N-m)/Le,this._x=(M+pe)/Le,this._y=(de+xe)/Le,this._z=.25*Le}return this._onChangeCallback(),this}setFromUnitVectors(o,c){let h=o.dot(c)+1;return h<Number.EPSILON?(h=0,Math.abs(o.x)>Math.abs(o.z)?(this._x=-o.y,this._y=o.x,this._z=0,this._w=h):(this._x=0,this._y=-o.z,this._z=o.y,this._w=h)):(this._x=o.y*c.z-o.z*c.y,this._y=o.z*c.x-o.x*c.z,this._z=o.x*c.y-o.y*c.x,this._w=h),this.normalize()}angleTo(o){return 2*Math.acos(Math.abs(nl(this.dot(o),-1,1)))}rotateTowards(o,c){const h=this.angleTo(o);if(0===h)return this;const m=Math.min(1,c/h);return this.slerp(o,m),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(o){return this._x*o._x+this._y*o._y+this._z*o._z+this._w*o._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let o=this.length();return 0===o?(this._x=0,this._y=0,this._z=0,this._w=1):(o=1/o,this._x=this._x*o,this._y=this._y*o,this._z=this._z*o,this._w=this._w*o),this._onChangeCallback(),this}multiply(o){return this.multiplyQuaternions(this,o)}premultiply(o){return this.multiplyQuaternions(o,this)}multiplyQuaternions(o,c){const h=o._x,m=o._y,M=o._z,N=o._w,q=c._x,de=c._y,pe=c._z,xe=c._w;return this._x=h*xe+N*q+m*pe-M*de,this._y=m*xe+N*de+M*q-h*pe,this._z=M*xe+N*pe+h*de-m*q,this._w=N*xe-h*q-m*de-M*pe,this._onChangeCallback(),this}slerp(o,c){if(0===c)return this;if(1===c)return this.copy(o);const h=this._x,m=this._y,M=this._z,N=this._w;let q=N*o._w+h*o._x+m*o._y+M*o._z;if(q<0?(this._w=-o._w,this._x=-o._x,this._y=-o._y,this._z=-o._z,q=-q):this.copy(o),q>=1)return this._w=N,this._x=h,this._y=m,this._z=M,this;const de=1-q*q;if(de<=Number.EPSILON){const Le=1-c;return this._w=Le*N+c*this._w,this._x=Le*h+c*this._x,this._y=Le*m+c*this._y,this._z=Le*M+c*this._z,this.normalize(),this._onChangeCallback(),this}const pe=Math.sqrt(de),xe=Math.atan2(pe,q),Ie=Math.sin((1-c)*xe)/pe,Be=Math.sin(c*xe)/pe;return this._w=N*Ie+this._w*Be,this._x=h*Ie+this._x*Be,this._y=m*Ie+this._y*Be,this._z=M*Ie+this._z*Be,this._onChangeCallback(),this}slerpQuaternions(o,c,h){return this.copy(o).slerp(c,h)}random(){const o=Math.random(),c=Math.sqrt(1-o),h=Math.sqrt(o),m=2*Math.PI*Math.random(),M=2*Math.PI*Math.random();return this.set(c*Math.cos(m),h*Math.sin(M),h*Math.cos(M),c*Math.sin(m))}equals(o){return o._x===this._x&&o._y===this._y&&o._z===this._z&&o._w===this._w}fromArray(o,c=0){return this._x=o[c],this._y=o[c+1],this._z=o[c+2],this._w=o[c+3],this._onChangeCallback(),this}toArray(o=[],c=0){return o[c]=this._x,o[c+1]=this._y,o[c+2]=this._z,o[c+3]=this._w,o}fromBufferAttribute(o,c){return this._x=o.getX(c),this._y=o.getY(c),this._z=o.getZ(c),this._w=o.getW(c),this}toJSON(){return this.toArray()}_onChange(o){return this._onChangeCallback=o,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Ft{constructor(o=0,c=0,h=0){Ft.prototype.isVector3=!0,this.x=o,this.y=c,this.z=h}set(o,c,h){return void 0===h&&(h=this.z),this.x=o,this.y=c,this.z=h,this}setScalar(o){return this.x=o,this.y=o,this.z=o,this}setX(o){return this.x=o,this}setY(o){return this.y=o,this}setZ(o){return this.z=o,this}setComponent(o,c){switch(o){case 0:this.x=c;break;case 1:this.y=c;break;case 2:this.z=c;break;default:throw new Error("index is out of range: "+o)}return this}getComponent(o){switch(o){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+o)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(o){return this.x=o.x,this.y=o.y,this.z=o.z,this}add(o){return this.x+=o.x,this.y+=o.y,this.z+=o.z,this}addScalar(o){return this.x+=o,this.y+=o,this.z+=o,this}addVectors(o,c){return this.x=o.x+c.x,this.y=o.y+c.y,this.z=o.z+c.z,this}addScaledVector(o,c){return this.x+=o.x*c,this.y+=o.y*c,this.z+=o.z*c,this}sub(o){return this.x-=o.x,this.y-=o.y,this.z-=o.z,this}subScalar(o){return this.x-=o,this.y-=o,this.z-=o,this}subVectors(o,c){return this.x=o.x-c.x,this.y=o.y-c.y,this.z=o.z-c.z,this}multiply(o){return this.x*=o.x,this.y*=o.y,this.z*=o.z,this}multiplyScalar(o){return this.x*=o,this.y*=o,this.z*=o,this}multiplyVectors(o,c){return this.x=o.x*c.x,this.y=o.y*c.y,this.z=o.z*c.z,this}applyEuler(o){return this.applyQuaternion(Wo.setFromEuler(o))}applyAxisAngle(o,c){return this.applyQuaternion(Wo.setFromAxisAngle(o,c))}applyMatrix3(o){const c=this.x,h=this.y,m=this.z,M=o.elements;return this.x=M[0]*c+M[3]*h+M[6]*m,this.y=M[1]*c+M[4]*h+M[7]*m,this.z=M[2]*c+M[5]*h+M[8]*m,this}applyNormalMatrix(o){return this.applyMatrix3(o).normalize()}applyMatrix4(o){const c=this.x,h=this.y,m=this.z,M=o.elements,N=1/(M[3]*c+M[7]*h+M[11]*m+M[15]);return this.x=(M[0]*c+M[4]*h+M[8]*m+M[12])*N,this.y=(M[1]*c+M[5]*h+M[9]*m+M[13])*N,this.z=(M[2]*c+M[6]*h+M[10]*m+M[14])*N,this}applyQuaternion(o){const c=this.x,h=this.y,m=this.z,M=o.x,N=o.y,q=o.z,de=o.w,pe=2*(N*m-q*h),xe=2*(q*c-M*m),Ie=2*(M*h-N*c);return this.x=c+de*pe+N*Ie-q*xe,this.y=h+de*xe+q*pe-M*Ie,this.z=m+de*Ie+M*xe-N*pe,this}project(o){return this.applyMatrix4(o.matrixWorldInverse).applyMatrix4(o.projectionMatrix)}unproject(o){return this.applyMatrix4(o.projectionMatrixInverse).applyMatrix4(o.matrixWorld)}transformDirection(o){const c=this.x,h=this.y,m=this.z,M=o.elements;return this.x=M[0]*c+M[4]*h+M[8]*m,this.y=M[1]*c+M[5]*h+M[9]*m,this.z=M[2]*c+M[6]*h+M[10]*m,this.normalize()}divide(o){return this.x/=o.x,this.y/=o.y,this.z/=o.z,this}divideScalar(o){return this.multiplyScalar(1/o)}min(o){return this.x=Math.min(this.x,o.x),this.y=Math.min(this.y,o.y),this.z=Math.min(this.z,o.z),this}max(o){return this.x=Math.max(this.x,o.x),this.y=Math.max(this.y,o.y),this.z=Math.max(this.z,o.z),this}clamp(o,c){return this.x=Math.max(o.x,Math.min(c.x,this.x)),this.y=Math.max(o.y,Math.min(c.y,this.y)),this.z=Math.max(o.z,Math.min(c.z,this.z)),this}clampScalar(o,c){return this.x=Math.max(o,Math.min(c,this.x)),this.y=Math.max(o,Math.min(c,this.y)),this.z=Math.max(o,Math.min(c,this.z)),this}clampLength(o,c){const h=this.length();return this.divideScalar(h||1).multiplyScalar(Math.max(o,Math.min(c,h)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(o){return this.x*o.x+this.y*o.y+this.z*o.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(o){return this.normalize().multiplyScalar(o)}lerp(o,c){return this.x+=(o.x-this.x)*c,this.y+=(o.y-this.y)*c,this.z+=(o.z-this.z)*c,this}lerpVectors(o,c,h){return this.x=o.x+(c.x-o.x)*h,this.y=o.y+(c.y-o.y)*h,this.z=o.z+(c.z-o.z)*h,this}cross(o){return this.crossVectors(this,o)}crossVectors(o,c){const h=o.x,m=o.y,M=o.z,N=c.x,q=c.y,de=c.z;return this.x=m*de-M*q,this.y=M*N-h*de,this.z=h*q-m*N,this}projectOnVector(o){const c=o.lengthSq();if(0===c)return this.set(0,0,0);const h=o.dot(this)/c;return this.copy(o).multiplyScalar(h)}projectOnPlane(o){return Ic.copy(this).projectOnVector(o),this.sub(Ic)}reflect(o){return this.sub(Ic.copy(o).multiplyScalar(2*this.dot(o)))}angleTo(o){const c=Math.sqrt(this.lengthSq()*o.lengthSq());if(0===c)return Math.PI/2;const h=this.dot(o)/c;return Math.acos(nl(h,-1,1))}distanceTo(o){return Math.sqrt(this.distanceToSquared(o))}distanceToSquared(o){const c=this.x-o.x,h=this.y-o.y,m=this.z-o.z;return c*c+h*h+m*m}manhattanDistanceTo(o){return Math.abs(this.x-o.x)+Math.abs(this.y-o.y)+Math.abs(this.z-o.z)}setFromSpherical(o){return this.setFromSphericalCoords(o.radius,o.phi,o.theta)}setFromSphericalCoords(o,c,h){const m=Math.sin(c)*o;return this.x=m*Math.sin(h),this.y=Math.cos(c)*o,this.z=m*Math.cos(h),this}setFromCylindrical(o){return this.setFromCylindricalCoords(o.radius,o.theta,o.y)}setFromCylindricalCoords(o,c,h){return this.x=o*Math.sin(c),this.y=h,this.z=o*Math.cos(c),this}setFromMatrixPosition(o){const c=o.elements;return this.x=c[12],this.y=c[13],this.z=c[14],this}setFromMatrixScale(o){const c=this.setFromMatrixColumn(o,0).length(),h=this.setFromMatrixColumn(o,1).length(),m=this.setFromMatrixColumn(o,2).length();return this.x=c,this.y=h,this.z=m,this}setFromMatrixColumn(o,c){return this.fromArray(o.elements,4*c)}setFromMatrix3Column(o,c){return this.fromArray(o.elements,3*c)}setFromEuler(o){return this.x=o._x,this.y=o._y,this.z=o._z,this}setFromColor(o){return this.x=o.r,this.y=o.g,this.z=o.b,this}equals(o){return o.x===this.x&&o.y===this.y&&o.z===this.z}fromArray(o,c=0){return this.x=o[c],this.y=o[c+1],this.z=o[c+2],this}toArray(o=[],c=0){return o[c]=this.x,o[c+1]=this.y,o[c+2]=this.z,o}fromBufferAttribute(o,c){return this.x=o.getX(c),this.y=o.getY(c),this.z=o.getZ(c),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const o=2*(Math.random()-.5),c=Math.random()*Math.PI*2,h=Math.sqrt(1-o**2);return this.x=h*Math.cos(c),this.y=h*Math.sin(c),this.z=o,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Ic=new Ft,Wo=new Lu;class rl{constructor(o=new Ft(1/0,1/0,1/0),c=new Ft(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=o,this.max=c}set(o,c){return this.min.copy(o),this.max.copy(c),this}setFromArray(o){this.makeEmpty();for(let c=0,h=o.length;c<h;c+=3)this.expandByPoint(Sl.fromArray(o,c));return this}setFromBufferAttribute(o){this.makeEmpty();for(let c=0,h=o.count;c<h;c++)this.expandByPoint(Sl.fromBufferAttribute(o,c));return this}setFromPoints(o){this.makeEmpty();for(let c=0,h=o.length;c<h;c++)this.expandByPoint(o[c]);return this}setFromCenterAndSize(o,c){const h=Sl.copy(c).multiplyScalar(.5);return this.min.copy(o).sub(h),this.max.copy(o).add(h),this}setFromObject(o,c=!1){return this.makeEmpty(),this.expandByObject(o,c)}clone(){return(new this.constructor).copy(this)}copy(o){return this.min.copy(o.min),this.max.copy(o.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(o){return this.isEmpty()?o.set(0,0,0):o.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(o){return this.isEmpty()?o.set(0,0,0):o.subVectors(this.max,this.min)}expandByPoint(o){return this.min.min(o),this.max.max(o),this}expandByVector(o){return this.min.sub(o),this.max.add(o),this}expandByScalar(o){return this.min.addScalar(-o),this.max.addScalar(o),this}expandByObject(o,c=!1){o.updateWorldMatrix(!1,!1);const h=o.geometry;if(void 0!==h){const M=h.getAttribute("position");if(!0===c&&void 0!==M&&!0!==o.isInstancedMesh)for(let N=0,q=M.count;N<q;N++)!0===o.isMesh?o.getVertexPosition(N,Sl):Sl.fromBufferAttribute(M,N),Sl.applyMatrix4(o.matrixWorld),this.expandByPoint(Sl);else void 0!==o.boundingBox?(null===o.boundingBox&&o.computeBoundingBox(),Bc.copy(o.boundingBox)):(null===h.boundingBox&&h.computeBoundingBox(),Bc.copy(h.boundingBox)),Bc.applyMatrix4(o.matrixWorld),this.union(Bc)}const m=o.children;for(let M=0,N=m.length;M<N;M++)this.expandByObject(m[M],c);return this}containsPoint(o){return!(o.x<this.min.x||o.x>this.max.x||o.y<this.min.y||o.y>this.max.y||o.z<this.min.z||o.z>this.max.z)}containsBox(o){return this.min.x<=o.min.x&&o.max.x<=this.max.x&&this.min.y<=o.min.y&&o.max.y<=this.max.y&&this.min.z<=o.min.z&&o.max.z<=this.max.z}getParameter(o,c){return c.set((o.x-this.min.x)/(this.max.x-this.min.x),(o.y-this.min.y)/(this.max.y-this.min.y),(o.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(o){return!(o.max.x<this.min.x||o.min.x>this.max.x||o.max.y<this.min.y||o.min.y>this.max.y||o.max.z<this.min.z||o.min.z>this.max.z)}intersectsSphere(o){return this.clampPoint(o.center,Sl),Sl.distanceToSquared(o.center)<=o.radius*o.radius}intersectsPlane(o){let c,h;return o.normal.x>0?(c=o.normal.x*this.min.x,h=o.normal.x*this.max.x):(c=o.normal.x*this.max.x,h=o.normal.x*this.min.x),o.normal.y>0?(c+=o.normal.y*this.min.y,h+=o.normal.y*this.max.y):(c+=o.normal.y*this.max.y,h+=o.normal.y*this.min.y),o.normal.z>0?(c+=o.normal.z*this.min.z,h+=o.normal.z*this.max.z):(c+=o.normal.z*this.max.z,h+=o.normal.z*this.min.z),c<=-o.constant&&h>=-o.constant}intersectsTriangle(o){if(this.isEmpty())return!1;this.getCenter(Mm),Tp.subVectors(this.max,Mm),Sp.subVectors(o.a,Mm),Ep.subVectors(o.b,Mm),_c.subVectors(o.c,Mm),Pc.subVectors(Ep,Sp),Kh.subVectors(_c,Ep),Nu.subVectors(Sp,_c);let c=[0,-Pc.z,Pc.y,0,-Kh.z,Kh.y,0,-Nu.z,Nu.y,Pc.z,0,-Pc.x,Kh.z,0,-Kh.x,Nu.z,0,-Nu.x,-Pc.y,Pc.x,0,-Kh.y,Kh.x,0,-Nu.y,Nu.x,0];return!(!A1(c,Sp,Ep,_c,Tp)||(c=[1,0,0,0,1,0,0,0,1],!A1(c,Sp,Ep,_c,Tp)))&&(Dp.crossVectors(Pc,Kh),c=[Dp.x,Dp.y,Dp.z],A1(c,Sp,Ep,_c,Tp))}clampPoint(o,c){return c.copy(o).clamp(this.min,this.max)}distanceToPoint(o){return this.clampPoint(o,Sl).distanceTo(o)}getBoundingSphere(o){return this.isEmpty()?o.makeEmpty():(this.getCenter(o.center),o.radius=.5*this.getSize(Sl).length()),o}intersect(o){return this.min.max(o.min),this.max.min(o.max),this.isEmpty()&&this.makeEmpty(),this}union(o){return this.min.min(o.min),this.max.max(o.max),this}applyMatrix4(o){return this.isEmpty()||(bl[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(o),bl[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(o),bl[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(o),bl[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(o),bl[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(o),bl[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(o),bl[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(o),bl[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(o),this.setFromPoints(bl)),this}translate(o){return this.min.add(o),this.max.add(o),this}equals(o){return o.min.equals(this.min)&&o.max.equals(this.max)}}const bl=[new Ft,new Ft,new Ft,new Ft,new Ft,new Ft,new Ft,new Ft],Sl=new Ft,Bc=new rl,Sp=new Ft,Ep=new Ft,_c=new Ft,Pc=new Ft,Kh=new Ft,Nu=new Ft,Mm=new Ft,Tp=new Ft,Dp=new Ft,Uu=new Ft;function A1(w,o,c,h,m){for(let M=0,N=w.length-3;M<=N;M+=3){Uu.fromArray(w,M);const q=m.x*Math.abs(Uu.x)+m.y*Math.abs(Uu.y)+m.z*Math.abs(Uu.z),de=o.dot(Uu),pe=c.dot(Uu),xe=h.dot(Uu);if(Math.max(-Math.max(de,pe,xe),Math.min(de,pe,xe))>q)return!1}return!0}const q0=new rl,vA=new Ft,Zh=new Ft;class Kd{constructor(o=new Ft,c=-1){this.center=o,this.radius=c}set(o,c){return this.center.copy(o),this.radius=c,this}setFromPoints(o,c){const h=this.center;void 0!==c?h.copy(c):q0.setFromPoints(o).getCenter(h);let m=0;for(let M=0,N=o.length;M<N;M++)m=Math.max(m,h.distanceToSquared(o[M]));return this.radius=Math.sqrt(m),this}copy(o){return this.center.copy(o.center),this.radius=o.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(o){return o.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(o){return o.distanceTo(this.center)-this.radius}intersectsSphere(o){const c=this.radius+o.radius;return o.center.distanceToSquared(this.center)<=c*c}intersectsBox(o){return o.intersectsSphere(this)}intersectsPlane(o){return Math.abs(o.distanceToPoint(this.center))<=this.radius}clampPoint(o,c){const h=this.center.distanceToSquared(o);return c.copy(o),h>this.radius*this.radius&&(c.sub(this.center).normalize(),c.multiplyScalar(this.radius).add(this.center)),c}getBoundingBox(o){return this.isEmpty()?(o.makeEmpty(),o):(o.set(this.center,this.center),o.expandByScalar(this.radius),o)}applyMatrix4(o){return this.center.applyMatrix4(o),this.radius=this.radius*o.getMaxScaleOnAxis(),this}translate(o){return this.center.add(o),this}expandByPoint(o){if(this.isEmpty())return this.center.copy(o),this.radius=0,this;vA.subVectors(o,this.center);const c=vA.lengthSq();if(c>this.radius*this.radius){const h=Math.sqrt(c),m=.5*(h-this.radius);this.center.addScaledVector(vA,m/h),this.radius+=m}return this}union(o){return o.isEmpty()?this:this.isEmpty()?(this.copy(o),this):(!0===this.center.equals(o.center)?this.radius=Math.max(this.radius,o.radius):(Zh.subVectors(o.center,this.center).setLength(o.radius),this.expandByPoint(vA.copy(o.center).add(Zh)),this.expandByPoint(vA.copy(o.center).sub(Zh))),this)}equals(o){return o.center.equals(this.center)&&o.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Pg=new Ft,Ip=new Ft,dv=new zo;class ih{constructor(o=new Ft(1,0,0),c=0){this.isPlane=!0,this.normal=o,this.constant=c}set(o,c){return this.normal.copy(o),this.constant=c,this}setComponents(o,c,h,m){return this.normal.set(o,c,h),this.constant=m,this}setFromNormalAndCoplanarPoint(o,c){return this.normal.copy(o),this.constant=-c.dot(this.normal),this}setFromCoplanarPoints(o,c,h){const m=Pg.subVectors(h,c).cross(Ip.subVectors(o,c)).normalize();return this.setFromNormalAndCoplanarPoint(m,o),this}copy(o){return this.normal.copy(o.normal),this.constant=o.constant,this}normalize(){const o=1/this.normal.length();return this.normal.multiplyScalar(o),this.constant*=o,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(o){return this.normal.dot(o)+this.constant}distanceToSphere(o){return this.distanceToPoint(o.center)-o.radius}projectPoint(o,c){return c.copy(o).addScaledVector(this.normal,-this.distanceToPoint(o))}intersectLine(o,c){const h=o.delta(Pg),m=this.normal.dot(h);if(0===m)return 0===this.distanceToPoint(o.start)?c.copy(o.start):null;const M=-(o.start.dot(this.normal)+this.constant)/m;return M<0||M>1?null:c.copy(o.start).addScaledVector(h,M)}intersectsLine(o){const c=this.distanceToPoint(o.start),h=this.distanceToPoint(o.end);return c<0&&h>0||h<0&&c>0}intersectsBox(o){return o.intersectsPlane(this)}intersectsSphere(o){return o.intersectsPlane(this)}coplanarPoint(o){return o.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(o,c){const h=c||dv.getNormalMatrix(o),m=this.coplanarPoint(Pg).applyMatrix4(o),M=this.normal.applyMatrix3(h).normalize();return this.constant=-m.dot(M),this}translate(o){return this.constant-=o.dot(this.normal),this}equals(o){return o.normal.equals(this.normal)&&o.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const yc=new Kd,Rg=new Ft;class Jh{constructor(o=new ih,c=new ih,h=new ih,m=new ih,M=new ih,N=new ih){this.planes=[o,c,h,m,M,N]}set(o,c,h,m,M,N){const q=this.planes;return q[0].copy(o),q[1].copy(c),q[2].copy(h),q[3].copy(m),q[4].copy(M),q[5].copy(N),this}copy(o){const c=this.planes;for(let h=0;h<6;h++)c[h].copy(o.planes[h]);return this}setFromProjectionMatrix(o,c=Dd){const h=this.planes,m=o.elements,M=m[0],N=m[1],q=m[2],de=m[3],pe=m[4],xe=m[5],Ie=m[6],Be=m[7],Le=m[8],Ke=m[9],ft=m[10],We=m[11],ze=m[12],Mt=m[13],ct=m[14],Dt=m[15];if(h[0].setComponents(de-M,Be-pe,We-Le,Dt-ze).normalize(),h[1].setComponents(de+M,Be+pe,We+Le,Dt+ze).normalize(),h[2].setComponents(de+N,Be+xe,We+Ke,Dt+Mt).normalize(),h[3].setComponents(de-N,Be-xe,We-Ke,Dt-Mt).normalize(),h[4].setComponents(de-q,Be-Ie,We-ft,Dt-ct).normalize(),c===Dd)h[5].setComponents(de+q,Be+Ie,We+ft,Dt+ct).normalize();else{if(2001!==c)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+c);h[5].setComponents(q,Ie,ft,ct).normalize()}return this}intersectsObject(o){if(void 0!==o.boundingSphere)null===o.boundingSphere&&o.computeBoundingSphere(),yc.copy(o.boundingSphere).applyMatrix4(o.matrixWorld);else{const c=o.geometry;null===c.boundingSphere&&c.computeBoundingSphere(),yc.copy(c.boundingSphere).applyMatrix4(o.matrixWorld)}return this.intersectsSphere(yc)}intersectsSprite(o){return yc.center.set(0,0,0),yc.radius=.7071067811865476,yc.applyMatrix4(o.matrixWorld),this.intersectsSphere(yc)}intersectsSphere(o){const c=this.planes,h=o.center,m=-o.radius;for(let M=0;M<6;M++)if(c[M].distanceToPoint(h)<m)return!1;return!0}intersectsBox(o){const c=this.planes;for(let h=0;h<6;h++){const m=c[h];if(Rg.x=m.normal.x>0?o.max.x:o.min.x,Rg.y=m.normal.y>0?o.max.y:o.min.y,Rg.z=m.normal.z>0?o.max.z:o.min.z,m.distanceToPoint(Rg)<0)return!1}return!0}containsPoint(o){const c=this.planes;for(let h=0;h<6;h++)if(c[h].distanceToPoint(o)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}class bo{constructor(o,c,h,m,M,N,q,de,pe,xe,Ie,Be,Le,Ke,ft,We){bo.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==o&&this.set(o,c,h,m,M,N,q,de,pe,xe,Ie,Be,Le,Ke,ft,We)}set(o,c,h,m,M,N,q,de,pe,xe,Ie,Be,Le,Ke,ft,We){const ze=this.elements;return ze[0]=o,ze[4]=c,ze[8]=h,ze[12]=m,ze[1]=M,ze[5]=N,ze[9]=q,ze[13]=de,ze[2]=pe,ze[6]=xe,ze[10]=Ie,ze[14]=Be,ze[3]=Le,ze[7]=Ke,ze[11]=ft,ze[15]=We,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new bo).fromArray(this.elements)}copy(o){const c=this.elements,h=o.elements;return c[0]=h[0],c[1]=h[1],c[2]=h[2],c[3]=h[3],c[4]=h[4],c[5]=h[5],c[6]=h[6],c[7]=h[7],c[8]=h[8],c[9]=h[9],c[10]=h[10],c[11]=h[11],c[12]=h[12],c[13]=h[13],c[14]=h[14],c[15]=h[15],this}copyPosition(o){const c=this.elements,h=o.elements;return c[12]=h[12],c[13]=h[13],c[14]=h[14],this}setFromMatrix3(o){const c=o.elements;return this.set(c[0],c[3],c[6],0,c[1],c[4],c[7],0,c[2],c[5],c[8],0,0,0,0,1),this}extractBasis(o,c,h){return o.setFromMatrixColumn(this,0),c.setFromMatrixColumn(this,1),h.setFromMatrixColumn(this,2),this}makeBasis(o,c,h){return this.set(o.x,c.x,h.x,0,o.y,c.y,h.y,0,o.z,c.z,h.z,0,0,0,0,1),this}extractRotation(o){const c=this.elements,h=o.elements,m=1/Rc.setFromMatrixColumn(o,0).length(),M=1/Rc.setFromMatrixColumn(o,1).length(),N=1/Rc.setFromMatrixColumn(o,2).length();return c[0]=h[0]*m,c[1]=h[1]*m,c[2]=h[2]*m,c[3]=0,c[4]=h[4]*M,c[5]=h[5]*M,c[6]=h[6]*M,c[7]=0,c[8]=h[8]*N,c[9]=h[9]*N,c[10]=h[10]*N,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,this}makeRotationFromEuler(o){const c=this.elements,h=o.x,m=o.y,M=o.z,N=Math.cos(h),q=Math.sin(h),de=Math.cos(m),pe=Math.sin(m),xe=Math.cos(M),Ie=Math.sin(M);if("XYZ"===o.order){const Be=N*xe,Le=N*Ie,Ke=q*xe,ft=q*Ie;c[0]=de*xe,c[4]=-de*Ie,c[8]=pe,c[1]=Le+Ke*pe,c[5]=Be-ft*pe,c[9]=-q*de,c[2]=ft-Be*pe,c[6]=Ke+Le*pe,c[10]=N*de}else if("YXZ"===o.order){const Be=de*xe,Le=de*Ie,Ke=pe*xe,ft=pe*Ie;c[0]=Be+ft*q,c[4]=Ke*q-Le,c[8]=N*pe,c[1]=N*Ie,c[5]=N*xe,c[9]=-q,c[2]=Le*q-Ke,c[6]=ft+Be*q,c[10]=N*de}else if("ZXY"===o.order){const Be=de*xe,Le=de*Ie,Ke=pe*xe,ft=pe*Ie;c[0]=Be-ft*q,c[4]=-N*Ie,c[8]=Ke+Le*q,c[1]=Le+Ke*q,c[5]=N*xe,c[9]=ft-Be*q,c[2]=-N*pe,c[6]=q,c[10]=N*de}else if("ZYX"===o.order){const Be=N*xe,Le=N*Ie,Ke=q*xe,ft=q*Ie;c[0]=de*xe,c[4]=Ke*pe-Le,c[8]=Be*pe+ft,c[1]=de*Ie,c[5]=ft*pe+Be,c[9]=Le*pe-Ke,c[2]=-pe,c[6]=q*de,c[10]=N*de}else if("YZX"===o.order){const Be=N*de,Le=N*pe,Ke=q*de,ft=q*pe;c[0]=de*xe,c[4]=ft-Be*Ie,c[8]=Ke*Ie+Le,c[1]=Ie,c[5]=N*xe,c[9]=-q*xe,c[2]=-pe*xe,c[6]=Le*Ie+Ke,c[10]=Be-ft*Ie}else if("XZY"===o.order){const Be=N*de,Le=N*pe,Ke=q*de,ft=q*pe;c[0]=de*xe,c[4]=-Ie,c[8]=pe*xe,c[1]=Be*Ie+ft,c[5]=N*xe,c[9]=Le*Ie-Ke,c[2]=Ke*Ie-Le,c[6]=q*xe,c[10]=ft*Ie+Be}return c[3]=0,c[7]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,this}makeRotationFromQuaternion(o){return this.compose(kg,o,Sm)}lookAt(o,c,h){const m=this.elements;return vc.subVectors(o,c),0===vc.lengthSq()&&(vc.z=1),vc.normalize(),rh.crossVectors(h,vc),0===rh.lengthSq()&&(1===Math.abs(h.z)?vc.x+=1e-4:vc.z+=1e-4,vc.normalize(),rh.crossVectors(h,vc)),rh.normalize(),Em.crossVectors(vc,rh),m[0]=rh.x,m[4]=Em.x,m[8]=vc.x,m[1]=rh.y,m[5]=Em.y,m[9]=vc.y,m[2]=rh.z,m[6]=Em.z,m[10]=vc.z,this}multiply(o){return this.multiplyMatrices(this,o)}premultiply(o){return this.multiplyMatrices(o,this)}multiplyMatrices(o,c){const h=o.elements,m=c.elements,M=this.elements,N=h[0],q=h[4],de=h[8],pe=h[12],xe=h[1],Ie=h[5],Be=h[9],Le=h[13],Ke=h[2],ft=h[6],We=h[10],ze=h[14],Mt=h[3],ct=h[7],Dt=h[11],Jt=h[15],cn=m[0],rn=m[4],Rn=m[8],kt=m[12],Zt=m[1],li=m[5],Ti=m[9],ur=m[13],Yn=m[2],Di=m[6],rr=m[10],Li=m[14],br=m[3],Ji=m[7],lr=m[11],ei=m[15];return M[0]=N*cn+q*Zt+de*Yn+pe*br,M[4]=N*rn+q*li+de*Di+pe*Ji,M[8]=N*Rn+q*Ti+de*rr+pe*lr,M[12]=N*kt+q*ur+de*Li+pe*ei,M[1]=xe*cn+Ie*Zt+Be*Yn+Le*br,M[5]=xe*rn+Ie*li+Be*Di+Le*Ji,M[9]=xe*Rn+Ie*Ti+Be*rr+Le*lr,M[13]=xe*kt+Ie*ur+Be*Li+Le*ei,M[2]=Ke*cn+ft*Zt+We*Yn+ze*br,M[6]=Ke*rn+ft*li+We*Di+ze*Ji,M[10]=Ke*Rn+ft*Ti+We*rr+ze*lr,M[14]=Ke*kt+ft*ur+We*Li+ze*ei,M[3]=Mt*cn+ct*Zt+Dt*Yn+Jt*br,M[7]=Mt*rn+ct*li+Dt*Di+Jt*Ji,M[11]=Mt*Rn+ct*Ti+Dt*rr+Jt*lr,M[15]=Mt*kt+ct*ur+Dt*Li+Jt*ei,this}multiplyScalar(o){const c=this.elements;return c[0]*=o,c[4]*=o,c[8]*=o,c[12]*=o,c[1]*=o,c[5]*=o,c[9]*=o,c[13]*=o,c[2]*=o,c[6]*=o,c[10]*=o,c[14]*=o,c[3]*=o,c[7]*=o,c[11]*=o,c[15]*=o,this}determinant(){const o=this.elements,c=o[0],h=o[4],m=o[8],M=o[12],N=o[1],q=o[5],de=o[9],pe=o[13],xe=o[2],Ie=o[6],Be=o[10],Le=o[14];return o[3]*(+M*de*Ie-m*pe*Ie-M*q*Be+h*pe*Be+m*q*Le-h*de*Le)+o[7]*(+c*de*Le-c*pe*Be+M*N*Be-m*N*Le+m*pe*xe-M*de*xe)+o[11]*(+c*pe*Ie-c*q*Le-M*N*Ie+h*N*Le+M*q*xe-h*pe*xe)+o[15]*(-m*q*xe-c*de*Ie+c*q*Be+m*N*Ie-h*N*Be+h*de*xe)}transpose(){const o=this.elements;let c;return c=o[1],o[1]=o[4],o[4]=c,c=o[2],o[2]=o[8],o[8]=c,c=o[6],o[6]=o[9],o[9]=c,c=o[3],o[3]=o[12],o[12]=c,c=o[7],o[7]=o[13],o[13]=c,c=o[11],o[11]=o[14],o[14]=c,this}setPosition(o,c,h){const m=this.elements;return o.isVector3?(m[12]=o.x,m[13]=o.y,m[14]=o.z):(m[12]=o,m[13]=c,m[14]=h),this}invert(){const o=this.elements,c=o[0],h=o[1],m=o[2],M=o[3],N=o[4],q=o[5],de=o[6],pe=o[7],xe=o[8],Ie=o[9],Be=o[10],Le=o[11],Ke=o[12],ft=o[13],We=o[14],ze=o[15],Mt=Ie*We*pe-ft*Be*pe+ft*de*Le-q*We*Le-Ie*de*ze+q*Be*ze,ct=Ke*Be*pe-xe*We*pe-Ke*de*Le+N*We*Le+xe*de*ze-N*Be*ze,Dt=xe*ft*pe-Ke*Ie*pe+Ke*q*Le-N*ft*Le-xe*q*ze+N*Ie*ze,Jt=Ke*Ie*de-xe*ft*de-Ke*q*Be+N*ft*Be+xe*q*We-N*Ie*We,cn=c*Mt+h*ct+m*Dt+M*Jt;if(0===cn)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const rn=1/cn;return o[0]=Mt*rn,o[1]=(ft*Be*M-Ie*We*M-ft*m*Le+h*We*Le+Ie*m*ze-h*Be*ze)*rn,o[2]=(q*We*M-ft*de*M+ft*m*pe-h*We*pe-q*m*ze+h*de*ze)*rn,o[3]=(Ie*de*M-q*Be*M-Ie*m*pe+h*Be*pe+q*m*Le-h*de*Le)*rn,o[4]=ct*rn,o[5]=(xe*We*M-Ke*Be*M+Ke*m*Le-c*We*Le-xe*m*ze+c*Be*ze)*rn,o[6]=(Ke*de*M-N*We*M-Ke*m*pe+c*We*pe+N*m*ze-c*de*ze)*rn,o[7]=(N*Be*M-xe*de*M+xe*m*pe-c*Be*pe-N*m*Le+c*de*Le)*rn,o[8]=Dt*rn,o[9]=(Ke*Ie*M-xe*ft*M-Ke*h*Le+c*ft*Le+xe*h*ze-c*Ie*ze)*rn,o[10]=(N*ft*M-Ke*q*M+Ke*h*pe-c*ft*pe-N*h*ze+c*q*ze)*rn,o[11]=(xe*q*M-N*Ie*M-xe*h*pe+c*Ie*pe+N*h*Le-c*q*Le)*rn,o[12]=Jt*rn,o[13]=(xe*ft*m-Ke*Ie*m+Ke*h*Be-c*ft*Be-xe*h*We+c*Ie*We)*rn,o[14]=(Ke*q*m-N*ft*m-Ke*h*de+c*ft*de+N*h*We-c*q*We)*rn,o[15]=(N*Ie*m-xe*q*m+xe*h*de-c*Ie*de-N*h*Be+c*q*Be)*rn,this}scale(o){const c=this.elements,h=o.x,m=o.y,M=o.z;return c[0]*=h,c[4]*=m,c[8]*=M,c[1]*=h,c[5]*=m,c[9]*=M,c[2]*=h,c[6]*=m,c[10]*=M,c[3]*=h,c[7]*=m,c[11]*=M,this}getMaxScaleOnAxis(){const o=this.elements;return Math.sqrt(Math.max(o[0]*o[0]+o[1]*o[1]+o[2]*o[2],o[4]*o[4]+o[5]*o[5]+o[6]*o[6],o[8]*o[8]+o[9]*o[9]+o[10]*o[10]))}makeTranslation(o,c,h){return o.isVector3?this.set(1,0,0,o.x,0,1,0,o.y,0,0,1,o.z,0,0,0,1):this.set(1,0,0,o,0,1,0,c,0,0,1,h,0,0,0,1),this}makeRotationX(o){const c=Math.cos(o),h=Math.sin(o);return this.set(1,0,0,0,0,c,-h,0,0,h,c,0,0,0,0,1),this}makeRotationY(o){const c=Math.cos(o),h=Math.sin(o);return this.set(c,0,h,0,0,1,0,0,-h,0,c,0,0,0,0,1),this}makeRotationZ(o){const c=Math.cos(o),h=Math.sin(o);return this.set(c,-h,0,0,h,c,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(o,c){const h=Math.cos(c),m=Math.sin(c),M=1-h,N=o.x,q=o.y,de=o.z,pe=M*N,xe=M*q;return this.set(pe*N+h,pe*q-m*de,pe*de+m*q,0,pe*q+m*de,xe*q+h,xe*de-m*N,0,pe*de-m*q,xe*de+m*N,M*de*de+h,0,0,0,0,1),this}makeScale(o,c,h){return this.set(o,0,0,0,0,c,0,0,0,0,h,0,0,0,0,1),this}makeShear(o,c,h,m,M,N){return this.set(1,h,M,0,o,1,N,0,c,m,1,0,0,0,0,1),this}compose(o,c,h){const m=this.elements,M=c._x,N=c._y,q=c._z,de=c._w,pe=M+M,xe=N+N,Ie=q+q,Be=M*pe,Le=M*xe,Ke=M*Ie,ft=N*xe,We=N*Ie,ze=q*Ie,Mt=de*pe,ct=de*xe,Dt=de*Ie,Jt=h.x,cn=h.y,rn=h.z;return m[0]=(1-(ft+ze))*Jt,m[1]=(Le+Dt)*Jt,m[2]=(Ke-ct)*Jt,m[3]=0,m[4]=(Le-Dt)*cn,m[5]=(1-(Be+ze))*cn,m[6]=(We+Mt)*cn,m[7]=0,m[8]=(Ke+ct)*rn,m[9]=(We-Mt)*rn,m[10]=(1-(Be+ft))*rn,m[11]=0,m[12]=o.x,m[13]=o.y,m[14]=o.z,m[15]=1,this}decompose(o,c,h){const m=this.elements;let M=Rc.set(m[0],m[1],m[2]).length();const N=Rc.set(m[4],m[5],m[6]).length(),q=Rc.set(m[8],m[9],m[10]).length();this.determinant()<0&&(M=-M),o.x=m[12],o.y=m[13],o.z=m[14],jc.copy(this);const pe=1/M,xe=1/N,Ie=1/q;return jc.elements[0]*=pe,jc.elements[1]*=pe,jc.elements[2]*=pe,jc.elements[4]*=xe,jc.elements[5]*=xe,jc.elements[6]*=xe,jc.elements[8]*=Ie,jc.elements[9]*=Ie,jc.elements[10]*=Ie,c.setFromRotationMatrix(jc),h.x=M,h.y=N,h.z=q,this}makePerspective(o,c,h,m,M,N,q=Dd){const de=this.elements,pe=2*M/(c-o),xe=2*M/(h-m),Ie=(c+o)/(c-o),Be=(h+m)/(h-m);let Le,Ke;if(q===Dd)Le=-(N+M)/(N-M),Ke=-2*N*M/(N-M);else{if(2001!==q)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+q);Le=-N/(N-M),Ke=-N*M/(N-M)}return de[0]=pe,de[4]=0,de[8]=Ie,de[12]=0,de[1]=0,de[5]=xe,de[9]=Be,de[13]=0,de[2]=0,de[6]=0,de[10]=Le,de[14]=Ke,de[3]=0,de[7]=0,de[11]=-1,de[15]=0,this}makeOrthographic(o,c,h,m,M,N,q=Dd){const de=this.elements,pe=1/(c-o),xe=1/(h-m),Ie=1/(N-M),Be=(c+o)*pe,Le=(h+m)*xe;let Ke,ft;if(q===Dd)Ke=(N+M)*Ie,ft=-2*Ie;else{if(2001!==q)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+q);Ke=M*Ie,ft=-1*Ie}return de[0]=2*pe,de[4]=0,de[8]=0,de[12]=-Be,de[1]=0,de[5]=2*xe,de[9]=0,de[13]=-Le,de[2]=0,de[6]=0,de[10]=ft,de[14]=-Ke,de[3]=0,de[7]=0,de[11]=0,de[15]=1,this}equals(o){const c=this.elements,h=o.elements;for(let m=0;m<16;m++)if(c[m]!==h[m])return!1;return!0}fromArray(o,c=0){for(let h=0;h<16;h++)this.elements[h]=o[h+c];return this}toArray(o=[],c=0){const h=this.elements;return o[c]=h[0],o[c+1]=h[1],o[c+2]=h[2],o[c+3]=h[3],o[c+4]=h[4],o[c+5]=h[5],o[c+6]=h[6],o[c+7]=h[7],o[c+8]=h[8],o[c+9]=h[9],o[c+10]=h[10],o[c+11]=h[11],o[c+12]=h[12],o[c+13]=h[13],o[c+14]=h[14],o[c+15]=h[15],o}}const Rc=new Ft,jc=new bo,kg=new Ft(0,0,0),Sm=new Ft(1,1,1),rh=new Ft,Em=new Ft,vc=new Ft;function bA(){let w=null,o=!1,c=null,h=null;function m(M,N){c(M,N),h=w.requestAnimationFrame(m)}return{start:function(){!0!==o&&null!==c&&(h=w.requestAnimationFrame(m),o=!0)},stop:function(){w.cancelAnimationFrame(h),o=!1},setAnimationLoop:function(M){c=M},setContext:function(M){w=M}}}function Bp(w,o){const c=o.isWebGL2,h=new WeakMap;return{get:function N(pe){return pe.isInterleavedBufferAttribute&&(pe=pe.data),h.get(pe)},remove:function q(pe){pe.isInterleavedBufferAttribute&&(pe=pe.data);const xe=h.get(pe);xe&&(w.deleteBuffer(xe.buffer),h.delete(pe))},update:function de(pe,xe){if(pe.isGLBufferAttribute){const Be=h.get(pe);return void((!Be||Be.version<pe.version)&&h.set(pe,{buffer:pe.buffer,type:pe.type,bytesPerElement:pe.elementSize,version:pe.version}))}pe.isInterleavedBufferAttribute&&(pe=pe.data);const Ie=h.get(pe);void 0===Ie?h.set(pe,function m(pe,xe){const Ie=pe.array,Be=pe.usage,Le=w.createBuffer();let Ke;if(w.bindBuffer(xe,Le),w.bufferData(xe,Ie,Be),pe.onUploadCallback(),Ie instanceof Float32Array)Ke=w.FLOAT;else if(Ie instanceof Uint16Array)if(pe.isFloat16BufferAttribute){if(!c)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");Ke=w.HALF_FLOAT}else Ke=w.UNSIGNED_SHORT;else if(Ie instanceof Int16Array)Ke=w.SHORT;else if(Ie instanceof Uint32Array)Ke=w.UNSIGNED_INT;else if(Ie instanceof Int32Array)Ke=w.INT;else if(Ie instanceof Int8Array)Ke=w.BYTE;else if(Ie instanceof Uint8Array)Ke=w.UNSIGNED_BYTE;else{if(!(Ie instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+Ie);Ke=w.UNSIGNED_BYTE}return{buffer:Le,type:Ke,bytesPerElement:Ie.BYTES_PER_ELEMENT,version:pe.version}}(pe,xe)):Ie.version<pe.version&&(function M(pe,xe,Ie){const Be=xe.array,Le=xe.updateRange;w.bindBuffer(Ie,pe),-1===Le.count?w.bufferSubData(Ie,0,Be):(c?w.bufferSubData(Ie,Le.offset*Be.BYTES_PER_ELEMENT,Be,Le.offset,Le.count):w.bufferSubData(Ie,Le.offset*Be.BYTES_PER_ELEMENT,Be.subarray(Le.offset,Le.offset+Le.count)),Le.count=-1),xe.onUploadCallback()}(Ie.buffer,pe,xe),Ie.version=pe.version)}}}const Nl=new Ft,Rp=new zi;class sa{constructor(o,c,h=!1){if(Array.isArray(o))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=o,this.itemSize=c,this.count=void 0!==o?o.length/c:0,this.normalized=h,this.usage=35044,this.updateRange={offset:0,count:-1},this.gpuType=dn,this.version=0}onUploadCallback(){}set needsUpdate(o){!0===o&&this.version++}setUsage(o){return this.usage=o,this}copy(o){return this.name=o.name,this.array=new o.array.constructor(o.array),this.itemSize=o.itemSize,this.count=o.count,this.normalized=o.normalized,this.usage=o.usage,this.gpuType=o.gpuType,this}copyAt(o,c,h){o*=this.itemSize,h*=c.itemSize;for(let m=0,M=this.itemSize;m<M;m++)this.array[o+m]=c.array[h+m];return this}copyArray(o){return this.array.set(o),this}applyMatrix3(o){if(2===this.itemSize)for(let c=0,h=this.count;c<h;c++)Rp.fromBufferAttribute(this,c),Rp.applyMatrix3(o),this.setXY(c,Rp.x,Rp.y);else if(3===this.itemSize)for(let c=0,h=this.count;c<h;c++)Nl.fromBufferAttribute(this,c),Nl.applyMatrix3(o),this.setXYZ(c,Nl.x,Nl.y,Nl.z);return this}applyMatrix4(o){for(let c=0,h=this.count;c<h;c++)Nl.fromBufferAttribute(this,c),Nl.applyMatrix4(o),this.setXYZ(c,Nl.x,Nl.y,Nl.z);return this}applyNormalMatrix(o){for(let c=0,h=this.count;c<h;c++)Nl.fromBufferAttribute(this,c),Nl.applyNormalMatrix(o),this.setXYZ(c,Nl.x,Nl.y,Nl.z);return this}transformDirection(o){for(let c=0,h=this.count;c<h;c++)Nl.fromBufferAttribute(this,c),Nl.transformDirection(o),this.setXYZ(c,Nl.x,Nl.y,Nl.z);return this}set(o,c=0){return this.array.set(o,c),this}getComponent(o,c){let h=this.array[o*this.itemSize+c];return this.normalized&&(h=Kl(h,this.array)),h}setComponent(o,c,h){return this.normalized&&(h=ko(h,this.array)),this.array[o*this.itemSize+c]=h,this}getX(o){let c=this.array[o*this.itemSize];return this.normalized&&(c=Kl(c,this.array)),c}setX(o,c){return this.normalized&&(c=ko(c,this.array)),this.array[o*this.itemSize]=c,this}getY(o){let c=this.array[o*this.itemSize+1];return this.normalized&&(c=Kl(c,this.array)),c}setY(o,c){return this.normalized&&(c=ko(c,this.array)),this.array[o*this.itemSize+1]=c,this}getZ(o){let c=this.array[o*this.itemSize+2];return this.normalized&&(c=Kl(c,this.array)),c}setZ(o,c){return this.normalized&&(c=ko(c,this.array)),this.array[o*this.itemSize+2]=c,this}getW(o){let c=this.array[o*this.itemSize+3];return this.normalized&&(c=Kl(c,this.array)),c}setW(o,c){return this.normalized&&(c=ko(c,this.array)),this.array[o*this.itemSize+3]=c,this}setXY(o,c,h){return o*=this.itemSize,this.normalized&&(c=ko(c,this.array),h=ko(h,this.array)),this.array[o+0]=c,this.array[o+1]=h,this}setXYZ(o,c,h,m){return o*=this.itemSize,this.normalized&&(c=ko(c,this.array),h=ko(h,this.array),m=ko(m,this.array)),this.array[o+0]=c,this.array[o+1]=h,this.array[o+2]=m,this}setXYZW(o,c,h,m,M){return o*=this.itemSize,this.normalized&&(c=ko(c,this.array),h=ko(h,this.array),m=ko(m,this.array),M=ko(M,this.array)),this.array[o+0]=c,this.array[o+1]=h,this.array[o+2]=m,this.array[o+3]=M,this}onUpload(o){return this.onUploadCallback=o,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const o={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(o.name=this.name),35044!==this.usage&&(o.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(o.updateRange=this.updateRange),o}}class _1 extends sa{constructor(o,c,h){super(new Uint16Array(o),c,h)}}class wA extends sa{constructor(o,c,h){super(new Uint32Array(o),c,h)}}class Bo extends sa{constructor(o,c,h){super(new Float32Array(o),c,h)}}const sh=new bo,Tl=new Lu;let Gr=(()=>{class w{constructor(c=0,h=0,m=0,M=w.DEFAULT_ORDER){this.isEuler=!0,this._x=c,this._y=h,this._z=m,this._order=M}get x(){return this._x}set x(c){this._x=c,this._onChangeCallback()}get y(){return this._y}set y(c){this._y=c,this._onChangeCallback()}get z(){return this._z}set z(c){this._z=c,this._onChangeCallback()}get order(){return this._order}set order(c){this._order=c,this._onChangeCallback()}set(c,h,m,M=this._order){return this._x=c,this._y=h,this._z=m,this._order=M,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(c){return this._x=c._x,this._y=c._y,this._z=c._z,this._order=c._order,this._onChangeCallback(),this}setFromRotationMatrix(c,h=this._order,m=!0){const M=c.elements,N=M[0],q=M[4],de=M[8],pe=M[1],xe=M[5],Ie=M[9],Be=M[2],Le=M[6],Ke=M[10];switch(h){case"XYZ":this._y=Math.asin(nl(de,-1,1)),Math.abs(de)<.9999999?(this._x=Math.atan2(-Ie,Ke),this._z=Math.atan2(-q,N)):(this._x=Math.atan2(Le,xe),this._z=0);break;case"YXZ":this._x=Math.asin(-nl(Ie,-1,1)),Math.abs(Ie)<.9999999?(this._y=Math.atan2(de,Ke),this._z=Math.atan2(pe,xe)):(this._y=Math.atan2(-Be,N),this._z=0);break;case"ZXY":this._x=Math.asin(nl(Le,-1,1)),Math.abs(Le)<.9999999?(this._y=Math.atan2(-Be,Ke),this._z=Math.atan2(-q,xe)):(this._y=0,this._z=Math.atan2(pe,N));break;case"ZYX":this._y=Math.asin(-nl(Be,-1,1)),Math.abs(Be)<.9999999?(this._x=Math.atan2(Le,Ke),this._z=Math.atan2(pe,N)):(this._x=0,this._z=Math.atan2(-q,xe));break;case"YZX":this._z=Math.asin(nl(pe,-1,1)),Math.abs(pe)<.9999999?(this._x=Math.atan2(-Ie,xe),this._y=Math.atan2(-Be,N)):(this._x=0,this._y=Math.atan2(de,Ke));break;case"XZY":this._z=Math.asin(-nl(q,-1,1)),Math.abs(q)<.9999999?(this._x=Math.atan2(Le,xe),this._y=Math.atan2(de,N)):(this._x=Math.atan2(-Ie,Ke),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+h)}return this._order=h,!0===m&&this._onChangeCallback(),this}setFromQuaternion(c,h,m){return sh.makeRotationFromQuaternion(c),this.setFromRotationMatrix(sh,h,m)}setFromVector3(c,h=this._order){return this.set(c.x,c.y,c.z,h)}reorder(c){return Tl.setFromEuler(this),this.setFromQuaternion(Tl,c)}equals(c){return c._x===this._x&&c._y===this._y&&c._z===this._z&&c._order===this._order}fromArray(c){return this._x=c[0],this._y=c[1],this._z=c[2],void 0!==c[3]&&(this._order=c[3]),this._onChangeCallback(),this}toArray(c=[],h=0){return c[h]=this._x,c[h+1]=this._y,c[h+2]=this._z,c[h+3]=this._order,c}_onChange(c){return this._onChangeCallback=c,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return w.DEFAULT_ORDER="XYZ",w})();class so{constructor(){this.mask=1}set(o){this.mask=1<<o>>>0}enable(o){this.mask|=1<<o}enableAll(){this.mask=-1}toggle(o){this.mask^=1<<o}disable(o){this.mask&=~(1<<o)}disableAll(){this.mask=0}test(o){return!!(this.mask&o.mask)}isEnabled(o){return!!(this.mask&1<<o)}}let ml=0;const Zd=new Ft,oc=new Lu,Ul=new bo,tf=new Ft,Ka=new Ft,$c=new Ft,zu=new Lu,Mo=new Ft(1,0,0),kp=new Ft(0,1,0),j0=new Ft(0,0,1),nf={type:"added"},Yo={type:"removed"};let Rl=(()=>{class w extends xh{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:ml++}),this.uuid=gu(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=w.DEFAULT_UP.clone();const c=new Ft,h=new Gr,m=new Lu,M=new Ft(1,1,1);h._onChange(function N(){m.setFromEuler(h,!1)}),m._onChange(function q(){h.setFromQuaternion(m,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:c},rotation:{configurable:!0,enumerable:!0,value:h},quaternion:{configurable:!0,enumerable:!0,value:m},scale:{configurable:!0,enumerable:!0,value:M},modelViewMatrix:{value:new bo},normalMatrix:{value:new zo}}),this.matrix=new bo,this.matrixWorld=new bo,this.matrixAutoUpdate=w.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=w.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new so,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(c){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(c),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(c){return this.quaternion.premultiply(c),this}setRotationFromAxisAngle(c,h){this.quaternion.setFromAxisAngle(c,h)}setRotationFromEuler(c){this.quaternion.setFromEuler(c,!0)}setRotationFromMatrix(c){this.quaternion.setFromRotationMatrix(c)}setRotationFromQuaternion(c){this.quaternion.copy(c)}rotateOnAxis(c,h){return oc.setFromAxisAngle(c,h),this.quaternion.multiply(oc),this}rotateOnWorldAxis(c,h){return oc.setFromAxisAngle(c,h),this.quaternion.premultiply(oc),this}rotateX(c){return this.rotateOnAxis(Mo,c)}rotateY(c){return this.rotateOnAxis(kp,c)}rotateZ(c){return this.rotateOnAxis(j0,c)}translateOnAxis(c,h){return Zd.copy(c).applyQuaternion(this.quaternion),this.position.add(Zd.multiplyScalar(h)),this}translateX(c){return this.translateOnAxis(Mo,c)}translateY(c){return this.translateOnAxis(kp,c)}translateZ(c){return this.translateOnAxis(j0,c)}localToWorld(c){return this.updateWorldMatrix(!0,!1),c.applyMatrix4(this.matrixWorld)}worldToLocal(c){return this.updateWorldMatrix(!0,!1),c.applyMatrix4(Ul.copy(this.matrixWorld).invert())}lookAt(c,h,m){c.isVector3?tf.copy(c):tf.set(c,h,m);const M=this.parent;this.updateWorldMatrix(!0,!1),Ka.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ul.lookAt(Ka,tf,this.up):Ul.lookAt(tf,Ka,this.up),this.quaternion.setFromRotationMatrix(Ul),M&&(Ul.extractRotation(M.matrixWorld),oc.setFromRotationMatrix(Ul),this.quaternion.premultiply(oc.invert()))}add(c){if(arguments.length>1){for(let h=0;h<arguments.length;h++)this.add(arguments[h]);return this}return c===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",c),this):(c&&c.isObject3D?(null!==c.parent&&c.parent.remove(c),c.parent=this,this.children.push(c),c.dispatchEvent(nf)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",c),this)}remove(c){if(arguments.length>1){for(let m=0;m<arguments.length;m++)this.remove(arguments[m]);return this}const h=this.children.indexOf(c);return-1!==h&&(c.parent=null,this.children.splice(h,1),c.dispatchEvent(Yo)),this}removeFromParent(){const c=this.parent;return null!==c&&c.remove(this),this}clear(){return this.remove(...this.children)}attach(c){return this.updateWorldMatrix(!0,!1),Ul.copy(this.matrixWorld).invert(),null!==c.parent&&(c.parent.updateWorldMatrix(!0,!1),Ul.multiply(c.parent.matrixWorld)),c.applyMatrix4(Ul),this.add(c),c.updateWorldMatrix(!1,!0),this}getObjectById(c){return this.getObjectByProperty("id",c)}getObjectByName(c){return this.getObjectByProperty("name",c)}getObjectByProperty(c,h){if(this[c]===h)return this;for(let m=0,M=this.children.length;m<M;m++){const q=this.children[m].getObjectByProperty(c,h);if(void 0!==q)return q}}getObjectsByProperty(c,h){let m=[];this[c]===h&&m.push(this);for(let M=0,N=this.children.length;M<N;M++){const q=this.children[M].getObjectsByProperty(c,h);q.length>0&&(m=m.concat(q))}return m}getWorldPosition(c){return this.updateWorldMatrix(!0,!1),c.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(c){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ka,c,$c),c}getWorldScale(c){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ka,zu,c),c}getWorldDirection(c){this.updateWorldMatrix(!0,!1);const h=this.matrixWorld.elements;return c.set(h[8],h[9],h[10]).normalize()}raycast(){}traverse(c){c(this);const h=this.children;for(let m=0,M=h.length;m<M;m++)h[m].traverse(c)}traverseVisible(c){if(!1===this.visible)return;c(this);const h=this.children;for(let m=0,M=h.length;m<M;m++)h[m].traverseVisible(c)}traverseAncestors(c){const h=this.parent;null!==h&&(c(h),h.traverseAncestors(c))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(c){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||c)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,c=!0);const h=this.children;for(let m=0,M=h.length;m<M;m++){const N=h[m];(!0===N.matrixWorldAutoUpdate||!0===c)&&N.updateMatrixWorld(c)}}updateWorldMatrix(c,h){const m=this.parent;if(!0===c&&null!==m&&!0===m.matrixWorldAutoUpdate&&m.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===h){const M=this.children;for(let N=0,q=M.length;N<q;N++){const de=M[N];!0===de.matrixWorldAutoUpdate&&de.updateWorldMatrix(!1,!0)}}}toJSON(c){const h=void 0===c||"string"==typeof c,m={};h&&(c={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},m.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const M={};function N(de,pe){return void 0===de[pe.uuid]&&(de[pe.uuid]=pe.toJSON(c)),pe.uuid}if(M.uuid=this.uuid,M.type=this.type,""!==this.name&&(M.name=this.name),!0===this.castShadow&&(M.castShadow=!0),!0===this.receiveShadow&&(M.receiveShadow=!0),!1===this.visible&&(M.visible=!1),!1===this.frustumCulled&&(M.frustumCulled=!1),0!==this.renderOrder&&(M.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(M.userData=this.userData),M.layers=this.layers.mask,M.matrix=this.matrix.toArray(),M.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(M.matrixAutoUpdate=!1),this.isInstancedMesh&&(M.type="InstancedMesh",M.count=this.count,M.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(M.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?M.background=this.background.toJSON():this.background.isTexture&&(M.background=this.background.toJSON(c).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(M.environment=this.environment.toJSON(c).uuid);else if(this.isMesh||this.isLine||this.isPoints){M.geometry=N(c.geometries,this.geometry);const de=this.geometry.parameters;if(void 0!==de&&void 0!==de.shapes){const pe=de.shapes;if(Array.isArray(pe))for(let xe=0,Ie=pe.length;xe<Ie;xe++)N(c.shapes,pe[xe]);else N(c.shapes,pe)}}if(this.isSkinnedMesh&&(M.bindMode=this.bindMode,M.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(N(c.skeletons,this.skeleton),M.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const de=[];for(let pe=0,xe=this.material.length;pe<xe;pe++)de.push(N(c.materials,this.material[pe]));M.material=de}else M.material=N(c.materials,this.material);if(this.children.length>0){M.children=[];for(let de=0;de<this.children.length;de++)M.children.push(this.children[de].toJSON(c).object)}if(this.animations.length>0){M.animations=[];for(let de=0;de<this.animations.length;de++)M.animations.push(N(c.animations,this.animations[de]))}if(h){const de=q(c.geometries),pe=q(c.materials),xe=q(c.textures),Ie=q(c.images),Be=q(c.shapes),Le=q(c.skeletons),Ke=q(c.animations),ft=q(c.nodes);de.length>0&&(m.geometries=de),pe.length>0&&(m.materials=pe),xe.length>0&&(m.textures=xe),Ie.length>0&&(m.images=Ie),Be.length>0&&(m.shapes=Be),Le.length>0&&(m.skeletons=Le),Ke.length>0&&(m.animations=Ke),ft.length>0&&(m.nodes=ft)}return m.object=M,m;function q(de){const pe=[];for(const xe in de){const Ie=de[xe];delete Ie.metadata,pe.push(Ie)}return pe}}clone(c){return(new this.constructor).copy(this,c)}copy(c,h=!0){if(this.name=c.name,this.up.copy(c.up),this.position.copy(c.position),this.rotation.order=c.rotation.order,this.quaternion.copy(c.quaternion),this.scale.copy(c.scale),this.matrix.copy(c.matrix),this.matrixWorld.copy(c.matrixWorld),this.matrixAutoUpdate=c.matrixAutoUpdate,this.matrixWorldNeedsUpdate=c.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=c.matrixWorldAutoUpdate,this.layers.mask=c.layers.mask,this.visible=c.visible,this.castShadow=c.castShadow,this.receiveShadow=c.receiveShadow,this.frustumCulled=c.frustumCulled,this.renderOrder=c.renderOrder,this.animations=c.animations.slice(),this.userData=JSON.parse(JSON.stringify(c.userData)),!0===h)for(let m=0;m<c.children.length;m++)this.add(c.children[m].clone());return this}}return w.DEFAULT_UP=new Ft(0,1,0),w.DEFAULT_MATRIX_AUTO_UPDATE=!0,w.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,w})(),Tm=0;const bc=new bo,Fp=new Rl,Op=new Ft,ac=new rl,Bd=new rl,Dl=new Ft;class Cs extends xh{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Tm++}),this.uuid=gu(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(o){return this.index=Array.isArray(o)?new(Wc(o)?wA:_1)(o,1):o,this}getAttribute(o){return this.attributes[o]}setAttribute(o,c){return this.attributes[o]=c,this}deleteAttribute(o){return delete this.attributes[o],this}hasAttribute(o){return void 0!==this.attributes[o]}addGroup(o,c,h=0){this.groups.push({start:o,count:c,materialIndex:h})}clearGroups(){this.groups=[]}setDrawRange(o,c){this.drawRange.start=o,this.drawRange.count=c}applyMatrix4(o){const c=this.attributes.position;void 0!==c&&(c.applyMatrix4(o),c.needsUpdate=!0);const h=this.attributes.normal;if(void 0!==h){const M=(new zo).getNormalMatrix(o);h.applyNormalMatrix(M),h.needsUpdate=!0}const m=this.attributes.tangent;return void 0!==m&&(m.transformDirection(o),m.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(o){return bc.makeRotationFromQuaternion(o),this.applyMatrix4(bc),this}rotateX(o){return bc.makeRotationX(o),this.applyMatrix4(bc),this}rotateY(o){return bc.makeRotationY(o),this.applyMatrix4(bc),this}rotateZ(o){return bc.makeRotationZ(o),this.applyMatrix4(bc),this}translate(o,c,h){return bc.makeTranslation(o,c,h),this.applyMatrix4(bc),this}scale(o,c,h){return bc.makeScale(o,c,h),this.applyMatrix4(bc),this}lookAt(o){return Fp.lookAt(o),Fp.updateMatrix(),this.applyMatrix4(Fp.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Op).negate(),this.translate(Op.x,Op.y,Op.z),this}setFromPoints(o){const c=[];for(let h=0,m=o.length;h<m;h++){const M=o[h];c.push(M.x,M.y,M.z||0)}return this.setAttribute("position",new Bo(c,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new rl);const o=this.attributes.position,c=this.morphAttributes.position;if(o&&o.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Ft(-1/0,-1/0,-1/0),new Ft(1/0,1/0,1/0));if(void 0!==o){if(this.boundingBox.setFromBufferAttribute(o),c)for(let h=0,m=c.length;h<m;h++)ac.setFromBufferAttribute(c[h]),this.morphTargetsRelative?(Dl.addVectors(this.boundingBox.min,ac.min),this.boundingBox.expandByPoint(Dl),Dl.addVectors(this.boundingBox.max,ac.max),this.boundingBox.expandByPoint(Dl)):(this.boundingBox.expandByPoint(ac.min),this.boundingBox.expandByPoint(ac.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Kd);const o=this.attributes.position,c=this.morphAttributes.position;if(o&&o.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Ft,1/0);if(o){const h=this.boundingSphere.center;if(ac.setFromBufferAttribute(o),c)for(let M=0,N=c.length;M<N;M++)Bd.setFromBufferAttribute(c[M]),this.morphTargetsRelative?(Dl.addVectors(ac.min,Bd.min),ac.expandByPoint(Dl),Dl.addVectors(ac.max,Bd.max),ac.expandByPoint(Dl)):(ac.expandByPoint(Bd.min),ac.expandByPoint(Bd.max));ac.getCenter(h);let m=0;for(let M=0,N=o.count;M<N;M++)Dl.fromBufferAttribute(o,M),m=Math.max(m,h.distanceToSquared(Dl));if(c)for(let M=0,N=c.length;M<N;M++){const q=c[M],de=this.morphTargetsRelative;for(let pe=0,xe=q.count;pe<xe;pe++)Dl.fromBufferAttribute(q,pe),de&&(Op.fromBufferAttribute(o,pe),Dl.add(Op)),m=Math.max(m,h.distanceToSquared(Dl))}this.boundingSphere.radius=Math.sqrt(m),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const o=this.index,c=this.attributes;if(null===o||void 0===c.position||void 0===c.normal||void 0===c.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const h=o.array,m=c.position.array,M=c.normal.array,N=c.uv.array,q=m.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new sa(new Float32Array(4*q),4));const de=this.getAttribute("tangent").array,pe=[],xe=[];for(let Zt=0;Zt<q;Zt++)pe[Zt]=new Ft,xe[Zt]=new Ft;const Ie=new Ft,Be=new Ft,Le=new Ft,Ke=new zi,ft=new zi,We=new zi,ze=new Ft,Mt=new Ft;function ct(Zt,li,Ti){Ie.fromArray(m,3*Zt),Be.fromArray(m,3*li),Le.fromArray(m,3*Ti),Ke.fromArray(N,2*Zt),ft.fromArray(N,2*li),We.fromArray(N,2*Ti),Be.sub(Ie),Le.sub(Ie),ft.sub(Ke),We.sub(Ke);const ur=1/(ft.x*We.y-We.x*ft.y);isFinite(ur)&&(ze.copy(Be).multiplyScalar(We.y).addScaledVector(Le,-ft.y).multiplyScalar(ur),Mt.copy(Le).multiplyScalar(ft.x).addScaledVector(Be,-We.x).multiplyScalar(ur),pe[Zt].add(ze),pe[li].add(ze),pe[Ti].add(ze),xe[Zt].add(Mt),xe[li].add(Mt),xe[Ti].add(Mt))}let Dt=this.groups;0===Dt.length&&(Dt=[{start:0,count:h.length}]);for(let Zt=0,li=Dt.length;Zt<li;++Zt){const Ti=Dt[Zt],ur=Ti.start;for(let Di=ur,rr=ur+Ti.count;Di<rr;Di+=3)ct(h[Di+0],h[Di+1],h[Di+2])}const Jt=new Ft,cn=new Ft,rn=new Ft,Rn=new Ft;function kt(Zt){rn.fromArray(M,3*Zt),Rn.copy(rn);const li=pe[Zt];Jt.copy(li),Jt.sub(rn.multiplyScalar(rn.dot(li))).normalize(),cn.crossVectors(Rn,li);const ur=cn.dot(xe[Zt])<0?-1:1;de[4*Zt]=Jt.x,de[4*Zt+1]=Jt.y,de[4*Zt+2]=Jt.z,de[4*Zt+3]=ur}for(let Zt=0,li=Dt.length;Zt<li;++Zt){const Ti=Dt[Zt],ur=Ti.start;for(let Di=ur,rr=ur+Ti.count;Di<rr;Di+=3)kt(h[Di+0]),kt(h[Di+1]),kt(h[Di+2])}}computeVertexNormals(){const o=this.index,c=this.getAttribute("position");if(void 0!==c){let h=this.getAttribute("normal");if(void 0===h)h=new sa(new Float32Array(3*c.count),3),this.setAttribute("normal",h);else for(let Be=0,Le=h.count;Be<Le;Be++)h.setXYZ(Be,0,0,0);const m=new Ft,M=new Ft,N=new Ft,q=new Ft,de=new Ft,pe=new Ft,xe=new Ft,Ie=new Ft;if(o)for(let Be=0,Le=o.count;Be<Le;Be+=3){const Ke=o.getX(Be+0),ft=o.getX(Be+1),We=o.getX(Be+2);m.fromBufferAttribute(c,Ke),M.fromBufferAttribute(c,ft),N.fromBufferAttribute(c,We),xe.subVectors(N,M),Ie.subVectors(m,M),xe.cross(Ie),q.fromBufferAttribute(h,Ke),de.fromBufferAttribute(h,ft),pe.fromBufferAttribute(h,We),q.add(xe),de.add(xe),pe.add(xe),h.setXYZ(Ke,q.x,q.y,q.z),h.setXYZ(ft,de.x,de.y,de.z),h.setXYZ(We,pe.x,pe.y,pe.z)}else for(let Be=0,Le=c.count;Be<Le;Be+=3)m.fromBufferAttribute(c,Be+0),M.fromBufferAttribute(c,Be+1),N.fromBufferAttribute(c,Be+2),xe.subVectors(N,M),Ie.subVectors(m,M),xe.cross(Ie),h.setXYZ(Be+0,xe.x,xe.y,xe.z),h.setXYZ(Be+1,xe.x,xe.y,xe.z),h.setXYZ(Be+2,xe.x,xe.y,xe.z);this.normalizeNormals(),h.needsUpdate=!0}}normalizeNormals(){const o=this.attributes.normal;for(let c=0,h=o.count;c<h;c++)Dl.fromBufferAttribute(o,c),Dl.normalize(),o.setXYZ(c,Dl.x,Dl.y,Dl.z)}toNonIndexed(){function o(q,de){const pe=q.array,xe=q.itemSize,Ie=q.normalized,Be=new pe.constructor(de.length*xe);let Le=0,Ke=0;for(let ft=0,We=de.length;ft<We;ft++){Le=q.isInterleavedBufferAttribute?de[ft]*q.data.stride+q.offset:de[ft]*xe;for(let ze=0;ze<xe;ze++)Be[Ke++]=pe[Le++]}return new sa(Be,xe,Ie)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const c=new Cs,h=this.index.array,m=this.attributes;for(const q in m){const pe=o(m[q],h);c.setAttribute(q,pe)}const M=this.morphAttributes;for(const q in M){const de=[],pe=M[q];for(let xe=0,Ie=pe.length;xe<Ie;xe++){const Le=o(pe[xe],h);de.push(Le)}c.morphAttributes[q]=de}c.morphTargetsRelative=this.morphTargetsRelative;const N=this.groups;for(let q=0,de=N.length;q<de;q++){const pe=N[q];c.addGroup(pe.start,pe.count,pe.materialIndex)}return c}toJSON(){const o={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(o.uuid=this.uuid,o.type=this.type,""!==this.name&&(o.name=this.name),Object.keys(this.userData).length>0&&(o.userData=this.userData),void 0!==this.parameters){const de=this.parameters;for(const pe in de)void 0!==de[pe]&&(o[pe]=de[pe]);return o}o.data={attributes:{}};const c=this.index;null!==c&&(o.data.index={type:c.array.constructor.name,array:Array.prototype.slice.call(c.array)});const h=this.attributes;for(const de in h)o.data.attributes[de]=h[de].toJSON(o.data);const m={};let M=!1;for(const de in this.morphAttributes){const pe=this.morphAttributes[de],xe=[];for(let Ie=0,Be=pe.length;Ie<Be;Ie++)xe.push(pe[Ie].toJSON(o.data));xe.length>0&&(m[de]=xe,M=!0)}M&&(o.data.morphAttributes=m,o.data.morphTargetsRelative=this.morphTargetsRelative);const N=this.groups;N.length>0&&(o.data.groups=JSON.parse(JSON.stringify(N)));const q=this.boundingSphere;return null!==q&&(o.data.boundingSphere={center:q.center.toArray(),radius:q.radius}),o}clone(){return(new this.constructor).copy(this)}copy(o){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const c={};this.name=o.name;const h=o.index;null!==h&&this.setIndex(h.clone(c));const m=o.attributes;for(const pe in m)this.setAttribute(pe,m[pe].clone(c));const M=o.morphAttributes;for(const pe in M){const xe=[],Ie=M[pe];for(let Be=0,Le=Ie.length;Be<Le;Be++)xe.push(Ie[Be].clone(c));this.morphAttributes[pe]=xe}this.morphTargetsRelative=o.morphTargetsRelative;const N=o.groups;for(let pe=0,xe=N.length;pe<xe;pe++){const Ie=N[pe];this.addGroup(Ie.start,Ie.count,Ie.materialIndex)}const q=o.boundingBox;null!==q&&(this.boundingBox=q.clone());const de=o.boundingSphere;return null!==de&&(this.boundingSphere=de.clone()),this.drawRange.start=o.drawRange.start,this.drawRange.count=o.drawRange.count,this.userData=o.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Mh extends Cs{constructor(o=1,c=1,h=1,m=1,M=1,N=1){super(),this.type="BoxGeometry",this.parameters={width:o,height:c,depth:h,widthSegments:m,heightSegments:M,depthSegments:N};const q=this;m=Math.floor(m),M=Math.floor(M),N=Math.floor(N);const de=[],pe=[],xe=[],Ie=[];let Be=0,Le=0;function Ke(ft,We,ze,Mt,ct,Dt,Jt,cn,rn,Rn,kt){const Zt=Dt/rn,li=Jt/Rn,Ti=Dt/2,ur=Jt/2,Yn=cn/2,Di=rn+1,rr=Rn+1;let Li=0,br=0;const Ji=new Ft;for(let lr=0;lr<rr;lr++){const ei=lr*li-ur;for(let sr=0;sr<Di;sr++)Ji[ft]=(sr*Zt-Ti)*Mt,Ji[We]=ei*ct,Ji[ze]=Yn,pe.push(Ji.x,Ji.y,Ji.z),Ji[ft]=0,Ji[We]=0,Ji[ze]=cn>0?1:-1,xe.push(Ji.x,Ji.y,Ji.z),Ie.push(sr/rn),Ie.push(1-lr/Rn),Li+=1}for(let lr=0;lr<Rn;lr++)for(let ei=0;ei<rn;ei++){const as=Be+ei+Di*(lr+1),xs=Be+(ei+1)+Di*(lr+1),Ds=Be+(ei+1)+Di*lr;de.push(Be+ei+Di*lr,as,Ds),de.push(as,xs,Ds),br+=6}q.addGroup(Le,br,kt),Le+=br,Be+=Li}Ke("z","y","x",-1,-1,h,c,o,N,M,0),Ke("z","y","x",1,-1,h,c,-o,N,M,1),Ke("x","z","y",1,1,o,h,c,m,N,2),Ke("x","z","y",1,-1,o,h,-c,m,N,3),Ke("x","y","z",1,-1,o,c,h,m,M,4),Ke("x","y","z",-1,-1,o,c,-h,m,M,5),this.setIndex(de),this.setAttribute("position",new Bo(pe,3)),this.setAttribute("normal",new Bo(xe,3)),this.setAttribute("uv",new Bo(Ie,2))}copy(o){return super.copy(o),this.parameters=Object.assign({},o.parameters),this}static fromJSON(o){return new Mh(o.width,o.height,o.depth,o.widthSegments,o.heightSegments,o.depthSegments)}}class rf extends Cs{constructor(o=1,c=1,h=1,m=1){super(),this.type="PlaneGeometry",this.parameters={width:o,height:c,widthSegments:h,heightSegments:m};const M=o/2,N=c/2,q=Math.floor(h),de=Math.floor(m),pe=q+1,xe=de+1,Ie=o/q,Be=c/de,Le=[],Ke=[],ft=[],We=[];for(let ze=0;ze<xe;ze++){const Mt=ze*Be-N;for(let ct=0;ct<pe;ct++)Ke.push(ct*Ie-M,-Mt,0),ft.push(0,0,1),We.push(ct/q),We.push(1-ze/de)}for(let ze=0;ze<de;ze++)for(let Mt=0;Mt<q;Mt++){const Dt=Mt+pe*(ze+1),Jt=Mt+1+pe*(ze+1),cn=Mt+1+pe*ze;Le.push(Mt+pe*ze,Dt,cn),Le.push(Dt,Jt,cn)}this.setIndex(Le),this.setAttribute("position",new Bo(Ke,3)),this.setAttribute("normal",new Bo(ft,3)),this.setAttribute("uv",new Bo(We,2))}copy(o){return super.copy(o),this.parameters=Object.assign({},o.parameters),this}static fromJSON(o){return new rf(o.width,o.height,o.widthSegments,o.heightSegments)}}let oh=0;class kc extends xh{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:oh++}),this.uuid=gu(),this.name="",this.type="Material",this.blending=1,this.side=F,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=E,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Os(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=zf,this.stencilZFail=zf,this.stencilZPass=zf,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(o){this._alphaTest>0!=o>0&&this.version++,this._alphaTest=o}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(o){if(void 0!==o)for(const c in o){const h=o[c];if(void 0===h){console.warn(`THREE.Material: parameter '${c}' has value of undefined.`);continue}const m=this[c];void 0!==m?m&&m.isColor?m.set(h):m&&m.isVector3&&h&&h.isVector3?m.copy(h):this[c]=h:console.warn(`THREE.Material: '${c}' is not a property of THREE.${this.type}.`)}}toJSON(o){const c=void 0===o||"string"==typeof o;c&&(o={textures:{},images:{}});const h={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function m(M){const N=[];for(const q in M){const de=M[q];delete de.metadata,N.push(de)}return N}if(h.uuid=this.uuid,h.type=this.type,""!==this.name&&(h.name=this.name),this.color&&this.color.isColor&&(h.color=this.color.getHex()),void 0!==this.roughness&&(h.roughness=this.roughness),void 0!==this.metalness&&(h.metalness=this.metalness),void 0!==this.sheen&&(h.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(h.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(h.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(h.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(h.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(h.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(h.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(h.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(h.shininess=this.shininess),void 0!==this.clearcoat&&(h.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(h.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(h.clearcoatMap=this.clearcoatMap.toJSON(o).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(h.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(o).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(h.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(o).uuid,h.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(h.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(h.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(h.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(h.iridescenceMap=this.iridescenceMap.toJSON(o).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(h.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(o).uuid),void 0!==this.anisotropy&&(h.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(h.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(h.anisotropyMap=this.anisotropyMap.toJSON(o).uuid),this.map&&this.map.isTexture&&(h.map=this.map.toJSON(o).uuid),this.matcap&&this.matcap.isTexture&&(h.matcap=this.matcap.toJSON(o).uuid),this.alphaMap&&this.alphaMap.isTexture&&(h.alphaMap=this.alphaMap.toJSON(o).uuid),this.lightMap&&this.lightMap.isTexture&&(h.lightMap=this.lightMap.toJSON(o).uuid,h.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(h.aoMap=this.aoMap.toJSON(o).uuid,h.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(h.bumpMap=this.bumpMap.toJSON(o).uuid,h.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(h.normalMap=this.normalMap.toJSON(o).uuid,h.normalMapType=this.normalMapType,h.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(h.displacementMap=this.displacementMap.toJSON(o).uuid,h.displacementScale=this.displacementScale,h.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(h.roughnessMap=this.roughnessMap.toJSON(o).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(h.metalnessMap=this.metalnessMap.toJSON(o).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(h.emissiveMap=this.emissiveMap.toJSON(o).uuid),this.specularMap&&this.specularMap.isTexture&&(h.specularMap=this.specularMap.toJSON(o).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(h.specularIntensityMap=this.specularIntensityMap.toJSON(o).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(h.specularColorMap=this.specularColorMap.toJSON(o).uuid),this.envMap&&this.envMap.isTexture&&(h.envMap=this.envMap.toJSON(o).uuid,void 0!==this.combine&&(h.combine=this.combine)),void 0!==this.envMapIntensity&&(h.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(h.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(h.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(h.gradientMap=this.gradientMap.toJSON(o).uuid),void 0!==this.transmission&&(h.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(h.transmissionMap=this.transmissionMap.toJSON(o).uuid),void 0!==this.thickness&&(h.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(h.thicknessMap=this.thicknessMap.toJSON(o).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(h.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(h.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(h.size=this.size),null!==this.shadowSide&&(h.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(h.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(h.blending=this.blending),this.side!==F&&(h.side=this.side),!0===this.vertexColors&&(h.vertexColors=!0),this.opacity<1&&(h.opacity=this.opacity),!0===this.transparent&&(h.transparent=!0),204!==this.blendSrc&&(h.blendSrc=this.blendSrc),205!==this.blendDst&&(h.blendDst=this.blendDst),this.blendEquation!==E&&(h.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(h.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(h.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(h.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(h.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(h.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(h.depthFunc=this.depthFunc),!1===this.depthTest&&(h.depthTest=this.depthTest),!1===this.depthWrite&&(h.depthWrite=this.depthWrite),!1===this.colorWrite&&(h.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(h.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(h.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(h.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(h.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==zf&&(h.stencilFail=this.stencilFail),this.stencilZFail!==zf&&(h.stencilZFail=this.stencilZFail),this.stencilZPass!==zf&&(h.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(h.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(h.rotation=this.rotation),!0===this.polygonOffset&&(h.polygonOffset=!0),0!==this.polygonOffsetFactor&&(h.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(h.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(h.linewidth=this.linewidth),void 0!==this.dashSize&&(h.dashSize=this.dashSize),void 0!==this.gapSize&&(h.gapSize=this.gapSize),void 0!==this.scale&&(h.scale=this.scale),!0===this.dithering&&(h.dithering=!0),this.alphaTest>0&&(h.alphaTest=this.alphaTest),!0===this.alphaHash&&(h.alphaHash=!0),!0===this.alphaToCoverage&&(h.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(h.premultipliedAlpha=!0),!0===this.forceSinglePass&&(h.forceSinglePass=!0),!0===this.wireframe&&(h.wireframe=!0),this.wireframeLinewidth>1&&(h.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(h.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(h.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(h.flatShading=!0),!1===this.visible&&(h.visible=!1),!1===this.toneMapped&&(h.toneMapped=!1),!1===this.fog&&(h.fog=!1),Object.keys(this.userData).length>0&&(h.userData=this.userData),c){const M=m(o.textures),N=m(o.images);M.length>0&&(h.textures=M),N.length>0&&(h.images=N)}return h}clone(){return(new this.constructor).copy(this)}copy(o){this.name=o.name,this.blending=o.blending,this.side=o.side,this.vertexColors=o.vertexColors,this.opacity=o.opacity,this.transparent=o.transparent,this.blendSrc=o.blendSrc,this.blendDst=o.blendDst,this.blendEquation=o.blendEquation,this.blendSrcAlpha=o.blendSrcAlpha,this.blendDstAlpha=o.blendDstAlpha,this.blendEquationAlpha=o.blendEquationAlpha,this.blendColor.copy(o.blendColor),this.blendAlpha=o.blendAlpha,this.depthFunc=o.depthFunc,this.depthTest=o.depthTest,this.depthWrite=o.depthWrite,this.stencilWriteMask=o.stencilWriteMask,this.stencilFunc=o.stencilFunc,this.stencilRef=o.stencilRef,this.stencilFuncMask=o.stencilFuncMask,this.stencilFail=o.stencilFail,this.stencilZFail=o.stencilZFail,this.stencilZPass=o.stencilZPass,this.stencilWrite=o.stencilWrite;const c=o.clippingPlanes;let h=null;if(null!==c){const m=c.length;h=new Array(m);for(let M=0;M!==m;++M)h[M]=c[M].clone()}return this.clippingPlanes=h,this.clipIntersection=o.clipIntersection,this.clipShadows=o.clipShadows,this.shadowSide=o.shadowSide,this.colorWrite=o.colorWrite,this.precision=o.precision,this.polygonOffset=o.polygonOffset,this.polygonOffsetFactor=o.polygonOffsetFactor,this.polygonOffsetUnits=o.polygonOffsetUnits,this.dithering=o.dithering,this.alphaTest=o.alphaTest,this.alphaHash=o.alphaHash,this.alphaToCoverage=o.alphaToCoverage,this.premultipliedAlpha=o.premultipliedAlpha,this.forceSinglePass=o.forceSinglePass,this.visible=o.visible,this.toneMapped=o.toneMapped,this.userData=JSON.parse(JSON.stringify(o.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(o){!0===o&&this.version++}}function cs(w){const o={};for(const c in w){o[c]={};for(const h in w[c]){const m=w[c][h];m&&(m.isColor||m.isMatrix3||m.isMatrix4||m.isVector2||m.isVector3||m.isVector4||m.isTexture||m.isQuaternion)?m.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),o[c][h]=null):o[c][h]=m.clone():o[c][h]=Array.isArray(m)?m.slice():m}}return o}function Ia(w){const o={};for(let c=0;c<w.length;c++){const h=cs(w[c]);for(const m in h)o[m]=h[m]}return o}function Fc(w){return null===w.getRenderTarget()?w.outputColorSpace:Ya.workingColorSpace}const dl={clone:cs,merge:Ia};class zl extends kc{constructor(o){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==o&&this.setValues(o)}copy(o){return super.copy(o),this.fragmentShader=o.fragmentShader,this.vertexShader=o.vertexShader,this.uniforms=cs(o.uniforms),this.uniformsGroups=function $0(w){const o=[];for(let c=0;c<w.length;c++)o.push(w[c].clone());return o}(o.uniformsGroups),this.defines=Object.assign({},o.defines),this.wireframe=o.wireframe,this.wireframeLinewidth=o.wireframeLinewidth,this.fog=o.fog,this.lights=o.lights,this.clipping=o.clipping,this.extensions=Object.assign({},o.extensions),this.glslVersion=o.glslVersion,this}toJSON(o){const c=super.toJSON(o);c.glslVersion=this.glslVersion,c.uniforms={};for(const m in this.uniforms){const N=this.uniforms[m].value;c.uniforms[m]=N&&N.isTexture?{type:"t",value:N.toJSON(o).uuid}:N&&N.isColor?{type:"c",value:N.getHex()}:N&&N.isVector2?{type:"v2",value:N.toArray()}:N&&N.isVector3?{type:"v3",value:N.toArray()}:N&&N.isVector4?{type:"v4",value:N.toArray()}:N&&N.isMatrix3?{type:"m3",value:N.toArray()}:N&&N.isMatrix4?{type:"m4",value:N.toArray()}:{value:N}}Object.keys(this.defines).length>0&&(c.defines=this.defines),c.vertexShader=this.vertexShader,c.fragmentShader=this.fragmentShader,c.lights=this.lights,c.clipping=this.clipping;const h={};for(const m in this.extensions)!0===this.extensions[m]&&(h[m]=!0);return Object.keys(h).length>0&&(c.extensions=h),c}}const Hl=new Ft,Lp=new Ft,SA=new Ft,af=new Ft,ah=new Ft,Np=new Ft,Up=new Ft;class lf{constructor(o=new Ft,c=new Ft(0,0,-1)){this.origin=o,this.direction=c}set(o,c){return this.origin.copy(o),this.direction.copy(c),this}copy(o){return this.origin.copy(o.origin),this.direction.copy(o.direction),this}at(o,c){return c.copy(this.origin).addScaledVector(this.direction,o)}lookAt(o){return this.direction.copy(o).sub(this.origin).normalize(),this}recast(o){return this.origin.copy(this.at(o,Hl)),this}closestPointToPoint(o,c){c.subVectors(o,this.origin);const h=c.dot(this.direction);return h<0?c.copy(this.origin):c.copy(this.origin).addScaledVector(this.direction,h)}distanceToPoint(o){return Math.sqrt(this.distanceSqToPoint(o))}distanceSqToPoint(o){const c=Hl.subVectors(o,this.origin).dot(this.direction);return c<0?this.origin.distanceToSquared(o):(Hl.copy(this.origin).addScaledVector(this.direction,c),Hl.distanceToSquared(o))}distanceSqToSegment(o,c,h,m){Lp.copy(o).add(c).multiplyScalar(.5),SA.copy(c).sub(o).normalize(),af.copy(this.origin).sub(Lp);const M=.5*o.distanceTo(c),N=-this.direction.dot(SA),q=af.dot(this.direction),de=-af.dot(SA),pe=af.lengthSq(),xe=Math.abs(1-N*N);let Ie,Be,Le,Ke;if(xe>0)if(Ie=N*de-q,Be=N*q-de,Ke=M*xe,Ie>=0)if(Be>=-Ke)if(Be<=Ke){const ft=1/xe;Ie*=ft,Be*=ft,Le=Ie*(Ie+N*Be+2*q)+Be*(N*Ie+Be+2*de)+pe}else Be=M,Ie=Math.max(0,-(N*Be+q)),Le=-Ie*Ie+Be*(Be+2*de)+pe;else Be=-M,Ie=Math.max(0,-(N*Be+q)),Le=-Ie*Ie+Be*(Be+2*de)+pe;else Be<=-Ke?(Ie=Math.max(0,-(-N*M+q)),Be=Ie>0?-M:Math.min(Math.max(-M,-de),M),Le=-Ie*Ie+Be*(Be+2*de)+pe):Be<=Ke?(Ie=0,Be=Math.min(Math.max(-M,-de),M),Le=Be*(Be+2*de)+pe):(Ie=Math.max(0,-(N*M+q)),Be=Ie>0?M:Math.min(Math.max(-M,-de),M),Le=-Ie*Ie+Be*(Be+2*de)+pe);else Be=N>0?-M:M,Ie=Math.max(0,-(N*Be+q)),Le=-Ie*Ie+Be*(Be+2*de)+pe;return h&&h.copy(this.origin).addScaledVector(this.direction,Ie),m&&m.copy(Lp).addScaledVector(SA,Be),Le}intersectSphere(o,c){Hl.subVectors(o.center,this.origin);const h=Hl.dot(this.direction),m=Hl.dot(Hl)-h*h,M=o.radius*o.radius;if(m>M)return null;const N=Math.sqrt(M-m),q=h-N,de=h+N;return de<0?null:this.at(q<0?de:q,c)}intersectsSphere(o){return this.distanceSqToPoint(o.center)<=o.radius*o.radius}distanceToPlane(o){const c=o.normal.dot(this.direction);if(0===c)return 0===o.distanceToPoint(this.origin)?0:null;const h=-(this.origin.dot(o.normal)+o.constant)/c;return h>=0?h:null}intersectPlane(o,c){const h=this.distanceToPlane(o);return null===h?null:this.at(h,c)}intersectsPlane(o){const c=o.distanceToPoint(this.origin);return 0===c||o.normal.dot(this.direction)*c<0}intersectBox(o,c){let h,m,M,N,q,de;const pe=1/this.direction.x,xe=1/this.direction.y,Ie=1/this.direction.z,Be=this.origin;return pe>=0?(h=(o.min.x-Be.x)*pe,m=(o.max.x-Be.x)*pe):(h=(o.max.x-Be.x)*pe,m=(o.min.x-Be.x)*pe),xe>=0?(M=(o.min.y-Be.y)*xe,N=(o.max.y-Be.y)*xe):(M=(o.max.y-Be.y)*xe,N=(o.min.y-Be.y)*xe),h>N||M>m||((M>h||isNaN(h))&&(h=M),(N<m||isNaN(m))&&(m=N),Ie>=0?(q=(o.min.z-Be.z)*Ie,de=(o.max.z-Be.z)*Ie):(q=(o.max.z-Be.z)*Ie,de=(o.min.z-Be.z)*Ie),h>de||q>m)||((q>h||h!=h)&&(h=q),(de<m||m!=m)&&(m=de),m<0)?null:this.at(h>=0?h:m,c)}intersectsBox(o){return null!==this.intersectBox(o,Hl)}intersectTriangle(o,c,h,m,M){ah.subVectors(c,o),Np.subVectors(h,o),Up.crossVectors(ah,Np);let q,N=this.direction.dot(Up);if(N>0){if(m)return null;q=1}else{if(!(N<0))return null;q=-1,N=-N}af.subVectors(this.origin,o);const de=q*this.direction.dot(Np.crossVectors(af,Np));if(de<0)return null;const pe=q*this.direction.dot(ah.cross(af));if(pe<0||de+pe>N)return null;const xe=-q*af.dot(Up);return xe<0?null:this.at(xe/N,M)}applyMatrix4(o){return this.origin.applyMatrix4(o),this.direction.transformDirection(o),this}equals(o){return o.origin.equals(this.origin)&&o.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}const Sh=new Ft,cf=new Ft,Lg=new Ft,Xf=new Ft,EA=new Ft,TA=new Ft,uv=new Ft,Ng=new Ft,Ug=new Ft,xc=new Ft;let Dm=!1;class lc{constructor(o=new Ft,c=new Ft,h=new Ft){this.a=o,this.b=c,this.c=h}static getNormal(o,c,h,m){m.subVectors(h,c),Sh.subVectors(o,c),m.cross(Sh);const M=m.lengthSq();return M>0?m.multiplyScalar(1/Math.sqrt(M)):m.set(0,0,0)}static getBarycoord(o,c,h,m,M){Sh.subVectors(m,c),cf.subVectors(h,c),Lg.subVectors(o,c);const N=Sh.dot(Sh),q=Sh.dot(cf),de=Sh.dot(Lg),pe=cf.dot(cf),xe=cf.dot(Lg),Ie=N*pe-q*q;if(0===Ie)return M.set(-2,-1,-1);const Be=1/Ie,Le=(pe*de-q*xe)*Be,Ke=(N*xe-q*de)*Be;return M.set(1-Le-Ke,Ke,Le)}static containsPoint(o,c,h,m){return this.getBarycoord(o,c,h,m,Xf),Xf.x>=0&&Xf.y>=0&&Xf.x+Xf.y<=1}static getUV(o,c,h,m,M,N,q,de){return!1===Dm&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Dm=!0),this.getInterpolation(o,c,h,m,M,N,q,de)}static getInterpolation(o,c,h,m,M,N,q,de){return this.getBarycoord(o,c,h,m,Xf),de.setScalar(0),de.addScaledVector(M,Xf.x),de.addScaledVector(N,Xf.y),de.addScaledVector(q,Xf.z),de}static isFrontFacing(o,c,h,m){return Sh.subVectors(h,c),cf.subVectors(o,c),Sh.cross(cf).dot(m)<0}set(o,c,h){return this.a.copy(o),this.b.copy(c),this.c.copy(h),this}setFromPointsAndIndices(o,c,h,m){return this.a.copy(o[c]),this.b.copy(o[h]),this.c.copy(o[m]),this}setFromAttributeAndIndices(o,c,h,m){return this.a.fromBufferAttribute(o,c),this.b.fromBufferAttribute(o,h),this.c.fromBufferAttribute(o,m),this}clone(){return(new this.constructor).copy(this)}copy(o){return this.a.copy(o.a),this.b.copy(o.b),this.c.copy(o.c),this}getArea(){return Sh.subVectors(this.c,this.b),cf.subVectors(this.a,this.b),.5*Sh.cross(cf).length()}getMidpoint(o){return o.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(o){return lc.getNormal(this.a,this.b,this.c,o)}getPlane(o){return o.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(o,c){return lc.getBarycoord(o,this.a,this.b,this.c,c)}getUV(o,c,h,m,M){return!1===Dm&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Dm=!0),lc.getInterpolation(o,this.a,this.b,this.c,c,h,m,M)}getInterpolation(o,c,h,m,M){return lc.getInterpolation(o,this.a,this.b,this.c,c,h,m,M)}containsPoint(o){return lc.containsPoint(o,this.a,this.b,this.c)}isFrontFacing(o){return lc.isFrontFacing(this.a,this.b,this.c,o)}intersectsBox(o){return o.intersectsTriangle(this)}closestPointToPoint(o,c){const h=this.a,m=this.b,M=this.c;let N,q;EA.subVectors(m,h),TA.subVectors(M,h),Ng.subVectors(o,h);const de=EA.dot(Ng),pe=TA.dot(Ng);if(de<=0&&pe<=0)return c.copy(h);Ug.subVectors(o,m);const xe=EA.dot(Ug),Ie=TA.dot(Ug);if(xe>=0&&Ie<=xe)return c.copy(m);const Be=de*Ie-xe*pe;if(Be<=0&&de>=0&&xe<=0)return N=de/(de-xe),c.copy(h).addScaledVector(EA,N);xc.subVectors(o,M);const Le=EA.dot(xc),Ke=TA.dot(xc);if(Ke>=0&&Le<=Ke)return c.copy(M);const ft=Le*pe-de*Ke;if(ft<=0&&pe>=0&&Ke<=0)return q=pe/(pe-Ke),c.copy(h).addScaledVector(TA,q);const We=xe*Ke-Le*Ie;if(We<=0&&Ie-xe>=0&&Le-Ke>=0)return uv.subVectors(M,m),q=(Ie-xe)/(Ie-xe+(Le-Ke)),c.copy(m).addScaledVector(uv,q);const ze=1/(We+ft+Be);return N=ft*ze,q=Be*ze,c.copy(h).addScaledVector(EA,N).addScaledVector(TA,q)}equals(o){return o.a.equals(this.a)&&o.b.equals(this.b)&&o.c.equals(this.c)}}class Xc extends kc{constructor(o){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Os(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ne,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(o)}copy(o){return super.copy(o),this.color.copy(o.color),this.map=o.map,this.lightMap=o.lightMap,this.lightMapIntensity=o.lightMapIntensity,this.aoMap=o.aoMap,this.aoMapIntensity=o.aoMapIntensity,this.specularMap=o.specularMap,this.alphaMap=o.alphaMap,this.envMap=o.envMap,this.combine=o.combine,this.reflectivity=o.reflectivity,this.refractionRatio=o.refractionRatio,this.wireframe=o.wireframe,this.wireframeLinewidth=o.wireframeLinewidth,this.wireframeLinecap=o.wireframeLinecap,this.wireframeLinejoin=o.wireframeLinejoin,this.fog=o.fog,this}}const lh=new bo,Jd=new lf,Im=new Kd,v1=new Ft,Eh=new Ft,Hu=new Ft,ch=new Ft,kl=new Ft,Yf=new Ft,zp=new zi,Kf=new zi,df=new zi,Bm=new Ft,Th=new Ft,Zf=new Ft,Jf=new Ft,eu=new Ft;class Jc extends Rl{constructor(o=new Cs,c=new Xc){super(),this.isMesh=!0,this.type="Mesh",this.geometry=o,this.material=c,this.updateMorphTargets()}copy(o,c){return super.copy(o,c),void 0!==o.morphTargetInfluences&&(this.morphTargetInfluences=o.morphTargetInfluences.slice()),void 0!==o.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},o.morphTargetDictionary)),this.material=Array.isArray(o.material)?o.material.slice():o.material,this.geometry=o.geometry,this}updateMorphTargets(){const c=this.geometry.morphAttributes,h=Object.keys(c);if(h.length>0){const m=c[h[0]];if(void 0!==m){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let M=0,N=m.length;M<N;M++){const q=m[M].name||String(M);this.morphTargetInfluences.push(0),this.morphTargetDictionary[q]=M}}}}getVertexPosition(o,c){const h=this.geometry,M=h.morphAttributes.position,N=h.morphTargetsRelative;c.fromBufferAttribute(h.attributes.position,o);const q=this.morphTargetInfluences;if(M&&q){Yf.set(0,0,0);for(let de=0,pe=M.length;de<pe;de++){const xe=q[de];0!==xe&&(kl.fromBufferAttribute(M[de],o),Yf.addScaledVector(N?kl:kl.sub(c),xe))}c.add(Yf)}return c}raycast(o,c){const h=this.geometry,M=this.matrixWorld;void 0!==this.material&&(null===h.boundingSphere&&h.computeBoundingSphere(),Im.copy(h.boundingSphere),Im.applyMatrix4(M),Jd.copy(o.ray).recast(o.near),(!1!==Im.containsPoint(Jd.origin)||!(null===Jd.intersectSphere(Im,v1)||Jd.origin.distanceToSquared(v1)>(o.far-o.near)**2))&&(lh.copy(M).invert(),Jd.copy(o.ray).applyMatrix4(lh),(null===h.boundingBox||!1!==Jd.intersectsBox(h.boundingBox))&&this._computeIntersections(o,c,Jd)))}_computeIntersections(o,c,h){let m;const M=this.geometry,N=this.material,q=M.index,de=M.attributes.position,pe=M.attributes.uv,xe=M.attributes.uv1,Ie=M.attributes.normal,Be=M.groups,Le=M.drawRange;if(null!==q)if(Array.isArray(N))for(let Ke=0,ft=Be.length;Ke<ft;Ke++){const We=Be[Ke],ze=N[We.materialIndex];for(let Dt=Math.max(We.start,Le.start),Jt=Math.min(q.count,Math.min(We.start+We.count,Le.start+Le.count));Dt<Jt;Dt+=3)m=DA(this,ze,o,h,pe,xe,Ie,q.getX(Dt),q.getX(Dt+1),q.getX(Dt+2)),m&&(m.faceIndex=Math.floor(Dt/3),m.face.materialIndex=We.materialIndex,c.push(m))}else for(let We=Math.max(0,Le.start),ze=Math.min(q.count,Le.start+Le.count);We<ze;We+=3)m=DA(this,N,o,h,pe,xe,Ie,q.getX(We),q.getX(We+1),q.getX(We+2)),m&&(m.faceIndex=Math.floor(We/3),c.push(m));else if(void 0!==de)if(Array.isArray(N))for(let Ke=0,ft=Be.length;Ke<ft;Ke++){const We=Be[Ke],ze=N[We.materialIndex];for(let Dt=Math.max(We.start,Le.start),Jt=Math.min(de.count,Math.min(We.start+We.count,Le.start+Le.count));Dt<Jt;Dt+=3)m=DA(this,ze,o,h,pe,xe,Ie,Dt,Dt+1,Dt+2),m&&(m.faceIndex=Math.floor(Dt/3),m.face.materialIndex=We.materialIndex,c.push(m))}else for(let We=Math.max(0,Le.start),ze=Math.min(de.count,Le.start+Le.count);We<ze;We+=3)m=DA(this,N,o,h,pe,xe,Ie,We,We+1,We+2),m&&(m.faceIndex=Math.floor(We/3),c.push(m))}}function DA(w,o,c,h,m,M,N,q,de,pe){w.getVertexPosition(q,Eh),w.getVertexPosition(de,Hu),w.getVertexPosition(pe,ch);const xe=function uf(w,o,c,h,m,M,N,q){let de;if(de=1===o.side?h.intersectTriangle(N,M,m,!0,q):h.intersectTriangle(m,M,N,o.side===F,q),null===de)return null;eu.copy(q),eu.applyMatrix4(w.matrixWorld);const pe=c.ray.origin.distanceTo(eu);return pe<c.near||pe>c.far?null:{distance:pe,point:eu.clone(),object:w}}(w,o,c,h,Eh,Hu,ch,Jf);if(xe){m&&(zp.fromBufferAttribute(m,q),Kf.fromBufferAttribute(m,de),df.fromBufferAttribute(m,pe),xe.uv=lc.getInterpolation(Jf,Eh,Hu,ch,zp,Kf,df,new zi)),M&&(zp.fromBufferAttribute(M,q),Kf.fromBufferAttribute(M,de),df.fromBufferAttribute(M,pe),xe.uv1=lc.getInterpolation(Jf,Eh,Hu,ch,zp,Kf,df,new zi),xe.uv2=xe.uv1),N&&(Bm.fromBufferAttribute(N,q),Th.fromBufferAttribute(N,de),Zf.fromBufferAttribute(N,pe),xe.normal=lc.getInterpolation(Jf,Eh,Hu,ch,Bm,Th,Zf,new Ft),xe.normal.dot(h.direction)>0&&xe.normal.multiplyScalar(-1));const Ie={a:q,b:de,c:pe,normal:new Ft,materialIndex:0};lc.getNormal(Eh,Hu,ch,Ie.normal),xe.face=Ie}return xe}const Ko={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(\n\tvec3( 0.8224621, 0.177538, 0.0 ),\n\tvec3( 0.0331941, 0.9668058, 0.0 ),\n\tvec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.2249401, - 0.2249404, 0.0 ),\n\tvec3( - 0.0420569, 1.0420571, 0.0 ),\n\tvec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn sRGBTransferOETF( value );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tanisotropyV /= material.anisotropy;\n\tmaterial.anisotropy = saturate( material.anisotropy );\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},ds={common:{diffuse:{value:new Os(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new zo},alphaMap:{value:null},alphaMapTransform:{value:new zo},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new zo}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new zo}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new zo}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new zo},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new zo},normalScale:{value:new zi(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new zo},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new zo}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new zo}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new zo}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Os(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Os(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new zo},alphaTest:{value:0},uvTransform:{value:new zo}},sprite:{diffuse:{value:new Os(16777215)},opacity:{value:1},center:{value:new zi(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new zo},alphaMap:{value:null},alphaMapTransform:{value:new zo},alphaTest:{value:0}}},Ah={basic:{uniforms:Ia([ds.common,ds.specularmap,ds.envmap,ds.aomap,ds.lightmap,ds.fog]),vertexShader:Ko.meshbasic_vert,fragmentShader:Ko.meshbasic_frag},lambert:{uniforms:Ia([ds.common,ds.specularmap,ds.envmap,ds.aomap,ds.lightmap,ds.emissivemap,ds.bumpmap,ds.normalmap,ds.displacementmap,ds.fog,ds.lights,{emissive:{value:new Os(0)}}]),vertexShader:Ko.meshlambert_vert,fragmentShader:Ko.meshlambert_frag},phong:{uniforms:Ia([ds.common,ds.specularmap,ds.envmap,ds.aomap,ds.lightmap,ds.emissivemap,ds.bumpmap,ds.normalmap,ds.displacementmap,ds.fog,ds.lights,{emissive:{value:new Os(0)},specular:{value:new Os(1118481)},shininess:{value:30}}]),vertexShader:Ko.meshphong_vert,fragmentShader:Ko.meshphong_frag},standard:{uniforms:Ia([ds.common,ds.envmap,ds.aomap,ds.lightmap,ds.emissivemap,ds.bumpmap,ds.normalmap,ds.displacementmap,ds.roughnessmap,ds.metalnessmap,ds.fog,ds.lights,{emissive:{value:new Os(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Ko.meshphysical_vert,fragmentShader:Ko.meshphysical_frag},toon:{uniforms:Ia([ds.common,ds.aomap,ds.lightmap,ds.emissivemap,ds.bumpmap,ds.normalmap,ds.displacementmap,ds.gradientmap,ds.fog,ds.lights,{emissive:{value:new Os(0)}}]),vertexShader:Ko.meshtoon_vert,fragmentShader:Ko.meshtoon_frag},matcap:{uniforms:Ia([ds.common,ds.bumpmap,ds.normalmap,ds.displacementmap,ds.fog,{matcap:{value:null}}]),vertexShader:Ko.meshmatcap_vert,fragmentShader:Ko.meshmatcap_frag},points:{uniforms:Ia([ds.points,ds.fog]),vertexShader:Ko.points_vert,fragmentShader:Ko.points_frag},dashed:{uniforms:Ia([ds.common,ds.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ko.linedashed_vert,fragmentShader:Ko.linedashed_frag},depth:{uniforms:Ia([ds.common,ds.displacementmap]),vertexShader:Ko.depth_vert,fragmentShader:Ko.depth_frag},normal:{uniforms:Ia([ds.common,ds.bumpmap,ds.normalmap,ds.displacementmap,{opacity:{value:1}}]),vertexShader:Ko.meshnormal_vert,fragmentShader:Ko.meshnormal_frag},sprite:{uniforms:Ia([ds.sprite,ds.fog]),vertexShader:Ko.sprite_vert,fragmentShader:Ko.sprite_frag},background:{uniforms:{uvTransform:{value:new zo},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Ko.background_vert,fragmentShader:Ko.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Ko.backgroundCube_vert,fragmentShader:Ko.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Ko.cube_vert,fragmentShader:Ko.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ko.equirect_vert,fragmentShader:Ko.equirect_frag},distanceRGBA:{uniforms:Ia([ds.common,ds.displacementmap,{referencePosition:{value:new Ft},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Ko.distanceRGBA_vert,fragmentShader:Ko.distanceRGBA_frag},shadow:{uniforms:Ia([ds.lights,ds.fog,{color:{value:new Os(0)},opacity:{value:1}}]),vertexShader:Ko.shadow_vert,fragmentShader:Ko.shadow_frag}};Ah.physical={uniforms:Ia([Ah.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new zo},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new zo},clearcoatNormalScale:{value:new zi(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new zo},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new zo},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new zo},sheen:{value:0},sheenColor:{value:new Os(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new zo},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new zo},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new zo},transmissionSamplerSize:{value:new zi},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new zo},attenuationDistance:{value:0},attenuationColor:{value:new Os(0)},specularColor:{value:new Os(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new zo},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new zo},anisotropyVector:{value:new zi},anisotropyMap:{value:null},anisotropyMapTransform:{value:new zo}}]),vertexShader:Ko.meshphysical_vert,fragmentShader:Ko.meshphysical_frag};const Hm={r:0,b:0,g:0};function N1(w,o,c,h,m,M,N){const q=new Os(0);let pe,xe,de=!0===M?0:1,Ie=null,Be=0,Le=null;function ft(We,ze){We.getRGB(Hm,Fc(w)),h.buffers.color.setClear(Hm.r,Hm.g,Hm.b,ze,N)}return{getClearColor:function(){return q},setClearColor:function(We,ze=1){q.set(We),de=ze,ft(q,de)},getClearAlpha:function(){return de},setClearAlpha:function(We){de=We,ft(q,de)},render:function Ke(We,ze){let Mt=!1,ct=!0===ze.isScene?ze.background:null;ct&&ct.isTexture&&(ct=(ze.backgroundBlurriness>0?c:o).get(ct)),null===ct?ft(q,de):ct&&ct.isColor&&(ft(ct,1),Mt=!0);const Dt=w.xr.getEnvironmentBlendMode();"additive"===Dt?h.buffers.color.setClear(0,0,0,1,N):"alpha-blend"===Dt&&h.buffers.color.setClear(0,0,0,0,N),(w.autoClear||Mt)&&w.clear(w.autoClearColor,w.autoClearDepth,w.autoClearStencil),ct&&(ct.isCubeTexture||ct.mapping===Sn)?(void 0===xe&&(xe=new Jc(new Mh(1,1,1),new zl({name:"BackgroundCubeMaterial",uniforms:cs(Ah.backgroundCube.uniforms),vertexShader:Ah.backgroundCube.vertexShader,fragmentShader:Ah.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),xe.geometry.deleteAttribute("normal"),xe.geometry.deleteAttribute("uv"),xe.onBeforeRender=function(Jt,cn,rn){this.matrixWorld.copyPosition(rn.matrixWorld)},Object.defineProperty(xe.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),m.update(xe)),xe.material.uniforms.envMap.value=ct,xe.material.uniforms.flipEnvMap.value=ct.isCubeTexture&&!1===ct.isRenderTargetTexture?-1:1,xe.material.uniforms.backgroundBlurriness.value=ze.backgroundBlurriness,xe.material.uniforms.backgroundIntensity.value=ze.backgroundIntensity,xe.material.toneMapped=Ya.getTransfer(ct.colorSpace)!==$o,(Ie!==ct||Be!==ct.version||Le!==w.toneMapping)&&(xe.material.needsUpdate=!0,Ie=ct,Be=ct.version,Le=w.toneMapping),xe.layers.enableAll(),We.unshift(xe,xe.geometry,xe.material,0,0,null)):ct&&ct.isTexture&&(void 0===pe&&(pe=new Jc(new rf(2,2),new zl({name:"BackgroundMaterial",uniforms:cs(Ah.background.uniforms),vertexShader:Ah.background.vertexShader,fragmentShader:Ah.background.fragmentShader,side:F,depthTest:!1,depthWrite:!1,fog:!1})),pe.geometry.deleteAttribute("normal"),Object.defineProperty(pe.material,"map",{get:function(){return this.uniforms.t2D.value}}),m.update(pe)),pe.material.uniforms.t2D.value=ct,pe.material.uniforms.backgroundIntensity.value=ze.backgroundIntensity,pe.material.toneMapped=Ya.getTransfer(ct.colorSpace)!==$o,!0===ct.matrixAutoUpdate&&ct.updateMatrix(),pe.material.uniforms.uvTransform.value.copy(ct.matrix),(Ie!==ct||Be!==ct.version||Le!==w.toneMapping)&&(pe.material.needsUpdate=!0,Ie=ct,Be=ct.version,Le=w.toneMapping),pe.layers.enableAll(),We.unshift(pe,pe.geometry,pe.material,0,0,null))}}}function U1(w,o,c,h){const m=w.getParameter(w.MAX_VERTEX_ATTRIBS),M=h.isWebGL2?null:o.get("OES_vertex_array_object"),N=h.isWebGL2||null!==M,q={},de=We(null);let pe=de,xe=!1;function Le(Yn){return h.isWebGL2?w.bindVertexArray(Yn):M.bindVertexArrayOES(Yn)}function Ke(Yn){return h.isWebGL2?w.deleteVertexArray(Yn):M.deleteVertexArrayOES(Yn)}function We(Yn){const Di=[],rr=[],Li=[];for(let br=0;br<m;br++)Di[br]=0,rr[br]=0,Li[br]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Di,enabledAttributes:rr,attributeDivisors:Li,object:Yn,attributes:{},index:null}}function ct(){const Yn=pe.newAttributes;for(let Di=0,rr=Yn.length;Di<rr;Di++)Yn[Di]=0}function Dt(Yn){Jt(Yn,0)}function Jt(Yn,Di){const Li=pe.enabledAttributes,br=pe.attributeDivisors;pe.newAttributes[Yn]=1,0===Li[Yn]&&(w.enableVertexAttribArray(Yn),Li[Yn]=1),br[Yn]!==Di&&((h.isWebGL2?w:o.get("ANGLE_instanced_arrays"))[h.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Yn,Di),br[Yn]=Di)}function cn(){const Yn=pe.newAttributes,Di=pe.enabledAttributes;for(let rr=0,Li=Di.length;rr<Li;rr++)Di[rr]!==Yn[rr]&&(w.disableVertexAttribArray(rr),Di[rr]=0)}function rn(Yn,Di,rr,Li,br,Ji,lr){!0===lr?w.vertexAttribIPointer(Yn,Di,rr,br,Ji):w.vertexAttribPointer(Yn,Di,rr,Li,br,Ji)}function Ti(){ur(),xe=!0,pe!==de&&(pe=de,Le(pe.object))}function ur(){de.geometry=null,de.program=null,de.wireframe=!1}return{setup:function Ie(Yn,Di,rr,Li,br){let Ji=!1;if(N){const lr=function ft(Yn,Di,rr){const Li=!0===rr.wireframe;let br=q[Yn.id];void 0===br&&(br={},q[Yn.id]=br);let Ji=br[Di.id];void 0===Ji&&(Ji={},br[Di.id]=Ji);let lr=Ji[Li];return void 0===lr&&(lr=We(function Be(){return h.isWebGL2?w.createVertexArray():M.createVertexArrayOES()}()),Ji[Li]=lr),lr}(Li,rr,Di);pe!==lr&&(pe=lr,Le(pe.object)),Ji=function ze(Yn,Di,rr,Li){const br=pe.attributes,Ji=Di.attributes;let lr=0;const ei=rr.getAttributes();for(const sr in ei)if(ei[sr].location>=0){const xs=br[sr];let Ds=Ji[sr];if(void 0===Ds&&("instanceMatrix"===sr&&Yn.instanceMatrix&&(Ds=Yn.instanceMatrix),"instanceColor"===sr&&Yn.instanceColor&&(Ds=Yn.instanceColor)),void 0===xs||xs.attribute!==Ds||Ds&&xs.data!==Ds.data)return!0;lr++}return pe.attributesNum!==lr||pe.index!==Li}(Yn,Li,rr,br),Ji&&function Mt(Yn,Di,rr,Li){const br={},Ji=Di.attributes;let lr=0;const ei=rr.getAttributes();for(const sr in ei)if(ei[sr].location>=0){let xs=Ji[sr];void 0===xs&&("instanceMatrix"===sr&&Yn.instanceMatrix&&(xs=Yn.instanceMatrix),"instanceColor"===sr&&Yn.instanceColor&&(xs=Yn.instanceColor));const Ds={};Ds.attribute=xs,xs&&xs.data&&(Ds.data=xs.data),br[sr]=Ds,lr++}pe.attributes=br,pe.attributesNum=lr,pe.index=Li}(Yn,Li,rr,br)}else{const lr=!0===Di.wireframe;(pe.geometry!==Li.id||pe.program!==rr.id||pe.wireframe!==lr)&&(pe.geometry=Li.id,pe.program=rr.id,pe.wireframe=lr,Ji=!0)}null!==br&&c.update(br,w.ELEMENT_ARRAY_BUFFER),(Ji||xe)&&(xe=!1,function Rn(Yn,Di,rr,Li){if(!1===h.isWebGL2&&(Yn.isInstancedMesh||Li.isInstancedBufferGeometry)&&null===o.get("ANGLE_instanced_arrays"))return;ct();const br=Li.attributes,Ji=rr.getAttributes(),lr=Di.defaultAttributeValues;for(const ei in Ji){const sr=Ji[ei];if(sr.location>=0){let as=br[ei];if(void 0===as&&("instanceMatrix"===ei&&Yn.instanceMatrix&&(as=Yn.instanceMatrix),"instanceColor"===ei&&Yn.instanceColor&&(as=Yn.instanceColor)),void 0!==as){const xs=as.normalized,Ds=as.itemSize,fs=c.get(as);if(void 0===fs)continue;const eo=fs.buffer,er=fs.type,Lr=fs.bytesPerElement,yr=!0===h.isWebGL2&&(er===w.INT||er===w.UNSIGNED_INT||1013===as.gpuType);if(as.isInterleavedBufferAttribute){const vr=as.data,_n=vr.stride,Ki=as.offset;if(vr.isInstancedInterleavedBuffer){for(let si=0;si<sr.locationSize;si++)Jt(sr.location+si,vr.meshPerAttribute);!0!==Yn.isInstancedMesh&&void 0===Li._maxInstanceCount&&(Li._maxInstanceCount=vr.meshPerAttribute*vr.count)}else for(let si=0;si<sr.locationSize;si++)Dt(sr.location+si);w.bindBuffer(w.ARRAY_BUFFER,eo);for(let si=0;si<sr.locationSize;si++)rn(sr.location+si,Ds/sr.locationSize,er,xs,_n*Lr,(Ki+Ds/sr.locationSize*si)*Lr,yr)}else{if(as.isInstancedBufferAttribute){for(let vr=0;vr<sr.locationSize;vr++)Jt(sr.location+vr,as.meshPerAttribute);!0!==Yn.isInstancedMesh&&void 0===Li._maxInstanceCount&&(Li._maxInstanceCount=as.meshPerAttribute*as.count)}else for(let vr=0;vr<sr.locationSize;vr++)Dt(sr.location+vr);w.bindBuffer(w.ARRAY_BUFFER,eo);for(let vr=0;vr<sr.locationSize;vr++)rn(sr.location+vr,Ds/sr.locationSize,er,xs,Ds*Lr,Ds/sr.locationSize*vr*Lr,yr)}}else if(void 0!==lr){const xs=lr[ei];if(void 0!==xs)switch(xs.length){case 2:w.vertexAttrib2fv(sr.location,xs);break;case 3:w.vertexAttrib3fv(sr.location,xs);break;case 4:w.vertexAttrib4fv(sr.location,xs);break;default:w.vertexAttrib1fv(sr.location,xs)}}}}cn()}(Yn,Di,rr,Li),null!==br&&w.bindBuffer(w.ELEMENT_ARRAY_BUFFER,c.get(br).buffer))},reset:Ti,resetDefaultState:ur,dispose:function kt(){Ti();for(const Yn in q){const Di=q[Yn];for(const rr in Di){const Li=Di[rr];for(const br in Li)Ke(Li[br].object),delete Li[br];delete Di[rr]}delete q[Yn]}},releaseStatesOfGeometry:function Zt(Yn){if(void 0===q[Yn.id])return;const Di=q[Yn.id];for(const rr in Di){const Li=Di[rr];for(const br in Li)Ke(Li[br].object),delete Li[br];delete Di[rr]}delete q[Yn.id]},releaseStatesOfProgram:function li(Yn){for(const Di in q){const rr=q[Di];if(void 0===rr[Yn.id])continue;const Li=rr[Yn.id];for(const br in Li)Ke(Li[br].object),delete Li[br];delete rr[Yn.id]}},initAttributes:ct,enableAttribute:Dt,disableUnusedAttributes:cn}}function z1(w,o,c,h){const m=h.isWebGL2;let M;this.setMode=function N(pe){M=pe},this.render=function q(pe,xe){w.drawArrays(M,pe,xe),c.update(xe,M,1)},this.renderInstances=function de(pe,xe,Ie){if(0===Ie)return;let Be,Le;if(m)Be=w,Le="drawArraysInstanced";else if(Be=o.get("ANGLE_instanced_arrays"),Le="drawArraysInstancedANGLE",null===Be)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");Be[Le](M,pe,xe,Ie),c.update(xe,M,Ie)}}function UA(w,o,c){let h;function M(rn){if("highp"===rn){if(w.getShaderPrecisionFormat(w.VERTEX_SHADER,w.HIGH_FLOAT).precision>0&&w.getShaderPrecisionFormat(w.FRAGMENT_SHADER,w.HIGH_FLOAT).precision>0)return"highp";rn="mediump"}return"mediump"===rn&&w.getShaderPrecisionFormat(w.VERTEX_SHADER,w.MEDIUM_FLOAT).precision>0&&w.getShaderPrecisionFormat(w.FRAGMENT_SHADER,w.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const N=typeof WebGL2RenderingContext<"u"&&"WebGL2RenderingContext"===w.constructor.name;let q=void 0!==c.precision?c.precision:"highp";const de=M(q);de!==q&&(console.warn("THREE.WebGLRenderer:",q,"not supported, using",de,"instead."),q=de);const pe=N||o.has("WEBGL_draw_buffers"),xe=!0===c.logarithmicDepthBuffer,Ie=w.getParameter(w.MAX_TEXTURE_IMAGE_UNITS),Be=w.getParameter(w.MAX_VERTEX_TEXTURE_IMAGE_UNITS),Le=w.getParameter(w.MAX_TEXTURE_SIZE),Ke=w.getParameter(w.MAX_CUBE_MAP_TEXTURE_SIZE),ft=w.getParameter(w.MAX_VERTEX_ATTRIBS),We=w.getParameter(w.MAX_VERTEX_UNIFORM_VECTORS),ze=w.getParameter(w.MAX_VARYING_VECTORS),Mt=w.getParameter(w.MAX_FRAGMENT_UNIFORM_VECTORS),ct=Be>0,Dt=N||o.has("OES_texture_float");return{isWebGL2:N,drawBuffers:pe,getMaxAnisotropy:function m(){if(void 0!==h)return h;if(!0===o.has("EXT_texture_filter_anisotropic")){const rn=o.get("EXT_texture_filter_anisotropic");h=w.getParameter(rn.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else h=0;return h},getMaxPrecision:M,precision:q,logarithmicDepthBuffer:xe,maxTextures:Ie,maxVertexTextures:Be,maxTextureSize:Le,maxCubemapSize:Ke,maxAttributes:ft,maxVertexUniforms:We,maxVaryings:ze,maxFragmentUniforms:Mt,vertexTextures:ct,floatFragmentTextures:Dt,floatVertexTextures:ct&&Dt,maxSamples:N?w.getParameter(w.MAX_SAMPLES):0}}function xv(w){const o=this;let c=null,h=0,m=!1,M=!1;const N=new ih,q=new zo,de={value:null,needsUpdate:!1};function xe(Ie,Be,Le,Ke){const ft=null!==Ie?Ie.length:0;let We=null;if(0!==ft){if(We=de.value,!0!==Ke||null===We){const ze=Le+4*ft,Mt=Be.matrixWorldInverse;q.getNormalMatrix(Mt),(null===We||We.length<ze)&&(We=new Float32Array(ze));for(let ct=0,Dt=Le;ct!==ft;++ct,Dt+=4)N.copy(Ie[ct]).applyMatrix4(Mt,q),N.normal.toArray(We,Dt),We[Dt+3]=N.constant}de.value=We,de.needsUpdate=!0}return o.numPlanes=ft,o.numIntersection=0,We}this.uniform=de,this.numPlanes=0,this.numIntersection=0,this.init=function(Ie,Be){const Le=0!==Ie.length||Be||0!==h||m;return m=Be,h=Ie.length,Le},this.beginShadows=function(){M=!0,xe(null)},this.endShadows=function(){M=!1},this.setGlobalState=function(Ie,Be){c=xe(Ie,Be,0)},this.setState=function(Ie,Be,Le){const Ke=Ie.clippingPlanes,ft=Ie.clipIntersection,We=Ie.clipShadows,ze=w.get(Ie);if(!m||null===Ke||0===Ke.length||M&&!We)M?xe(null):function pe(){de.value!==c&&(de.value=c,de.needsUpdate=h>0),o.numPlanes=h,o.numIntersection=0}();else{const Mt=M?0:h,ct=4*Mt;let Dt=ze.clippingState||null;de.value=Dt,Dt=xe(Ke,Be,ct,Le);for(let Jt=0;Jt!==ct;++Jt)Dt[Jt]=c[Jt];ze.clippingState=Dt,this.numIntersection=ft?this.numPlanes:0,this.numPlanes+=Mt}}}class sp extends Rl{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new bo,this.projectionMatrix=new bo,this.projectionMatrixInverse=new bo,this.coordinateSystem=Dd}copy(o,c){return super.copy(o,c),this.matrixWorldInverse.copy(o.matrixWorldInverse),this.projectionMatrix.copy(o.projectionMatrix),this.projectionMatrixInverse.copy(o.projectionMatrixInverse),this.coordinateSystem=o.coordinateSystem,this}getWorldDirection(o){return super.getWorldDirection(o).negate()}updateMatrixWorld(o){super.updateMatrixWorld(o),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(o,c){super.updateWorldMatrix(o,c),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class Vl extends sp{constructor(o=50,c=1,h=.1,m=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=o,this.zoom=1,this.near=h,this.far=m,this.focus=10,this.aspect=c,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(o,c){return super.copy(o,c),this.fov=o.fov,this.zoom=o.zoom,this.near=o.near,this.far=o.far,this.focus=o.focus,this.aspect=o.aspect,this.view=null===o.view?null:Object.assign({},o.view),this.filmGauge=o.filmGauge,this.filmOffset=o.filmOffset,this}setFocalLength(o){const c=.5*this.getFilmHeight()/o;this.fov=2*pd*Math.atan(c),this.updateProjectionMatrix()}getFocalLength(){const o=Math.tan(.5*Xd*this.fov);return.5*this.getFilmHeight()/o}getEffectiveFOV(){return 2*pd*Math.atan(Math.tan(.5*Xd*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(o,c,h,m,M,N){this.aspect=o/c,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=o,this.view.fullHeight=c,this.view.offsetX=h,this.view.offsetY=m,this.view.width=M,this.view.height=N,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const o=this.near;let c=o*Math.tan(.5*Xd*this.fov)/this.zoom,h=2*c,m=this.aspect*h,M=-.5*m;const N=this.view;if(null!==this.view&&this.view.enabled){const de=N.fullWidth,pe=N.fullHeight;M+=N.offsetX*m/de,c-=N.offsetY*h/pe,m*=N.width/de,h*=N.height/pe}const q=this.filmOffset;0!==q&&(M+=o*q/this.getFilmWidth()),this.projectionMatrix.makePerspective(M,M+m,c,c-h,o,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(o){const c=super.toJSON(o);return c.object.fov=this.fov,c.object.zoom=this.zoom,c.object.near=this.near,c.object.far=this.far,c.object.focus=this.focus,c.object.aspect=this.aspect,null!==this.view&&(c.object.view=Object.assign({},this.view)),c.object.filmGauge=this.filmGauge,c.object.filmOffset=this.filmOffset,c}}class Al extends Rl{constructor(o,c,h){super(),this.type="CubeCamera",this.renderTarget=h,this.coordinateSystem=null,this.activeMipmapLevel=0;const m=new Vl(-90,1,o,c);m.layers=this.layers,this.add(m);const M=new Vl(-90,1,o,c);M.layers=this.layers,this.add(M);const N=new Vl(-90,1,o,c);N.layers=this.layers,this.add(N);const q=new Vl(-90,1,o,c);q.layers=this.layers,this.add(q);const de=new Vl(-90,1,o,c);de.layers=this.layers,this.add(de);const pe=new Vl(-90,1,o,c);pe.layers=this.layers,this.add(pe)}updateCoordinateSystem(){const o=this.coordinateSystem,c=this.children.concat(),[h,m,M,N,q,de]=c;for(const pe of c)this.remove(pe);if(o===Dd)h.up.set(0,1,0),h.lookAt(1,0,0),m.up.set(0,1,0),m.lookAt(-1,0,0),M.up.set(0,0,-1),M.lookAt(0,1,0),N.up.set(0,0,1),N.lookAt(0,-1,0),q.up.set(0,1,0),q.lookAt(0,0,1),de.up.set(0,1,0),de.lookAt(0,0,-1);else{if(2001!==o)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+o);h.up.set(0,-1,0),h.lookAt(-1,0,0),m.up.set(0,-1,0),m.lookAt(1,0,0),M.up.set(0,0,1),M.lookAt(0,1,0),N.up.set(0,0,-1),N.lookAt(0,-1,0),q.up.set(0,-1,0),q.lookAt(0,0,1),de.up.set(0,-1,0),de.lookAt(0,0,-1)}for(const pe of c)this.add(pe),pe.updateMatrixWorld()}update(o,c){null===this.parent&&this.updateMatrixWorld();const{renderTarget:h,activeMipmapLevel:m}=this;this.coordinateSystem!==o.coordinateSystem&&(this.coordinateSystem=o.coordinateSystem,this.updateCoordinateSystem());const[M,N,q,de,pe,xe]=this.children,Ie=o.getRenderTarget(),Be=o.getActiveCubeFace(),Le=o.getActiveMipmapLevel(),Ke=o.xr.enabled;o.xr.enabled=!1;const ft=h.texture.generateMipmaps;h.texture.generateMipmaps=!1,o.setRenderTarget(h,0,m),o.render(c,M),o.setRenderTarget(h,1,m),o.render(c,N),o.setRenderTarget(h,2,m),o.render(c,q),o.setRenderTarget(h,3,m),o.render(c,de),o.setRenderTarget(h,4,m),o.render(c,pe),h.texture.generateMipmaps=ft,o.setRenderTarget(h,5,m),o.render(c,xe),o.setRenderTarget(Ie,Be,Le),o.xr.enabled=Ke,h.texture.needsPMREMUpdate=!0}}class jp extends bu{constructor(o,c,h,m,M,N,q,de,pe,xe){super(o=void 0!==o?o:[],c=void 0!==c?c:Dn,h,m,M,N,q,de,pe,xe),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(o){this.image=o}}class zA extends Ou{constructor(o=1,c={}){super(o,o,c),this.isWebGLCubeRenderTarget=!0;const h={width:o,height:o,depth:1},m=[h,h,h,h,h,h];void 0!==c.encoding&&(Cm("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),c.colorSpace=c.encoding===$l?ll:""),this.texture=new jp(m,c.mapping,c.wrapS,c.wrapT,c.magFilter,c.minFilter,c.format,c.type,c.anisotropy,c.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==c.generateMipmaps&&c.generateMipmaps,this.texture.minFilter=void 0!==c.minFilter?c.minFilter:xt}fromEquirectangularTexture(o,c){this.texture.type=c.type,this.texture.colorSpace=c.colorSpace,this.texture.generateMipmaps=c.generateMipmaps,this.texture.minFilter=c.minFilter,this.texture.magFilter=c.magFilter;const h_uniforms={tEquirect:{value:null}},h_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",h_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",m=new Mh(5,5,5),M=new zl({name:"CubemapFromEquirect",uniforms:cs(h_uniforms),vertexShader:h_vertexShader,fragmentShader:h_fragmentShader,side:1,blending:0});M.uniforms.tEquirect.value=c;const N=new Jc(m,M),q=c.minFilter;return c.minFilter===ye&&(c.minFilter=xt),new Al(1,10,this).update(o,N),c.minFilter=q,N.geometry.dispose(),N.material.dispose(),this}clear(o,c,h,m){const M=o.getRenderTarget();for(let N=0;N<6;N++)o.setRenderTarget(this,N),o.clear(c,h,m);o.setRenderTarget(M)}}function op(w){let o=new WeakMap;function c(N,q){return 303===q?N.mapping=Dn:304===q&&(N.mapping=$n),N}function m(N){const q=N.target;q.removeEventListener("dispose",m);const de=o.get(q);void 0!==de&&(o.delete(q),de.dispose())}return{get:function h(N){if(N&&N.isTexture&&!1===N.isRenderTargetTexture){const q=N.mapping;if(303===q||304===q){if(o.has(N))return c(o.get(N).texture,N.mapping);{const de=N.image;if(de&&de.height>0){const pe=new zA(de.height/2);return pe.fromEquirectangularTexture(w,N),o.set(N,pe),N.addEventListener("dispose",m),c(pe.texture,N.mapping)}return null}}}return N},dispose:function M(){o=new WeakMap}}}class kd extends sp{constructor(o=-1,c=1,h=1,m=-1,M=.1,N=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=o,this.right=c,this.top=h,this.bottom=m,this.near=M,this.far=N,this.updateProjectionMatrix()}copy(o,c){return super.copy(o,c),this.left=o.left,this.right=o.right,this.top=o.top,this.bottom=o.bottom,this.near=o.near,this.far=o.far,this.zoom=o.zoom,this.view=null===o.view?null:Object.assign({},o.view),this}setViewOffset(o,c,h,m,M,N){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=o,this.view.fullHeight=c,this.view.offsetX=h,this.view.offsetY=m,this.view.width=M,this.view.height=N,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const o=(this.right-this.left)/(2*this.zoom),c=(this.top-this.bottom)/(2*this.zoom),h=(this.right+this.left)/2,m=(this.top+this.bottom)/2;let M=h-o,N=h+o,q=m+c,de=m-c;if(null!==this.view&&this.view.enabled){const pe=(this.right-this.left)/this.view.fullWidth/this.zoom,xe=(this.top-this.bottom)/this.view.fullHeight/this.zoom;M+=pe*this.view.offsetX,N=M+pe*this.view.width,q-=xe*this.view.offsetY,de=q-xe*this.view.height}this.projectionMatrix.makeOrthographic(M,N,q,de,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(o){const c=super.toJSON(o);return c.object.zoom=this.zoom,c.object.left=this.left,c.object.right=this.right,c.object.top=this.top,c.object.bottom=this.bottom,c.object.near=this.near,c.object.far=this.far,null!==this.view&&(c.object.view=Object.assign({},this.view)),c}}const t0=[.125,.215,.35,.446,.526,.582],m_=new kd,HA=new Os;let Vm=null,H1=0,n0=0;const Gm=(1+Math.sqrt(5))/2,VA=1/Gm,A_=[new Ft(1,1,1),new Ft(-1,1,1),new Ft(1,1,-1),new Ft(-1,1,-1),new Ft(0,Gm,VA),new Ft(0,Gm,-VA),new Ft(VA,0,Gm),new Ft(-VA,0,Gm),new Ft(Gm,VA,0),new Ft(-Gm,VA,0)];class g_{constructor(o){this._renderer=o,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(o,c=0,h=.1,m=100){Vm=this._renderer.getRenderTarget(),H1=this._renderer.getActiveCubeFace(),n0=this._renderer.getActiveMipmapLevel(),this._setSize(256);const M=this._allocateTargets();return M.depthBuffer=!0,this._sceneToCubeUV(o,h,m,M),c>0&&this._blur(M,0,0,c),this._applyPMREM(M),this._cleanup(M),M}fromEquirectangular(o,c=null){return this._fromTexture(o,c)}fromCubemap(o,c=null){return this._fromTexture(o,c)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=Ls(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=Wm(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(o){this._lodMax=Math.floor(Math.log2(o)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let o=0;o<this._lodPlanes.length;o++)this._lodPlanes[o].dispose()}_cleanup(o){this._renderer.setRenderTarget(Vm,H1,n0),o.scissorTest=!1,Qm(o,0,0,o.width,o.height)}_fromTexture(o,c){this._setSize(o.mapping===Dn||o.mapping===$n?0===o.image.length?16:o.image[0].width||o.image[0].image.width:o.image.width/4),Vm=this._renderer.getRenderTarget(),H1=this._renderer.getActiveCubeFace(),n0=this._renderer.getActiveMipmapLevel();const h=c||this._allocateTargets();return this._textureToCubeUV(o,h),this._applyPMREM(h),this._cleanup(h),h}_allocateTargets(){const o=3*Math.max(this._cubeSize,112),c=4*this._cubeSize,h={magFilter:xt,minFilter:xt,generateMipmaps:!1,type:In,format:Jn,colorSpace:sc,depthBuffer:!1},m=oo(o,c,h);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==o||this._pingPongRenderTarget.height!==c){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=oo(o,c,h);const{_lodMax:M}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function qm(w){const o=[],c=[],h=[];let m=w;const M=w-4+1+t0.length;for(let N=0;N<M;N++){const q=Math.pow(2,m);c.push(q);let de=1/q;N>w-4?de=t0[N-w+4-1]:0===N&&(de=0),h.push(de);const pe=1/(q-2),xe=-pe,Ie=1+pe,Be=[xe,xe,Ie,xe,Ie,Ie,xe,xe,Ie,Ie,xe,Ie],Le=6,Ke=6,ft=3,We=2,ze=1,Mt=new Float32Array(ft*Ke*Le),ct=new Float32Array(We*Ke*Le),Dt=new Float32Array(ze*Ke*Le);for(let cn=0;cn<Le;cn++){const rn=cn%3*2/3-1,Rn=cn>2?0:-1;Mt.set([rn,Rn,0,rn+2/3,Rn,0,rn+2/3,Rn+1,0,rn,Rn,0,rn+2/3,Rn+1,0,rn,Rn+1,0],ft*Ke*cn),ct.set(Be,We*Ke*cn),Dt.set([cn,cn,cn,cn,cn,cn],ze*Ke*cn)}const Jt=new Cs;Jt.setAttribute("position",new sa(Mt,ft)),Jt.setAttribute("uv",new sa(ct,We)),Jt.setAttribute("faceIndex",new sa(Dt,ze)),o.push(Jt),m>4&&m--}return{lodPlanes:o,sizeLods:c,sigmas:h}}(M)),this._blurMaterial=function __(w,o,c){const h=new Float32Array(20),m=new Ft(0,1,0);return new zl({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/o,CUBEUV_TEXEL_HEIGHT:1/c,CUBEUV_MAX_MIP:`${w}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:h},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:m}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(M,o,c)}return m}_compileMaterial(o){const c=new Jc(this._lodPlanes[0],o);this._renderer.compile(c,m_)}_sceneToCubeUV(o,c,h,m){const q=new Vl(90,1,c,h),de=[1,-1,1,1,1,1],pe=[1,1,1,-1,-1,-1],xe=this._renderer,Ie=xe.autoClear,Be=xe.toneMapping;xe.getClearColor(HA),xe.toneMapping=pt,xe.autoClear=!1;const Le=new Xc({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),Ke=new Jc(new Mh,Le);let ft=!1;const We=o.background;We?We.isColor&&(Le.color.copy(We),o.background=null,ft=!0):(Le.color.copy(HA),ft=!0);for(let ze=0;ze<6;ze++){const Mt=ze%3;0===Mt?(q.up.set(0,de[ze],0),q.lookAt(pe[ze],0,0)):1===Mt?(q.up.set(0,0,de[ze]),q.lookAt(0,pe[ze],0)):(q.up.set(0,de[ze],0),q.lookAt(0,0,pe[ze]));const ct=this._cubeSize;Qm(m,Mt*ct,ze>2?ct:0,ct,ct),xe.setRenderTarget(m),ft&&xe.render(Ke,q),xe.render(o,q)}Ke.geometry.dispose(),Ke.material.dispose(),xe.toneMapping=Be,xe.autoClear=Ie,o.background=We}_textureToCubeUV(o,c){const h=this._renderer,m=o.mapping===Dn||o.mapping===$n;m?(null===this._cubemapMaterial&&(this._cubemapMaterial=Ls()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===o.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=Wm());const M=m?this._cubemapMaterial:this._equirectMaterial,N=new Jc(this._lodPlanes[0],M);M.uniforms.envMap.value=o;const de=this._cubeSize;Qm(c,0,0,3*de,2*de),h.setRenderTarget(c),h.render(N,m_)}_applyPMREM(o){const c=this._renderer,h=c.autoClear;c.autoClear=!1;for(let m=1;m<this._lodPlanes.length;m++){const M=Math.sqrt(this._sigmas[m]*this._sigmas[m]-this._sigmas[m-1]*this._sigmas[m-1]);this._blur(o,m-1,m,M,A_[(m-1)%A_.length])}c.autoClear=h}_blur(o,c,h,m,M){const N=this._pingPongRenderTarget;this._halfBlur(o,N,c,h,m,"latitudinal",M),this._halfBlur(N,o,h,h,m,"longitudinal",M)}_halfBlur(o,c,h,m,M,N,q){const de=this._renderer,pe=this._blurMaterial;"latitudinal"!==N&&"longitudinal"!==N&&console.error("blur direction must be either latitudinal or longitudinal!");const Ie=new Jc(this._lodPlanes[m],pe),Be=pe.uniforms,Le=this._sizeLods[h]-1,Ke=isFinite(M)?Math.PI/(2*Le):2*Math.PI/39,ft=M/Ke,We=isFinite(M)?1+Math.floor(3*ft):20;We>20&&console.warn(`sigmaRadians, ${M}, is too large and will clip, as it requested ${We} samples when the maximum is set to 20`);const ze=[];let Mt=0;for(let rn=0;rn<20;++rn){const Rn=rn/ft,kt=Math.exp(-Rn*Rn/2);ze.push(kt),0===rn?Mt+=kt:rn<We&&(Mt+=2*kt)}for(let rn=0;rn<ze.length;rn++)ze[rn]=ze[rn]/Mt;Be.envMap.value=o.texture,Be.samples.value=We,Be.weights.value=ze,Be.latitudinal.value="latitudinal"===N,q&&(Be.poleAxis.value=q);const{_lodMax:ct}=this;Be.dTheta.value=Ke,Be.mipInt.value=ct-h;const Dt=this._sizeLods[m];Qm(c,3*Dt*(m>ct-4?m-ct+4:0),4*(this._cubeSize-Dt),3*Dt,2*Dt),de.setRenderTarget(c),de.render(Ie,m_)}}function oo(w,o,c){const h=new Ou(w,o,c);return h.texture.mapping=Sn,h.texture.name="PMREM.cubeUv",h.scissorTest=!0,h}function Qm(w,o,c,h,m){w.viewport.set(o,c,h,m),w.scissor.set(o,c,h,m)}function Wm(){return new zl({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Ls(){return new zl({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function _f(w){let o=new WeakMap,c=null;function M(q){const de=q.target;de.removeEventListener("dispose",M);const pe=o.get(de);void 0!==pe&&(o.delete(de),pe.dispose())}return{get:function h(q){if(q&&q.isTexture){const de=q.mapping,pe=303===de||304===de,xe=de===Dn||de===$n;if(pe||xe){if(q.isRenderTargetTexture&&!0===q.needsPMREMUpdate){q.needsPMREMUpdate=!1;let Ie=o.get(q);return null===c&&(c=new g_(w)),Ie=pe?c.fromEquirectangular(q,Ie):c.fromCubemap(q,Ie),o.set(q,Ie),Ie.texture}if(o.has(q))return o.get(q).texture;{const Ie=q.image;if(pe&&Ie&&Ie.height>0||xe&&Ie&&function m(q){let de=0;for(let xe=0;xe<6;xe++)void 0!==q[xe]&&de++;return 6===de}(Ie)){null===c&&(c=new g_(w));const Be=pe?c.fromEquirectangular(q):c.fromCubemap(q);return o.set(q,Be),q.addEventListener("dispose",M),Be.texture}return null}}}return q},dispose:function N(){o=new WeakMap,null!==c&&(c.dispose(),c=null)}}}function ap(w){const o={};function c(h){if(void 0!==o[h])return o[h];let m;switch(h){case"WEBGL_depth_texture":m=w.getExtension("WEBGL_depth_texture")||w.getExtension("MOZ_WEBGL_depth_texture")||w.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":m=w.getExtension("EXT_texture_filter_anisotropic")||w.getExtension("MOZ_EXT_texture_filter_anisotropic")||w.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":m=w.getExtension("WEBGL_compressed_texture_s3tc")||w.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||w.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":m=w.getExtension("WEBGL_compressed_texture_pvrtc")||w.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:m=w.getExtension(h)}return o[h]=m,m}return{has:function(h){return null!==c(h)},init:function(h){h.isWebGL2?c("EXT_color_buffer_float"):(c("WEBGL_depth_texture"),c("OES_texture_float"),c("OES_texture_half_float"),c("OES_texture_half_float_linear"),c("OES_standard_derivatives"),c("OES_element_index_uint"),c("OES_vertex_array_object"),c("ANGLE_instanced_arrays")),c("OES_texture_float_linear"),c("EXT_color_buffer_half_float"),c("WEBGL_multisampled_render_to_texture")},get:function(h){const m=c(h);return null===m&&console.warn("THREE.WebGLRenderer: "+h+" extension not supported."),m}}}function s0(w,o,c,h){const m={},M=new WeakMap;function N(Ie){const Be=Ie.target;null!==Be.index&&o.remove(Be.index);for(const Ke in Be.attributes)o.remove(Be.attributes[Ke]);for(const Ke in Be.morphAttributes){const ft=Be.morphAttributes[Ke];for(let We=0,ze=ft.length;We<ze;We++)o.remove(ft[We])}Be.removeEventListener("dispose",N),delete m[Be.id];const Le=M.get(Be);Le&&(o.remove(Le),M.delete(Be)),h.releaseStatesOfGeometry(Be),!0===Be.isInstancedBufferGeometry&&delete Be._maxInstanceCount,c.memory.geometries--}function pe(Ie){const Be=[],Le=Ie.index,Ke=Ie.attributes.position;let ft=0;if(null!==Le){const Mt=Le.array;ft=Le.version;for(let ct=0,Dt=Mt.length;ct<Dt;ct+=3){const Jt=Mt[ct+0],cn=Mt[ct+1],rn=Mt[ct+2];Be.push(Jt,cn,cn,rn,rn,Jt)}}else{if(void 0===Ke)return;ft=Ke.version;for(let ct=0,Dt=Ke.array.length/3-1;ct<Dt;ct+=3){const Jt=ct+0,cn=ct+1,rn=ct+2;Be.push(Jt,cn,cn,rn,rn,Jt)}}const We=new(Wc(Be)?wA:_1)(Be,1);We.version=ft;const ze=M.get(Ie);ze&&o.remove(ze),M.set(Ie,We)}return{get:function q(Ie,Be){return!0===m[Be.id]||(Be.addEventListener("dispose",N),m[Be.id]=!0,c.memory.geometries++),Be},update:function de(Ie){const Be=Ie.attributes;for(const Ke in Be)o.update(Be[Ke],w.ARRAY_BUFFER);const Le=Ie.morphAttributes;for(const Ke in Le){const ft=Le[Ke];for(let We=0,ze=ft.length;We<ze;We++)o.update(ft[We],w.ARRAY_BUFFER)}},getWireframeAttribute:function xe(Ie){const Be=M.get(Ie);if(Be){const Le=Ie.index;null!==Le&&Be.version<Le.version&&pe(Ie)}else pe(Ie);return M.get(Ie)}}}function ne(w,o,c,h){const m=h.isWebGL2;let M,q,de;this.setMode=function N(Be){M=Be},this.setIndex=function pe(Be){q=Be.type,de=Be.bytesPerElement},this.render=function xe(Be,Le){w.drawElements(M,Le,q,Be*de),c.update(Le,M,1)},this.renderInstances=function Ie(Be,Le,Ke){if(0===Ke)return;let ft,We;if(m)ft=w,We="drawElementsInstanced";else if(ft=o.get("ANGLE_instanced_arrays"),We="drawElementsInstancedANGLE",null===ft)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");ft[We](M,Le,q,Be*de,Ke),c.update(Le,M,Ke)}}function j(w){const c={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:c,programs:null,autoReset:!0,reset:function m(){c.calls=0,c.triangles=0,c.points=0,c.lines=0},update:function h(M,N,q){switch(c.calls++,N){case w.TRIANGLES:c.triangles+=q*(M/3);break;case w.LINES:c.lines+=q*(M/2);break;case w.LINE_STRIP:c.lines+=q*(M-1);break;case w.LINE_LOOP:c.lines+=q*M;break;case w.POINTS:c.points+=q*M;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",N)}}}}class le extends bu{constructor(o=null,c=1,h=1,m=1){super(null),this.isDataArrayTexture=!0,this.image={data:o,width:c,height:h,depth:m},this.magFilter=ti,this.minFilter=ti,this.wrapR=ai,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}function ae(w,o){return w[0]-o[0]}function Ue(w,o){return Math.abs(o[1])-Math.abs(w[1])}function dt(w,o,c){const h={},m=new Float32Array(8),M=new WeakMap,N=new il,q=[];for(let pe=0;pe<8;pe++)q[pe]=[pe,0];return{update:function de(pe,xe,Ie){const Be=pe.morphTargetInfluences;if(!0===o.isWebGL2){const Le=xe.morphAttributes.position||xe.morphAttributes.normal||xe.morphAttributes.color,Ke=void 0!==Le?Le.length:0;let ft=M.get(xe);if(void 0===ft||ft.count!==Ke){let Yn=function(){Ti.dispose(),M.delete(xe),xe.removeEventListener("dispose",Yn)};void 0!==ft&&ft.texture.dispose();const Mt=void 0!==xe.morphAttributes.position,ct=void 0!==xe.morphAttributes.normal,Dt=void 0!==xe.morphAttributes.color,Jt=xe.morphAttributes.position||[],cn=xe.morphAttributes.normal||[],rn=xe.morphAttributes.color||[];let Rn=0;!0===Mt&&(Rn=1),!0===ct&&(Rn=2),!0===Dt&&(Rn=3);let kt=xe.attributes.position.count*Rn,Zt=1;kt>o.maxTextureSize&&(Zt=Math.ceil(kt/o.maxTextureSize),kt=o.maxTextureSize);const li=new Float32Array(kt*Zt*4*Ke),Ti=new le(li,kt,Zt,Ke);Ti.type=dn,Ti.needsUpdate=!0;const ur=4*Rn;for(let Di=0;Di<Ke;Di++){const rr=Jt[Di],Li=cn[Di],br=rn[Di],Ji=kt*Zt*4*Di;for(let lr=0;lr<rr.count;lr++){const ei=lr*ur;!0===Mt&&(N.fromBufferAttribute(rr,lr),li[Ji+ei+0]=N.x,li[Ji+ei+1]=N.y,li[Ji+ei+2]=N.z,li[Ji+ei+3]=0),!0===ct&&(N.fromBufferAttribute(Li,lr),li[Ji+ei+4]=N.x,li[Ji+ei+5]=N.y,li[Ji+ei+6]=N.z,li[Ji+ei+7]=0),!0===Dt&&(N.fromBufferAttribute(br,lr),li[Ji+ei+8]=N.x,li[Ji+ei+9]=N.y,li[Ji+ei+10]=N.z,li[Ji+ei+11]=4===br.itemSize?N.w:1)}}ft={count:Ke,texture:Ti,size:new zi(kt,Zt)},M.set(xe,ft),xe.addEventListener("dispose",Yn)}let We=0;for(let Mt=0;Mt<Be.length;Mt++)We+=Be[Mt];const ze=xe.morphTargetsRelative?1:1-We;Ie.getUniforms().setValue(w,"morphTargetBaseInfluence",ze),Ie.getUniforms().setValue(w,"morphTargetInfluences",Be),Ie.getUniforms().setValue(w,"morphTargetsTexture",ft.texture,c),Ie.getUniforms().setValue(w,"morphTargetsTextureSize",ft.size)}else{const Le=void 0===Be?0:Be.length;let Ke=h[xe.id];if(void 0===Ke||Ke.length!==Le){Ke=[];for(let ct=0;ct<Le;ct++)Ke[ct]=[ct,0];h[xe.id]=Ke}for(let ct=0;ct<Le;ct++){const Dt=Ke[ct];Dt[0]=ct,Dt[1]=Be[ct]}Ke.sort(Ue);for(let ct=0;ct<8;ct++)ct<Le&&Ke[ct][1]?(q[ct][0]=Ke[ct][0],q[ct][1]=Ke[ct][1]):(q[ct][0]=Number.MAX_SAFE_INTEGER,q[ct][1]=0);q.sort(ae);const ft=xe.morphAttributes.position,We=xe.morphAttributes.normal;let ze=0;for(let ct=0;ct<8;ct++){const Dt=q[ct],Jt=Dt[0],cn=Dt[1];Jt!==Number.MAX_SAFE_INTEGER&&cn?(ft&&xe.getAttribute("morphTarget"+ct)!==ft[Jt]&&xe.setAttribute("morphTarget"+ct,ft[Jt]),We&&xe.getAttribute("morphNormal"+ct)!==We[Jt]&&xe.setAttribute("morphNormal"+ct,We[Jt]),m[ct]=cn,ze+=cn):(ft&&!0===xe.hasAttribute("morphTarget"+ct)&&xe.deleteAttribute("morphTarget"+ct),We&&!0===xe.hasAttribute("morphNormal"+ct)&&xe.deleteAttribute("morphNormal"+ct),m[ct]=0)}const Mt=xe.morphTargetsRelative?1:1-ze;Ie.getUniforms().setValue(w,"morphTargetBaseInfluence",Mt),Ie.getUniforms().setValue(w,"morphTargetInfluences",m)}}}}function Bt(w,o,c,h){let m=new WeakMap;function q(de){const pe=de.target;pe.removeEventListener("dispose",q),c.remove(pe.instanceMatrix),null!==pe.instanceColor&&c.remove(pe.instanceColor)}return{update:function M(de){const pe=h.render.frame,Ie=o.get(de,de.geometry);if(m.get(Ie)!==pe&&(o.update(Ie),m.set(Ie,pe)),de.isInstancedMesh&&(!1===de.hasEventListener("dispose",q)&&de.addEventListener("dispose",q),m.get(de)!==pe&&(c.update(de.instanceMatrix,w.ARRAY_BUFFER),null!==de.instanceColor&&c.update(de.instanceColor,w.ARRAY_BUFFER),m.set(de,pe))),de.isSkinnedMesh){const Be=de.skeleton;m.get(Be)!==pe&&(Be.update(),m.set(Be,pe))}return Ie},dispose:function N(){m=new WeakMap}}}class ln extends bu{constructor(o=null,c=1,h=1,m=1){super(null),this.isData3DTexture=!0,this.image={data:o,width:c,height:h,depth:m},this.magFilter=ti,this.minFilter=ti,this.wrapR=ai,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const on=new bu,jn=new le,Zn=new ln,ri=new jp,Xi=[],Ss=[],zr=new Float32Array(16),Hr=new Float32Array(9),Ho=new Float32Array(4);function Ns(w,o,c){const h=w[0];if(h<=0||h>0)return w;const m=o*c;let M=Xi[m];if(void 0===M&&(M=new Float32Array(m),Xi[m]=M),0!==o){h.toArray(M,0);for(let N=1,q=0;N!==o;++N)q+=c,w[N].toArray(M,q)}return M}function Jr(w,o){if(w.length!==o.length)return!1;for(let c=0,h=w.length;c<h;c++)if(w[c]!==o[c])return!1;return!0}function So(w,o){for(let c=0,h=o.length;c<h;c++)w[c]=o[c]}function Xo(w,o){let c=Ss[o];void 0===c&&(c=new Int32Array(o),Ss[o]=c);for(let h=0;h!==o;++h)c[h]=w.allocateTextureUnit();return c}function Fo(w,o){const c=this.cache;c[0]!==o&&(w.uniform1f(this.addr,o),c[0]=o)}function Es(w,o){const c=this.cache;if(void 0!==o.x)(c[0]!==o.x||c[1]!==o.y)&&(w.uniform2f(this.addr,o.x,o.y),c[0]=o.x,c[1]=o.y);else{if(Jr(c,o))return;w.uniform2fv(this.addr,o),So(c,o)}}function La(w,o){const c=this.cache;if(void 0!==o.x)(c[0]!==o.x||c[1]!==o.y||c[2]!==o.z)&&(w.uniform3f(this.addr,o.x,o.y,o.z),c[0]=o.x,c[1]=o.y,c[2]=o.z);else if(void 0!==o.r)(c[0]!==o.r||c[1]!==o.g||c[2]!==o.b)&&(w.uniform3f(this.addr,o.r,o.g,o.b),c[0]=o.r,c[1]=o.g,c[2]=o.b);else{if(Jr(c,o))return;w.uniform3fv(this.addr,o),So(c,o)}}function Ba(w,o){const c=this.cache;if(void 0!==o.x)(c[0]!==o.x||c[1]!==o.y||c[2]!==o.z||c[3]!==o.w)&&(w.uniform4f(this.addr,o.x,o.y,o.z,o.w),c[0]=o.x,c[1]=o.y,c[2]=o.z,c[3]=o.w);else{if(Jr(c,o))return;w.uniform4fv(this.addr,o),So(c,o)}}function Vo(w,o){const c=this.cache,h=o.elements;if(void 0===h){if(Jr(c,o))return;w.uniformMatrix2fv(this.addr,!1,o),So(c,o)}else{if(Jr(c,h))return;Ho.set(h),w.uniformMatrix2fv(this.addr,!1,Ho),So(c,h)}}function wc(w,o){const c=this.cache,h=o.elements;if(void 0===h){if(Jr(c,o))return;w.uniformMatrix3fv(this.addr,!1,o),So(c,o)}else{if(Jr(c,h))return;Hr.set(h),w.uniformMatrix3fv(this.addr,!1,Hr),So(c,h)}}function tu(w,o){const c=this.cache,h=o.elements;if(void 0===h){if(Jr(c,o))return;w.uniformMatrix4fv(this.addr,!1,o),So(c,o)}else{if(Jr(c,h))return;zr.set(h),w.uniformMatrix4fv(this.addr,!1,zr),So(c,h)}}function wu(w,o){const c=this.cache;c[0]!==o&&(w.uniform1i(this.addr,o),c[0]=o)}function ul(w,o){const c=this.cache;if(void 0!==o.x)(c[0]!==o.x||c[1]!==o.y)&&(w.uniform2i(this.addr,o.x,o.y),c[0]=o.x,c[1]=o.y);else{if(Jr(c,o))return;w.uniform2iv(this.addr,o),So(c,o)}}function Kc(w,o){const c=this.cache;if(void 0!==o.x)(c[0]!==o.x||c[1]!==o.y||c[2]!==o.z)&&(w.uniform3i(this.addr,o.x,o.y,o.z),c[0]=o.x,c[1]=o.y,c[2]=o.z);else{if(Jr(c,o))return;w.uniform3iv(this.addr,o),So(c,o)}}function yf(w,o){const c=this.cache;if(void 0!==o.x)(c[0]!==o.x||c[1]!==o.y||c[2]!==o.z||c[3]!==o.w)&&(w.uniform4i(this.addr,o.x,o.y,o.z,o.w),c[0]=o.x,c[1]=o.y,c[2]=o.z,c[3]=o.w);else{if(Jr(c,o))return;w.uniform4iv(this.addr,o),So(c,o)}}function ed(w,o){const c=this.cache;c[0]!==o&&(w.uniform1ui(this.addr,o),c[0]=o)}function Fd(w,o){const c=this.cache;if(void 0!==o.x)(c[0]!==o.x||c[1]!==o.y)&&(w.uniform2ui(this.addr,o.x,o.y),c[0]=o.x,c[1]=o.y);else{if(Jr(c,o))return;w.uniform2uiv(this.addr,o),So(c,o)}}function lp(w,o){const c=this.cache;if(void 0!==o.x)(c[0]!==o.x||c[1]!==o.y||c[2]!==o.z)&&(w.uniform3ui(this.addr,o.x,o.y,o.z),c[0]=o.x,c[1]=o.y,c[2]=o.z);else{if(Jr(c,o))return;w.uniform3uiv(this.addr,o),So(c,o)}}function gh(w,o){const c=this.cache;if(void 0!==o.x)(c[0]!==o.x||c[1]!==o.y||c[2]!==o.z||c[3]!==o.w)&&(w.uniform4ui(this.addr,o.x,o.y,o.z,o.w),c[0]=o.x,c[1]=o.y,c[2]=o.z,c[3]=o.w);else{if(Jr(c,o))return;w.uniform4uiv(this.addr,o),So(c,o)}}function vf(w,o,c){const h=this.cache,m=c.allocateTextureUnit();h[0]!==m&&(w.uniform1i(this.addr,m),h[0]=m),c.setTexture2D(o||on,m)}function $p(w,o,c){const h=this.cache,m=c.allocateTextureUnit();h[0]!==m&&(w.uniform1i(this.addr,m),h[0]=m),c.setTexture3D(o||Zn,m)}function Xp(w,o,c){const h=this.cache,m=c.allocateTextureUnit();h[0]!==m&&(w.uniform1i(this.addr,m),h[0]=m),c.setTextureCube(o||ri,m)}function bf(w,o,c){const h=this.cache,m=c.allocateTextureUnit();h[0]!==m&&(w.uniform1i(this.addr,m),h[0]=m),c.setTexture2DArray(o||jn,m)}function kh(w,o){w.uniform1fv(this.addr,o)}function GA(w,o){const c=Ns(o,this.size,2);w.uniform2fv(this.addr,c)}function jm(w,o){const c=Ns(o,this.size,3);w.uniform3fv(this.addr,c)}function zC(w,o){const c=Ns(o,this.size,4);w.uniform4fv(this.addr,c)}function zx(w,o){const c=Ns(o,this.size,4);w.uniformMatrix2fv(this.addr,!1,c)}function oT(w,o){const c=Ns(o,this.size,9);w.uniformMatrix3fv(this.addr,!1,c)}function HC(w,o){const c=Ns(o,this.size,16);w.uniformMatrix4fv(this.addr,!1,c)}function Hx(w,o){w.uniform1iv(this.addr,o)}function wv(w,o){w.uniform2iv(this.addr,o)}function VC(w,o){w.uniform3iv(this.addr,o)}function $m(w,o){w.uniform4iv(this.addr,o)}function y_(w,o){w.uniform1uiv(this.addr,o)}function GC(w,o){w.uniform2uiv(this.addr,o)}function Vx(w,o){w.uniform3uiv(this.addr,o)}function Kp(w,o){w.uniform4uiv(this.addr,o)}function aT(w,o,c){const h=this.cache,m=o.length,M=Xo(c,m);Jr(h,M)||(w.uniform1iv(this.addr,M),So(h,M));for(let N=0;N!==m;++N)c.setTexture2D(o[N]||on,M[N])}function Od(w,o,c){const h=this.cache,m=o.length,M=Xo(c,m);Jr(h,M)||(w.uniform1iv(this.addr,M),So(h,M));for(let N=0;N!==m;++N)c.setTexture3D(o[N]||Zn,M[N])}function Cv(w,o,c){const h=this.cache,m=o.length,M=Xo(c,m);Jr(h,M)||(w.uniform1iv(this.addr,M),So(h,M));for(let N=0;N!==m;++N)c.setTextureCube(o[N]||ri,M[N])}function qC(w,o,c){const h=this.cache,m=o.length,M=Xo(c,m);Jr(h,M)||(w.uniform1iv(this.addr,M),So(h,M));for(let N=0;N!==m;++N)c.setTexture2DArray(o[N]||jn,M[N])}class lT{constructor(o,c,h){this.id=o,this.addr=h,this.cache=[],this.setValue=function Yp(w){switch(w){case 5126:return Fo;case 35664:return Es;case 35665:return La;case 35666:return Ba;case 35674:return Vo;case 35675:return wc;case 35676:return tu;case 5124:case 35670:return wu;case 35667:case 35671:return ul;case 35668:case 35672:return Kc;case 35669:case 35673:return yf;case 5125:return ed;case 36294:return Fd;case 36295:return lp;case 36296:return gh;case 35678:case 36198:case 36298:case 36306:case 35682:return vf;case 35679:case 36299:case 36307:return $p;case 35680:case 36300:case 36308:case 36293:return Xp;case 36289:case 36303:case 36311:case 36292:return bf}}(c.type)}}class Zp{constructor(o,c,h){this.id=o,this.addr=h,this.cache=[],this.size=c.size,this.setValue=function QC(w){switch(w){case 5126:return kh;case 35664:return GA;case 35665:return jm;case 35666:return zC;case 35674:return zx;case 35675:return oT;case 35676:return HC;case 5124:case 35670:return Hx;case 35667:case 35671:return wv;case 35668:case 35672:return VC;case 35669:case 35673:return $m;case 5125:return y_;case 36294:return GC;case 36295:return Vx;case 36296:return Kp;case 35678:case 36198:case 36298:case 36306:case 35682:return aT;case 35679:case 36299:case 36307:return Od;case 35680:case 36300:case 36308:case 36293:return Cv;case 36289:case 36303:case 36311:case 36292:return qC}}(c.type)}}class V1{constructor(o){this.id=o,this.seq=[],this.map={}}setValue(o,c,h){const m=this.seq;for(let M=0,N=m.length;M!==N;++M){const q=m[M];q.setValue(o,c[q.id],h)}}}const G1=/(\w+)(\])?(\[|\.)?/g;function Fh(w,o){w.seq.push(o),w.map[o.id]=o}function Mv(w,o,c){const h=w.name,m=h.length;for(G1.lastIndex=0;;){const M=G1.exec(h);let q=M[1];const pe=M[3];if("]"===M[2]&&(q|=0),void 0===pe||"["===pe&&G1.lastIndex+2===m){Fh(c,void 0===pe?new lT(q,w,o):new Zp(q,w,o));break}{let Ie=c.map[q];void 0===Ie&&(Ie=new V1(q),Fh(c,Ie)),c=Ie}}}class Jp{constructor(o,c){this.seq=[],this.map={};const h=o.getProgramParameter(c,o.ACTIVE_UNIFORMS);for(let m=0;m<h;++m){const M=o.getActiveUniform(c,m);Mv(M,o.getUniformLocation(c,M.name),this)}}setValue(o,c,h,m){const M=this.map[c];void 0!==M&&M.setValue(o,h,m)}setOptional(o,c,h){const m=c[h];void 0!==m&&this.setValue(o,h,m)}static upload(o,c,h,m){for(let M=0,N=c.length;M!==N;++M){const q=c[M],de=h[q.id];!1!==de.needsUpdate&&q.setValue(o,de.value,m)}}static seqWithValue(o,c){const h=[];for(let m=0,M=o.length;m!==M;++m){const N=o[m];N.id in c&&h.push(N)}return h}}function q1(w,o,c){const h=w.createShader(o);return w.shaderSource(h,c),w.compileShader(h),h}const Sv=37297;let v_=0;function V(w,o,c){const h=w.getShaderParameter(o,w.COMPILE_STATUS),m=w.getShaderInfoLog(o).trim();if(h&&""===m)return"";const M=/ERROR: 0:(\d+)/.exec(m);if(M){const N=parseInt(M[1]);return c.toUpperCase()+"\n\n"+m+"\n\n"+function Ev(w,o){const c=w.split("\n"),h=[],m=Math.max(o-6,0),M=Math.min(o+6,c.length);for(let N=m;N<M;N++){const q=N+1;h.push(`${q===o?">":" "} ${q}: ${c[N]}`)}return h.join("\n")}(w.getShaderSource(o),N)}return m}function Ae(w,o){const c=function y(w){const o=Ya.getPrimaries(Ya.workingColorSpace),c=Ya.getPrimaries(w);let h;switch(o===c?h="":o===Uf&&c===N0?h="LinearDisplayP3ToLinearSRGB":o===N0&&c===Uf&&(h="LinearSRGBToLinearDisplayP3"),w){case sc:case eh:return[h,"LinearTransferOETF"];case ll:case Ju:return[h,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",w),[h,"LinearTransferOETF"]}}(o);return`vec4 ${w}( vec4 value ) { return ${c[0]}( ${c[1]}( value ) ); }`}function be(w,o){let c;switch(o){case st:c="Linear";break;case vt:c="Reinhard";break;case Yt:c="OptimizedCineon";break;case qt:c="ACESFilmic";break;case Ot:c="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",o),c="Linear"}return"vec3 "+w+"( vec3 color ) { return "+c+"ToneMapping( color ); }"}function Tt(w){return""!==w}function Gt(w,o){const c=o.numSpotLightShadows+o.numSpotLightMaps-o.numSpotLightShadowsWithMaps;return w.replace(/NUM_DIR_LIGHTS/g,o.numDirLights).replace(/NUM_SPOT_LIGHTS/g,o.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,o.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,c).replace(/NUM_RECT_AREA_LIGHTS/g,o.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,o.numPointLights).replace(/NUM_HEMI_LIGHTS/g,o.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,o.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,o.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,o.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,o.numPointLightShadows)}function Wt(w,o){return w.replace(/NUM_CLIPPING_PLANES/g,o.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,o.numClippingPlanes-o.numClipIntersection)}const pn=/^[ \t]*#include +<([\w\d./]+)>/gm;function Qn(w){return w.replace(pn,Ei)}const Wn=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function Ei(w,o){let c=Ko[o];if(void 0===c){const h=Wn.get(o);if(void 0===h)throw new Error("Can not resolve #include <"+o+">");c=Ko[h],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',o,h)}return Qn(c)}const kr=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function pr(w){return w.replace(kr,wr)}function wr(w,o,c,h){let m="";for(let M=parseInt(o);M<parseInt(c);M++)m+=h.replace(/\[\s*i\s*\]/g,"[ "+M+" ]").replace(/UNROLLED_LOOP_INDEX/g,M);return m}function Ts(w){let o="precision "+w.precision+" float;\nprecision "+w.precision+" int;";return"highp"===w.precision?o+="\n#define HIGH_PRECISION":"mediump"===w.precision?o+="\n#define MEDIUM_PRECISION":"lowp"===w.precision&&(o+="\n#define LOW_PRECISION"),o}function Go(w,o,c,h){const m=w.getContext(),M=c.defines;let N=c.vertexShader,q=c.fragmentShader;const de=function jo(w){let o="SHADOWMAP_TYPE_BASIC";return w.shadowMapType===He?o="SHADOWMAP_TYPE_PCF":w.shadowMapType===Ve?o="SHADOWMAP_TYPE_PCF_SOFT":w.shadowMapType===De&&(o="SHADOWMAP_TYPE_VSM"),o}(c),pe=function qr(w){let o="ENVMAP_TYPE_CUBE";if(w.envMap)switch(w.envMapMode){case Dn:case $n:o="ENVMAP_TYPE_CUBE";break;case Sn:o="ENVMAP_TYPE_CUBE_UV"}return o}(c),xe=function nr(w){let o="ENVMAP_MODE_REFLECTION";return w.envMap&&w.envMapMode===$n&&(o="ENVMAP_MODE_REFRACTION"),o}(c),Ie=function Xs(w){let o="ENVMAP_BLENDING_NONE";if(w.envMap)switch(w.combine){case Ne:o="ENVMAP_BLENDING_MULTIPLY";break;case rt:o="ENVMAP_BLENDING_MIX";break;case St:o="ENVMAP_BLENDING_ADD"}return o}(c),Be=function bs(w){const o=w.envMapCubeUVHeight;if(null===o)return null;const c=Math.log2(o)-2,h=1/o;return{texelWidth:1/(3*Math.max(Math.pow(2,c),112)),texelHeight:h,maxMip:c}}(c),Le=c.isWebGL2?"":function Xe(w){return[w.extensionDerivatives||w.envMapCubeUVHeight||w.bumpMap||w.normalMapTangentSpace||w.clearcoatNormalMap||w.flatShading||"physical"===w.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(w.extensionFragDepth||w.logarithmicDepthBuffer)&&w.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",w.extensionDrawBuffers&&w.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(w.extensionShaderTextureLOD||w.envMap||w.transmission)&&w.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Tt).join("\n")}(c),Ke=function ut(w){const o=[];for(const c in w){const h=w[c];!1!==h&&o.push("#define "+c+" "+h)}return o.join("\n")}(M),ft=m.createProgram();let We,ze,Mt=c.glslVersion?"#version "+c.glslVersion+"\n":"";c.isRawShaderMaterial?(We=["#define SHADER_TYPE "+c.shaderType,"#define SHADER_NAME "+c.shaderName,Ke].filter(Tt).join("\n"),We.length>0&&(We+="\n"),ze=[Le,"#define SHADER_TYPE "+c.shaderType,"#define SHADER_NAME "+c.shaderName,Ke].filter(Tt).join("\n"),ze.length>0&&(ze+="\n")):(We=[Ts(c),"#define SHADER_TYPE "+c.shaderType,"#define SHADER_NAME "+c.shaderName,Ke,c.instancing?"#define USE_INSTANCING":"",c.instancingColor?"#define USE_INSTANCING_COLOR":"",c.useFog&&c.fog?"#define USE_FOG":"",c.useFog&&c.fogExp2?"#define FOG_EXP2":"",c.map?"#define USE_MAP":"",c.envMap?"#define USE_ENVMAP":"",c.envMap?"#define "+xe:"",c.lightMap?"#define USE_LIGHTMAP":"",c.aoMap?"#define USE_AOMAP":"",c.bumpMap?"#define USE_BUMPMAP":"",c.normalMap?"#define USE_NORMALMAP":"",c.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",c.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",c.displacementMap?"#define USE_DISPLACEMENTMAP":"",c.emissiveMap?"#define USE_EMISSIVEMAP":"",c.anisotropy?"#define USE_ANISOTROPY":"",c.anisotropyMap?"#define USE_ANISOTROPYMAP":"",c.clearcoatMap?"#define USE_CLEARCOATMAP":"",c.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",c.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",c.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",c.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",c.specularMap?"#define USE_SPECULARMAP":"",c.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",c.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",c.roughnessMap?"#define USE_ROUGHNESSMAP":"",c.metalnessMap?"#define USE_METALNESSMAP":"",c.alphaMap?"#define USE_ALPHAMAP":"",c.alphaHash?"#define USE_ALPHAHASH":"",c.transmission?"#define USE_TRANSMISSION":"",c.transmissionMap?"#define USE_TRANSMISSIONMAP":"",c.thicknessMap?"#define USE_THICKNESSMAP":"",c.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",c.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",c.mapUv?"#define MAP_UV "+c.mapUv:"",c.alphaMapUv?"#define ALPHAMAP_UV "+c.alphaMapUv:"",c.lightMapUv?"#define LIGHTMAP_UV "+c.lightMapUv:"",c.aoMapUv?"#define AOMAP_UV "+c.aoMapUv:"",c.emissiveMapUv?"#define EMISSIVEMAP_UV "+c.emissiveMapUv:"",c.bumpMapUv?"#define BUMPMAP_UV "+c.bumpMapUv:"",c.normalMapUv?"#define NORMALMAP_UV "+c.normalMapUv:"",c.displacementMapUv?"#define DISPLACEMENTMAP_UV "+c.displacementMapUv:"",c.metalnessMapUv?"#define METALNESSMAP_UV "+c.metalnessMapUv:"",c.roughnessMapUv?"#define ROUGHNESSMAP_UV "+c.roughnessMapUv:"",c.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+c.anisotropyMapUv:"",c.clearcoatMapUv?"#define CLEARCOATMAP_UV "+c.clearcoatMapUv:"",c.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+c.clearcoatNormalMapUv:"",c.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+c.clearcoatRoughnessMapUv:"",c.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+c.iridescenceMapUv:"",c.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+c.iridescenceThicknessMapUv:"",c.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+c.sheenColorMapUv:"",c.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+c.sheenRoughnessMapUv:"",c.specularMapUv?"#define SPECULARMAP_UV "+c.specularMapUv:"",c.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+c.specularColorMapUv:"",c.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+c.specularIntensityMapUv:"",c.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+c.transmissionMapUv:"",c.thicknessMapUv?"#define THICKNESSMAP_UV "+c.thicknessMapUv:"",c.vertexTangents&&!1===c.flatShading?"#define USE_TANGENT":"",c.vertexColors?"#define USE_COLOR":"",c.vertexAlphas?"#define USE_COLOR_ALPHA":"",c.vertexUv1s?"#define USE_UV1":"",c.vertexUv2s?"#define USE_UV2":"",c.vertexUv3s?"#define USE_UV3":"",c.pointsUvs?"#define USE_POINTS_UV":"",c.flatShading?"#define FLAT_SHADED":"",c.skinning?"#define USE_SKINNING":"",c.morphTargets?"#define USE_MORPHTARGETS":"",c.morphNormals&&!1===c.flatShading?"#define USE_MORPHNORMALS":"",c.morphColors&&c.isWebGL2?"#define USE_MORPHCOLORS":"",c.morphTargetsCount>0&&c.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",c.morphTargetsCount>0&&c.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+c.morphTextureStride:"",c.morphTargetsCount>0&&c.isWebGL2?"#define MORPHTARGETS_COUNT "+c.morphTargetsCount:"",c.doubleSided?"#define DOUBLE_SIDED":"",c.flipSided?"#define FLIP_SIDED":"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapEnabled?"#define "+de:"",c.sizeAttenuation?"#define USE_SIZEATTENUATION":"",c.numLightProbes>0?"#define USE_LIGHT_PROBES":"",c.useLegacyLights?"#define LEGACY_LIGHTS":"",c.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",c.logarithmicDepthBuffer&&c.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Tt).join("\n"),ze=[Le,Ts(c),"#define SHADER_TYPE "+c.shaderType,"#define SHADER_NAME "+c.shaderName,Ke,c.useFog&&c.fog?"#define USE_FOG":"",c.useFog&&c.fogExp2?"#define FOG_EXP2":"",c.map?"#define USE_MAP":"",c.matcap?"#define USE_MATCAP":"",c.envMap?"#define USE_ENVMAP":"",c.envMap?"#define "+pe:"",c.envMap?"#define "+xe:"",c.envMap?"#define "+Ie:"",Be?"#define CUBEUV_TEXEL_WIDTH "+Be.texelWidth:"",Be?"#define CUBEUV_TEXEL_HEIGHT "+Be.texelHeight:"",Be?"#define CUBEUV_MAX_MIP "+Be.maxMip+".0":"",c.lightMap?"#define USE_LIGHTMAP":"",c.aoMap?"#define USE_AOMAP":"",c.bumpMap?"#define USE_BUMPMAP":"",c.normalMap?"#define USE_NORMALMAP":"",c.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",c.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",c.emissiveMap?"#define USE_EMISSIVEMAP":"",c.anisotropy?"#define USE_ANISOTROPY":"",c.anisotropyMap?"#define USE_ANISOTROPYMAP":"",c.clearcoat?"#define USE_CLEARCOAT":"",c.clearcoatMap?"#define USE_CLEARCOATMAP":"",c.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",c.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",c.iridescence?"#define USE_IRIDESCENCE":"",c.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",c.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",c.specularMap?"#define USE_SPECULARMAP":"",c.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",c.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",c.roughnessMap?"#define USE_ROUGHNESSMAP":"",c.metalnessMap?"#define USE_METALNESSMAP":"",c.alphaMap?"#define USE_ALPHAMAP":"",c.alphaTest?"#define USE_ALPHATEST":"",c.alphaHash?"#define USE_ALPHAHASH":"",c.sheen?"#define USE_SHEEN":"",c.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",c.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",c.transmission?"#define USE_TRANSMISSION":"",c.transmissionMap?"#define USE_TRANSMISSIONMAP":"",c.thicknessMap?"#define USE_THICKNESSMAP":"",c.vertexTangents&&!1===c.flatShading?"#define USE_TANGENT":"",c.vertexColors||c.instancingColor?"#define USE_COLOR":"",c.vertexAlphas?"#define USE_COLOR_ALPHA":"",c.vertexUv1s?"#define USE_UV1":"",c.vertexUv2s?"#define USE_UV2":"",c.vertexUv3s?"#define USE_UV3":"",c.pointsUvs?"#define USE_POINTS_UV":"",c.gradientMap?"#define USE_GRADIENTMAP":"",c.flatShading?"#define FLAT_SHADED":"",c.doubleSided?"#define DOUBLE_SIDED":"",c.flipSided?"#define FLIP_SIDED":"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapEnabled?"#define "+de:"",c.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",c.numLightProbes>0?"#define USE_LIGHT_PROBES":"",c.useLegacyLights?"#define LEGACY_LIGHTS":"",c.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",c.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",c.logarithmicDepthBuffer&&c.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",c.toneMapping!==pt?"#define TONE_MAPPING":"",c.toneMapping!==pt?Ko.tonemapping_pars_fragment:"",c.toneMapping!==pt?be("toneMapping",c.toneMapping):"",c.dithering?"#define DITHERING":"",c.opaque?"#define OPAQUE":"",Ko.colorspace_pars_fragment,Ae("linearToOutputTexel",c.outputColorSpace),c.useDepthPacking?"#define DEPTH_PACKING "+c.depthPacking:"","\n"].filter(Tt).join("\n")),N=Qn(N),N=Gt(N,c),N=Wt(N,c),q=Qn(q),q=Gt(q,c),q=Wt(q,c),N=pr(N),q=pr(q),c.isWebGL2&&!0!==c.isRawShaderMaterial&&(Mt="#version 300 es\n",We=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+We,ze=["precision mediump sampler2DArray;","#define varying in",c.glslVersion===H0?"":"layout(location = 0) out highp vec4 pc_fragColor;",c.glslVersion===H0?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+ze);const Dt=Mt+ze+q,Jt=q1(m,m.VERTEX_SHADER,Mt+We+N),cn=q1(m,m.FRAGMENT_SHADER,Dt);function rn(li){if(w.debug.checkShaderErrors){const Ti=m.getProgramInfoLog(ft).trim(),ur=m.getShaderInfoLog(Jt).trim(),Yn=m.getShaderInfoLog(cn).trim();let Di=!0,rr=!0;if(!1===m.getProgramParameter(ft,m.LINK_STATUS))if(Di=!1,"function"==typeof w.debug.onShaderError)w.debug.onShaderError(m,ft,Jt,cn);else{const Li=V(m,Jt,"vertex"),br=V(m,cn,"fragment");console.error("THREE.WebGLProgram: Shader Error "+m.getError()+" - VALIDATE_STATUS "+m.getProgramParameter(ft,m.VALIDATE_STATUS)+"\n\nProgram Info Log: "+Ti+"\n"+Li+"\n"+br)}else""!==Ti?console.warn("THREE.WebGLProgram: Program Info Log:",Ti):(""===ur||""===Yn)&&(rr=!1);rr&&(li.diagnostics={runnable:Di,programLog:Ti,vertexShader:{log:ur,prefix:We},fragmentShader:{log:Yn,prefix:ze}})}m.deleteShader(Jt),m.deleteShader(cn),Rn=new Jp(m,ft),kt=function _t(w,o){const c={},h=w.getProgramParameter(o,w.ACTIVE_ATTRIBUTES);for(let m=0;m<h;m++){const M=w.getActiveAttrib(o,m),N=M.name;let q=1;M.type===w.FLOAT_MAT2&&(q=2),M.type===w.FLOAT_MAT3&&(q=3),M.type===w.FLOAT_MAT4&&(q=4),c[N]={type:M.type,location:w.getAttribLocation(o,N),locationSize:q}}return c}(m,ft)}let Rn,kt;m.attachShader(ft,Jt),m.attachShader(ft,cn),void 0!==c.index0AttributeName?m.bindAttribLocation(ft,0,c.index0AttributeName):!0===c.morphTargets&&m.bindAttribLocation(ft,0,"position"),m.linkProgram(ft),this.getUniforms=function(){return void 0===Rn&&rn(this),Rn},this.getAttributes=function(){return void 0===kt&&rn(this),kt};let Zt=!1===c.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===Zt&&(Zt=m.getProgramParameter(ft,Sv)),Zt},this.destroy=function(){h.releaseStatesOfProgram(this),m.deleteProgram(ft),this.program=void 0},this.type=c.shaderType,this.name=c.shaderName,this.id=v_++,this.cacheKey=o,this.usedTimes=1,this.program=ft,this.vertexShader=Jt,this.fragmentShader=cn,this}let hl=0;class zc{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(o){const h=o.fragmentShader,m=this._getShaderStage(o.vertexShader),M=this._getShaderStage(h),N=this._getShaderCacheForMaterial(o);return!1===N.has(m)&&(N.add(m),m.usedTimes++),!1===N.has(M)&&(N.add(M),M.usedTimes++),this}remove(o){const c=this.materialCache.get(o);for(const h of c)h.usedTimes--,0===h.usedTimes&&this.shaderCache.delete(h.code);return this.materialCache.delete(o),this}getVertexShaderID(o){return this._getShaderStage(o.vertexShader).id}getFragmentShaderID(o){return this._getShaderStage(o.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(o){const c=this.materialCache;let h=c.get(o);return void 0===h&&(h=new Set,c.set(o,h)),h}_getShaderStage(o){const c=this.shaderCache;let h=c.get(o);return void 0===h&&(h=new dc(o),c.set(o,h)),h}}class dc{constructor(o){this.id=hl++,this.code=o,this.usedTimes=0}}function ao(w,o,c,h,m,M,N){const q=new so,de=new zc,pe=[],xe=m.isWebGL2,Ie=m.logarithmicDepthBuffer,Be=m.vertexTextures;let Le=m.precision;const Ke={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function ft(kt){return 0===kt?"uv":`uv${kt}`}return{getParameters:function We(kt,Zt,li,Ti,ur){const Yn=Ti.fog,Di=ur.geometry,Li=(kt.isMeshStandardMaterial?c:o).get(kt.envMap||(kt.isMeshStandardMaterial?Ti.environment:null)),br=Li&&Li.mapping===Sn?Li.image.height:null,Ji=Ke[kt.type];null!==kt.precision&&(Le=m.getMaxPrecision(kt.precision),Le!==kt.precision&&console.warn("THREE.WebGLProgram.getParameters:",kt.precision,"not supported, using",Le,"instead."));const lr=Di.morphAttributes.position||Di.morphAttributes.normal||Di.morphAttributes.color,ei=void 0!==lr?lr.length:0;let as,xs,Ds,fs,sr=0;if(void 0!==Di.morphAttributes.position&&(sr=1),void 0!==Di.morphAttributes.normal&&(sr=2),void 0!==Di.morphAttributes.color&&(sr=3),Ji){const id=Ah[Ji];as=id.vertexShader,xs=id.fragmentShader}else as=kt.vertexShader,xs=kt.fragmentShader,de.update(kt),Ds=de.getVertexShaderID(kt),fs=de.getFragmentShaderID(kt);const eo=w.getRenderTarget(),er=!0===ur.isInstancedMesh,Lr=!!kt.map,vr=!!Li,_n=!!kt.aoMap,Ki=!!kt.lightMap,si=!!kt.bumpMap,Ri=!!kt.normalMap,Ii=!!kt.displacementMap,es=!!kt.emissiveMap,Ur=!!kt.metalnessMap,fr=!!kt.roughnessMap,us=kt.anisotropy>0,co=kt.clearcoat>0,_s=kt.iridescence>0,$t=kt.sheen>0,Pt=kt.transmission>0,ni=us&&!!kt.anisotropyMap,cr=co&&!!kt.clearcoatMap,Ar=co&&!!kt.clearcoatNormalMap,Br=co&&!!kt.clearcoatRoughnessMap,ks=_s&&!!kt.iridescenceMap,Ir=_s&&!!kt.iridescenceThicknessMap,ts=$t&&!!kt.sheenColorMap,Nn=$t&&!!kt.sheenRoughnessMap,Vr=!!kt.specularMap,xr=!!kt.specularColorMap,Oo=!!kt.specularIntensityMap,Ao=Pt&&!!kt.transmissionMap,fo=Pt&&!!kt.thicknessMap,Ps=!!kt.alphaMap,ys=!!kt.extensions,jr=!!Di.attributes.uv1,dr=!!Di.attributes.uv2,ns=!!Di.attributes.uv3;let xo=pt;return kt.toneMapped&&(null===eo||!0===eo.isXRRenderTarget)&&(xo=w.toneMapping),{isWebGL2:xe,shaderID:Ji,shaderType:kt.type,shaderName:kt.name,vertexShader:as,fragmentShader:xs,defines:kt.defines,customVertexShaderID:Ds,customFragmentShaderID:fs,isRawShaderMaterial:!0===kt.isRawShaderMaterial,glslVersion:kt.glslVersion,precision:Le,instancing:er,instancingColor:er&&null!==ur.instanceColor,supportsVertexTextures:Be,outputColorSpace:null===eo?w.outputColorSpace:!0===eo.isXRRenderTarget?eo.texture.colorSpace:sc,map:Lr,matcap:!!kt.matcap,envMap:vr,envMapMode:vr&&Li.mapping,envMapCubeUVHeight:br,aoMap:_n,lightMap:Ki,bumpMap:si,normalMap:Ri,displacementMap:Be&&Ii,emissiveMap:es,normalMapObjectSpace:Ri&&1===kt.normalMapType,normalMapTangentSpace:Ri&&0===kt.normalMapType,metalnessMap:Ur,roughnessMap:fr,anisotropy:us,anisotropyMap:ni,clearcoat:co,clearcoatMap:cr,clearcoatNormalMap:Ar,clearcoatRoughnessMap:Br,iridescence:_s,iridescenceMap:ks,iridescenceThicknessMap:Ir,sheen:$t,sheenColorMap:ts,sheenRoughnessMap:Nn,specularMap:Vr,specularColorMap:xr,specularIntensityMap:Oo,transmission:Pt,transmissionMap:Ao,thicknessMap:fo,gradientMap:!!kt.gradientMap,opaque:!1===kt.transparent&&1===kt.blending,alphaMap:Ps,alphaTest:kt.alphaTest>0,alphaHash:!!kt.alphaHash,combine:kt.combine,mapUv:Lr&&ft(kt.map.channel),aoMapUv:_n&&ft(kt.aoMap.channel),lightMapUv:Ki&&ft(kt.lightMap.channel),bumpMapUv:si&&ft(kt.bumpMap.channel),normalMapUv:Ri&&ft(kt.normalMap.channel),displacementMapUv:Ii&&ft(kt.displacementMap.channel),emissiveMapUv:es&&ft(kt.emissiveMap.channel),metalnessMapUv:Ur&&ft(kt.metalnessMap.channel),roughnessMapUv:fr&&ft(kt.roughnessMap.channel),anisotropyMapUv:ni&&ft(kt.anisotropyMap.channel),clearcoatMapUv:cr&&ft(kt.clearcoatMap.channel),clearcoatNormalMapUv:Ar&&ft(kt.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Br&&ft(kt.clearcoatRoughnessMap.channel),iridescenceMapUv:ks&&ft(kt.iridescenceMap.channel),iridescenceThicknessMapUv:Ir&&ft(kt.iridescenceThicknessMap.channel),sheenColorMapUv:ts&&ft(kt.sheenColorMap.channel),sheenRoughnessMapUv:Nn&&ft(kt.sheenRoughnessMap.channel),specularMapUv:Vr&&ft(kt.specularMap.channel),specularColorMapUv:xr&&ft(kt.specularColorMap.channel),specularIntensityMapUv:Oo&&ft(kt.specularIntensityMap.channel),transmissionMapUv:Ao&&ft(kt.transmissionMap.channel),thicknessMapUv:fo&&ft(kt.thicknessMap.channel),alphaMapUv:Ps&&ft(kt.alphaMap.channel),vertexTangents:!!Di.attributes.tangent&&(Ri||us),vertexColors:kt.vertexColors,vertexAlphas:!0===kt.vertexColors&&!!Di.attributes.color&&4===Di.attributes.color.itemSize,vertexUv1s:jr,vertexUv2s:dr,vertexUv3s:ns,pointsUvs:!0===ur.isPoints&&!!Di.attributes.uv&&(Lr||Ps),fog:!!Yn,useFog:!0===kt.fog,fogExp2:Yn&&Yn.isFogExp2,flatShading:!0===kt.flatShading,sizeAttenuation:!0===kt.sizeAttenuation,logarithmicDepthBuffer:Ie,skinning:!0===ur.isSkinnedMesh,morphTargets:void 0!==Di.morphAttributes.position,morphNormals:void 0!==Di.morphAttributes.normal,morphColors:void 0!==Di.morphAttributes.color,morphTargetsCount:ei,morphTextureStride:sr,numDirLights:Zt.directional.length,numPointLights:Zt.point.length,numSpotLights:Zt.spot.length,numSpotLightMaps:Zt.spotLightMap.length,numRectAreaLights:Zt.rectArea.length,numHemiLights:Zt.hemi.length,numDirLightShadows:Zt.directionalShadowMap.length,numPointLightShadows:Zt.pointShadowMap.length,numSpotLightShadows:Zt.spotShadowMap.length,numSpotLightShadowsWithMaps:Zt.numSpotLightShadowsWithMaps,numLightProbes:Zt.numLightProbes,numClippingPlanes:N.numPlanes,numClipIntersection:N.numIntersection,dithering:kt.dithering,shadowMapEnabled:w.shadowMap.enabled&&li.length>0,shadowMapType:w.shadowMap.type,toneMapping:xo,useLegacyLights:w._useLegacyLights,decodeVideoTexture:Lr&&!0===kt.map.isVideoTexture&&Ya.getTransfer(kt.map.colorSpace)===$o,premultipliedAlpha:kt.premultipliedAlpha,doubleSided:kt.side===Y,flipSided:1===kt.side,useDepthPacking:kt.depthPacking>=0,depthPacking:kt.depthPacking||0,index0AttributeName:kt.index0AttributeName,extensionDerivatives:ys&&!0===kt.extensions.derivatives,extensionFragDepth:ys&&!0===kt.extensions.fragDepth,extensionDrawBuffers:ys&&!0===kt.extensions.drawBuffers,extensionShaderTextureLOD:ys&&!0===kt.extensions.shaderTextureLOD,rendererExtensionFragDepth:xe||h.has("EXT_frag_depth"),rendererExtensionDrawBuffers:xe||h.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:xe||h.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:h.has("KHR_parallel_shader_compile"),customProgramCacheKey:kt.customProgramCacheKey()}},getProgramCacheKey:function ze(kt){const Zt=[];if(kt.shaderID?Zt.push(kt.shaderID):(Zt.push(kt.customVertexShaderID),Zt.push(kt.customFragmentShaderID)),void 0!==kt.defines)for(const li in kt.defines)Zt.push(li),Zt.push(kt.defines[li]);return!1===kt.isRawShaderMaterial&&(function Mt(kt,Zt){kt.push(Zt.precision),kt.push(Zt.outputColorSpace),kt.push(Zt.envMapMode),kt.push(Zt.envMapCubeUVHeight),kt.push(Zt.mapUv),kt.push(Zt.alphaMapUv),kt.push(Zt.lightMapUv),kt.push(Zt.aoMapUv),kt.push(Zt.bumpMapUv),kt.push(Zt.normalMapUv),kt.push(Zt.displacementMapUv),kt.push(Zt.emissiveMapUv),kt.push(Zt.metalnessMapUv),kt.push(Zt.roughnessMapUv),kt.push(Zt.anisotropyMapUv),kt.push(Zt.clearcoatMapUv),kt.push(Zt.clearcoatNormalMapUv),kt.push(Zt.clearcoatRoughnessMapUv),kt.push(Zt.iridescenceMapUv),kt.push(Zt.iridescenceThicknessMapUv),kt.push(Zt.sheenColorMapUv),kt.push(Zt.sheenRoughnessMapUv),kt.push(Zt.specularMapUv),kt.push(Zt.specularColorMapUv),kt.push(Zt.specularIntensityMapUv),kt.push(Zt.transmissionMapUv),kt.push(Zt.thicknessMapUv),kt.push(Zt.combine),kt.push(Zt.fogExp2),kt.push(Zt.sizeAttenuation),kt.push(Zt.morphTargetsCount),kt.push(Zt.morphAttributeCount),kt.push(Zt.numDirLights),kt.push(Zt.numPointLights),kt.push(Zt.numSpotLights),kt.push(Zt.numSpotLightMaps),kt.push(Zt.numHemiLights),kt.push(Zt.numRectAreaLights),kt.push(Zt.numDirLightShadows),kt.push(Zt.numPointLightShadows),kt.push(Zt.numSpotLightShadows),kt.push(Zt.numSpotLightShadowsWithMaps),kt.push(Zt.numLightProbes),kt.push(Zt.shadowMapType),kt.push(Zt.toneMapping),kt.push(Zt.numClippingPlanes),kt.push(Zt.numClipIntersection),kt.push(Zt.depthPacking)}(Zt,kt),function ct(kt,Zt){q.disableAll(),Zt.isWebGL2&&q.enable(0),Zt.supportsVertexTextures&&q.enable(1),Zt.instancing&&q.enable(2),Zt.instancingColor&&q.enable(3),Zt.matcap&&q.enable(4),Zt.envMap&&q.enable(5),Zt.normalMapObjectSpace&&q.enable(6),Zt.normalMapTangentSpace&&q.enable(7),Zt.clearcoat&&q.enable(8),Zt.iridescence&&q.enable(9),Zt.alphaTest&&q.enable(10),Zt.vertexColors&&q.enable(11),Zt.vertexAlphas&&q.enable(12),Zt.vertexUv1s&&q.enable(13),Zt.vertexUv2s&&q.enable(14),Zt.vertexUv3s&&q.enable(15),Zt.vertexTangents&&q.enable(16),Zt.anisotropy&&q.enable(17),Zt.alphaHash&&q.enable(18),kt.push(q.mask),q.disableAll(),Zt.fog&&q.enable(0),Zt.useFog&&q.enable(1),Zt.flatShading&&q.enable(2),Zt.logarithmicDepthBuffer&&q.enable(3),Zt.skinning&&q.enable(4),Zt.morphTargets&&q.enable(5),Zt.morphNormals&&q.enable(6),Zt.morphColors&&q.enable(7),Zt.premultipliedAlpha&&q.enable(8),Zt.shadowMapEnabled&&q.enable(9),Zt.useLegacyLights&&q.enable(10),Zt.doubleSided&&q.enable(11),Zt.flipSided&&q.enable(12),Zt.useDepthPacking&&q.enable(13),Zt.dithering&&q.enable(14),Zt.transmission&&q.enable(15),Zt.sheen&&q.enable(16),Zt.opaque&&q.enable(17),Zt.pointsUvs&&q.enable(18),Zt.decodeVideoTexture&&q.enable(19),kt.push(q.mask)}(Zt,kt),Zt.push(w.outputColorSpace)),Zt.push(kt.customProgramCacheKey),Zt.join()},getUniforms:function Dt(kt){const Zt=Ke[kt.type];let li;return li=Zt?dl.clone(Ah[Zt].uniforms):kt.uniforms,li},acquireProgram:function Jt(kt,Zt){let li;for(let Ti=0,ur=pe.length;Ti<ur;Ti++){const Yn=pe[Ti];if(Yn.cacheKey===Zt){li=Yn,++li.usedTimes;break}}return void 0===li&&(li=new Go(w,Zt,kt,M),pe.push(li)),li},releaseProgram:function cn(kt){if(0==--kt.usedTimes){const Zt=pe.indexOf(kt);pe[Zt]=pe[pe.length-1],pe.pop(),kt.destroy()}},releaseShaderCache:function rn(kt){de.remove(kt)},programs:pe,dispose:function Rn(){de.dispose()}}}function wl(){let w=new WeakMap;return{get:function o(M){let N=w.get(M);return void 0===N&&(N={},w.set(M,N)),N},remove:function c(M){w.delete(M)},update:function h(M,N,q){w.get(M)[N]=q},dispose:function m(){w=new WeakMap}}}function Js(w,o){return w.groupOrder!==o.groupOrder?w.groupOrder-o.groupOrder:w.renderOrder!==o.renderOrder?w.renderOrder-o.renderOrder:w.material.id!==o.material.id?w.material.id-o.material.id:w.z!==o.z?w.z-o.z:w.id-o.id}function Zo(w,o){return w.groupOrder!==o.groupOrder?w.groupOrder-o.groupOrder:w.renderOrder!==o.renderOrder?w.renderOrder-o.renderOrder:w.z!==o.z?o.z-w.z:w.id-o.id}function nu(){const w=[];let o=0;const c=[],h=[],m=[];function N(Ie,Be,Le,Ke,ft,We){let ze=w[o];return void 0===ze?(ze={id:Ie.id,object:Ie,geometry:Be,material:Le,groupOrder:Ke,renderOrder:Ie.renderOrder,z:ft,group:We},w[o]=ze):(ze.id=Ie.id,ze.object=Ie,ze.geometry=Be,ze.material=Le,ze.groupOrder=Ke,ze.renderOrder=Ie.renderOrder,ze.z=ft,ze.group=We),o++,ze}return{opaque:c,transmissive:h,transparent:m,init:function M(){o=0,c.length=0,h.length=0,m.length=0},push:function q(Ie,Be,Le,Ke,ft,We){const ze=N(Ie,Be,Le,Ke,ft,We);Le.transmission>0?h.push(ze):!0===Le.transparent?m.push(ze):c.push(ze)},unshift:function de(Ie,Be,Le,Ke,ft,We){const ze=N(Ie,Be,Le,Ke,ft,We);Le.transmission>0?h.unshift(ze):!0===Le.transparent?m.unshift(ze):c.unshift(ze)},finish:function xe(){for(let Ie=o,Be=w.length;Ie<Be;Ie++){const Le=w[Ie];if(null===Le.id)break;Le.id=null,Le.object=null,Le.geometry=null,Le.material=null,Le.group=null}},sort:function pe(Ie,Be){c.length>1&&c.sort(Ie||Js),h.length>1&&h.sort(Be||Zo),m.length>1&&m.sort(Be||Zo)}}}function iu(){let w=new WeakMap;return{get:function o(h,m){const M=w.get(h);let N;return void 0===M?(N=new nu,w.set(h,[N])):m>=M.length?(N=new nu,M.push(N)):N=M[m],N},dispose:function c(){w=new WeakMap}}}function td(){const w={};return{get:function(o){if(void 0!==w[o.id])return w[o.id];let c;switch(o.type){case"DirectionalLight":c={direction:new Ft,color:new Os};break;case"SpotLight":c={position:new Ft,direction:new Ft,color:new Os,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":c={position:new Ft,color:new Os,distance:0,decay:0};break;case"HemisphereLight":c={direction:new Ft,skyColor:new Os,groundColor:new Os};break;case"RectAreaLight":c={color:new Os,position:new Ft,halfWidth:new Ft,halfHeight:new Ft}}return w[o.id]=c,c}}}let Jl=0;function cp(w,o){return(o.castShadow?2:0)-(w.castShadow?2:0)+(o.map?1:0)-(w.map?1:0)}function o0(w,o){const c=new td,h=function Ld(){const w={};return{get:function(o){if(void 0!==w[o.id])return w[o.id];let c;switch(o.type){case"DirectionalLight":case"SpotLight":c={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new zi};break;case"PointLight":c={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new zi,shadowCameraNear:1,shadowCameraFar:1e3}}return w[o.id]=c,c}}}(),m={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let xe=0;xe<9;xe++)m.probe.push(new Ft);const M=new Ft,N=new bo,q=new bo;return{setup:function de(xe,Ie){let Be=0,Le=0,Ke=0;for(let Ti=0;Ti<9;Ti++)m.probe[Ti].set(0,0,0);let ft=0,We=0,ze=0,Mt=0,ct=0,Dt=0,Jt=0,cn=0,rn=0,Rn=0,kt=0;xe.sort(cp);const Zt=!0===Ie?Math.PI:1;for(let Ti=0,ur=xe.length;Ti<ur;Ti++){const Yn=xe[Ti],Di=Yn.color,rr=Yn.intensity,Li=Yn.distance,br=Yn.shadow&&Yn.shadow.map?Yn.shadow.map.texture:null;if(Yn.isAmbientLight)Be+=Di.r*rr*Zt,Le+=Di.g*rr*Zt,Ke+=Di.b*rr*Zt;else if(Yn.isLightProbe){for(let Ji=0;Ji<9;Ji++)m.probe[Ji].addScaledVector(Yn.sh.coefficients[Ji],rr);kt++}else if(Yn.isDirectionalLight){const Ji=c.get(Yn);if(Ji.color.copy(Yn.color).multiplyScalar(Yn.intensity*Zt),Yn.castShadow){const lr=Yn.shadow,ei=h.get(Yn);ei.shadowBias=lr.bias,ei.shadowNormalBias=lr.normalBias,ei.shadowRadius=lr.radius,ei.shadowMapSize=lr.mapSize,m.directionalShadow[ft]=ei,m.directionalShadowMap[ft]=br,m.directionalShadowMatrix[ft]=Yn.shadow.matrix,Dt++}m.directional[ft]=Ji,ft++}else if(Yn.isSpotLight){const Ji=c.get(Yn);Ji.position.setFromMatrixPosition(Yn.matrixWorld),Ji.color.copy(Di).multiplyScalar(rr*Zt),Ji.distance=Li,Ji.coneCos=Math.cos(Yn.angle),Ji.penumbraCos=Math.cos(Yn.angle*(1-Yn.penumbra)),Ji.decay=Yn.decay,m.spot[ze]=Ji;const lr=Yn.shadow;if(Yn.map&&(m.spotLightMap[rn]=Yn.map,rn++,lr.updateMatrices(Yn),Yn.castShadow&&Rn++),m.spotLightMatrix[ze]=lr.matrix,Yn.castShadow){const ei=h.get(Yn);ei.shadowBias=lr.bias,ei.shadowNormalBias=lr.normalBias,ei.shadowRadius=lr.radius,ei.shadowMapSize=lr.mapSize,m.spotShadow[ze]=ei,m.spotShadowMap[ze]=br,cn++}ze++}else if(Yn.isRectAreaLight){const Ji=c.get(Yn);Ji.color.copy(Di).multiplyScalar(rr),Ji.halfWidth.set(.5*Yn.width,0,0),Ji.halfHeight.set(0,.5*Yn.height,0),m.rectArea[Mt]=Ji,Mt++}else if(Yn.isPointLight){const Ji=c.get(Yn);if(Ji.color.copy(Yn.color).multiplyScalar(Yn.intensity*Zt),Ji.distance=Yn.distance,Ji.decay=Yn.decay,Yn.castShadow){const lr=Yn.shadow,ei=h.get(Yn);ei.shadowBias=lr.bias,ei.shadowNormalBias=lr.normalBias,ei.shadowRadius=lr.radius,ei.shadowMapSize=lr.mapSize,ei.shadowCameraNear=lr.camera.near,ei.shadowCameraFar=lr.camera.far,m.pointShadow[We]=ei,m.pointShadowMap[We]=br,m.pointShadowMatrix[We]=Yn.shadow.matrix,Jt++}m.point[We]=Ji,We++}else if(Yn.isHemisphereLight){const Ji=c.get(Yn);Ji.skyColor.copy(Yn.color).multiplyScalar(rr*Zt),Ji.groundColor.copy(Yn.groundColor).multiplyScalar(rr*Zt),m.hemi[ct]=Ji,ct++}}Mt>0&&(o.isWebGL2||!0===w.has("OES_texture_float_linear")?(m.rectAreaLTC1=ds.LTC_FLOAT_1,m.rectAreaLTC2=ds.LTC_FLOAT_2):!0===w.has("OES_texture_half_float_linear")?(m.rectAreaLTC1=ds.LTC_HALF_1,m.rectAreaLTC2=ds.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),m.ambient[0]=Be,m.ambient[1]=Le,m.ambient[2]=Ke;const li=m.hash;(li.directionalLength!==ft||li.pointLength!==We||li.spotLength!==ze||li.rectAreaLength!==Mt||li.hemiLength!==ct||li.numDirectionalShadows!==Dt||li.numPointShadows!==Jt||li.numSpotShadows!==cn||li.numSpotMaps!==rn||li.numLightProbes!==kt)&&(m.directional.length=ft,m.spot.length=ze,m.rectArea.length=Mt,m.point.length=We,m.hemi.length=ct,m.directionalShadow.length=Dt,m.directionalShadowMap.length=Dt,m.pointShadow.length=Jt,m.pointShadowMap.length=Jt,m.spotShadow.length=cn,m.spotShadowMap.length=cn,m.directionalShadowMatrix.length=Dt,m.pointShadowMatrix.length=Jt,m.spotLightMatrix.length=cn+rn-Rn,m.spotLightMap.length=rn,m.numSpotLightShadowsWithMaps=Rn,m.numLightProbes=kt,li.directionalLength=ft,li.pointLength=We,li.spotLength=ze,li.rectAreaLength=Mt,li.hemiLength=ct,li.numDirectionalShadows=Dt,li.numPointShadows=Jt,li.numSpotShadows=cn,li.numSpotMaps=rn,li.numLightProbes=kt,m.version=Jl++)},setupView:function pe(xe,Ie){let Be=0,Le=0,Ke=0,ft=0,We=0;const ze=Ie.matrixWorldInverse;for(let Mt=0,ct=xe.length;Mt<ct;Mt++){const Dt=xe[Mt];if(Dt.isDirectionalLight){const Jt=m.directional[Be];Jt.direction.setFromMatrixPosition(Dt.matrixWorld),M.setFromMatrixPosition(Dt.target.matrixWorld),Jt.direction.sub(M),Jt.direction.transformDirection(ze),Be++}else if(Dt.isSpotLight){const Jt=m.spot[Ke];Jt.position.setFromMatrixPosition(Dt.matrixWorld),Jt.position.applyMatrix4(ze),Jt.direction.setFromMatrixPosition(Dt.matrixWorld),M.setFromMatrixPosition(Dt.target.matrixWorld),Jt.direction.sub(M),Jt.direction.transformDirection(ze),Ke++}else if(Dt.isRectAreaLight){const Jt=m.rectArea[ft];Jt.position.setFromMatrixPosition(Dt.matrixWorld),Jt.position.applyMatrix4(ze),q.identity(),N.copy(Dt.matrixWorld),N.premultiply(ze),q.extractRotation(N),Jt.halfWidth.set(.5*Dt.width,0,0),Jt.halfHeight.set(0,.5*Dt.height,0),Jt.halfWidth.applyMatrix4(q),Jt.halfHeight.applyMatrix4(q),ft++}else if(Dt.isPointLight){const Jt=m.point[Le];Jt.position.setFromMatrixPosition(Dt.matrixWorld),Jt.position.applyMatrix4(ze),Le++}else if(Dt.isHemisphereLight){const Jt=m.hemi[We];Jt.direction.setFromMatrixPosition(Dt.matrixWorld),Jt.direction.transformDirection(ze),We++}}},state:m}}function a0(w,o){const c=new o0(w,o),h=[],m=[];return{init:function M(){h.length=0,m.length=0},state:{lightsArray:h,shadowsArray:m,lights:c},setupLights:function de(Ie){c.setup(h,Ie)},setupLightsView:function pe(Ie){c.setupView(h,Ie)},pushLight:function N(Ie){h.push(Ie)},pushShadow:function q(Ie){m.push(Ie)}}}function Xm(w,o){let c=new WeakMap;return{get:function h(M,N=0){const q=c.get(M);let de;return void 0===q?(de=new a0(w,o),c.set(M,[de])):N>=q.length?(de=new a0(w,o),q.push(de)):de=q[N],de},dispose:function m(){c=new WeakMap}}}class em extends kc{constructor(o){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(o)}copy(o){return super.copy(o),this.depthPacking=o.depthPacking,this.map=o.map,this.alphaMap=o.alphaMap,this.displacementMap=o.displacementMap,this.displacementScale=o.displacementScale,this.displacementBias=o.displacementBias,this.wireframe=o.wireframe,this.wireframeLinewidth=o.wireframeLinewidth,this}}class _h extends kc{constructor(o){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(o)}copy(o){return super.copy(o),this.map=o.map,this.alphaMap=o.alphaMap,this.displacementMap=o.displacementMap,this.displacementScale=o.displacementScale,this.displacementBias=o.displacementBias,this}}function xf(w,o,c){let h=new Jh;const m=new zi,M=new zi,N=new il,q=new em({depthPacking:3201}),de=new _h,pe={},xe=c.maxTextureSize,Ie={[F]:1,1:F,[Y]:Y},Be=new zl({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new zi},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),Le=Be.clone();Le.defines.HORIZONTAL_PASS=1;const Ke=new Cs;Ke.setAttribute("position",new sa(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const ft=new Jc(Ke,Be),We=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=He;let ze=this.type;function Mt(Jt,cn){const rn=o.update(ft);Be.defines.VSM_SAMPLES!==Jt.blurSamples&&(Be.defines.VSM_SAMPLES=Jt.blurSamples,Le.defines.VSM_SAMPLES=Jt.blurSamples,Be.needsUpdate=!0,Le.needsUpdate=!0),null===Jt.mapPass&&(Jt.mapPass=new Ou(m.x,m.y)),Be.uniforms.shadow_pass.value=Jt.map.texture,Be.uniforms.resolution.value=Jt.mapSize,Be.uniforms.radius.value=Jt.radius,w.setRenderTarget(Jt.mapPass),w.clear(),w.renderBufferDirect(cn,null,rn,Be,ft,null),Le.uniforms.shadow_pass.value=Jt.mapPass.texture,Le.uniforms.resolution.value=Jt.mapSize,Le.uniforms.radius.value=Jt.radius,w.setRenderTarget(Jt.map),w.clear(),w.renderBufferDirect(cn,null,rn,Le,ft,null)}function ct(Jt,cn,rn,Rn){let kt=null;const Zt=!0===rn.isPointLight?Jt.customDistanceMaterial:Jt.customDepthMaterial;if(void 0!==Zt)kt=Zt;else if(kt=!0===rn.isPointLight?de:q,w.localClippingEnabled&&!0===cn.clipShadows&&Array.isArray(cn.clippingPlanes)&&0!==cn.clippingPlanes.length||cn.displacementMap&&0!==cn.displacementScale||cn.alphaMap&&cn.alphaTest>0||cn.map&&cn.alphaTest>0){const li=kt.uuid,Ti=cn.uuid;let ur=pe[li];void 0===ur&&(ur={},pe[li]=ur);let Yn=ur[Ti];void 0===Yn&&(Yn=kt.clone(),ur[Ti]=Yn),kt=Yn}return kt.visible=cn.visible,kt.wireframe=cn.wireframe,kt.side=Rn===De?null!==cn.shadowSide?cn.shadowSide:cn.side:null!==cn.shadowSide?cn.shadowSide:Ie[cn.side],kt.alphaMap=cn.alphaMap,kt.alphaTest=cn.alphaTest,kt.map=cn.map,kt.clipShadows=cn.clipShadows,kt.clippingPlanes=cn.clippingPlanes,kt.clipIntersection=cn.clipIntersection,kt.displacementMap=cn.displacementMap,kt.displacementScale=cn.displacementScale,kt.displacementBias=cn.displacementBias,kt.wireframeLinewidth=cn.wireframeLinewidth,kt.linewidth=cn.linewidth,!0===rn.isPointLight&&!0===kt.isMeshDistanceMaterial&&(w.properties.get(kt).light=rn),kt}function Dt(Jt,cn,rn,Rn,kt){if(!1===Jt.visible)return;if(Jt.layers.test(cn.layers)&&(Jt.isMesh||Jt.isLine||Jt.isPoints)&&(Jt.castShadow||Jt.receiveShadow&&kt===De)&&(!Jt.frustumCulled||h.intersectsObject(Jt))){Jt.modelViewMatrix.multiplyMatrices(rn.matrixWorldInverse,Jt.matrixWorld);const Ti=o.update(Jt),ur=Jt.material;if(Array.isArray(ur)){const Yn=Ti.groups;for(let Di=0,rr=Yn.length;Di<rr;Di++){const Li=Yn[Di],br=ur[Li.materialIndex];if(br&&br.visible){const Ji=ct(Jt,br,Rn,kt);w.renderBufferDirect(rn,null,Ti,Ji,Jt,Li)}}}else if(ur.visible){const Yn=ct(Jt,ur,Rn,kt);w.renderBufferDirect(rn,null,Ti,Yn,Jt,null)}}const li=Jt.children;for(let Ti=0,ur=li.length;Ti<ur;Ti++)Dt(li[Ti],cn,rn,Rn,kt)}this.render=function(Jt,cn,rn){if(!1===We.enabled||!1===We.autoUpdate&&!1===We.needsUpdate||0===Jt.length)return;const Rn=w.getRenderTarget(),kt=w.getActiveCubeFace(),Zt=w.getActiveMipmapLevel(),li=w.state;li.setBlending(0),li.buffers.color.setClear(1,1,1,1),li.buffers.depth.setTest(!0),li.setScissorTest(!1);const Ti=ze!==De&&this.type===De,ur=ze===De&&this.type!==De;for(let Yn=0,Di=Jt.length;Yn<Di;Yn++){const rr=Jt[Yn],Li=rr.shadow;if(void 0===Li){console.warn("THREE.WebGLShadowMap:",rr,"has no shadow.");continue}if(!1===Li.autoUpdate&&!1===Li.needsUpdate)continue;m.copy(Li.mapSize);const br=Li.getFrameExtents();if(m.multiply(br),M.copy(Li.mapSize),(m.x>xe||m.y>xe)&&(m.x>xe&&(M.x=Math.floor(xe/br.x),m.x=M.x*br.x,Li.mapSize.x=M.x),m.y>xe&&(M.y=Math.floor(xe/br.y),m.y=M.y*br.y,Li.mapSize.y=M.y)),null===Li.map||!0===Ti||!0===ur){const lr=this.type!==De?{minFilter:ti,magFilter:ti}:{};null!==Li.map&&Li.map.dispose(),Li.map=new Ou(m.x,m.y,lr),Li.map.texture.name=rr.name+".shadowMap",Li.camera.updateProjectionMatrix()}w.setRenderTarget(Li.map),w.clear();const Ji=Li.getViewportCount();for(let lr=0;lr<Ji;lr++){const ei=Li.getViewport(lr);N.set(M.x*ei.x,M.y*ei.y,M.x*ei.z,M.y*ei.w),li.viewport(N),Li.updateMatrices(rr,lr),h=Li.getFrustum(),Dt(cn,rn,Li.camera,rr,this.type)}!0!==Li.isPointLightShadow&&this.type===De&&Mt(Li,rn),Li.needsUpdate=!1}ze=this.type,We.needsUpdate=!1,w.setRenderTarget(Rn,kt,Zt)}}function Qs(w,o,c){const h=c.isWebGL2,q=new function m(){let Kn=!1;const ys=new il;let jr=null;const dr=new il(0,0,0,0);return{setMask:function(ns){jr!==ns&&!Kn&&(w.colorMask(ns,ns,ns,ns),jr=ns)},setLocked:function(ns){Kn=ns},setClear:function(ns,xo,Na,id,wf){!0===wf&&(ns*=id,xo*=id,Na*=id),ys.set(ns,xo,Na,id),!1===dr.equals(ys)&&(w.clearColor(ns,xo,Na,id),dr.copy(ys))},reset:function(){Kn=!1,jr=null,dr.set(-1,0,0,0)}}},de=new function M(){let Kn=!1,ys=null,jr=null,dr=null;return{setTest:function(ns){ns?Lr(w.DEPTH_TEST):yr(w.DEPTH_TEST)},setMask:function(ns){ys!==ns&&!Kn&&(w.depthMask(ns),ys=ns)},setFunc:function(ns){if(jr!==ns){switch(ns){case 0:w.depthFunc(w.NEVER);break;case 1:w.depthFunc(w.ALWAYS);break;case 2:w.depthFunc(w.LESS);break;case 3:default:w.depthFunc(w.LEQUAL);break;case 4:w.depthFunc(w.EQUAL);break;case 5:w.depthFunc(w.GEQUAL);break;case 6:w.depthFunc(w.GREATER);break;case 7:w.depthFunc(w.NOTEQUAL)}jr=ns}},setLocked:function(ns){Kn=ns},setClear:function(ns){dr!==ns&&(w.clearDepth(ns),dr=ns)},reset:function(){Kn=!1,ys=null,jr=null,dr=null}}},pe=new function N(){let Kn=!1,ys=null,jr=null,dr=null,ns=null,xo=null,Na=null,id=null,wf=null;return{setTest:function(Gl){Kn||(Gl?Lr(w.STENCIL_TEST):yr(w.STENCIL_TEST))},setMask:function(Gl){ys!==Gl&&!Kn&&(w.stencilMask(Gl),ys=Gl)},setFunc:function(Gl,qu,Zm){(jr!==Gl||dr!==qu||ns!==Zm)&&(w.stencilFunc(Gl,qu,Zm),jr=Gl,dr=qu,ns=Zm)},setOp:function(Gl,qu,Zm){(xo!==Gl||Na!==qu||id!==Zm)&&(w.stencilOp(Gl,qu,Zm),xo=Gl,Na=qu,id=Zm)},setLocked:function(Gl){Kn=Gl},setClear:function(Gl){wf!==Gl&&(w.clearStencil(Gl),wf=Gl)},reset:function(){Kn=!1,ys=null,jr=null,dr=null,ns=null,xo=null,Na=null,id=null,wf=null}}},xe=new WeakMap,Ie=new WeakMap;let Be={},Le={},Ke=new WeakMap,ft=[],We=null,ze=!1,Mt=null,ct=null,Dt=null,Jt=null,cn=null,rn=null,Rn=null,kt=new Os(0,0,0),Zt=0,li=!1,Ti=null,ur=null,Yn=null,Di=null,rr=null;const Li=w.getParameter(w.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let br=!1,Ji=0;const lr=w.getParameter(w.VERSION);-1!==lr.indexOf("WebGL")?(Ji=parseFloat(/^WebGL (\d)/.exec(lr)[1]),br=Ji>=1):-1!==lr.indexOf("OpenGL ES")&&(Ji=parseFloat(/^OpenGL ES (\d)/.exec(lr)[1]),br=Ji>=2);let ei=null,sr={};const as=w.getParameter(w.SCISSOR_BOX),xs=w.getParameter(w.VIEWPORT),Ds=(new il).fromArray(as),fs=(new il).fromArray(xs);function eo(Kn,ys,jr,dr){const ns=new Uint8Array(4),xo=w.createTexture();w.bindTexture(Kn,xo),w.texParameteri(Kn,w.TEXTURE_MIN_FILTER,w.NEAREST),w.texParameteri(Kn,w.TEXTURE_MAG_FILTER,w.NEAREST);for(let Na=0;Na<jr;Na++)!h||Kn!==w.TEXTURE_3D&&Kn!==w.TEXTURE_2D_ARRAY?w.texImage2D(ys+Na,0,w.RGBA,1,1,0,w.RGBA,w.UNSIGNED_BYTE,ns):w.texImage3D(ys,0,w.RGBA,1,1,dr,0,w.RGBA,w.UNSIGNED_BYTE,ns);return xo}const er={};function Lr(Kn){!0!==Be[Kn]&&(w.enable(Kn),Be[Kn]=!0)}function yr(Kn){!1!==Be[Kn]&&(w.disable(Kn),Be[Kn]=!1)}er[w.TEXTURE_2D]=eo(w.TEXTURE_2D,w.TEXTURE_2D,1),er[w.TEXTURE_CUBE_MAP]=eo(w.TEXTURE_CUBE_MAP,w.TEXTURE_CUBE_MAP_POSITIVE_X,6),h&&(er[w.TEXTURE_2D_ARRAY]=eo(w.TEXTURE_2D_ARRAY,w.TEXTURE_2D_ARRAY,1,1),er[w.TEXTURE_3D]=eo(w.TEXTURE_3D,w.TEXTURE_3D,1,1)),q.setClear(0,0,0,1),de.setClear(1),pe.setClear(0),Lr(w.DEPTH_TEST),de.setFunc(3),Ur(!1),fr(1),Lr(w.CULL_FACE),Ii(0);const si={[E]:w.FUNC_ADD,101:w.FUNC_SUBTRACT,102:w.FUNC_REVERSE_SUBTRACT};if(h)si[103]=w.MIN,si[104]=w.MAX;else{const Kn=o.get("EXT_blend_minmax");null!==Kn&&(si[103]=Kn.MIN_EXT,si[104]=Kn.MAX_EXT)}const Ri={200:w.ZERO,201:w.ONE,202:w.SRC_COLOR,204:w.SRC_ALPHA,210:w.SRC_ALPHA_SATURATE,208:w.DST_COLOR,206:w.DST_ALPHA,203:w.ONE_MINUS_SRC_COLOR,205:w.ONE_MINUS_SRC_ALPHA,209:w.ONE_MINUS_DST_COLOR,207:w.ONE_MINUS_DST_ALPHA,211:w.CONSTANT_COLOR,212:w.ONE_MINUS_CONSTANT_COLOR,213:w.CONSTANT_ALPHA,214:w.ONE_MINUS_CONSTANT_ALPHA};function Ii(Kn,ys,jr,dr,ns,xo,Na,id,wf,Gl){if(0!==Kn){if(!1===ze&&(Lr(w.BLEND),ze=!0),5===Kn)ns=ns||ys,xo=xo||jr,Na=Na||dr,(ys!==ct||ns!==cn)&&(w.blendEquationSeparate(si[ys],si[ns]),ct=ys,cn=ns),(jr!==Dt||dr!==Jt||xo!==rn||Na!==Rn)&&(w.blendFuncSeparate(Ri[jr],Ri[dr],Ri[xo],Ri[Na]),Dt=jr,Jt=dr,rn=xo,Rn=Na),(!1===id.equals(kt)||wf!==Zt)&&(w.blendColor(id.r,id.g,id.b,wf),kt.copy(id),Zt=wf),Mt=Kn,li=!1;else if(Kn!==Mt||Gl!==li){if((ct!==E||cn!==E)&&(w.blendEquation(w.FUNC_ADD),ct=E,cn=E),Gl)switch(Kn){case 1:w.blendFuncSeparate(w.ONE,w.ONE_MINUS_SRC_ALPHA,w.ONE,w.ONE_MINUS_SRC_ALPHA);break;case 2:w.blendFunc(w.ONE,w.ONE);break;case 3:w.blendFuncSeparate(w.ZERO,w.ONE_MINUS_SRC_COLOR,w.ZERO,w.ONE);break;case 4:w.blendFuncSeparate(w.ZERO,w.SRC_COLOR,w.ZERO,w.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Kn)}else switch(Kn){case 1:w.blendFuncSeparate(w.SRC_ALPHA,w.ONE_MINUS_SRC_ALPHA,w.ONE,w.ONE_MINUS_SRC_ALPHA);break;case 2:w.blendFunc(w.SRC_ALPHA,w.ONE);break;case 3:w.blendFuncSeparate(w.ZERO,w.ONE_MINUS_SRC_COLOR,w.ZERO,w.ONE);break;case 4:w.blendFunc(w.ZERO,w.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Kn)}Dt=null,Jt=null,rn=null,Rn=null,kt.set(0,0,0),Zt=0,Mt=Kn,li=Gl}}else!0===ze&&(yr(w.BLEND),ze=!1)}function Ur(Kn){Ti!==Kn&&(w.frontFace(Kn?w.CW:w.CCW),Ti=Kn)}function fr(Kn){0!==Kn?(Lr(w.CULL_FACE),Kn!==ur&&w.cullFace(1===Kn?w.BACK:2===Kn?w.FRONT:w.FRONT_AND_BACK)):yr(w.CULL_FACE),ur=Kn}function co(Kn,ys,jr){Kn?(Lr(w.POLYGON_OFFSET_FILL),(Di!==ys||rr!==jr)&&(w.polygonOffset(ys,jr),Di=ys,rr=jr)):yr(w.POLYGON_OFFSET_FILL)}return{buffers:{color:q,depth:de,stencil:pe},enable:Lr,disable:yr,bindFramebuffer:function vr(Kn,ys){return Le[Kn]!==ys&&(w.bindFramebuffer(Kn,ys),Le[Kn]=ys,h&&(Kn===w.DRAW_FRAMEBUFFER&&(Le[w.FRAMEBUFFER]=ys),Kn===w.FRAMEBUFFER&&(Le[w.DRAW_FRAMEBUFFER]=ys)),!0)},drawBuffers:function _n(Kn,ys){let jr=ft,dr=!1;if(Kn)if(jr=Ke.get(ys),void 0===jr&&(jr=[],Ke.set(ys,jr)),Kn.isWebGLMultipleRenderTargets){const ns=Kn.texture;if(jr.length!==ns.length||jr[0]!==w.COLOR_ATTACHMENT0){for(let xo=0,Na=ns.length;xo<Na;xo++)jr[xo]=w.COLOR_ATTACHMENT0+xo;jr.length=ns.length,dr=!0}}else jr[0]!==w.COLOR_ATTACHMENT0&&(jr[0]=w.COLOR_ATTACHMENT0,dr=!0);else jr[0]!==w.BACK&&(jr[0]=w.BACK,dr=!0);dr&&(c.isWebGL2?w.drawBuffers(jr):o.get("WEBGL_draw_buffers").drawBuffersWEBGL(jr))},useProgram:function Ki(Kn){return We!==Kn&&(w.useProgram(Kn),We=Kn,!0)},setBlending:Ii,setMaterial:function es(Kn,ys){Kn.side===Y?yr(w.CULL_FACE):Lr(w.CULL_FACE);let jr=1===Kn.side;ys&&(jr=!jr),Ur(jr),1===Kn.blending&&!1===Kn.transparent?Ii(0):Ii(Kn.blending,Kn.blendEquation,Kn.blendSrc,Kn.blendDst,Kn.blendEquationAlpha,Kn.blendSrcAlpha,Kn.blendDstAlpha,Kn.blendColor,Kn.blendAlpha,Kn.premultipliedAlpha),de.setFunc(Kn.depthFunc),de.setTest(Kn.depthTest),de.setMask(Kn.depthWrite),q.setMask(Kn.colorWrite);const dr=Kn.stencilWrite;pe.setTest(dr),dr&&(pe.setMask(Kn.stencilWriteMask),pe.setFunc(Kn.stencilFunc,Kn.stencilRef,Kn.stencilFuncMask),pe.setOp(Kn.stencilFail,Kn.stencilZFail,Kn.stencilZPass)),co(Kn.polygonOffset,Kn.polygonOffsetFactor,Kn.polygonOffsetUnits),!0===Kn.alphaToCoverage?Lr(w.SAMPLE_ALPHA_TO_COVERAGE):yr(w.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:Ur,setCullFace:fr,setLineWidth:function us(Kn){Kn!==Yn&&(br&&w.lineWidth(Kn),Yn=Kn)},setPolygonOffset:co,setScissorTest:function _s(Kn){Kn?Lr(w.SCISSOR_TEST):yr(w.SCISSOR_TEST)},activeTexture:function $t(Kn){void 0===Kn&&(Kn=w.TEXTURE0+Li-1),ei!==Kn&&(w.activeTexture(Kn),ei=Kn)},bindTexture:function Pt(Kn,ys,jr){void 0===jr&&(jr=null===ei?w.TEXTURE0+Li-1:ei);let dr=sr[jr];void 0===dr&&(dr={type:void 0,texture:void 0},sr[jr]=dr),(dr.type!==Kn||dr.texture!==ys)&&(ei!==jr&&(w.activeTexture(jr),ei=jr),w.bindTexture(Kn,ys||er[Kn]),dr.type=Kn,dr.texture=ys)},unbindTexture:function ni(){const Kn=sr[ei];void 0!==Kn&&void 0!==Kn.type&&(w.bindTexture(Kn.type,null),Kn.type=void 0,Kn.texture=void 0)},compressedTexImage2D:function cr(){try{w.compressedTexImage2D.apply(w,arguments)}catch(Kn){console.error("THREE.WebGLState:",Kn)}},compressedTexImage3D:function Ar(){try{w.compressedTexImage3D.apply(w,arguments)}catch(Kn){console.error("THREE.WebGLState:",Kn)}},texImage2D:function xr(){try{w.texImage2D.apply(w,arguments)}catch(Kn){console.error("THREE.WebGLState:",Kn)}},texImage3D:function Oo(){try{w.texImage3D.apply(w,arguments)}catch(Kn){console.error("THREE.WebGLState:",Kn)}},updateUBOMapping:function to(Kn,ys){let jr=Ie.get(ys);void 0===jr&&(jr=new WeakMap,Ie.set(ys,jr));let dr=jr.get(Kn);void 0===dr&&(dr=w.getUniformBlockIndex(ys,Kn.name),jr.set(Kn,dr))},uniformBlockBinding:function Ps(Kn,ys){const dr=Ie.get(ys).get(Kn);xe.get(ys)!==dr&&(w.uniformBlockBinding(ys,dr,Kn.__bindingPointIndex),xe.set(ys,dr))},texStorage2D:function Nn(){try{w.texStorage2D.apply(w,arguments)}catch(Kn){console.error("THREE.WebGLState:",Kn)}},texStorage3D:function Vr(){try{w.texStorage3D.apply(w,arguments)}catch(Kn){console.error("THREE.WebGLState:",Kn)}},texSubImage2D:function Br(){try{w.texSubImage2D.apply(w,arguments)}catch(Kn){console.error("THREE.WebGLState:",Kn)}},texSubImage3D:function ks(){try{w.texSubImage3D.apply(w,arguments)}catch(Kn){console.error("THREE.WebGLState:",Kn)}},compressedTexSubImage2D:function Ir(){try{w.compressedTexSubImage2D.apply(w,arguments)}catch(Kn){console.error("THREE.WebGLState:",Kn)}},compressedTexSubImage3D:function ts(){try{w.compressedTexSubImage3D.apply(w,arguments)}catch(Kn){console.error("THREE.WebGLState:",Kn)}},scissor:function Ao(Kn){!1===Ds.equals(Kn)&&(w.scissor(Kn.x,Kn.y,Kn.z,Kn.w),Ds.copy(Kn))},viewport:function fo(Kn){!1===fs.equals(Kn)&&(w.viewport(Kn.x,Kn.y,Kn.z,Kn.w),fs.copy(Kn))},reset:function _a(){w.disable(w.BLEND),w.disable(w.CULL_FACE),w.disable(w.DEPTH_TEST),w.disable(w.POLYGON_OFFSET_FILL),w.disable(w.SCISSOR_TEST),w.disable(w.STENCIL_TEST),w.disable(w.SAMPLE_ALPHA_TO_COVERAGE),w.blendEquation(w.FUNC_ADD),w.blendFunc(w.ONE,w.ZERO),w.blendFuncSeparate(w.ONE,w.ZERO,w.ONE,w.ZERO),w.blendColor(0,0,0,0),w.colorMask(!0,!0,!0,!0),w.clearColor(0,0,0,0),w.depthMask(!0),w.depthFunc(w.LESS),w.clearDepth(1),w.stencilMask(4294967295),w.stencilFunc(w.ALWAYS,0,4294967295),w.stencilOp(w.KEEP,w.KEEP,w.KEEP),w.clearStencil(0),w.cullFace(w.BACK),w.frontFace(w.CCW),w.polygonOffset(0,0),w.activeTexture(w.TEXTURE0),w.bindFramebuffer(w.FRAMEBUFFER,null),!0===h&&(w.bindFramebuffer(w.DRAW_FRAMEBUFFER,null),w.bindFramebuffer(w.READ_FRAMEBUFFER,null)),w.useProgram(null),w.lineWidth(1),w.scissor(0,0,w.canvas.width,w.canvas.height),w.viewport(0,0,w.canvas.width,w.canvas.height),Be={},ei=null,sr={},Le={},Ke=new WeakMap,ft=[],We=null,ze=!1,Mt=null,ct=null,Dt=null,Jt=null,cn=null,rn=null,Rn=null,kt=new Os(0,0,0),Zt=0,li=!1,Ti=null,ur=null,Yn=null,Di=null,rr=null,Ds.set(0,0,w.canvas.width,w.canvas.height),fs.set(0,0,w.canvas.width,w.canvas.height),q.reset(),de.reset(),pe.reset()}}}function Ma(w,o,c,h,m,M,N){const q=m.isWebGL2,de=m.maxTextures,pe=m.maxCubemapSize,xe=m.maxTextureSize,Ie=m.maxSamples,Be=o.has("WEBGL_multisampled_render_to_texture")?o.get("WEBGL_multisampled_render_to_texture"):null,Le=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),Ke=new WeakMap;let ft;const We=new WeakMap;let ze=!1;try{ze=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function Mt($t,Pt){return ze?new OffscreenCanvas($t,Pt):mi("canvas")}function ct($t,Pt,ni,cr){let Ar=1;if(($t.width>cr||$t.height>cr)&&(Ar=cr/Math.max($t.width,$t.height)),Ar<1||!0===Pt){if(typeof HTMLImageElement<"u"&&$t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&$t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&$t instanceof ImageBitmap){const Br=Pt?Yd:Math.floor,ks=Br(Ar*$t.width),Ir=Br(Ar*$t.height);void 0===ft&&(ft=Mt(ks,Ir));const ts=ni?Mt(ks,Ir):ft;return ts.width=ks,ts.height=Ir,ts.getContext("2d").drawImage($t,0,0,ks,Ir),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+$t.width+"x"+$t.height+") to ("+ks+"x"+Ir+")."),ts}return"data"in $t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+$t.width+"x"+$t.height+")."),$t}return $t}function Dt($t){return _u($t.width)&&_u($t.height)}function cn($t,Pt){return $t.generateMipmaps&&Pt&&$t.minFilter!==ti&&$t.minFilter!==xt}function rn($t){w.generateMipmap($t)}function Rn($t,Pt,ni,cr,Ar=!1){if(!1===q)return Pt;if(null!==$t){if(void 0!==w[$t])return w[$t];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+$t+"'")}let Br=Pt;if(Pt===w.RED&&(ni===w.FLOAT&&(Br=w.R32F),ni===w.HALF_FLOAT&&(Br=w.R16F),ni===w.UNSIGNED_BYTE&&(Br=w.R8)),Pt===w.RED_INTEGER&&(ni===w.UNSIGNED_BYTE&&(Br=w.R8UI),ni===w.UNSIGNED_SHORT&&(Br=w.R16UI),ni===w.UNSIGNED_INT&&(Br=w.R32UI),ni===w.BYTE&&(Br=w.R8I),ni===w.SHORT&&(Br=w.R16I),ni===w.INT&&(Br=w.R32I)),Pt===w.RG&&(ni===w.FLOAT&&(Br=w.RG32F),ni===w.HALF_FLOAT&&(Br=w.RG16F),ni===w.UNSIGNED_BYTE&&(Br=w.RG8)),Pt===w.RGBA){const ks=Ar?tl:Ya.getTransfer(cr);ni===w.FLOAT&&(Br=w.RGBA32F),ni===w.HALF_FLOAT&&(Br=w.RGBA16F),ni===w.UNSIGNED_BYTE&&(Br=ks===$o?w.SRGB8_ALPHA8:w.RGBA8),ni===w.UNSIGNED_SHORT_4_4_4_4&&(Br=w.RGBA4),ni===w.UNSIGNED_SHORT_5_5_5_1&&(Br=w.RGB5_A1)}return(Br===w.R16F||Br===w.R32F||Br===w.RG16F||Br===w.RG32F||Br===w.RGBA16F||Br===w.RGBA32F)&&o.get("EXT_color_buffer_float"),Br}function kt($t,Pt,ni){return!0===cn($t,ni)||$t.isFramebufferTexture&&$t.minFilter!==ti&&$t.minFilter!==xt?Math.log2(Math.max(Pt.width,Pt.height))+1:void 0!==$t.mipmaps&&$t.mipmaps.length>0?$t.mipmaps.length:$t.isCompressedTexture&&Array.isArray($t.image)?Pt.mipmaps.length:1}function Zt($t){return $t===ti||1004===$t||1005===$t?w.NEAREST:w.LINEAR}function li($t){const Pt=$t.target;Pt.removeEventListener("dispose",li),function ur($t){const Pt=h.get($t);if(void 0===Pt.__webglInit)return;const ni=$t.source,cr=We.get(ni);if(cr){const Ar=cr[Pt.__cacheKey];Ar.usedTimes--,0===Ar.usedTimes&&Yn($t),0===Object.keys(cr).length&&We.delete(ni)}h.remove($t)}(Pt),Pt.isVideoTexture&&Ke.delete(Pt)}function Ti($t){const Pt=$t.target;Pt.removeEventListener("dispose",Ti),function Di($t){const Pt=$t.texture,ni=h.get($t),cr=h.get(Pt);if(void 0!==cr.__webglTexture&&(w.deleteTexture(cr.__webglTexture),N.memory.textures--),$t.depthTexture&&$t.depthTexture.dispose(),$t.isWebGLCubeRenderTarget)for(let Ar=0;Ar<6;Ar++){if(Array.isArray(ni.__webglFramebuffer[Ar]))for(let Br=0;Br<ni.__webglFramebuffer[Ar].length;Br++)w.deleteFramebuffer(ni.__webglFramebuffer[Ar][Br]);else w.deleteFramebuffer(ni.__webglFramebuffer[Ar]);ni.__webglDepthbuffer&&w.deleteRenderbuffer(ni.__webglDepthbuffer[Ar])}else{if(Array.isArray(ni.__webglFramebuffer))for(let Ar=0;Ar<ni.__webglFramebuffer.length;Ar++)w.deleteFramebuffer(ni.__webglFramebuffer[Ar]);else w.deleteFramebuffer(ni.__webglFramebuffer);if(ni.__webglDepthbuffer&&w.deleteRenderbuffer(ni.__webglDepthbuffer),ni.__webglMultisampledFramebuffer&&w.deleteFramebuffer(ni.__webglMultisampledFramebuffer),ni.__webglColorRenderbuffer)for(let Ar=0;Ar<ni.__webglColorRenderbuffer.length;Ar++)ni.__webglColorRenderbuffer[Ar]&&w.deleteRenderbuffer(ni.__webglColorRenderbuffer[Ar]);ni.__webglDepthRenderbuffer&&w.deleteRenderbuffer(ni.__webglDepthRenderbuffer)}if($t.isWebGLMultipleRenderTargets)for(let Ar=0,Br=Pt.length;Ar<Br;Ar++){const ks=h.get(Pt[Ar]);ks.__webglTexture&&(w.deleteTexture(ks.__webglTexture),N.memory.textures--),h.remove(Pt[Ar])}h.remove(Pt),h.remove($t)}(Pt)}function Yn($t){const Pt=h.get($t);w.deleteTexture(Pt.__webglTexture),delete We.get($t.source)[Pt.__cacheKey],N.memory.textures--}let rr=0;function lr($t,Pt){const ni=h.get($t);if($t.isVideoTexture&&function co($t){const Pt=N.render.frame;Ke.get($t)!==Pt&&(Ke.set($t,Pt),$t.update())}($t),!1===$t.isRenderTargetTexture&&$t.version>0&&ni.__version!==$t.version){const cr=$t.image;if(null===cr)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==cr.complete)return void Lr(ni,$t,Pt);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}c.bindTexture(w.TEXTURE_2D,ni.__webglTexture,w.TEXTURE0+Pt)}const xs={1e3:w.REPEAT,[ai]:w.CLAMP_TO_EDGE,1002:w.MIRRORED_REPEAT},Ds={[ti]:w.NEAREST,1004:w.NEAREST_MIPMAP_NEAREST,1005:w.NEAREST_MIPMAP_LINEAR,[xt]:w.LINEAR,1007:w.LINEAR_MIPMAP_NEAREST,[ye]:w.LINEAR_MIPMAP_LINEAR},fs={512:w.NEVER,519:w.ALWAYS,513:w.LESS,515:w.LEQUAL,514:w.EQUAL,518:w.GEQUAL,516:w.GREATER,517:w.NOTEQUAL};function eo($t,Pt,ni){if(ni?(w.texParameteri($t,w.TEXTURE_WRAP_S,xs[Pt.wrapS]),w.texParameteri($t,w.TEXTURE_WRAP_T,xs[Pt.wrapT]),($t===w.TEXTURE_3D||$t===w.TEXTURE_2D_ARRAY)&&w.texParameteri($t,w.TEXTURE_WRAP_R,xs[Pt.wrapR]),w.texParameteri($t,w.TEXTURE_MAG_FILTER,Ds[Pt.magFilter]),w.texParameteri($t,w.TEXTURE_MIN_FILTER,Ds[Pt.minFilter])):(w.texParameteri($t,w.TEXTURE_WRAP_S,w.CLAMP_TO_EDGE),w.texParameteri($t,w.TEXTURE_WRAP_T,w.CLAMP_TO_EDGE),($t===w.TEXTURE_3D||$t===w.TEXTURE_2D_ARRAY)&&w.texParameteri($t,w.TEXTURE_WRAP_R,w.CLAMP_TO_EDGE),(Pt.wrapS!==ai||Pt.wrapT!==ai)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),w.texParameteri($t,w.TEXTURE_MAG_FILTER,Zt(Pt.magFilter)),w.texParameteri($t,w.TEXTURE_MIN_FILTER,Zt(Pt.minFilter)),Pt.minFilter!==ti&&Pt.minFilter!==xt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),Pt.compareFunction&&(w.texParameteri($t,w.TEXTURE_COMPARE_MODE,w.COMPARE_REF_TO_TEXTURE),w.texParameteri($t,w.TEXTURE_COMPARE_FUNC,fs[Pt.compareFunction])),!0===o.has("EXT_texture_filter_anisotropic")){const cr=o.get("EXT_texture_filter_anisotropic");if(Pt.magFilter===ti||1005!==Pt.minFilter&&Pt.minFilter!==ye||Pt.type===dn&&!1===o.has("OES_texture_float_linear")||!1===q&&Pt.type===In&&!1===o.has("OES_texture_half_float_linear"))return;(Pt.anisotropy>1||h.get(Pt).__currentAnisotropy)&&(w.texParameterf($t,cr.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Pt.anisotropy,m.getMaxAnisotropy())),h.get(Pt).__currentAnisotropy=Pt.anisotropy)}}function er($t,Pt){let ni=!1;void 0===$t.__webglInit&&($t.__webglInit=!0,Pt.addEventListener("dispose",li));const cr=Pt.source;let Ar=We.get(cr);void 0===Ar&&(Ar={},We.set(cr,Ar));const Br=function Ji($t){const Pt=[];return Pt.push($t.wrapS),Pt.push($t.wrapT),Pt.push($t.wrapR||0),Pt.push($t.magFilter),Pt.push($t.minFilter),Pt.push($t.anisotropy),Pt.push($t.internalFormat),Pt.push($t.format),Pt.push($t.type),Pt.push($t.generateMipmaps),Pt.push($t.premultiplyAlpha),Pt.push($t.flipY),Pt.push($t.unpackAlignment),Pt.push($t.colorSpace),Pt.join()}(Pt);if(Br!==$t.__cacheKey){void 0===Ar[Br]&&(Ar[Br]={texture:w.createTexture(),usedTimes:0},N.memory.textures++,ni=!0),Ar[Br].usedTimes++;const ks=Ar[$t.__cacheKey];void 0!==ks&&(Ar[$t.__cacheKey].usedTimes--,0===ks.usedTimes&&Yn(Pt)),$t.__cacheKey=Br,$t.__webglTexture=Ar[Br].texture}return ni}function Lr($t,Pt,ni){let cr=w.TEXTURE_2D;(Pt.isDataArrayTexture||Pt.isCompressedArrayTexture)&&(cr=w.TEXTURE_2D_ARRAY),Pt.isData3DTexture&&(cr=w.TEXTURE_3D);const Ar=er($t,Pt),Br=Pt.source;c.bindTexture(cr,$t.__webglTexture,w.TEXTURE0+ni);const ks=h.get(Br);if(Br.version!==ks.__version||!0===Ar){c.activeTexture(w.TEXTURE0+ni);const Ir=Ya.getPrimaries(Ya.workingColorSpace),ts=""===Pt.colorSpace?null:Ya.getPrimaries(Pt.colorSpace),Nn=""===Pt.colorSpace||Ir===ts?w.NONE:w.BROWSER_DEFAULT_WEBGL;w.pixelStorei(w.UNPACK_FLIP_Y_WEBGL,Pt.flipY),w.pixelStorei(w.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Pt.premultiplyAlpha),w.pixelStorei(w.UNPACK_ALIGNMENT,Pt.unpackAlignment),w.pixelStorei(w.UNPACK_COLORSPACE_CONVERSION_WEBGL,Nn);const Vr=function Jt($t){return!q&&($t.wrapS!==ai||$t.wrapT!==ai||$t.minFilter!==ti&&$t.minFilter!==xt)}(Pt)&&!1===Dt(Pt.image);let xr=ct(Pt.image,Vr,!1,xe);xr=_s(Pt,xr);const Oo=Dt(xr)||q,Ao=M.convert(Pt.format,Pt.colorSpace);let Ps,fo=M.convert(Pt.type),to=Rn(Pt.internalFormat,Ao,fo,Pt.colorSpace,Pt.isVideoTexture);eo(cr,Pt,Oo);const _a=Pt.mipmaps,Kn=q&&!0!==Pt.isVideoTexture,ys=void 0===ks.__version||!0===Ar,jr=kt(Pt,xr,Oo);if(Pt.isDepthTexture)to=w.DEPTH_COMPONENT,q?to=Pt.type===dn?w.DEPTH_COMPONENT32F:Pt.type===kn?w.DEPTH_COMPONENT24:Pt.type===Si?w.DEPTH24_STENCIL8:w.DEPTH_COMPONENT16:Pt.type===dn&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Pt.format===Rs&&to===w.DEPTH_COMPONENT&&1012!==Pt.type&&Pt.type!==kn&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Pt.type=kn,fo=M.convert(Pt.type)),Pt.format===oe&&to===w.DEPTH_COMPONENT&&(to=w.DEPTH_STENCIL,Pt.type!==Si&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Pt.type=Si,fo=M.convert(Pt.type))),ys&&(Kn?c.texStorage2D(w.TEXTURE_2D,1,to,xr.width,xr.height):c.texImage2D(w.TEXTURE_2D,0,to,xr.width,xr.height,0,Ao,fo,null));else if(Pt.isDataTexture)if(_a.length>0&&Oo){Kn&&ys&&c.texStorage2D(w.TEXTURE_2D,jr,to,_a[0].width,_a[0].height);for(let dr=0,ns=_a.length;dr<ns;dr++)Ps=_a[dr],Kn?c.texSubImage2D(w.TEXTURE_2D,dr,0,0,Ps.width,Ps.height,Ao,fo,Ps.data):c.texImage2D(w.TEXTURE_2D,dr,to,Ps.width,Ps.height,0,Ao,fo,Ps.data);Pt.generateMipmaps=!1}else Kn?(ys&&c.texStorage2D(w.TEXTURE_2D,jr,to,xr.width,xr.height),c.texSubImage2D(w.TEXTURE_2D,0,0,0,xr.width,xr.height,Ao,fo,xr.data)):c.texImage2D(w.TEXTURE_2D,0,to,xr.width,xr.height,0,Ao,fo,xr.data);else if(Pt.isCompressedTexture)if(Pt.isCompressedArrayTexture){Kn&&ys&&c.texStorage3D(w.TEXTURE_2D_ARRAY,jr,to,_a[0].width,_a[0].height,xr.depth);for(let dr=0,ns=_a.length;dr<ns;dr++)Ps=_a[dr],Pt.format!==Jn?null!==Ao?Kn?c.compressedTexSubImage3D(w.TEXTURE_2D_ARRAY,dr,0,0,0,Ps.width,Ps.height,xr.depth,Ao,Ps.data,0,0):c.compressedTexImage3D(w.TEXTURE_2D_ARRAY,dr,to,Ps.width,Ps.height,xr.depth,0,Ps.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Kn?c.texSubImage3D(w.TEXTURE_2D_ARRAY,dr,0,0,0,Ps.width,Ps.height,xr.depth,Ao,fo,Ps.data):c.texImage3D(w.TEXTURE_2D_ARRAY,dr,to,Ps.width,Ps.height,xr.depth,0,Ao,fo,Ps.data)}else{Kn&&ys&&c.texStorage2D(w.TEXTURE_2D,jr,to,_a[0].width,_a[0].height);for(let dr=0,ns=_a.length;dr<ns;dr++)Ps=_a[dr],Pt.format!==Jn?null!==Ao?Kn?c.compressedTexSubImage2D(w.TEXTURE_2D,dr,0,0,Ps.width,Ps.height,Ao,Ps.data):c.compressedTexImage2D(w.TEXTURE_2D,dr,to,Ps.width,Ps.height,0,Ps.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Kn?c.texSubImage2D(w.TEXTURE_2D,dr,0,0,Ps.width,Ps.height,Ao,fo,Ps.data):c.texImage2D(w.TEXTURE_2D,dr,to,Ps.width,Ps.height,0,Ao,fo,Ps.data)}else if(Pt.isDataArrayTexture)Kn?(ys&&c.texStorage3D(w.TEXTURE_2D_ARRAY,jr,to,xr.width,xr.height,xr.depth),c.texSubImage3D(w.TEXTURE_2D_ARRAY,0,0,0,0,xr.width,xr.height,xr.depth,Ao,fo,xr.data)):c.texImage3D(w.TEXTURE_2D_ARRAY,0,to,xr.width,xr.height,xr.depth,0,Ao,fo,xr.data);else if(Pt.isData3DTexture)Kn?(ys&&c.texStorage3D(w.TEXTURE_3D,jr,to,xr.width,xr.height,xr.depth),c.texSubImage3D(w.TEXTURE_3D,0,0,0,0,xr.width,xr.height,xr.depth,Ao,fo,xr.data)):c.texImage3D(w.TEXTURE_3D,0,to,xr.width,xr.height,xr.depth,0,Ao,fo,xr.data);else if(Pt.isFramebufferTexture){if(ys)if(Kn)c.texStorage2D(w.TEXTURE_2D,jr,to,xr.width,xr.height);else{let dr=xr.width,ns=xr.height;for(let xo=0;xo<jr;xo++)c.texImage2D(w.TEXTURE_2D,xo,to,dr,ns,0,Ao,fo,null),dr>>=1,ns>>=1}}else if(_a.length>0&&Oo){Kn&&ys&&c.texStorage2D(w.TEXTURE_2D,jr,to,_a[0].width,_a[0].height);for(let dr=0,ns=_a.length;dr<ns;dr++)Ps=_a[dr],Kn?c.texSubImage2D(w.TEXTURE_2D,dr,0,0,Ao,fo,Ps):c.texImage2D(w.TEXTURE_2D,dr,to,Ao,fo,Ps);Pt.generateMipmaps=!1}else Kn?(ys&&c.texStorage2D(w.TEXTURE_2D,jr,to,xr.width,xr.height),c.texSubImage2D(w.TEXTURE_2D,0,0,0,Ao,fo,xr)):c.texImage2D(w.TEXTURE_2D,0,to,Ao,fo,xr);cn(Pt,Oo)&&rn(cr),ks.__version=Br.version,Pt.onUpdate&&Pt.onUpdate(Pt)}$t.__version=Pt.version}function vr($t,Pt,ni,cr,Ar,Br){const ks=M.convert(ni.format,ni.colorSpace),Ir=M.convert(ni.type),ts=Rn(ni.internalFormat,ks,Ir,ni.colorSpace);if(!h.get(Pt).__hasExternalTextures){const Vr=Math.max(1,Pt.width>>Br),xr=Math.max(1,Pt.height>>Br);Ar===w.TEXTURE_3D||Ar===w.TEXTURE_2D_ARRAY?c.texImage3D(Ar,Br,ts,Vr,xr,Pt.depth,0,ks,Ir,null):c.texImage2D(Ar,Br,ts,Vr,xr,0,ks,Ir,null)}c.bindFramebuffer(w.FRAMEBUFFER,$t),us(Pt)?Be.framebufferTexture2DMultisampleEXT(w.FRAMEBUFFER,cr,Ar,h.get(ni).__webglTexture,0,fr(Pt)):(Ar===w.TEXTURE_2D||Ar>=w.TEXTURE_CUBE_MAP_POSITIVE_X&&Ar<=w.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&w.framebufferTexture2D(w.FRAMEBUFFER,cr,Ar,h.get(ni).__webglTexture,Br),c.bindFramebuffer(w.FRAMEBUFFER,null)}function _n($t,Pt,ni){if(w.bindRenderbuffer(w.RENDERBUFFER,$t),Pt.depthBuffer&&!Pt.stencilBuffer){let cr=!0===q?w.DEPTH_COMPONENT24:w.DEPTH_COMPONENT16;if(ni||us(Pt)){const Ar=Pt.depthTexture;Ar&&Ar.isDepthTexture&&(Ar.type===dn?cr=w.DEPTH_COMPONENT32F:Ar.type===kn&&(cr=w.DEPTH_COMPONENT24));const Br=fr(Pt);us(Pt)?Be.renderbufferStorageMultisampleEXT(w.RENDERBUFFER,Br,cr,Pt.width,Pt.height):w.renderbufferStorageMultisample(w.RENDERBUFFER,Br,cr,Pt.width,Pt.height)}else w.renderbufferStorage(w.RENDERBUFFER,cr,Pt.width,Pt.height);w.framebufferRenderbuffer(w.FRAMEBUFFER,w.DEPTH_ATTACHMENT,w.RENDERBUFFER,$t)}else if(Pt.depthBuffer&&Pt.stencilBuffer){const cr=fr(Pt);ni&&!1===us(Pt)?w.renderbufferStorageMultisample(w.RENDERBUFFER,cr,w.DEPTH24_STENCIL8,Pt.width,Pt.height):us(Pt)?Be.renderbufferStorageMultisampleEXT(w.RENDERBUFFER,cr,w.DEPTH24_STENCIL8,Pt.width,Pt.height):w.renderbufferStorage(w.RENDERBUFFER,w.DEPTH_STENCIL,Pt.width,Pt.height),w.framebufferRenderbuffer(w.FRAMEBUFFER,w.DEPTH_STENCIL_ATTACHMENT,w.RENDERBUFFER,$t)}else{const cr=!0===Pt.isWebGLMultipleRenderTargets?Pt.texture:[Pt.texture];for(let Ar=0;Ar<cr.length;Ar++){const Br=cr[Ar],ks=M.convert(Br.format,Br.colorSpace),Ir=M.convert(Br.type),ts=Rn(Br.internalFormat,ks,Ir,Br.colorSpace),Nn=fr(Pt);ni&&!1===us(Pt)?w.renderbufferStorageMultisample(w.RENDERBUFFER,Nn,ts,Pt.width,Pt.height):us(Pt)?Be.renderbufferStorageMultisampleEXT(w.RENDERBUFFER,Nn,ts,Pt.width,Pt.height):w.renderbufferStorage(w.RENDERBUFFER,ts,Pt.width,Pt.height)}}w.bindRenderbuffer(w.RENDERBUFFER,null)}function si($t){const Pt=h.get($t),ni=!0===$t.isWebGLCubeRenderTarget;if($t.depthTexture&&!Pt.__autoAllocateDepthBuffer){if(ni)throw new Error("target.depthTexture not supported in Cube render targets");!function Ki($t,Pt){if(Pt&&Pt.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(c.bindFramebuffer(w.FRAMEBUFFER,$t),!Pt.depthTexture||!Pt.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!h.get(Pt.depthTexture).__webglTexture||Pt.depthTexture.image.width!==Pt.width||Pt.depthTexture.image.height!==Pt.height)&&(Pt.depthTexture.image.width=Pt.width,Pt.depthTexture.image.height=Pt.height,Pt.depthTexture.needsUpdate=!0),lr(Pt.depthTexture,0);const cr=h.get(Pt.depthTexture).__webglTexture,Ar=fr(Pt);if(Pt.depthTexture.format===Rs)us(Pt)?Be.framebufferTexture2DMultisampleEXT(w.FRAMEBUFFER,w.DEPTH_ATTACHMENT,w.TEXTURE_2D,cr,0,Ar):w.framebufferTexture2D(w.FRAMEBUFFER,w.DEPTH_ATTACHMENT,w.TEXTURE_2D,cr,0);else{if(Pt.depthTexture.format!==oe)throw new Error("Unknown depthTexture format");us(Pt)?Be.framebufferTexture2DMultisampleEXT(w.FRAMEBUFFER,w.DEPTH_STENCIL_ATTACHMENT,w.TEXTURE_2D,cr,0,Ar):w.framebufferTexture2D(w.FRAMEBUFFER,w.DEPTH_STENCIL_ATTACHMENT,w.TEXTURE_2D,cr,0)}}(Pt.__webglFramebuffer,$t)}else if(ni){Pt.__webglDepthbuffer=[];for(let cr=0;cr<6;cr++)c.bindFramebuffer(w.FRAMEBUFFER,Pt.__webglFramebuffer[cr]),Pt.__webglDepthbuffer[cr]=w.createRenderbuffer(),_n(Pt.__webglDepthbuffer[cr],$t,!1)}else c.bindFramebuffer(w.FRAMEBUFFER,Pt.__webglFramebuffer),Pt.__webglDepthbuffer=w.createRenderbuffer(),_n(Pt.__webglDepthbuffer,$t,!1);c.bindFramebuffer(w.FRAMEBUFFER,null)}function fr($t){return Math.min(Ie,$t.samples)}function us($t){const Pt=h.get($t);return q&&$t.samples>0&&!0===o.has("WEBGL_multisampled_render_to_texture")&&!1!==Pt.__useRenderToTexture}function _s($t,Pt){const ni=$t.colorSpace,cr=$t.format,Ar=$t.type;return!0===$t.isCompressedTexture||!0===$t.isVideoTexture||1035===$t.format||ni!==sc&&""!==ni&&(Ya.getTransfer(ni)===$o?!1===q?!0===o.has("EXT_sRGB")&&cr===Jn?($t.format=1035,$t.minFilter=xt,$t.generateMipmaps=!1):Pt=vu.sRGBToLinear(Pt):(cr!==Jn||Ar!==At)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",ni)),Pt}this.allocateTextureUnit=function br(){const $t=rr;return $t>=de&&console.warn("THREE.WebGLTextures: Trying to use "+$t+" texture units while this GPU supports only "+de),rr+=1,$t},this.resetTextureUnits=function Li(){rr=0},this.setTexture2D=lr,this.setTexture2DArray=function ei($t,Pt){const ni=h.get($t);$t.version>0&&ni.__version!==$t.version?Lr(ni,$t,Pt):c.bindTexture(w.TEXTURE_2D_ARRAY,ni.__webglTexture,w.TEXTURE0+Pt)},this.setTexture3D=function sr($t,Pt){const ni=h.get($t);$t.version>0&&ni.__version!==$t.version?Lr(ni,$t,Pt):c.bindTexture(w.TEXTURE_3D,ni.__webglTexture,w.TEXTURE0+Pt)},this.setTextureCube=function as($t,Pt){const ni=h.get($t);$t.version>0&&ni.__version!==$t.version?function yr($t,Pt,ni){if(6!==Pt.image.length)return;const cr=er($t,Pt),Ar=Pt.source;c.bindTexture(w.TEXTURE_CUBE_MAP,$t.__webglTexture,w.TEXTURE0+ni);const Br=h.get(Ar);if(Ar.version!==Br.__version||!0===cr){c.activeTexture(w.TEXTURE0+ni);const ks=Ya.getPrimaries(Ya.workingColorSpace),Ir=""===Pt.colorSpace?null:Ya.getPrimaries(Pt.colorSpace),ts=""===Pt.colorSpace||ks===Ir?w.NONE:w.BROWSER_DEFAULT_WEBGL;w.pixelStorei(w.UNPACK_FLIP_Y_WEBGL,Pt.flipY),w.pixelStorei(w.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Pt.premultiplyAlpha),w.pixelStorei(w.UNPACK_ALIGNMENT,Pt.unpackAlignment),w.pixelStorei(w.UNPACK_COLORSPACE_CONVERSION_WEBGL,ts);const Nn=Pt.isCompressedTexture||Pt.image[0].isCompressedTexture,Vr=Pt.image[0]&&Pt.image[0].isDataTexture,xr=[];for(let dr=0;dr<6;dr++)xr[dr]=Nn||Vr?Vr?Pt.image[dr].image:Pt.image[dr]:ct(Pt.image[dr],!1,!0,pe),xr[dr]=_s(Pt,xr[dr]);const Oo=xr[0],Ao=Dt(Oo)||q,fo=M.convert(Pt.format,Pt.colorSpace),to=M.convert(Pt.type),Ps=Rn(Pt.internalFormat,fo,to,Pt.colorSpace),_a=q&&!0!==Pt.isVideoTexture,Kn=void 0===Br.__version||!0===cr;let jr,ys=kt(Pt,Oo,Ao);if(eo(w.TEXTURE_CUBE_MAP,Pt,Ao),Nn){_a&&Kn&&c.texStorage2D(w.TEXTURE_CUBE_MAP,ys,Ps,Oo.width,Oo.height);for(let dr=0;dr<6;dr++){jr=xr[dr].mipmaps;for(let ns=0;ns<jr.length;ns++){const xo=jr[ns];Pt.format!==Jn?null!==fo?_a?c.compressedTexSubImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+dr,ns,0,0,xo.width,xo.height,fo,xo.data):c.compressedTexImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+dr,ns,Ps,xo.width,xo.height,0,xo.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):_a?c.texSubImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+dr,ns,0,0,xo.width,xo.height,fo,to,xo.data):c.texImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+dr,ns,Ps,xo.width,xo.height,0,fo,to,xo.data)}}}else{jr=Pt.mipmaps,_a&&Kn&&(jr.length>0&&ys++,c.texStorage2D(w.TEXTURE_CUBE_MAP,ys,Ps,xr[0].width,xr[0].height));for(let dr=0;dr<6;dr++)if(Vr){_a?c.texSubImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+dr,0,0,0,xr[dr].width,xr[dr].height,fo,to,xr[dr].data):c.texImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+dr,0,Ps,xr[dr].width,xr[dr].height,0,fo,to,xr[dr].data);for(let ns=0;ns<jr.length;ns++){const Na=jr[ns].image[dr].image;_a?c.texSubImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+dr,ns+1,0,0,Na.width,Na.height,fo,to,Na.data):c.texImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+dr,ns+1,Ps,Na.width,Na.height,0,fo,to,Na.data)}}else{_a?c.texSubImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+dr,0,0,0,fo,to,xr[dr]):c.texImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+dr,0,Ps,fo,to,xr[dr]);for(let ns=0;ns<jr.length;ns++){const xo=jr[ns];_a?c.texSubImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+dr,ns+1,0,0,fo,to,xo.image[dr]):c.texImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+dr,ns+1,Ps,fo,to,xo.image[dr])}}}cn(Pt,Ao)&&rn(w.TEXTURE_CUBE_MAP),Br.__version=Ar.version,Pt.onUpdate&&Pt.onUpdate(Pt)}$t.__version=Pt.version}(ni,$t,Pt):c.bindTexture(w.TEXTURE_CUBE_MAP,ni.__webglTexture,w.TEXTURE0+Pt)},this.rebindTextures=function Ri($t,Pt,ni){const cr=h.get($t);void 0!==Pt&&vr(cr.__webglFramebuffer,$t,$t.texture,w.COLOR_ATTACHMENT0,w.TEXTURE_2D,0),void 0!==ni&&si($t)},this.setupRenderTarget=function Ii($t){const Pt=$t.texture,ni=h.get($t),cr=h.get(Pt);$t.addEventListener("dispose",Ti),!0!==$t.isWebGLMultipleRenderTargets&&(void 0===cr.__webglTexture&&(cr.__webglTexture=w.createTexture()),cr.__version=Pt.version,N.memory.textures++);const Ar=!0===$t.isWebGLCubeRenderTarget,Br=!0===$t.isWebGLMultipleRenderTargets,ks=Dt($t)||q;if(Ar){ni.__webglFramebuffer=[];for(let Ir=0;Ir<6;Ir++)if(q&&Pt.mipmaps&&Pt.mipmaps.length>0){ni.__webglFramebuffer[Ir]=[];for(let ts=0;ts<Pt.mipmaps.length;ts++)ni.__webglFramebuffer[Ir][ts]=w.createFramebuffer()}else ni.__webglFramebuffer[Ir]=w.createFramebuffer()}else{if(q&&Pt.mipmaps&&Pt.mipmaps.length>0){ni.__webglFramebuffer=[];for(let Ir=0;Ir<Pt.mipmaps.length;Ir++)ni.__webglFramebuffer[Ir]=w.createFramebuffer()}else ni.__webglFramebuffer=w.createFramebuffer();if(Br)if(m.drawBuffers){const Ir=$t.texture;for(let ts=0,Nn=Ir.length;ts<Nn;ts++){const Vr=h.get(Ir[ts]);void 0===Vr.__webglTexture&&(Vr.__webglTexture=w.createTexture(),N.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(q&&$t.samples>0&&!1===us($t)){const Ir=Br?Pt:[Pt];ni.__webglMultisampledFramebuffer=w.createFramebuffer(),ni.__webglColorRenderbuffer=[],c.bindFramebuffer(w.FRAMEBUFFER,ni.__webglMultisampledFramebuffer);for(let ts=0;ts<Ir.length;ts++){const Nn=Ir[ts];ni.__webglColorRenderbuffer[ts]=w.createRenderbuffer(),w.bindRenderbuffer(w.RENDERBUFFER,ni.__webglColorRenderbuffer[ts]);const Vr=M.convert(Nn.format,Nn.colorSpace),xr=M.convert(Nn.type),Oo=Rn(Nn.internalFormat,Vr,xr,Nn.colorSpace,!0===$t.isXRRenderTarget),Ao=fr($t);w.renderbufferStorageMultisample(w.RENDERBUFFER,Ao,Oo,$t.width,$t.height),w.framebufferRenderbuffer(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0+ts,w.RENDERBUFFER,ni.__webglColorRenderbuffer[ts])}w.bindRenderbuffer(w.RENDERBUFFER,null),$t.depthBuffer&&(ni.__webglDepthRenderbuffer=w.createRenderbuffer(),_n(ni.__webglDepthRenderbuffer,$t,!0)),c.bindFramebuffer(w.FRAMEBUFFER,null)}}if(Ar){c.bindTexture(w.TEXTURE_CUBE_MAP,cr.__webglTexture),eo(w.TEXTURE_CUBE_MAP,Pt,ks);for(let Ir=0;Ir<6;Ir++)if(q&&Pt.mipmaps&&Pt.mipmaps.length>0)for(let ts=0;ts<Pt.mipmaps.length;ts++)vr(ni.__webglFramebuffer[Ir][ts],$t,Pt,w.COLOR_ATTACHMENT0,w.TEXTURE_CUBE_MAP_POSITIVE_X+Ir,ts);else vr(ni.__webglFramebuffer[Ir],$t,Pt,w.COLOR_ATTACHMENT0,w.TEXTURE_CUBE_MAP_POSITIVE_X+Ir,0);cn(Pt,ks)&&rn(w.TEXTURE_CUBE_MAP),c.unbindTexture()}else if(Br){const Ir=$t.texture;for(let ts=0,Nn=Ir.length;ts<Nn;ts++){const Vr=Ir[ts],xr=h.get(Vr);c.bindTexture(w.TEXTURE_2D,xr.__webglTexture),eo(w.TEXTURE_2D,Vr,ks),vr(ni.__webglFramebuffer,$t,Vr,w.COLOR_ATTACHMENT0+ts,w.TEXTURE_2D,0),cn(Vr,ks)&&rn(w.TEXTURE_2D)}c.unbindTexture()}else{let Ir=w.TEXTURE_2D;if(($t.isWebGL3DRenderTarget||$t.isWebGLArrayRenderTarget)&&(q?Ir=$t.isWebGL3DRenderTarget?w.TEXTURE_3D:w.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),c.bindTexture(Ir,cr.__webglTexture),eo(Ir,Pt,ks),q&&Pt.mipmaps&&Pt.mipmaps.length>0)for(let ts=0;ts<Pt.mipmaps.length;ts++)vr(ni.__webglFramebuffer[ts],$t,Pt,w.COLOR_ATTACHMENT0,Ir,ts);else vr(ni.__webglFramebuffer,$t,Pt,w.COLOR_ATTACHMENT0,Ir,0);cn(Pt,ks)&&rn(Ir),c.unbindTexture()}$t.depthBuffer&&si($t)},this.updateRenderTargetMipmap=function es($t){const Pt=Dt($t)||q,ni=!0===$t.isWebGLMultipleRenderTargets?$t.texture:[$t.texture];for(let cr=0,Ar=ni.length;cr<Ar;cr++){const Br=ni[cr];if(cn(Br,Pt)){const ks=$t.isWebGLCubeRenderTarget?w.TEXTURE_CUBE_MAP:w.TEXTURE_2D,Ir=h.get(Br).__webglTexture;c.bindTexture(ks,Ir),rn(ks),c.unbindTexture()}}},this.updateMultisampleRenderTarget=function Ur($t){if(q&&$t.samples>0&&!1===us($t)){const Pt=$t.isWebGLMultipleRenderTargets?$t.texture:[$t.texture],ni=$t.width,cr=$t.height;let Ar=w.COLOR_BUFFER_BIT;const Br=[],ks=$t.stencilBuffer?w.DEPTH_STENCIL_ATTACHMENT:w.DEPTH_ATTACHMENT,Ir=h.get($t),ts=!0===$t.isWebGLMultipleRenderTargets;if(ts)for(let Nn=0;Nn<Pt.length;Nn++)c.bindFramebuffer(w.FRAMEBUFFER,Ir.__webglMultisampledFramebuffer),w.framebufferRenderbuffer(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0+Nn,w.RENDERBUFFER,null),c.bindFramebuffer(w.FRAMEBUFFER,Ir.__webglFramebuffer),w.framebufferTexture2D(w.DRAW_FRAMEBUFFER,w.COLOR_ATTACHMENT0+Nn,w.TEXTURE_2D,null,0);c.bindFramebuffer(w.READ_FRAMEBUFFER,Ir.__webglMultisampledFramebuffer),c.bindFramebuffer(w.DRAW_FRAMEBUFFER,Ir.__webglFramebuffer);for(let Nn=0;Nn<Pt.length;Nn++){Br.push(w.COLOR_ATTACHMENT0+Nn),$t.depthBuffer&&Br.push(ks);const Vr=void 0!==Ir.__ignoreDepthValues&&Ir.__ignoreDepthValues;if(!1===Vr&&($t.depthBuffer&&(Ar|=w.DEPTH_BUFFER_BIT),$t.stencilBuffer&&(Ar|=w.STENCIL_BUFFER_BIT)),ts&&w.framebufferRenderbuffer(w.READ_FRAMEBUFFER,w.COLOR_ATTACHMENT0,w.RENDERBUFFER,Ir.__webglColorRenderbuffer[Nn]),!0===Vr&&(w.invalidateFramebuffer(w.READ_FRAMEBUFFER,[ks]),w.invalidateFramebuffer(w.DRAW_FRAMEBUFFER,[ks])),ts){const xr=h.get(Pt[Nn]).__webglTexture;w.framebufferTexture2D(w.DRAW_FRAMEBUFFER,w.COLOR_ATTACHMENT0,w.TEXTURE_2D,xr,0)}w.blitFramebuffer(0,0,ni,cr,0,0,ni,cr,Ar,w.NEAREST),Le&&w.invalidateFramebuffer(w.READ_FRAMEBUFFER,Br)}if(c.bindFramebuffer(w.READ_FRAMEBUFFER,null),c.bindFramebuffer(w.DRAW_FRAMEBUFFER,null),ts)for(let Nn=0;Nn<Pt.length;Nn++){c.bindFramebuffer(w.FRAMEBUFFER,Ir.__webglMultisampledFramebuffer),w.framebufferRenderbuffer(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0+Nn,w.RENDERBUFFER,Ir.__webglColorRenderbuffer[Nn]);const Vr=h.get(Pt[Nn]).__webglTexture;c.bindFramebuffer(w.FRAMEBUFFER,Ir.__webglFramebuffer),w.framebufferTexture2D(w.DRAW_FRAMEBUFFER,w.COLOR_ATTACHMENT0+Nn,w.TEXTURE_2D,Vr,0)}c.bindFramebuffer(w.DRAW_FRAMEBUFFER,Ir.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=si,this.setupFrameBufferTexture=vr,this.useMultisampledRTT=us}function Va(w,o,c){const h=c.isWebGL2;return{convert:function m(M,N=""){let q;const de=Ya.getTransfer(N);if(M===At)return w.UNSIGNED_BYTE;if(1017===M)return w.UNSIGNED_SHORT_4_4_4_4;if(1018===M)return w.UNSIGNED_SHORT_5_5_5_1;if(1010===M)return w.BYTE;if(1011===M)return w.SHORT;if(1012===M)return w.UNSIGNED_SHORT;if(1013===M)return w.INT;if(M===kn)return w.UNSIGNED_INT;if(M===dn)return w.FLOAT;if(M===In)return h?w.HALF_FLOAT:(q=o.get("OES_texture_half_float"),null!==q?q.HALF_FLOAT_OES:null);if(1021===M)return w.ALPHA;if(M===Jn)return w.RGBA;if(1024===M)return w.LUMINANCE;if(1025===M)return w.LUMINANCE_ALPHA;if(M===Rs)return w.DEPTH_COMPONENT;if(M===oe)return w.DEPTH_STENCIL;if(1035===M)return q=o.get("EXT_sRGB"),null!==q?q.SRGB_ALPHA_EXT:null;if(1028===M)return w.RED;if(1029===M)return w.RED_INTEGER;if(1030===M)return w.RG;if(1031===M)return w.RG_INTEGER;if(1033===M)return w.RGBA_INTEGER;if(33776===M||33777===M||33778===M||33779===M)if(de===$o){if(q=o.get("WEBGL_compressed_texture_s3tc_srgb"),null===q)return null;if(33776===M)return q.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===M)return q.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===M)return q.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===M)return q.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(q=o.get("WEBGL_compressed_texture_s3tc"),null===q)return null;if(33776===M)return q.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===M)return q.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===M)return q.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===M)return q.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===M||35841===M||35842===M||35843===M){if(q=o.get("WEBGL_compressed_texture_pvrtc"),null===q)return null;if(35840===M)return q.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===M)return q.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===M)return q.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===M)return q.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===M)return q=o.get("WEBGL_compressed_texture_etc1"),null!==q?q.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===M||37496===M){if(q=o.get("WEBGL_compressed_texture_etc"),null===q)return null;if(37492===M)return de===$o?q.COMPRESSED_SRGB8_ETC2:q.COMPRESSED_RGB8_ETC2;if(37496===M)return de===$o?q.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:q.COMPRESSED_RGBA8_ETC2_EAC}if(37808===M||37809===M||37810===M||37811===M||37812===M||37813===M||37814===M||37815===M||37816===M||37817===M||37818===M||37819===M||37820===M||37821===M){if(q=o.get("WEBGL_compressed_texture_astc"),null===q)return null;if(37808===M)return de===$o?q.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:q.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===M)return de===$o?q.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:q.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===M)return de===$o?q.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:q.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===M)return de===$o?q.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:q.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===M)return de===$o?q.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:q.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===M)return de===$o?q.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:q.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===M)return de===$o?q.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:q.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===M)return de===$o?q.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:q.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===M)return de===$o?q.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:q.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===M)return de===$o?q.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:q.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===M)return de===$o?q.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:q.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===M)return de===$o?q.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:q.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===M)return de===$o?q.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:q.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===M)return de===$o?q.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:q.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===M||36494===M||36495===M){if(q=o.get("EXT_texture_compression_bptc"),null===q)return null;if(36492===M)return de===$o?q.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:q.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(36494===M)return q.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(36495===M)return q.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===M||36284===M||36285===M||36286===M){if(q=o.get("EXT_texture_compression_rgtc"),null===q)return null;if(36492===M)return q.COMPRESSED_RED_RGTC1_EXT;if(36284===M)return q.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===M)return q.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===M)return q.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return M===Si?h?w.UNSIGNED_INT_24_8:(q=o.get("WEBGL_depth_texture"),null!==q?q.UNSIGNED_INT_24_8_WEBGL:null):void 0!==w[M]?w[M]:null}}}class Wr extends Vl{constructor(o=[]){super(),this.isArrayCamera=!0,this.cameras=o}}class nd extends Rl{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Sa={type:"move"};class ec{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new nd,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new nd,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Ft,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Ft),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new nd,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Ft,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Ft),this._grip}dispatchEvent(o){return null!==this._targetRay&&this._targetRay.dispatchEvent(o),null!==this._grip&&this._grip.dispatchEvent(o),null!==this._hand&&this._hand.dispatchEvent(o),this}connect(o){if(o&&o.hand){const c=this._hand;if(c)for(const h of o.hand.values())this._getHandJoint(c,h)}return this.dispatchEvent({type:"connected",data:o}),this}disconnect(o){return this.dispatchEvent({type:"disconnected",data:o}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(o,c,h){let m=null,M=null,N=null;const q=this._targetRay,de=this._grip,pe=this._hand;if(o&&"visible-blurred"!==c.session.visibilityState){if(pe&&o.hand){N=!0;for(const ft of o.hand.values()){const We=c.getJointPose(ft,h),ze=this._getHandJoint(pe,ft);null!==We&&(ze.matrix.fromArray(We.transform.matrix),ze.matrix.decompose(ze.position,ze.rotation,ze.scale),ze.matrixWorldNeedsUpdate=!0,ze.jointRadius=We.radius),ze.visible=null!==We}const Be=pe.joints["index-finger-tip"].position.distanceTo(pe.joints["thumb-tip"].position),Le=.02,Ke=.005;pe.inputState.pinching&&Be>Le+Ke?(pe.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:o.handedness,target:this})):!pe.inputState.pinching&&Be<=Le-Ke&&(pe.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:o.handedness,target:this}))}else null!==de&&o.gripSpace&&(M=c.getPose(o.gripSpace,h),null!==M&&(de.matrix.fromArray(M.transform.matrix),de.matrix.decompose(de.position,de.rotation,de.scale),de.matrixWorldNeedsUpdate=!0,M.linearVelocity?(de.hasLinearVelocity=!0,de.linearVelocity.copy(M.linearVelocity)):de.hasLinearVelocity=!1,M.angularVelocity?(de.hasAngularVelocity=!0,de.angularVelocity.copy(M.angularVelocity)):de.hasAngularVelocity=!1));null!==q&&(m=c.getPose(o.targetRaySpace,h),null===m&&null!==M&&(m=M),null!==m&&(q.matrix.fromArray(m.transform.matrix),q.matrix.decompose(q.position,q.rotation,q.scale),q.matrixWorldNeedsUpdate=!0,m.linearVelocity?(q.hasLinearVelocity=!0,q.linearVelocity.copy(m.linearVelocity)):q.hasLinearVelocity=!1,m.angularVelocity?(q.hasAngularVelocity=!0,q.angularVelocity.copy(m.angularVelocity)):q.hasAngularVelocity=!1,this.dispatchEvent(Sa)))}return null!==q&&(q.visible=null!==m),null!==de&&(de.visible=null!==M),null!==pe&&(pe.visible=null!==N),this}_getHandJoint(o,c){if(void 0===o.joints[c.jointName]){const h=new nd;h.matrixAutoUpdate=!1,h.visible=!1,o.joints[c.jointName]=h,o.add(h)}return o.joints[c.jointName]}}class yh extends bu{constructor(o,c,h,m,M,N,q,de,pe,xe){if((xe=void 0!==xe?xe:Rs)!==Rs&&xe!==oe)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===h&&xe===Rs&&(h=kn),void 0===h&&xe===oe&&(h=Si),super(null,m,M,N,q,de,xe,h,pe),this.isDepthTexture=!0,this.image={width:o,height:c},this.magFilter=void 0!==q?q:ti,this.minFilter=void 0!==de?de:ti,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(o){return super.copy(o),this.compareFunction=o.compareFunction,this}toJSON(o){const c=super.toJSON(o);return null!==this.compareFunction&&(c.compareFunction=this.compareFunction),c}}class qA extends xh{constructor(o,c){super();const h=this;let m=null,M=1,N=null,q="local-floor",de=1,pe=null,xe=null,Ie=null,Be=null,Le=null,Ke=null;const ft=c.getContextAttributes();let We=null,ze=null;const Mt=[],ct=[],Dt=new Vl;Dt.layers.enable(1),Dt.viewport=new il;const Jt=new Vl;Jt.layers.enable(2),Jt.viewport=new il;const cn=[Dt,Jt],rn=new Wr;rn.layers.enable(1),rn.layers.enable(2);let Rn=null,kt=null;function Zt(ei){const sr=ct.indexOf(ei.inputSource);if(-1===sr)return;const as=Mt[sr];void 0!==as&&(as.update(ei.inputSource,ei.frame,pe||N),as.dispatchEvent({type:ei.type,data:ei.inputSource}))}function li(){m.removeEventListener("select",Zt),m.removeEventListener("selectstart",Zt),m.removeEventListener("selectend",Zt),m.removeEventListener("squeeze",Zt),m.removeEventListener("squeezestart",Zt),m.removeEventListener("squeezeend",Zt),m.removeEventListener("end",li),m.removeEventListener("inputsourceschange",Ti);for(let ei=0;ei<Mt.length;ei++){const sr=ct[ei];null!==sr&&(ct[ei]=null,Mt[ei].disconnect(sr))}Rn=null,kt=null,o.setRenderTarget(We),Le=null,Be=null,Ie=null,m=null,ze=null,lr.stop(),h.isPresenting=!1,h.dispatchEvent({type:"sessionend"})}function Ti(ei){for(let sr=0;sr<ei.removed.length;sr++){const as=ei.removed[sr],xs=ct.indexOf(as);xs>=0&&(ct[xs]=null,Mt[xs].disconnect(as))}for(let sr=0;sr<ei.added.length;sr++){const as=ei.added[sr];let xs=ct.indexOf(as);if(-1===xs){for(let fs=0;fs<Mt.length;fs++){if(fs>=ct.length){ct.push(as),xs=fs;break}if(null===ct[fs]){ct[fs]=as,xs=fs;break}}if(-1===xs)break}const Ds=Mt[xs];Ds&&Ds.connect(as)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ei){let sr=Mt[ei];return void 0===sr&&(sr=new ec,Mt[ei]=sr),sr.getTargetRaySpace()},this.getControllerGrip=function(ei){let sr=Mt[ei];return void 0===sr&&(sr=new ec,Mt[ei]=sr),sr.getGripSpace()},this.getHand=function(ei){let sr=Mt[ei];return void 0===sr&&(sr=new ec,Mt[ei]=sr),sr.getHandSpace()},this.setFramebufferScaleFactor=function(ei){M=ei,!0===h.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ei){q=ei,!0===h.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return pe||N},this.setReferenceSpace=function(ei){pe=ei},this.getBaseLayer=function(){return null!==Be?Be:Le},this.getBinding=function(){return Ie},this.getFrame=function(){return Ke},this.getSession=function(){return m},this.setSession=function(){var ei=(0,Ee.A)(function*(sr){if(m=sr,null!==m){if(We=o.getRenderTarget(),m.addEventListener("select",Zt),m.addEventListener("selectstart",Zt),m.addEventListener("selectend",Zt),m.addEventListener("squeeze",Zt),m.addEventListener("squeezestart",Zt),m.addEventListener("squeezeend",Zt),m.addEventListener("end",li),m.addEventListener("inputsourceschange",Ti),!0!==ft.xrCompatible&&(yield c.makeXRCompatible()),void 0===m.renderState.layers||!1===o.capabilities.isWebGL2)Le=new XRWebGLLayer(m,c,{antialias:void 0!==m.renderState.layers||ft.antialias,alpha:!0,depth:ft.depth,stencil:ft.stencil,framebufferScaleFactor:M}),m.updateRenderState({baseLayer:Le}),ze=new Ou(Le.framebufferWidth,Le.framebufferHeight,{format:Jn,type:At,colorSpace:o.outputColorSpace,stencilBuffer:ft.stencil});else{let as=null,xs=null,Ds=null;ft.depth&&(Ds=ft.stencil?c.DEPTH24_STENCIL8:c.DEPTH_COMPONENT24,as=ft.stencil?oe:Rs,xs=ft.stencil?Si:kn);const fs={colorFormat:c.RGBA8,depthFormat:Ds,scaleFactor:M};Ie=new XRWebGLBinding(m,c),Be=Ie.createProjectionLayer(fs),m.updateRenderState({layers:[Be]}),ze=new Ou(Be.textureWidth,Be.textureHeight,{format:Jn,type:At,depthTexture:new yh(Be.textureWidth,Be.textureHeight,xs,void 0,void 0,void 0,void 0,void 0,void 0,as),stencilBuffer:ft.stencil,colorSpace:o.outputColorSpace,samples:ft.antialias?4:0}),o.properties.get(ze).__ignoreDepthValues=Be.ignoreDepthValues}ze.isXRRenderTarget=!0,this.setFoveation(de),pe=null,N=yield m.requestReferenceSpace(q),lr.setContext(m),lr.start(),h.isPresenting=!0,h.dispatchEvent({type:"sessionstart"})}});return function(sr){return ei.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==m)return m.environmentBlendMode};const ur=new Ft,Yn=new Ft;function rr(ei,sr){null===sr?ei.matrixWorld.copy(ei.matrix):ei.matrixWorld.multiplyMatrices(sr.matrixWorld,ei.matrix),ei.matrixWorldInverse.copy(ei.matrixWorld).invert()}this.updateCamera=function(ei){if(null===m)return;rn.near=Jt.near=Dt.near=ei.near,rn.far=Jt.far=Dt.far=ei.far,(Rn!==rn.near||kt!==rn.far)&&(m.updateRenderState({depthNear:rn.near,depthFar:rn.far}),Rn=rn.near,kt=rn.far);const sr=ei.parent,as=rn.cameras;rr(rn,sr);for(let xs=0;xs<as.length;xs++)rr(as[xs],sr);2===as.length?function Di(ei,sr,as){ur.setFromMatrixPosition(sr.matrixWorld),Yn.setFromMatrixPosition(as.matrixWorld);const xs=ur.distanceTo(Yn),Ds=sr.projectionMatrix.elements,fs=as.projectionMatrix.elements,eo=Ds[14]/(Ds[10]-1),er=Ds[14]/(Ds[10]+1),Lr=(Ds[9]+1)/Ds[5],yr=(Ds[9]-1)/Ds[5],vr=(Ds[8]-1)/Ds[0],_n=(fs[8]+1)/fs[0],Ki=eo*vr,si=eo*_n,Ri=xs/(-vr+_n),Ii=Ri*-vr;sr.matrixWorld.decompose(ei.position,ei.quaternion,ei.scale),ei.translateX(Ii),ei.translateZ(Ri),ei.matrixWorld.compose(ei.position,ei.quaternion,ei.scale),ei.matrixWorldInverse.copy(ei.matrixWorld).invert();const es=eo+Ri,Ur=er+Ri;ei.projectionMatrix.makePerspective(Ki-Ii,si+(xs-Ii),Lr*er/Ur*es,yr*er/Ur*es,es,Ur),ei.projectionMatrixInverse.copy(ei.projectionMatrix).invert()}(rn,Dt,Jt):rn.projectionMatrix.copy(Dt.projectionMatrix),function Li(ei,sr,as){null===as?ei.matrix.copy(sr.matrixWorld):(ei.matrix.copy(as.matrixWorld),ei.matrix.invert(),ei.matrix.multiply(sr.matrixWorld)),ei.matrix.decompose(ei.position,ei.quaternion,ei.scale),ei.updateMatrixWorld(!0),ei.projectionMatrix.copy(sr.projectionMatrix),ei.projectionMatrixInverse.copy(sr.projectionMatrixInverse),ei.isPerspectiveCamera&&(ei.fov=2*pd*Math.atan(1/ei.projectionMatrix.elements[5]),ei.zoom=1)}(ei,rn,sr)},this.getCamera=function(){return rn},this.getFoveation=function(){if(null!==Be||null!==Le)return de},this.setFoveation=function(ei){de=ei,null!==Be&&(Be.fixedFoveation=ei),null!==Le&&void 0!==Le.fixedFoveation&&(Le.fixedFoveation=ei)};let br=null;const lr=new bA;lr.setAnimationLoop(function Ji(ei,sr){if(xe=sr.getViewerPose(pe||N),Ke=sr,null!==xe){const as=xe.views;null!==Le&&(o.setRenderTargetFramebuffer(ze,Le.framebuffer),o.setRenderTarget(ze));let xs=!1;as.length!==rn.cameras.length&&(rn.cameras.length=0,xs=!0);for(let Ds=0;Ds<as.length;Ds++){const fs=as[Ds];let eo=null;if(null!==Le)eo=Le.getViewport(fs);else{const Lr=Ie.getViewSubImage(Be,fs);eo=Lr.viewport,0===Ds&&(o.setRenderTargetTextures(ze,Lr.colorTexture,Be.ignoreDepthValues?void 0:Lr.depthStencilTexture),o.setRenderTarget(ze))}let er=cn[Ds];void 0===er&&(er=new Vl,er.layers.enable(Ds),er.viewport=new il,cn[Ds]=er),er.matrix.fromArray(fs.transform.matrix),er.matrix.decompose(er.position,er.quaternion,er.scale),er.projectionMatrix.fromArray(fs.projectionMatrix),er.projectionMatrixInverse.copy(er.projectionMatrix).invert(),er.viewport.set(eo.x,eo.y,eo.width,eo.height),0===Ds&&(rn.matrix.copy(er.matrix),rn.matrix.decompose(rn.position,rn.quaternion,rn.scale)),!0===xs&&rn.cameras.push(er)}}for(let as=0;as<Mt.length;as++){const xs=ct[as],Ds=Mt[as];null!==xs&&void 0!==Ds&&Ds.update(xs,sr,pe||N)}br&&br(ei,sr),sr.detectedPlanes&&h.dispatchEvent({type:"planesdetected",data:sr}),Ke=null}),this.setAnimationLoop=function(ei){br=ei},this.dispose=function(){}}}function Gx(w,o){function c(We,ze){!0===We.matrixAutoUpdate&&We.updateMatrix(),ze.value.copy(We.matrix)}function M(We,ze){We.opacity.value=ze.opacity,ze.color&&We.diffuse.value.copy(ze.color),ze.emissive&&We.emissive.value.copy(ze.emissive).multiplyScalar(ze.emissiveIntensity),ze.map&&(We.map.value=ze.map,c(ze.map,We.mapTransform)),ze.alphaMap&&(We.alphaMap.value=ze.alphaMap,c(ze.alphaMap,We.alphaMapTransform)),ze.bumpMap&&(We.bumpMap.value=ze.bumpMap,c(ze.bumpMap,We.bumpMapTransform),We.bumpScale.value=ze.bumpScale,1===ze.side&&(We.bumpScale.value*=-1)),ze.normalMap&&(We.normalMap.value=ze.normalMap,c(ze.normalMap,We.normalMapTransform),We.normalScale.value.copy(ze.normalScale),1===ze.side&&We.normalScale.value.negate()),ze.displacementMap&&(We.displacementMap.value=ze.displacementMap,c(ze.displacementMap,We.displacementMapTransform),We.displacementScale.value=ze.displacementScale,We.displacementBias.value=ze.displacementBias),ze.emissiveMap&&(We.emissiveMap.value=ze.emissiveMap,c(ze.emissiveMap,We.emissiveMapTransform)),ze.specularMap&&(We.specularMap.value=ze.specularMap,c(ze.specularMap,We.specularMapTransform)),ze.alphaTest>0&&(We.alphaTest.value=ze.alphaTest);const Mt=o.get(ze).envMap;if(Mt&&(We.envMap.value=Mt,We.flipEnvMap.value=Mt.isCubeTexture&&!1===Mt.isRenderTargetTexture?-1:1,We.reflectivity.value=ze.reflectivity,We.ior.value=ze.ior,We.refractionRatio.value=ze.refractionRatio),ze.lightMap){We.lightMap.value=ze.lightMap;const ct=!0===w._useLegacyLights?Math.PI:1;We.lightMapIntensity.value=ze.lightMapIntensity*ct,c(ze.lightMap,We.lightMapTransform)}ze.aoMap&&(We.aoMap.value=ze.aoMap,We.aoMapIntensity.value=ze.aoMapIntensity,c(ze.aoMap,We.aoMapTransform))}return{refreshFogUniforms:function h(We,ze){ze.color.getRGB(We.fogColor.value,Fc(w)),ze.isFog?(We.fogNear.value=ze.near,We.fogFar.value=ze.far):ze.isFogExp2&&(We.fogDensity.value=ze.density)},refreshMaterialUniforms:function m(We,ze,Mt,ct,Dt){ze.isMeshBasicMaterial||ze.isMeshLambertMaterial?M(We,ze):ze.isMeshToonMaterial?(M(We,ze),function Ie(We,ze){ze.gradientMap&&(We.gradientMap.value=ze.gradientMap)}(We,ze)):ze.isMeshPhongMaterial?(M(We,ze),function xe(We,ze){We.specular.value.copy(ze.specular),We.shininess.value=Math.max(ze.shininess,1e-4)}(We,ze)):ze.isMeshStandardMaterial?(M(We,ze),function Be(We,ze){We.metalness.value=ze.metalness,ze.metalnessMap&&(We.metalnessMap.value=ze.metalnessMap,c(ze.metalnessMap,We.metalnessMapTransform)),We.roughness.value=ze.roughness,ze.roughnessMap&&(We.roughnessMap.value=ze.roughnessMap,c(ze.roughnessMap,We.roughnessMapTransform)),o.get(ze).envMap&&(We.envMapIntensity.value=ze.envMapIntensity)}(We,ze),ze.isMeshPhysicalMaterial&&function Le(We,ze,Mt){We.ior.value=ze.ior,ze.sheen>0&&(We.sheenColor.value.copy(ze.sheenColor).multiplyScalar(ze.sheen),We.sheenRoughness.value=ze.sheenRoughness,ze.sheenColorMap&&(We.sheenColorMap.value=ze.sheenColorMap,c(ze.sheenColorMap,We.sheenColorMapTransform)),ze.sheenRoughnessMap&&(We.sheenRoughnessMap.value=ze.sheenRoughnessMap,c(ze.sheenRoughnessMap,We.sheenRoughnessMapTransform))),ze.clearcoat>0&&(We.clearcoat.value=ze.clearcoat,We.clearcoatRoughness.value=ze.clearcoatRoughness,ze.clearcoatMap&&(We.clearcoatMap.value=ze.clearcoatMap,c(ze.clearcoatMap,We.clearcoatMapTransform)),ze.clearcoatRoughnessMap&&(We.clearcoatRoughnessMap.value=ze.clearcoatRoughnessMap,c(ze.clearcoatRoughnessMap,We.clearcoatRoughnessMapTransform)),ze.clearcoatNormalMap&&(We.clearcoatNormalMap.value=ze.clearcoatNormalMap,c(ze.clearcoatNormalMap,We.clearcoatNormalMapTransform),We.clearcoatNormalScale.value.copy(ze.clearcoatNormalScale),1===ze.side&&We.clearcoatNormalScale.value.negate())),ze.iridescence>0&&(We.iridescence.value=ze.iridescence,We.iridescenceIOR.value=ze.iridescenceIOR,We.iridescenceThicknessMinimum.value=ze.iridescenceThicknessRange[0],We.iridescenceThicknessMaximum.value=ze.iridescenceThicknessRange[1],ze.iridescenceMap&&(We.iridescenceMap.value=ze.iridescenceMap,c(ze.iridescenceMap,We.iridescenceMapTransform)),ze.iridescenceThicknessMap&&(We.iridescenceThicknessMap.value=ze.iridescenceThicknessMap,c(ze.iridescenceThicknessMap,We.iridescenceThicknessMapTransform))),ze.transmission>0&&(We.transmission.value=ze.transmission,We.transmissionSamplerMap.value=Mt.texture,We.transmissionSamplerSize.value.set(Mt.width,Mt.height),ze.transmissionMap&&(We.transmissionMap.value=ze.transmissionMap,c(ze.transmissionMap,We.transmissionMapTransform)),We.thickness.value=ze.thickness,ze.thicknessMap&&(We.thicknessMap.value=ze.thicknessMap,c(ze.thicknessMap,We.thicknessMapTransform)),We.attenuationDistance.value=ze.attenuationDistance,We.attenuationColor.value.copy(ze.attenuationColor)),ze.anisotropy>0&&(We.anisotropyVector.value.set(ze.anisotropy*Math.cos(ze.anisotropyRotation),ze.anisotropy*Math.sin(ze.anisotropyRotation)),ze.anisotropyMap&&(We.anisotropyMap.value=ze.anisotropyMap,c(ze.anisotropyMap,We.anisotropyMapTransform))),We.specularIntensity.value=ze.specularIntensity,We.specularColor.value.copy(ze.specularColor),ze.specularColorMap&&(We.specularColorMap.value=ze.specularColorMap,c(ze.specularColorMap,We.specularColorMapTransform)),ze.specularIntensityMap&&(We.specularIntensityMap.value=ze.specularIntensityMap,c(ze.specularIntensityMap,We.specularIntensityMapTransform))}(We,ze,Dt)):ze.isMeshMatcapMaterial?(M(We,ze),function Ke(We,ze){ze.matcap&&(We.matcap.value=ze.matcap)}(We,ze)):ze.isMeshDepthMaterial?M(We,ze):ze.isMeshDistanceMaterial?(M(We,ze),function ft(We,ze){const Mt=o.get(ze).light;We.referencePosition.value.setFromMatrixPosition(Mt.matrixWorld),We.nearDistance.value=Mt.shadow.camera.near,We.farDistance.value=Mt.shadow.camera.far}(We,ze)):ze.isMeshNormalMaterial?M(We,ze):ze.isLineBasicMaterial?(function N(We,ze){We.diffuse.value.copy(ze.color),We.opacity.value=ze.opacity,ze.map&&(We.map.value=ze.map,c(ze.map,We.mapTransform))}(We,ze),ze.isLineDashedMaterial&&function q(We,ze){We.dashSize.value=ze.dashSize,We.totalSize.value=ze.dashSize+ze.gapSize,We.scale.value=ze.scale}(We,ze)):ze.isPointsMaterial?function de(We,ze,Mt,ct){We.diffuse.value.copy(ze.color),We.opacity.value=ze.opacity,We.size.value=ze.size*Mt,We.scale.value=.5*ct,ze.map&&(We.map.value=ze.map,c(ze.map,We.uvTransform)),ze.alphaMap&&(We.alphaMap.value=ze.alphaMap,c(ze.alphaMap,We.alphaMapTransform)),ze.alphaTest>0&&(We.alphaTest.value=ze.alphaTest)}(We,ze,Mt,ct):ze.isSpriteMaterial?function pe(We,ze){We.diffuse.value.copy(ze.color),We.opacity.value=ze.opacity,We.rotation.value=ze.rotation,ze.map&&(We.map.value=ze.map,c(ze.map,We.mapTransform)),ze.alphaMap&&(We.alphaMap.value=ze.alphaMap,c(ze.alphaMap,We.alphaMapTransform)),ze.alphaTest>0&&(We.alphaTest.value=ze.alphaTest)}(We,ze):ze.isShadowMaterial?(We.color.value.copy(ze.color),We.opacity.value=ze.opacity):ze.isShaderMaterial&&(ze.uniformsNeedUpdate=!1)}}}function IB(w,o,c,h){let m={},M={},N=[];const q=c.isWebGL2?w.getParameter(w.MAX_UNIFORM_BUFFER_BINDINGS):0;function Le(Mt,ct,Dt){const Jt=Mt.value;if(void 0===Dt[ct]){if("number"==typeof Jt)Dt[ct]=Jt;else{const cn=Array.isArray(Jt)?Jt:[Jt],rn=[];for(let Rn=0;Rn<cn.length;Rn++)rn.push(cn[Rn].clone());Dt[ct]=rn}return!0}if("number"==typeof Jt){if(Dt[ct]!==Jt)return Dt[ct]=Jt,!0}else{const cn=Array.isArray(Dt[ct])?Dt[ct]:[Dt[ct]],rn=Array.isArray(Jt)?Jt:[Jt];for(let Rn=0;Rn<cn.length;Rn++){const kt=cn[Rn];if(!1===kt.equals(rn[Rn]))return kt.copy(rn[Rn]),!0}}return!1}function ft(Mt){const ct={boundary:0,storage:0};return"number"==typeof Mt?(ct.boundary=4,ct.storage=4):Mt.isVector2?(ct.boundary=8,ct.storage=8):Mt.isVector3||Mt.isColor?(ct.boundary=16,ct.storage=12):Mt.isVector4?(ct.boundary=16,ct.storage=16):Mt.isMatrix3?(ct.boundary=48,ct.storage=48):Mt.isMatrix4?(ct.boundary=64,ct.storage=64):Mt.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",Mt),ct}function We(Mt){const ct=Mt.target;ct.removeEventListener("dispose",We);const Dt=N.indexOf(ct.__bindingPointIndex);N.splice(Dt,1),w.deleteBuffer(m[ct.id]),delete m[ct.id],delete M[ct.id]}return{bind:function de(Mt,ct){h.uniformBlockBinding(Mt,ct.program)},update:function pe(Mt,ct){let Dt=m[Mt.id];void 0===Dt&&(function Ke(Mt){const ct=Mt.uniforms;let Dt=0;let cn=0;for(let rn=0,Rn=ct.length;rn<Rn;rn++){const kt=ct[rn],Zt={boundary:0,storage:0},li=Array.isArray(kt.value)?kt.value:[kt.value];for(let Ti=0,ur=li.length;Ti<ur;Ti++){const Di=ft(li[Ti]);Zt.boundary+=Di.boundary,Zt.storage+=Di.storage}kt.__data=new Float32Array(Zt.storage/Float32Array.BYTES_PER_ELEMENT),kt.__offset=Dt,rn>0&&(cn=Dt%16,0!==cn&&16-cn-Zt.boundary<0&&(Dt+=16-cn,kt.__offset=Dt)),Dt+=Zt.storage}cn=Dt%16,cn>0&&(Dt+=16-cn),Mt.__size=Dt,Mt.__cache={}}(Mt),Dt=function xe(Mt){const ct=function Ie(){for(let Mt=0;Mt<q;Mt++)if(-1===N.indexOf(Mt))return N.push(Mt),Mt;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();Mt.__bindingPointIndex=ct;const Dt=w.createBuffer(),Jt=Mt.__size,cn=Mt.usage;return w.bindBuffer(w.UNIFORM_BUFFER,Dt),w.bufferData(w.UNIFORM_BUFFER,Jt,cn),w.bindBuffer(w.UNIFORM_BUFFER,null),w.bindBufferBase(w.UNIFORM_BUFFER,ct,Dt),Dt}(Mt),m[Mt.id]=Dt,Mt.addEventListener("dispose",We)),h.updateUBOMapping(Mt,ct.program);const cn=o.render.frame;M[Mt.id]!==cn&&(function Be(Mt){const Dt=Mt.uniforms,Jt=Mt.__cache;w.bindBuffer(w.UNIFORM_BUFFER,m[Mt.id]);for(let cn=0,rn=Dt.length;cn<rn;cn++){const Rn=Dt[cn];if(!0===Le(Rn,cn,Jt)){const kt=Rn.__offset,Zt=Array.isArray(Rn.value)?Rn.value:[Rn.value];let li=0;for(let Ti=0;Ti<Zt.length;Ti++){const ur=Zt[Ti],Yn=ft(ur);"number"==typeof ur?(Rn.__data[0]=ur,w.bufferSubData(w.UNIFORM_BUFFER,kt+li,Rn.__data)):ur.isMatrix3?(Rn.__data[0]=ur.elements[0],Rn.__data[1]=ur.elements[1],Rn.__data[2]=ur.elements[2],Rn.__data[3]=ur.elements[0],Rn.__data[4]=ur.elements[3],Rn.__data[5]=ur.elements[4],Rn.__data[6]=ur.elements[5],Rn.__data[7]=ur.elements[0],Rn.__data[8]=ur.elements[6],Rn.__data[9]=ur.elements[7],Rn.__data[10]=ur.elements[8],Rn.__data[11]=ur.elements[0]):(ur.toArray(Rn.__data,li),li+=Yn.storage/Float32Array.BYTES_PER_ELEMENT)}w.bufferSubData(w.UNIFORM_BUFFER,kt,Rn.__data)}}w.bindBuffer(w.UNIFORM_BUFFER,null)}(Mt),M[Mt.id]=cn)},dispose:function ze(){for(const Mt in m)w.deleteBuffer(m[Mt]);N=[],m={},M={}}}}class BB{constructor(o={}){const{canvas:c=Tg(),context:h=null,depth:m=!0,stencil:M=!0,alpha:N=!1,antialias:q=!1,premultipliedAlpha:de=!0,preserveDrawingBuffer:pe=!1,powerPreference:xe="default",failIfMajorPerformanceCaveat:Ie=!1}=o;let Be;this.isWebGLRenderer=!0,Be=null!==h?h.getContextAttributes().alpha:N;const Le=new Uint32Array(4),Ke=new Int32Array(4);let ft=null,We=null;const ze=[],Mt=[];this.domElement=c,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=ll,this._useLegacyLights=!1,this.toneMapping=pt,this.toneMappingExposure=1;const ct=this;let Dt=!1,Jt=0,cn=0,rn=null,Rn=-1,kt=null;const Zt=new il,li=new il;let Ti=null;const ur=new Os(0);let Yn=0,Di=c.width,rr=c.height,Li=1,br=null,Ji=null;const lr=new il(0,0,Di,rr),ei=new il(0,0,Di,rr);let sr=!1;const as=new Jh;let xs=!1,Ds=!1,fs=null;const eo=new bo,er=new zi,Lr=new Ft,yr={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function vr(){return null===rn?Li:1}let si,Ri,Ii,es,Ur,fr,us,co,_s,$t,Pt,ni,cr,Ar,Br,ks,Ir,ts,Nn,Vr,xr,Oo,Ao,fo,_n=h;function Ki(An,yi){for(let ji=0;ji<An.length;ji++){const or=c.getContext(An[ji],yi);if(null!==or)return or}return null}try{const An={alpha:!0,depth:m,stencil:M,antialias:q,premultipliedAlpha:de,preserveDrawingBuffer:pe,powerPreference:xe,failIfMajorPerformanceCaveat:Ie};if("setAttribute"in c&&c.setAttribute("data-engine",`three.js r${x}`),c.addEventListener("webglcontextlost",_a,!1),c.addEventListener("webglcontextrestored",Kn,!1),c.addEventListener("webglcontextcreationerror",ys,!1),null===_n){const yi=["webgl2","webgl","experimental-webgl"];if(!0===ct.isWebGL1Renderer&&yi.shift(),_n=Ki(yi,An),null===_n)throw Ki(yi)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&_n instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===_n.getShaderPrecisionFormat&&(_n.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(An){throw console.error("THREE.WebGLRenderer: "+An.message),An}function to(){si=new ap(_n),Ri=new UA(_n,si,o),si.init(Ri),Oo=new Va(_n,si,Ri),Ii=new Qs(_n,si,Ri),es=new j(_n),Ur=new wl,fr=new Ma(_n,si,Ii,Ur,Ri,Oo,es),us=new op(ct),co=new _f(ct),_s=new Bp(_n,Ri),Ao=new U1(_n,si,_s,Ri),$t=new s0(_n,_s,es,Ao),Pt=new Bt(_n,$t,_s,es),Nn=new dt(_n,Ri,fr),ks=new xv(Ur),ni=new ao(ct,us,co,si,Ri,Ao,ks),cr=new Gx(ct,Ur),Ar=new iu,Br=new Xm(si,Ri),ts=new N1(ct,us,co,Ii,Pt,Be,de),Ir=new xf(ct,Pt,Ri),fo=new IB(_n,es,Ri,Ii),Vr=new z1(_n,si,es,Ri),xr=new ne(_n,si,es,Ri),es.programs=ni.programs,ct.capabilities=Ri,ct.extensions=si,ct.properties=Ur,ct.renderLists=Ar,ct.shadowMap=Ir,ct.state=Ii,ct.info=es}to();const Ps=new qA(ct,_n);function _a(An){An.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),Dt=!0}function Kn(){console.log("THREE.WebGLRenderer: Context Restored."),Dt=!1;const An=es.autoReset,yi=Ir.enabled,ji=Ir.autoUpdate,ir=Ir.needsUpdate,or=Ir.type;to(),es.autoReset=An,Ir.enabled=yi,Ir.autoUpdate=ji,Ir.needsUpdate=ir,Ir.type=or}function ys(An){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",An.statusMessage)}function jr(An){const yi=An.target;yi.removeEventListener("dispose",jr),function dr(An){(function ns(An){const yi=Ur.get(An).programs;void 0!==yi&&(yi.forEach(function(ji){ni.releaseProgram(ji)}),An.isShaderMaterial&&ni.releaseShaderCache(An))})(An),Ur.remove(An)}(yi)}function xo(An,yi,ji){!0===An.transparent&&An.side===Y&&!1===An.forceSinglePass?(An.side=1,An.needsUpdate=!0,HM(An,yi,ji),An.side=F,An.needsUpdate=!0,HM(An,yi,ji),An.side=Y):HM(An,yi,ji)}this.xr=Ps,this.getContext=function(){return _n},this.getContextAttributes=function(){return _n.getContextAttributes()},this.forceContextLoss=function(){const An=si.get("WEBGL_lose_context");An&&An.loseContext()},this.forceContextRestore=function(){const An=si.get("WEBGL_lose_context");An&&An.restoreContext()},this.getPixelRatio=function(){return Li},this.setPixelRatio=function(An){void 0!==An&&(Li=An,this.setSize(Di,rr,!1))},this.getSize=function(An){return An.set(Di,rr)},this.setSize=function(An,yi,ji=!0){Ps.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Di=An,rr=yi,c.width=Math.floor(An*Li),c.height=Math.floor(yi*Li),!0===ji&&(c.style.width=An+"px",c.style.height=yi+"px"),this.setViewport(0,0,An,yi))},this.getDrawingBufferSize=function(An){return An.set(Di*Li,rr*Li).floor()},this.setDrawingBufferSize=function(An,yi,ji){Di=An,rr=yi,Li=ji,c.width=Math.floor(An*ji),c.height=Math.floor(yi*ji),this.setViewport(0,0,An,yi)},this.getCurrentViewport=function(An){return An.copy(Zt)},this.getViewport=function(An){return An.copy(lr)},this.setViewport=function(An,yi,ji,ir){An.isVector4?lr.set(An.x,An.y,An.z,An.w):lr.set(An,yi,ji,ir),Ii.viewport(Zt.copy(lr).multiplyScalar(Li).floor())},this.getScissor=function(An){return An.copy(ei)},this.setScissor=function(An,yi,ji,ir){An.isVector4?ei.set(An.x,An.y,An.z,An.w):ei.set(An,yi,ji,ir),Ii.scissor(li.copy(ei).multiplyScalar(Li).floor())},this.getScissorTest=function(){return sr},this.setScissorTest=function(An){Ii.setScissorTest(sr=An)},this.setOpaqueSort=function(An){br=An},this.setTransparentSort=function(An){Ji=An},this.getClearColor=function(An){return An.copy(ts.getClearColor())},this.setClearColor=function(){ts.setClearColor.apply(ts,arguments)},this.getClearAlpha=function(){return ts.getClearAlpha()},this.setClearAlpha=function(){ts.setClearAlpha.apply(ts,arguments)},this.clear=function(An=!0,yi=!0,ji=!0){let ir=0;if(An){let or=!1;if(null!==rn){const js=rn.texture.format;or=1033===js||1031===js||1029===js}if(or){const js=rn.texture.type,Eo=js===At||js===kn||1012===js||js===Si||1017===js||1018===js,Jo=ts.getClearColor(),fa=ts.getClearAlpha(),Pa=Jo.r,ea=Jo.g,da=Jo.b;Eo?(Le[0]=Pa,Le[1]=ea,Le[2]=da,Le[3]=fa,_n.clearBufferuiv(_n.COLOR,0,Le)):(Ke[0]=Pa,Ke[1]=ea,Ke[2]=da,Ke[3]=fa,_n.clearBufferiv(_n.COLOR,0,Ke))}else ir|=_n.COLOR_BUFFER_BIT}yi&&(ir|=_n.DEPTH_BUFFER_BIT),ji&&(ir|=_n.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),_n.clear(ir)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){c.removeEventListener("webglcontextlost",_a,!1),c.removeEventListener("webglcontextrestored",Kn,!1),c.removeEventListener("webglcontextcreationerror",ys,!1),Ar.dispose(),Br.dispose(),Ur.dispose(),us.dispose(),co.dispose(),Pt.dispose(),Ao.dispose(),fo.dispose(),ni.dispose(),Ps.dispose(),Ps.removeEventListener("sessionstart",wf),Ps.removeEventListener("sessionend",Gl),fs&&(fs.dispose(),fs=null),qu.stop()},this.renderBufferDirect=function(An,yi,ji,ir,or,js){null===yi&&(yi=yr);const Eo=or.isMesh&&or.matrixWorld.determinant()<0,Jo=function DN(An,yi,ji,ir,or){!0!==yi.isScene&&(yi=yr),fr.resetTextureUnits();const js=yi.fog,Jo=null===rn?ct.outputColorSpace:!0===rn.isXRRenderTarget?rn.texture.colorSpace:sc,fa=(ir.isMeshStandardMaterial?co:us).get(ir.envMap||(ir.isMeshStandardMaterial?yi.environment:null)),Pa=!0===ir.vertexColors&&!!ji.attributes.color&&4===ji.attributes.color.itemSize,ea=!!ji.attributes.tangent&&(!!ir.normalMap||ir.anisotropy>0),da=!!ji.morphAttributes.position,rd=!!ji.morphAttributes.normal,fp=!!ji.morphAttributes.color;let zd=pt;ir.toneMapped&&(null===rn||!0===rn.isXRRenderTarget)&&(zd=ct.toneMapping);const ZA=ji.morphAttributes.position||ji.morphAttributes.normal||ji.morphAttributes.color,sd=void 0!==ZA?ZA.length:0,$a=Ur.get(ir),VM=We.state.lights;!0!==xs||!0!==Ds&&An===kt||ks.setState(ir,An,An===kt&&ir.id===Rn);let _d=!1;ir.version===$a.__version?($a.needsLights&&$a.lightsStateVersion!==VM.state.version||$a.outputColorSpace!==Jo||or.isInstancedMesh&&!1===$a.instancing||!or.isInstancedMesh&&!0===$a.instancing||or.isSkinnedMesh&&!1===$a.skinning||!or.isSkinnedMesh&&!0===$a.skinning||or.isInstancedMesh&&!0===$a.instancingColor&&null===or.instanceColor||or.isInstancedMesh&&!1===$a.instancingColor&&null!==or.instanceColor||$a.envMap!==fa||!0===ir.fog&&$a.fog!==js||void 0!==$a.numClippingPlanes&&($a.numClippingPlanes!==ks.numPlanes||$a.numIntersection!==ks.numIntersection)||$a.vertexAlphas!==Pa||$a.vertexTangents!==ea||$a.morphTargets!==da||$a.morphNormals!==rd||$a.morphColors!==fp||$a.toneMapping!==zd||!0===Ri.isWebGL2&&$a.morphTargetsCount!==sd)&&(_d=!0):(_d=!0,$a.__version=ir.version);let Jm=$a.currentProgram;!0===_d&&(Jm=HM(ir,yi,or));let GM=!1,cb=!1,bw=!1;const Oh=Jm.getUniforms(),m0=$a.uniforms;if(Ii.useProgram(Jm.program)&&(GM=!0,cb=!0,bw=!0),ir.id!==Rn&&(Rn=ir.id,cb=!0),GM||kt!==An){Oh.setValue(_n,"projectionMatrix",An.projectionMatrix),Oh.setValue(_n,"viewMatrix",An.matrixWorldInverse);const Cf=Oh.map.cameraPosition;void 0!==Cf&&Cf.setValue(_n,Lr.setFromMatrixPosition(An.matrixWorld)),Ri.logarithmicDepthBuffer&&Oh.setValue(_n,"logDepthBufFC",2/(Math.log(An.far+1)/Math.LN2)),(ir.isMeshPhongMaterial||ir.isMeshToonMaterial||ir.isMeshLambertMaterial||ir.isMeshBasicMaterial||ir.isMeshStandardMaterial||ir.isShaderMaterial)&&Oh.setValue(_n,"isOrthographic",!0===An.isOrthographicCamera),kt!==An&&(kt=An,cb=!0,bw=!0)}if(or.isSkinnedMesh){Oh.setOptional(_n,or,"bindMatrix"),Oh.setOptional(_n,or,"bindMatrixInverse");const Cf=or.skeleton;Cf&&(Ri.floatVertexTextures?(null===Cf.boneTexture&&Cf.computeBoneTexture(),Oh.setValue(_n,"boneTexture",Cf.boneTexture,fr),Oh.setValue(_n,"boneTextureSize",Cf.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const y3=ji.morphAttributes;if((void 0!==y3.position||void 0!==y3.normal||void 0!==y3.color&&!0===Ri.isWebGL2)&&Nn.update(or,ji,Jm),(cb||$a.receiveShadow!==or.receiveShadow)&&($a.receiveShadow=or.receiveShadow,Oh.setValue(_n,"receiveShadow",or.receiveShadow)),ir.isMeshGouraudMaterial&&null!==ir.envMap&&(m0.envMap.value=fa,m0.flipEnvMap.value=fa.isCubeTexture&&!1===fa.isRenderTargetTexture?-1:1),cb&&(Oh.setValue(_n,"toneMappingExposure",ct.toneMappingExposure),$a.needsLights&&function g3(An,yi){An.ambientLightColor.needsUpdate=yi,An.lightProbe.needsUpdate=yi,An.directionalLights.needsUpdate=yi,An.directionalLightShadows.needsUpdate=yi,An.pointLights.needsUpdate=yi,An.pointLightShadows.needsUpdate=yi,An.spotLights.needsUpdate=yi,An.spotLightShadows.needsUpdate=yi,An.rectAreaLights.needsUpdate=yi,An.hemisphereLights.needsUpdate=yi}(m0,bw),js&&!0===ir.fog&&cr.refreshFogUniforms(m0,js),cr.refreshMaterialUniforms(m0,ir,Li,rr,fs),Jp.upload(_n,CP($a),m0,fr)),ir.isShaderMaterial&&!0===ir.uniformsNeedUpdate&&(Jp.upload(_n,CP($a),m0,fr),ir.uniformsNeedUpdate=!1),ir.isSpriteMaterial&&Oh.setValue(_n,"center",or.center),Oh.setValue(_n,"modelViewMatrix",or.modelViewMatrix),Oh.setValue(_n,"normalMatrix",or.normalMatrix),Oh.setValue(_n,"modelMatrix",or.matrixWorld),ir.isShaderMaterial||ir.isRawShaderMaterial){const Cf=ir.uniformsGroups;for(let xw=0,Lo=Cf.length;xw<Lo;xw++)if(Ri.isWebGL2){const v3=Cf[xw];fo.update(v3,Jm),fo.bind(v3,Jm)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Jm}(An,yi,ji,ir,or);Ii.setMaterial(ir,Eo);let fa=ji.index,Pa=1;if(!0===ir.wireframe){if(fa=$t.getWireframeAttribute(ji),void 0===fa)return;Pa=2}const ea=ji.drawRange,da=ji.attributes.position;let rd=ea.start*Pa,fp=(ea.start+ea.count)*Pa;null!==js&&(rd=Math.max(rd,js.start*Pa),fp=Math.min(fp,(js.start+js.count)*Pa)),null!==fa?(rd=Math.max(rd,0),fp=Math.min(fp,fa.count)):null!=da&&(rd=Math.max(rd,0),fp=Math.min(fp,da.count));const zd=fp-rd;if(zd<0||zd===1/0)return;Ao.setup(or,ir,Jo,ji,fa);let ZA,sd=Vr;if(null!==fa&&(ZA=_s.get(fa),sd=xr,sd.setIndex(ZA)),or.isMesh)!0===ir.wireframe?(Ii.setLineWidth(ir.wireframeLinewidth*vr()),sd.setMode(_n.LINES)):sd.setMode(_n.TRIANGLES);else if(or.isLine){let $a=ir.linewidth;void 0===$a&&($a=1),Ii.setLineWidth($a*vr()),sd.setMode(or.isLineSegments?_n.LINES:or.isLineLoop?_n.LINE_LOOP:_n.LINE_STRIP)}else or.isPoints?sd.setMode(_n.POINTS):or.isSprite&&sd.setMode(_n.TRIANGLES);if(or.isInstancedMesh)sd.renderInstances(rd,zd,or.count);else if(ji.isInstancedBufferGeometry){const VM=Math.min(ji.instanceCount,void 0!==ji._maxInstanceCount?ji._maxInstanceCount:1/0);sd.renderInstances(rd,zd,VM)}else sd.render(rd,zd)},this.compile=function(An,yi,ji=null){null===ji&&(ji=An),We=Br.get(ji),We.init(),Mt.push(We),ji.traverseVisible(function(or){or.isLight&&or.layers.test(yi.layers)&&(We.pushLight(or),or.castShadow&&We.pushShadow(or))}),An!==ji&&An.traverseVisible(function(or){or.isLight&&or.layers.test(yi.layers)&&(We.pushLight(or),or.castShadow&&We.pushShadow(or))}),We.setupLights(ct._useLegacyLights);const ir=new Set;return An.traverse(function(or){const js=or.material;if(js)if(Array.isArray(js))for(let Eo=0;Eo<js.length;Eo++){const Jo=js[Eo];xo(Jo,ji,or),ir.add(Jo)}else xo(js,ji,or),ir.add(js)}),Mt.pop(),We=null,ir},this.compileAsync=function(An,yi,ji=null){const ir=this.compile(An,yi,ji);return new Promise(or=>{function js(){ir.forEach(function(Eo){Ur.get(Eo).currentProgram.isReady()&&ir.delete(Eo)}),0!==ir.size?setTimeout(js,10):or(An)}null!==si.get("KHR_parallel_shader_compile")?js():setTimeout(js,10)})};let Na=null;function wf(){qu.stop()}function Gl(){qu.start()}const qu=new bA;function Zm(An,yi,ji,ir){if(!1===An.visible)return;if(An.layers.test(yi.layers))if(An.isGroup)ji=An.renderOrder;else if(An.isLOD)!0===An.autoUpdate&&An.update(yi);else if(An.isLight)We.pushLight(An),An.castShadow&&We.pushShadow(An);else if(An.isSprite){if(!An.frustumCulled||as.intersectsSprite(An)){ir&&Lr.setFromMatrixPosition(An.matrixWorld).applyMatrix4(eo);const Eo=Pt.update(An),Jo=An.material;Jo.visible&&ft.push(An,Eo,Jo,ji,Lr.z,null)}}else if((An.isMesh||An.isLine||An.isPoints)&&(!An.frustumCulled||as.intersectsObject(An))){const Eo=Pt.update(An),Jo=An.material;if(ir&&(void 0!==An.boundingSphere?(null===An.boundingSphere&&An.computeBoundingSphere(),Lr.copy(An.boundingSphere.center)):(null===Eo.boundingSphere&&Eo.computeBoundingSphere(),Lr.copy(Eo.boundingSphere.center)),Lr.applyMatrix4(An.matrixWorld).applyMatrix4(eo)),Array.isArray(Jo)){const fa=Eo.groups;for(let Pa=0,ea=fa.length;Pa<ea;Pa++){const da=fa[Pa],rd=Jo[da.materialIndex];rd&&rd.visible&&ft.push(An,Eo,rd,ji,Lr.z,da)}}else Jo.visible&&ft.push(An,Eo,Jo,ji,Lr.z,null)}const js=An.children;for(let Eo=0,Jo=js.length;Eo<Jo;Eo++)Zm(js[Eo],yi,ji,ir)}function xP(An,yi,ji,ir){const or=An.opaque,js=An.transmissive,Eo=An.transparent;We.setupLightsView(ji),!0===xs&&ks.setGlobalState(ct.clippingPlanes,ji),js.length>0&&function TN(An,yi,ji,ir){if(null!==(!0===ji.isScene?ji.overrideMaterial:null))return;const js=Ri.isWebGL2;null===fs&&(fs=new Ou(1,1,{generateMipmaps:!0,type:si.has("EXT_color_buffer_half_float")?In:At,minFilter:ye,samples:js?4:0})),ct.getDrawingBufferSize(er),js?fs.setSize(er.x,er.y):fs.setSize(Yd(er.x),Yd(er.y));const Eo=ct.getRenderTarget();ct.setRenderTarget(fs),ct.getClearColor(ur),Yn=ct.getClearAlpha(),Yn<1&&ct.setClearColor(16777215,.5),ct.clear();const Jo=ct.toneMapping;ct.toneMapping=pt,zM(An,ji,ir),fr.updateMultisampleRenderTarget(fs),fr.updateRenderTargetMipmap(fs);let fa=!1;for(let Pa=0,ea=yi.length;Pa<ea;Pa++){const da=yi[Pa],rd=da.object,fp=da.geometry,zd=da.material,ZA=da.group;if(zd.side===Y&&rd.layers.test(ir.layers)){const sd=zd.side;zd.side=1,zd.needsUpdate=!0,wP(rd,ji,ir,fp,zd,ZA),zd.side=sd,zd.needsUpdate=!0,fa=!0}}!0===fa&&(fr.updateMultisampleRenderTarget(fs),fr.updateRenderTargetMipmap(fs)),ct.setRenderTarget(Eo),ct.setClearColor(ur,Yn),ct.toneMapping=Jo}(or,js,yi,ji),ir&&Ii.viewport(Zt.copy(ir)),or.length>0&&zM(or,yi,ji),js.length>0&&zM(js,yi,ji),Eo.length>0&&zM(Eo,yi,ji),Ii.buffers.depth.setTest(!0),Ii.buffers.depth.setMask(!0),Ii.buffers.color.setMask(!0),Ii.setPolygonOffset(!1)}function zM(An,yi,ji){const ir=!0===yi.isScene?yi.overrideMaterial:null;for(let or=0,js=An.length;or<js;or++){const Eo=An[or],Jo=Eo.object,fa=Eo.geometry,Pa=null===ir?Eo.material:ir,ea=Eo.group;Jo.layers.test(ji.layers)&&wP(Jo,yi,ji,fa,Pa,ea)}}function wP(An,yi,ji,ir,or,js){An.onBeforeRender(ct,yi,ji,ir,or,js),An.modelViewMatrix.multiplyMatrices(ji.matrixWorldInverse,An.matrixWorld),An.normalMatrix.getNormalMatrix(An.modelViewMatrix),or.onBeforeRender(ct,yi,ji,ir,An,js),!0===or.transparent&&or.side===Y&&!1===or.forceSinglePass?(or.side=1,or.needsUpdate=!0,ct.renderBufferDirect(ji,yi,ir,or,An,js),or.side=F,or.needsUpdate=!0,ct.renderBufferDirect(ji,yi,ir,or,An,js),or.side=Y):ct.renderBufferDirect(ji,yi,ir,or,An,js),An.onAfterRender(ct,yi,ji,ir,or,js)}function HM(An,yi,ji){!0!==yi.isScene&&(yi=yr);const ir=Ur.get(An),or=We.state.lights,Eo=or.state.version,Jo=ni.getParameters(An,or.state,We.state.shadowsArray,yi,ji),fa=ni.getProgramCacheKey(Jo);let Pa=ir.programs;ir.environment=An.isMeshStandardMaterial?yi.environment:null,ir.fog=yi.fog,ir.envMap=(An.isMeshStandardMaterial?co:us).get(An.envMap||ir.environment),void 0===Pa&&(An.addEventListener("dispose",jr),Pa=new Map,ir.programs=Pa);let ea=Pa.get(fa);if(void 0!==ea){if(ir.currentProgram===ea&&ir.lightsStateVersion===Eo)return MP(An,Jo),ea}else Jo.uniforms=ni.getUniforms(An),An.onBuild(ji,Jo,ct),An.onBeforeCompile(Jo,ct),ea=ni.acquireProgram(Jo,fa),Pa.set(fa,ea),ir.uniforms=Jo.uniforms;const da=ir.uniforms;return(!An.isShaderMaterial&&!An.isRawShaderMaterial||!0===An.clipping)&&(da.clippingPlanes=ks.uniform),MP(An,Jo),ir.needsLights=function _3(An){return An.isMeshLambertMaterial||An.isMeshToonMaterial||An.isMeshPhongMaterial||An.isMeshStandardMaterial||An.isShadowMaterial||An.isShaderMaterial&&!0===An.lights}(An),ir.lightsStateVersion=Eo,ir.needsLights&&(da.ambientLightColor.value=or.state.ambient,da.lightProbe.value=or.state.probe,da.directionalLights.value=or.state.directional,da.directionalLightShadows.value=or.state.directionalShadow,da.spotLights.value=or.state.spot,da.spotLightShadows.value=or.state.spotShadow,da.rectAreaLights.value=or.state.rectArea,da.ltc_1.value=or.state.rectAreaLTC1,da.ltc_2.value=or.state.rectAreaLTC2,da.pointLights.value=or.state.point,da.pointLightShadows.value=or.state.pointShadow,da.hemisphereLights.value=or.state.hemi,da.directionalShadowMap.value=or.state.directionalShadowMap,da.directionalShadowMatrix.value=or.state.directionalShadowMatrix,da.spotShadowMap.value=or.state.spotShadowMap,da.spotLightMatrix.value=or.state.spotLightMatrix,da.spotLightMap.value=or.state.spotLightMap,da.pointShadowMap.value=or.state.pointShadowMap,da.pointShadowMatrix.value=or.state.pointShadowMatrix),ir.currentProgram=ea,ir.uniformsList=null,ea}function CP(An){if(null===An.uniformsList){const yi=An.currentProgram.getUniforms();An.uniformsList=Jp.seqWithValue(yi.seq,An.uniforms)}return An.uniformsList}function MP(An,yi){const ji=Ur.get(An);ji.outputColorSpace=yi.outputColorSpace,ji.instancing=yi.instancing,ji.instancingColor=yi.instancingColor,ji.skinning=yi.skinning,ji.morphTargets=yi.morphTargets,ji.morphNormals=yi.morphNormals,ji.morphColors=yi.morphColors,ji.morphTargetsCount=yi.morphTargetsCount,ji.numClippingPlanes=yi.numClippingPlanes,ji.numIntersection=yi.numClipIntersection,ji.vertexAlphas=yi.vertexAlphas,ji.vertexTangents=yi.vertexTangents,ji.toneMapping=yi.toneMapping}qu.setAnimationLoop(function id(An){Na&&Na(An)}),typeof self<"u"&&qu.setContext(self),this.setAnimationLoop=function(An){Na=An,Ps.setAnimationLoop(An),null===An?qu.stop():qu.start()},Ps.addEventListener("sessionstart",wf),Ps.addEventListener("sessionend",Gl),this.render=function(An,yi){if(void 0===yi||!0===yi.isCamera){if(!0!==Dt){if(!0===An.matrixWorldAutoUpdate&&An.updateMatrixWorld(),null===yi.parent&&!0===yi.matrixWorldAutoUpdate&&yi.updateMatrixWorld(),!0===Ps.enabled&&!0===Ps.isPresenting&&(!0===Ps.cameraAutoUpdate&&Ps.updateCamera(yi),yi=Ps.getCamera()),!0===An.isScene&&An.onBeforeRender(ct,An,yi,rn),We=Br.get(An,Mt.length),We.init(),Mt.push(We),eo.multiplyMatrices(yi.projectionMatrix,yi.matrixWorldInverse),as.setFromProjectionMatrix(eo),Ds=this.localClippingEnabled,xs=ks.init(this.clippingPlanes,Ds),ft=Ar.get(An,ze.length),ft.init(),ze.push(ft),Zm(An,yi,0,ct.sortObjects),ft.finish(),!0===ct.sortObjects&&ft.sort(br,Ji),this.info.render.frame++,!0===xs&&ks.beginShadows(),Ir.render(We.state.shadowsArray,An,yi),!0===xs&&ks.endShadows(),!0===this.info.autoReset&&this.info.reset(),ts.render(ft,An),We.setupLights(ct._useLegacyLights),yi.isArrayCamera){const ir=yi.cameras;for(let or=0,js=ir.length;or<js;or++){const Eo=ir[or];xP(ft,An,Eo,Eo.viewport)}}else xP(ft,An,yi);null!==rn&&(fr.updateMultisampleRenderTarget(rn),fr.updateRenderTargetMipmap(rn)),!0===An.isScene&&An.onAfterRender(ct,An,yi),Ao.resetDefaultState(),Rn=-1,kt=null,Mt.pop(),We=Mt.length>0?Mt[Mt.length-1]:null,ze.pop(),ft=ze.length>0?ze[ze.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return Jt},this.getActiveMipmapLevel=function(){return cn},this.getRenderTarget=function(){return rn},this.setRenderTargetTextures=function(An,yi,ji){Ur.get(An.texture).__webglTexture=yi,Ur.get(An.depthTexture).__webglTexture=ji;const ir=Ur.get(An);ir.__hasExternalTextures=!0,ir.__hasExternalTextures&&(ir.__autoAllocateDepthBuffer=void 0===ji,ir.__autoAllocateDepthBuffer||!0===si.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ir.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(An,yi){const ji=Ur.get(An);ji.__webglFramebuffer=yi,ji.__useDefaultFramebuffer=void 0===yi},this.setRenderTarget=function(An,yi=0,ji=0){rn=An,Jt=yi,cn=ji;let ir=!0,or=null,js=!1,Eo=!1;if(An){const fa=Ur.get(An);void 0!==fa.__useDefaultFramebuffer?(Ii.bindFramebuffer(_n.FRAMEBUFFER,null),ir=!1):void 0===fa.__webglFramebuffer?fr.setupRenderTarget(An):fa.__hasExternalTextures&&fr.rebindTextures(An,Ur.get(An.texture).__webglTexture,Ur.get(An.depthTexture).__webglTexture);const Pa=An.texture;(Pa.isData3DTexture||Pa.isDataArrayTexture||Pa.isCompressedArrayTexture)&&(Eo=!0);const ea=Ur.get(An).__webglFramebuffer;An.isWebGLCubeRenderTarget?(or=Array.isArray(ea[yi])?ea[yi][ji]:ea[yi],js=!0):or=Ri.isWebGL2&&An.samples>0&&!1===fr.useMultisampledRTT(An)?Ur.get(An).__webglMultisampledFramebuffer:Array.isArray(ea)?ea[ji]:ea,Zt.copy(An.viewport),li.copy(An.scissor),Ti=An.scissorTest}else Zt.copy(lr).multiplyScalar(Li).floor(),li.copy(ei).multiplyScalar(Li).floor(),Ti=sr;if(Ii.bindFramebuffer(_n.FRAMEBUFFER,or)&&Ri.drawBuffers&&ir&&Ii.drawBuffers(An,or),Ii.viewport(Zt),Ii.scissor(li),Ii.setScissorTest(Ti),js){const fa=Ur.get(An.texture);_n.framebufferTexture2D(_n.FRAMEBUFFER,_n.COLOR_ATTACHMENT0,_n.TEXTURE_CUBE_MAP_POSITIVE_X+yi,fa.__webglTexture,ji)}else if(Eo){const fa=Ur.get(An.texture);_n.framebufferTextureLayer(_n.FRAMEBUFFER,_n.COLOR_ATTACHMENT0,fa.__webglTexture,ji||0,yi||0)}Rn=-1},this.readRenderTargetPixels=function(An,yi,ji,ir,or,js,Eo){if(!An||!An.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Jo=Ur.get(An).__webglFramebuffer;if(An.isWebGLCubeRenderTarget&&void 0!==Eo&&(Jo=Jo[Eo]),Jo){Ii.bindFramebuffer(_n.FRAMEBUFFER,Jo);try{const fa=An.texture,Pa=fa.format,ea=fa.type;if(Pa!==Jn&&Oo.convert(Pa)!==_n.getParameter(_n.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const da=ea===In&&(si.has("EXT_color_buffer_half_float")||Ri.isWebGL2&&si.has("EXT_color_buffer_float"));if(!(ea===At||Oo.convert(ea)===_n.getParameter(_n.IMPLEMENTATION_COLOR_READ_TYPE)||ea===dn&&(Ri.isWebGL2||si.has("OES_texture_float")||si.has("WEBGL_color_buffer_float"))||da))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");yi>=0&&yi<=An.width-ir&&ji>=0&&ji<=An.height-or&&_n.readPixels(yi,ji,ir,or,Oo.convert(Pa),Oo.convert(ea),js)}finally{const fa=null!==rn?Ur.get(rn).__webglFramebuffer:null;Ii.bindFramebuffer(_n.FRAMEBUFFER,fa)}}},this.copyFramebufferToTexture=function(An,yi,ji=0){const ir=Math.pow(2,-ji),or=Math.floor(yi.image.width*ir),js=Math.floor(yi.image.height*ir);fr.setTexture2D(yi,0),_n.copyTexSubImage2D(_n.TEXTURE_2D,ji,0,0,An.x,An.y,or,js),Ii.unbindTexture()},this.copyTextureToTexture=function(An,yi,ji,ir=0){const or=yi.image.width,js=yi.image.height,Eo=Oo.convert(ji.format),Jo=Oo.convert(ji.type);fr.setTexture2D(ji,0),_n.pixelStorei(_n.UNPACK_FLIP_Y_WEBGL,ji.flipY),_n.pixelStorei(_n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ji.premultiplyAlpha),_n.pixelStorei(_n.UNPACK_ALIGNMENT,ji.unpackAlignment),yi.isDataTexture?_n.texSubImage2D(_n.TEXTURE_2D,ir,An.x,An.y,or,js,Eo,Jo,yi.image.data):yi.isCompressedTexture?_n.compressedTexSubImage2D(_n.TEXTURE_2D,ir,An.x,An.y,yi.mipmaps[0].width,yi.mipmaps[0].height,Eo,yi.mipmaps[0].data):_n.texSubImage2D(_n.TEXTURE_2D,ir,An.x,An.y,Eo,Jo,yi.image),0===ir&&ji.generateMipmaps&&_n.generateMipmap(_n.TEXTURE_2D),Ii.unbindTexture()},this.copyTextureToTexture3D=function(An,yi,ji,ir,or=0){if(ct.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const js=An.max.x-An.min.x+1,Eo=An.max.y-An.min.y+1,Jo=An.max.z-An.min.z+1,fa=Oo.convert(ir.format),Pa=Oo.convert(ir.type);let ea;if(ir.isData3DTexture)fr.setTexture3D(ir,0),ea=_n.TEXTURE_3D;else{if(!ir.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");fr.setTexture2DArray(ir,0),ea=_n.TEXTURE_2D_ARRAY}_n.pixelStorei(_n.UNPACK_FLIP_Y_WEBGL,ir.flipY),_n.pixelStorei(_n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ir.premultiplyAlpha),_n.pixelStorei(_n.UNPACK_ALIGNMENT,ir.unpackAlignment);const da=_n.getParameter(_n.UNPACK_ROW_LENGTH),rd=_n.getParameter(_n.UNPACK_IMAGE_HEIGHT),fp=_n.getParameter(_n.UNPACK_SKIP_PIXELS),zd=_n.getParameter(_n.UNPACK_SKIP_ROWS),ZA=_n.getParameter(_n.UNPACK_SKIP_IMAGES),sd=ji.isCompressedTexture?ji.mipmaps[0]:ji.image;_n.pixelStorei(_n.UNPACK_ROW_LENGTH,sd.width),_n.pixelStorei(_n.UNPACK_IMAGE_HEIGHT,sd.height),_n.pixelStorei(_n.UNPACK_SKIP_PIXELS,An.min.x),_n.pixelStorei(_n.UNPACK_SKIP_ROWS,An.min.y),_n.pixelStorei(_n.UNPACK_SKIP_IMAGES,An.min.z),ji.isDataTexture||ji.isData3DTexture?_n.texSubImage3D(ea,or,yi.x,yi.y,yi.z,js,Eo,Jo,fa,Pa,sd.data):ji.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),_n.compressedTexSubImage3D(ea,or,yi.x,yi.y,yi.z,js,Eo,Jo,fa,sd.data)):_n.texSubImage3D(ea,or,yi.x,yi.y,yi.z,js,Eo,Jo,fa,Pa,sd),_n.pixelStorei(_n.UNPACK_ROW_LENGTH,da),_n.pixelStorei(_n.UNPACK_IMAGE_HEIGHT,rd),_n.pixelStorei(_n.UNPACK_SKIP_PIXELS,fp),_n.pixelStorei(_n.UNPACK_SKIP_ROWS,zd),_n.pixelStorei(_n.UNPACK_SKIP_IMAGES,ZA),0===or&&ir.generateMipmaps&&_n.generateMipmap(ea),Ii.unbindTexture()},this.initTexture=function(An){An.isCubeTexture?fr.setTextureCube(An,0):An.isData3DTexture?fr.setTexture3D(An,0):An.isDataArrayTexture||An.isCompressedArrayTexture?fr.setTexture2DArray(An,0):fr.setTexture2D(An,0),Ii.unbindTexture()},this.resetState=function(){Jt=0,cn=0,rn=null,Ii.reset(),Ao.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Dd}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(o){this._outputColorSpace=o;const c=this.getContext();c.drawingBufferColorSpace=o===Ju?"display-p3":"srgb",c.unpackColorSpace=Ya.workingColorSpace===eh?"display-p3":"srgb"}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(o){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!o}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===ll?$l:3e3}set outputEncoding(o){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=o===$l?ll:sc}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(o){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=o}}class qx{constructor(o,c=1,h=1e3){this.isFog=!0,this.name="",this.color=new Os(o),this.near=c,this.far=h}clone(){return new qx(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class WC extends Rl{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(o,c){return super.copy(o,c),null!==o.background&&(this.background=o.background.clone()),null!==o.environment&&(this.environment=o.environment.clone()),null!==o.fog&&(this.fog=o.fog.clone()),this.backgroundBlurriness=o.backgroundBlurriness,this.backgroundIntensity=o.backgroundIntensity,null!==o.overrideMaterial&&(this.overrideMaterial=o.overrideMaterial.clone()),this.matrixAutoUpdate=o.matrixAutoUpdate,this}toJSON(o){const c=super.toJSON(o);return null!==this.fog&&(c.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(c.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(c.object.backgroundIntensity=this.backgroundIntensity),c}}class Tv extends sa{constructor(o,c,h,m=1){super(o,c,h),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=m}copy(o){return super.copy(o),this.meshPerAttribute=o.meshPerAttribute,this}toJSON(){const o=super.toJSON();return o.meshPerAttribute=this.meshPerAttribute,o.isInstancedBufferAttribute=!0,o}}const Q1=new bo,cT=new bo,Qx=[],Dv=new rl,QA=new bo,WA=new Jc,W1=new Kd;class jC extends Jc{constructor(o,c,h){super(o,c),this.isInstancedMesh=!0,this.instanceMatrix=new Tv(new Float32Array(16*h),16),this.instanceColor=null,this.count=h,this.boundingBox=null,this.boundingSphere=null;for(let m=0;m<h;m++)this.setMatrixAt(m,QA)}computeBoundingBox(){const o=this.geometry,c=this.count;null===this.boundingBox&&(this.boundingBox=new rl),null===o.boundingBox&&o.computeBoundingBox(),this.boundingBox.makeEmpty();for(let h=0;h<c;h++)this.getMatrixAt(h,Q1),Dv.copy(o.boundingBox).applyMatrix4(Q1),this.boundingBox.union(Dv)}computeBoundingSphere(){const o=this.geometry,c=this.count;null===this.boundingSphere&&(this.boundingSphere=new Kd),null===o.boundingSphere&&o.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let h=0;h<c;h++)this.getMatrixAt(h,Q1),W1.copy(o.boundingSphere).applyMatrix4(Q1),this.boundingSphere.union(W1)}copy(o,c){return super.copy(o,c),this.instanceMatrix.copy(o.instanceMatrix),null!==o.instanceColor&&(this.instanceColor=o.instanceColor.clone()),this.count=o.count,null!==o.boundingBox&&(this.boundingBox=o.boundingBox.clone()),null!==o.boundingSphere&&(this.boundingSphere=o.boundingSphere.clone()),this}getColorAt(o,c){c.fromArray(this.instanceColor.array,3*o)}getMatrixAt(o,c){c.fromArray(this.instanceMatrix.array,16*o)}raycast(o,c){const h=this.matrixWorld,m=this.count;if(WA.geometry=this.geometry,WA.material=this.material,void 0!==WA.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),W1.copy(this.boundingSphere),W1.applyMatrix4(h),!1!==o.ray.intersectsSphere(W1)))for(let M=0;M<m;M++){this.getMatrixAt(M,Q1),cT.multiplyMatrices(h,Q1),WA.matrixWorld=cT,WA.raycast(o,Qx);for(let N=0,q=Qx.length;N<q;N++){const de=Qx[N];de.instanceId=M,de.object=this,c.push(de)}Qx.length=0}}setColorAt(o,c){null===this.instanceColor&&(this.instanceColor=new Tv(new Float32Array(3*this.instanceMatrix.count),3)),c.toArray(this.instanceColor.array,3*o)}setMatrixAt(o,c){c.toArray(this.instanceMatrix.array,16*o)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class j1 extends kc{constructor(o){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Os(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(o)}copy(o){return super.copy(o),this.color.copy(o.color),this.map=o.map,this.linewidth=o.linewidth,this.linecap=o.linecap,this.linejoin=o.linejoin,this.fog=o.fog,this}}const PB=new Ft,RB=new Ft,kB=new bo,Iv=new lf,$1=new Kd;class $C extends Rl{constructor(o=new Cs,c=new j1){super(),this.isLine=!0,this.type="Line",this.geometry=o,this.material=c,this.updateMorphTargets()}copy(o,c){return super.copy(o,c),this.material=Array.isArray(o.material)?o.material.slice():o.material,this.geometry=o.geometry,this}computeLineDistances(){const o=this.geometry;if(null===o.index){const c=o.attributes.position,h=[0];for(let m=1,M=c.count;m<M;m++)PB.fromBufferAttribute(c,m-1),RB.fromBufferAttribute(c,m),h[m]=h[m-1],h[m]+=PB.distanceTo(RB);o.setAttribute("lineDistance",new Bo(h,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(o,c){const h=this.geometry,m=this.matrixWorld,M=o.params.Line.threshold,N=h.drawRange;if(null===h.boundingSphere&&h.computeBoundingSphere(),$1.copy(h.boundingSphere),$1.applyMatrix4(m),$1.radius+=M,!1===o.ray.intersectsSphere($1))return;kB.copy(m).invert(),Iv.copy(o.ray).applyMatrix4(kB);const q=M/((this.scale.x+this.scale.y+this.scale.z)/3),de=q*q,pe=new Ft,xe=new Ft,Ie=new Ft,Be=new Ft,Le=this.isLineSegments?2:1,Ke=h.index,We=h.attributes.position;if(null!==Ke)for(let ct=Math.max(0,N.start),Dt=Math.min(Ke.count,N.start+N.count)-1;ct<Dt;ct+=Le){const Jt=Ke.getX(ct),cn=Ke.getX(ct+1);if(pe.fromBufferAttribute(We,Jt),xe.fromBufferAttribute(We,cn),Iv.distanceSqToSegment(pe,xe,Be,Ie)>de)continue;Be.applyMatrix4(this.matrixWorld);const Rn=o.ray.origin.distanceTo(Be);Rn<o.near||Rn>o.far||c.push({distance:Rn,point:Ie.clone().applyMatrix4(this.matrixWorld),index:ct,face:null,faceIndex:null,object:this})}else for(let ct=Math.max(0,N.start),Dt=Math.min(We.count,N.start+N.count)-1;ct<Dt;ct+=Le){if(pe.fromBufferAttribute(We,ct),xe.fromBufferAttribute(We,ct+1),Iv.distanceSqToSegment(pe,xe,Be,Ie)>de)continue;Be.applyMatrix4(this.matrixWorld);const cn=o.ray.origin.distanceTo(Be);cn<o.near||cn>o.far||c.push({distance:cn,point:Ie.clone().applyMatrix4(this.matrixWorld),index:ct,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const c=this.geometry.morphAttributes,h=Object.keys(c);if(h.length>0){const m=c[h[0]];if(void 0!==m){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let M=0,N=m.length;M<N;M++){const q=m[M].name||String(M);this.morphTargetInfluences.push(0),this.morphTargetDictionary[q]=M}}}}}const FB=new Ft,XC=new Ft;class dT extends $C{constructor(o,c){super(o,c),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const o=this.geometry;if(null===o.index){const c=o.attributes.position,h=[];for(let m=0,M=c.count;m<M;m+=2)FB.fromBufferAttribute(c,m),XC.fromBufferAttribute(c,m+1),h[m]=0===m?0:h[m-1],h[m+1]=h[m]+FB.distanceTo(XC);o.setAttribute("lineDistance",new Bo(h,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class YC extends kc{constructor(o){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Os(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(o)}copy(o){return super.copy(o),this.color.copy(o.color),this.map=o.map,this.alphaMap=o.alphaMap,this.size=o.size,this.sizeAttenuation=o.sizeAttenuation,this.fog=o.fog,this}}const uT=new bo,KC=new lf,Bv=new Kd,Pv=new Ft;class hT extends Rl{constructor(o=new Cs,c=new YC){super(),this.isPoints=!0,this.type="Points",this.geometry=o,this.material=c,this.updateMorphTargets()}copy(o,c){return super.copy(o,c),this.material=Array.isArray(o.material)?o.material.slice():o.material,this.geometry=o.geometry,this}raycast(o,c){const h=this.geometry,m=this.matrixWorld,M=o.params.Points.threshold,N=h.drawRange;if(null===h.boundingSphere&&h.computeBoundingSphere(),Bv.copy(h.boundingSphere),Bv.applyMatrix4(m),Bv.radius+=M,!1===o.ray.intersectsSphere(Bv))return;uT.copy(m).invert(),KC.copy(o.ray).applyMatrix4(uT);const q=M/((this.scale.x+this.scale.y+this.scale.z)/3),de=q*q,pe=h.index,Ie=h.attributes.position;if(null!==pe)for(let Ke=Math.max(0,N.start),ft=Math.min(pe.count,N.start+N.count);Ke<ft;Ke++){const We=pe.getX(Ke);Pv.fromBufferAttribute(Ie,We),fT(Pv,We,de,m,o,c,this)}else for(let Ke=Math.max(0,N.start),ft=Math.min(Ie.count,N.start+N.count);Ke<ft;Ke++)Pv.fromBufferAttribute(Ie,Ke),fT(Pv,Ke,de,m,o,c,this)}updateMorphTargets(){const c=this.geometry.morphAttributes,h=Object.keys(c);if(h.length>0){const m=c[h[0]];if(void 0!==m){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let M=0,N=m.length;M<N;M++){const q=m[M].name||String(M);this.morphTargetInfluences.push(0),this.morphTargetDictionary[q]=M}}}}}function fT(w,o,c,h,m,M,N){const q=KC.distanceSqToPoint(w);if(q<c){const de=new Ft;KC.closestPointToPoint(w,de),de.applyMatrix4(h);const pe=m.ray.origin.distanceTo(de);if(pe<m.near||pe>m.far)return;M.push({distance:pe,distanceToRay:Math.sqrt(q),point:de,index:o,face:null,object:N})}}class Wx extends bu{constructor(o,c,h,m,M,N,q,de,pe){super(o,c,h,m,M,N,q,de,pe),this.isCanvasTexture=!0,this.needsUpdate=!0}}class tm{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(o,c){const h=this.getUtoTmapping(o);return this.getPoint(h,c)}getPoints(o=5){const c=[];for(let h=0;h<=o;h++)c.push(this.getPoint(h/o));return c}getSpacedPoints(o=5){const c=[];for(let h=0;h<=o;h++)c.push(this.getPointAt(h/o));return c}getLength(){const o=this.getLengths();return o[o.length-1]}getLengths(o=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===o+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const c=[];let h,m=this.getPoint(0),M=0;c.push(0);for(let N=1;N<=o;N++)h=this.getPoint(N/o),M+=h.distanceTo(m),c.push(M),m=h;return this.cacheArcLengths=c,c}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(o,c){const h=this.getLengths();let m=0;const M=h.length;let N;N=c||o*h[M-1];let pe,q=0,de=M-1;for(;q<=de;)if(m=Math.floor(q+(de-q)/2),pe=h[m]-N,pe<0)q=m+1;else{if(!(pe>0)){de=m;break}de=m-1}if(m=de,h[m]===N)return m/(M-1);const xe=h[m];return(m+(N-xe)/(h[m+1]-xe))/(M-1)}getTangent(o,c){let m=o-1e-4,M=o+1e-4;m<0&&(m=0),M>1&&(M=1);const N=this.getPoint(m),q=this.getPoint(M),de=c||(N.isVector2?new zi:new Ft);return de.copy(q).sub(N).normalize(),de}getTangentAt(o,c){const h=this.getUtoTmapping(o);return this.getTangent(h,c)}computeFrenetFrames(o,c){const h=new Ft,m=[],M=[],N=[],q=new Ft,de=new bo;for(let Le=0;Le<=o;Le++)m[Le]=this.getTangentAt(Le/o,new Ft);M[0]=new Ft,N[0]=new Ft;let pe=Number.MAX_VALUE;const xe=Math.abs(m[0].x),Ie=Math.abs(m[0].y),Be=Math.abs(m[0].z);xe<=pe&&(pe=xe,h.set(1,0,0)),Ie<=pe&&(pe=Ie,h.set(0,1,0)),Be<=pe&&h.set(0,0,1),q.crossVectors(m[0],h).normalize(),M[0].crossVectors(m[0],q),N[0].crossVectors(m[0],M[0]);for(let Le=1;Le<=o;Le++){if(M[Le]=M[Le-1].clone(),N[Le]=N[Le-1].clone(),q.crossVectors(m[Le-1],m[Le]),q.length()>Number.EPSILON){q.normalize();const Ke=Math.acos(nl(m[Le-1].dot(m[Le]),-1,1));M[Le].applyMatrix4(de.makeRotationAxis(q,Ke))}N[Le].crossVectors(m[Le],M[Le])}if(!0===c){let Le=Math.acos(nl(M[0].dot(M[o]),-1,1));Le/=o,m[0].dot(q.crossVectors(M[0],M[o]))>0&&(Le=-Le);for(let Ke=1;Ke<=o;Ke++)M[Ke].applyMatrix4(de.makeRotationAxis(m[Ke],Le*Ke)),N[Ke].crossVectors(m[Ke],M[Ke])}return{tangents:m,normals:M,binormals:N}}clone(){return(new this.constructor).copy(this)}copy(o){return this.arcLengthDivisions=o.arcLengthDivisions,this}toJSON(){const o={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return o.arcLengthDivisions=this.arcLengthDivisions,o.type=this.type,o}fromJSON(o){return this.arcLengthDivisions=o.arcLengthDivisions,this}}class Rv extends tm{constructor(o=0,c=0,h=1,m=1,M=0,N=2*Math.PI,q=!1,de=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=o,this.aY=c,this.xRadius=h,this.yRadius=m,this.aStartAngle=M,this.aEndAngle=N,this.aClockwise=q,this.aRotation=de}getPoint(o,c){const h=c||new zi,m=2*Math.PI;let M=this.aEndAngle-this.aStartAngle;const N=Math.abs(M)<Number.EPSILON;for(;M<0;)M+=m;for(;M>m;)M-=m;M<Number.EPSILON&&(M=N?0:m),!0===this.aClockwise&&!N&&(M===m?M=-m:M-=m);const q=this.aStartAngle+o*M;let de=this.aX+this.xRadius*Math.cos(q),pe=this.aY+this.yRadius*Math.sin(q);if(0!==this.aRotation){const xe=Math.cos(this.aRotation),Ie=Math.sin(this.aRotation),Be=de-this.aX,Le=pe-this.aY;de=Be*xe-Le*Ie+this.aX,pe=Be*Ie+Le*xe+this.aY}return h.set(de,pe)}copy(o){return super.copy(o),this.aX=o.aX,this.aY=o.aY,this.xRadius=o.xRadius,this.yRadius=o.yRadius,this.aStartAngle=o.aStartAngle,this.aEndAngle=o.aEndAngle,this.aClockwise=o.aClockwise,this.aRotation=o.aRotation,this}toJSON(){const o=super.toJSON();return o.aX=this.aX,o.aY=this.aY,o.xRadius=this.xRadius,o.yRadius=this.yRadius,o.aStartAngle=this.aStartAngle,o.aEndAngle=this.aEndAngle,o.aClockwise=this.aClockwise,o.aRotation=this.aRotation,o}fromJSON(o){return super.fromJSON(o),this.aX=o.aX,this.aY=o.aY,this.xRadius=o.xRadius,this.yRadius=o.yRadius,this.aStartAngle=o.aStartAngle,this.aEndAngle=o.aEndAngle,this.aClockwise=o.aClockwise,this.aRotation=o.aRotation,this}}function Nd(){let w=0,o=0,c=0,h=0;function m(M,N,q,de){w=M,o=q,c=-3*M+3*N-2*q-de,h=2*M-2*N+q+de}return{initCatmullRom:function(M,N,q,de,pe){m(N,q,pe*(q-M),pe*(de-N))},initNonuniformCatmullRom:function(M,N,q,de,pe,xe,Ie){let Be=(N-M)/pe-(q-M)/(pe+xe)+(q-N)/xe,Le=(q-N)/xe-(de-N)/(xe+Ie)+(de-q)/Ie;Be*=xe,Le*=xe,m(N,q,Be,Le)},calc:function(M){const N=M*M;return w+o*M+c*N+h*(N*M)}}}const jx=new Ft,ZC=new Nd,Y1=new Nd,$x=new Nd;function pT(w,o,c,h,m){const M=.5*(h-o),N=.5*(m-c),q=w*w;return(2*c-2*h+M+N)*(w*q)+(-3*c+3*h-2*M-N)*q+M*w+c}function Xx(w,o,c,h){return function UB(w,o){const c=1-w;return c*c*o}(w,o)+function zB(w,o){return 2*(1-w)*w*o}(w,c)+function mT(w,o){return w*w*o}(w,h)}function Fv(w,o,c,h,m){return function pN(w,o){const c=1-w;return c*c*c*o}(w,o)+function kv(w,o){const c=1-w;return 3*c*c*w*o}(w,c)+function HB(w,o){return 3*(1-w)*w*w*o}(w,h)+function VB(w,o){return w*w*w*o}(w,m)}class JC extends tm{constructor(o=new zi,c=new zi,h=new zi,m=new zi){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=o,this.v1=c,this.v2=h,this.v3=m}getPoint(o,c=new zi){const h=c,m=this.v0,M=this.v1,N=this.v2,q=this.v3;return h.set(Fv(o,m.x,M.x,N.x,q.x),Fv(o,m.y,M.y,N.y,q.y)),h}copy(o){return super.copy(o),this.v0.copy(o.v0),this.v1.copy(o.v1),this.v2.copy(o.v2),this.v3.copy(o.v3),this}toJSON(){const o=super.toJSON();return o.v0=this.v0.toArray(),o.v1=this.v1.toArray(),o.v2=this.v2.toArray(),o.v3=this.v3.toArray(),o}fromJSON(o){return super.fromJSON(o),this.v0.fromArray(o.v0),this.v1.fromArray(o.v1),this.v2.fromArray(o.v2),this.v3.fromArray(o.v3),this}}class AT extends tm{constructor(o=new zi,c=new zi){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=o,this.v2=c}getPoint(o,c=new zi){const h=c;return 1===o?h.copy(this.v2):(h.copy(this.v2).sub(this.v1),h.multiplyScalar(o).add(this.v1)),h}getPointAt(o,c){return this.getPoint(o,c)}getTangent(o,c=new zi){return c.subVectors(this.v2,this.v1).normalize()}getTangentAt(o,c){return this.getTangent(o,c)}copy(o){return super.copy(o),this.v1.copy(o.v1),this.v2.copy(o.v2),this}toJSON(){const o=super.toJSON();return o.v1=this.v1.toArray(),o.v2=this.v2.toArray(),o}fromJSON(o){return super.fromJSON(o),this.v1.fromArray(o.v1),this.v2.fromArray(o.v2),this}}class gT extends tm{constructor(o=new zi,c=new zi,h=new zi){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=o,this.v1=c,this.v2=h}getPoint(o,c=new zi){const h=c,m=this.v0,M=this.v1,N=this.v2;return h.set(Xx(o,m.x,M.x,N.x),Xx(o,m.y,M.y,N.y)),h}copy(o){return super.copy(o),this.v0.copy(o.v0),this.v1.copy(o.v1),this.v2.copy(o.v2),this}toJSON(){const o=super.toJSON();return o.v0=this.v0.toArray(),o.v1=this.v1.toArray(),o.v2=this.v2.toArray(),o}fromJSON(o){return super.fromJSON(o),this.v0.fromArray(o.v0),this.v1.fromArray(o.v1),this.v2.fromArray(o.v2),this}}class yT extends tm{constructor(o=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=o}getPoint(o,c=new zi){const h=c,m=this.points,M=(m.length-1)*o,N=Math.floor(M),q=M-N,de=m[0===N?N:N-1],pe=m[N],xe=m[N>m.length-2?m.length-1:N+1],Ie=m[N>m.length-3?m.length-1:N+2];return h.set(pT(q,de.x,pe.x,xe.x,Ie.x),pT(q,de.y,pe.y,xe.y,Ie.y)),h}copy(o){super.copy(o),this.points=[];for(let c=0,h=o.points.length;c<h;c++)this.points.push(o.points[c].clone());return this}toJSON(){const o=super.toJSON();o.points=[];for(let c=0,h=this.points.length;c<h;c++)o.points.push(this.points[c].toArray());return o}fromJSON(o){super.fromJSON(o),this.points=[];for(let c=0,h=o.points.length;c<h;c++){const m=o.points[c];this.points.push((new zi).fromArray(m))}return this}}var K1=Object.freeze({__proto__:null,ArcCurve:class LB extends Rv{constructor(o,c,h,m,M,N){super(o,c,h,h,m,M,N),this.isArcCurve=!0,this.type="ArcCurve"}},CatmullRomCurve3:class NB extends tm{constructor(o=[],c=!1,h="centripetal",m=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=o,this.closed=c,this.curveType=h,this.tension=m}getPoint(o,c=new Ft){const h=c,m=this.points,M=m.length,N=(M-(this.closed?0:1))*o;let pe,xe,q=Math.floor(N),de=N-q;this.closed?q+=q>0?0:(Math.floor(Math.abs(q)/M)+1)*M:0===de&&q===M-1&&(q=M-2,de=1),this.closed||q>0?pe=m[(q-1)%M]:(jx.subVectors(m[0],m[1]).add(m[0]),pe=jx);const Ie=m[q%M],Be=m[(q+1)%M];if(this.closed||q+2<M?xe=m[(q+2)%M]:(jx.subVectors(m[M-1],m[M-2]).add(m[M-1]),xe=jx),"centripetal"===this.curveType||"chordal"===this.curveType){const Le="chordal"===this.curveType?.5:.25;let Ke=Math.pow(pe.distanceToSquared(Ie),Le),ft=Math.pow(Ie.distanceToSquared(Be),Le),We=Math.pow(Be.distanceToSquared(xe),Le);ft<1e-4&&(ft=1),Ke<1e-4&&(Ke=ft),We<1e-4&&(We=ft),ZC.initNonuniformCatmullRom(pe.x,Ie.x,Be.x,xe.x,Ke,ft,We),Y1.initNonuniformCatmullRom(pe.y,Ie.y,Be.y,xe.y,Ke,ft,We),$x.initNonuniformCatmullRom(pe.z,Ie.z,Be.z,xe.z,Ke,ft,We)}else"catmullrom"===this.curveType&&(ZC.initCatmullRom(pe.x,Ie.x,Be.x,xe.x,this.tension),Y1.initCatmullRom(pe.y,Ie.y,Be.y,xe.y,this.tension),$x.initCatmullRom(pe.z,Ie.z,Be.z,xe.z,this.tension));return h.set(ZC.calc(de),Y1.calc(de),$x.calc(de)),h}copy(o){super.copy(o),this.points=[];for(let c=0,h=o.points.length;c<h;c++)this.points.push(o.points[c].clone());return this.closed=o.closed,this.curveType=o.curveType,this.tension=o.tension,this}toJSON(){const o=super.toJSON();o.points=[];for(let c=0,h=this.points.length;c<h;c++)o.points.push(this.points[c].toArray());return o.closed=this.closed,o.curveType=this.curveType,o.tension=this.tension,o}fromJSON(o){super.fromJSON(o),this.points=[];for(let c=0,h=o.points.length;c<h;c++){const m=o.points[c];this.points.push((new Ft).fromArray(m))}return this.closed=o.closed,this.curveType=o.curveType,this.tension=o.tension,this}},CubicBezierCurve:JC,CubicBezierCurve3:class GB extends tm{constructor(o=new Ft,c=new Ft,h=new Ft,m=new Ft){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=o,this.v1=c,this.v2=h,this.v3=m}getPoint(o,c=new Ft){const h=c,m=this.v0,M=this.v1,N=this.v2,q=this.v3;return h.set(Fv(o,m.x,M.x,N.x,q.x),Fv(o,m.y,M.y,N.y,q.y),Fv(o,m.z,M.z,N.z,q.z)),h}copy(o){return super.copy(o),this.v0.copy(o.v0),this.v1.copy(o.v1),this.v2.copy(o.v2),this.v3.copy(o.v3),this}toJSON(){const o=super.toJSON();return o.v0=this.v0.toArray(),o.v1=this.v1.toArray(),o.v2=this.v2.toArray(),o.v3=this.v3.toArray(),o}fromJSON(o){return super.fromJSON(o),this.v0.fromArray(o.v0),this.v1.fromArray(o.v1),this.v2.fromArray(o.v2),this.v3.fromArray(o.v3),this}},EllipseCurve:Rv,LineCurve:AT,LineCurve3:class qB extends tm{constructor(o=new Ft,c=new Ft){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=o,this.v2=c}getPoint(o,c=new Ft){const h=c;return 1===o?h.copy(this.v2):(h.copy(this.v2).sub(this.v1),h.multiplyScalar(o).add(this.v1)),h}getPointAt(o,c){return this.getPoint(o,c)}getTangent(o,c=new Ft){return c.subVectors(this.v2,this.v1).normalize()}getTangentAt(o,c){return this.getTangent(o,c)}copy(o){return super.copy(o),this.v1.copy(o.v1),this.v2.copy(o.v2),this}toJSON(){const o=super.toJSON();return o.v1=this.v1.toArray(),o.v2=this.v2.toArray(),o}fromJSON(o){return super.fromJSON(o),this.v1.fromArray(o.v1),this.v2.fromArray(o.v2),this}},QuadraticBezierCurve:gT,QuadraticBezierCurve3:class _T extends tm{constructor(o=new Ft,c=new Ft,h=new Ft){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=o,this.v1=c,this.v2=h}getPoint(o,c=new Ft){const h=c,m=this.v0,M=this.v1,N=this.v2;return h.set(Xx(o,m.x,M.x,N.x),Xx(o,m.y,M.y,N.y),Xx(o,m.z,M.z,N.z)),h}copy(o){return super.copy(o),this.v0.copy(o.v0),this.v1.copy(o.v1),this.v2.copy(o.v2),this}toJSON(){const o=super.toJSON();return o.v0=this.v0.toArray(),o.v1=this.v1.toArray(),o.v2=this.v2.toArray(),o}fromJSON(o){return super.fromJSON(o),this.v0.fromArray(o.v0),this.v1.fromArray(o.v1),this.v2.fromArray(o.v2),this}},SplineCurve:yT});class mN extends tm{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(o){this.curves.push(o)}closePath(){const o=this.curves[0].getPoint(0),c=this.curves[this.curves.length-1].getPoint(1);return o.equals(c)||this.curves.push(new K1[!0===o.isVector2?"LineCurve":"LineCurve3"](c,o)),this}getPoint(o,c){const h=o*this.getLength(),m=this.getCurveLengths();let M=0;for(;M<m.length;){if(m[M]>=h){const N=m[M]-h,q=this.curves[M],de=q.getLength();return q.getPointAt(0===de?0:1-N/de,c)}M++}return null}getLength(){const o=this.getCurveLengths();return o[o.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const o=[];let c=0;for(let h=0,m=this.curves.length;h<m;h++)c+=this.curves[h].getLength(),o.push(c);return this.cacheLengths=o,o}getSpacedPoints(o=40){const c=[];for(let h=0;h<=o;h++)c.push(this.getPoint(h/o));return this.autoClose&&c.push(c[0]),c}getPoints(o=12){const c=[];let h;for(let m=0,M=this.curves;m<M.length;m++){const N=M[m],de=N.getPoints(N.isEllipseCurve?2*o:N.isLineCurve||N.isLineCurve3?1:N.isSplineCurve?o*N.points.length:o);for(let pe=0;pe<de.length;pe++){const xe=de[pe];h&&h.equals(xe)||(c.push(xe),h=xe)}}return this.autoClose&&c.length>1&&!c[c.length-1].equals(c[0])&&c.push(c[0]),c}copy(o){super.copy(o),this.curves=[];for(let c=0,h=o.curves.length;c<h;c++)this.curves.push(o.curves[c].clone());return this.autoClose=o.autoClose,this}toJSON(){const o=super.toJSON();o.autoClose=this.autoClose,o.curves=[];for(let c=0,h=this.curves.length;c<h;c++)o.curves.push(this.curves[c].toJSON());return o}fromJSON(o){super.fromJSON(o),this.autoClose=o.autoClose,this.curves=[];for(let c=0,h=o.curves.length;c<h;c++){const m=o.curves[c];this.curves.push((new K1[m.type]).fromJSON(m))}return this}}class eM extends mN{constructor(o){super(),this.type="Path",this.currentPoint=new zi,o&&this.setFromPoints(o)}setFromPoints(o){this.moveTo(o[0].x,o[0].y);for(let c=1,h=o.length;c<h;c++)this.lineTo(o[c].x,o[c].y);return this}moveTo(o,c){return this.currentPoint.set(o,c),this}lineTo(o,c){const h=new AT(this.currentPoint.clone(),new zi(o,c));return this.curves.push(h),this.currentPoint.set(o,c),this}quadraticCurveTo(o,c,h,m){const M=new gT(this.currentPoint.clone(),new zi(o,c),new zi(h,m));return this.curves.push(M),this.currentPoint.set(h,m),this}bezierCurveTo(o,c,h,m,M,N){const q=new JC(this.currentPoint.clone(),new zi(o,c),new zi(h,m),new zi(M,N));return this.curves.push(q),this.currentPoint.set(M,N),this}splineThru(o){const c=[this.currentPoint.clone()].concat(o),h=new yT(c);return this.curves.push(h),this.currentPoint.copy(o[o.length-1]),this}arc(o,c,h,m,M,N){return this.absarc(o+this.currentPoint.x,c+this.currentPoint.y,h,m,M,N),this}absarc(o,c,h,m,M,N){return this.absellipse(o,c,h,h,m,M,N),this}ellipse(o,c,h,m,M,N,q,de){return this.absellipse(o+this.currentPoint.x,c+this.currentPoint.y,h,m,M,N,q,de),this}absellipse(o,c,h,m,M,N,q,de){const pe=new Rv(o,c,h,m,M,N,q,de);if(this.curves.length>0){const Ie=pe.getPoint(0);Ie.equals(this.currentPoint)||this.lineTo(Ie.x,Ie.y)}this.curves.push(pe);const xe=pe.getPoint(1);return this.currentPoint.copy(xe),this}copy(o){return super.copy(o),this.currentPoint.copy(o.currentPoint),this}toJSON(){const o=super.toJSON();return o.currentPoint=this.currentPoint.toArray(),o}fromJSON(o){return super.fromJSON(o),this.currentPoint.fromArray(o.currentPoint),this}}class tM extends Cs{constructor(o=1,c=32,h=0,m=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:o,segments:c,thetaStart:h,thetaLength:m},c=Math.max(3,c);const M=[],N=[],q=[],de=[],pe=new Ft,xe=new zi;N.push(0,0,0),q.push(0,0,1),de.push(.5,.5);for(let Ie=0,Be=3;Ie<=c;Ie++,Be+=3){const Le=h+Ie/c*m;pe.x=o*Math.cos(Le),pe.y=o*Math.sin(Le),N.push(pe.x,pe.y,pe.z),q.push(0,0,1),xe.x=(N[Be]/o+1)/2,xe.y=(N[Be+1]/o+1)/2,de.push(xe.x,xe.y)}for(let Ie=1;Ie<=c;Ie++)M.push(Ie,Ie+1,0);this.setIndex(M),this.setAttribute("position",new Bo(N,3)),this.setAttribute("normal",new Bo(q,3)),this.setAttribute("uv",new Bo(de,2))}copy(o){return super.copy(o),this.parameters=Object.assign({},o.parameters),this}static fromJSON(o){return new tM(o.radius,o.segments,o.thetaStart,o.thetaLength)}}class ey extends eM{constructor(o){super(o),this.uuid=gu(),this.type="Shape",this.holes=[]}getPointsHoles(o){const c=[];for(let h=0,m=this.holes.length;h<m;h++)c[h]=this.holes[h].getPoints(o);return c}extractPoints(o){return{shape:this.getPoints(o),holes:this.getPointsHoles(o)}}copy(o){super.copy(o),this.holes=[];for(let c=0,h=o.holes.length;c<h;c++)this.holes.push(o.holes[c].clone());return this}toJSON(){const o=super.toJSON();o.uuid=this.uuid,o.holes=[];for(let c=0,h=this.holes.length;c<h;c++)o.holes.push(this.holes[c].toJSON());return o}fromJSON(o){super.fromJSON(o),this.uuid=o.uuid,this.holes=[];for(let c=0,h=o.holes.length;c<h;c++){const m=o.holes[c];this.holes.push((new eM).fromJSON(m))}return this}}function rM(w,o,c,h,m){let M,N;if(m===function lM(w,o,c,h){let m=0;for(let M=o,N=c-h;M<c;M+=h)m+=(w[N]-w[M])*(w[M+1]+w[N+1]),N=M;return m}(w,o,c,h)>0)for(M=o;M<c;M+=h)N=aM(M,w[M],w[M+1],N);else for(M=c-h;M>=o;M-=h)N=aM(M,w[M],w[M+1],N);return N&&ty(N,N.next)&&(jA(N),N=N.next),N}function dp(w,o){if(!w)return w;o||(o=w);let h,c=w;do{if(h=!1,c.steiner||!ty(c,c.next)&&0!==Cc(c.prev,c,c.next))c=c.next;else{if(jA(c),c=o=c.prev,c===c.next)break;h=!0}}while(h||c!==o);return o}function Cu(w,o,c,h,m,M,N){if(!w)return;!N&&M&&function u0(w,o,c,h){let m=w;do{0===m.z&&(m.z=Nv(m.x,m.y,o,c,h)),m.prevZ=m.prev,m.nextZ=m.next,m=m.next}while(m!==w);m.prevZ.nextZ=null,m.prevZ=null,function sM(w){let o,c,h,m,M,N,q,de,pe=1;do{for(c=w,w=null,M=null,N=0;c;){for(N++,h=c,q=0,o=0;o<pe&&(q++,h=h.nextZ,h);o++);for(de=pe;q>0||de>0&&h;)0!==q&&(0===de||!h||c.z<=h.z)?(m=c,c=c.nextZ,q--):(m=h,h=h.nextZ,de--),M?M.nextZ=m:w=m,m.prevZ=M,M=m;c=h}M.nextZ=null,pe*=2}while(N>1)}(m)}(w,h,m,M);let de,pe,q=w;for(;w.prev!==w.next;)if(de=w.prev,pe=w.next,M?wT(w,h,m,M):d0(w))o.push(de.i/c|0),o.push(w.i/c|0),o.push(pe.i/c|0),jA(w),w=pe.next,q=pe.next;else if((w=pe)===q){N?1===N?Cu(w=AN(dp(w),o,c),o,c,h,m,M,2):2===N&&WB(w,o,c,h,m,M):Cu(dp(w),o,c,h,m,M,1);break}}function d0(w){const o=w.prev,c=w,h=w.next;if(Cc(o,c,h)>=0)return!1;const m=o.x,M=c.x,N=h.x,q=o.y,de=c.y,pe=h.y,xe=m<M?m<N?m:N:M<N?M:N,Ie=q<de?q<pe?q:pe:de<pe?de:pe,Be=m>M?m>N?m:N:M>N?M:N,Le=q>de?q>pe?q:pe:de>pe?de:pe;let Ke=h.next;for(;Ke!==o;){if(Ke.x>=xe&&Ke.x<=Be&&Ke.y>=Ie&&Ke.y<=Le&&nm(m,q,M,de,N,pe,Ke.x,Ke.y)&&Cc(Ke.prev,Ke,Ke.next)>=0)return!1;Ke=Ke.next}return!0}function wT(w,o,c,h){const m=w.prev,M=w,N=w.next;if(Cc(m,M,N)>=0)return!1;const q=m.x,de=M.x,pe=N.x,xe=m.y,Ie=M.y,Be=N.y,Le=q<de?q<pe?q:pe:de<pe?de:pe,Ke=xe<Ie?xe<Be?xe:Be:Ie<Be?Ie:Be,ft=q>de?q>pe?q:pe:de>pe?de:pe,We=xe>Ie?xe>Be?xe:Be:Ie>Be?Ie:Be,ze=Nv(Le,Ke,o,c,h),Mt=Nv(ft,We,o,c,h);let ct=w.prevZ,Dt=w.nextZ;for(;ct&&ct.z>=ze&&Dt&&Dt.z<=Mt;){if(ct.x>=Le&&ct.x<=ft&&ct.y>=Ke&&ct.y<=We&&ct!==m&&ct!==N&&nm(q,xe,de,Ie,pe,Be,ct.x,ct.y)&&Cc(ct.prev,ct,ct.next)>=0||(ct=ct.prevZ,Dt.x>=Le&&Dt.x<=ft&&Dt.y>=Ke&&Dt.y<=We&&Dt!==m&&Dt!==N&&nm(q,xe,de,Ie,pe,Be,Dt.x,Dt.y)&&Cc(Dt.prev,Dt,Dt.next)>=0))return!1;Dt=Dt.nextZ}for(;ct&&ct.z>=ze;){if(ct.x>=Le&&ct.x<=ft&&ct.y>=Ke&&ct.y<=We&&ct!==m&&ct!==N&&nm(q,xe,de,Ie,pe,Be,ct.x,ct.y)&&Cc(ct.prev,ct,ct.next)>=0)return!1;ct=ct.prevZ}for(;Dt&&Dt.z<=Mt;){if(Dt.x>=Le&&Dt.x<=ft&&Dt.y>=Ke&&Dt.y<=We&&Dt!==m&&Dt!==N&&nm(q,xe,de,Ie,pe,Be,Dt.x,Dt.y)&&Cc(Dt.prev,Dt,Dt.next)>=0)return!1;Dt=Dt.nextZ}return!0}function AN(w,o,c){let h=w;do{const m=h.prev,M=h.next.next;!ty(m,M)&&Uv(m,h,h.next,M)&&zv(m,M)&&zv(M,m)&&(o.push(m.i/c|0),o.push(h.i/c|0),o.push(M.i/c|0),jA(h),jA(h.next),h=w=M),h=h.next}while(h!==w);return dp(h)}function WB(w,o,c,h,m,M){let N=w;do{let q=N.next.next;for(;q!==N.prev;){if(N.i!==q.i&&oM(N,q)){let de=ET(N,q);return N=dp(N,N.next),de=dp(de,de.next),Cu(N,o,c,h,m,M,0),void Cu(de,o,c,h,m,M,0)}q=q.next}N=N.next}while(N!==w)}function _N(w,o){return w.x-o.x}function CT(w,o){const c=function MT(w,o){let m,c=o,h=-1/0;const M=w.x,N=w.y;do{if(N<=c.y&&N>=c.next.y&&c.next.y!==c.y){const Be=c.x+(N-c.y)*(c.next.x-c.x)/(c.next.y-c.y);if(Be<=M&&Be>h&&(h=Be,m=c.x<c.next.x?c:c.next,Be===M))return m}c=c.next}while(c!==o);if(!m)return null;const q=m,de=m.x,pe=m.y;let Ie,xe=1/0;c=m;do{M>=c.x&&c.x>=de&&M!==c.x&&nm(N<pe?M:h,N,de,pe,N<pe?h:M,N,c.x,c.y)&&(Ie=Math.abs(N-c.y)/(M-c.x),zv(c,w)&&(Ie<xe||Ie===xe&&(c.x>m.x||c.x===m.x&&yN(m,c)))&&(m=c,xe=Ie)),c=c.next}while(c!==q);return m}(w,o);if(!c)return o;const h=ET(c,w);return dp(h,h.next),dp(c,c.next)}function yN(w,o){return Cc(w.prev,w,o.prev)<0&&Cc(o.next,w,w.next)<0}function Nv(w,o,c,h,m){return(w=1431655765&((w=858993459&((w=252645135&((w=16711935&((w=(w-c)*m|0)|w<<8))|w<<4))|w<<2))|w<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-h)*m|0)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function jB(w){let o=w,c=w;do{(o.x<c.x||o.x===c.x&&o.y<c.y)&&(c=o),o=o.next}while(o!==w);return c}function nm(w,o,c,h,m,M,N,q){return(m-N)*(o-q)>=(w-N)*(M-q)&&(w-N)*(h-q)>=(c-N)*(o-q)&&(c-N)*(M-q)>=(m-N)*(h-q)}function oM(w,o){return w.next.i!==o.i&&w.prev.i!==o.i&&!function ST(w,o){let c=w;do{if(c.i!==w.i&&c.next.i!==w.i&&c.i!==o.i&&c.next.i!==o.i&&Uv(c,c.next,w,o))return!0;c=c.next}while(c!==w);return!1}(w,o)&&(zv(w,o)&&zv(o,w)&&function $B(w,o){let c=w,h=!1;const m=(w.x+o.x)/2,M=(w.y+o.y)/2;do{c.y>M!=c.next.y>M&&c.next.y!==c.y&&m<(c.next.x-c.x)*(M-c.y)/(c.next.y-c.y)+c.x&&(h=!h),c=c.next}while(c!==w);return h}(w,o)&&(Cc(w.prev,w,o.prev)||Cc(w,o.prev,o))||ty(w,o)&&Cc(w.prev,w,w.next)>0&&Cc(o.prev,o,o.next)>0)}function Cc(w,o,c){return(o.y-w.y)*(c.x-o.x)-(o.x-w.x)*(c.y-o.y)}function ty(w,o){return w.x===o.x&&w.y===o.y}function Uv(w,o,c,h){const m=Kx(Cc(w,o,c)),M=Kx(Cc(w,o,h)),N=Kx(Cc(c,h,w)),q=Kx(Cc(c,h,o));return!!(m!==M&&N!==q||0===m&&Yx(w,c,o)||0===M&&Yx(w,h,o)||0===N&&Yx(c,w,h)||0===q&&Yx(c,o,h))}function Yx(w,o,c){return o.x<=Math.max(w.x,c.x)&&o.x>=Math.min(w.x,c.x)&&o.y<=Math.max(w.y,c.y)&&o.y>=Math.min(w.y,c.y)}function Kx(w){return w>0?1:w<0?-1:0}function zv(w,o){return Cc(w.prev,w,w.next)<0?Cc(w,o,w.next)>=0&&Cc(w,w.prev,o)>=0:Cc(w,o,w.prev)<0||Cc(w,w.next,o)<0}function ET(w,o){const c=new ny(w.i,w.x,w.y),h=new ny(o.i,o.x,o.y),m=w.next,M=o.prev;return w.next=o,o.prev=w,c.next=m,m.prev=c,h.next=c,c.prev=h,M.next=h,h.prev=M,h}function aM(w,o,c,h){const m=new ny(w,o,c);return h?(m.next=h.next,m.prev=h,h.next.prev=m,h.next=m):(m.prev=m,m.next=m),m}function jA(w){w.next.prev=w.prev,w.prev.next=w.next,w.prevZ&&(w.prevZ.nextZ=w.nextZ),w.nextZ&&(w.nextZ.prevZ=w.prevZ)}function ny(w,o,c){this.i=w,this.x=o,this.y=c,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Ym{static area(o){const c=o.length;let h=0;for(let m=c-1,M=0;M<c;m=M++)h+=o[m].x*o[M].y-o[M].x*o[m].y;return.5*h}static isClockWise(o){return Ym.area(o)<0}static triangulateShape(o,c){const h=[],m=[],M=[];TT(o),Zx(h,o);let N=o.length;c.forEach(TT);for(let de=0;de<c.length;de++)m.push(N),N+=c[de].length,Zx(h,c[de]);const q=function(w,o,c=2){const h=o&&o.length,m=h?o[0]*c:w.length;let M=rM(w,0,m,c,!0);const N=[];if(!M||M.next===M.prev)return N;let q,de,pe,xe,Ie,Be,Le;if(h&&(M=function gN(w,o,c,h){const m=[];let M,N,q,de,pe;for(M=0,N=o.length;M<N;M++)q=o[M]*h,de=M<N-1?o[M+1]*h:w.length,pe=rM(w,q,de,h,!1),pe===pe.next&&(pe.steiner=!0),m.push(jB(pe));for(m.sort(_N),M=0;M<m.length;M++)c=CT(m[M],c);return c}(w,o,M,c)),w.length>80*c){q=pe=w[0],de=xe=w[1];for(let Ke=c;Ke<m;Ke+=c)Ie=w[Ke],Be=w[Ke+1],Ie<q&&(q=Ie),Be<de&&(de=Be),Ie>pe&&(pe=Ie),Be>xe&&(xe=Be);Le=Math.max(pe-q,xe-de),Le=0!==Le?32767/Le:0}return Cu(M,N,c,q,de,Le,0),N}(h,m);for(let de=0;de<q.length;de+=3)M.push(q.slice(de,de+3));return M}}function TT(w){const o=w.length;o>2&&w[o-1].equals(w[0])&&w.pop()}function Zx(w,o){for(let c=0;c<o.length;c++)w.push(o[c].x),w.push(o[c].y)}class Hv extends Cs{constructor(o=new ey([new zi(.5,.5),new zi(-.5,.5),new zi(-.5,-.5),new zi(.5,-.5)]),c={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:o,options:c},o=Array.isArray(o)?o:[o];const h=this,m=[],M=[];for(let q=0,de=o.length;q<de;q++)N(o[q]);function N(q){const de=[],pe=void 0!==c.curveSegments?c.curveSegments:12,xe=void 0!==c.steps?c.steps:1,Ie=void 0!==c.depth?c.depth:1;let Be=void 0===c.bevelEnabled||c.bevelEnabled,Le=void 0!==c.bevelThickness?c.bevelThickness:.2,Ke=void 0!==c.bevelSize?c.bevelSize:Le-.1,ft=void 0!==c.bevelOffset?c.bevelOffset:0,We=void 0!==c.bevelSegments?c.bevelSegments:3;const ze=c.extrudePath,Mt=void 0!==c.UVGenerator?c.UVGenerator:w_;let ct,Jt,cn,rn,Rn,Dt=!1;ze&&(ct=ze.getSpacedPoints(xe),Dt=!0,Be=!1,Jt=ze.computeFrenetFrames(xe,!1),cn=new Ft,rn=new Ft,Rn=new Ft),Be||(We=0,Le=0,Ke=0,ft=0);const kt=q.extractPoints(pe);let Zt=kt.shape;const li=kt.holes;if(!Ym.isClockWise(Zt)){Zt=Zt.reverse();for(let _n=0,Ki=li.length;_n<Ki;_n++){const si=li[_n];Ym.isClockWise(si)&&(li[_n]=si.reverse())}}const ur=Ym.triangulateShape(Zt,li),Yn=Zt;for(let _n=0,Ki=li.length;_n<Ki;_n++)Zt=Zt.concat(li[_n]);function Di(_n,Ki,si){return Ki||console.error("THREE.ExtrudeGeometry: vec does not exist"),_n.clone().addScaledVector(Ki,si)}const rr=Zt.length,Li=ur.length;function br(_n,Ki,si){let Ri,Ii,es;const Ur=_n.x-Ki.x,fr=_n.y-Ki.y,us=si.x-_n.x,co=si.y-_n.y,_s=Ur*Ur+fr*fr;if(Math.abs(Ur*co-fr*us)>Number.EPSILON){const Pt=Math.sqrt(_s),ni=Math.sqrt(us*us+co*co),cr=Ki.x-fr/Pt,Ar=Ki.y+Ur/Pt,Ir=((si.x-co/ni-cr)*co-(si.y+us/ni-Ar)*us)/(Ur*co-fr*us);Ri=cr+Ur*Ir-_n.x,Ii=Ar+fr*Ir-_n.y;const ts=Ri*Ri+Ii*Ii;if(ts<=2)return new zi(Ri,Ii);es=Math.sqrt(ts/2)}else{let Pt=!1;Ur>Number.EPSILON?us>Number.EPSILON&&(Pt=!0):Ur<-Number.EPSILON?us<-Number.EPSILON&&(Pt=!0):Math.sign(fr)===Math.sign(co)&&(Pt=!0),Pt?(Ri=-fr,Ii=Ur,es=Math.sqrt(_s)):(Ri=Ur,Ii=fr,es=Math.sqrt(_s/2))}return new zi(Ri/es,Ii/es)}const Ji=[];for(let _n=0,Ki=Yn.length,si=Ki-1,Ri=_n+1;_n<Ki;_n++,si++,Ri++)si===Ki&&(si=0),Ri===Ki&&(Ri=0),Ji[_n]=br(Yn[_n],Yn[si],Yn[Ri]);const lr=[];let ei,sr=Ji.concat();for(let _n=0,Ki=li.length;_n<Ki;_n++){const si=li[_n];ei=[];for(let Ri=0,Ii=si.length,es=Ii-1,Ur=Ri+1;Ri<Ii;Ri++,es++,Ur++)es===Ii&&(es=0),Ur===Ii&&(Ur=0),ei[Ri]=br(si[Ri],si[es],si[Ur]);lr.push(ei),sr=sr.concat(ei)}for(let _n=0;_n<We;_n++){const Ki=_n/We,si=Le*Math.cos(Ki*Math.PI/2),Ri=Ke*Math.sin(Ki*Math.PI/2)+ft;for(let Ii=0,es=Yn.length;Ii<es;Ii++){const Ur=Di(Yn[Ii],Ji[Ii],Ri);eo(Ur.x,Ur.y,-si)}for(let Ii=0,es=li.length;Ii<es;Ii++){const Ur=li[Ii];ei=lr[Ii];for(let fr=0,us=Ur.length;fr<us;fr++){const co=Di(Ur[fr],ei[fr],Ri);eo(co.x,co.y,-si)}}}const as=Ke+ft;for(let _n=0;_n<rr;_n++){const Ki=Be?Di(Zt[_n],sr[_n],as):Zt[_n];Dt?(rn.copy(Jt.normals[0]).multiplyScalar(Ki.x),cn.copy(Jt.binormals[0]).multiplyScalar(Ki.y),Rn.copy(ct[0]).add(rn).add(cn),eo(Rn.x,Rn.y,Rn.z)):eo(Ki.x,Ki.y,0)}for(let _n=1;_n<=xe;_n++)for(let Ki=0;Ki<rr;Ki++){const si=Be?Di(Zt[Ki],sr[Ki],as):Zt[Ki];Dt?(rn.copy(Jt.normals[_n]).multiplyScalar(si.x),cn.copy(Jt.binormals[_n]).multiplyScalar(si.y),Rn.copy(ct[_n]).add(rn).add(cn),eo(Rn.x,Rn.y,Rn.z)):eo(si.x,si.y,Ie/xe*_n)}for(let _n=We-1;_n>=0;_n--){const Ki=_n/We,si=Le*Math.cos(Ki*Math.PI/2),Ri=Ke*Math.sin(Ki*Math.PI/2)+ft;for(let Ii=0,es=Yn.length;Ii<es;Ii++){const Ur=Di(Yn[Ii],Ji[Ii],Ri);eo(Ur.x,Ur.y,Ie+si)}for(let Ii=0,es=li.length;Ii<es;Ii++){const Ur=li[Ii];ei=lr[Ii];for(let fr=0,us=Ur.length;fr<us;fr++){const co=Di(Ur[fr],ei[fr],Ri);Dt?eo(co.x,co.y+ct[xe-1].y,ct[xe-1].x+si):eo(co.x,co.y,Ie+si)}}}function fs(_n,Ki){let si=_n.length;for(;--si>=0;){const Ri=si;let Ii=si-1;Ii<0&&(Ii=_n.length-1);for(let es=0,Ur=xe+2*We;es<Ur;es++){const fr=rr*es,us=rr*(es+1);Lr(Ki+Ri+fr,Ki+Ii+fr,Ki+Ii+us,Ki+Ri+us)}}}function eo(_n,Ki,si){de.push(_n),de.push(Ki),de.push(si)}function er(_n,Ki,si){yr(_n),yr(Ki),yr(si);const Ri=m.length/3,Ii=Mt.generateTopUV(h,m,Ri-3,Ri-2,Ri-1);vr(Ii[0]),vr(Ii[1]),vr(Ii[2])}function Lr(_n,Ki,si,Ri){yr(_n),yr(Ki),yr(Ri),yr(Ki),yr(si),yr(Ri);const Ii=m.length/3,es=Mt.generateSideWallUV(h,m,Ii-6,Ii-3,Ii-2,Ii-1);vr(es[0]),vr(es[1]),vr(es[3]),vr(es[1]),vr(es[2]),vr(es[3])}function yr(_n){m.push(de[3*_n+0]),m.push(de[3*_n+1]),m.push(de[3*_n+2])}function vr(_n){M.push(_n.x),M.push(_n.y)}(function xs(){const _n=m.length/3;if(Be){let Ki=0,si=rr*Ki;for(let Ri=0;Ri<Li;Ri++){const Ii=ur[Ri];er(Ii[2]+si,Ii[1]+si,Ii[0]+si)}Ki=xe+2*We,si=rr*Ki;for(let Ri=0;Ri<Li;Ri++){const Ii=ur[Ri];er(Ii[0]+si,Ii[1]+si,Ii[2]+si)}}else{for(let Ki=0;Ki<Li;Ki++){const si=ur[Ki];er(si[2],si[1],si[0])}for(let Ki=0;Ki<Li;Ki++){const si=ur[Ki];er(si[0]+rr*xe,si[1]+rr*xe,si[2]+rr*xe)}}h.addGroup(_n,m.length/3-_n,0)})(),function Ds(){const _n=m.length/3;let Ki=0;fs(Yn,Ki),Ki+=Yn.length;for(let si=0,Ri=li.length;si<Ri;si++){const Ii=li[si];fs(Ii,Ki),Ki+=Ii.length}h.addGroup(_n,m.length/3-_n,1)}()}this.setAttribute("position",new Bo(m,3)),this.setAttribute("uv",new Bo(M,2)),this.computeVertexNormals()}copy(o){return super.copy(o),this.parameters=Object.assign({},o.parameters),this}toJSON(){const o=super.toJSON();return function DT(w,o,c){if(c.shapes=[],Array.isArray(w))for(let h=0,m=w.length;h<m;h++)c.shapes.push(w[h].uuid);else c.shapes.push(w.uuid);return c.options=Object.assign({},o),void 0!==o.extrudePath&&(c.options.extrudePath=o.extrudePath.toJSON()),c}(this.parameters.shapes,this.parameters.options,o)}static fromJSON(o,c){const h=[];for(let M=0,N=o.shapes.length;M<N;M++)h.push(c[o.shapes[M]]);const m=o.options.extrudePath;return void 0!==m&&(o.options.extrudePath=(new K1[m.type]).fromJSON(m)),new Hv(h,o.options)}}const w_={generateTopUV:function(w,o,c,h,m){const q=o[3*h],de=o[3*h+1],pe=o[3*m],xe=o[3*m+1];return[new zi(o[3*c],o[3*c+1]),new zi(q,de),new zi(pe,xe)]},generateSideWallUV:function(w,o,c,h,m,M){const N=o[3*c],q=o[3*c+1],de=o[3*c+2],pe=o[3*h],xe=o[3*h+1],Ie=o[3*h+2],Be=o[3*m],Le=o[3*m+1],Ke=o[3*m+2],ft=o[3*M],We=o[3*M+1],ze=o[3*M+2];return Math.abs(q-xe)<Math.abs(N-pe)?[new zi(N,1-de),new zi(pe,1-Ie),new zi(Be,1-Ke),new zi(ft,1-ze)]:[new zi(q,1-de),new zi(xe,1-Ie),new zi(Le,1-Ke),new zi(We,1-ze)]}};class Vv extends Cs{constructor(o=1,c=32,h=16,m=0,M=2*Math.PI,N=0,q=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:o,widthSegments:c,heightSegments:h,phiStart:m,phiLength:M,thetaStart:N,thetaLength:q},c=Math.max(3,Math.floor(c)),h=Math.max(2,Math.floor(h));const de=Math.min(N+q,Math.PI);let pe=0;const xe=[],Ie=new Ft,Be=new Ft,Le=[],Ke=[],ft=[],We=[];for(let ze=0;ze<=h;ze++){const Mt=[],ct=ze/h;let Dt=0;0===ze&&0===N?Dt=.5/c:ze===h&&de===Math.PI&&(Dt=-.5/c);for(let Jt=0;Jt<=c;Jt++){const cn=Jt/c;Ie.x=-o*Math.cos(m+cn*M)*Math.sin(N+ct*q),Ie.y=o*Math.cos(N+ct*q),Ie.z=o*Math.sin(m+cn*M)*Math.sin(N+ct*q),Ke.push(Ie.x,Ie.y,Ie.z),Be.copy(Ie).normalize(),ft.push(Be.x,Be.y,Be.z),We.push(cn+Dt,1-ct),Mt.push(pe++)}xe.push(Mt)}for(let ze=0;ze<h;ze++)for(let Mt=0;Mt<c;Mt++){const Dt=xe[ze][Mt],Jt=xe[ze+1][Mt],cn=xe[ze+1][Mt+1];(0!==ze||N>0)&&Le.push(xe[ze][Mt+1],Dt,cn),(ze!==h-1||de<Math.PI)&&Le.push(Dt,Jt,cn)}this.setIndex(Le),this.setAttribute("position",new Bo(Ke,3)),this.setAttribute("normal",new Bo(ft,3)),this.setAttribute("uv",new Bo(We,2))}copy(o){return super.copy(o),this.parameters=Object.assign({},o.parameters),this}static fromJSON(o){return new Vv(o.radius,o.widthSegments,o.heightSegments,o.phiStart,o.phiLength,o.thetaStart,o.thetaLength)}}class qv extends kc{constructor(o){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Os(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Os(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new zi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(o)}copy(o){return super.copy(o),this.defines={STANDARD:""},this.color.copy(o.color),this.roughness=o.roughness,this.metalness=o.metalness,this.map=o.map,this.lightMap=o.lightMap,this.lightMapIntensity=o.lightMapIntensity,this.aoMap=o.aoMap,this.aoMapIntensity=o.aoMapIntensity,this.emissive.copy(o.emissive),this.emissiveMap=o.emissiveMap,this.emissiveIntensity=o.emissiveIntensity,this.bumpMap=o.bumpMap,this.bumpScale=o.bumpScale,this.normalMap=o.normalMap,this.normalMapType=o.normalMapType,this.normalScale.copy(o.normalScale),this.displacementMap=o.displacementMap,this.displacementScale=o.displacementScale,this.displacementBias=o.displacementBias,this.roughnessMap=o.roughnessMap,this.metalnessMap=o.metalnessMap,this.alphaMap=o.alphaMap,this.envMap=o.envMap,this.envMapIntensity=o.envMapIntensity,this.wireframe=o.wireframe,this.wireframeLinewidth=o.wireframeLinewidth,this.wireframeLinecap=o.wireframeLinecap,this.wireframeLinejoin=o.wireframeLinejoin,this.flatShading=o.flatShading,this.fog=o.fog,this}}class Qv extends qv{constructor(o){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new zi(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return nl(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(c){this.ior=(1+.4*c)/(1-.4*c)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Os(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Os(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Os(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(o)}get anisotropy(){return this._anisotropy}set anisotropy(o){this._anisotropy>0!=o>0&&this.version++,this._anisotropy=o}get clearcoat(){return this._clearcoat}set clearcoat(o){this._clearcoat>0!=o>0&&this.version++,this._clearcoat=o}get iridescence(){return this._iridescence}set iridescence(o){this._iridescence>0!=o>0&&this.version++,this._iridescence=o}get sheen(){return this._sheen}set sheen(o){this._sheen>0!=o>0&&this.version++,this._sheen=o}get transmission(){return this._transmission}set transmission(o){this._transmission>0!=o>0&&this.version++,this._transmission=o}copy(o){return super.copy(o),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=o.anisotropy,this.anisotropyRotation=o.anisotropyRotation,this.anisotropyMap=o.anisotropyMap,this.clearcoat=o.clearcoat,this.clearcoatMap=o.clearcoatMap,this.clearcoatRoughness=o.clearcoatRoughness,this.clearcoatRoughnessMap=o.clearcoatRoughnessMap,this.clearcoatNormalMap=o.clearcoatNormalMap,this.clearcoatNormalScale.copy(o.clearcoatNormalScale),this.ior=o.ior,this.iridescence=o.iridescence,this.iridescenceMap=o.iridescenceMap,this.iridescenceIOR=o.iridescenceIOR,this.iridescenceThicknessRange=[...o.iridescenceThicknessRange],this.iridescenceThicknessMap=o.iridescenceThicknessMap,this.sheen=o.sheen,this.sheenColor.copy(o.sheenColor),this.sheenColorMap=o.sheenColorMap,this.sheenRoughness=o.sheenRoughness,this.sheenRoughnessMap=o.sheenRoughnessMap,this.transmission=o.transmission,this.transmissionMap=o.transmissionMap,this.thickness=o.thickness,this.thicknessMap=o.thicknessMap,this.attenuationDistance=o.attenuationDistance,this.attenuationColor.copy(o.attenuationColor),this.specularIntensity=o.specularIntensity,this.specularIntensityMap=o.specularIntensityMap,this.specularColor.copy(o.specularColor),this.specularColorMap=o.specularColorMap,this}}class PT extends kc{constructor(o){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Os(16777215),this.specular=new Os(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Os(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new zi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ne,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(o)}copy(o){return super.copy(o),this.color.copy(o.color),this.specular.copy(o.specular),this.shininess=o.shininess,this.map=o.map,this.lightMap=o.lightMap,this.lightMapIntensity=o.lightMapIntensity,this.aoMap=o.aoMap,this.aoMapIntensity=o.aoMapIntensity,this.emissive.copy(o.emissive),this.emissiveMap=o.emissiveMap,this.emissiveIntensity=o.emissiveIntensity,this.bumpMap=o.bumpMap,this.bumpScale=o.bumpScale,this.normalMap=o.normalMap,this.normalMapType=o.normalMapType,this.normalScale.copy(o.normalScale),this.displacementMap=o.displacementMap,this.displacementScale=o.displacementScale,this.displacementBias=o.displacementBias,this.specularMap=o.specularMap,this.alphaMap=o.alphaMap,this.envMap=o.envMap,this.combine=o.combine,this.reflectivity=o.reflectivity,this.refractionRatio=o.refractionRatio,this.wireframe=o.wireframe,this.wireframeLinewidth=o.wireframeLinewidth,this.wireframeLinecap=o.wireframeLinecap,this.wireframeLinejoin=o.wireframeLinejoin,this.flatShading=o.flatShading,this.fog=o.fog,this}}class hM extends kc{constructor(o){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Os(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Os(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new zi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(o)}copy(o){return super.copy(o),this.color.copy(o.color),this.map=o.map,this.gradientMap=o.gradientMap,this.lightMap=o.lightMap,this.lightMapIntensity=o.lightMapIntensity,this.aoMap=o.aoMap,this.aoMapIntensity=o.aoMapIntensity,this.emissive.copy(o.emissive),this.emissiveMap=o.emissiveMap,this.emissiveIntensity=o.emissiveIntensity,this.bumpMap=o.bumpMap,this.bumpScale=o.bumpScale,this.normalMap=o.normalMap,this.normalMapType=o.normalMapType,this.normalScale.copy(o.normalScale),this.displacementMap=o.displacementMap,this.displacementScale=o.displacementScale,this.displacementBias=o.displacementBias,this.alphaMap=o.alphaMap,this.wireframe=o.wireframe,this.wireframeLinewidth=o.wireframeLinewidth,this.wireframeLinecap=o.wireframeLinecap,this.wireframeLinejoin=o.wireframeLinejoin,this.fog=o.fog,this}}class RT extends kc{constructor(o){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new zi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(o)}copy(o){return super.copy(o),this.bumpMap=o.bumpMap,this.bumpScale=o.bumpScale,this.normalMap=o.normalMap,this.normalMapType=o.normalMapType,this.normalScale.copy(o.normalScale),this.displacementMap=o.displacementMap,this.displacementScale=o.displacementScale,this.displacementBias=o.displacementBias,this.wireframe=o.wireframe,this.wireframeLinewidth=o.wireframeLinewidth,this.flatShading=o.flatShading,this}}class kT extends kc{constructor(o){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Os(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Os(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new zi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ne,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(o)}copy(o){return super.copy(o),this.color.copy(o.color),this.map=o.map,this.lightMap=o.lightMap,this.lightMapIntensity=o.lightMapIntensity,this.aoMap=o.aoMap,this.aoMapIntensity=o.aoMapIntensity,this.emissive.copy(o.emissive),this.emissiveMap=o.emissiveMap,this.emissiveIntensity=o.emissiveIntensity,this.bumpMap=o.bumpMap,this.bumpScale=o.bumpScale,this.normalMap=o.normalMap,this.normalMapType=o.normalMapType,this.normalScale.copy(o.normalScale),this.displacementMap=o.displacementMap,this.displacementScale=o.displacementScale,this.displacementBias=o.displacementBias,this.specularMap=o.specularMap,this.alphaMap=o.alphaMap,this.envMap=o.envMap,this.combine=o.combine,this.reflectivity=o.reflectivity,this.refractionRatio=o.refractionRatio,this.wireframe=o.wireframe,this.wireframeLinewidth=o.wireframeLinewidth,this.wireframeLinecap=o.wireframeLinecap,this.wireframeLinejoin=o.wireframeLinejoin,this.flatShading=o.flatShading,this.fog=o.fog,this}}class FT extends kc{constructor(o){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Os(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new zi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(o)}copy(o){return super.copy(o),this.defines={MATCAP:""},this.color.copy(o.color),this.matcap=o.matcap,this.map=o.map,this.bumpMap=o.bumpMap,this.bumpScale=o.bumpScale,this.normalMap=o.normalMap,this.normalMapType=o.normalMapType,this.normalScale.copy(o.normalScale),this.displacementMap=o.displacementMap,this.displacementScale=o.displacementScale,this.displacementBias=o.displacementBias,this.alphaMap=o.alphaMap,this.flatShading=o.flatShading,this.fog=o.fog,this}}class fM extends j1{constructor(o){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(o)}copy(o){return super.copy(o),this.scale=o.scale,this.dashSize=o.dashSize,this.gapSize=o.gapSize,this}}const C_={enabled:!1,files:{},add:function(w,o){!1!==this.enabled&&(this.files[w]=o)},get:function(w){if(!1!==this.enabled)return this.files[w]},remove:function(w){delete this.files[w]},clear:function(){this.files={}}};class ca{constructor(o,c,h){const m=this;let de,M=!1,N=0,q=0;const pe=[];this.onStart=void 0,this.onLoad=o,this.onProgress=c,this.onError=h,this.itemStart=function(xe){q++,!1===M&&void 0!==m.onStart&&m.onStart(xe,N,q),M=!0},this.itemEnd=function(xe){N++,void 0!==m.onProgress&&m.onProgress(xe,N,q),N===q&&(M=!1,void 0!==m.onLoad&&m.onLoad())},this.itemError=function(xe){void 0!==m.onError&&m.onError(xe)},this.resolveURL=function(xe){return de?de(xe):xe},this.setURLModifier=function(xe){return de=xe,this},this.addHandler=function(xe,Ie){return pe.push(xe,Ie),this},this.removeHandler=function(xe){const Ie=pe.indexOf(xe);return-1!==Ie&&pe.splice(Ie,2),this},this.getHandler=function(xe){for(let Ie=0,Be=pe.length;Ie<Be;Ie+=2){const Le=pe[Ie],Ke=pe[Ie+1];if(Le.global&&(Le.lastIndex=0),Le.test(xe))return Ke}return null}}}const Vn=new ca;let up=(()=>{class w{constructor(c){this.manager=void 0!==c?c:Vn,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(c,h){const m=this;return new Promise(function(M,N){m.load(c,M,h,N)})}parse(){}setCrossOrigin(c){return this.crossOrigin=c,this}setWithCredentials(c){return this.withCredentials=c,this}setPath(c){return this.path=c,this}setResourcePath(c){return this.resourcePath=c,this}setRequestHeader(c){return this.requestHeader=c,this}}return w.DEFAULT_MATERIAL_NAME="__DEFAULT",w})();Error;class $A extends up{constructor(o){super(o)}load(o,c,h,m){void 0!==this.path&&(o=this.path+o),o=this.manager.resolveURL(o);const M=this,N=C_.get(o);if(void 0!==N)return M.manager.itemStart(o),setTimeout(function(){c&&c(N),M.manager.itemEnd(o)},0),N;const q=mi("img");function de(){xe(),C_.add(o,this),c&&c(this),M.manager.itemEnd(o)}function pe(Ie){xe(),m&&m(Ie),M.manager.itemError(o),M.manager.itemEnd(o)}function xe(){q.removeEventListener("load",de,!1),q.removeEventListener("error",pe,!1)}return q.addEventListener("load",de,!1),q.addEventListener("error",pe,!1),"data:"!==o.slice(0,5)&&void 0!==this.crossOrigin&&(q.crossOrigin=this.crossOrigin),M.manager.itemStart(o),q.src=o,q}}class LT extends up{constructor(o){super(o)}load(o,c,h,m){const M=new bu,N=new $A(this.manager);return N.setCrossOrigin(this.crossOrigin),N.setPath(this.path),N.load(o,function(q){M.image=q,M.needsUpdate=!0,void 0!==c&&c(M)},h,m),M}}class XA extends Rl{constructor(o,c=1){super(),this.isLight=!0,this.type="Light",this.color=new Os(o),this.intensity=c}dispose(){}copy(o,c){return super.copy(o,c),this.color.copy(o.color),this.intensity=o.intensity,this}toJSON(o){const c=super.toJSON(o);return c.object.color=this.color.getHex(),c.object.intensity=this.intensity,void 0!==this.groundColor&&(c.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(c.object.distance=this.distance),void 0!==this.angle&&(c.object.angle=this.angle),void 0!==this.decay&&(c.object.decay=this.decay),void 0!==this.penumbra&&(c.object.penumbra=this.penumbra),void 0!==this.shadow&&(c.object.shadow=this.shadow.toJSON()),c}}class WT extends XA{constructor(o,c,h){super(o,h),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Rl.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Os(c)}copy(o,c){return super.copy(o,c),this.groundColor.copy(o.groundColor),this}}const vM=new bo,bM=new Ft,xM=new Ft;class dy{constructor(o){this.camera=o,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new zi(512,512),this.map=null,this.mapPass=null,this.matrix=new bo,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Jh,this._frameExtents=new zi(1,1),this._viewportCount=1,this._viewports=[new il(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(o){const c=this.camera,h=this.matrix;bM.setFromMatrixPosition(o.matrixWorld),c.position.copy(bM),xM.setFromMatrixPosition(o.target.matrixWorld),c.lookAt(xM),c.updateMatrixWorld(),vM.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse),this._frustum.setFromProjectionMatrix(vM),h.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),h.multiply(vM)}getViewport(o){return this._viewports[o]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(o){return this.camera=o.camera.clone(),this.bias=o.bias,this.radius=o.radius,this.mapSize.copy(o.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const o={};return 0!==this.bias&&(o.bias=this.bias),0!==this.normalBias&&(o.normalBias=this.normalBias),1!==this.radius&&(o.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(o.mapSize=this.mapSize.toArray()),o.camera=this.camera.toJSON(!1).object,delete o.camera.matrix,o}}class YA extends dy{constructor(){super(new kd(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class jT extends XA{constructor(o,c){super(o,c),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Rl.DEFAULT_UP),this.updateMatrix(),this.target=new Rl,this.shadow=new YA}dispose(){this.shadow.dispose()}copy(o){return super.copy(o),this.target=o.target.clone(),this.shadow=o.shadow.clone(),this}}class $T extends XA{constructor(o,c){super(o,c),this.isAmbientLight=!0,this.type="AmbientLight"}}function Kv(w,o,c){return!w||!c&&w.constructor===o?w:"number"==typeof o.BYTES_PER_ELEMENT?new o(w):Array.prototype.slice.call(w)}class Jv{constructor(o,c,h,m){this.parameterPositions=o,this._cachedIndex=0,this.resultBuffer=void 0!==m?m:new c.constructor(h),this.sampleValues=c,this.valueSize=h,this.settings=null,this.DefaultSettings_={}}evaluate(o){const c=this.parameterPositions;let h=this._cachedIndex,m=c[h],M=c[h-1];e:{t:{let N;n:{i:if(!(o<m)){for(let q=h+2;;){if(void 0===m){if(o<M)break i;return h=c.length,this._cachedIndex=h,this.copySampleValue_(h-1)}if(h===q)break;if(M=m,m=c[++h],o<m)break t}N=c.length;break n}if(o>=M)break e;{const q=c[1];o<q&&(h=2,M=q);for(let de=h-2;;){if(void 0===M)return this._cachedIndex=0,this.copySampleValue_(0);if(h===de)break;if(m=M,M=c[--h-1],o>=M)break t}N=h,h=0}}for(;h<N;){const q=h+N>>>1;o<c[q]?N=q:h=q+1}if(m=c[h],M=c[h-1],void 0===M)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===m)return h=c.length,this._cachedIndex=h,this.copySampleValue_(h-1)}this._cachedIndex=h,this.intervalChanged_(h,M,m)}return this.interpolate_(h,M,o,m)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(o){const c=this.resultBuffer,h=this.sampleValues,m=this.valueSize,M=o*m;for(let N=0;N!==m;++N)c[N]=h[M+N];return c}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class XT extends Jv{constructor(o,c,h,m){super(o,c,h,m),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(o,c,h){const m=this.parameterPositions;let M=o-2,N=o+1,q=m[M],de=m[N];if(void 0===q)switch(this.getSettings_().endingStart){case 2401:M=o,q=2*c-h;break;case 2402:M=m.length-2,q=c+m[M]-m[M+1];break;default:M=o,q=h}if(void 0===de)switch(this.getSettings_().endingEnd){case 2401:N=o,de=2*h-c;break;case 2402:N=1,de=h+m[1]-m[0];break;default:N=o-1,de=c}const pe=.5*(h-c),xe=this.valueSize;this._weightPrev=pe/(c-q),this._weightNext=pe/(de-h),this._offsetPrev=M*xe,this._offsetNext=N*xe}interpolate_(o,c,h,m){const M=this.resultBuffer,N=this.sampleValues,q=this.valueSize,de=o*q,pe=de-q,xe=this._offsetPrev,Ie=this._offsetNext,Be=this._weightPrev,Le=this._weightNext,Ke=(h-c)/(m-c),ft=Ke*Ke,We=ft*Ke,ze=-Be*We+2*Be*ft-Be*Ke,Mt=(1+Be)*We+(-1.5-2*Be)*ft+(-.5+Be)*Ke+1,ct=(-1-Le)*We+(1.5+Le)*ft+.5*Ke,Dt=Le*We-Le*ft;for(let Jt=0;Jt!==q;++Jt)M[Jt]=ze*N[xe+Jt]+Mt*N[pe+Jt]+ct*N[de+Jt]+Dt*N[Ie+Jt];return M}}class nP extends Jv{constructor(o,c,h,m){super(o,c,h,m)}interpolate_(o,c,h,m){const M=this.resultBuffer,N=this.sampleValues,q=this.valueSize,de=o*q,pe=de-q,xe=(h-c)/(m-c),Ie=1-xe;for(let Be=0;Be!==q;++Be)M[Be]=N[pe+Be]*Ie+N[de+Be]*xe;return M}}class iP extends Jv{constructor(o,c,h,m){super(o,c,h,m)}interpolate_(o){return this.copySampleValue_(o-1)}}class Km{constructor(o,c,h,m){if(void 0===o)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===c||0===c.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+o);this.name=o,this.times=Kv(c,this.TimeBufferType),this.values=Kv(h,this.ValueBufferType),this.setInterpolation(m||this.DefaultInterpolation)}static toJSON(o){const c=o.constructor;let h;if(c.toJSON!==this.toJSON)h=c.toJSON(o);else{h={name:o.name,times:Kv(o.times,Array),values:Kv(o.values,Array)};const m=o.getInterpolation();m!==o.DefaultInterpolation&&(h.interpolation=m)}return h.type=o.ValueTypeName,h}InterpolantFactoryMethodDiscrete(o){return new iP(this.times,this.values,this.getValueSize(),o)}InterpolantFactoryMethodLinear(o){return new nP(this.times,this.values,this.getValueSize(),o)}InterpolantFactoryMethodSmooth(o){return new XT(this.times,this.values,this.getValueSize(),o)}setInterpolation(o){let c;switch(o){case 2300:c=this.InterpolantFactoryMethodDiscrete;break;case 2301:c=this.InterpolantFactoryMethodLinear;break;case 2302:c=this.InterpolantFactoryMethodSmooth}if(void 0===c){const h="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(o===this.DefaultInterpolation)throw new Error(h);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",h),this}return this.createInterpolant=c,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(o){if(0!==o){const c=this.times;for(let h=0,m=c.length;h!==m;++h)c[h]+=o}return this}scale(o){if(1!==o){const c=this.times;for(let h=0,m=c.length;h!==m;++h)c[h]*=o}return this}trim(o,c){const h=this.times,m=h.length;let M=0,N=m-1;for(;M!==m&&h[M]<o;)++M;for(;-1!==N&&h[N]>c;)--N;if(++N,0!==M||N!==m){M>=N&&(N=Math.max(N,1),M=N-1);const q=this.getValueSize();this.times=h.slice(M,N),this.values=this.values.slice(M*q,N*q)}return this}validate(){let o=!0;const c=this.getValueSize();c-Math.floor(c)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),o=!1);const h=this.times,m=this.values,M=h.length;0===M&&(console.error("THREE.KeyframeTrack: Track is empty.",this),o=!1);let N=null;for(let q=0;q!==M;q++){const de=h[q];if("number"==typeof de&&isNaN(de)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,q,de),o=!1;break}if(null!==N&&N>de){console.error("THREE.KeyframeTrack: Out of order keys.",this,q,de,N),o=!1;break}N=de}if(void 0!==m&&function hy(w){return ArrayBuffer.isView(w)&&!(w instanceof DataView)}(m))for(let q=0,de=m.length;q!==de;++q){const pe=m[q];if(isNaN(pe)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,q,pe),o=!1;break}}return o}optimize(){const o=this.times.slice(),c=this.values.slice(),h=this.getValueSize(),m=2302===this.getInterpolation(),M=o.length-1;let N=1;for(let q=1;q<M;++q){let de=!1;const pe=o[q];if(pe!==o[q+1]&&(1!==q||pe!==o[0]))if(m)de=!0;else{const Ie=q*h,Be=Ie-h,Le=Ie+h;for(let Ke=0;Ke!==h;++Ke){const ft=c[Ie+Ke];if(ft!==c[Be+Ke]||ft!==c[Le+Ke]){de=!0;break}}}if(de){if(q!==N){o[N]=o[q];const Ie=q*h,Be=N*h;for(let Le=0;Le!==h;++Le)c[Be+Le]=c[Ie+Le]}++N}}if(M>0){o[N]=o[M];for(let q=M*h,de=N*h,pe=0;pe!==h;++pe)c[de+pe]=c[q+pe];++N}return N!==o.length?(this.times=o.slice(0,N),this.values=c.slice(0,N*h)):(this.times=o,this.values=c),this}clone(){const o=this.times.slice(),c=this.values.slice(),m=new(0,this.constructor)(this.name,o,c);return m.createInterpolant=this.createInterpolant,m}}Km.prototype.TimeBufferType=Float32Array,Km.prototype.ValueBufferType=Float32Array,Km.prototype.DefaultInterpolation=2301;class py extends Km{}py.prototype.ValueTypeName="bool",py.prototype.ValueBufferType=Array,py.prototype.DefaultInterpolation=2300,py.prototype.InterpolantFactoryMethodLinear=void 0,py.prototype.InterpolantFactoryMethodSmooth=void 0;(class EM extends Km{}).prototype.ValueTypeName="color";(class E_ extends Km{}).prototype.ValueTypeName="number";class rP extends Jv{constructor(o,c,h,m){super(o,c,h,m)}interpolate_(o,c,h,m){const M=this.resultBuffer,N=this.sampleValues,q=this.valueSize,de=(h-c)/(m-c);let pe=o*q;for(let xe=pe+q;pe!==xe;pe+=4)Lu.slerpFlat(M,0,N,pe-q,N,pe,de);return M}}class fw extends Km{InterpolantFactoryMethodLinear(o){return new rP(this.times,this.values,this.getValueSize(),o)}}fw.prototype.ValueTypeName="quaternion",fw.prototype.DefaultInterpolation=2301,fw.prototype.InterpolantFactoryMethodSmooth=void 0;class my extends Km{}my.prototype.ValueTypeName="string",my.prototype.ValueBufferType=Array,my.prototype.DefaultInterpolation=2300,my.prototype.InterpolantFactoryMethodLinear=void 0,my.prototype.InterpolantFactoryMethodSmooth=void 0;(class pw extends Km{}).prototype.ValueTypeName="vector";class dP{constructor(o,c,h=0,m=1/0){this.ray=new lf(o,c),this.near=h,this.far=m,this.camera=null,this.layers=new so,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(o,c){this.ray.set(o,c)}setFromCamera(o,c){c.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(c.matrixWorld),this.ray.direction.set(o.x,o.y,.5).unproject(c).sub(this.ray.origin).normalize(),this.camera=c):c.isOrthographicCamera?(this.ray.origin.set(o.x,o.y,(c.near+c.far)/(c.near-c.far)).unproject(c),this.ray.direction.set(0,0,-1).transformDirection(c.matrixWorld),this.camera=c):console.error("THREE.Raycaster: Unsupported camera type: "+c.type)}intersectObject(o,c=!0,h=[]){return DM(o,this,h,c),h.sort(e3),h}intersectObjects(o,c=!0,h=[]){for(let m=0,M=o.length;m<M;m++)DM(o[m],this,h,c);return h.sort(e3),h}}function e3(w,o){return w.distance-o.distance}function DM(w,o,c,h){if(w.layers.test(o.layers)&&w.raycast(o,c),!0===h){const m=w.children;for(let M=0,N=m.length;M<N;M++)DM(m[M],o,c,!0)}}class IM{constructor(o=!0){this.autoStart=o,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Ay(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let o=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const c=Ay();o=(c-this.oldTime)/1e3,this.oldTime=c,this.elapsedTime+=o}return o}}function Ay(){return(typeof performance>"u"?Date:performance).now()}class _w{constructor(o=1,c=0,h=0){return this.radius=o,this.phi=c,this.theta=h,this}set(o,c,h){return this.radius=o,this.phi=c,this.theta=h,this}copy(o){return this.radius=o.radius,this.phi=o.phi,this.theta=o.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(o){return this.setFromCartesianCoords(o.x,o.y,o.z)}setFromCartesianCoords(o,c,h){return this.radius=Math.sqrt(o*o+c*c+h*h),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(o,h),this.phi=Math.acos(nl(c/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}const PM=new zi;class gy{constructor(o=new zi(1/0,1/0),c=new zi(-1/0,-1/0)){this.isBox2=!0,this.min=o,this.max=c}set(o,c){return this.min.copy(o),this.max.copy(c),this}setFromPoints(o){this.makeEmpty();for(let c=0,h=o.length;c<h;c++)this.expandByPoint(o[c]);return this}setFromCenterAndSize(o,c){const h=PM.copy(c).multiplyScalar(.5);return this.min.copy(o).sub(h),this.max.copy(o).add(h),this}clone(){return(new this.constructor).copy(this)}copy(o){return this.min.copy(o.min),this.max.copy(o.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(o){return this.isEmpty()?o.set(0,0):o.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(o){return this.isEmpty()?o.set(0,0):o.subVectors(this.max,this.min)}expandByPoint(o){return this.min.min(o),this.max.max(o),this}expandByVector(o){return this.min.sub(o),this.max.add(o),this}expandByScalar(o){return this.min.addScalar(-o),this.max.addScalar(o),this}containsPoint(o){return!(o.x<this.min.x||o.x>this.max.x||o.y<this.min.y||o.y>this.max.y)}containsBox(o){return this.min.x<=o.min.x&&o.max.x<=this.max.x&&this.min.y<=o.min.y&&o.max.y<=this.max.y}getParameter(o,c){return c.set((o.x-this.min.x)/(this.max.x-this.min.x),(o.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(o){return!(o.max.x<this.min.x||o.min.x>this.max.x||o.max.y<this.min.y||o.min.y>this.max.y)}clampPoint(o,c){return c.copy(o).clamp(this.min,this.max)}distanceToPoint(o){return this.clampPoint(o,PM).distanceTo(o)}intersect(o){return this.min.max(o.min),this.max.min(o.max),this.isEmpty()&&this.makeEmpty(),this}union(o){return this.min.min(o.min),this.max.max(o.max),this}translate(o){return this.min.add(o),this.max.add(o),this}equals(o){return o.min.equals(this.min)&&o.max.equals(this.max)}}const RM=new Ft,yw=new Ft;class tb{constructor(o=new Ft,c=new Ft){this.start=o,this.end=c}set(o,c){return this.start.copy(o),this.end.copy(c),this}copy(o){return this.start.copy(o.start),this.end.copy(o.end),this}getCenter(o){return o.addVectors(this.start,this.end).multiplyScalar(.5)}delta(o){return o.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(o,c){return this.delta(c).multiplyScalar(o).add(this.start)}closestPointToPointParameter(o,c){RM.subVectors(o,this.start),yw.subVectors(this.end,this.start);const h=yw.dot(yw);let M=yw.dot(RM)/h;return c&&(M=nl(M,0,1)),M}closestPointToPoint(o,c,h){const m=this.closestPointToPointParameter(o,c);return this.delta(h).multiplyScalar(m).add(this.start)}applyMatrix4(o){return this.start.applyMatrix4(o),this.end.applyMatrix4(o),this}equals(o){return o.start.equals(this.start)&&o.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}class t3 extends $C{constructor(o,c=1,h=16776960){const m=h,N=new Cs;N.setAttribute("position",new Bo([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),N.computeBoundingSphere(),super(N,new j1({color:m,toneMapped:!1})),this.type="PlaneHelper",this.plane=o,this.size=c;const de=new Cs;de.setAttribute("position",new Bo([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),de.computeBoundingSphere(),this.add(new Jc(de,new Xc({color:m,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(o){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(o)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}class uP{constructor(){this.type="ShapePath",this.color=new Os,this.subPaths=[],this.currentPath=null}moveTo(o,c){return this.currentPath=new eM,this.subPaths.push(this.currentPath),this.currentPath.moveTo(o,c),this}lineTo(o,c){return this.currentPath.lineTo(o,c),this}quadraticCurveTo(o,c,h,m){return this.currentPath.quadraticCurveTo(o,c,h,m),this}bezierCurveTo(o,c,h,m,M,N){return this.currentPath.bezierCurveTo(o,c,h,m,M,N),this}splineThru(o){return this.currentPath.splineThru(o),this}toShapes(o){function h(ze,Mt){const ct=Mt.length;let Dt=!1;for(let Jt=ct-1,cn=0;cn<ct;Jt=cn++){let rn=Mt[Jt],Rn=Mt[cn],kt=Rn.x-rn.x,Zt=Rn.y-rn.y;if(Math.abs(Zt)>Number.EPSILON){if(Zt<0&&(rn=Mt[cn],kt=-kt,Rn=Mt[Jt],Zt=-Zt),ze.y<rn.y||ze.y>Rn.y)continue;if(ze.y===rn.y){if(ze.x===rn.x)return!0}else{const li=Zt*(ze.x-rn.x)-kt*(ze.y-rn.y);if(0===li)return!0;if(li<0)continue;Dt=!Dt}}else{if(ze.y!==rn.y)continue;if(Rn.x<=ze.x&&ze.x<=rn.x||rn.x<=ze.x&&ze.x<=Rn.x)return!0}}return Dt}const m=Ym.isClockWise,M=this.subPaths;if(0===M.length)return[];let N,q,de;const pe=[];if(1===M.length)return q=M[0],de=new ey,de.curves=q.curves,pe.push(de),pe;let xe=!m(M[0].getPoints());xe=o?!xe:xe;const Ie=[],Be=[];let ft,We,Le=[],Ke=0;Be[Ke]=void 0,Le[Ke]=[];for(let ze=0,Mt=M.length;ze<Mt;ze++)q=M[ze],ft=q.getPoints(),N=m(ft),N=o?!N:N,N?(!xe&&Be[Ke]&&Ke++,Be[Ke]={s:new ey,p:ft},Be[Ke].s.curves=q.curves,xe&&Ke++,Le[Ke]=[]):Le[Ke].push({h:q,p:ft[0]});if(!Be[0])return function c(ze){const Mt=[];for(let ct=0,Dt=ze.length;ct<Dt;ct++){const Jt=ze[ct],cn=new ey;cn.curves=Jt.curves,Mt.push(cn)}return Mt}(M);if(Be.length>1){let ze=!1,Mt=0;for(let ct=0,Dt=Be.length;ct<Dt;ct++)Ie[ct]=[];for(let ct=0,Dt=Be.length;ct<Dt;ct++){const Jt=Le[ct];for(let cn=0;cn<Jt.length;cn++){const rn=Jt[cn];let Rn=!0;for(let kt=0;kt<Be.length;kt++)h(rn.p,Be[kt].p)&&(ct!==kt&&Mt++,Rn?(Rn=!1,Ie[kt].push(rn)):ze=!0);Rn&&Ie[ct].push(rn)}}Mt>0&&!1===ze&&(Le=Ie)}for(let ze=0,Mt=Be.length;ze<Mt;ze++){de=Be[ze].s,pe.push(de),We=Le[ze];for(let ct=0,Dt=We.length;ct<Dt;ct++)de.holes.push(We[ct].h)}return pe}}class n3 extends Hv{constructor(o,c={}){const h=c.font;if(void 0===h)super();else{const m=h.generateShapes(o,c.size);c.depth=void 0!==c.height?c.height:50,void 0===c.bevelThickness&&(c.bevelThickness=10),void 0===c.bevelSize&&(c.bevelSize=8),void 0===c.bevelEnabled&&(c.bevelEnabled=!1),super(m,c)}this.type="TextGeometry"}}var r3={0:{x_min:73,x_max:715,ha:792,o:"m 394 -29 q 153 129 242 -29 q 73 479 73 272 q 152 829 73 687 q 394 989 241 989 q 634 829 545 989 q 715 479 715 684 q 635 129 715 270 q 394 -29 546 -29 m 394 89 q 546 211 489 89 q 598 479 598 322 q 548 748 598 640 q 394 871 491 871 q 241 748 298 871 q 190 479 190 637 q 239 211 190 319 q 394 89 296 89 "},1:{x_min:215.671875,x_max:574,ha:792,o:"m 574 0 l 442 0 l 442 697 l 215 697 l 215 796 q 386 833 330 796 q 475 986 447 875 l 574 986 l 574 0 "},2:{x_min:59,x_max:731,ha:792,o:"m 731 0 l 59 0 q 197 314 59 188 q 457 487 199 315 q 598 691 598 580 q 543 819 598 772 q 411 867 488 867 q 272 811 328 867 q 209 630 209 747 l 81 630 q 182 901 81 805 q 408 986 271 986 q 629 909 536 986 q 731 694 731 826 q 613 449 731 541 q 378 316 495 383 q 201 122 235 234 l 731 122 l 731 0 "},3:{x_min:54,x_max:737,ha:792,o:"m 737 284 q 635 55 737 141 q 399 -25 541 -25 q 156 52 248 -25 q 54 308 54 140 l 185 308 q 245 147 185 202 q 395 96 302 96 q 539 140 484 96 q 602 280 602 190 q 510 429 602 390 q 324 454 451 454 l 324 565 q 487 584 441 565 q 565 719 565 617 q 515 835 565 791 q 395 879 466 879 q 255 824 307 879 q 203 661 203 769 l 78 661 q 166 909 78 822 q 387 992 250 992 q 603 921 513 992 q 701 723 701 844 q 669 607 701 656 q 578 524 637 558 q 696 434 655 499 q 737 284 737 369 "},4:{x_min:48,x_max:742.453125,ha:792,o:"m 742 243 l 602 243 l 602 0 l 476 0 l 476 243 l 48 243 l 48 368 l 476 958 l 602 958 l 602 354 l 742 354 l 742 243 m 476 354 l 476 792 l 162 354 l 476 354 "},5:{x_min:54.171875,x_max:738,ha:792,o:"m 738 314 q 626 60 738 153 q 382 -23 526 -23 q 155 47 248 -23 q 54 256 54 125 l 183 256 q 259 132 204 174 q 382 91 314 91 q 533 149 471 91 q 602 314 602 213 q 538 469 602 411 q 386 528 475 528 q 284 506 332 528 q 197 439 237 484 l 81 439 l 159 958 l 684 958 l 684 840 l 254 840 l 214 579 q 306 627 258 612 q 407 643 354 643 q 636 552 540 643 q 738 314 738 457 "},6:{x_min:53,x_max:739,ha:792,o:"m 739 312 q 633 62 739 162 q 400 -31 534 -31 q 162 78 257 -31 q 53 439 53 206 q 178 859 53 712 q 441 986 284 986 q 643 912 559 986 q 732 713 732 833 l 601 713 q 544 830 594 786 q 426 875 494 875 q 268 793 331 875 q 193 517 193 697 q 301 597 240 570 q 427 624 362 624 q 643 540 552 624 q 739 312 739 451 m 603 298 q 540 461 603 400 q 404 516 484 516 q 268 461 323 516 q 207 300 207 401 q 269 137 207 198 q 405 83 325 83 q 541 137 486 83 q 603 298 603 197 "},7:{x_min:58.71875,x_max:730.953125,ha:792,o:"m 730 839 q 469 448 560 641 q 335 0 378 255 l 192 0 q 328 441 235 252 q 593 830 421 630 l 58 830 l 58 958 l 730 958 l 730 839 "},8:{x_min:55,x_max:736,ha:792,o:"m 571 527 q 694 424 652 491 q 736 280 736 358 q 648 71 736 158 q 395 -26 551 -26 q 142 69 238 -26 q 55 279 55 157 q 96 425 55 359 q 220 527 138 491 q 120 615 153 562 q 88 726 88 668 q 171 904 88 827 q 395 986 261 986 q 618 905 529 986 q 702 727 702 830 q 670 616 702 667 q 571 527 638 565 m 394 565 q 519 610 475 565 q 563 717 563 655 q 521 823 563 781 q 392 872 474 872 q 265 824 312 872 q 224 720 224 783 q 265 613 224 656 q 394 565 312 565 m 395 91 q 545 150 488 91 q 597 280 597 204 q 546 408 597 355 q 395 465 492 465 q 244 408 299 465 q 194 280 194 356 q 244 150 194 203 q 395 91 299 91 "},9:{x_min:53,x_max:739,ha:792,o:"m 739 524 q 619 94 739 241 q 362 -32 516 -32 q 150 47 242 -32 q 59 244 59 126 l 191 244 q 246 129 191 176 q 373 82 301 82 q 526 161 466 82 q 597 440 597 255 q 363 334 501 334 q 130 432 216 334 q 53 650 53 521 q 134 880 53 786 q 383 986 226 986 q 659 841 566 986 q 739 524 739 719 m 388 449 q 535 514 480 449 q 585 658 585 573 q 535 805 585 744 q 388 873 480 873 q 242 809 294 873 q 191 658 191 745 q 239 514 191 572 q 388 449 292 449 "},\u03bf:{x_min:0,x_max:712,ha:815,o:"m 356 -25 q 96 88 192 -25 q 0 368 0 201 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 "},S:{x_min:0,x_max:788,ha:890,o:"m 788 291 q 662 54 788 144 q 397 -26 550 -26 q 116 68 226 -26 q 0 337 0 168 l 131 337 q 200 152 131 220 q 384 85 269 85 q 557 129 479 85 q 650 270 650 183 q 490 429 650 379 q 194 513 341 470 q 33 739 33 584 q 142 964 33 881 q 388 1041 242 1041 q 644 957 543 1041 q 756 716 756 867 l 625 716 q 561 874 625 816 q 395 933 497 933 q 243 891 309 933 q 164 759 164 841 q 325 609 164 656 q 625 526 475 568 q 788 291 788 454 "},"\xa6":{x_min:343,x_max:449,ha:792,o:"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},"/":{x_min:183.25,x_max:608.328125,ha:792,o:"m 608 1041 l 266 -129 l 183 -129 l 520 1041 l 608 1041 "},\u03a4:{x_min:-.4375,x_max:777.453125,ha:839,o:"m 777 893 l 458 893 l 458 0 l 319 0 l 319 892 l 0 892 l 0 1013 l 777 1013 l 777 893 "},y:{x_min:0,x_max:684.78125,ha:771,o:"m 684 738 l 388 -83 q 311 -216 356 -167 q 173 -279 252 -279 q 97 -266 133 -279 l 97 -149 q 132 -155 109 -151 q 168 -160 155 -160 q 240 -114 213 -160 q 274 -26 248 -98 l 0 738 l 137 737 l 341 139 l 548 737 l 684 738 "},\u03a0:{x_min:0,x_max:803,ha:917,o:"m 803 0 l 667 0 l 667 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 803 1012 l 803 0 "},\u0390:{x_min:-111,x_max:339,ha:361,o:"m 339 800 l 229 800 l 229 925 l 339 925 l 339 800 m -1 800 l -111 800 l -111 925 l -1 925 l -1 800 m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 m 302 1040 l 113 819 l 30 819 l 165 1040 l 302 1040 "},g:{x_min:0,x_max:686,ha:838,o:"m 686 34 q 586 -213 686 -121 q 331 -306 487 -306 q 131 -252 216 -306 q 31 -84 31 -190 l 155 -84 q 228 -174 166 -138 q 345 -207 284 -207 q 514 -109 454 -207 q 564 89 564 -27 q 461 6 521 36 q 335 -23 401 -23 q 88 100 184 -23 q 0 370 0 215 q 87 634 0 522 q 330 758 183 758 q 457 728 398 758 q 564 644 515 699 l 564 737 l 686 737 l 686 34 m 582 367 q 529 560 582 481 q 358 652 468 652 q 189 561 250 652 q 135 369 135 482 q 189 176 135 255 q 361 85 251 85 q 529 176 468 85 q 582 367 582 255 "},"\xb2":{x_min:0,x_max:442,ha:539,o:"m 442 383 l 0 383 q 91 566 0 492 q 260 668 176 617 q 354 798 354 727 q 315 875 354 845 q 227 905 277 905 q 136 869 173 905 q 99 761 99 833 l 14 761 q 82 922 14 864 q 232 974 141 974 q 379 926 316 974 q 442 797 442 878 q 351 635 442 704 q 183 539 321 611 q 92 455 92 491 l 442 455 l 442 383 "},"\u2013":{x_min:0,x_max:705.5625,ha:803,o:"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},\u039a:{x_min:0,x_max:819.5625,ha:893,o:"m 819 0 l 650 0 l 294 509 l 139 356 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},\u0192:{x_min:-46.265625,x_max:392,ha:513,o:"m 392 651 l 259 651 l 79 -279 l -46 -278 l 134 651 l 14 651 l 14 751 l 135 751 q 151 948 135 900 q 304 1041 185 1041 q 334 1040 319 1041 q 392 1034 348 1039 l 392 922 q 337 931 360 931 q 271 883 287 931 q 260 793 260 853 l 260 751 l 392 751 l 392 651 "},e:{x_min:0,x_max:714,ha:813,o:"m 714 326 l 140 326 q 200 157 140 227 q 359 87 260 87 q 488 130 431 87 q 561 245 545 174 l 697 245 q 577 48 670 123 q 358 -26 484 -26 q 97 85 195 -26 q 0 363 0 197 q 94 642 0 529 q 358 765 195 765 q 626 627 529 765 q 714 326 714 503 m 576 429 q 507 583 564 522 q 355 650 445 650 q 206 583 266 650 q 140 429 152 522 l 576 429 "},\u03cc:{x_min:0,x_max:712,ha:815,o:"m 356 -25 q 94 91 194 -25 q 0 368 0 202 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 m 576 1040 l 387 819 l 303 819 l 438 1040 l 576 1040 "},J:{x_min:0,x_max:588,ha:699,o:"m 588 279 q 287 -26 588 -26 q 58 73 126 -26 q 0 327 0 158 l 133 327 q 160 172 133 227 q 288 96 198 96 q 426 171 391 96 q 449 336 449 219 l 449 1013 l 588 1013 l 588 279 "},"\xbb":{x_min:-1,x_max:503,ha:601,o:"m 503 302 l 280 136 l 281 256 l 429 373 l 281 486 l 280 608 l 503 440 l 503 302 m 221 302 l 0 136 l 0 255 l 145 372 l 0 486 l -1 608 l 221 440 l 221 302 "},"\xa9":{x_min:-3,x_max:1008,ha:1106,o:"m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 741 394 q 661 246 731 302 q 496 190 591 190 q 294 285 369 190 q 228 497 228 370 q 295 714 228 625 q 499 813 370 813 q 656 762 588 813 q 733 625 724 711 l 634 625 q 589 704 629 673 q 498 735 550 735 q 377 666 421 735 q 334 504 334 597 q 374 340 334 408 q 490 272 415 272 q 589 304 549 272 q 638 394 628 337 l 741 394 "},\u03ce:{x_min:0,x_max:922,ha:1030,o:"m 687 1040 l 498 819 l 415 819 l 549 1040 l 687 1040 m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 338 0 202 q 45 551 0 444 q 161 737 84 643 l 302 737 q 175 552 219 647 q 124 336 124 446 q 155 179 124 248 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 341 797 257 q 745 555 797 450 q 619 737 705 637 l 760 737 q 874 551 835 640 q 922 339 922 444 "},"^":{x_min:193.0625,x_max:598.609375,ha:792,o:"m 598 772 l 515 772 l 395 931 l 277 772 l 193 772 l 326 1013 l 462 1013 l 598 772 "},"\xab":{x_min:0,x_max:507.203125,ha:604,o:"m 506 136 l 284 302 l 284 440 l 506 608 l 507 485 l 360 371 l 506 255 l 506 136 m 222 136 l 0 302 l 0 440 l 222 608 l 221 486 l 73 373 l 222 256 l 222 136 "},D:{x_min:0,x_max:828,ha:935,o:"m 389 1013 q 714 867 593 1013 q 828 521 828 729 q 712 161 828 309 q 382 0 587 0 l 0 0 l 0 1013 l 389 1013 m 376 124 q 607 247 523 124 q 681 510 681 355 q 607 771 681 662 q 376 896 522 896 l 139 896 l 139 124 l 376 124 "},"\u2219":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},\u00ff:{x_min:0,x_max:47,ha:125,o:"m 47 3 q 37 -7 47 -7 q 28 0 30 -7 q 39 -4 32 -4 q 45 3 45 -1 l 37 0 q 28 9 28 0 q 39 19 28 19 l 47 16 l 47 19 l 47 3 m 37 1 q 44 8 44 1 q 37 16 44 16 q 30 8 30 16 q 37 1 30 1 m 26 1 l 23 22 l 14 0 l 3 22 l 3 3 l 0 25 l 13 1 l 22 25 l 26 1 "},w:{x_min:0,x_max:1009.71875,ha:1100,o:"m 1009 738 l 783 0 l 658 0 l 501 567 l 345 0 l 222 0 l 0 738 l 130 738 l 284 174 l 432 737 l 576 738 l 721 173 l 881 737 l 1009 738 "},$:{x_min:0,x_max:700,ha:793,o:"m 664 717 l 542 717 q 490 825 531 785 q 381 872 450 865 l 381 551 q 620 446 540 522 q 700 241 700 370 q 618 45 700 116 q 381 -25 536 -25 l 381 -152 l 307 -152 l 307 -25 q 81 62 162 -25 q 0 297 0 149 l 124 297 q 169 146 124 204 q 307 81 215 89 l 307 441 q 80 536 148 469 q 13 725 13 603 q 96 910 13 839 q 307 982 180 982 l 307 1077 l 381 1077 l 381 982 q 574 917 494 982 q 664 717 664 845 m 307 565 l 307 872 q 187 831 233 872 q 142 724 142 791 q 180 618 142 656 q 307 565 218 580 m 381 76 q 562 237 562 96 q 517 361 562 313 q 381 423 472 409 l 381 76 "},"\\":{x_min:-.015625,x_max:425.0625,ha:522,o:"m 425 -129 l 337 -129 l 0 1041 l 83 1041 l 425 -129 "},\u00b5:{x_min:0,x_max:697.21875,ha:747,o:"m 697 -4 q 629 -14 658 -14 q 498 97 513 -14 q 422 9 470 41 q 313 -23 374 -23 q 207 4 258 -23 q 119 81 156 32 l 119 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 173 124 246 q 308 83 216 83 q 452 178 402 83 q 493 359 493 255 l 493 738 l 617 738 l 617 214 q 623 136 617 160 q 673 92 637 92 q 697 96 684 92 l 697 -4 "},\u0399:{x_min:42,x_max:181,ha:297,o:"m 181 0 l 42 0 l 42 1013 l 181 1013 l 181 0 "},\u038e:{x_min:0,x_max:1144.5,ha:1214,o:"m 1144 1012 l 807 416 l 807 0 l 667 0 l 667 416 l 325 1012 l 465 1012 l 736 533 l 1004 1012 l 1144 1012 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"\u2019":{x_min:0,x_max:139,ha:236,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},\u039d:{x_min:0,x_max:801,ha:915,o:"m 801 0 l 651 0 l 131 822 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 191 l 670 1013 l 801 1013 l 801 0 "},"-":{x_min:8.71875,x_max:350.390625,ha:478,o:"m 350 317 l 8 317 l 8 428 l 350 428 l 350 317 "},Q:{x_min:0,x_max:968,ha:1072,o:"m 954 5 l 887 -79 l 744 35 q 622 -11 687 2 q 483 -26 556 -26 q 127 130 262 -26 q 0 504 0 279 q 127 880 0 728 q 484 1041 262 1041 q 841 884 708 1041 q 968 507 968 735 q 933 293 968 398 q 832 104 899 188 l 954 5 m 723 191 q 802 330 777 248 q 828 499 828 412 q 744 790 828 673 q 483 922 650 922 q 228 791 322 922 q 142 505 142 673 q 227 221 142 337 q 487 91 323 91 q 632 123 566 91 l 520 215 l 587 301 l 723 191 "},\u03c2:{x_min:1,x_max:676.28125,ha:740,o:"m 676 460 l 551 460 q 498 595 542 546 q 365 651 448 651 q 199 578 263 651 q 136 401 136 505 q 266 178 136 241 q 508 106 387 142 q 640 -50 640 62 q 625 -158 640 -105 q 583 -278 611 -211 l 465 -278 q 498 -182 490 -211 q 515 -80 515 -126 q 381 12 515 -15 q 134 91 197 51 q 1 388 1 179 q 100 651 1 542 q 354 761 199 761 q 587 680 498 761 q 676 460 676 599 "},M:{x_min:0,x_max:954,ha:1067,o:"m 954 0 l 819 0 l 819 869 l 537 0 l 405 0 l 128 866 l 128 0 l 0 0 l 0 1013 l 200 1013 l 472 160 l 757 1013 l 954 1013 l 954 0 "},\u03a8:{x_min:0,x_max:1006,ha:1094,o:"m 1006 678 q 914 319 1006 429 q 571 200 814 200 l 571 0 l 433 0 l 433 200 q 92 319 194 200 q 0 678 0 429 l 0 1013 l 139 1013 l 139 679 q 191 417 139 492 q 433 326 255 326 l 433 1013 l 571 1013 l 571 326 l 580 326 q 813 423 747 326 q 868 679 868 502 l 868 1013 l 1006 1013 l 1006 678 "},C:{x_min:0,x_max:886,ha:944,o:"m 886 379 q 760 87 886 201 q 455 -26 634 -26 q 112 136 236 -26 q 0 509 0 283 q 118 882 0 737 q 469 1041 245 1041 q 748 955 630 1041 q 879 708 879 859 l 745 708 q 649 862 724 805 q 473 920 573 920 q 219 791 312 920 q 136 509 136 675 q 217 229 136 344 q 470 99 311 99 q 672 179 591 99 q 753 379 753 259 l 886 379 "},"!":{x_min:0,x_max:138,ha:236,o:"m 138 684 q 116 409 138 629 q 105 244 105 299 l 33 244 q 16 465 33 313 q 0 684 0 616 l 0 1013 l 138 1013 l 138 684 m 138 0 l 0 0 l 0 151 l 138 151 l 138 0 "},"{":{x_min:0,x_max:480.5625,ha:578,o:"m 480 -286 q 237 -213 303 -286 q 187 -45 187 -159 q 194 48 187 -15 q 201 141 201 112 q 164 264 201 225 q 0 314 118 314 l 0 417 q 164 471 119 417 q 201 605 201 514 q 199 665 201 644 q 193 772 193 769 q 241 941 193 887 q 480 1015 308 1015 l 480 915 q 336 866 375 915 q 306 742 306 828 q 310 662 306 717 q 314 577 314 606 q 288 452 314 500 q 176 365 256 391 q 289 275 257 337 q 314 143 314 226 q 313 84 314 107 q 310 -11 310 -5 q 339 -131 310 -94 q 480 -182 377 -182 l 480 -286 "},X:{x_min:-.015625,x_max:854.15625,ha:940,o:"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 428 637 l 675 1013 l 836 1013 l 504 520 l 854 0 "},"#":{x_min:0,x_max:963.890625,ha:1061,o:"m 963 690 l 927 590 l 719 590 l 655 410 l 876 410 l 840 310 l 618 310 l 508 -3 l 393 -2 l 506 309 l 329 310 l 215 -2 l 102 -3 l 212 310 l 0 310 l 36 410 l 248 409 l 312 590 l 86 590 l 120 690 l 347 690 l 459 1006 l 573 1006 l 462 690 l 640 690 l 751 1006 l 865 1006 l 754 690 l 963 690 m 606 590 l 425 590 l 362 410 l 543 410 l 606 590 "},\u03b9:{x_min:42,x_max:284,ha:361,o:"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 738 l 167 738 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 "},\u0386:{x_min:0,x_max:906.953125,ha:982,o:"m 283 1040 l 88 799 l 5 799 l 145 1040 l 283 1040 m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1012 l 529 1012 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},")":{x_min:0,x_max:318,ha:415,o:"m 318 365 q 257 25 318 191 q 87 -290 197 -141 l 0 -290 q 140 21 93 -128 q 193 360 193 189 q 141 704 193 537 q 0 1024 97 850 l 87 1024 q 257 706 197 871 q 318 365 318 542 "},\u03b5:{x_min:0,x_max:634.71875,ha:714,o:"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 314 0 265 q 128 390 67 353 q 56 460 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 "},\u0394:{x_min:0,x_max:952.78125,ha:1028,o:"m 952 0 l 0 0 l 400 1013 l 551 1013 l 952 0 m 762 124 l 476 867 l 187 124 l 762 124 "},"}":{x_min:0,x_max:481,ha:578,o:"m 481 314 q 318 262 364 314 q 282 136 282 222 q 284 65 282 97 q 293 -58 293 -48 q 241 -217 293 -166 q 0 -286 174 -286 l 0 -182 q 143 -130 105 -182 q 171 -2 171 -93 q 168 81 171 22 q 165 144 165 140 q 188 275 165 229 q 306 365 220 339 q 191 455 224 391 q 165 588 165 505 q 168 681 165 624 q 171 742 171 737 q 141 865 171 827 q 0 915 102 915 l 0 1015 q 243 942 176 1015 q 293 773 293 888 q 287 675 293 741 q 282 590 282 608 q 318 466 282 505 q 481 417 364 417 l 481 314 "},"\u2030":{x_min:-3,x_max:1672,ha:1821,o:"m 846 0 q 664 76 732 0 q 603 244 603 145 q 662 412 603 344 q 846 489 729 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 846 0 962 0 m 845 103 q 945 143 910 103 q 981 243 981 184 q 947 340 981 301 q 845 385 910 385 q 745 342 782 385 q 709 243 709 300 q 742 147 709 186 q 845 103 781 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 m 1428 0 q 1246 76 1314 0 q 1185 244 1185 145 q 1244 412 1185 344 q 1428 489 1311 489 q 1610 412 1542 489 q 1672 244 1672 343 q 1612 76 1672 144 q 1428 0 1545 0 m 1427 103 q 1528 143 1492 103 q 1564 243 1564 184 q 1530 340 1564 301 q 1427 385 1492 385 q 1327 342 1364 385 q 1291 243 1291 300 q 1324 147 1291 186 q 1427 103 1363 103 "},a:{x_min:0,x_max:698.609375,ha:794,o:"m 698 0 q 661 -12 679 -7 q 615 -17 643 -17 q 536 12 564 -17 q 500 96 508 41 q 384 6 456 37 q 236 -25 312 -25 q 65 31 130 -25 q 0 194 0 88 q 118 390 0 334 q 328 435 180 420 q 488 483 476 451 q 495 523 495 504 q 442 619 495 584 q 325 654 389 654 q 209 617 257 654 q 152 513 161 580 l 33 513 q 123 705 33 633 q 332 772 207 772 q 528 712 448 772 q 617 531 617 645 l 617 163 q 624 108 617 126 q 664 90 632 90 l 698 94 l 698 0 m 491 262 l 491 372 q 272 329 350 347 q 128 201 128 294 q 166 113 128 144 q 264 83 205 83 q 414 130 346 83 q 491 262 491 183 "},"\u2014":{x_min:0,x_max:941.671875,ha:1039,o:"m 941 334 l 0 334 l 0 410 l 941 410 l 941 334 "},"=":{x_min:8.71875,x_max:780.953125,ha:792,o:"m 780 510 l 8 510 l 8 606 l 780 606 l 780 510 m 780 235 l 8 235 l 8 332 l 780 332 l 780 235 "},N:{x_min:0,x_max:801,ha:914,o:"m 801 0 l 651 0 l 131 823 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 193 l 670 1013 l 801 1013 l 801 0 "},\u03c1:{x_min:0,x_max:712,ha:797,o:"m 712 369 q 620 94 712 207 q 362 -26 521 -26 q 230 2 292 -26 q 119 83 167 30 l 119 -278 l 0 -278 l 0 362 q 91 643 0 531 q 355 764 190 764 q 617 647 517 764 q 712 369 712 536 m 583 366 q 530 559 583 480 q 359 651 469 651 q 190 562 252 651 q 135 370 135 483 q 189 176 135 257 q 359 85 250 85 q 528 175 466 85 q 583 366 583 254 "},"\xaf":{x_min:0,x_max:941.671875,ha:938,o:"m 941 1033 l 0 1033 l 0 1109 l 941 1109 l 941 1033 "},Z:{x_min:0,x_max:779,ha:849,o:"m 779 0 l 0 0 l 0 113 l 621 896 l 40 896 l 40 1013 l 779 1013 l 778 887 l 171 124 l 779 124 l 779 0 "},u:{x_min:0,x_max:617,ha:729,o:"m 617 0 l 499 0 l 499 110 q 391 10 460 45 q 246 -25 322 -25 q 61 58 127 -25 q 0 258 0 136 l 0 738 l 125 738 l 125 284 q 156 148 125 202 q 273 82 197 82 q 433 165 369 82 q 493 340 493 243 l 493 738 l 617 738 l 617 0 "},k:{x_min:0,x_max:612.484375,ha:697,o:"m 612 738 l 338 465 l 608 0 l 469 0 l 251 382 l 121 251 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 402 l 456 738 l 612 738 "},\u0397:{x_min:0,x_max:803,ha:917,o:"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},\u0391:{x_min:0,x_max:906.953125,ha:985,o:"m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},s:{x_min:0,x_max:604,ha:697,o:"m 604 217 q 501 36 604 104 q 292 -23 411 -23 q 86 43 166 -23 q 0 238 0 114 l 121 237 q 175 122 121 164 q 300 85 223 85 q 415 112 363 85 q 479 207 479 147 q 361 309 479 276 q 140 372 141 370 q 21 544 21 426 q 111 708 21 647 q 298 761 190 761 q 492 705 413 761 q 583 531 583 643 l 462 531 q 412 625 462 594 q 298 657 363 657 q 199 636 242 657 q 143 558 143 608 q 262 454 143 486 q 484 394 479 397 q 604 217 604 341 "},B:{x_min:0,x_max:778,ha:876,o:"m 580 546 q 724 469 670 535 q 778 311 778 403 q 673 83 778 171 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 892 q 691 633 732 693 q 580 546 650 572 m 393 899 l 139 899 l 139 588 l 379 588 q 521 624 462 588 q 592 744 592 667 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 303 635 219 q 559 436 635 389 q 402 477 494 477 l 139 477 l 139 124 l 419 124 "},"\u2026":{x_min:0,x_max:614,ha:708,o:"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 m 378 0 l 236 0 l 236 151 l 378 151 l 378 0 m 614 0 l 472 0 l 472 151 l 614 151 l 614 0 "},"?":{x_min:0,x_max:607,ha:704,o:"m 607 777 q 543 599 607 674 q 422 474 482 537 q 357 272 357 391 l 236 272 q 297 487 236 395 q 411 619 298 490 q 474 762 474 691 q 422 885 474 838 q 301 933 371 933 q 179 880 228 933 q 124 706 124 819 l 0 706 q 94 963 0 872 q 302 1044 177 1044 q 511 973 423 1044 q 607 777 607 895 m 370 0 l 230 0 l 230 151 l 370 151 l 370 0 "},H:{x_min:0,x_max:803,ha:915,o:"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},\u03bd:{x_min:0,x_max:675,ha:761,o:"m 675 738 l 404 0 l 272 0 l 0 738 l 133 738 l 340 147 l 541 738 l 675 738 "},c:{x_min:1,x_max:701.390625,ha:775,o:"m 701 264 q 584 53 681 133 q 353 -26 487 -26 q 91 91 188 -26 q 1 370 1 201 q 92 645 1 537 q 353 761 190 761 q 572 688 479 761 q 690 493 666 615 l 556 493 q 487 606 545 562 q 356 650 428 650 q 186 563 246 650 q 134 372 134 487 q 188 179 134 258 q 359 88 250 88 q 492 136 437 88 q 566 264 548 185 l 701 264 "},"\xb6":{x_min:0,x_max:566.671875,ha:678,o:"m 21 892 l 52 892 l 98 761 l 145 892 l 176 892 l 178 741 l 157 741 l 157 867 l 108 741 l 88 741 l 40 871 l 40 741 l 21 741 l 21 892 m 308 854 l 308 731 q 252 691 308 691 q 227 691 240 691 q 207 696 213 695 l 207 712 l 253 706 q 288 733 288 706 l 288 763 q 244 741 279 741 q 193 797 193 741 q 261 860 193 860 q 287 860 273 860 q 308 854 302 855 m 288 842 l 263 843 q 213 796 213 843 q 248 756 213 756 q 288 796 288 756 l 288 842 m 566 988 l 502 988 l 502 -1 l 439 -1 l 439 988 l 317 988 l 317 -1 l 252 -1 l 252 602 q 81 653 155 602 q 0 805 0 711 q 101 989 0 918 q 309 1053 194 1053 l 566 1053 l 566 988 "},\u03b2:{x_min:0,x_max:660,ha:745,o:"m 471 550 q 610 450 561 522 q 660 280 660 378 q 578 64 660 151 q 367 -22 497 -22 q 239 5 299 -22 q 126 82 178 32 l 126 -278 l 0 -278 l 0 593 q 54 903 0 801 q 318 1042 127 1042 q 519 964 436 1042 q 603 771 603 887 q 567 644 603 701 q 471 550 532 586 m 337 79 q 476 138 418 79 q 535 279 535 198 q 427 437 535 386 q 226 477 344 477 l 226 583 q 398 620 329 583 q 486 762 486 668 q 435 884 486 833 q 312 935 384 935 q 169 861 219 935 q 126 698 126 797 l 126 362 q 170 169 126 242 q 337 79 224 79 "},\u039c:{x_min:0,x_max:954,ha:1068,o:"m 954 0 l 819 0 l 819 868 l 537 0 l 405 0 l 128 865 l 128 0 l 0 0 l 0 1013 l 199 1013 l 472 158 l 758 1013 l 954 1013 l 954 0 "},\u038c:{x_min:.109375,x_max:1120,ha:1217,o:"m 1120 505 q 994 132 1120 282 q 642 -29 861 -29 q 290 130 422 -29 q 167 505 167 280 q 294 883 167 730 q 650 1046 430 1046 q 999 882 868 1046 q 1120 505 1120 730 m 977 504 q 896 784 977 669 q 644 915 804 915 q 391 785 484 915 q 307 504 307 669 q 391 224 307 339 q 644 95 486 95 q 894 224 803 95 q 977 504 977 339 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},\u0389:{x_min:0,x_max:1158,ha:1275,o:"m 1158 0 l 1022 0 l 1022 475 l 496 475 l 496 0 l 356 0 l 356 1012 l 496 1012 l 496 599 l 1022 599 l 1022 1012 l 1158 1012 l 1158 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"\u2022":{x_min:0,x_max:663.890625,ha:775,o:"m 663 529 q 566 293 663 391 q 331 196 469 196 q 97 294 194 196 q 0 529 0 393 q 96 763 0 665 q 331 861 193 861 q 566 763 469 861 q 663 529 663 665 "},"\xa5":{x_min:.1875,x_max:819.546875,ha:886,o:"m 563 561 l 697 561 l 696 487 l 520 487 l 482 416 l 482 380 l 697 380 l 695 308 l 482 308 l 482 0 l 342 0 l 342 308 l 125 308 l 125 380 l 342 380 l 342 417 l 303 487 l 125 487 l 125 561 l 258 561 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 l 563 561 "},"(":{x_min:0,x_max:318.0625,ha:415,o:"m 318 -290 l 230 -290 q 61 23 122 -142 q 0 365 0 190 q 62 712 0 540 q 230 1024 119 869 l 318 1024 q 175 705 219 853 q 125 360 125 542 q 176 22 125 187 q 318 -290 223 -127 "},U:{x_min:0,x_max:796,ha:904,o:"m 796 393 q 681 93 796 212 q 386 -25 566 -25 q 101 95 208 -25 q 0 393 0 211 l 0 1013 l 138 1013 l 138 391 q 204 191 138 270 q 394 107 276 107 q 586 191 512 107 q 656 391 656 270 l 656 1013 l 796 1013 l 796 393 "},\u03b3:{x_min:.5,x_max:744.953125,ha:822,o:"m 744 737 l 463 54 l 463 -278 l 338 -278 l 338 54 l 154 495 q 104 597 124 569 q 13 651 67 651 l 0 651 l 0 751 l 39 753 q 168 711 121 753 q 242 594 207 676 l 403 208 l 617 737 l 744 737 "},\u03b1:{x_min:0,x_max:765.5625,ha:809,o:"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 728 407 760 q 563 637 524 696 l 563 739 l 685 739 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 96 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 "},F:{x_min:0,x_max:683.328125,ha:717,o:"m 683 888 l 140 888 l 140 583 l 613 583 l 613 458 l 140 458 l 140 0 l 0 0 l 0 1013 l 683 1013 l 683 888 "},"\xad":{x_min:0,x_max:705.5625,ha:803,o:"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},":":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},\u03a7:{x_min:0,x_max:854.171875,ha:935,o:"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 427 637 l 675 1013 l 836 1013 l 504 521 l 854 0 "},"*":{x_min:116,x_max:674,ha:792,o:"m 674 768 l 475 713 l 610 544 l 517 477 l 394 652 l 272 478 l 178 544 l 314 713 l 116 766 l 153 876 l 341 812 l 342 1013 l 446 1013 l 446 811 l 635 874 l 674 768 "},"\u2020":{x_min:0,x_max:777,ha:835,o:"m 458 804 l 777 804 l 777 683 l 458 683 l 458 0 l 319 0 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 "},"\xb0":{x_min:0,x_max:347,ha:444,o:"m 173 802 q 43 856 91 802 q 0 977 0 905 q 45 1101 0 1049 q 173 1153 90 1153 q 303 1098 255 1153 q 347 977 347 1049 q 303 856 347 905 q 173 802 256 802 m 173 884 q 238 910 214 884 q 262 973 262 937 q 239 1038 262 1012 q 173 1064 217 1064 q 108 1037 132 1064 q 85 973 85 1010 q 108 910 85 937 q 173 884 132 884 "},V:{x_min:0,x_max:862.71875,ha:940,o:"m 862 1013 l 505 0 l 361 0 l 0 1013 l 143 1013 l 434 165 l 718 1012 l 862 1013 "},\u039e:{x_min:0,x_max:734.71875,ha:763,o:"m 723 889 l 9 889 l 9 1013 l 723 1013 l 723 889 m 673 463 l 61 463 l 61 589 l 673 589 l 673 463 m 734 0 l 0 0 l 0 124 l 734 124 l 734 0 "},"\xa0":{x_min:0,x_max:0,ha:853},\u03ab:{x_min:.328125,x_max:819.515625,ha:889,o:"m 588 1046 l 460 1046 l 460 1189 l 588 1189 l 588 1046 m 360 1046 l 232 1046 l 232 1189 l 360 1189 l 360 1046 m 819 1012 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1012 l 140 1012 l 411 533 l 679 1012 l 819 1012 "},"\u201d":{x_min:0,x_max:347,ha:454,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 m 347 851 q 310 737 347 784 q 208 669 273 690 l 208 734 q 267 787 250 741 q 280 873 280 821 l 208 873 l 208 1013 l 347 1013 l 347 851 "},"@":{x_min:0,x_max:1260,ha:1357,o:"m 1098 -45 q 877 -160 1001 -117 q 633 -203 752 -203 q 155 -29 327 -203 q 0 360 0 127 q 176 802 0 616 q 687 1008 372 1008 q 1123 854 969 1008 q 1260 517 1260 718 q 1155 216 1260 341 q 868 82 1044 82 q 772 106 801 82 q 737 202 737 135 q 647 113 700 144 q 527 82 594 82 q 367 147 420 82 q 314 312 314 212 q 401 565 314 452 q 639 690 498 690 q 810 588 760 690 l 849 668 l 938 668 q 877 441 900 532 q 833 226 833 268 q 853 182 833 198 q 902 167 873 167 q 1088 272 1012 167 q 1159 512 1159 372 q 1051 793 1159 681 q 687 925 925 925 q 248 747 415 925 q 97 361 97 586 q 226 26 97 159 q 627 -122 370 -122 q 856 -87 737 -122 q 1061 8 976 -53 l 1098 -45 m 786 488 q 738 580 777 545 q 643 615 700 615 q 483 517 548 615 q 425 322 425 430 q 457 203 425 250 q 552 156 490 156 q 722 273 665 156 q 786 488 738 309 "},\u038a:{x_min:0,x_max:499,ha:613,o:"m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 m 499 0 l 360 0 l 360 1012 l 499 1012 l 499 0 "},i:{x_min:14,x_max:136,ha:275,o:"m 136 873 l 14 873 l 14 1013 l 136 1013 l 136 873 m 136 0 l 14 0 l 14 737 l 136 737 l 136 0 "},\u0392:{x_min:0,x_max:778,ha:877,o:"m 580 545 q 724 468 671 534 q 778 310 778 402 q 673 83 778 170 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 891 q 691 632 732 692 q 580 545 650 571 m 393 899 l 139 899 l 139 587 l 379 587 q 521 623 462 587 q 592 744 592 666 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 302 635 219 q 559 435 635 388 q 402 476 494 476 l 139 476 l 139 124 l 419 124 "},\u03c5:{x_min:0,x_max:617,ha:725,o:"m 617 352 q 540 94 617 199 q 308 -24 455 -24 q 76 94 161 -24 q 0 352 0 199 l 0 739 l 126 739 l 126 355 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 355 492 257 l 492 739 l 617 739 l 617 352 "},"]":{x_min:0,x_max:275,ha:372,o:"m 275 -281 l 0 -281 l 0 -187 l 151 -187 l 151 920 l 0 920 l 0 1013 l 275 1013 l 275 -281 "},m:{x_min:0,x_max:1019,ha:1128,o:"m 1019 0 l 897 0 l 897 454 q 860 591 897 536 q 739 660 816 660 q 613 586 659 660 q 573 436 573 522 l 573 0 l 447 0 l 447 455 q 412 591 447 535 q 294 657 372 657 q 165 586 213 657 q 122 437 122 521 l 122 0 l 0 0 l 0 738 l 117 738 l 117 640 q 202 730 150 697 q 316 763 254 763 q 437 730 381 763 q 525 642 494 697 q 621 731 559 700 q 753 763 682 763 q 943 694 867 763 q 1019 512 1019 625 l 1019 0 "},\u03c7:{x_min:8.328125,x_max:780.5625,ha:815,o:"m 780 -278 q 715 -294 747 -294 q 616 -257 663 -294 q 548 -175 576 -227 l 379 133 l 143 -277 l 9 -277 l 313 254 l 163 522 q 127 586 131 580 q 36 640 91 640 q 8 637 27 640 l 8 752 l 52 757 q 162 719 113 757 q 236 627 200 690 l 383 372 l 594 737 l 726 737 l 448 250 l 625 -69 q 670 -153 647 -110 q 743 -188 695 -188 q 780 -184 759 -188 l 780 -278 "},\u03af:{x_min:42,x_max:326.71875,ha:361,o:"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 102 239 101 q 284 112 257 104 l 284 3 m 326 1040 l 137 819 l 54 819 l 189 1040 l 326 1040 "},\u0396:{x_min:0,x_max:779.171875,ha:850,o:"m 779 0 l 0 0 l 0 113 l 620 896 l 40 896 l 40 1013 l 779 1013 l 779 887 l 170 124 l 779 124 l 779 0 "},R:{x_min:0,x_max:781.953125,ha:907,o:"m 781 0 l 623 0 q 587 242 590 52 q 407 433 585 433 l 138 433 l 138 0 l 0 0 l 0 1013 l 396 1013 q 636 946 539 1013 q 749 731 749 868 q 711 597 749 659 q 608 502 674 534 q 718 370 696 474 q 729 207 722 352 q 781 26 736 62 l 781 0 m 373 551 q 533 594 465 551 q 614 731 614 645 q 532 859 614 815 q 373 896 465 896 l 138 896 l 138 551 l 373 551 "},o:{x_min:0,x_max:713,ha:821,o:"m 357 -25 q 94 91 194 -25 q 0 368 0 202 q 93 642 0 533 q 357 761 193 761 q 618 644 518 761 q 713 368 713 533 q 619 91 713 201 q 357 -25 521 -25 m 357 85 q 528 175 465 85 q 584 369 584 255 q 529 562 584 484 q 357 651 467 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 357 85 250 85 "},K:{x_min:0,x_max:819.46875,ha:906,o:"m 819 0 l 649 0 l 294 509 l 139 355 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},",":{x_min:0,x_max:142,ha:239,o:"m 142 -12 q 105 -132 142 -82 q 0 -205 68 -182 l 0 -138 q 57 -82 40 -124 q 70 0 70 -51 l 0 0 l 0 151 l 142 151 l 142 -12 "},d:{x_min:0,x_max:683,ha:796,o:"m 683 0 l 564 0 l 564 93 q 456 6 516 38 q 327 -25 395 -25 q 87 100 181 -25 q 0 365 0 215 q 90 639 0 525 q 343 763 187 763 q 564 647 486 763 l 564 1013 l 683 1013 l 683 0 m 582 373 q 529 562 582 484 q 361 653 468 653 q 190 561 253 653 q 135 365 135 479 q 189 175 135 254 q 358 85 251 85 q 529 178 468 85 q 582 373 582 258 "},"\xa8":{x_min:-109,x_max:247,ha:232,o:"m 247 1046 l 119 1046 l 119 1189 l 247 1189 l 247 1046 m 19 1046 l -109 1046 l -109 1189 l 19 1189 l 19 1046 "},E:{x_min:0,x_max:736.109375,ha:789,o:"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},Y:{x_min:0,x_max:820,ha:886,o:"m 820 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 534 l 679 1012 l 820 1013 "},'"':{x_min:0,x_max:299,ha:396,o:"m 299 606 l 203 606 l 203 988 l 299 988 l 299 606 m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"\u2039":{x_min:17.984375,x_max:773.609375,ha:792,o:"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"\u201e":{x_min:0,x_max:364,ha:467,o:"m 141 -12 q 104 -132 141 -82 q 0 -205 67 -182 l 0 -138 q 56 -82 40 -124 q 69 0 69 -51 l 0 0 l 0 151 l 141 151 l 141 -12 m 364 -12 q 327 -132 364 -82 q 222 -205 290 -182 l 222 -138 q 279 -82 262 -124 q 292 0 292 -51 l 222 0 l 222 151 l 364 151 l 364 -12 "},\u03b4:{x_min:1,x_max:710,ha:810,o:"m 710 360 q 616 87 710 196 q 356 -28 518 -28 q 99 82 197 -28 q 1 356 1 192 q 100 606 1 509 q 355 703 199 703 q 180 829 288 754 q 70 903 124 866 l 70 1012 l 643 1012 l 643 901 l 258 901 q 462 763 422 794 q 636 592 577 677 q 710 360 710 485 m 584 365 q 552 501 584 447 q 451 602 521 555 q 372 611 411 611 q 197 541 258 611 q 136 355 136 472 q 190 171 136 245 q 358 85 252 85 q 528 173 465 85 q 584 365 584 252 "},\u03ad:{x_min:0,x_max:634.71875,ha:714,o:"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 313 0 265 q 128 390 67 352 q 56 459 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 m 520 1040 l 331 819 l 248 819 l 383 1040 l 520 1040 "},\u03c9:{x_min:0,x_max:922,ha:1031,o:"m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 339 0 203 q 45 551 0 444 q 161 738 84 643 l 302 738 q 175 553 219 647 q 124 336 124 446 q 155 179 124 249 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 342 797 257 q 745 556 797 450 q 619 738 705 638 l 760 738 q 874 551 835 640 q 922 339 922 444 "},"\xb4":{x_min:0,x_max:96,ha:251,o:"m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"\xb1":{x_min:11,x_max:781,ha:792,o:"m 781 490 l 446 490 l 446 255 l 349 255 l 349 490 l 11 490 l 11 586 l 349 586 l 349 819 l 446 819 l 446 586 l 781 586 l 781 490 m 781 21 l 11 21 l 11 115 l 781 115 l 781 21 "},"|":{x_min:343,x_max:449,ha:792,o:"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},\u03cb:{x_min:0,x_max:617,ha:725,o:"m 482 800 l 372 800 l 372 925 l 482 925 l 482 800 m 239 800 l 129 800 l 129 925 l 239 925 l 239 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 "},"\xa7":{x_min:0,x_max:593,ha:690,o:"m 593 425 q 554 312 593 369 q 467 233 516 254 q 537 83 537 172 q 459 -74 537 -12 q 288 -133 387 -133 q 115 -69 184 -133 q 47 96 47 -6 l 166 96 q 199 7 166 40 q 288 -26 232 -26 q 371 -5 332 -26 q 420 60 420 21 q 311 201 420 139 q 108 309 210 255 q 0 490 0 383 q 33 602 0 551 q 124 687 66 654 q 75 743 93 712 q 58 812 58 773 q 133 984 58 920 q 300 1043 201 1043 q 458 987 394 1043 q 529 814 529 925 l 411 814 q 370 908 404 877 q 289 939 336 939 q 213 911 246 939 q 180 841 180 883 q 286 720 180 779 q 484 612 480 615 q 593 425 593 534 m 467 409 q 355 544 467 473 q 196 630 228 612 q 146 587 162 609 q 124 525 124 558 q 239 387 124 462 q 398 298 369 315 q 448 345 429 316 q 467 409 467 375 "},b:{x_min:0,x_max:685,ha:783,o:"m 685 372 q 597 99 685 213 q 347 -25 501 -25 q 219 5 277 -25 q 121 93 161 36 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 634 q 214 723 157 692 q 341 754 272 754 q 591 637 493 754 q 685 372 685 526 m 554 356 q 499 550 554 470 q 328 644 437 644 q 162 556 223 644 q 108 369 108 478 q 160 176 108 256 q 330 83 221 83 q 498 169 435 83 q 554 356 554 245 "},q:{x_min:0,x_max:683,ha:876,o:"m 683 -278 l 564 -278 l 564 97 q 474 8 533 39 q 345 -23 415 -23 q 91 93 188 -23 q 0 364 0 203 q 87 635 0 522 q 337 760 184 760 q 466 727 408 760 q 564 637 523 695 l 564 737 l 683 737 l 683 -278 m 582 375 q 527 564 582 488 q 358 652 466 652 q 190 565 253 652 q 135 377 135 488 q 189 179 135 261 q 361 84 251 84 q 530 179 469 84 q 582 375 582 260 "},\u03a9:{x_min:-.171875,x_max:969.5625,ha:1068,o:"m 969 0 l 555 0 l 555 123 q 744 308 675 194 q 814 558 814 423 q 726 812 814 709 q 484 922 633 922 q 244 820 334 922 q 154 567 154 719 q 223 316 154 433 q 412 123 292 199 l 412 0 l 0 0 l 0 124 l 217 124 q 68 327 122 210 q 15 572 15 444 q 144 911 15 781 q 484 1041 274 1041 q 822 909 691 1041 q 953 569 953 777 q 899 326 953 443 q 750 124 846 210 l 969 124 l 969 0 "},\u03cd:{x_min:0,x_max:617,ha:725,o:"m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 535 1040 l 346 819 l 262 819 l 397 1040 l 535 1040 "},z:{x_min:-.015625,x_max:613.890625,ha:697,o:"m 613 0 l 0 0 l 0 100 l 433 630 l 20 630 l 20 738 l 594 738 l 593 636 l 163 110 l 613 110 l 613 0 "},"\u2122":{x_min:0,x_max:894,ha:1e3,o:"m 389 951 l 229 951 l 229 503 l 160 503 l 160 951 l 0 951 l 0 1011 l 389 1011 l 389 951 m 894 503 l 827 503 l 827 939 l 685 503 l 620 503 l 481 937 l 481 503 l 417 503 l 417 1011 l 517 1011 l 653 580 l 796 1010 l 894 1011 l 894 503 "},\u03ae:{x_min:.78125,x_max:697,ha:810,o:"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 721 124 755 q 200 630 193 687 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 m 479 1040 l 290 819 l 207 819 l 341 1040 l 479 1040 "},\u0398:{x_min:0,x_max:960,ha:1056,o:"m 960 507 q 833 129 960 280 q 476 -32 698 -32 q 123 129 255 -32 q 0 507 0 280 q 123 883 0 732 q 476 1045 255 1045 q 832 883 696 1045 q 960 507 960 732 m 817 500 q 733 789 817 669 q 476 924 639 924 q 223 792 317 924 q 142 507 142 675 q 222 222 142 339 q 476 89 315 89 q 730 218 636 89 q 817 500 817 334 m 716 449 l 243 449 l 243 571 l 716 571 l 716 449 "},"\xae":{x_min:-3,x_max:1008,ha:1106,o:"m 503 532 q 614 562 566 532 q 672 658 672 598 q 614 747 672 716 q 503 772 569 772 l 338 772 l 338 532 l 503 532 m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 788 146 l 678 146 q 653 316 655 183 q 527 449 652 449 l 338 449 l 338 146 l 241 146 l 241 854 l 518 854 q 688 808 621 854 q 766 658 766 755 q 739 563 766 607 q 668 497 713 519 q 751 331 747 472 q 788 164 756 190 l 788 146 "},"~":{x_min:0,x_max:833,ha:931,o:"m 833 958 q 778 753 833 831 q 594 665 716 665 q 402 761 502 665 q 240 857 302 857 q 131 795 166 857 q 104 665 104 745 l 0 665 q 54 867 0 789 q 237 958 116 958 q 429 861 331 958 q 594 765 527 765 q 704 827 670 765 q 729 958 729 874 l 833 958 "},\u0395:{x_min:0,x_max:736.21875,ha:778,o:"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},"\xb3":{x_min:0,x_max:450,ha:547,o:"m 450 552 q 379 413 450 464 q 220 366 313 366 q 69 414 130 366 q 0 567 0 470 l 85 567 q 126 470 85 504 q 225 437 168 437 q 320 467 280 437 q 360 552 360 498 q 318 632 360 608 q 213 657 276 657 q 195 657 203 657 q 176 657 181 657 l 176 722 q 279 733 249 722 q 334 815 334 752 q 300 881 334 856 q 220 907 267 907 q 133 875 169 907 q 97 781 97 844 l 15 781 q 78 926 15 875 q 220 972 135 972 q 364 930 303 972 q 426 817 426 888 q 344 697 426 733 q 421 642 392 681 q 450 552 450 603 "},"[":{x_min:0,x_max:273.609375,ha:371,o:"m 273 -281 l 0 -281 l 0 1013 l 273 1013 l 273 920 l 124 920 l 124 -187 l 273 -187 l 273 -281 "},L:{x_min:0,x_max:645.828125,ha:696,o:"m 645 0 l 0 0 l 0 1013 l 140 1013 l 140 126 l 645 126 l 645 0 "},\u03c3:{x_min:0,x_max:803.390625,ha:894,o:"m 803 628 l 633 628 q 713 368 713 512 q 618 93 713 204 q 357 -25 518 -25 q 94 91 194 -25 q 0 368 0 201 q 94 644 0 533 q 356 761 194 761 q 481 750 398 761 q 608 739 564 739 l 803 739 l 803 628 m 360 85 q 529 180 467 85 q 584 374 584 262 q 527 566 584 490 q 352 651 463 651 q 187 559 247 651 q 135 368 135 478 q 189 175 135 254 q 360 85 251 85 "},\u03b6:{x_min:0,x_max:573,ha:642,o:"m 573 -40 q 553 -162 573 -97 q 510 -278 543 -193 l 400 -278 q 441 -187 428 -219 q 462 -90 462 -132 q 378 -14 462 -14 q 108 45 197 -14 q 0 290 0 117 q 108 631 0 462 q 353 901 194 767 l 55 901 l 55 1012 l 561 1012 l 561 924 q 261 669 382 831 q 128 301 128 489 q 243 117 128 149 q 458 98 350 108 q 573 -40 573 80 "},\u03b8:{x_min:0,x_max:674,ha:778,o:"m 674 496 q 601 160 674 304 q 336 -26 508 -26 q 73 153 165 -26 q 0 485 0 296 q 72 840 0 683 q 343 1045 166 1045 q 605 844 516 1045 q 674 496 674 692 m 546 579 q 498 798 546 691 q 336 935 437 935 q 178 798 237 935 q 126 579 137 701 l 546 579 m 546 475 l 126 475 q 170 233 126 348 q 338 80 230 80 q 504 233 447 80 q 546 475 546 346 "},\u039f:{x_min:0,x_max:958,ha:1054,o:"m 485 1042 q 834 883 703 1042 q 958 511 958 735 q 834 136 958 287 q 481 -26 701 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 729 q 485 1042 263 1042 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 670 q 480 913 640 913 q 226 785 321 913 q 142 504 142 671 q 226 224 142 339 q 480 98 319 98 "},\u0393:{x_min:0,x_max:705.28125,ha:749,o:"m 705 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 705 1012 l 705 886 "}," ":{x_min:0,x_max:0,ha:375},"%":{x_min:-3,x_max:1089,ha:1186,o:"m 845 0 q 663 76 731 0 q 602 244 602 145 q 661 412 602 344 q 845 489 728 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 845 0 962 0 m 844 103 q 945 143 909 103 q 981 243 981 184 q 947 340 981 301 q 844 385 909 385 q 744 342 781 385 q 708 243 708 300 q 741 147 708 186 q 844 103 780 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 "},P:{x_min:0,x_max:726,ha:806,o:"m 424 1013 q 640 931 555 1013 q 726 719 726 850 q 637 506 726 587 q 413 426 548 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 379 889 l 140 889 l 140 548 l 372 548 q 522 589 459 548 q 593 720 593 637 q 528 845 593 801 q 379 889 463 889 "},\u0388:{x_min:0,x_max:1078.21875,ha:1118,o:"m 1078 0 l 342 0 l 342 1013 l 1067 1013 l 1067 889 l 481 889 l 481 585 l 1019 585 l 1019 467 l 481 467 l 481 125 l 1078 125 l 1078 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},\u038f:{x_min:.125,x_max:1136.546875,ha:1235,o:"m 1136 0 l 722 0 l 722 123 q 911 309 842 194 q 981 558 981 423 q 893 813 981 710 q 651 923 800 923 q 411 821 501 923 q 321 568 321 720 q 390 316 321 433 q 579 123 459 200 l 579 0 l 166 0 l 166 124 l 384 124 q 235 327 289 210 q 182 572 182 444 q 311 912 182 782 q 651 1042 441 1042 q 989 910 858 1042 q 1120 569 1120 778 q 1066 326 1120 443 q 917 124 1013 210 l 1136 124 l 1136 0 m 277 1040 l 83 800 l 0 800 l 140 1041 l 277 1040 "},_:{x_min:0,x_max:705.5625,ha:803,o:"m 705 -334 l 0 -334 l 0 -234 l 705 -234 l 705 -334 "},\u03aa:{x_min:-110,x_max:246,ha:275,o:"m 246 1046 l 118 1046 l 118 1189 l 246 1189 l 246 1046 m 18 1046 l -110 1046 l -110 1189 l 18 1189 l 18 1046 m 136 0 l 0 0 l 0 1012 l 136 1012 l 136 0 "},"+":{x_min:23,x_max:768,ha:792,o:"m 768 372 l 444 372 l 444 0 l 347 0 l 347 372 l 23 372 l 23 468 l 347 468 l 347 840 l 444 840 l 444 468 l 768 468 l 768 372 "},"\xbd":{x_min:0,x_max:1050,ha:1149,o:"m 1050 0 l 625 0 q 712 178 625 108 q 878 277 722 187 q 967 385 967 328 q 932 456 967 429 q 850 484 897 484 q 759 450 798 484 q 721 352 721 416 l 640 352 q 706 502 640 448 q 851 551 766 551 q 987 509 931 551 q 1050 385 1050 462 q 976 251 1050 301 q 829 179 902 215 q 717 68 740 133 l 1050 68 l 1050 0 m 834 985 l 215 -28 l 130 -28 l 750 984 l 834 985 m 224 422 l 142 422 l 142 811 l 0 811 l 0 867 q 104 889 62 867 q 164 973 157 916 l 224 973 l 224 422 "},\u03a1:{x_min:0,x_max:720,ha:783,o:"m 424 1013 q 637 933 554 1013 q 720 723 720 853 q 633 508 720 591 q 413 426 546 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 378 889 l 140 889 l 140 548 l 371 548 q 521 589 458 548 q 592 720 592 637 q 527 845 592 801 q 378 889 463 889 "},"'":{x_min:0,x_max:139,ha:236,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},\u00aa:{x_min:0,x_max:350,ha:397,o:"m 350 625 q 307 616 328 616 q 266 631 281 616 q 247 673 251 645 q 190 628 225 644 q 116 613 156 613 q 32 641 64 613 q 0 722 0 669 q 72 826 0 800 q 247 866 159 846 l 247 887 q 220 934 247 916 q 162 953 194 953 q 104 934 129 953 q 76 882 80 915 l 16 882 q 60 976 16 941 q 166 1011 104 1011 q 266 979 224 1011 q 308 891 308 948 l 308 706 q 311 679 308 688 q 331 670 315 670 l 350 672 l 350 625 m 247 757 l 247 811 q 136 790 175 798 q 64 726 64 773 q 83 682 64 697 q 132 667 103 667 q 207 690 174 667 q 247 757 247 718 "},"\u0385":{x_min:0,x_max:450,ha:553,o:"m 450 800 l 340 800 l 340 925 l 450 925 l 450 800 m 406 1040 l 212 800 l 129 800 l 269 1040 l 406 1040 m 110 800 l 0 800 l 0 925 l 110 925 l 110 800 "},T:{x_min:0,x_max:777,ha:835,o:"m 777 894 l 458 894 l 458 0 l 319 0 l 319 894 l 0 894 l 0 1013 l 777 1013 l 777 894 "},\u03a6:{x_min:0,x_max:915,ha:997,o:"m 527 0 l 389 0 l 389 122 q 110 231 220 122 q 0 509 0 340 q 110 785 0 677 q 389 893 220 893 l 389 1013 l 527 1013 l 527 893 q 804 786 693 893 q 915 509 915 679 q 805 231 915 341 q 527 122 696 122 l 527 0 m 527 226 q 712 310 641 226 q 779 507 779 389 q 712 705 779 627 q 527 787 641 787 l 527 226 m 389 226 l 389 787 q 205 698 275 775 q 136 505 136 620 q 206 308 136 391 q 389 226 276 226 "},"\u204b":{x_min:0,x_max:0,ha:694},j:{x_min:-77.78125,x_max:167,ha:349,o:"m 167 871 l 42 871 l 42 1013 l 167 1013 l 167 871 m 167 -80 q 121 -231 167 -184 q -26 -278 76 -278 l -77 -278 l -77 -164 l -41 -164 q 26 -143 11 -164 q 42 -65 42 -122 l 42 737 l 167 737 l 167 -80 "},\u03a3:{x_min:0,x_max:756.953125,ha:819,o:"m 756 0 l 0 0 l 0 107 l 395 523 l 22 904 l 22 1013 l 745 1013 l 745 889 l 209 889 l 566 523 l 187 125 l 756 125 l 756 0 "},"\u203a":{x_min:18.0625,x_max:774,ha:792,o:"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},"<":{x_min:17.984375,x_max:773.609375,ha:792,o:"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"\xa3":{x_min:0,x_max:704.484375,ha:801,o:"m 704 41 q 623 -10 664 5 q 543 -26 583 -26 q 359 15 501 -26 q 243 36 288 36 q 158 23 197 36 q 73 -21 119 10 l 6 76 q 125 195 90 150 q 175 331 175 262 q 147 443 175 383 l 0 443 l 0 512 l 108 512 q 43 734 43 623 q 120 929 43 854 q 358 1010 204 1010 q 579 936 487 1010 q 678 729 678 857 l 678 684 l 552 684 q 504 838 552 780 q 362 896 457 896 q 216 852 263 896 q 176 747 176 815 q 199 627 176 697 q 248 512 217 574 l 468 512 l 468 443 l 279 443 q 297 356 297 398 q 230 194 297 279 q 153 107 211 170 q 227 133 190 125 q 293 142 264 142 q 410 119 339 142 q 516 96 482 96 q 579 105 550 96 q 648 142 608 115 l 704 41 "},t:{x_min:0,x_max:367,ha:458,o:"m 367 0 q 312 -5 339 -2 q 262 -8 284 -8 q 145 28 183 -8 q 108 143 108 64 l 108 638 l 0 638 l 0 738 l 108 738 l 108 944 l 232 944 l 232 738 l 367 738 l 367 638 l 232 638 l 232 185 q 248 121 232 140 q 307 102 264 102 q 345 104 330 102 q 367 107 360 107 l 367 0 "},"\xac":{x_min:0,x_max:706,ha:803,o:"m 706 411 l 706 158 l 630 158 l 630 335 l 0 335 l 0 411 l 706 411 "},\u03bb:{x_min:0,x_max:750,ha:803,o:"m 750 -7 q 679 -15 716 -15 q 538 59 591 -15 q 466 214 512 97 l 336 551 l 126 0 l 0 0 l 270 705 q 223 837 247 770 q 116 899 190 899 q 90 898 100 899 l 90 1004 q 152 1011 125 1011 q 298 938 244 1011 q 373 783 326 901 l 605 192 q 649 115 629 136 q 716 95 669 95 l 736 95 q 750 97 745 97 l 750 -7 "},W:{x_min:0,x_max:1263.890625,ha:1351,o:"m 1263 1013 l 995 0 l 859 0 l 627 837 l 405 0 l 265 0 l 0 1013 l 136 1013 l 342 202 l 556 1013 l 701 1013 l 921 207 l 1133 1012 l 1263 1013 "},">":{x_min:18.0625,x_max:774,ha:792,o:"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},v:{x_min:0,x_max:675.15625,ha:761,o:"m 675 738 l 404 0 l 272 0 l 0 738 l 133 737 l 340 147 l 541 737 l 675 738 "},\u03c4:{x_min:.28125,x_max:644.5,ha:703,o:"m 644 628 l 382 628 l 382 179 q 388 120 382 137 q 436 91 401 91 q 474 94 447 91 q 504 97 501 97 l 504 0 q 454 -9 482 -5 q 401 -14 426 -14 q 278 67 308 -14 q 260 233 260 118 l 260 628 l 0 628 l 0 739 l 644 739 l 644 628 "},\u03be:{x_min:0,x_max:624.9375,ha:699,o:"m 624 -37 q 608 -153 624 -96 q 563 -278 593 -211 l 454 -278 q 491 -183 486 -200 q 511 -83 511 -126 q 484 -23 511 -44 q 370 1 452 1 q 323 0 354 1 q 283 -1 293 -1 q 84 76 169 -1 q 0 266 0 154 q 56 431 0 358 q 197 538 108 498 q 94 613 134 562 q 54 730 54 665 q 77 823 54 780 q 143 901 101 867 l 27 901 l 27 1012 l 576 1012 l 576 901 l 380 901 q 244 863 303 901 q 178 745 178 820 q 312 600 178 636 q 532 582 380 582 l 532 479 q 276 455 361 479 q 118 281 118 410 q 165 173 118 217 q 274 120 208 133 q 494 101 384 110 q 624 -37 624 76 "},"&":{x_min:-3,x_max:894.25,ha:992,o:"m 894 0 l 725 0 l 624 123 q 471 0 553 40 q 306 -41 390 -41 q 168 -7 231 -41 q 62 92 105 26 q 14 187 31 139 q -3 276 -3 235 q 55 433 -3 358 q 248 581 114 508 q 170 689 196 640 q 137 817 137 751 q 214 985 137 922 q 384 1041 284 1041 q 548 988 483 1041 q 622 824 622 928 q 563 666 622 739 q 431 556 516 608 l 621 326 q 649 407 639 361 q 663 493 653 426 l 781 493 q 703 229 781 352 l 894 0 m 504 818 q 468 908 504 877 q 384 940 433 940 q 293 907 331 940 q 255 818 255 875 q 289 714 255 767 q 363 628 313 678 q 477 729 446 682 q 504 818 504 771 m 556 209 l 314 499 q 179 395 223 449 q 135 283 135 341 q 146 222 135 253 q 183 158 158 192 q 333 80 241 80 q 556 209 448 80 "},\u039b:{x_min:0,x_max:862.5,ha:942,o:"m 862 0 l 719 0 l 426 847 l 143 0 l 0 0 l 356 1013 l 501 1013 l 862 0 "},I:{x_min:41,x_max:180,ha:293,o:"m 180 0 l 41 0 l 41 1013 l 180 1013 l 180 0 "},G:{x_min:0,x_max:921,ha:1011,o:"m 921 0 l 832 0 l 801 136 q 655 15 741 58 q 470 -28 568 -28 q 126 133 259 -28 q 0 499 0 284 q 125 881 0 731 q 486 1043 259 1043 q 763 957 647 1043 q 905 709 890 864 l 772 709 q 668 866 747 807 q 486 926 589 926 q 228 795 322 926 q 142 507 142 677 q 228 224 142 342 q 483 94 323 94 q 712 195 625 94 q 796 435 796 291 l 477 435 l 477 549 l 921 549 l 921 0 "},\u03b0:{x_min:0,x_max:617,ha:725,o:"m 524 800 l 414 800 l 414 925 l 524 925 l 524 800 m 183 800 l 73 800 l 73 925 l 183 925 l 183 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 489 1040 l 300 819 l 216 819 l 351 1040 l 489 1040 "},"`":{x_min:0,x_max:138.890625,ha:236,o:"m 138 699 l 0 699 l 0 861 q 36 974 0 929 q 138 1041 72 1020 l 138 977 q 82 931 95 969 q 69 839 69 893 l 138 839 l 138 699 "},"\xb7":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},\u03a5:{x_min:.328125,x_max:819.515625,ha:889,o:"m 819 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 "},r:{x_min:0,x_max:355.5625,ha:432,o:"m 355 621 l 343 621 q 179 569 236 621 q 122 411 122 518 l 122 0 l 0 0 l 0 737 l 117 737 l 117 604 q 204 719 146 686 q 355 753 262 753 l 355 621 "},x:{x_min:0,x_max:675,ha:764,o:"m 675 0 l 525 0 l 331 286 l 144 0 l 0 0 l 256 379 l 12 738 l 157 737 l 336 473 l 516 738 l 661 738 l 412 380 l 675 0 "},\u03bc:{x_min:0,x_max:696.609375,ha:747,o:"m 696 -4 q 628 -14 657 -14 q 498 97 513 -14 q 422 8 470 41 q 313 -24 374 -24 q 207 3 258 -24 q 120 80 157 31 l 120 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 172 124 246 q 308 82 216 82 q 451 177 402 82 q 492 358 492 254 l 492 738 l 616 738 l 616 214 q 623 136 616 160 q 673 92 636 92 q 696 95 684 92 l 696 -4 "},h:{x_min:0,x_max:615,ha:724,o:"m 615 472 l 615 0 l 490 0 l 490 454 q 456 590 490 535 q 338 654 416 654 q 186 588 251 654 q 122 436 122 522 l 122 0 l 0 0 l 0 1013 l 122 1013 l 122 633 q 218 727 149 694 q 362 760 287 760 q 552 676 484 760 q 615 472 615 600 "},".":{x_min:0,x_max:142,ha:239,o:"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},\u03c6:{x_min:-2,x_max:878,ha:974,o:"m 496 -279 l 378 -279 l 378 -17 q 101 88 204 -17 q -2 367 -2 194 q 68 626 -2 510 q 283 758 151 758 l 283 646 q 167 537 209 626 q 133 373 133 462 q 192 177 133 254 q 378 93 259 93 l 378 758 q 445 764 426 763 q 476 765 464 765 q 765 659 653 765 q 878 377 878 553 q 771 96 878 209 q 496 -17 665 -17 l 496 -279 m 496 93 l 514 93 q 687 183 623 93 q 746 380 746 265 q 691 569 746 491 q 522 658 629 658 l 496 656 l 496 93 "},";":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 -12 q 105 -132 142 -82 q 0 -206 68 -182 l 0 -138 q 58 -82 43 -123 q 68 0 68 -56 l 0 0 l 0 151 l 142 151 l 142 -12 "},f:{x_min:0,x_max:378,ha:472,o:"m 378 638 l 246 638 l 246 0 l 121 0 l 121 638 l 0 638 l 0 738 l 121 738 q 137 935 121 887 q 290 1028 171 1028 q 320 1027 305 1028 q 378 1021 334 1026 l 378 908 q 323 918 346 918 q 257 870 273 918 q 246 780 246 840 l 246 738 l 378 738 l 378 638 "},"\u201c":{x_min:1,x_max:348.21875,ha:454,o:"m 140 670 l 1 670 l 1 830 q 37 943 1 897 q 140 1011 74 990 l 140 947 q 82 900 97 940 q 68 810 68 861 l 140 810 l 140 670 m 348 670 l 209 670 l 209 830 q 245 943 209 897 q 348 1011 282 990 l 348 947 q 290 900 305 940 q 276 810 276 861 l 348 810 l 348 670 "},A:{x_min:.03125,x_max:906.953125,ha:1008,o:"m 906 0 l 756 0 l 648 303 l 251 303 l 142 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 610 421 l 452 867 l 293 421 l 610 421 "},"\u2018":{x_min:1,x_max:139.890625,ha:236,o:"m 139 670 l 1 670 l 1 830 q 37 943 1 897 q 139 1011 74 990 l 139 947 q 82 900 97 940 q 68 810 68 861 l 139 810 l 139 670 "},\u03ca:{x_min:-70,x_max:283,ha:361,o:"m 283 800 l 173 800 l 173 925 l 283 925 l 283 800 m 40 800 l -70 800 l -70 925 l 40 925 l 40 800 m 283 3 q 232 -10 257 -5 q 181 -15 206 -15 q 84 26 118 -15 q 41 200 41 79 l 41 737 l 166 737 l 167 215 q 171 141 167 157 q 225 101 182 101 q 247 103 238 101 q 283 112 256 104 l 283 3 "},\u03c0:{x_min:-.21875,x_max:773.21875,ha:857,o:"m 773 -7 l 707 -11 q 575 40 607 -11 q 552 174 552 77 l 552 226 l 552 626 l 222 626 l 222 0 l 97 0 l 97 626 l 0 626 l 0 737 l 773 737 l 773 626 l 676 626 l 676 171 q 695 103 676 117 q 773 90 714 90 l 773 -7 "},\u03ac:{x_min:0,x_max:765.5625,ha:809,o:"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 727 407 760 q 563 637 524 695 l 563 738 l 685 738 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 95 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 m 604 1040 l 415 819 l 332 819 l 466 1040 l 604 1040 "},O:{x_min:0,x_max:958,ha:1057,o:"m 485 1041 q 834 882 702 1041 q 958 512 958 734 q 834 136 958 287 q 481 -26 702 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 728 q 485 1041 263 1041 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 669 q 480 912 640 912 q 226 784 321 912 q 142 504 142 670 q 226 224 142 339 q 480 98 319 98 "},n:{x_min:0,x_max:615,ha:724,o:"m 615 463 l 615 0 l 490 0 l 490 454 q 453 592 490 537 q 331 656 410 656 q 178 585 240 656 q 117 421 117 514 l 117 0 l 0 0 l 0 738 l 117 738 l 117 630 q 218 728 150 693 q 359 764 286 764 q 552 675 484 764 q 615 463 615 593 "},l:{x_min:41,x_max:166,ha:279,o:"m 166 0 l 41 0 l 41 1013 l 166 1013 l 166 0 "},"\xa4":{x_min:40.09375,x_max:728.796875,ha:825,o:"m 728 304 l 649 224 l 512 363 q 383 331 458 331 q 256 363 310 331 l 119 224 l 40 304 l 177 441 q 150 553 150 493 q 184 673 150 621 l 40 818 l 119 898 l 267 749 q 321 766 291 759 q 384 773 351 773 q 447 766 417 773 q 501 749 477 759 l 649 898 l 728 818 l 585 675 q 612 618 604 648 q 621 553 621 587 q 591 441 621 491 l 728 304 m 384 682 q 280 643 318 682 q 243 551 243 604 q 279 461 243 499 q 383 423 316 423 q 487 461 449 423 q 525 553 525 500 q 490 641 525 605 q 384 682 451 682 "},\u03ba:{x_min:0,x_max:632.328125,ha:679,o:"m 632 0 l 482 0 l 225 384 l 124 288 l 124 0 l 0 0 l 0 738 l 124 738 l 124 446 l 433 738 l 596 738 l 312 466 l 632 0 "},p:{x_min:0,x_max:685,ha:786,o:"m 685 364 q 598 96 685 205 q 350 -23 504 -23 q 121 89 205 -23 l 121 -278 l 0 -278 l 0 738 l 121 738 l 121 633 q 220 726 159 691 q 351 761 280 761 q 598 636 504 761 q 685 364 685 522 m 557 371 q 501 560 557 481 q 330 651 437 651 q 162 559 223 651 q 108 366 108 479 q 162 177 108 254 q 333 87 224 87 q 502 178 441 87 q 557 371 557 258 "},"\u2021":{x_min:0,x_max:777,ha:835,o:"m 458 238 l 458 0 l 319 0 l 319 238 l 0 238 l 0 360 l 319 360 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 l 777 804 l 777 683 l 458 683 l 458 360 l 777 360 l 777 238 l 458 238 "},\u03c8:{x_min:0,x_max:808,ha:907,o:"m 465 -278 l 341 -278 l 341 -15 q 87 102 180 -15 q 0 378 0 210 l 0 739 l 133 739 l 133 379 q 182 195 133 275 q 341 98 242 98 l 341 922 l 465 922 l 465 98 q 623 195 563 98 q 675 382 675 278 l 675 742 l 808 742 l 808 381 q 720 104 808 213 q 466 -13 627 -13 l 465 -278 "},\u03b7:{x_min:.78125,x_max:697,ha:810,o:"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 720 124 755 q 200 630 193 686 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 "}},l3={yMin:-334,xMin:-111,yMax:1189,xMax:1672},vw={postscript_name:"Helvetiker-Regular",version_string:"Version 1.00 2004 initial release",vendor_url:"http://www.magenta.gr/",full_font_name:"Helvetiker",font_family_name:"Helvetiker",copyright:"Copyright (c) \u039cagenta ltd, 2004",description:"",trademark:"",designer:"",designer_url:"",unique_font_identifier:"\u039cagenta ltd:Helvetiker:22-10-104",license_url:"http://www.ellak.gr/fonts/MgOpen/license.html",license_description:'Copyright (c) 2004 by MAGENTA Ltd. All Rights Reserved.\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of the fonts accompanying this license ("Fonts") and associated documentation files (the "Font Software"), to reproduce and distribute the Font Software, including without limitation the rights to use, copy, merge, publish, distribute, and/or sell copies of the Font Software, and to permit persons to whom the Font Software is furnished to do so, subject to the following conditions: \r\n\r\nThe above copyright and this permission notice shall be included in all copies of one or more of the Font Software typefaces.\r\n\r\nThe Font Software may be modified, altered, or added to, and in particular the designs of glyphs or characters in the Fonts may be modified and additional glyphs or characters may be added to the Fonts, only if the fonts are renamed to names not containing the word "MgOpen", or if the modifications are accepted for inclusion in the Font Software itself by the each appointed Administrator.\r\n\r\nThis License becomes null and void to the extent applicable to Fonts or Font Software that has been modified and is distributed under the "MgOpen" name.\r\n\r\nThe Font Software may be sold as part of a larger software package but no copy of one or more of the Font Software typefaces may be sold by itself. \r\n\r\nTHE FONT SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL MAGENTA OR PERSONS OR BODIES IN CHARGE OF ADMINISTRATION AND MAINTENANCE OF THE FONT SOFTWARE BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM OTHER DEALINGS IN THE FONT SOFTWARE.',manufacturer_name:"\u039cagenta ltd",font_sub_family_name:"Regular"},d3="Helvetiker",hP=Object.freeze({__proto__:null,ascender:1189,boundingBox:l3,cssFontStyle:"normal",cssFontWeight:"normal",default:{glyphs:r3,cssFontWeight:"normal",ascender:1189,underlinePosition:-100,cssFontStyle:"normal",boundingBox:l3,resolution:1e3,original_font_information:vw,descender:-334,familyName:d3,lineHeight:1522,underlineThickness:50},descender:-334,familyName:d3,glyphs:r3,lineHeight:1522,original_font_information:vw,resolution:1e3,underlinePosition:-100,underlineThickness:50});class fP{constructor(o){this.isFont=!0,this.type="Font",this.data=o}generateShapes(o,c=100){const h=[],m=function kM(w,o,c){const h=Array.from(w),m=o/c.resolution,M=(c.boundingBox.yMax-c.boundingBox.yMin+c.underlineThickness)*m,N=[];let q=0,de=0;for(let pe=0;pe<h.length;pe++){const xe=h[pe];if("\n"===xe)q=0,de-=M;else{const Ie=pP(xe,m,q,de,c);q+=Ie.offsetX,N.push(Ie.path)}}return N}(o,c,this.data);for(let M=0,N=m.length;M<N;M++)h.push(...m[M].toShapes());return h}}function pP(w,o,c,h,m){const M=m.glyphs[w]||m.glyphs["?"];if(!M)return void console.error('THREE.Font: character "'+w+'" does not exists in font family '+m.familyName+".");const N=new uP;let q,de,pe,xe,Ie,Be,Le,Ke;if(M.o){const ft=M._cachedOutline||(M._cachedOutline=M.o.split(" "));for(let We=0,ze=ft.length;We<ze;)switch(ft[We++]){case"m":q=ft[We++]*o+c,de=ft[We++]*o+h,N.moveTo(q,de);break;case"l":q=ft[We++]*o+c,de=ft[We++]*o+h,N.lineTo(q,de);break;case"q":pe=ft[We++]*o+c,xe=ft[We++]*o+h,Ie=ft[We++]*o+c,Be=ft[We++]*o+h,N.quadraticCurveTo(Ie,Be,pe,xe);break;case"b":pe=ft[We++]*o+c,xe=ft[We++]*o+h,Ie=ft[We++]*o+c,Be=ft[We++]*o+h,Le=ft[We++]*o+c,Ke=ft[We++]*o+h,N.bezierCurveTo(Ie,Be,Le,Ke,pe,xe)}}return{offsetX:M.ha*o,path:N}}const FM={type:"change"},OM={type:"start"},u3={type:"end"},sb=new lf,h3=new ih,mP=Math.cos(70*Xd);class yy extends xh{constructor(o,c){super(),this.object=o,this.domElement=c,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new Ft,this.cursor=new Ft,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return q.phi},this.getAzimuthalAngle=function(){return q.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(Nn){Nn.addEventListener("keydown",Pt),this._domElementKeyEvents=Nn},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",Pt),this._domElementKeyEvents=null},this.saveState=function(){h.target0.copy(h.target),h.position0.copy(h.object.position),h.zoom0=h.object.zoom},this.reset=function(){h.target.copy(h.target0),h.object.position.copy(h.position0),h.object.zoom=h.zoom0,h.object.updateProjectionMatrix(),h.dispatchEvent(FM),h.update(),M=m.NONE},this.resetOrthoPanZoom=function(){xe.set(0,0,0),h.object.zoom=1,h.object.updateProjectionMatrix()},this.update=function(){const Nn=new Ft,Vr=(new Lu).setFromUnitVectors(o.up,new Ft(0,1,0)),xr=Vr.clone().invert(),Oo=new Ft,Ao=new Lu,fo=new Ft,to=2*Math.PI;return function(_a=null){const Kn=h.object.position;Nn.copy(Kn).sub(h.target),Nn.applyQuaternion(Vr),q.setFromVector3(Nn),h.autoRotate&&M===m.NONE&&li(function kt(Nn){return null!==Nn?2*Math.PI/60*h.autoRotateSpeed*Nn:2*Math.PI/60/60*h.autoRotateSpeed}(_a)),h.enableDamping?(q.theta+=de.theta*h.dampingFactor,q.phi+=de.phi*h.dampingFactor):(q.theta+=de.theta,q.phi+=de.phi);let ys=h.minAzimuthAngle,jr=h.maxAzimuthAngle;isFinite(ys)&&isFinite(jr)&&(ys<-Math.PI?ys+=to:ys>Math.PI&&(ys-=to),jr<-Math.PI?jr+=to:jr>Math.PI&&(jr-=to),q.theta=ys<=jr?Math.max(ys,Math.min(jr,q.theta)):q.theta>(ys+jr)/2?Math.max(ys,q.theta):Math.min(jr,q.theta)),q.phi=Math.max(h.minPolarAngle,Math.min(h.maxPolarAngle,q.phi)),q.makeSafe(),!0===h.enableDamping?h.target.addScaledVector(xe,h.dampingFactor):h.target.add(xe),h.target.sub(h.cursor),h.target.clampLength(h.minTargetRadius,h.maxTargetRadius),h.target.add(h.cursor),q.radius=Ji(h.zoomToCursor&&cn||h.object.isOrthographicCamera?q.radius:q.radius*pe),Nn.setFromSpherical(q),Nn.applyQuaternion(xr),Kn.copy(h.target).add(Nn),h.object.lookAt(h.target),!0===h.enableDamping?(de.theta*=1-h.dampingFactor,de.phi*=1-h.dampingFactor,xe.multiplyScalar(1-h.dampingFactor)):(de.set(0,0,0),xe.set(0,0,0));let dr=!1;if(h.zoomToCursor&&cn){let ns=null;if(h.object.isPerspectiveCamera){const xo=Nn.length();ns=Ji(xo*pe),h.object.position.addScaledVector(Dt,xo-ns),h.object.updateMatrixWorld()}else if(h.object.isOrthographicCamera){const xo=new Ft(Jt.x,Jt.y,0);xo.unproject(h.object),h.object.zoom=Math.max(h.minZoom,Math.min(h.maxZoom,h.object.zoom/pe)),h.object.updateProjectionMatrix(),dr=!0;const Na=new Ft(Jt.x,Jt.y,0);Na.unproject(h.object),h.object.position.sub(Na).add(xo),h.object.updateMatrixWorld(),ns=Nn.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),h.zoomToCursor=!1;null!==ns&&(this.screenSpacePanning?h.target.set(0,0,-1).transformDirection(h.object.matrix).multiplyScalar(ns).add(h.object.position):(sb.origin.copy(h.object.position),sb.direction.set(0,0,-1).transformDirection(h.object.matrix),Math.abs(h.object.up.dot(sb.direction))<mP?o.lookAt(h.target):(h3.setFromNormalAndCoplanarPoint(h.object.up,h.target),sb.intersectPlane(h3,h.target))))}else h.object.isOrthographicCamera&&(h.object.zoom=Math.max(h.minZoom,Math.min(h.maxZoom,h.object.zoom/pe)),h.object.updateProjectionMatrix(),dr=!0);return pe=1,cn=!1,!!(dr||Oo.distanceToSquared(h.object.position)>N||8*(1-Ao.dot(h.object.quaternion))>N||fo.distanceToSquared(h.target)>0)&&(h.dispatchEvent(FM),Oo.copy(h.object.position),Ao.copy(h.object.quaternion),fo.copy(h.target),dr=!1,!0)}}(),this.dispose=function(){h.domElement.removeEventListener("contextmenu",Ar),h.domElement.removeEventListener("pointerdown",Ur),h.domElement.removeEventListener("pointercancel",us),h.domElement.removeEventListener("wheel",$t),h.domElement.removeEventListener("pointermove",fr),h.domElement.removeEventListener("pointerup",us),null!==h._domElementKeyEvents&&(h._domElementKeyEvents.removeEventListener("keydown",Pt),h._domElementKeyEvents=null)};const h=this,m={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let M=m.NONE;const N=1e-6,q=new _w,de=new _w;let pe=1;const xe=new Ft,Ie=new zi,Be=new zi,Le=new zi,Ke=new zi,ft=new zi,We=new zi,ze=new zi,Mt=new zi,ct=new zi,Dt=new Ft,Jt=new zi;let cn=!1;const rn=[],Rn={};function Zt(){return Math.pow(.95,h.zoomSpeed)}function li(Nn){de.theta-=Nn}function Ti(Nn){de.phi-=Nn}const ur=function(){const Nn=new Ft;return function(xr,Oo){Nn.setFromMatrixColumn(Oo,0),Nn.multiplyScalar(-xr),xe.add(Nn)}}(),Yn=function(){const Nn=new Ft;return function(xr,Oo){!0===h.screenSpacePanning?Nn.setFromMatrixColumn(Oo,1):(Nn.setFromMatrixColumn(Oo,0),Nn.crossVectors(h.object.up,Nn)),Nn.multiplyScalar(xr),xe.add(Nn)}}(),Di=function(){const Nn=new Ft;return function(xr,Oo){const Ao=h.domElement;if(h.object.isPerspectiveCamera){Nn.copy(h.object.position).sub(h.target);let to=Nn.length();to*=Math.tan(h.object.fov/2*Math.PI/180),ur(2*xr*to/Ao.clientHeight,h.object.matrix),Yn(2*Oo*to/Ao.clientHeight,h.object.matrix)}else h.object.isOrthographicCamera?(ur(xr*(h.object.right-h.object.left)/h.object.zoom/Ao.clientWidth,h.object.matrix),Yn(Oo*(h.object.top-h.object.bottom)/h.object.zoom/Ao.clientHeight,h.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),h.enablePan=!1)}}();function rr(Nn){h.object.isPerspectiveCamera||h.object.isOrthographicCamera?pe/=Nn:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),h.enableZoom=!1)}function Li(Nn){h.object.isPerspectiveCamera||h.object.isOrthographicCamera?pe*=Nn:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),h.enableZoom=!1)}function br(Nn){if(!h.zoomToCursor)return;cn=!0;const Vr=h.domElement.getBoundingClientRect(),Oo=Nn.clientY-Vr.top,fo=Vr.height;Jt.x=(Nn.clientX-Vr.left)/Vr.width*2-1,Jt.y=-Oo/fo*2+1,Dt.set(Jt.x,Jt.y,1).unproject(h.object).sub(h.object.position).normalize()}function Ji(Nn){return Math.max(h.minDistance,Math.min(h.maxDistance,Nn))}function lr(Nn){Ie.set(Nn.clientX,Nn.clientY)}function sr(Nn){Ke.set(Nn.clientX,Nn.clientY)}function er(){1===rn.length?Ie.set(rn[0].pageX,rn[0].pageY):Ie.set(.5*(rn[0].pageX+rn[1].pageX),.5*(rn[0].pageY+rn[1].pageY))}function Lr(){1===rn.length?Ke.set(rn[0].pageX,rn[0].pageY):Ke.set(.5*(rn[0].pageX+rn[1].pageX),.5*(rn[0].pageY+rn[1].pageY))}function yr(){const Nn=rn[0].pageX-rn[1].pageX,Vr=rn[0].pageY-rn[1].pageY,xr=Math.sqrt(Nn*Nn+Vr*Vr);ze.set(0,xr)}function Ki(Nn){if(1==rn.length)Be.set(Nn.pageX,Nn.pageY);else{const xr=ts(Nn);Be.set(.5*(Nn.pageX+xr.x),.5*(Nn.pageY+xr.y))}Le.subVectors(Be,Ie).multiplyScalar(h.rotateSpeed);const Vr=h.domElement;li(2*Math.PI*Le.x/Vr.clientHeight),Ti(2*Math.PI*Le.y/Vr.clientHeight),Ie.copy(Be)}function si(Nn){if(1===rn.length)ft.set(Nn.pageX,Nn.pageY);else{const Vr=ts(Nn);ft.set(.5*(Nn.pageX+Vr.x),.5*(Nn.pageY+Vr.y))}We.subVectors(ft,Ke).multiplyScalar(h.panSpeed),Di(We.x,We.y),Ke.copy(ft)}function Ri(Nn){const Vr=ts(Nn),xr=Nn.pageX-Vr.x,Oo=Nn.pageY-Vr.y,Ao=Math.sqrt(xr*xr+Oo*Oo);Mt.set(0,Ao),ct.set(0,Math.pow(Mt.y/ze.y,h.zoomSpeed)),rr(ct.y),ze.copy(Mt)}function Ur(Nn){!1!==h.enabled&&(0===rn.length&&(h.domElement.setPointerCapture(Nn.pointerId),h.domElement.addEventListener("pointermove",fr),h.domElement.addEventListener("pointerup",us)),function Br(Nn){rn.push(Nn)}(Nn),"touch"===Nn.pointerType?function ni(Nn){switch(Ir(Nn),rn.length){case 1:switch(h.touches.ONE){case 0:if(!1===h.enableRotate)return;er(),M=m.TOUCH_ROTATE;break;case 1:if(!1===h.enablePan)return;Lr(),M=m.TOUCH_PAN;break;default:M=m.NONE}break;case 2:switch(h.touches.TWO){case 2:if(!1===h.enableZoom&&!1===h.enablePan)return;(function vr(){h.enableZoom&&yr(),h.enablePan&&Lr()})(),M=m.TOUCH_DOLLY_PAN;break;case 3:if(!1===h.enableZoom&&!1===h.enableRotate)return;(function _n(){h.enableZoom&&yr(),h.enableRotate&&er()})(),M=m.TOUCH_DOLLY_ROTATE;break;default:M=m.NONE}break;default:M=m.NONE}M!==m.NONE&&h.dispatchEvent(OM)}(Nn):function co(Nn){let Vr;switch(Nn.button){case 0:Vr=h.mouseButtons.LEFT;break;case 1:Vr=h.mouseButtons.MIDDLE;break;case 2:Vr=h.mouseButtons.RIGHT;break;default:Vr=-1}switch(Vr){case 1:if(!1===h.enableZoom)return;(function ei(Nn){br(Nn),ze.set(Nn.clientX,Nn.clientY)})(Nn),M=m.DOLLY;break;case 0:if(Nn.ctrlKey||Nn.metaKey||Nn.shiftKey){if(!1===h.enablePan)return;sr(Nn),M=m.PAN}else{if(!1===h.enableRotate)return;lr(Nn),M=m.ROTATE}break;case 2:if(Nn.ctrlKey||Nn.metaKey||Nn.shiftKey){if(!1===h.enableRotate)return;lr(Nn),M=m.ROTATE}else{if(!1===h.enablePan)return;sr(Nn),M=m.PAN}break;default:M=m.NONE}M!==m.NONE&&h.dispatchEvent(OM)}(Nn))}function fr(Nn){!1!==h.enabled&&("touch"===Nn.pointerType?function cr(Nn){switch(Ir(Nn),M){case m.TOUCH_ROTATE:if(!1===h.enableRotate)return;Ki(Nn),h.update();break;case m.TOUCH_PAN:if(!1===h.enablePan)return;si(Nn),h.update();break;case m.TOUCH_DOLLY_PAN:if(!1===h.enableZoom&&!1===h.enablePan)return;(function Ii(Nn){h.enableZoom&&Ri(Nn),h.enablePan&&si(Nn)})(Nn),h.update();break;case m.TOUCH_DOLLY_ROTATE:if(!1===h.enableZoom&&!1===h.enableRotate)return;(function es(Nn){h.enableZoom&&Ri(Nn),h.enableRotate&&Ki(Nn)})(Nn),h.update();break;default:M=m.NONE}}(Nn):function _s(Nn){switch(M){case m.ROTATE:if(!1===h.enableRotate)return;!function as(Nn){Be.set(Nn.clientX,Nn.clientY),Le.subVectors(Be,Ie).multiplyScalar(h.rotateSpeed);const Vr=h.domElement;li(2*Math.PI*Le.x/Vr.clientHeight),Ti(2*Math.PI*Le.y/Vr.clientHeight),Ie.copy(Be),h.update()}(Nn);break;case m.DOLLY:if(!1===h.enableZoom)return;!function xs(Nn){Mt.set(Nn.clientX,Nn.clientY),ct.subVectors(Mt,ze),ct.y>0?rr(Zt()):ct.y<0&&Li(Zt()),ze.copy(Mt),h.update()}(Nn);break;case m.PAN:if(!1===h.enablePan)return;!function Ds(Nn){ft.set(Nn.clientX,Nn.clientY),We.subVectors(ft,Ke).multiplyScalar(h.panSpeed),Di(We.x,We.y),Ke.copy(ft),h.update()}(Nn)}}(Nn))}function us(Nn){(function ks(Nn){delete Rn[Nn.pointerId];for(let Vr=0;Vr<rn.length;Vr++)if(rn[Vr].pointerId==Nn.pointerId)return void rn.splice(Vr,1)})(Nn),0===rn.length&&(h.domElement.releasePointerCapture(Nn.pointerId),h.domElement.removeEventListener("pointermove",fr),h.domElement.removeEventListener("pointerup",us)),h.dispatchEvent(u3),M=m.NONE}function $t(Nn){!1===h.enabled||!1===h.enableZoom||M!==m.NONE||(Nn.preventDefault(),h.dispatchEvent(OM),function fs(Nn){br(Nn),Nn.deltaY<0?Li(Zt()):Nn.deltaY>0&&rr(Zt()),h.update()}(Nn),h.dispatchEvent(u3))}function Pt(Nn){!1===h.enabled||!1===h.enablePan||function eo(Nn){let Vr=!1;switch(Nn.code){case h.keys.UP:Nn.ctrlKey||Nn.metaKey||Nn.shiftKey?Ti(2*Math.PI*h.rotateSpeed/h.domElement.clientHeight):Di(0,h.keyPanSpeed),Vr=!0;break;case h.keys.BOTTOM:Nn.ctrlKey||Nn.metaKey||Nn.shiftKey?Ti(-2*Math.PI*h.rotateSpeed/h.domElement.clientHeight):Di(0,-h.keyPanSpeed),Vr=!0;break;case h.keys.LEFT:Nn.ctrlKey||Nn.metaKey||Nn.shiftKey?li(2*Math.PI*h.rotateSpeed/h.domElement.clientHeight):Di(h.keyPanSpeed,0),Vr=!0;break;case h.keys.RIGHT:Nn.ctrlKey||Nn.metaKey||Nn.shiftKey?li(-2*Math.PI*h.rotateSpeed/h.domElement.clientHeight):Di(-h.keyPanSpeed,0),Vr=!0}Vr&&(Nn.preventDefault(),h.update())}(Nn)}function Ar(Nn){!1!==h.enabled&&Nn.preventDefault()}function Ir(Nn){let Vr=Rn[Nn.pointerId];void 0===Vr&&(Vr=new zi,Rn[Nn.pointerId]=Vr),Vr.set(Nn.pageX,Nn.pageY)}function ts(Nn){return Rn[(Nn.pointerId===rn[0].pointerId?rn[1]:rn[0]).pointerId]}h.domElement.addEventListener("contextmenu",Ar),h.domElement.addEventListener("pointerdown",Ur),h.domElement.addEventListener("pointercancel",us),h.domElement.addEventListener("wheel",$t,{passive:!1}),this.update()}}const ob={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = opacity * texel;\n\n\n\t\t}"};class ab{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const f3=new kd(-1,1,1,-1,0,1),p3=new class AP extends Cs{constructor(){super(),this.setAttribute("position",new Bo([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Bo([0,2,0,0,2,0],2))}};class gP{constructor(o){this._mesh=new Jc(p3,o)}dispose(){this._mesh.geometry.dispose()}render(o){o.render(this._mesh,f3)}get material(){return this._mesh.material}set material(o){this._mesh.material=o}}class _P extends ab{constructor(o,c){super(),this.textureID=void 0!==c?c:"tDiffuse",o instanceof zl?(this.uniforms=o.uniforms,this.material=o):o&&(this.uniforms=dl.clone(o.uniforms),this.material=new zl({name:void 0!==o.name?o.name:"unspecified",defines:Object.assign({},o.defines),uniforms:this.uniforms,vertexShader:o.vertexShader,fragmentShader:o.fragmentShader})),this.fsQuad=new gP(this.material)}render(o,c,h){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=h.texture),this.fsQuad.material=this.material,this.renderToScreen?(o.setRenderTarget(null),this.fsQuad.render(o)):(o.setRenderTarget(c),this.clear&&o.clear(o.autoClearColor,o.autoClearDepth,o.autoClearStencil),this.fsQuad.render(o))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class p0 extends ab{constructor(o,c){super(),this.scene=o,this.camera=c,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(o,c,h){const m=o.getContext(),M=o.state;let N,q;M.buffers.color.setMask(!1),M.buffers.depth.setMask(!1),M.buffers.color.setLocked(!0),M.buffers.depth.setLocked(!0),this.inverse?(N=0,q=1):(N=1,q=0),M.buffers.stencil.setTest(!0),M.buffers.stencil.setOp(m.REPLACE,m.REPLACE,m.REPLACE),M.buffers.stencil.setFunc(m.ALWAYS,N,4294967295),M.buffers.stencil.setClear(q),M.buffers.stencil.setLocked(!0),o.setRenderTarget(h),this.clear&&o.clear(),o.render(this.scene,this.camera),o.setRenderTarget(c),this.clear&&o.clear(),o.render(this.scene,this.camera),M.buffers.color.setLocked(!1),M.buffers.depth.setLocked(!1),M.buffers.color.setMask(!0),M.buffers.depth.setMask(!0),M.buffers.stencil.setLocked(!1),M.buffers.stencil.setFunc(m.EQUAL,1,4294967295),M.buffers.stencil.setOp(m.KEEP,m.KEEP,m.KEEP),M.buffers.stencil.setLocked(!0)}}class LM extends ab{constructor(){super(),this.needsSwap=!1}render(o){o.state.buffers.stencil.setLocked(!1),o.state.buffers.stencil.setTest(!1)}}class KA{constructor(o,c){if(this.renderer=o,this._pixelRatio=o.getPixelRatio(),void 0===c){const h=o.getSize(new zi);this._width=h.width,this._height=h.height,(c=new Ou(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:In})).texture.name="EffectComposer.rt1"}else this._width=c.width,this._height=c.height;this.renderTarget1=c,this.renderTarget2=c.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new _P(ob),this.copyPass.material.blending=0,this.clock=new IM}swapBuffers(){const o=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=o}addPass(o){this.passes.push(o),o.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(o,c){this.passes.splice(c,0,o),o.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(o){const c=this.passes.indexOf(o);-1!==c&&this.passes.splice(c,1)}isLastEnabledPass(o){for(let c=o+1;c<this.passes.length;c++)if(this.passes[c].enabled)return!1;return!0}render(o){void 0===o&&(o=this.clock.getDelta());const c=this.renderer.getRenderTarget();let h=!1;for(let m=0,M=this.passes.length;m<M;m++){const N=this.passes[m];if(!1!==N.enabled){if(N.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(m),N.render(this.renderer,this.writeBuffer,this.readBuffer,o,h),N.needsSwap){if(h){const q=this.renderer.getContext(),de=this.renderer.state.buffers.stencil;de.setFunc(q.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,o),de.setFunc(q.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==p0&&(N instanceof p0?h=!0:N instanceof LM&&(h=!1))}}this.renderer.setRenderTarget(c)}reset(o){if(void 0===o){const c=this.renderer.getSize(new zi);this._pixelRatio=this.renderer.getPixelRatio(),this._width=c.width,this._height=c.height,(o=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=o,this.renderTarget2=o.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(o,c){this._width=o,this._height=c;const h=this._width*this._pixelRatio,m=this._height*this._pixelRatio;this.renderTarget1.setSize(h,m),this.renderTarget2.setSize(h,m);for(let M=0;M<this.passes.length;M++)this.passes[M].setSize(h,m)}setPixelRatio(o){this._pixelRatio=o,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class yP extends ab{constructor(o,c,h=null,m=null,M=null){super(),this.scene=o,this.camera=c,this.overrideMaterial=h,this.clearColor=m,this.clearAlpha=M,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Os}render(o,c,h){const m=o.autoClear;let M,N;o.autoClear=!1,null!==this.overrideMaterial&&(N=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),null!==this.clearColor&&(o.getClearColor(this._oldClearColor),o.setClearColor(this.clearColor)),null!==this.clearAlpha&&(M=o.getClearAlpha(),o.setClearAlpha(this.clearAlpha)),1==this.clearDepth&&o.clearDepth(),o.setRenderTarget(this.renderToScreen?null:h),!0===this.clear&&o.clear(o.autoClearColor,o.autoClearDepth,o.autoClearStencil),o.render(this.scene,this.camera),null!==this.clearColor&&o.setClearColor(this._oldClearColor),null!==this.clearAlpha&&o.setClearAlpha(M),null!==this.overrideMaterial&&(this.scene.overrideMaterial=N),o.autoClear=m}}const NM={name:"LuminosityHighPassShader",shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new Os(0)},defaultOpacity:{value:0}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec3 defaultColor;\n\t\tuniform float defaultOpacity;\n\t\tuniform float luminosityThreshold;\n\t\tuniform float smoothWidth;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\n\t\t\tvec3 luma = vec3( 0.299, 0.587, 0.114 );\n\n\t\t\tfloat v = dot( texel.xyz, luma );\n\n\t\t\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\n\n\t\t\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\n\n\t\t\tgl_FragColor = mix( outputColor, texel, alpha );\n\n\t\t}"};class lb extends ab{constructor(o,c,h,m){super(),this.strength=void 0!==c?c:1,this.radius=h,this.threshold=m,this.resolution=void 0!==o?new zi(o.x,o.y):new zi(256,256),this.clearColor=new Os(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let M=Math.round(this.resolution.x/2),N=Math.round(this.resolution.y/2);this.renderTargetBright=new Ou(M,N,{type:In}),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let Ie=0;Ie<this.nMips;Ie++){const Be=new Ou(M,N,{type:In});Be.texture.name="UnrealBloomPass.h"+Ie,Be.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(Be);const Le=new Ou(M,N,{type:In});Le.texture.name="UnrealBloomPass.v"+Ie,Le.texture.generateMipmaps=!1,this.renderTargetsVertical.push(Le),M=Math.round(M/2),N=Math.round(N/2)}const q=NM;this.highPassUniforms=dl.clone(q.uniforms),this.highPassUniforms.luminosityThreshold.value=m,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new zl({uniforms:this.highPassUniforms,vertexShader:q.vertexShader,fragmentShader:q.fragmentShader}),this.separableBlurMaterials=[];const de=[3,5,7,9,11];M=Math.round(this.resolution.x/2),N=Math.round(this.resolution.y/2);for(let Ie=0;Ie<this.nMips;Ie++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(de[Ie])),this.separableBlurMaterials[Ie].uniforms.invSize.value=new zi(1/M,1/N),M=Math.round(M/2),N=Math.round(N/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=c,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new Ft(1,1,1),new Ft(1,1,1),new Ft(1,1,1),new Ft(1,1,1),new Ft(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors;const xe=ob;this.copyUniforms=dl.clone(xe.uniforms),this.blendMaterial=new zl({uniforms:this.copyUniforms,vertexShader:xe.vertexShader,fragmentShader:xe.fragmentShader,blending:2,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new Os,this.oldClearAlpha=1,this.basic=new Xc,this.fsQuad=new gP(null)}dispose(){for(let o=0;o<this.renderTargetsHorizontal.length;o++)this.renderTargetsHorizontal[o].dispose();for(let o=0;o<this.renderTargetsVertical.length;o++)this.renderTargetsVertical[o].dispose();this.renderTargetBright.dispose();for(let o=0;o<this.separableBlurMaterials.length;o++)this.separableBlurMaterials[o].dispose();this.compositeMaterial.dispose(),this.blendMaterial.dispose(),this.basic.dispose(),this.fsQuad.dispose()}setSize(o,c){let h=Math.round(o/2),m=Math.round(c/2);this.renderTargetBright.setSize(h,m);for(let M=0;M<this.nMips;M++)this.renderTargetsHorizontal[M].setSize(h,m),this.renderTargetsVertical[M].setSize(h,m),this.separableBlurMaterials[M].uniforms.invSize.value=new zi(1/h,1/m),h=Math.round(h/2),m=Math.round(m/2)}render(o,c,h,m,M){o.getClearColor(this._oldClearColor),this.oldClearAlpha=o.getClearAlpha();const N=o.autoClear;o.autoClear=!1,o.setClearColor(this.clearColor,0),M&&o.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=h.texture,o.setRenderTarget(null),o.clear(),this.fsQuad.render(o)),this.highPassUniforms.tDiffuse.value=h.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,o.setRenderTarget(this.renderTargetBright),o.clear(),this.fsQuad.render(o);let q=this.renderTargetBright;for(let de=0;de<this.nMips;de++)this.fsQuad.material=this.separableBlurMaterials[de],this.separableBlurMaterials[de].uniforms.colorTexture.value=q.texture,this.separableBlurMaterials[de].uniforms.direction.value=lb.BlurDirectionX,o.setRenderTarget(this.renderTargetsHorizontal[de]),o.clear(),this.fsQuad.render(o),this.separableBlurMaterials[de].uniforms.colorTexture.value=this.renderTargetsHorizontal[de].texture,this.separableBlurMaterials[de].uniforms.direction.value=lb.BlurDirectionY,o.setRenderTarget(this.renderTargetsVertical[de]),o.clear(),this.fsQuad.render(o),q=this.renderTargetsVertical[de];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,o.setRenderTarget(this.renderTargetsHorizontal[0]),o.clear(),this.fsQuad.render(o),this.fsQuad.material=this.blendMaterial,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,M&&o.state.buffers.stencil.setTest(!0),this.renderToScreen?(o.setRenderTarget(null),this.fsQuad.render(o)):(o.setRenderTarget(h),this.fsQuad.render(o)),o.setClearColor(this._oldClearColor,this.oldClearAlpha),o.autoClear=N}getSeperableBlurMaterial(o){const c=[];for(let h=0;h<o;h++)c.push(.39894*Math.exp(-.5*h*h/(o*o))/o);return new zl({defines:{KERNEL_RADIUS:o},uniforms:{colorTexture:{value:null},invSize:{value:new zi(.5,.5)},direction:{value:new zi(.5,.5)},gaussianCoefficients:{value:c}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 invSize;\n\t\t\t\tuniform vec2 direction;\n\t\t\t\tuniform float gaussianCoefficients[KERNEL_RADIUS];\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tfloat weightSum = gaussianCoefficients[0];\n\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv ).rgb * weightSum;\n\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat x = float(i);\n\t\t\t\t\t\tfloat w = gaussianCoefficients[i];\n\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\n\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset ).rgb;\n\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset ).rgb;\n\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\n\t\t\t\t\t\tweightSum += 2.0 * w;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})}getCompositeMaterial(o){return new zl({defines:{NUM_MIPS:o},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\t\t\t\tuniform sampler2D blurTexture1;\n\t\t\t\tuniform sampler2D blurTexture2;\n\t\t\t\tuniform sampler2D blurTexture3;\n\t\t\t\tuniform sampler2D blurTexture4;\n\t\t\t\tuniform sampler2D blurTexture5;\n\t\t\t\tuniform float bloomStrength;\n\t\t\t\tuniform float bloomRadius;\n\t\t\t\tuniform float bloomFactors[NUM_MIPS];\n\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\n\n\t\t\t\tfloat lerpBloomFactor(const in float factor) {\n\t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\n\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\n\t\t\t\t}"})}}lb.BlurDirectionX=new zi(1,0),lb.BlurDirectionY=new zi(0,1);class m3{constructor(){this.id=0,this.object=null,this.z=0,this.renderOrder=0}}class im{constructor(){this.id=0,this.v1=new I_,this.v2=new I_,this.v3=new I_,this.normalModel=new Ft,this.vertexNormalsModel=[new Ft,new Ft,new Ft],this.vertexNormalsLength=0,this.color=new Os,this.material=null,this.uvs=[new zi,new zi,new zi],this.z=0,this.renderOrder=0}}class I_{constructor(){this.position=new Ft,this.positionWorld=new Ft,this.positionScreen=new il,this.visible=!0}copy(o){this.positionWorld.copy(o.positionWorld),this.positionScreen.copy(o.positionScreen)}}class A3{constructor(){this.id=0,this.v1=new I_,this.v2=new I_,this.vertexColors=[new Os,new Os],this.material=null,this.z=0,this.renderOrder=0}}class vP{constructor(){this.id=0,this.object=null,this.x=0,this.y=0,this.z=0,this.rotation=0,this.scale=new zi,this.material=null,this.renderOrder=0}}class io{constructor(){let o,c,m,M,q,de,xe,Ie,Le,Ke,We,h=0,N=0,pe=0,Be=0,ft=0;const ze={objects:[],lights:[],elements:[]},Mt=new Ft,ct=new il,Dt=new rl(new Ft(-1,-1,-1),new Ft(1,1,1)),Jt=new rl,cn=new Array(3),rn=new bo,Rn=new bo,kt=new bo,Zt=new Jh,li=[],Ti=[],ur=[],Yn=[],Di=[],Li=new function rr(){const er=[],Lr=[],yr=[];let vr=null;const _n=new zo;function si($t){const ni=$t.positionWorld,cr=$t.positionScreen;ni.copy($t.position).applyMatrix4(We),cr.copy(ni).applyMatrix4(Rn);const Ar=1/cr.w;cr.x*=Ar,cr.y*=Ar,cr.z*=Ar,$t.visible=cr.x>=-1&&cr.x<=1&&cr.y>=-1&&cr.y<=1&&cr.z>=-1&&cr.z<=1}function fr($t,Pt,ni){return!0===$t.visible||!0===Pt.visible||!0===ni.visible||(cn[0]=$t.positionScreen,cn[1]=Pt.positionScreen,cn[2]=ni.positionScreen,Dt.intersectsBox(Jt.setFromPoints(cn)))}function us($t,Pt,ni){return(ni.positionScreen.x-$t.positionScreen.x)*(Pt.positionScreen.y-$t.positionScreen.y)-(ni.positionScreen.y-$t.positionScreen.y)*(Pt.positionScreen.x-$t.positionScreen.x)<0}return{setObject:function Ki($t){vr=$t,_n.getNormalMatrix(vr.matrixWorld),er.length=0,Lr.length=0,yr.length=0},projectVertex:si,checkTriangleVisibility:fr,checkBackfaceCulling:us,pushVertex:function Ri($t,Pt,ni){m=function sr(){if(M===N){const er=new I_;return Ti.push(er),N++,M++,er}return Ti[M++]}(),m.position.set($t,Pt,ni),si(m)},pushNormal:function Ii($t,Pt,ni){er.push($t,Pt,ni)},pushColor:function es($t,Pt,ni){Lr.push($t,Pt,ni)},pushUv:function Ur($t,Pt){yr.push($t,Pt)},pushLine:function co($t,Pt){const ni=Ti[$t],cr=Ti[Pt];ni.positionScreen.copy(ni.position).applyMatrix4(kt),cr.positionScreen.copy(cr.position).applyMatrix4(kt),!0===function eo(er,Lr){let yr=0,vr=1;const _n=er.z+er.w,Ki=Lr.z+Lr.w,si=-er.z+er.w,Ri=-Lr.z+Lr.w;return _n>=0&&Ki>=0&&si>=0&&Ri>=0||!(_n<0&&Ki<0||si<0&&Ri<0)&&(_n<0?yr=Math.max(yr,_n/(_n-Ki)):Ki<0&&(vr=Math.min(vr,_n/(_n-Ki))),si<0?yr=Math.max(yr,si/(si-Ri)):Ri<0&&(vr=Math.min(vr,si/(si-Ri))),!(vr<yr||(er.lerp(Lr,yr),Lr.lerp(er,1-vr),0)))}(ni.positionScreen,cr.positionScreen)&&(ni.positionScreen.multiplyScalar(1/ni.positionScreen.w),cr.positionScreen.multiplyScalar(1/cr.positionScreen.w),xe=function xs(){if(Ie===Be){const er=new A3;return Yn.push(er),Be++,Ie++,er}return Yn[Ie++]}(),xe.id=vr.id,xe.v1.copy(ni),xe.v2.copy(cr),xe.z=Math.max(ni.positionScreen.z,cr.positionScreen.z),xe.renderOrder=vr.renderOrder,xe.material=vr.material,vr.material.vertexColors&&(xe.vertexColors[0].fromArray(Lr,3*$t),xe.vertexColors[1].fromArray(Lr,3*Pt)),ze.elements.push(xe))},pushTriangle:function _s($t,Pt,ni,cr){const Ar=Ti[$t],Br=Ti[Pt],ks=Ti[ni];if(!1!==fr(Ar,Br,ks)&&(cr.side===Y||!0===us(Ar,Br,ks))){q=function as(){if(de===pe){const er=new im;return ur.push(er),pe++,de++,er}return ur[de++]}(),q.id=vr.id,q.v1.copy(Ar),q.v2.copy(Br),q.v3.copy(ks),q.z=(Ar.positionScreen.z+Br.positionScreen.z+ks.positionScreen.z)/3,q.renderOrder=vr.renderOrder,Mt.subVectors(ks.position,Br.position),ct.subVectors(Ar.position,Br.position),Mt.cross(ct),q.normalModel.copy(Mt),q.normalModel.applyMatrix3(_n).normalize();for(let Ir=0;Ir<3;Ir++){const ts=q.vertexNormalsModel[Ir];ts.fromArray(er,3*arguments[Ir]),ts.applyMatrix3(_n).normalize(),q.uvs[Ir].fromArray(yr,2*arguments[Ir])}q.vertexNormalsLength=3,q.material=cr,cr.vertexColors&&q.color.fromArray(Lr,3*$t),ze.elements.push(q)}}}};function br(er){if(!1===er.visible)return;if(er.isLight)ze.lights.push(er);else if(er.isMesh||er.isLine||er.isPoints){if(!1===er.material.visible||!0===er.frustumCulled&&!1===Zt.intersectsObject(er))return;Ji(er)}else if(er.isSprite){if(!1===er.material.visible||!0===er.frustumCulled&&!1===Zt.intersectsSprite(er))return;Ji(er)}const Lr=er.children;for(let yr=0,vr=Lr.length;yr<vr;yr++)br(Lr[yr])}function Ji(er){o=function ei(){if(c===h){const er=new m3;return li.push(er),h++,c++,er}return li[c++]}(),o.id=er.id,o.object=er,Mt.setFromMatrixPosition(er.matrixWorld),Mt.applyMatrix4(Rn),o.z=Mt.z,o.renderOrder=er.renderOrder,ze.objects.push(o)}function lr(er,Lr,yr){const vr=1/er.w;er.z*=vr,er.z>=-1&&er.z<=1&&(Le=function Ds(){if(Ke===ft){const er=new vP;return Di.push(er),ft++,Ke++,er}return Di[Ke++]}(),Le.id=Lr.id,Le.x=er.x*vr,Le.y=er.y*vr,Le.z=er.z,Le.renderOrder=Lr.renderOrder,Le.object=Lr,Le.rotation=Lr.rotation,Le.scale.x=Lr.scale.x*Math.abs(Le.x-(er.x+yr.projectionMatrix.elements[0])/(er.w+yr.projectionMatrix.elements[12])),Le.scale.y=Lr.scale.y*Math.abs(Le.y-(er.y+yr.projectionMatrix.elements[5])/(er.w+yr.projectionMatrix.elements[13])),Le.material=Lr.material,ze.elements.push(Le))}function fs(er,Lr){return er.renderOrder!==Lr.renderOrder?er.renderOrder-Lr.renderOrder:er.z!==Lr.z?Lr.z-er.z:er.id!==Lr.id?er.id-Lr.id:0}this.projectScene=function(er,Lr,yr,vr){de=0,Ie=0,Ke=0,ze.elements.length=0,!0===er.matrixWorldAutoUpdate&&er.updateMatrixWorld(),null===Lr.parent&&!0===Lr.matrixWorldAutoUpdate&&Lr.updateMatrixWorld(),rn.copy(Lr.matrixWorldInverse),Rn.multiplyMatrices(Lr.projectionMatrix,rn),Zt.setFromProjectionMatrix(Rn),c=0,ze.objects.length=0,ze.lights.length=0,br(er),!0===yr&&ze.objects.sort(fs);const _n=ze.objects;for(let Ki=0,si=_n.length;Ki<si;Ki++){const Ri=_n[Ki].object,Ii=Ri.geometry;if(Li.setObject(Ri),We=Ri.matrixWorld,M=0,Ri.isMesh){let es=Ri.material;const Ur=Array.isArray(es),fr=Ii.attributes,us=Ii.groups;if(void 0===fr.position)continue;const co=fr.position.array;for(let _s=0,$t=co.length;_s<$t;_s+=3){let Pt=co[_s],ni=co[_s+1],cr=co[_s+2];const Ar=Ii.morphAttributes.position;if(void 0!==Ar){const Br=Ii.morphTargetsRelative,ks=Ri.morphTargetInfluences;for(let Ir=0,ts=Ar.length;Ir<ts;Ir++){const Nn=ks[Ir];if(0===Nn)continue;const Vr=Ar[Ir];Br?(Pt+=Vr.getX(_s/3)*Nn,ni+=Vr.getY(_s/3)*Nn,cr+=Vr.getZ(_s/3)*Nn):(Pt+=(Vr.getX(_s/3)-co[_s])*Nn,ni+=(Vr.getY(_s/3)-co[_s+1])*Nn,cr+=(Vr.getZ(_s/3)-co[_s+2])*Nn)}}Li.pushVertex(Pt,ni,cr)}if(void 0!==fr.normal){const _s=fr.normal.array;for(let $t=0,Pt=_s.length;$t<Pt;$t+=3)Li.pushNormal(_s[$t],_s[$t+1],_s[$t+2])}if(void 0!==fr.color){const _s=fr.color.array;for(let $t=0,Pt=_s.length;$t<Pt;$t+=3)Li.pushColor(_s[$t],_s[$t+1],_s[$t+2])}if(void 0!==fr.uv){const _s=fr.uv.array;for(let $t=0,Pt=_s.length;$t<Pt;$t+=2)Li.pushUv(_s[$t],_s[$t+1])}if(null!==Ii.index){const _s=Ii.index.array;if(us.length>0)for(let $t=0;$t<us.length;$t++){const Pt=us[$t];if(es=!0===Ur?Ri.material[Pt.materialIndex]:Ri.material,void 0!==es)for(let ni=Pt.start,cr=Pt.start+Pt.count;ni<cr;ni+=3)Li.pushTriangle(_s[ni],_s[ni+1],_s[ni+2],es)}else for(let $t=0,Pt=_s.length;$t<Pt;$t+=3)Li.pushTriangle(_s[$t],_s[$t+1],_s[$t+2],es)}else if(us.length>0)for(let _s=0;_s<us.length;_s++){const $t=us[_s];if(es=!0===Ur?Ri.material[$t.materialIndex]:Ri.material,void 0!==es)for(let Pt=$t.start,ni=$t.start+$t.count;Pt<ni;Pt+=3)Li.pushTriangle(Pt,Pt+1,Pt+2,es)}else for(let _s=0,$t=co.length/3;_s<$t;_s+=3)Li.pushTriangle(_s,_s+1,_s+2,es)}else if(Ri.isLine){kt.multiplyMatrices(Rn,We);const es=Ii.attributes;if(void 0!==es.position){const Ur=es.position.array;for(let fr=0,us=Ur.length;fr<us;fr+=3)Li.pushVertex(Ur[fr],Ur[fr+1],Ur[fr+2]);if(void 0!==es.color){const fr=es.color.array;for(let us=0,co=fr.length;us<co;us+=3)Li.pushColor(fr[us],fr[us+1],fr[us+2])}if(null!==Ii.index){const fr=Ii.index.array;for(let us=0,co=fr.length;us<co;us+=2)Li.pushLine(fr[us],fr[us+1])}else{const fr=Ri.isLineSegments?2:1;for(let us=0,co=Ur.length/3-1;us<co;us+=fr)Li.pushLine(us,us+1)}}}else if(Ri.isPoints){kt.multiplyMatrices(Rn,We);const es=Ii.attributes;if(void 0!==es.position){const Ur=es.position.array;for(let fr=0,us=Ur.length;fr<us;fr+=3)ct.set(Ur[fr],Ur[fr+1],Ur[fr+2],1),ct.applyMatrix4(kt),lr(ct,Ri,Lr)}}else Ri.isSprite&&(Ri.modelViewMatrix.multiplyMatrices(Lr.matrixWorldInverse,Ri.matrixWorld),ct.set(We.elements[12],We.elements[13],We.elements[14],1),ct.applyMatrix4(Rn),lr(ct,Ri,Lr))}return!0===vr&&ze.elements.sort(fs),ze}}}class bP{constructor(){let o,c,h,m,M,N,q,de,pe,xe,Ie,ft,We,Be=0,Le=null,Ke=1;const ze=this,Mt=new gy,ct=new gy,Dt=new Os,Jt=new Os,cn=new Os,rn=new Os,Rn=new Os,kt=new Os,Zt=new Ft,li=new Ft,Ti=new Ft,ur=new zo,Yn=new bo,Di=new bo,rr=[],Li=new io,br=document.createElementNS("http://www.w3.org/2000/svg","svg");function Ji(){for(Be=0;br.childNodes.length>0;)br.removeChild(br.childNodes[0])}function lr(yr){return null!==Le?yr.toFixed(Le):yr}function as(yr,vr,_n){let Ki=vr.scale.x*N,si=vr.scale.y*q;_n.isPointsMaterial&&(Ki*=_n.size,si*=_n.size);const Ri="M"+lr(yr.x-.5*Ki)+","+lr(yr.y-.5*si)+"h"+lr(Ki)+"v"+lr(si)+"h"+lr(-Ki)+"z";let Ii="";(_n.isSpriteMaterial||_n.isPointsMaterial)&&(Ii="fill:"+_n.color.getStyle(ze.outputColorSpace)+";fill-opacity:"+_n.opacity),eo(Ii,Ri)}function xs(yr,vr,_n){const Ki="M"+lr(yr.positionScreen.x)+","+lr(yr.positionScreen.y)+"L"+lr(vr.positionScreen.x)+","+lr(vr.positionScreen.y);if(_n.isLineBasicMaterial){let si="fill:none;stroke:"+_n.color.getStyle(ze.outputColorSpace)+";stroke-opacity:"+_n.opacity+";stroke-width:"+_n.linewidth+";stroke-linecap:"+_n.linecap;_n.isLineDashedMaterial&&(si=si+";stroke-dasharray:"+_n.dashSize+","+_n.gapSize),eo(si,Ki)}}function Ds(yr,vr,_n,Ki,si){ze.info.render.vertices+=3,ze.info.render.faces++;const Ri="M"+lr(yr.positionScreen.x)+","+lr(yr.positionScreen.y)+"L"+lr(vr.positionScreen.x)+","+lr(vr.positionScreen.y)+"L"+lr(_n.positionScreen.x)+","+lr(_n.positionScreen.y)+"z";let Ii="";si.isMeshBasicMaterial?(Dt.copy(si.color),si.vertexColors&&Dt.multiply(Ki.color)):si.isMeshLambertMaterial||si.isMeshPhongMaterial||si.isMeshStandardMaterial?(Jt.copy(si.color),si.vertexColors&&Jt.multiply(Ki.color),Dt.copy(cn),li.copy(yr.positionWorld).add(vr.positionWorld).add(_n.positionWorld).divideScalar(3),function sr(yr,vr,_n,Ki){for(let si=0,Ri=yr.length;si<Ri;si++){const Ii=yr[si],es=Ii.color;if(Ii.isDirectionalLight){const Ur=Zt.setFromMatrixPosition(Ii.matrixWorld).normalize();let fr=_n.dot(Ur);if(fr<=0)continue;fr*=Ii.intensity,Ki.r+=es.r*fr,Ki.g+=es.g*fr,Ki.b+=es.b*fr}else if(Ii.isPointLight){const Ur=Zt.setFromMatrixPosition(Ii.matrixWorld);let fr=_n.dot(Zt.subVectors(Ur,vr).normalize());if(fr<=0||(fr*=0==Ii.distance?1:1-Math.min(vr.distanceTo(Ur)/Ii.distance,1),0==fr))continue;fr*=Ii.intensity,Ki.r+=es.r*fr,Ki.g+=es.g*fr,Ki.b+=es.b*fr}}}(h,li,Ki.normalModel,Dt),Dt.multiply(Jt).add(si.emissive)):si.isMeshNormalMaterial&&(Ti.copy(Ki.normalModel).applyMatrix3(ur).normalize(),Dt.setRGB(Ti.x,Ti.y,Ti.z).multiplyScalar(.5).addScalar(.5)),Ii=si.wireframe?"fill:none;stroke:"+Dt.getStyle(ze.outputColorSpace)+";stroke-opacity:"+si.opacity+";stroke-width:"+si.wireframeLinewidth+";stroke-linecap:"+si.wireframeLinecap+";stroke-linejoin:"+si.wireframeLinejoin:"fill:"+Dt.getStyle(ze.outputColorSpace)+";fill-opacity:"+si.opacity,eo(Ii,Ri)}function fs(yr,vr,_n){let Ki=vr.x-yr.x,si=vr.y-yr.y;const Ri=Ki*Ki+si*si;if(0===Ri)return;const Ii=_n/Math.sqrt(Ri);Ki*=Ii,si*=Ii,vr.x+=Ki,vr.y+=si,yr.x-=Ki,yr.y-=si}function eo(yr,vr){We===yr?ft+=vr:(er(),We=yr,ft=vr)}function er(){ft&&(Ie=function Lr(yr){return null==rr[yr]&&(rr[yr]=document.createElementNS("http://www.w3.org/2000/svg","path"),0==Ke&&rr[yr].setAttribute("shape-rendering","crispEdges")),rr[yr]}(Be++),Ie.setAttribute("d",ft),Ie.setAttribute("style",We),br.appendChild(Ie)),ft="",We=""}this.domElement=br,this.autoClear=!0,this.sortObjects=!0,this.sortElements=!0,this.overdraw=.5,this.outputColorSpace=ll,this.info={render:{vertices:0,faces:0}},this.setQuality=function(yr){switch(yr){case"high":Ke=1;break;case"low":Ke=0}},this.setClearColor=function(yr){kt.set(yr)},this.setPixelRatio=function(){},this.setSize=function(yr,vr){m=yr,M=vr,N=m/2,q=M/2,br.setAttribute("viewBox",-N+" "+-q+" "+m+" "+M),br.setAttribute("width",m),br.setAttribute("height",M),Mt.min.set(-N,-q),Mt.max.set(N,q)},this.getSize=function(){return{width:m,height:M}},this.setPrecision=function(yr){Le=yr},this.clear=function(){Ji(),br.style.backgroundColor=kt.getStyle(ze.outputColorSpace)},this.render=function(yr,vr){if(!(vr instanceof sp))return void console.error("THREE.SVGRenderer.render: camera is not an instance of Camera.");const _n=yr.background;_n&&_n.isColor?(Ji(),br.style.backgroundColor=_n.getStyle(ze.outputColorSpace)):!0===this.autoClear&&this.clear(),ze.info.render.vertices=0,ze.info.render.faces=0,Yn.copy(vr.matrixWorldInverse),Di.multiplyMatrices(vr.projectionMatrix,Yn),o=Li.projectScene(yr,vr,this.sortObjects,this.sortElements),c=o.elements,h=o.lights,ur.getNormalMatrix(vr.matrixWorldInverse),function ei(yr){cn.setRGB(0,0,0),rn.setRGB(0,0,0),Rn.setRGB(0,0,0);for(let vr=0,_n=yr.length;vr<_n;vr++){const Ki=yr[vr],si=Ki.color;Ki.isAmbientLight?(cn.r+=si.r,cn.g+=si.g,cn.b+=si.b):Ki.isDirectionalLight?(rn.r+=si.r,rn.g+=si.g,rn.b+=si.b):Ki.isPointLight&&(Rn.r+=si.r,Rn.g+=si.g,Rn.b+=si.b)}}(h),ft="",We="";for(let Ki=0,si=c.length;Ki<si;Ki++){const Ri=c[Ki],Ii=Ri.material;if(void 0!==Ii&&0!==Ii.opacity)if(ct.makeEmpty(),Ri instanceof vP)de=Ri,de.x*=N,de.y*=-q,as(de,Ri,Ii);else if(Ri instanceof A3)de=Ri.v1,pe=Ri.v2,de.positionScreen.x*=N,de.positionScreen.y*=-q,pe.positionScreen.x*=N,pe.positionScreen.y*=-q,ct.setFromPoints([de.positionScreen,pe.positionScreen]),!0===Mt.intersectsBox(ct)&&xs(de,pe,Ii);else if(Ri instanceof im){if(de=Ri.v1,pe=Ri.v2,xe=Ri.v3,de.positionScreen.z<-1||de.positionScreen.z>1||pe.positionScreen.z<-1||pe.positionScreen.z>1||xe.positionScreen.z<-1||xe.positionScreen.z>1)continue;de.positionScreen.x*=N,de.positionScreen.y*=-q,pe.positionScreen.x*=N,pe.positionScreen.y*=-q,xe.positionScreen.x*=N,xe.positionScreen.y*=-q,this.overdraw>0&&(fs(de.positionScreen,pe.positionScreen,this.overdraw),fs(pe.positionScreen,xe.positionScreen,this.overdraw),fs(xe.positionScreen,de.positionScreen,this.overdraw)),ct.setFromPoints([de.positionScreen,pe.positionScreen,xe.positionScreen]),!0===Mt.intersectsBox(ct)&&Ds(de,pe,xe,Ri,Ii)}}er(),yr.traverseVisible(function(Ki){if(Ki.isSVGObject){if(Zt.setFromMatrixPosition(Ki.matrixWorld),Zt.applyMatrix4(Di),Zt.z<-1||Zt.z>1)return;const Ii=Ki.node;Ii.setAttribute("transform","translate("+Zt.x*N+","+-Zt.y*q+")"),br.appendChild(Ii)}})}}}let UM=hP;typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:x}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=x)},1949:(Yr,mt,Se)=>{"use strict";Se.r(mt),Se.d(mt,{TDrawSelector:()=>E,TDrawVariable:()=>A,TSelector:()=>Y,clTBranchFunc:()=>J,kClonesNode:()=>Ze,kSTLNode:()=>Re,treeDraw:()=>k,treeHierarchy:()=>he,treeIOTest:()=>ee,treeProcess:()=>I});var Ee=Se(4882),x=Se(8872),L=Se(4369),ve=Se(6983);const ke=0,ot=1,Ye=2,Ze=3,Re=4,He=31,Ve=41,De=(0,x.BIT)(22),F="TBranchElement",J="TBranchFunc";class Y{constructor(){this._branches=[],this._names=[],this._directs=[],this._break=0,this.tgtobj={}}addBranch(b,P,T){return P||(P=(0,x.isStr)(b)?b:`br${this._branches.length}`),this._branches.push(b),this._names.push(P),this._directs.push(T),this._branches.length-1}numBranches(){return this._branches.length}getBranch(b){return this._branches[b]}indexOfBranch(b){return this._branches.indexOf(b)}nameOfBranch(b){return this._names[b]}ShowProgress(){}Abort(){this._break=-1111}Begin(){}Process(){}Terminate(){}}function ue(G,b){if(!(0,x.isObject)(G))return 0;const P=(0,x.isArrayProto)(Object.prototype.toString.apply(G));if(!b||1!==P)return P;let T,z=!0;for(let W=0;W<G.length;++W){const fe=typeof G[W];if(T||(T=fe),fe!==T){z=!1;break}if((0,x.isObject)(fe)&&ue(G[W])){z=!1;break}}return z?2:1}class Q{constructor(b,P,T){this.object=b,this.value=0,this.arr=[],this.indx=[],this.cnt=-1,this.tgtobj=T,this.select=(0,x.isObject)(P)?P:[]}next(){let b,P,T=this.cnt;if(T>=0){if(++this.fastindx<this.fastlimit)return this.value=this.fastarr[this.fastindx],!0;for(;--T>=0&&!(void 0===this.select[T]&&++this.indx[T]<this.arr[T].length););if(T<0)return!1}for(;;){if(b=T<0?this.object:this.arr[T][this.indx[T]],P=b?typeof b:"any","object"===P&&(void 0!==b._typename?(0,x.isRootCollection)(b)?(b=b.arr,P="array"):P="any":P=Number.isInteger(b.length)&&ue(b)>0?"array":"any"),"$self$"===this.select[T+1])return this.value=b,this.fastindx=this.fastlimit=0,this.cnt=T+1,!0;if("any"===P&&(0,x.isStr)(this.select[T+1]))this.arr[++T]=b,this.indx[T]=this.select[T];else{if("array"!==P||!(b.length>0||"$size$"===this.select[T+1]))return!(T<0||(this.value=b,void 0===this.select[T]?(this.fastarr=this.arr[T],this.fastindx=this.indx[T],this.fastlimit=this.fastarr.length):this.fastindx=this.fastlimit=0,this.cnt=T,0));switch(this.arr[++T]=b,this.select[T]){case void 0:this.indx[T]=0;break;case"$last$":this.indx[T]=b.length-1;break;case"$size$":return this.value=b.length,this.fastindx=this.fastlimit=0,this.cnt=T,!0;default:Number.isInteger(this.select[T])?(this.indx[T]=this.select[T],this.indx[T]<0&&(this.indx[T]=b.length-1)):(this.select[T].produce(this.tgtobj),this.indx[T]=Math.round(this.select[T].get(0)))}}}}reset(){this.arr=[],this.indx=[],delete this.fastarr,this.cnt=-1,this.value=0}}function me(G,b,P=!1,T=!1){if(!G||G._typename!==F)return"";if(G.fType===ke&&-2===G.fID&&-1===G.fStreamerType)return G.fClassName;if(P&&G.fClonesName&&(G.fType===Ze||G.fType===Re))return G.fClonesName;const z=g(G,b.$file);if(G.fType===ot&&z&&"BASE"===z.fTypeName)return z.fName;if(G.fType===Ye)return!z||z.fType!==L.Ph&&z.fType!==L.w1?x.clTObject:z.fTypeName;if(G.fType===ke&&z&&T){if(z.fType===L.Ph||z.fType===L.w1)return z.fTypeName;if(z.fType===L.FF)return z.fTypeName.slice(0,z.fTypeName.length-1)}return""}function B(G,b,P=void 0,T=!1){let z=!1,W=b,fe=null;if(!P){z=!0,P=G.fBranches;const we=W.indexOf("[");we>0&&(W=W.slice(0,we))}if(!P||0===P.arr.length)return null;for(let we=0;we<P.arr.length;++we){let Me=P.arr[we].fName;if("]"===Me[Me.length-1]&&(Me=Me.slice(0,Me.indexOf("["))),0!==W.indexOf(Me)&&Me.indexOf("<")>0){const Ge=Me.indexOf("<"),lt=Me.lastIndexOf(">");Me=Me.slice(0,Ge)+Me.slice(lt+1)}if(Me===W){fe={branch:P.arr[we],rest:""};break}if(0!==W.indexOf(Me))continue;let je=Me.length;if("."===Me[je-1]&&je--,"."===W[je]){fe=B(G,W,P.arr[we].fBranches),fe||(fe=B(G,W.slice(je+1),P.arr[we].fBranches)),fe||(fe={branch:P.arr[we],rest:W.slice(je)});break}}if(z&&!T&&!fe&&0===W.indexOf("br_")){let we=3;for(;we<W.length&&W[we]>="0"&&W[we]<="9";)++we;const Me=we>3?function X(G,b){if(!Number.isInteger(b))return;let P,T=0;return function z(W){W?.fBranches?.arr.forEach(fe=>{T++===b&&(P=fe),P||z(fe)})}(G),P}(G,parseInt(W.slice(3,we))):null;Me&&(fe={branch:Me,rest:W.slice(we)})}return!z||!fe||b.length>W.length&&(fe.rest+=b.slice(W.length)),fe}function $(G,b){const P=B(G,b,G.fBranches,!0);return!P||P.rest?null:P.branch}class A{constructor(b){this.globals=b,this.code="",this.brindex=[],this.branches=[],this.brarray=[],this.func=null,this.kind=void 0,this.buf=[]}parse(b,P,T,z,W){const fe=lt=>lt>="A"&&lt<="Z"||lt>="a"&&lt<="z"||"_"===lt,we=lt=>!!(fe(lt)||lt>="0"&&lt<="9");T||(T=""),this.code=(z?.fName??"")+T;let Me=0,je=0,Ge=null;for(;Me<T.length||z;){let lt=[];if(z)Ge=z,z=void 0;else{for(je=Me;je<T.length&&(we(T[je])||"."===T[je]);)je++;if("$"===T[je]){let Je="";switch(T.slice(Me,je)){case"LocalEntry":case"Entry":Je="arg.$globals.entry";break;case"Entries":Je="arg.$globals.entries"}if(Je){T=T.slice(0,Me)+Je+T.slice(je+1),Me+=Je.length;continue}}if(Ge=B(b,T.slice(Me,je)),!Ge){Me=je+1;continue}Ge.branch&&void 0!==Ge.rest&&(je-=Ge.rest.length,W=void 0,Ge=Ge.branch),je>=T.length-1&&"."===T[T.length-1]&&(lt.push("$self$"),je=T.length)}for(;je<T.length;){if("@"===T[je]&&"@size"===T.slice(je,je+5)&&0===lt.length){je+=5,W=!0;break}if("."===T[je]){const Ne=++je;if("@"===T[Ne]&&"@size"===T.slice(Ne,Ne+5)){lt.push("$size$"),je+=5;break}if(!fe(T[Ne])){lt.push("$self$");break}for(;je<T.length&&we(T[je]);)je++;if("("===T[je]){je=Ne-1;break}if(0===lt.length)if(Ge.fType===Ze||Ge.fType===Re)lt.push(void 0);else{const rt=me(Ge,b,!1,!0);rt&&(0,x.isRootCollection)(null,rt)&&lt.push(void 0)}lt.push(T.slice(Ne,je));continue}if("["!==T[je])break;if("]"===T[je+1]){lt.push(void 0),je+=2;continue}const Je=je++;let tt=0;for(;je<T.length&&("]"!==T[je]||tt>0);)"["===T[je]?tt++:"]"===T[je]&&tt--,je++;const Fe=T.slice(Je+1,je);switch(Fe){case"":case"$all$":lt.push(void 0);break;case"$last$":lt.push("$last$");break;case"$size$":lt.push("$size$");break;case"$first$":lt.push(0);break;default:if(Number.isInteger(parseInt(Fe)))lt.push(parseInt(Fe));else{const Ne=new A(this.globals);if(!Ne.parse(b,P,Fe))return!1;lt.push(Ne)}}je++}0===lt.length?lt=void 0:1===lt.length&&void 0===lt[0]&&(lt=!0);let bt=P.indexOfBranch(Ge);if(bt<0&&(bt=P.addBranch(Ge,void 0,W)),W=void 0,this.brindex.push(bt),this.branches.push(P.nameOfBranch(bt)),this.brarray.push(lt),0===Me&&je===T.length&&1===this.branches.length)return this.direct_branch=!0,!0;const te="arg.var"+(this.branches.length-1);T=T.slice(0,Me)+te+T.slice(je),Me+=te.length}return T=T.replace(/TMath::Exp\(/g,"Math.exp(").replace(/TMath::Abs\(/g,"Math.abs(").replace(/TMath::Prob\(/g,"arg.$math.Prob(").replace(/TMath::Gaus\(/g,"arg.$math.Gaus("),this.func=new Function("arg",`return (${T})`),!0}is_dummy(){return 0===this.branches.length&&!this.func}produce(b){if(this.length=1,this.isarray=!1,this.is_dummy())return this.value=1,void(this.kind="number");const P={$globals:this.globals,$math:ve},T=[];let z=-1;for(let W=0;W<this.branches.length;++W){const fe=`var${W}`;if(P[fe]=b[this.branches[W]],void 0===this.brarray[W]&&(this.brarray[W]=ue(P[fe])>0||(0,x.isRootCollection)(P[fe])),!1!==this.brarray[W]){if(!0===this.brarray[W]&&2===ue(P[fe],!0))T[W]=P[fe];else{const we=new Q(P[fe],this.brarray[W],b);for(T[W]=[];we.next();)T[W].push(we.value)}(z<0||z<T[W].length)&&(z=T[W].length)}}if(z<0)return this.value=this.direct_branch?P.var0:this.func(P),void(this.kind||(this.kind=typeof this.value));if(0===z)return this.length=0,void(this.value=0);if(this.length=z,this.isarray=!0,this.direct_branch)this.value=T[0];else{this.value=new Array(z);for(let W=0;W<z;++W){for(let fe=0;fe<this.branches.length;++fe)T[fe]&&(P[`var${fe}`]=T[fe][W]);this.value[W]=this.func(P)}}this.kind||(this.kind=typeof this.value[0])}get(b){return this.isarray?this.value[b]:this.value}appendArray(b){this.buf=this.buf.concat(b[this.branches[0]])}}class E extends Y{constructor(){super(),this.ndim=0,this.vars=[],this.cut=null,this.hist=null,this.histo_drawopt="",this.hist_name="$htemp",this.hist_title="Result of TTree::Draw",this.graph=!1,this.hist_args=[],this.arr_limit=1e3,this.htype="F",this.monitoring=0,this.globals={},this.last_progress=0,this.aver_diff=0}setCallback(b,P){this.result_callback=b,this.progress_callback=P}parseParameters(b,P,T){if(!T||!(0,x.isStr)(T))return"";let z=T.lastIndexOf(";");for(;z>=0;){let fe,W=T.slice(z+1);z=(T=T.slice(0,z)).lastIndexOf(";");const we=W.indexOf(":");we>0&&(fe=W.slice(we+1),W=W.slice(0,we));let Me=parseInt(fe);switch((!fe||!Number.isInteger(Me))&&(Me=void 0),W){case"num":case"entries":case"numentries":"all"===fe?P.numentries=b.fEntries:"half"===fe?P.numentries=Math.round(b.fEntries/2):void 0!==Me&&(P.numentries=Me);break;case"first":void 0!==Me&&(P.firstentry=Me);break;case"mon":case"monitor":P.monitoring=void 0!==Me?Me:5e3;break;case"player":P.player=!0;break;case"dump":P.dump=!0;break;case"maxseg":case"maxrange":Me&&(b.$file.fMaxRanges=Me);break;case"accum":Me&&(this.arr_limit=Me);break;case"htype":fe&&1===fe.length&&(this.htype=fe.toUpperCase(),["C","S","I","F","L","D"].indexOf(this.htype)<0&&(this.htype="F"));break;case"hbins":this.hist_nbins=parseInt(fe),!Number.isInteger(this.hist_nbins)||this.hist_nbins<=3?delete this.hist_nbins:this.want_hist=!0;break;case"drawopt":P.drawopt=fe;break;case"graph":P.graph=Me||!0}}if(z=T.lastIndexOf(">>"),z>=0){let W=T.slice(z+2).trim();if(T=T.slice(0,z).trim(),z=W.indexOf("("),z>0&&(this.hist_name=W.slice(0,z),W=W.slice(z)),"dump"===W)P.dump=!0;else if(0===W.indexOf("Graph"))P.graph=!0;else if(z<0)this.want_hist=!0,this.hist_name=W;else if("("===W[0]&&")"===W[W.length-1]){this.want_hist=!0,W=W.slice(1,W.length-1).split(",");let fe=!0;for(let we=0;we<W.length;++we)W[we]=we%3==0?parseInt(W[we]):parseFloat(W[we]),Number.isFinite(W[we])||(fe=!1);fe&&(this.hist_args=W)}}return P.dump&&(this.dump_values=!0,P.reallocate_objects=!0,void 0===P.numentries&&(P.numentries=10)),T}parseDrawExpression(b,P){let T=this.parseParameters(b,P,P.expr),z="";this.hist_title=`drawing '${T}' from ${b.fName}`;let W=0;P.cut?z=P.cut:(W=T.replace(/TMath::/g,"TMath__").lastIndexOf("::"),W>0&&(z=T.slice(W+2).trim(),T=T.slice(0,W).trim())),P.parse_expr=T,P.parse_cut=z;const fe=[];let we=0,Me=0,je=0;for(W=0;W<T.length;++W)switch(T[W]){case"(":we++;break;case")":we--;break;case"[":Me++;break;case"]":Me--;break;case":":if(":"===T[W+1]){W++;continue}!we&&!Me&&W>je&&fe.push(T.slice(je,W)),je=W+1}if(!we&&!Me&&W>je&&fe.push(T.slice(je,W)),fe.length<1||fe.length>3)return!1;this.ndim=fe.length;let Ge=!z;for(let lt=0;lt<this.ndim;++lt){if(this.vars[lt]=new A(this.globals),!this.vars[lt].parse(b,this,fe[lt]))return!1;this.vars[lt].direct_branch||(Ge=!1)}return this.cut=new A(this.globals),!(z&&!this.cut.parse(b,this,z)||(this.numBranches()?(Ge&&(this.ProcessArrays=this.ProcessArraysFunc),this.monitoring=P.monitoring,3===this.ndim&&!this.want_hist&&!P.dump&&(P.graph=!0),this.graph=P.graph,this.histo_drawopt=void 0!==P.drawopt?P.drawopt:2===this.ndim?"col":"",0):(console.warn("no any branch is selected"),1)))}drawOnlyBranch(b,P,T,z){return this.ndim=1,0===T.indexOf("dump")&&(T=";"+T),T=this.parseParameters(b,z,T),this.monitoring=z.monitoring,z.dump&&(this.dump_values=!0,z.reallocate_objects=!0),this.dump_values?(this.hist=[],this.leaf=z.leaf,this.copy_fields=(z.branch.fLeaves&&z.branch.fLeaves.arr.length>1||z.branch.fBranches&&z.branch.fBranches.arr.length>0)&&!z.leaf,this.addBranch(P,"br0",z.direct_branch),this.Process=this.ProcessDump,!0):(this.vars[0]=new A(this.globals),!!this.vars[0].parse(b,this,T,P,z.direct_branch)&&(this.hist_title=`drawing branch ${P.fName} ${T?" expr:"+T:""} from ${b.fName}`,this.cut=new A(this.globals),this.vars[0].direct_branch&&(this.ProcessArrays=this.ProcessArraysFunc),!0))}Begin(b){this.globals.entries=b.fEntries,this.monitoring&&(this.lasttm=(new Date).getTime())}ShowProgress(){}getBitsBins(b,P){P.nbins=P.max=b,P.fLabels=(0,x.create)(x.clTHashList);for(let T=0;T<b;++T){const z=(0,x.create)(x.clTObjString);z.fString=T.toString(),z.fUniqueID=T+1,P.fLabels.Add(z)}return P}getMinMaxBins(b,P){const T={min:0,max:0,nbins:P,k:1,fLabels:null,title:""};if(b>=this.ndim)return T;const z=this.vars[b].buf;if(T.title=this.vars[b].code||"","object"===this.vars[b].kind){let W,fe=!0,we=8;for(let Me=0;Me<z.length;++Me)z[Me]&&(W||(W=z[Me]._typename),W!==z[Me]._typename&&(fe=!1),z[Me].fNbits&&(we=Math.max(we,z[Me].fNbits+1)));if(W&&fe&&"TBits"===W&&0===b)return this.fill1DHistogram=this.fillTBitsHistogram,we%8&&(we=8+(65520&we)),"bits"===this.hist_name&&1===this.hist_args.length&&this.hist_args[0]&&(we=this.hist_args[0]),this.getBitsBins(we,T)}if("string"===this.vars[b].kind){T.lbls=[];for(let W=0;W<z.length;++W)T.lbls.indexOf(z[W])<0&&T.lbls.push(z[W]);T.lbls.sort(),T.max=T.nbins=T.lbls.length,T.fLabels=(0,x.create)(x.clTHashList);for(let W=0;W<T.lbls.length;++W){const fe=(0,x.create)(x.clTObjString);fe.fString=T.lbls[W],fe.fUniqueID=W+1,""===fe.fString&&(fe.fString="<empty>"),T.fLabels.Add(fe)}}else{if(0===b&&"bits"===this.hist_name&&this.hist_args.length<=1)return this.fill1DHistogram=this.FillBitsHistogram,this.getBitsBins(this.hist_args[0]||32,T);if(3*b+2<this.hist_args.length)T.nbins=this.hist_args[3*b],T.min=this.hist_args[3*b+1],T.max=this.hist_args[3*b+2];else{let W=!1;for(let fe=1;fe<z.length;++fe){const we=z[fe];Number.isFinite(we)&&(W?(T.min=Math.min(T.min,we),T.max=Math.max(T.max,we)):(T.min=T.max=we,W=!0))}if(W||(T.min=0,T.max=1),this.hist_nbins&&(P=T.nbins=this.hist_nbins),T.isinteger=Math.round(T.min)===T.min&&Math.round(T.max)===T.max,T.isinteger)for(let fe=0;fe<z.length;++fe)if(z[fe]!==Math.round(z[fe])){T.isinteger=!1;break}if(T.isinteger)if(T.min=Math.round(T.min),T.max=Math.round(T.max),T.max-T.min<5*P)T.min-=1,T.max+=2,T.nbins=Math.round(T.max-T.min);else{const fe=T.max-T.min+2;let we=Math.floor(fe/P);for(;we*P<fe;)we++;T.max=T.min+P*we}else T.min>=T.max?(T.max=T.min,Math.abs(T.min)<100?(T.min-=1,T.max+=1):T.min>0?(T.min*=.9,T.max*=1.1):(T.min*=1.1,T.max*=.9)):T.max+=(T.max-T.min)/T.nbins}}return T.k=T.nbins/(T.max-T.min),T.GetBin=function(W){const fe=this.lbls?.indexOf(W)??Number.isFinite(W)?Math.floor((W-this.min)*this.k):this.nbins+1;return fe<0?0:fe>this.nbins?this.nbins+1:fe+1},T}createHistogram(b,P=!1){b||(b=20);const T=this.getMinMaxBins(0,b),z=this.getMinMaxBins(1,b),W=this.getMinMaxBins(2,b);let fe=null;switch(this.ndim){case 1:fe=(0,x.createHistogram)(x.clTH1+this.htype,T.nbins);break;case 2:fe=(0,x.createHistogram)(x.clTH2+this.htype,T.nbins,z.nbins);break;case 3:fe=(0,x.createHistogram)(x.clTH3+this.htype,T.nbins,z.nbins,W.nbins)}return fe.fXaxis.fTitle=T.title,fe.fXaxis.fXmin=T.min,fe.fXaxis.fXmax=T.max,fe.fXaxis.fLabels=T.fLabels,this.ndim>1&&(fe.fYaxis.fTitle=z.title),fe.fYaxis.fXmin=z.min,fe.fYaxis.fXmax=z.max,fe.fYaxis.fLabels=z.fLabels,this.ndim>2&&(fe.fZaxis.fTitle=W.title),fe.fZaxis.fXmin=W.min,fe.fZaxis.fXmax=W.max,fe.fZaxis.fLabels=W.fLabels,fe.fName=this.hist_name,fe.fTitle=this.hist_title,fe.fOption=this.histo_drawopt,fe.$custom_stat="$htemp"===this.hist_name?111110:111111,P?(this.hist=fe,this.x=T,this.y=z,this.z=W):fe.fBits=fe.fBits|x.kNoStats,fe}createOutputObject(){if(this.hist||!this.vars[0].buf)return;if(this.dump_values)this.hist=[],this.fill1DHistogram=this.fill2DHistogram=this.fill3DHistogram=this.dumpValues;else if(this.graph){const z=this.vars[0].buf.length;let W=null;if(1===this.ndim)W=(0,x.createTGraph)(z,Array.from(Array(z).keys()),this.vars[0].buf),W.fName="Graph",W.fTitle=this.hist_title;else if(2===this.ndim)W=(0,x.createTGraph)(z,this.vars[0].buf,this.vars[1].buf),W.fName="Graph",W.fTitle=this.hist_title,delete this.vars[1].buf;else if(3===this.ndim){W=(0,x.create)(x.clTPolyMarker3D),W.fN=z,W.fLastPoint=z-1;const fe=new Array(3*z);for(let we=0;we<z;++we)fe[3*we]=this.vars[0].buf[we],fe[3*we+1]=this.vars[1].buf[we],fe[3*we+2]=this.vars[2].buf[we];W.fP=fe,W.$hist=this.createHistogram(10),delete this.vars[1].buf,delete this.vars[2].buf,W.fName="Points"}this.hist=W}else this.createHistogram([200,50,20][this.ndim],!0);const b=this.vars[0].buf,P=this.cut.buf,T=b.length;if(!this.graph)switch(this.ndim){case 1:for(let z=0;z<T;++z)this.fill1DHistogram(b[z],P?P[z]:1);break;case 2:{const z=this.vars[1].buf;for(let W=0;W<T;++W)this.fill2DHistogram(b[W],z[W],P?P[W]:1);delete this.vars[1].buf;break}case 3:{const z=this.vars[1].buf,W=this.vars[2].buf;for(let fe=0;fe<T;++fe)this.fill3DHistogram(b[fe],z[fe],W[fe],P?P[fe]:1);delete this.vars[1].buf,delete this.vars[2].buf;break}}delete this.vars[0].buf,delete this.cut.buf}fillTBitsHistogram(b,P){if(!(P&&b&&b.fNbits&&b.fAllBits))return;const T=Math.min(b.fNbits+1,8*b.fNbytes);for(let z=0,W=1,fe=0;z<T;++z)b.fAllBits[fe]&&W&&(z<=this.x.nbins?this.hist.fArray[z+1]+=P:this.hist.fArray[this.x.nbins+1]+=P),W*=2,W>=256&&(W=1,++fe)}FillBitsHistogram(b,P){if(P)for(let T=0,z=1;T<this.x.nbins;++T)b&z&&(this.hist.fArray[T+1]+=P),z*=2}fill1DHistogram(b,P){const T=this.x.GetBin(b);this.hist.fArray[T]+=P,!this.x.lbls&&Number.isFinite(b)&&(this.hist.fTsumw+=P,this.hist.fTsumwx+=P*b,this.hist.fTsumwx2+=P*b*b)}fill2DHistogram(b,P,T){const z=this.x.GetBin(b),W=this.y.GetBin(P);this.hist.fArray[z+(this.x.nbins+2)*W]+=T,!this.x.lbls&&!this.y.lbls&&Number.isFinite(b)&&Number.isFinite(P)&&(this.hist.fTsumw+=T,this.hist.fTsumwx+=T*b,this.hist.fTsumwy+=T*P,this.hist.fTsumwx2+=T*b*b,this.hist.fTsumwxy+=T*b*P,this.hist.fTsumwy2+=T*P*P)}fill3DHistogram(b,P,T,z){const W=this.x.GetBin(b),fe=this.y.GetBin(P),we=this.z.GetBin(T);this.hist.fArray[W+(this.x.nbins+2)*(fe+(this.y.nbins+2)*we)]+=z,!this.x.lbls&&!this.y.lbls&&!this.z.lbls&&Number.isFinite(b)&&Number.isFinite(P)&&Number.isFinite(T)&&(this.hist.fTsumw+=z,this.hist.fTsumwx+=z*b,this.hist.fTsumwy+=z*P,this.hist.fTsumwz+=z*T,this.hist.fTsumwx2+=z*b*b,this.hist.fTsumwy2+=z*P*P,this.hist.fTsumwz2+=z*T*T,this.hist.fTsumwxy+=z*b*P,this.hist.fTsumwxz+=z*b*T,this.hist.fTsumwyz+=z*P*T)}dumpValues(b,P,T,z){let W;switch(this.ndim){case 1:W={x:b,weight:P};break;case 2:W={x:b,y:P,weight:T};break;case 3:W={x:b,y:P,z:T,weight:z}}this.cut.is_dummy()&&(1===this.ndim?W=b:delete W.weight),this.hist.push(W)}ProcessArraysFunc(){if(this.arr_limit||this.graph){const b=this.vars[0],P=this.vars[1],T=this.vars[2],z=this.tgtarr.br0.length;if(0===b.buf.length&&z>=this.arr_limit&&!this.graph)b.buf=this.tgtarr.br0,P&&(P.buf=this.tgtarr.br1),T&&(T.buf=this.tgtarr.br2);else for(let W=0;W<z;++W)b.buf.push(this.tgtarr.br0[W]),P&&P.buf.push(this.tgtarr.br1[W]),T&&T.buf.push(this.tgtarr.br2[W]);b.kind="number",P&&(P.kind="number"),T&&(T.kind="number"),this.cut.buf=null,!this.graph&&b.buf.length>=this.arr_limit&&(this.createOutputObject(),this.arr_limit=0)}else{const b=this.tgtarr.br0,P=b.length;switch(this.ndim){case 1:for(let T=0;T<P;++T)this.fill1DHistogram(b[T],1);break;case 2:{const T=this.tgtarr.br1;for(let z=0;z<P;++z)this.fill2DHistogram(b[z],T[z],1);break}case 3:{const T=this.tgtarr.br1,z=this.tgtarr.br2;for(let W=0;W<P;++W)this.fill3DHistogram(b[W],T[W],z[W],1);break}}}}ProcessDump(){const b=this.leaf?this.tgtobj.br0[this.leaf]:this.tgtobj.br0;b&&this.copy_fields&&0===ue(b)?this.hist.push(Object.assign({},b)):this.hist.push(b)}Process(b){if(this.globals.entry=b,this.cut.produce(this.tgtobj),!this.dump_values&&!this.cut.value)return;for(let fe=0;fe<this.ndim;++fe)this.vars[fe].produce(this.tgtobj);const P=this.vars[0],T=this.vars[1],z=this.vars[2],W=this.cut;if(this.graph||this.arr_limit){switch(this.ndim){case 1:for(let fe=0;fe<P.length;++fe)P.buf.push(P.get(fe)),W.buf?.push(W.value);break;case 2:for(let fe=0;fe<P.length;++fe)for(let we=0;we<T.length;++we)P.buf.push(P.get(fe)),T.buf.push(T.get(we)),W.buf?.push(W.value);break;case 3:for(let fe=0;fe<P.length;++fe)for(let we=0;we<T.length;++we)for(let Me=0;Me<z.length;++Me)P.buf.push(P.get(fe)),T.buf.push(T.get(we)),z.buf.push(z.get(Me)),W.buf?.push(W.value)}!this.graph&&P.buf.length>=this.arr_limit&&(this.createOutputObject(),this.arr_limit=0)}else if(this.hist)switch(this.ndim){case 1:for(let fe=0;fe<P.length;++fe)this.fill1DHistogram(P.get(fe),W.value);break;case 2:for(let fe=0;fe<P.length;++fe)for(let we=0;we<T.length;++we)this.fill2DHistogram(P.get(fe),T.get(we),W.value);break;case 3:for(let fe=0;fe<P.length;++fe)for(let we=0;we<T.length;++we)for(let Me=0;Me<z.length;++Me)this.fill3DHistogram(P.get(fe),T.get(we),z.get(Me),W.value)}if(this.monitoring&&this.hist&&!this.dump_values){const fe=(new Date).getTime();fe-this.lasttm>this.monitoring&&(this.lasttm=fe,(0,x.isFunc)(this.progress_callback)&&this.progress_callback(this.hist))}}Terminate(b){b&&!this.hist&&this.createOutputObject(),this.ShowProgress(),(0,x.isFunc)(this.result_callback)&&this.result_callback(this.hist)}}function g(G,b){if(!G||!b||G._typename!==F||G.fID<0||G.fStreamerType<0)return null;const P=b.findStreamerInfo(G.fClassName,G.fClassVersion,G.fCheckSum),T=P&&P.fElements?P.fElements.arr:null;if(!T)return null;let z=G.fName,W=z.indexOf("[");function fe(we){return!(!we||we.fName!==z||we.fType!==G.fStreamerType&&(we.fType!==L.Qu||G.fStreamerType!==L.h0)&&(G.fStreamerType!==L.$o&&G.fStreamerType!==L.$o+L.bm&&G.fStreamerType!==L.v5&&G.fStreamerType!==L.v5+L.bm||we.fType!==L.N8)&&(console.warn(`Should match element ${we.fType} with branch ${G.fStreamerType}`),1))}if(W>0&&(z=z.slice(0,W)),W=z.lastIndexOf("."),W>0&&(z=z.slice(W+1)),fe(T[G.fID]))return T[G.fID];for(let we=0;we<T.length;++we)if(we!==G.fID&&fe(T[we]))return T[we];return console.error(`Did not found/match element for branch ${G.fName} class ${G.fClassName}`),null}function v(G,b,P){const T=G.findStreamerInfo(b),z=T?.fElements?.arr;if(!z)return"";let W=null;for(let we=0;we<z.length;++we)if("BASE"===z[we].fTypeName){const Me=v(G,z[we].fName,P);if(Me)return Me}else if(z[we].fName===P){W=z[we];break}if(!W)return"";let fe=W.fTypeName;return"*"===fe[fe.length-1]&&(fe=fe.slice(0,fe.length-1)),fe}function f(G){const b=(0,x.getMethods)(G),P={names:[],values:[],Create(){const T={};for(let z=0;z<this.names.length;++z)T[this.names[z]]=this.values[z];return T}};P.names.push("_typename"),P.values.push(G);for(const T in b)P.names.push(T),P.values.push(b[T]);return P}function C(G,b,P){let T="";for(let z=P||0;z<G.arr.length;++z)0===G.arr[z].fName.indexOf(b)&&G.arr[z].fClassName&&(T=G.arr[z].fClassName);return T}function I(G,b,P){return U.apply(this,arguments)}function U(){return(U=(0,Ee.A)(function*(G,b,P){if(P||(P={}),!b||!G.$file||!b.numBranches())return b?.Terminate(!1),Promise.reject(Error("required parameter missing for TTree::Process"));const T={tree:G,file:G.$file,selector:b,arr:[],curr:-1,current_entry:-1,simple_read:!0,process_arrays:!0},z=(te,Je)=>{let tt=0;switch(te._typename){case"TLeafF":tt=L.k1;break;case"TLeafD":tt=L.Hg;break;case"TLeafO":tt=L.Qu;break;case"TLeafB":tt=te.fIsUnsigned?L.h0:L.yd;break;case"TLeafS":tt=te.fIsUnsigned?L.bP:L.aM;break;case"TLeafI":tt=te.fIsUnsigned?L.c4:L.nc;break;case"TLeafL":tt=te.fIsUnsigned?L.NE:L.s4;break;case"TLeafC":tt=L.V$;break;default:return null}const Fe=(0,L._T)(Je||te.fName,tt);return te.fLen>1&&(Fe.fType+=L.bm,Fe.fArrayLength=te.fLen),Fe},W=te=>{for(let Je=0;Je<T.arr.length;++Je)if(T.arr[Je].branch===te)return T.arr[Je];return null};let Me,je,fe=0;function we(te,Je,tt,Fe){if((0,x.isStr)(te)&&(te=$(T.tree,te)),!te)return console.error("Did not found branch"),null;let Ne=W(te);if(Ne)return console.error(`Branch ${te.fName} already configured for reading`),Ne.tgt!==Je&&console.error("Target object differs"),null;if(!te.fEntries)return console.warn(`Branch ${te.fName} does not have entries`),null;for(Ne={branch:te,tgt:Je,name:tt,index:-1,member:null,type:0,curr_entry:-1,raw:null,basket:null,curr_basket:0,read_entry:-1,staged_entry:-1,first_readentry:-1,staged_basket:0,numentries:te.fEntries,numbaskets:te.fWriteBasket,counters:null,ascounter:[],baskets:[],staged_prev:0,staged_now:0,progress_showtm:0,getBasketEntry(bn){if(!this.branch||bn>this.branch.fMaxBaskets)return 0;const Dn=bn<this.branch.fMaxBaskets?this.branch.fBasketEntry[bn]:0;if(Dn)return Dn;const $n=bn>0?this.branch.fBaskets.arr[bn-1]:null;return $n?this.branch.fBasketEntry[bn-1]+$n.fNevBuf:0},getTarget(bn){if(!this.tgt)return bn;for(let Dn=0;Dn<this.tgt.length;++Dn){const $n=this.tgt[Dn];bn[$n.name]||(bn[$n.name]=$n.lst.Create()),bn=bn[$n.name]}return bn},getEntry(bn){const Dn=bn-this.first_entry;let $n;this.branch.TestBit(De)||this.raw.clearObjectMap(),this.basket.fEntryOffset?($n=this.basket.fEntryOffset[Dn],this.basket.fDisplacement&&(this.raw.fDisplacement=this.basket.fDisplacement[Dn])):$n=this.basket.fKeylen+this.basket.fNevBufSize*Dn,this.raw.locate($n-this.raw.raw_shift)}};Ne.getBasketEntry(Ne.numbaskets+1);)Ne.numbaskets++;const rt=te.fLeaves?.arr?.length??0,St=rt>0?te.fLeaves.arr[0]:null,pt=te._typename===F;let st=null,vt=null,Yt=0,qt=null,Ot=null,Bn="";if(te.fBranchCount){if(qt=W(te.fBranchCount),qt||(qt=we(te.fBranchCount,Je,"$counter"+fe++,!0)),!qt)return console.error(`Cannot add counter branch ${te.fBranchCount.fName}`),null;let bn=te.fBranchCount2;if(!bn&&te.fBranchCount.fStreamerType===L.$o&&(te.fStreamerType===L.mU||te.fStreamerType===L.bm+L.mU)){const Dn=g(te,T.file),$n=te.fBranchCount.fBranches.arr;if(Dn?.fCountName&&$n)for(let Cn=0;Cn<$n.length;++Cn)if($n[Cn].fName===te.fBranchCount.fName+"."+Dn.fCountName){bn=$n[Cn];break}bn||console.error("Did not found branch for second counter of kStreamLoop element")}if(bn&&(Ot=W(bn),Ot||(Ot=we(bn,Je,"$counter"+fe++,!0)),!Ot))return console.error(`Cannot add counter branch2 ${bn.fName}`),null}else if(1===rt&&St&&St.fLeafCount){const bn=$(T.tree,St.fLeafCount.fName);if(bn&&(qt=W(bn),qt||(qt=we(bn,Je,"$counter"+fe++,!0)),!qt))return console.error(`Cannot add counter branch ${bn.fName}`),null}function Mn(bn,Dn,$n){if(!bn||!bn.arr.length)return!0;let Cn=te.fName;"."===Cn[Cn.length-1]&&(Cn=Cn.slice(0,Cn.length-1)),(0,x.isStr)(Fe)&&"."===Fe[0]&&(Cn+=Fe),Cn+=".";for(let yn=0;yn<bn.arr.length;++yn){const Sn=bn.arr[yn];if($n>0&&Sn.fType!==$n)continue;if(Sn.fType===ot){if(!Mn(Sn.fBranches,Dn,$n))return!1;continue}if("BASE"===g(Sn,T.file)?.fTypeName){if(Sn.fTotBytes&&!we(Sn,Je,tt,Fe)||!Mn(Sn.fBranches,Dn,$n))return!1;continue}let ai=Sn.fName,Hi=1;if(0===Sn.fName.indexOf(Cn))ai=ai.slice(Cn.length);else if($n>0)continue;let ti=ai.indexOf("[");if(ti>0&&(ai=ai.slice(0,ti)),ti=ai.indexOf("<"),ti>0&&(ai=ai.slice(0,ti)),$n>0){Hi="$child$";const Nr=ai.indexOf(".");Nr>0&&(Hi=C(bn,te.fName+"."+ai.slice(0,Nr+1),yn)||x.clTObject)}if(!we(Sn,Dn,ai,Hi))return!1}return!0}if("TBranchObject"===te._typename)vt={name:tt,typename:te.fClassName,virtual:St.fVirtual,func(bn,Dn){let $n=this.typename;this.virtual&&($n=bn.readFastString(bn.ntou1()+1)),Dn[this.name]=bn.classStreamer({},$n)}};else if(te.fType===Ze||te.fType===Re){if(st=(0,L._T)(tt,L.nc),!Fe||(0,x.isStr)(Fe)&&"."===Fe[0]||1===Fe){if(T.process_arrays=!1,vt={name:tt,conttype:te.fClonesName||x.clTObject,reallocate:P.reallocate_objects,func(bn,Dn){const $n=bn.ntoi4();let Cn=0,yn=Dn[this.name];for(!yn||this.reallocate?yn=Dn[this.name]=new Array($n):(Cn=yn.length,yn.length=$n);Cn<$n;)yn[Cn++]=this.methods.Create()}},(0,x.isStr)(Fe)&&"."===Fe[0]&&(vt.conttype=C(te.fBranches,te.fName+Fe),!vt.conttype))return console.error(`Cannot select object ${Fe} in the branch ${te.fName}`),null;vt.methods=f(vt.conttype),Yt=te.fType===Ze?He:Ve}}else{if(Bn=me(te,T.tree)){if(!0===Fe)return console.warn(`Object branch ${Bn} can not have data to be read directly`),null;T.process_arrays=!1;const bn=new Array(Je?Je.length+1:1);for(let Dn=0;Dn<bn.length-1;++Dn)bn[Dn]=Je[Dn];return bn[bn.length-1]={name:tt,lst:f(Bn)},Mn(te.fBranches,bn,0)?Ne:null}if(pt&&1===rt&&St.fName===te.fName&&-1===te.fID){if(st=(0,L._T)(tt,te.fClassName),st.fType===L.w1){const bn=T.file.getStreamer(te.fClassName,{val:te.fClassVersion,checksum:te.fCheckSum});bn?vt={name:tt,typename:te.fClassName,streamer:bn,func(Dn,$n){const Cn={_typename:this.typename};for(let yn=0;yn<this.streamer.length;++yn)this.streamer[yn].func(Dn,Cn);$n[this.name]=Cn}}:(st=null,console.warn("not found streamer!"))}}else if(pt&&rt<=1)st=g(te,T.file),!st&&te.fStreamerType&&te.fStreamerType<20&&(st=(0,L._T)(tt,te.fStreamerType));else if(1===rt)st=z(St,tt);else if("TBranch"===te._typename&&rt>1){const bn=new Array(rt);let Dn=!0;for(let $n=0;$n<rt;++$n)bn[$n]=(0,L.Mx)(z(te.fLeaves.arr[$n]),T.file),bn[$n]||(Dn=!1);Dn&&(vt={name:tt,leaves:bn,func($n,Cn){let yn=Cn[this.name],Sn=0;for(yn||(Cn[this.name]=yn={});Sn<this.leaves.length;)this.leaves[Sn++].func($n,yn)}})}}if(!st&&!vt)return console.warn(`Not supported branch ${te.fName} type ${te._typename}`),null;if(vt||(vt=(0,L.Mx)(st,T.file),void 0!==vt.base&&vt.basename&&(vt.func=function(bn,Dn){Dn[this.name]||(Dn[this.name]={_typename:this.basename}),bn.classStreamer(Dn[this.name],this.basename)})),qt&&(0,x.isStr)(Fe)){vt.name0=qt.name;const bn=tt.split(".");if(1===bn.length)vt.get=(Dn,$n)=>Dn[$n];else{if("$child$"===Fe)return console.error(`target name ${tt} contains point, but suppose to be direct child`),null;if(2===bn.length)tt=vt.name=bn[1],vt.name1=bn[0],vt.subtype1=Fe,vt.methods1=f(vt.subtype1),vt.get=function(Dn,$n){let Cn=Dn[$n][this.name1];return Cn||(Cn=Dn[$n][this.name1]=this.methods1.Create()),Cn};else{if(!te.fParentName)return console.error(`Not possible to provide more than 2 parts in the target name ${tt}`),null;tt=vt.name=bn.pop(),vt.snames=bn,vt.smethods=[];let Dn=te.fParentName;for(let $n=0;$n<bn.length;++$n){const Cn=v(T.file,Dn,bn[$n]);vt.smethods[$n]=f(Cn||"AbstractClass"),Dn=Cn}vt.get=function($n,Cn){let yn=$n[Cn][this.snames[0]];yn||(yn=$n[Cn][this.snames[0]]=this.smethods[0].Create());for(let Sn=1;Sn<this.snames.length;++Sn){let ii=yn[this.snames[Sn]];ii||(ii=yn[this.snames[Sn]]=this.smethods[Sn].Create()),yn=ii}return yn}}}vt.objs_branch_func?vt.func=vt.objs_branch_func:(vt.func0=vt.func,vt.func=function(Dn,$n){const Cn=$n[this.name0];let yn=0;for(;yn<Cn.length;)this.func0(Dn,this.get(Cn,yn++))})}else if(qt)if(T.process_arrays=!1,st.fType===L.Q_||st.fType===L.PI)vt.stl_size=qt.name,vt.func=function(bn,Dn){Dn[this.name]=this.readarr(bn,Dn[this.stl_size])};else if(st.fType!==L.Pk+L.Q_&&st.fType!==L.Pk+L.PI||!te.fBranchCount2)if(st.fType>0&&st.fType<L.bm||st.fType===L.V$||st.fType>L.Pk&&st.fType<L.Pk+L.bm&&te.fBranchCount2)vt={name:tt,stl_size:qt.name,type:st.fType,func(bn,Dn){Dn[this.name]=bn.readFastArray(Dn[this.stl_size],this.type)}},te.fBranchCount2&&(vt.type-=L.Pk,vt.arr_size=Ot.name,vt.func=function(bn,Dn){const $n=Dn[this.stl_size],Cn=Dn[this.arr_size],yn=new Array($n);for(let Sn=0;Sn<$n;++Sn)yn[Sn]=1===bn.ntou1()?bn.readFastArray(Cn[Sn],this.type):[];Dn[this.name]=yn});else if(st.fType>L.Pk&&st.fType<L.Pk+L.bm&&vt.cntname)vt.cntname=qt.name;else if(st.fType===L.N8){if(Ot)throw new Error("Second branch counter not supported yet with kStreamer");vt.func=vt.branch_func,vt.stl_size=qt.name}else if(st.fType===L.mU||st.fType===L.bm+L.mU)Ot?(vt.stl_size=qt.name,vt.cntname=Ot.name,vt.func=vt.branch_func):vt.cntname=qt.name;else{let bn;if(vt.name="$stl_member",Ot){if(!vt.cntname)throw new Error("Second branch counter not used - very BAD");bn=Ot.name,vt.cntname="$loop_size"}vt={name:tt,stl_size:qt.name,loop_size:bn,member0:vt,func($n,Cn){const yn=Cn[this.stl_size],Sn=new Array(yn);for(let ii=0;ii<yn;++ii)this.loop_size&&(Cn.$loop_size=Cn[this.loop_size][ii]),this.member0.func($n,Cn),Sn[ii]=Cn.$stl_member;delete Cn.$stl_member,delete Cn.$loop_size,Cn[this.name]=Sn}}}else vt.stl_size=qt.name,vt.arr_size=Ot.name,vt.func=function(bn,Dn){const $n=Dn[this.stl_size],Cn=Dn[this.arr_size],yn=new Array($n);for(let Sn=0;Sn<$n;++Sn)yn[Sn]=1===bn.ntou1()?this.readarr(bn,Cn[Sn]):[];Dn[this.name]=yn};return vt.name=tt,Ne.member=vt,st&&(Ne.type=st.fType),Ne.index=T.arr.length,qt&&(Ne.counters=[qt.index],qt.ascounter.push(Ne.index),Ot&&(Ne.counters.push(Ot.index),Ot.ascounter.push(Ne.index))),T.arr.push(Ne),Yt&&!Mn(te.fBranches,Je,Yt)?null:Ne}for(let te=0;te<b.numBranches();++te)if(!we(b.getBranch(te),void 0,b.nameOfBranch(te),b._directs[te]))return b.Terminate(!1),Promise.reject(Error(`Fail to add branch ${b.nameOfBranch(te)}`));for(let te=1;te<T.arr.length&&T.simple_read;++te){const Je=T.arr[te],tt=T.arr[0];(Je.numentries!==tt.numentries||Je.numbaskets!==tt.numbaskets)&&(T.simple_read=!1);for(let Fe=0;Fe<Je.numbaskets;++Fe)Je.getBasketEntry(Fe)!==tt.getBasketEntry(Fe)&&(T.simple_read=!1)}T.firstentry=T.lastentry=0;for(let te=0;te<T.arr.length;++te){const Je=T.arr[te].branch,tt=Je.fFirstEntry??(Je.fBasketBytes[0]?Je.fBasketEntry[0]:0);T.firstentry=Math.max(T.firstentry,tt),T.lastentry=0===te?tt+Je.fEntries:Math.min(T.lastentry,tt+Je.fEntries)}if(T.firstentry>=T.lastentry)return b.Terminate(!1),Promise.reject(Error("No any common events for selected branches"));if(T.process_min=T.firstentry,T.process_max=T.lastentry,Number.isInteger(P.firstentry)&&P.firstentry>T.firstentry&&P.firstentry<T.lastentry&&(T.process_min=P.firstentry),T.current_entry=T.staged_now=T.process_min,Number.isInteger(P.numentries)&&P.numentries>0){const te=T.process_min+P.numentries;te<T.process_max&&(T.process_max=te)}if((0,x.isFunc)(b.ProcessArrays)&&T.simple_read){for(let te=0;te<T.arr.length;++te){const Je=T.arr[te];(Je.type<=0||Je.type>=L.bm||Je.type===L.k)&&(T.process_arrays=!1)}if(T.process_arrays){b.tgtarr={};for(let te=0;te<T.arr.length;++te){const Je=T.arr[te],tt=(0,L._T)(Je.name,Je.type);tt.fType=Je.type+L.bm,tt.fArrayLength=10,tt.fArrayDim=1,tt.fMaxIndex[0]=10,Je.arrmember=(0,L.Mx)(tt,T.file)}}}else T.process_arrays=!1;function Ge(te){function Je(){const rt=[];let St="";for(let pt=0;pt<te.length;++pt){if(te[pt].done)continue;const st=te[pt].branch;if(0===rt.length)St=st.fFileName;else if(St!==st.fFileName)continue;te[pt].selected=!0,rt.push(st.fBasketSeek[te[pt].basket],st.fBasketBytes[te[pt].basket])}return rt.length>0?{places:rt,filename:St}:null}function tt(rt){if(T.staged_prev===T.staged_now||T.process_max<=T.process_min)return;const St=(new Date).getTime();return St-T.progress_showtm<500?void 0:(T.progress_showtm=St,T.selector.ShowProgress((T.staged_prev+rt*(T.staged_now-T.staged_prev))/(T.process_max-T.process_min)))}function Fe(rt,St){return!rt||St.length>2&&2*rt.length!==St.length?Promise.resolve(null):(2===St.length&&(rt=[rt]),function pt(st){for(;st<te.length;++st){if(!te[st].selected)continue;te[st].selected=!1,te[st].done=!0;const Yt=rt.shift();let qt=new L.lW(Yt,0,T.file);const Ot=qt.classStreamer({},L.ym);if(Ot.fNbytes!==te[st].branch.fBasketBytes[te[st].basket]&&console.error(`mismatch in read basket sizes ${Ot.fNbytes} != ${te[st].branch.fBasketBytes[te[st].basket]}`),te[st].bskt_obj=Ot,Ot.fKeylen+Ot.fObjlen!==Ot.fNbytes)return(0,L.ry)(Yt,Ot.fObjlen,!1,qt.o).then(Bn=>{if(!Bn)throw new Error("FAIL TO UNPACK");return qt=new L.lW(Bn,0,T.file),qt.raw_shift=Ot.fKeylen,qt.fTagOffset=Ot.fKeylen,te[st].raw=qt,te[st].branch.fEntryOffsetLen>0&&qt.readBasketEntryOffset(Ot,qt.raw_shift),pt(st+1)});qt.raw_shift=0,te[st].raw=qt,te[st].branch.fEntryOffsetLen>0&&qt.readBasketEntryOffset(Ot,qt.raw_shift)}const vt=Je();return vt?T.file.readBuffer(vt.places,vt.filename,tt).then(Yt=>Fe(Yt)).catch(()=>null):Promise.resolve(te)}(0))}const Ne=Je();return Ne?T.file.readBuffer(Ne.places,Ne.filename,tt).then(rt=>Fe(rt,Ne.places)).catch(()=>null):Promise.resolve(null)}function lt(){const te=[];let Je=0,tt=!0,Fe=!1,Ne=T.process_max;for(;Je<1e6&&tt;){tt=!1;for(let St=T.arr.length-1;St>=0;--St){const pt=T.arr[St];for(;pt.staged_basket<pt.numbaskets;){const st=pt.staged_basket++;if(pt.getBasketEntry(st)>=T.process_max)break;if(pt.first_readentry<0){if(pt.getBasketEntry(st+1)<=T.process_min)continue;pt.curr_basket=st,pt.first_readentry=pt.getBasketEntry(st)}const vt={id:St,branch:pt.branch,basket:st,raw:null},Yt=pt.branch.fBaskets.arr[st];Yt?(vt.raw=Yt.fBufferRef,vt.raw?vt.raw.locate(0):vt.raw=new L.lW(null,0,T.file),vt.raw.raw_shift=Yt.fKeylen,Yt.fBufferRef&&pt.branch.fEntryOffsetLen>0&&vt.raw.readBasketEntryOffset(Yt,vt.raw.raw_shift),vt.bskt_obj=Yt,Fe=!0,pt.baskets[st]=vt):(te.push(vt),Je+=pt.branch.fBasketBytes[st],tt=!0),pt.staged_entry=pt.getBasketEntry(st+1),Ne=Math.min(Ne,pt.staged_entry);break}}}if(0===Je&&!Fe)return T.selector.Terminate(!0),Me(T.selector);T.staged_prev=T.staged_now,T.staged_now=Ne;let rt=0;if(T.process_max>T.process_min&&(rt=(T.staged_prev-T.process_min)/(T.process_max-T.process_min)),"break"===T.selector.ShowProgress(rt))return T.selector.Terminate(!0),Me(T.selector);if(T.progress_showtm=(new Date).getTime(),Je>0)return Ge(te).then(bt);if(Fe)return bt([]);throw new Error("No any data is requested - never come here")}function bt(te){if(0!==T.selector._break||null===te)return T.selector.Terminate(!1),Me(T.selector);for(let tt=0;tt<te.length;++tt)T.arr[te[tt].id].baskets[te[tt].basket]=te[tt];let Je=!1;for(;;){let Fe,Ne,tt=1e8;for(Fe=0;Fe<T.arr.length;++Fe){if(Ne=T.arr[Fe],!Ne.raw||!Ne.basket||Ne.first_entry+Ne.basket.fNevBuf<=T.current_entry){if(delete Ne.raw,delete Ne.basket,Ne.curr_basket>=Ne.numbaskets){if(0===Fe)return T.selector.Terminate(!0),Me(T.selector);continue}const rt=Ne.baskets[Ne.curr_basket];if(!rt)return Je?lt():(T.selector.Terminate(!1),je(Error(`no data for ${Ne.branch.fName} basket ${Ne.curr_basket}`)));Ne.raw=rt.raw,Ne.basket=rt.bskt_obj,Ne.first_entry=Ne.getBasketEntry(rt.basket),rt.raw=null,rt.branch=null,rt.bskt_obj=null,Ne.baskets[Ne.curr_basket++]=void 0}tt=Math.min(tt,Ne.first_entry+Ne.basket.fNevBuf-T.current_entry)}if(T.current_entry+tt>T.process_max&&(tt=T.process_max-T.current_entry),T.process_arrays&&tt>1){for(Fe=0;Fe<T.arr.length;++Fe)Ne=T.arr[Fe],Ne.getEntry(T.current_entry),Ne.arrmember.arrlength=tt,Ne.arrmember.func(Ne.raw,T.selector.tgtarr),Ne.raw=null;T.selector.ProcessArrays(T.current_entry),T.current_entry+=tt,Je=!0}else for(;tt--;){for(Fe=0;Fe<T.arr.length;++Fe)Ne=T.arr[Fe],Ne.getEntry(T.current_entry),Ne.member.func(Ne.raw,Ne.getTarget(T.selector.tgtobj));T.selector.Process(T.current_entry),T.current_entry++,Je=!0}if(T.current_entry>=T.process_max)return T.selector.Terminate(!0),Me(T.selector)}}return new Promise((te,Je)=>{Me=te,je=Je,T.selector.Begin(G),lt()})})).apply(this,arguments)}function k(G,b){return Z.apply(this,arguments)}function Z(){return(Z=(0,Ee.A)(function*(G,b){(0,x.isStr)(b)&&(b={expr:b}),(0,x.isStr)(b.expr)||(b.expr="");const P=new E;if(b.branch){if(!P.drawOnlyBranch(G,b.branch,b.expr,b))return Promise.reject(Error(`Fail to create draw expression ${b.expr} for branch ${b.branch.fName}`))}else if(!P.parseDrawExpression(G,b))return Promise.reject(Error(`Fail to create draw expression ${b.expr}`));return P.setCallback(null,b.progress),I(G,P,b).then(()=>P.hist)})).apply(this,arguments)}function ee(G,b){const P=[],T=[],z=[],fe=function W(je,Ge=""){if(!je?.fBranches)return 0;let lt=0;for(let bt=0;bt<je.fBranches.arr.length;++bt){const te=je.fBranches.arr[bt],Je=(Ge?Ge+"/":"")+te.fName;P.push(te),T.push(Je),z.push(0);const tt=z.length-1;lt+=te.fLeaves?.arr?.length??0;const Fe=W(te,Je);lt+=Fe,z[tt]=Fe}return lt}(G);let we;return T.push(`Total are ${P.length} branches with ${fe} leaves`),function Me(je){if(je>=P.length||we?._break||b._break)return Promise.resolve(!0);we=new Y,we.addBranch(P[je],"br0"),we.Process=function(){void 0===this.tgtobj.br0&&(this.fail=!0)},we.Terminate=function(Ne){(0,x.isStr)(Ne)||(Ne=!Ne||this.fails?"FAIL":"ok"),T[je]=Ne+" "+T[je]};const Ge=P[je],lt=me(Ge,G),bt=Ge.fEntries;if((lt?z[je]>100:!Ge.fLeaves?.arr?.length)||bt<=0)return Me(je+1);const Je={numentries:10},tt=Ge.fFirstEntry||0,Fe=Ge.fEntryNumber||tt+bt;return bt<Je.numentries?Je.numentries=bt:Je.firstentry=tt+Math.round((Fe-tt-Je.numentries)*Math.random()),console.log(`test branch ${Ge.fName} first ${Je.firstentry||0} num ${Je.numentries}`),(0,x.isFunc)(b.showProgress)&&b.showProgress(`br ${je}/${P.length} ${Ge.fName}`),I(G,we,Je).then(()=>Me(je+1))}(0).then(()=>((0,x.isFunc)(b.showProgress)&&b.showProgress(),T))}function he(G,b){function P(T,z,W,fe){if(!T||!z)return!1;const we=z.fBranches?.arr?.length??0,Me=z.fLeaves?.arr?.length??0;function je(lt){const bt=lt.indexOf("[");return bt>0&&(lt=lt.slice(0,bt)),fe&&0===lt.indexOf(fe.fName)&&"."===(lt=lt.slice(fe.fName.length))[0]&&(lt=lt.slice(1)),lt}z.$tree=W;const Ge={_name:je(z.fName),_kind:x.prROOT+z._typename,_title:z.fTitle,_obj:z};if(T._childs||(T._childs=[]),T._childs.push(Ge),z._typename===F&&(Ge._title+=` from ${z.fClassName};${z.fClassVersion}`),we>0)return Ge._more=!0,Ge._expand=function(lt,bt){if(!bt)return!1;lt._childs||(lt._childs=[]),1===bt.fLeaves?.arr?.length&&(bt.fType===Ze||bt.fType===Re)&&(bt.fLeaves.arr[0].$branch=bt,lt._childs.push({_name:"@size",_title:"container size",_kind:x.prROOT+"TLeafElement",_icon:"img_leaf",_obj:bt.fLeaves.arr[0],_more:!1}));for(let tt=0;tt<bt.fBranches.arr.length;++tt)P(lt,bt.fBranches.arr[tt],bt.$tree,bt);const te=me(bt,bt.$tree,!0),Je=te?(0,x.getMethods)(te):null;if(Je&&bt.fBranches.arr.length>0)for(const tt in Je){if(!(0,x.isFunc)(Je[tt]))continue;const Fe=Je[tt].toString();Fe.indexOf("return")>0&&0===Fe.indexOf("function ()")&&lt._childs.push({_name:tt+"()",_title:`function ${tt} of class ${te}`,_kind:x.prROOT+J,_obj:{_typename:J,branch:bt,func:tt},_more:!1})}return!0},!0;if(1===Me)Ge._icon="img_leaf",Ge._more=!1;else if(Me>1){Ge._childs=[];for(let lt=0;lt<Me;++lt){z.fLeaves.arr[lt].$branch=z;const bt={_name:je(z.fLeaves.arr[lt].fName),_kind:x.prROOT+z.fLeaves.arr[lt]._typename,_obj:z.fLeaves.arr[lt]};Ge._childs.push(bt)}}return!0}if(void 0===b.fBranches)return!1;G._childs=[],G._tree=b;for(let T=0;T<b.fBranches.arr?.length;++T)P(G,b.fBranches.arr[T],b);return!0}}},Yr=>{Yr(Yr.s=8007)}]);
//# sourceMappingURL=main.1e4dff0735cca215.js.map